<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>GDB (API): /home/stan/gdb/src/gdb/printcmd.c Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">GDB (API)
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">/home/stan/gdb/src/gdb/printcmd.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="printcmd_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/* Print values for GNU debugger GDB.</span>
<a name="l00002"></a>00002 <span class="comment"></span>
<a name="l00003"></a>00003 <span class="comment">   Copyright (C) 1986-2013 Free Software Foundation, Inc.</span>
<a name="l00004"></a>00004 <span class="comment"></span>
<a name="l00005"></a>00005 <span class="comment">   This file is part of GDB.</span>
<a name="l00006"></a>00006 <span class="comment"></span>
<a name="l00007"></a>00007 <span class="comment">   This program is free software; you can redistribute it and/or modify</span>
<a name="l00008"></a>00008 <span class="comment">   it under the terms of the GNU General Public License as published by</span>
<a name="l00009"></a>00009 <span class="comment">   the Free Software Foundation; either version 3 of the License, or</span>
<a name="l00010"></a>00010 <span class="comment">   (at your option) any later version.</span>
<a name="l00011"></a>00011 <span class="comment"></span>
<a name="l00012"></a>00012 <span class="comment">   This program is distributed in the hope that it will be useful,</span>
<a name="l00013"></a>00013 <span class="comment">   but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00014"></a>00014 <span class="comment">   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00015"></a>00015 <span class="comment">   GNU General Public License for more details.</span>
<a name="l00016"></a>00016 <span class="comment"></span>
<a name="l00017"></a>00017 <span class="comment">   You should have received a copy of the GNU General Public License</span>
<a name="l00018"></a>00018 <span class="comment">   along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.  */</span>
<a name="l00019"></a>00019 
<a name="l00020"></a>00020 <span class="preprocessor">#include &quot;<a class="code" href="defs_8h.html">defs.h</a>&quot;</span>
<a name="l00021"></a>00021 <span class="preprocessor">#include &quot;<a class="code" href="gdb__string_8h.html">gdb_string.h</a>&quot;</span>
<a name="l00022"></a>00022 <span class="preprocessor">#include &quot;<a class="code" href="frame_8h.html">frame.h</a>&quot;</span>
<a name="l00023"></a>00023 <span class="preprocessor">#include &quot;<a class="code" href="symtab_8h.html">symtab.h</a>&quot;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &quot;<a class="code" href="gdbtypes_8h.html">gdbtypes.h</a>&quot;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &quot;<a class="code" href="value_8h.html">value.h</a>&quot;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &quot;<a class="code" href="language_8h.html">language.h</a>&quot;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &quot;<a class="code" href="expression_8h.html">expression.h</a>&quot;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &quot;<a class="code" href="gdbcore_8h.html">gdbcore.h</a>&quot;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &quot;<a class="code" href="gdbcmd_8h.html">gdbcmd.h</a>&quot;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &quot;<a class="code" href="target_8h.html">target.h</a>&quot;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &quot;<a class="code" href="breakpoint_8h.html">breakpoint.h</a>&quot;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &quot;demangle.h&quot;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &quot;<a class="code" href="gdb-demangle_8h.html">gdb-demangle.h</a>&quot;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &quot;<a class="code" href="valprint_8h.html">valprint.h</a>&quot;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &quot;<a class="code" href="annotate_8h.html">annotate.h</a>&quot;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &quot;<a class="code" href="symfile_8h.html">symfile.h</a>&quot;</span>            <span class="comment">/* for overlay functions */</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &quot;<a class="code" href="objfiles_8h.html">objfiles.h</a>&quot;</span>           <span class="comment">/* ditto */</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include &quot;<a class="code" href="completer_8h.html">completer.h</a>&quot;</span>          <span class="comment">/* for completion functions */</span>
<a name="l00039"></a>00039 <span class="preprocessor">#include &quot;<a class="code" href="ui-out_8h.html">ui-out.h</a>&quot;</span>
<a name="l00040"></a>00040 <span class="preprocessor">#include &quot;<a class="code" href="gdb__assert_8h.html">gdb_assert.h</a>&quot;</span>
<a name="l00041"></a>00041 <span class="preprocessor">#include &quot;<a class="code" href="block_8h.html">block.h</a>&quot;</span>
<a name="l00042"></a>00042 <span class="preprocessor">#include &quot;<a class="code" href="disasm_8h.html">disasm.h</a>&quot;</span>
<a name="l00043"></a>00043 <span class="preprocessor">#include &quot;<a class="code" href="dfp_8h.html">dfp.h</a>&quot;</span>
<a name="l00044"></a>00044 <span class="preprocessor">#include &quot;<a class="code" href="valprint_8h.html">valprint.h</a>&quot;</span>
<a name="l00045"></a>00045 <span class="preprocessor">#include &quot;<a class="code" href="exceptions_8h.html">exceptions.h</a>&quot;</span>
<a name="l00046"></a>00046 <span class="preprocessor">#include &quot;<a class="code" href="observer_8h.html">observer.h</a>&quot;</span>
<a name="l00047"></a>00047 <span class="preprocessor">#include &quot;<a class="code" href="solist_8h.html">solist.h</a>&quot;</span>
<a name="l00048"></a>00048 <span class="preprocessor">#include &quot;<a class="code" href="parser-defs_8h.html">parser-defs.h</a>&quot;</span>
<a name="l00049"></a>00049 <span class="preprocessor">#include &quot;<a class="code" href="charset_8h.html">charset.h</a>&quot;</span>
<a name="l00050"></a>00050 <span class="preprocessor">#include &quot;<a class="code" href="arch-utils_8h.html">arch-utils.h</a>&quot;</span>
<a name="l00051"></a>00051 <span class="preprocessor">#include &quot;<a class="code" href="cli-utils_8h.html">cli/cli-utils.h</a>&quot;</span>
<a name="l00052"></a>00052 <span class="preprocessor">#include &quot;<a class="code" href="format_8h.html">format.h</a>&quot;</span>
<a name="l00053"></a>00053 <span class="preprocessor">#include &quot;<a class="code" href="source_8h.html">source.h</a>&quot;</span>
<a name="l00054"></a>00054 
<a name="l00055"></a>00055 <span class="preprocessor">#ifdef TUI</span>
<a name="l00056"></a>00056 <span class="preprocessor"></span><span class="preprocessor">#include &quot;<a class="code" href="tui_8h.html">tui/tui.h</a>&quot;</span>            <span class="comment">/* For tui_active et al.   */</span>
<a name="l00057"></a>00057 <span class="preprocessor">#endif</span>
<a name="l00058"></a>00058 <span class="preprocessor"></span>
<a name="l00059"></a>00059 <span class="keyword">struct </span>format_data
<a name="l00060"></a>00060   {
<a name="l00061"></a>00061     <span class="keywordtype">int</span> count;
<a name="l00062"></a>00062     <span class="keywordtype">char</span> format;
<a name="l00063"></a>00063     <span class="keywordtype">char</span> <a class="code" href="go32-nat_8c.html#a854352f53b148adc24983a58a1866d66">size</a>;
<a name="l00064"></a>00064 
<a name="l00065"></a>00065     <span class="comment">/* True if the value should be printed raw -- that is, bypassing</span>
<a name="l00066"></a>00066 <span class="comment">       python-based formatters.  */</span>
<a name="l00067"></a>00067     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> raw;
<a name="l00068"></a>00068   };
<a name="l00069"></a>00069 
<a name="l00070"></a>00070 <span class="comment">/* Last specified output format.  */</span>
<a name="l00071"></a>00071 
<a name="l00072"></a>00072 <span class="keyword">static</span> <span class="keywordtype">char</span> last_format = 0;
<a name="l00073"></a>00073 
<a name="l00074"></a>00074 <span class="comment">/* Last specified examination size.  &#39;b&#39;, &#39;h&#39;, &#39;w&#39; or `q&#39;.  */</span>
<a name="l00075"></a>00075 
<a name="l00076"></a>00076 <span class="keyword">static</span> <span class="keywordtype">char</span> last_size = <span class="charliteral">&#39;w&#39;</span>;
<a name="l00077"></a>00077 
<a name="l00078"></a>00078 <span class="comment">/* Default address to examine next, and associated architecture.  */</span>
<a name="l00079"></a>00079 
<a name="l00080"></a>00080 <span class="keyword">static</span> <span class="keyword">struct </span>gdbarch *next_gdbarch;
<a name="l00081"></a>00081 <span class="keyword">static</span> <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> next_address;
<a name="l00082"></a>00082 
<a name="l00083"></a>00083 <span class="comment">/* Number of delay instructions following current disassembled insn.  */</span>
<a name="l00084"></a>00084 
<a name="l00085"></a>00085 <span class="keyword">static</span> <span class="keywordtype">int</span> branch_delay_insns;
<a name="l00086"></a>00086 
<a name="l00087"></a>00087 <span class="comment">/* Last address examined.  */</span>
<a name="l00088"></a>00088 
<a name="l00089"></a>00089 <span class="keyword">static</span> <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> last_examine_address;
<a name="l00090"></a>00090 
<a name="l00091"></a>00091 <span class="comment">/* Contents of last address examined.</span>
<a name="l00092"></a>00092 <span class="comment">   This is not valid past the end of the `x&#39; command!  */</span>
<a name="l00093"></a>00093 
<a name="l00094"></a>00094 <span class="keyword">static</span> <span class="keyword">struct </span>value *last_examine_value;
<a name="l00095"></a>00095 
<a name="l00096"></a>00096 <span class="comment">/* Largest offset between a symbolic value and an address, that will be</span>
<a name="l00097"></a>00097 <span class="comment">   printed as `0x1234 &lt;symbol+offset&gt;&#39;.  */</span>
<a name="l00098"></a>00098 
<a name="l00099"></a>00099 <span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> max_symbolic_offset = UINT_MAX;
<a name="l00100"></a>00100 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00101"></a>00101 show_max_symbolic_offset (<span class="keyword">struct</span> ui_file *file, <span class="keywordtype">int</span> from_tty,
<a name="l00102"></a>00102                           <span class="keyword">struct</span> <a class="code" href="structcmd__list__element.html">cmd_list_element</a> *c, <span class="keyword">const</span> <span class="keywordtype">char</span> *value)
<a name="l00103"></a>00103 {
<a name="l00104"></a>00104   <a class="code" href="utils_8c.html#aaa819b1a6c0b6c4090bdc0b027eaf64b">fprintf_filtered</a> (file,
<a name="l00105"></a>00105                     <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;The largest offset that will be &quot;</span>
<a name="l00106"></a>00106                       <span class="stringliteral">&quot;printed in &lt;symbol+1234&gt; form is %s.\n&quot;</span>),
<a name="l00107"></a>00107                     value);
<a name="l00108"></a>00108 }
<a name="l00109"></a>00109 
<a name="l00110"></a>00110 <span class="comment">/* Append the source filename and linenumber of the symbol when</span>
<a name="l00111"></a>00111 <span class="comment">   printing a symbolic value as `&lt;symbol at filename:linenum&gt;&#39; if set.  */</span>
<a name="l00112"></a>00112 <span class="keyword">static</span> <span class="keywordtype">int</span> print_symbol_filename = 0;
<a name="l00113"></a>00113 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00114"></a>00114 show_print_symbol_filename (<span class="keyword">struct</span> ui_file *file, <span class="keywordtype">int</span> from_tty,
<a name="l00115"></a>00115                             <span class="keyword">struct</span> <a class="code" href="structcmd__list__element.html">cmd_list_element</a> *c, <span class="keyword">const</span> <span class="keywordtype">char</span> *value)
<a name="l00116"></a>00116 {
<a name="l00117"></a>00117   <a class="code" href="utils_8c.html#aaa819b1a6c0b6c4090bdc0b027eaf64b">fprintf_filtered</a> (file, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Printing of source filename and &quot;</span>
<a name="l00118"></a>00118                             <span class="stringliteral">&quot;line number with &lt;symbol&gt; is %s.\n&quot;</span>),
<a name="l00119"></a>00119                     value);
<a name="l00120"></a>00120 }
<a name="l00121"></a>00121 
<a name="l00122"></a>00122 <span class="comment">/* Number of auto-display expression currently being displayed.</span>
<a name="l00123"></a>00123 <span class="comment">   So that we can disable it if we get a signal within it.</span>
<a name="l00124"></a>00124 <span class="comment">   -1 when not doing one.  */</span>
<a name="l00125"></a>00125 
<a name="l00126"></a>00126 <span class="keyword">static</span> <span class="keywordtype">int</span> current_display_number;
<a name="l00127"></a>00127 
<a name="l00128"></a>00128 <span class="keyword">struct </span>display
<a name="l00129"></a>00129   {
<a name="l00130"></a>00130     <span class="comment">/* Chain link to next auto-display item.  */</span>
<a name="l00131"></a>00131     <span class="keyword">struct </span>display *next;
<a name="l00132"></a>00132 
<a name="l00133"></a>00133     <span class="comment">/* The expression as the user typed it.  */</span>
<a name="l00134"></a>00134     <span class="keywordtype">char</span> *exp_string;
<a name="l00135"></a>00135 
<a name="l00136"></a>00136     <span class="comment">/* Expression to be evaluated and displayed.  */</span>
<a name="l00137"></a>00137     <span class="keyword">struct </span><a class="code" href="structexpression.html">expression</a> *exp;
<a name="l00138"></a>00138 
<a name="l00139"></a>00139     <span class="comment">/* Item number of this auto-display item.  */</span>
<a name="l00140"></a>00140     <span class="keywordtype">int</span> number;
<a name="l00141"></a>00141 
<a name="l00142"></a>00142     <span class="comment">/* Display format specified.  */</span>
<a name="l00143"></a>00143     <span class="keyword">struct </span>format_data format;
<a name="l00144"></a>00144 
<a name="l00145"></a>00145     <span class="comment">/* Program space associated with `block&#39;.  */</span>
<a name="l00146"></a>00146     <span class="keyword">struct </span><a class="code" href="structprogram__space.html">program_space</a> *pspace;
<a name="l00147"></a>00147 
<a name="l00148"></a>00148     <span class="comment">/* Innermost block required by this expression when evaluated.  */</span>
<a name="l00149"></a>00149     <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structblock.html">block</a> *<a class="code" href="structblock.html">block</a>;
<a name="l00150"></a>00150 
<a name="l00151"></a>00151     <span class="comment">/* Status of this display (enabled or disabled).  */</span>
<a name="l00152"></a>00152     <span class="keywordtype">int</span> enabled_p;
<a name="l00153"></a>00153   };
<a name="l00154"></a>00154 
<a name="l00155"></a>00155 <span class="comment">/* Chain of expressions whose values should be displayed</span>
<a name="l00156"></a>00156 <span class="comment">   automatically each time the program stops.  */</span>
<a name="l00157"></a>00157 
<a name="l00158"></a>00158 <span class="keyword">static</span> <span class="keyword">struct </span>display *display_chain;
<a name="l00159"></a>00159 
<a name="l00160"></a>00160 <span class="keyword">static</span> <span class="keywordtype">int</span> display_number;
<a name="l00161"></a>00161 
<a name="l00162"></a>00162 <span class="comment">/* Walk the following statement or block through all displays.</span>
<a name="l00163"></a>00163 <span class="comment">   ALL_DISPLAYS_SAFE does so even if the statement deletes the current</span>
<a name="l00164"></a>00164 <span class="comment">   display.  */</span>
<a name="l00165"></a>00165 
<a name="l00166"></a><a class="code" href="printcmd_8c.html#a60a8b7fbd6675e03f28c0f14bbffab2e">00166</a> <span class="preprocessor">#define ALL_DISPLAYS(B)                         \</span>
<a name="l00167"></a>00167 <span class="preprocessor">  for (B = display_chain; B; B = B-&gt;next)</span>
<a name="l00168"></a>00168 <span class="preprocessor"></span>
<a name="l00169"></a><a class="code" href="printcmd_8c.html#ad8c91345cffaa94ab0113700552d2d8c">00169</a> <span class="preprocessor">#define ALL_DISPLAYS_SAFE(B,TMP)                \</span>
<a name="l00170"></a>00170 <span class="preprocessor">  for (B = display_chain;                       \</span>
<a name="l00171"></a>00171 <span class="preprocessor">       B ? (TMP = B-&gt;next, 1): 0;               \</span>
<a name="l00172"></a>00172 <span class="preprocessor">       B = TMP)</span>
<a name="l00173"></a>00173 <span class="preprocessor"></span>
<a name="l00174"></a>00174 <span class="comment">/* Prototypes for exported functions.  */</span>
<a name="l00175"></a>00175 
<a name="l00176"></a>00176 <span class="keywordtype">void</span> <a class="code" href="init_8c.html#a4304dafa58ec82a3e93687ae1c7a76d2">_initialize_printcmd</a> (<span class="keywordtype">void</span>);
<a name="l00177"></a>00177 
<a name="l00178"></a>00178 <span class="comment">/* Prototypes for local functions.  */</span>
<a name="l00179"></a>00179 
<a name="l00180"></a>00180 <span class="keyword">static</span> <span class="keywordtype">void</span> do_one_display (<span class="keyword">struct</span> display *);
<a name="l00181"></a>00181 
<a name="l00182"></a>00182 
<a name="l00183"></a>00183 <span class="comment">/* Decode a format specification.  *STRING_PTR should point to it.</span>
<a name="l00184"></a>00184 <span class="comment">   OFORMAT and OSIZE are used as defaults for the format and size</span>
<a name="l00185"></a>00185 <span class="comment">   if none are given in the format specification.</span>
<a name="l00186"></a>00186 <span class="comment">   If OSIZE is zero, then the size field of the returned value</span>
<a name="l00187"></a>00187 <span class="comment">   should be set only if a size is explicitly specified by the</span>
<a name="l00188"></a>00188 <span class="comment">   user.</span>
<a name="l00189"></a>00189 <span class="comment">   The structure returned describes all the data</span>
<a name="l00190"></a>00190 <span class="comment">   found in the specification.  In addition, *STRING_PTR is advanced</span>
<a name="l00191"></a>00191 <span class="comment">   past the specification and past all whitespace following it.  */</span>
<a name="l00192"></a>00192 
<a name="l00193"></a>00193 <span class="keyword">static</span> <span class="keyword">struct </span>format_data
<a name="l00194"></a>00194 decode_format (<a class="code" href="p-lang_8h.html#a21296fc6f36ba2fc4d9780fdd126acb5">const</a> char **string_ptr, <span class="keywordtype">int</span> oformat, <span class="keywordtype">int</span> osize)
<a name="l00195"></a>00195 {
<a name="l00196"></a>00196   <span class="keyword">struct </span>format_data val;
<a name="l00197"></a>00197   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="windows-nat_8c.html#ade66e4ccafbc33b117610bbc0d85feb0">p</a> = *string_ptr;
<a name="l00198"></a>00198 
<a name="l00199"></a>00199   val.format = <span class="charliteral">&#39;?&#39;</span>;
<a name="l00200"></a>00200   val.size = <span class="charliteral">&#39;?&#39;</span>;
<a name="l00201"></a>00201   val.count = 1;
<a name="l00202"></a>00202   val.raw = 0;
<a name="l00203"></a>00203 
<a name="l00204"></a>00204   <span class="keywordflow">if</span> (*p &gt;= <span class="charliteral">&#39;0&#39;</span> &amp;&amp; *p &lt;= <span class="charliteral">&#39;9&#39;</span>)
<a name="l00205"></a>00205     val.count = atoi (p);
<a name="l00206"></a>00206   <span class="keywordflow">while</span> (*p &gt;= <span class="charliteral">&#39;0&#39;</span> &amp;&amp; *p &lt;= <span class="charliteral">&#39;9&#39;</span>)
<a name="l00207"></a>00207     p++;
<a name="l00208"></a>00208 
<a name="l00209"></a>00209   <span class="comment">/* Now process size or format letters that follow.  */</span>
<a name="l00210"></a>00210 
<a name="l00211"></a>00211   <span class="keywordflow">while</span> (1)
<a name="l00212"></a>00212     {
<a name="l00213"></a>00213       <span class="keywordflow">if</span> (*p == <span class="charliteral">&#39;b&#39;</span> || *p == <span class="charliteral">&#39;h&#39;</span> || *p == <span class="charliteral">&#39;w&#39;</span> || *p == <span class="charliteral">&#39;g&#39;</span>)
<a name="l00214"></a>00214         val.size = *p++;
<a name="l00215"></a>00215       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*p == <span class="charliteral">&#39;r&#39;</span>)
<a name="l00216"></a>00216         {
<a name="l00217"></a>00217           val.raw = 1;
<a name="l00218"></a>00218           p++;
<a name="l00219"></a>00219         }
<a name="l00220"></a>00220       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*p &gt;= <span class="charliteral">&#39;a&#39;</span> &amp;&amp; *p &lt;= <span class="charliteral">&#39;z&#39;</span>)
<a name="l00221"></a>00221         val.format = *p++;
<a name="l00222"></a>00222       <span class="keywordflow">else</span>
<a name="l00223"></a>00223         <span class="keywordflow">break</span>;
<a name="l00224"></a>00224     }
<a name="l00225"></a>00225 
<a name="l00226"></a>00226   <span class="keywordflow">while</span> (*p == <span class="charliteral">&#39; &#39;</span> || *p == <span class="charliteral">&#39;\t&#39;</span>)
<a name="l00227"></a>00227     p++;
<a name="l00228"></a>00228   *string_ptr = p;
<a name="l00229"></a>00229 
<a name="l00230"></a>00230   <span class="comment">/* Set defaults for format and size if not specified.  */</span>
<a name="l00231"></a>00231   <span class="keywordflow">if</span> (val.format == <span class="charliteral">&#39;?&#39;</span>)
<a name="l00232"></a>00232     {
<a name="l00233"></a>00233       <span class="keywordflow">if</span> (val.size == <span class="charliteral">&#39;?&#39;</span>)
<a name="l00234"></a>00234         {
<a name="l00235"></a>00235           <span class="comment">/* Neither has been specified.  */</span>
<a name="l00236"></a>00236           val.format = oformat;
<a name="l00237"></a>00237           val.size = osize;
<a name="l00238"></a>00238         }
<a name="l00239"></a>00239       <span class="keywordflow">else</span>
<a name="l00240"></a>00240         <span class="comment">/* If a size is specified, any format makes a reasonable</span>
<a name="l00241"></a>00241 <span class="comment">           default except &#39;i&#39;.  */</span>
<a name="l00242"></a>00242         val.format = oformat == <span class="charliteral">&#39;i&#39;</span> ? <span class="charliteral">&#39;x&#39;</span> : oformat;
<a name="l00243"></a>00243     }
<a name="l00244"></a>00244   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (val.size == <span class="charliteral">&#39;?&#39;</span>)
<a name="l00245"></a>00245     <span class="keywordflow">switch</span> (val.format)
<a name="l00246"></a>00246       {
<a name="l00247"></a>00247       <span class="keywordflow">case</span> <span class="charliteral">&#39;a&#39;</span>:
<a name="l00248"></a>00248         <span class="comment">/* Pick the appropriate size for an address.  This is deferred</span>
<a name="l00249"></a>00249 <span class="comment">           until do_examine when we know the actual architecture to use.</span>
<a name="l00250"></a>00250 <span class="comment">           A special size value of &#39;a&#39; is used to indicate this case.  */</span>
<a name="l00251"></a>00251         val.size = osize ? <span class="charliteral">&#39;a&#39;</span> : osize;
<a name="l00252"></a>00252         <span class="keywordflow">break</span>;
<a name="l00253"></a>00253       <span class="keywordflow">case</span> <span class="charliteral">&#39;f&#39;</span>:
<a name="l00254"></a>00254         <span class="comment">/* Floating point has to be word or giantword.  */</span>
<a name="l00255"></a>00255         <span class="keywordflow">if</span> (osize == <span class="charliteral">&#39;w&#39;</span> || osize == <span class="charliteral">&#39;g&#39;</span>)
<a name="l00256"></a>00256           val.size = osize;
<a name="l00257"></a>00257         <span class="keywordflow">else</span>
<a name="l00258"></a>00258           <span class="comment">/* Default it to giantword if the last used size is not</span>
<a name="l00259"></a>00259 <span class="comment">             appropriate.  */</span>
<a name="l00260"></a>00260           val.size = osize ? <span class="charliteral">&#39;g&#39;</span> : osize;
<a name="l00261"></a>00261         <span class="keywordflow">break</span>;
<a name="l00262"></a>00262       <span class="keywordflow">case</span> <span class="charliteral">&#39;c&#39;</span>:
<a name="l00263"></a>00263         <span class="comment">/* Characters default to one byte.  */</span>
<a name="l00264"></a>00264         val.size = osize ? <span class="charliteral">&#39;b&#39;</span> : osize;
<a name="l00265"></a>00265         <span class="keywordflow">break</span>;
<a name="l00266"></a>00266       <span class="keywordflow">case</span> <span class="charliteral">&#39;s&#39;</span>:
<a name="l00267"></a>00267         <span class="comment">/* Display strings with byte size chars unless explicitly</span>
<a name="l00268"></a>00268 <span class="comment">           specified.  */</span>
<a name="l00269"></a>00269         val.size = <span class="charliteral">&#39;\0&#39;</span>;
<a name="l00270"></a>00270         <span class="keywordflow">break</span>;
<a name="l00271"></a>00271 
<a name="l00272"></a>00272       <span class="keywordflow">default</span>:
<a name="l00273"></a>00273         <span class="comment">/* The default is the size most recently specified.  */</span>
<a name="l00274"></a>00274         val.size = osize;
<a name="l00275"></a>00275       }
<a name="l00276"></a>00276 
<a name="l00277"></a>00277   <span class="keywordflow">return</span> val;
<a name="l00278"></a>00278 }
<a name="l00279"></a>00279 
<a name="l00280"></a>00280 <span class="comment">/* Print value VAL on stream according to OPTIONS.</span>
<a name="l00281"></a>00281 <span class="comment">   Do not end with a newline.</span>
<a name="l00282"></a>00282 <span class="comment">   SIZE is the letter for the size of datum being printed.</span>
<a name="l00283"></a>00283 <span class="comment">   This is used to pad hex numbers so they line up.  SIZE is 0</span>
<a name="l00284"></a>00284 <span class="comment">   for print / output and set for examine.  */</span>
<a name="l00285"></a>00285 
<a name="l00286"></a>00286 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00287"></a>00287 print_formatted (<span class="keyword">struct</span> value *val, <span class="keywordtype">int</span> <a class="code" href="go32-nat_8c.html#a854352f53b148adc24983a58a1866d66">size</a>,
<a name="l00288"></a>00288                  <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structvalue__print__options.html">value_print_options</a> *options,
<a name="l00289"></a>00289                  <span class="keyword">struct</span> ui_file *stream)
<a name="l00290"></a>00290 {
<a name="l00291"></a>00291   <span class="keyword">struct </span><a class="code" href="structtype.html">type</a> *<a class="code" href="structtype.html">type</a> = <a class="code" href="gdbtypes_8c.html#a0bf29d7521d8a8b8735b9a259e380386">check_typedef</a> (<a class="code" href="value_8c.html#a263a4c0bee0b0df41074b952d3c121d0">value_type</a> (val));
<a name="l00292"></a>00292   <span class="keywordtype">int</span> <a class="code" href="exec_8h.html#a00f945351279d3c8935f13d2b9f9b808">len</a> = <a class="code" href="gdbtypes_8h.html#aeac33f868e763780094aec8a2dcb9a1a">TYPE_LENGTH</a> (type);
<a name="l00293"></a>00293 
<a name="l00294"></a>00294   <span class="keywordflow">if</span> (<a class="code" href="value_8h.html#a39f15e604dd7037545ce2774310b0cd5">VALUE_LVAL</a> (val) == <a class="code" href="defs_8h.html#aae40e9877f56980bf8fac75923a098aba04e4ffc3d93e9a0cdec974596a72c17e">lval_memory</a>)
<a name="l00295"></a>00295     next_address = <a class="code" href="value_8c.html#a64c795fa1a8854682b3b727025d0d31d">value_address</a> (val) + <a class="code" href="exec_8h.html#a00f945351279d3c8935f13d2b9f9b808">len</a>;
<a name="l00296"></a>00296 
<a name="l00297"></a>00297   <span class="keywordflow">if</span> (size)
<a name="l00298"></a>00298     {
<a name="l00299"></a>00299       <span class="keywordflow">switch</span> (options-&gt;<a class="code" href="structvalue__print__options.html#ad4c1267f3716389d2b1ce09fc2191e7b">format</a>)
<a name="l00300"></a>00300         {
<a name="l00301"></a>00301         <span class="keywordflow">case</span> <span class="charliteral">&#39;s&#39;</span>:
<a name="l00302"></a>00302           {
<a name="l00303"></a>00303             <span class="keyword">struct </span>type *elttype = <a class="code" href="value_8c.html#a263a4c0bee0b0df41074b952d3c121d0">value_type</a> (val);
<a name="l00304"></a>00304 
<a name="l00305"></a>00305             next_address = (<a class="code" href="value_8c.html#a64c795fa1a8854682b3b727025d0d31d">value_address</a> (val)
<a name="l00306"></a>00306                             + <a class="code" href="valprint_8c.html#a95c390f3325bc0a8a50068a6cf17d28c">val_print_string</a> (elttype, NULL,
<a name="l00307"></a>00307                                                 <a class="code" href="value_8c.html#a64c795fa1a8854682b3b727025d0d31d">value_address</a> (val), -1,
<a name="l00308"></a>00308                                                 stream, options) * <a class="code" href="exec_8h.html#a00f945351279d3c8935f13d2b9f9b808">len</a>);
<a name="l00309"></a>00309           }
<a name="l00310"></a>00310           <span class="keywordflow">return</span>;
<a name="l00311"></a>00311 
<a name="l00312"></a>00312         <span class="keywordflow">case</span> <span class="charliteral">&#39;i&#39;</span>:
<a name="l00313"></a>00313           <span class="comment">/* We often wrap here if there are long symbolic names.  */</span>
<a name="l00314"></a>00314           <a class="code" href="utils_8c.html#a857540a17ef1cd62fef4a33cc3b6a894">wrap_here</a> (<span class="stringliteral">&quot;    &quot;</span>);
<a name="l00315"></a>00315           next_address = (<a class="code" href="value_8c.html#a64c795fa1a8854682b3b727025d0d31d">value_address</a> (val)
<a name="l00316"></a>00316                           + <a class="code" href="disasm_8c.html#a4c61d181d14061ce83b618f475087f77">gdb_print_insn</a> (<a class="code" href="gdbtypes_8c.html#a84ca61a6d58c2bd2c7dcedf19d56a39d">get_type_arch</a> (type),
<a name="l00317"></a>00317                                             <a class="code" href="value_8c.html#a64c795fa1a8854682b3b727025d0d31d">value_address</a> (val), stream,
<a name="l00318"></a>00318                                             &amp;branch_delay_insns));
<a name="l00319"></a>00319           <span class="keywordflow">return</span>;
<a name="l00320"></a>00320         }
<a name="l00321"></a>00321     }
<a name="l00322"></a>00322 
<a name="l00323"></a>00323   <span class="keywordflow">if</span> (options-&gt;<a class="code" href="structvalue__print__options.html#ad4c1267f3716389d2b1ce09fc2191e7b">format</a> == 0 || options-&gt;<a class="code" href="structvalue__print__options.html#ad4c1267f3716389d2b1ce09fc2191e7b">format</a> == <span class="charliteral">&#39;s&#39;</span>
<a name="l00324"></a>00324       || <a class="code" href="gdbtypes_8h.html#a9505f41c7012665947c6b4065ce190e1">TYPE_CODE</a> (type) == <a class="code" href="gdbtypes_8h.html#a90e2a0fddaa6afff6a0a489ff4da3462a476430709e5a251f7e0f8e3fb48a713f">TYPE_CODE_REF</a>
<a name="l00325"></a>00325       || <a class="code" href="gdbtypes_8h.html#a9505f41c7012665947c6b4065ce190e1">TYPE_CODE</a> (type) == <a class="code" href="gdbtypes_8h.html#a90e2a0fddaa6afff6a0a489ff4da3462a00c795b43d1a39f57d3e222385f14fc0">TYPE_CODE_ARRAY</a>
<a name="l00326"></a>00326       || <a class="code" href="gdbtypes_8h.html#a9505f41c7012665947c6b4065ce190e1">TYPE_CODE</a> (type) == <a class="code" href="gdbtypes_8h.html#a90e2a0fddaa6afff6a0a489ff4da3462a956ce01e5c83060e05208c9404fedca2">TYPE_CODE_STRING</a>
<a name="l00327"></a>00327       || <a class="code" href="gdbtypes_8h.html#a9505f41c7012665947c6b4065ce190e1">TYPE_CODE</a> (type) == <a class="code" href="gdbtypes_8h.html#a90e2a0fddaa6afff6a0a489ff4da3462af3b3fc76f66c95e12946c0ef84409365">TYPE_CODE_STRUCT</a>
<a name="l00328"></a>00328       || <a class="code" href="gdbtypes_8h.html#a9505f41c7012665947c6b4065ce190e1">TYPE_CODE</a> (type) == <a class="code" href="gdbtypes_8h.html#a90e2a0fddaa6afff6a0a489ff4da3462a8c3218d2f780665395d57dcd4d909191">TYPE_CODE_UNION</a>
<a name="l00329"></a>00329       || <a class="code" href="gdbtypes_8h.html#a9505f41c7012665947c6b4065ce190e1">TYPE_CODE</a> (type) == <a class="code" href="gdbtypes_8h.html#a90e2a0fddaa6afff6a0a489ff4da3462ae5cdf73186d3029211503380f64949b6">TYPE_CODE_NAMESPACE</a>)
<a name="l00330"></a>00330     <a class="code" href="valprint_8c.html#a1e41c7430a7b838beec1717ced3e9d94">value_print</a> (val, stream, options);
<a name="l00331"></a>00331   <span class="keywordflow">else</span>
<a name="l00332"></a>00332     <span class="comment">/* User specified format, so don&#39;t look to the type to tell us</span>
<a name="l00333"></a>00333 <span class="comment">       what to do.  */</span>
<a name="l00334"></a>00334     <a class="code" href="valprint_8c.html#add7cf84e5468bf56b55687f69f5c0fde">val_print_scalar_formatted</a> (type,
<a name="l00335"></a>00335                                 <a class="code" href="value_8c.html#a77fb759fae03d1a1c2a4e1500aa13adb">value_contents_for_printing</a> (val),
<a name="l00336"></a>00336                                 <a class="code" href="value_8c.html#acbd6146ab9bd4c54f994a895a66f3f3d">value_embedded_offset</a> (val),
<a name="l00337"></a>00337                                 val,
<a name="l00338"></a>00338                                 options, size, stream);
<a name="l00339"></a>00339 }
<a name="l00340"></a>00340 
<a name="l00341"></a>00341 <span class="comment">/* Return builtin floating point type of same length as TYPE.</span>
<a name="l00342"></a>00342 <span class="comment">   If no such type is found, return TYPE itself.  */</span>
<a name="l00343"></a>00343 <span class="keyword">static</span> <span class="keyword">struct </span>type *
<a name="l00344"></a>00344 float_type_from_length (<span class="keyword">struct</span> type *type)
<a name="l00345"></a>00345 {
<a name="l00346"></a>00346   <span class="keyword">struct </span>gdbarch *gdbarch = <a class="code" href="gdbtypes_8c.html#a84ca61a6d58c2bd2c7dcedf19d56a39d">get_type_arch</a> (type);
<a name="l00347"></a>00347   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structbuiltin__type.html">builtin_type</a> *builtin = <a class="code" href="gdbtypes_8c.html#addd01ebc9ccdf2cacb33ab01e281ddb8">builtin_type</a> (gdbarch);
<a name="l00348"></a>00348 
<a name="l00349"></a>00349   <span class="keywordflow">if</span> (<a class="code" href="gdbtypes_8h.html#aeac33f868e763780094aec8a2dcb9a1a">TYPE_LENGTH</a> (type) == <a class="code" href="gdbtypes_8h.html#aeac33f868e763780094aec8a2dcb9a1a">TYPE_LENGTH</a> (builtin-&gt;<a class="code" href="structbuiltin__type.html#af44abaec1868fa0a34efaab02a436d6a">builtin_float</a>))
<a name="l00350"></a>00350     type = builtin-&gt;<a class="code" href="structbuiltin__type.html#af44abaec1868fa0a34efaab02a436d6a">builtin_float</a>;
<a name="l00351"></a>00351   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="gdbtypes_8h.html#aeac33f868e763780094aec8a2dcb9a1a">TYPE_LENGTH</a> (type) == <a class="code" href="gdbtypes_8h.html#aeac33f868e763780094aec8a2dcb9a1a">TYPE_LENGTH</a> (builtin-&gt;<a class="code" href="structbuiltin__type.html#a29f1e28c1aa70321c4c7d4094f672b57">builtin_double</a>))
<a name="l00352"></a>00352     type = builtin-&gt;<a class="code" href="structbuiltin__type.html#a29f1e28c1aa70321c4c7d4094f672b57">builtin_double</a>;
<a name="l00353"></a>00353   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="gdbtypes_8h.html#aeac33f868e763780094aec8a2dcb9a1a">TYPE_LENGTH</a> (type) == <a class="code" href="gdbtypes_8h.html#aeac33f868e763780094aec8a2dcb9a1a">TYPE_LENGTH</a> (builtin-&gt;<a class="code" href="structbuiltin__type.html#a715dea24631a6825a39dbb26d85c87f5">builtin_long_double</a>))
<a name="l00354"></a>00354     type = builtin-&gt;<a class="code" href="structbuiltin__type.html#a715dea24631a6825a39dbb26d85c87f5">builtin_long_double</a>;
<a name="l00355"></a>00355 
<a name="l00356"></a>00356   <span class="keywordflow">return</span> type;
<a name="l00357"></a>00357 }
<a name="l00358"></a>00358 
<a name="l00359"></a>00359 <span class="comment">/* Print a scalar of data of type TYPE, pointed to in GDB by VALADDR,</span>
<a name="l00360"></a>00360 <span class="comment">   according to OPTIONS and SIZE on STREAM.  Formats s and i are not</span>
<a name="l00361"></a>00361 <span class="comment">   supported at this level.  */</span>
<a name="l00362"></a>00362 
<a name="l00363"></a>00363 <span class="keywordtype">void</span>
<a name="l00364"></a><a class="code" href="printcmd_8c.html#acfc4f9e8c338b911eceefa5d1c1e64c3">00364</a> <a class="code" href="gdbtypes_8h.html#a7b01a75e18ea7083fc6abaebc996f70e">print_scalar_formatted</a> (<span class="keyword">const</span> <span class="keywordtype">void</span> *valaddr, <span class="keyword">struct</span> type *type,
<a name="l00365"></a>00365                         <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structvalue__print__options.html">value_print_options</a> *options,
<a name="l00366"></a>00366                         <span class="keywordtype">int</span> size, <span class="keyword">struct</span> ui_file *stream)
<a name="l00367"></a>00367 {
<a name="l00368"></a>00368   <span class="keyword">struct </span>gdbarch *gdbarch = <a class="code" href="gdbtypes_8c.html#a84ca61a6d58c2bd2c7dcedf19d56a39d">get_type_arch</a> (type);
<a name="l00369"></a>00369   <a class="code" href="defs_8h.html#ac7647a3f71533007c9e128f3ddda1987">LONGEST</a> val_long = 0;
<a name="l00370"></a>00370   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> len = <a class="code" href="gdbtypes_8h.html#aeac33f868e763780094aec8a2dcb9a1a">TYPE_LENGTH</a> (type);
<a name="l00371"></a>00371   <span class="keyword">enum</span> bfd_endian byte_order = <a class="code" href="gdbarch_8c.html#abc300a3797421aa7342b288e1637483e">gdbarch_byte_order</a> (gdbarch);
<a name="l00372"></a>00372 
<a name="l00373"></a>00373   <span class="comment">/* String printing should go through val_print_scalar_formatted.  */</span>
<a name="l00374"></a>00374   <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (options-&gt;<a class="code" href="structvalue__print__options.html#ad4c1267f3716389d2b1ce09fc2191e7b">format</a> != <span class="charliteral">&#39;s&#39;</span>);
<a name="l00375"></a>00375 
<a name="l00376"></a>00376   <span class="keywordflow">if</span> (len &gt; <span class="keyword">sizeof</span>(<a class="code" href="defs_8h.html#ac7647a3f71533007c9e128f3ddda1987">LONGEST</a>) &amp;&amp;
<a name="l00377"></a>00377       (<a class="code" href="gdbtypes_8h.html#a9505f41c7012665947c6b4065ce190e1">TYPE_CODE</a> (type) == <a class="code" href="gdbtypes_8h.html#a90e2a0fddaa6afff6a0a489ff4da3462a7071a71840688811b992838bb09d0ddd">TYPE_CODE_INT</a>
<a name="l00378"></a>00378        || <a class="code" href="gdbtypes_8h.html#a9505f41c7012665947c6b4065ce190e1">TYPE_CODE</a> (type) == <a class="code" href="gdbtypes_8h.html#a90e2a0fddaa6afff6a0a489ff4da3462a1afbc1e8f69012b205070a3b5eac7217">TYPE_CODE_ENUM</a>))
<a name="l00379"></a>00379     {
<a name="l00380"></a>00380       <span class="keywordflow">switch</span> (options-&gt;<a class="code" href="structvalue__print__options.html#ad4c1267f3716389d2b1ce09fc2191e7b">format</a>)
<a name="l00381"></a>00381         {
<a name="l00382"></a>00382         <span class="keywordflow">case</span> <span class="charliteral">&#39;o&#39;</span>:
<a name="l00383"></a>00383           <a class="code" href="valprint_8c.html#a4184cce917790f20f9e448c0cb9abb56">print_octal_chars</a> (stream, valaddr, len, byte_order);
<a name="l00384"></a>00384           <span class="keywordflow">return</span>;
<a name="l00385"></a>00385         <span class="keywordflow">case</span> <span class="charliteral">&#39;u&#39;</span>:
<a name="l00386"></a>00386         <span class="keywordflow">case</span> <span class="charliteral">&#39;d&#39;</span>:
<a name="l00387"></a>00387           <a class="code" href="valprint_8c.html#a59b35a27f958e78ca02ac0113229f287">print_decimal_chars</a> (stream, valaddr, len, byte_order);
<a name="l00388"></a>00388           <span class="keywordflow">return</span>;
<a name="l00389"></a>00389         <span class="keywordflow">case</span> <span class="charliteral">&#39;t&#39;</span>:
<a name="l00390"></a>00390           <a class="code" href="valprint_8c.html#a0ae8b2e02f39f34963478f9b2c276614">print_binary_chars</a> (stream, valaddr, len, byte_order);
<a name="l00391"></a>00391           <span class="keywordflow">return</span>;
<a name="l00392"></a>00392         <span class="keywordflow">case</span> <span class="charliteral">&#39;x&#39;</span>:
<a name="l00393"></a>00393           <a class="code" href="valprint_8c.html#a241fbeb52f8f44e9b5ee23ae2f42b63d">print_hex_chars</a> (stream, valaddr, len, byte_order);
<a name="l00394"></a>00394           <span class="keywordflow">return</span>;
<a name="l00395"></a>00395         <span class="keywordflow">case</span> <span class="charliteral">&#39;c&#39;</span>:
<a name="l00396"></a>00396           <a class="code" href="valprint_8c.html#a8a85a4a1501b864c8c8f502a69c37548">print_char_chars</a> (stream, type, valaddr, len, byte_order);
<a name="l00397"></a>00397           <span class="keywordflow">return</span>;
<a name="l00398"></a>00398         <span class="keywordflow">default</span>:
<a name="l00399"></a>00399           <span class="keywordflow">break</span>;
<a name="l00400"></a>00400         };
<a name="l00401"></a>00401     }
<a name="l00402"></a>00402 
<a name="l00403"></a>00403   <span class="keywordflow">if</span> (options-&gt;<a class="code" href="structvalue__print__options.html#ad4c1267f3716389d2b1ce09fc2191e7b">format</a> != <span class="charliteral">&#39;f&#39;</span>)
<a name="l00404"></a>00404     val_long = <a class="code" href="value_8c.html#af8ee32c3e2a2e1cd7cdfe92be37a759f">unpack_long</a> (type, valaddr);
<a name="l00405"></a>00405 
<a name="l00406"></a>00406   <span class="comment">/* If the value is a pointer, and pointers and addresses are not the</span>
<a name="l00407"></a>00407 <span class="comment">     same, then at this point, the value&#39;s length (in target bytes) is</span>
<a name="l00408"></a>00408 <span class="comment">     gdbarch_addr_bit/TARGET_CHAR_BIT, not TYPE_LENGTH (type).  */</span>
<a name="l00409"></a>00409   <span class="keywordflow">if</span> (<a class="code" href="gdbtypes_8h.html#a9505f41c7012665947c6b4065ce190e1">TYPE_CODE</a> (type) == <a class="code" href="gdbtypes_8h.html#a90e2a0fddaa6afff6a0a489ff4da3462a1a639160f3e3a2f9f7ac55255942c581">TYPE_CODE_PTR</a>)
<a name="l00410"></a>00410     len = <a class="code" href="gdbarch_8c.html#a3ee335ac98782b6633ab7fc235182cc9">gdbarch_addr_bit</a> (gdbarch) / TARGET_CHAR_BIT;
<a name="l00411"></a>00411 
<a name="l00412"></a>00412   <span class="comment">/* If we are printing it as unsigned, truncate it in case it is actually</span>
<a name="l00413"></a>00413 <span class="comment">     a negative signed value (e.g. &quot;print/u (short)-1&quot; should print 65535</span>
<a name="l00414"></a>00414 <span class="comment">     (if shorts are 16 bits) instead of 4294967295).  */</span>
<a name="l00415"></a>00415   <span class="keywordflow">if</span> (options-&gt;<a class="code" href="structvalue__print__options.html#ad4c1267f3716389d2b1ce09fc2191e7b">format</a> != <span class="charliteral">&#39;d&#39;</span> || <a class="code" href="gdbtypes_8h.html#a124c6ba3c6519f8a6ea57495d2f5f7f7">TYPE_UNSIGNED</a> (type))
<a name="l00416"></a>00416     {
<a name="l00417"></a>00417       <span class="keywordflow">if</span> (len &lt; <span class="keyword">sizeof</span> (<a class="code" href="defs_8h.html#ac7647a3f71533007c9e128f3ddda1987">LONGEST</a>))
<a name="l00418"></a>00418         val_long &amp;= ((<a class="code" href="defs_8h.html#ac7647a3f71533007c9e128f3ddda1987">LONGEST</a>) 1 &lt;&lt; <a class="code" href="defs_8h.html#a02f9a4c6bafd89c95ba34f80a750eff8">HOST_CHAR_BIT</a> * len) - 1;
<a name="l00419"></a>00419     }
<a name="l00420"></a>00420 
<a name="l00421"></a>00421   <span class="keywordflow">switch</span> (options-&gt;<a class="code" href="structvalue__print__options.html#ad4c1267f3716389d2b1ce09fc2191e7b">format</a>)
<a name="l00422"></a>00422     {
<a name="l00423"></a>00423     <span class="keywordflow">case</span> <span class="charliteral">&#39;x&#39;</span>:
<a name="l00424"></a>00424       <span class="keywordflow">if</span> (!size)
<a name="l00425"></a>00425         {
<a name="l00426"></a>00426           <span class="comment">/* No size specified, like in print.  Print varying # of digits.  */</span>
<a name="l00427"></a>00427           <a class="code" href="valprint_8c.html#ac70fad20415854638c3ccdea72016401">print_longest</a> (stream, <span class="charliteral">&#39;x&#39;</span>, 1, val_long);
<a name="l00428"></a>00428         }
<a name="l00429"></a>00429       <span class="keywordflow">else</span>
<a name="l00430"></a>00430         <span class="keywordflow">switch</span> (size)
<a name="l00431"></a>00431           {
<a name="l00432"></a>00432           <span class="keywordflow">case</span> <span class="charliteral">&#39;b&#39;</span>:
<a name="l00433"></a>00433           <span class="keywordflow">case</span> <span class="charliteral">&#39;h&#39;</span>:
<a name="l00434"></a>00434           <span class="keywordflow">case</span> <span class="charliteral">&#39;w&#39;</span>:
<a name="l00435"></a>00435           <span class="keywordflow">case</span> <span class="charliteral">&#39;g&#39;</span>:
<a name="l00436"></a>00436             <a class="code" href="valprint_8c.html#ac70fad20415854638c3ccdea72016401">print_longest</a> (stream, size, 1, val_long);
<a name="l00437"></a>00437             <span class="keywordflow">break</span>;
<a name="l00438"></a>00438           <span class="keywordflow">default</span>:
<a name="l00439"></a>00439             <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Undefined output size \&quot;%c\&quot;.&quot;</span>), size);
<a name="l00440"></a>00440           }
<a name="l00441"></a>00441       <span class="keywordflow">break</span>;
<a name="l00442"></a>00442 
<a name="l00443"></a>00443     <span class="keywordflow">case</span> <span class="charliteral">&#39;d&#39;</span>:
<a name="l00444"></a>00444       <a class="code" href="valprint_8c.html#ac70fad20415854638c3ccdea72016401">print_longest</a> (stream, <span class="charliteral">&#39;d&#39;</span>, 1, val_long);
<a name="l00445"></a>00445       <span class="keywordflow">break</span>;
<a name="l00446"></a>00446 
<a name="l00447"></a>00447     <span class="keywordflow">case</span> <span class="charliteral">&#39;u&#39;</span>:
<a name="l00448"></a>00448       <a class="code" href="valprint_8c.html#ac70fad20415854638c3ccdea72016401">print_longest</a> (stream, <span class="charliteral">&#39;u&#39;</span>, 0, val_long);
<a name="l00449"></a>00449       <span class="keywordflow">break</span>;
<a name="l00450"></a>00450 
<a name="l00451"></a>00451     <span class="keywordflow">case</span> <span class="charliteral">&#39;o&#39;</span>:
<a name="l00452"></a>00452       <span class="keywordflow">if</span> (val_long)
<a name="l00453"></a>00453         <a class="code" href="valprint_8c.html#ac70fad20415854638c3ccdea72016401">print_longest</a> (stream, <span class="charliteral">&#39;o&#39;</span>, 1, val_long);
<a name="l00454"></a>00454       <span class="keywordflow">else</span>
<a name="l00455"></a>00455         <a class="code" href="utils_8c.html#aaa819b1a6c0b6c4090bdc0b027eaf64b">fprintf_filtered</a> (stream, <span class="stringliteral">&quot;0&quot;</span>);
<a name="l00456"></a>00456       <span class="keywordflow">break</span>;
<a name="l00457"></a>00457 
<a name="l00458"></a>00458     <span class="keywordflow">case</span> <span class="charliteral">&#39;a&#39;</span>:
<a name="l00459"></a>00459       {
<a name="l00460"></a>00460         <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> addr = <a class="code" href="value_8c.html#a2deecf78d27717c4ed9fd8bf0f7d0715">unpack_pointer</a> (type, valaddr);
<a name="l00461"></a>00461 
<a name="l00462"></a>00462         <a class="code" href="defs_8h.html#ac859be6d454d5718fb6faf3bd34fc27e">print_address</a> (gdbarch, addr, stream);
<a name="l00463"></a>00463       }
<a name="l00464"></a>00464       <span class="keywordflow">break</span>;
<a name="l00465"></a>00465 
<a name="l00466"></a>00466     <span class="keywordflow">case</span> <span class="charliteral">&#39;c&#39;</span>:
<a name="l00467"></a>00467       {
<a name="l00468"></a>00468         <span class="keyword">struct </span><a class="code" href="structvalue__print__options.html">value_print_options</a> opts = *options;
<a name="l00469"></a>00469 
<a name="l00470"></a>00470         opts.<a class="code" href="structvalue__print__options.html#ad4c1267f3716389d2b1ce09fc2191e7b">format</a> = 0;
<a name="l00471"></a>00471         <span class="keywordflow">if</span> (<a class="code" href="gdbtypes_8h.html#a124c6ba3c6519f8a6ea57495d2f5f7f7">TYPE_UNSIGNED</a> (type))
<a name="l00472"></a>00472           type = <a class="code" href="gdbtypes_8c.html#addd01ebc9ccdf2cacb33ab01e281ddb8">builtin_type</a> (gdbarch)-&gt;<a class="code" href="structbuiltin__type.html#a62b7c7c269c00894245a60e10403a41e">builtin_true_unsigned_char</a>;
<a name="l00473"></a>00473         <span class="keywordflow">else</span>
<a name="l00474"></a>00474           type = <a class="code" href="gdbtypes_8c.html#addd01ebc9ccdf2cacb33ab01e281ddb8">builtin_type</a> (gdbarch)-&gt;<a class="code" href="structbuiltin__type.html#afe4574015ae6bc9b3ee2c1a8c5440e87">builtin_true_char</a>;
<a name="l00475"></a>00475 
<a name="l00476"></a>00476         <a class="code" href="valprint_8c.html#a1e41c7430a7b838beec1717ced3e9d94">value_print</a> (<a class="code" href="value_8c.html#a194b41f9d10ade20e32daff64b4ae03c">value_from_longest</a> (type, val_long), stream, &amp;opts);
<a name="l00477"></a>00477       }
<a name="l00478"></a>00478       <span class="keywordflow">break</span>;
<a name="l00479"></a>00479 
<a name="l00480"></a>00480     <span class="keywordflow">case</span> <span class="charliteral">&#39;f&#39;</span>:
<a name="l00481"></a>00481       type = float_type_from_length (type);
<a name="l00482"></a>00482       <a class="code" href="valprint_8c.html#abf1df9805a858cd6c82565aa67a681f1">print_floating</a> (valaddr, type, stream);
<a name="l00483"></a>00483       <span class="keywordflow">break</span>;
<a name="l00484"></a>00484 
<a name="l00485"></a>00485     <span class="keywordflow">case</span> 0:
<a name="l00486"></a>00486       <a class="code" href="common-utils_8h.html#aa14285d9d3d4171016ef9cf09447e8bb">internal_error</a> (__FILE__, __LINE__,
<a name="l00487"></a>00487                       <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;failed internal consistency check&quot;</span>));
<a name="l00488"></a>00488 
<a name="l00489"></a>00489     <span class="keywordflow">case</span> <span class="charliteral">&#39;t&#39;</span>:
<a name="l00490"></a>00490       <span class="comment">/* Binary; &#39;t&#39; stands for &quot;two&quot;.  */</span>
<a name="l00491"></a>00491       {
<a name="l00492"></a>00492         <span class="keywordtype">char</span> <a class="code" href="arm-tdep_8c.html#a6d53921cd0f216408c4aed2806a0cb1f">bits</a>[8 * (<span class="keyword">sizeof</span> val_long) + 1];
<a name="l00493"></a>00493         <span class="keywordtype">char</span> buf[8 * (<span class="keyword">sizeof</span> val_long) + 32];
<a name="l00494"></a>00494         <span class="keywordtype">char</span> *cp = <a class="code" href="arm-tdep_8c.html#a6d53921cd0f216408c4aed2806a0cb1f">bits</a>;
<a name="l00495"></a>00495         <span class="keywordtype">int</span> width;
<a name="l00496"></a>00496 
<a name="l00497"></a>00497         <span class="keywordflow">if</span> (!size)
<a name="l00498"></a>00498           width = 8 * (<span class="keyword">sizeof</span> val_long);
<a name="l00499"></a>00499         <span class="keywordflow">else</span>
<a name="l00500"></a>00500           <span class="keywordflow">switch</span> (size)
<a name="l00501"></a>00501             {
<a name="l00502"></a>00502             <span class="keywordflow">case</span> <span class="charliteral">&#39;b&#39;</span>:
<a name="l00503"></a>00503               width = 8;
<a name="l00504"></a>00504               <span class="keywordflow">break</span>;
<a name="l00505"></a>00505             <span class="keywordflow">case</span> <span class="charliteral">&#39;h&#39;</span>:
<a name="l00506"></a>00506               width = 16;
<a name="l00507"></a>00507               <span class="keywordflow">break</span>;
<a name="l00508"></a>00508             <span class="keywordflow">case</span> <span class="charliteral">&#39;w&#39;</span>:
<a name="l00509"></a>00509               width = 32;
<a name="l00510"></a>00510               <span class="keywordflow">break</span>;
<a name="l00511"></a>00511             <span class="keywordflow">case</span> <span class="charliteral">&#39;g&#39;</span>:
<a name="l00512"></a>00512               width = 64;
<a name="l00513"></a>00513               <span class="keywordflow">break</span>;
<a name="l00514"></a>00514             <span class="keywordflow">default</span>:
<a name="l00515"></a>00515               <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Undefined output size \&quot;%c\&quot;.&quot;</span>), size);
<a name="l00516"></a>00516             }
<a name="l00517"></a>00517 
<a name="l00518"></a>00518         <a class="code" href="arm-tdep_8c.html#a6d53921cd0f216408c4aed2806a0cb1f">bits</a>[width] = <span class="charliteral">&#39;\0&#39;</span>;
<a name="l00519"></a>00519         <span class="keywordflow">while</span> (width-- &gt; 0)
<a name="l00520"></a>00520           {
<a name="l00521"></a>00521             <a class="code" href="arm-tdep_8c.html#a6d53921cd0f216408c4aed2806a0cb1f">bits</a>[width] = (val_long &amp; 1) ? <span class="charliteral">&#39;1&#39;</span> : <span class="charliteral">&#39;0&#39;</span>;
<a name="l00522"></a>00522             val_long &gt;&gt;= 1;
<a name="l00523"></a>00523           }
<a name="l00524"></a>00524         <span class="keywordflow">if</span> (!size)
<a name="l00525"></a>00525           {
<a name="l00526"></a>00526             <span class="keywordflow">while</span> (*cp &amp;&amp; *cp == <span class="charliteral">&#39;0&#39;</span>)
<a name="l00527"></a>00527               cp++;
<a name="l00528"></a>00528             <span class="keywordflow">if</span> (*cp == <span class="charliteral">&#39;\0&#39;</span>)
<a name="l00529"></a>00529               cp--;
<a name="l00530"></a>00530           }
<a name="l00531"></a>00531         strncpy (buf, cp, <span class="keyword">sizeof</span> (<a class="code" href="arm-tdep_8c.html#a6d53921cd0f216408c4aed2806a0cb1f">bits</a>));
<a name="l00532"></a>00532         <a class="code" href="utils_8c.html#a4b28488051faf9ab4a2f07633225835f">fputs_filtered</a> (buf, stream);
<a name="l00533"></a>00533       }
<a name="l00534"></a>00534       <span class="keywordflow">break</span>;
<a name="l00535"></a>00535 
<a name="l00536"></a>00536     <span class="keywordflow">case</span> <span class="charliteral">&#39;z&#39;</span>:
<a name="l00537"></a>00537       <a class="code" href="valprint_8c.html#a241fbeb52f8f44e9b5ee23ae2f42b63d">print_hex_chars</a> (stream, valaddr, len, byte_order);
<a name="l00538"></a>00538       <span class="keywordflow">break</span>;
<a name="l00539"></a>00539 
<a name="l00540"></a>00540     <span class="keywordflow">default</span>:
<a name="l00541"></a>00541       <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Undefined output format \&quot;%c\&quot;.&quot;</span>), options-&gt;<a class="code" href="structvalue__print__options.html#ad4c1267f3716389d2b1ce09fc2191e7b">format</a>);
<a name="l00542"></a>00542     }
<a name="l00543"></a>00543 }
<a name="l00544"></a>00544 
<a name="l00545"></a>00545 <span class="comment">/* Specify default address for `x&#39; command.</span>
<a name="l00546"></a>00546 <span class="comment">   The `info lines&#39; command uses this.  */</span>
<a name="l00547"></a>00547 
<a name="l00548"></a>00548 <span class="keywordtype">void</span>
<a name="l00549"></a><a class="code" href="printcmd_8c.html#a162f6ecdae9b4fd3fbbf617d1e3ffadd">00549</a> <a class="code" href="defs_8h.html#a55e0332ed07e2318daf35ed1ee2ffba7">set_next_address</a> (<span class="keyword">struct</span> gdbarch *gdbarch, <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> addr)
<a name="l00550"></a>00550 {
<a name="l00551"></a>00551   <span class="keyword">struct </span>type *ptr_type = <a class="code" href="gdbtypes_8c.html#addd01ebc9ccdf2cacb33ab01e281ddb8">builtin_type</a> (gdbarch)-&gt;<a class="code" href="structbuiltin__type.html#a55f6f9ff7436431777683d8ba62f662a">builtin_data_ptr</a>;
<a name="l00552"></a>00552 
<a name="l00553"></a>00553   next_gdbarch = gdbarch;
<a name="l00554"></a>00554   next_address = addr;
<a name="l00555"></a>00555 
<a name="l00556"></a>00556   <span class="comment">/* Make address available to the user as $_.  */</span>
<a name="l00557"></a>00557   <a class="code" href="value_8c.html#a8e5fd3bd77e20876ececbe85d2c8b568">set_internalvar</a> (<a class="code" href="value_8c.html#ac96b41b37d2b8eeb44137ec148ca5c7c">lookup_internalvar</a> (<span class="stringliteral">&quot;_&quot;</span>),
<a name="l00558"></a>00558                    <a class="code" href="value_8c.html#a2f2d0d3d3ce482fc844f1fc4dc4c038e">value_from_pointer</a> (ptr_type, addr));
<a name="l00559"></a>00559 }
<a name="l00560"></a>00560 
<a name="l00561"></a>00561 <span class="comment">/* Optionally print address ADDR symbolically as &lt;SYMBOL+OFFSET&gt; on STREAM,</span>
<a name="l00562"></a>00562 <span class="comment">   after LEADIN.  Print nothing if no symbolic name is found nearby.</span>
<a name="l00563"></a>00563 <span class="comment">   Optionally also print source file and line number, if available.</span>
<a name="l00564"></a>00564 <span class="comment">   DO_DEMANGLE controls whether to print a symbol in its native &quot;raw&quot; form,</span>
<a name="l00565"></a>00565 <span class="comment">   or to interpret it as a possible C++ name and convert it back to source</span>
<a name="l00566"></a>00566 <span class="comment">   form.  However note that DO_DEMANGLE can be overridden by the specific</span>
<a name="l00567"></a>00567 <span class="comment">   settings of the demangle and asm_demangle variables.  Returns</span>
<a name="l00568"></a>00568 <span class="comment">   non-zero if anything was printed; zero otherwise.  */</span>
<a name="l00569"></a>00569 
<a name="l00570"></a>00570 <span class="keywordtype">int</span>
<a name="l00571"></a><a class="code" href="printcmd_8c.html#ae94398f98605abb8447316c99e196853">00571</a> <a class="code" href="defs_8h.html#a8337015171b8b8e4f281dfcecdd510f6">print_address_symbolic</a> (<span class="keyword">struct</span> gdbarch *gdbarch, <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> addr,
<a name="l00572"></a>00572                         <span class="keyword">struct</span> ui_file *stream,
<a name="l00573"></a>00573                         <span class="keywordtype">int</span> do_demangle, <span class="keywordtype">char</span> *leadin)
<a name="l00574"></a>00574 {
<a name="l00575"></a>00575   <span class="keywordtype">char</span> *<a class="code" href="aarch64-tdep_8c.html#acc128f98d9ceca227038c771308eff39">name</a> = NULL;
<a name="l00576"></a>00576   <span class="keywordtype">char</span> *filename = NULL;
<a name="l00577"></a>00577   <span class="keywordtype">int</span> unmapped = 0;
<a name="l00578"></a>00578   <span class="keywordtype">int</span> <a class="code" href="common_2agent_8c.html#aed7ea92f45bd273dde380a45ddced592">offset</a> = 0;
<a name="l00579"></a>00579   <span class="keywordtype">int</span> <a class="code" href="symtab_8h.html#a41ebd28ef1d7c6ade45642cb6acc1039">line</a> = 0;
<a name="l00580"></a>00580 
<a name="l00581"></a>00581   <span class="comment">/* Throw away both name and filename.  */</span>
<a name="l00582"></a>00582   <span class="keyword">struct </span>cleanup *cleanup_chain = <a class="code" href="cleanups_8c.html#a3d418f8af424aec399898c2d48b26224">make_cleanup</a> (<a class="code" href="utils_8c.html#a6d8c21606d3f67a431a7bfbb1f47d12e">free_current_contents</a>, &amp;name);
<a name="l00583"></a>00583   <a class="code" href="cleanups_8c.html#a3d418f8af424aec399898c2d48b26224">make_cleanup</a> (<a class="code" href="utils_8c.html#a6d8c21606d3f67a431a7bfbb1f47d12e">free_current_contents</a>, &amp;filename);
<a name="l00584"></a>00584 
<a name="l00585"></a>00585   <span class="keywordflow">if</span> (<a class="code" href="defs_8h.html#af3e823aa2a08ae692599d0aae7fc5e16">build_address_symbolic</a> (gdbarch, addr, do_demangle, &amp;name, &amp;offset,
<a name="l00586"></a>00586                               &amp;filename, &amp;line, &amp;unmapped))
<a name="l00587"></a>00587     {
<a name="l00588"></a>00588       <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (cleanup_chain);
<a name="l00589"></a>00589       <span class="keywordflow">return</span> 0;
<a name="l00590"></a>00590     }
<a name="l00591"></a>00591 
<a name="l00592"></a>00592   <a class="code" href="utils_8c.html#a4b28488051faf9ab4a2f07633225835f">fputs_filtered</a> (leadin, stream);
<a name="l00593"></a>00593   <span class="keywordflow">if</span> (unmapped)
<a name="l00594"></a>00594     <a class="code" href="utils_8c.html#a4b28488051faf9ab4a2f07633225835f">fputs_filtered</a> (<span class="stringliteral">&quot;&lt;*&quot;</span>, stream);
<a name="l00595"></a>00595   <span class="keywordflow">else</span>
<a name="l00596"></a>00596     <a class="code" href="utils_8c.html#a4b28488051faf9ab4a2f07633225835f">fputs_filtered</a> (<span class="stringliteral">&quot;&lt;&quot;</span>, stream);
<a name="l00597"></a>00597   <a class="code" href="utils_8c.html#a4b28488051faf9ab4a2f07633225835f">fputs_filtered</a> (name, stream);
<a name="l00598"></a>00598   <span class="keywordflow">if</span> (offset != 0)
<a name="l00599"></a>00599     <a class="code" href="utils_8c.html#aaa819b1a6c0b6c4090bdc0b027eaf64b">fprintf_filtered</a> (stream, <span class="stringliteral">&quot;+%u&quot;</span>, (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>) offset);
<a name="l00600"></a>00600 
<a name="l00601"></a>00601   <span class="comment">/* Append source filename and line number if desired.  Give specific</span>
<a name="l00602"></a>00602 <span class="comment">     line # of this addr, if we have it; else line # of the nearest symbol.  */</span>
<a name="l00603"></a>00603   <span class="keywordflow">if</span> (print_symbol_filename &amp;&amp; filename != NULL)
<a name="l00604"></a>00604     {
<a name="l00605"></a>00605       <span class="keywordflow">if</span> (line != -1)
<a name="l00606"></a>00606         <a class="code" href="utils_8c.html#aaa819b1a6c0b6c4090bdc0b027eaf64b">fprintf_filtered</a> (stream, <span class="stringliteral">&quot; at %s:%d&quot;</span>, filename, line);
<a name="l00607"></a>00607       <span class="keywordflow">else</span>
<a name="l00608"></a>00608         <a class="code" href="utils_8c.html#aaa819b1a6c0b6c4090bdc0b027eaf64b">fprintf_filtered</a> (stream, <span class="stringliteral">&quot; in %s&quot;</span>, filename);
<a name="l00609"></a>00609     }
<a name="l00610"></a>00610   <span class="keywordflow">if</span> (unmapped)
<a name="l00611"></a>00611     <a class="code" href="utils_8c.html#a4b28488051faf9ab4a2f07633225835f">fputs_filtered</a> (<span class="stringliteral">&quot;*&gt;&quot;</span>, stream);
<a name="l00612"></a>00612   <span class="keywordflow">else</span>
<a name="l00613"></a>00613     <a class="code" href="utils_8c.html#a4b28488051faf9ab4a2f07633225835f">fputs_filtered</a> (<span class="stringliteral">&quot;&gt;&quot;</span>, stream);
<a name="l00614"></a>00614 
<a name="l00615"></a>00615   <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (cleanup_chain);
<a name="l00616"></a>00616   <span class="keywordflow">return</span> 1;
<a name="l00617"></a>00617 }
<a name="l00618"></a>00618 
<a name="l00619"></a>00619 <span class="comment">/* Given an address ADDR return all the elements needed to print the</span>
<a name="l00620"></a>00620 <span class="comment">   address in a symbolic form.  NAME can be mangled or not depending</span>
<a name="l00621"></a>00621 <span class="comment">   on DO_DEMANGLE (and also on the asm_demangle global variable,</span>
<a name="l00622"></a>00622 <span class="comment">   manipulated via &#39;&#39;set print asm-demangle&#39;&#39;).  Return 0 in case of</span>
<a name="l00623"></a>00623 <span class="comment">   success, when all the info in the OUT paramters is valid.  Return 1</span>
<a name="l00624"></a>00624 <span class="comment">   otherwise.  */</span>
<a name="l00625"></a>00625 <span class="keywordtype">int</span>
<a name="l00626"></a><a class="code" href="printcmd_8c.html#a13cf1fbb9c3c4a506e4b76f523b2fadb">00626</a> <a class="code" href="defs_8h.html#af3e823aa2a08ae692599d0aae7fc5e16">build_address_symbolic</a> (<span class="keyword">struct</span> gdbarch *gdbarch,
<a name="l00627"></a>00627                         <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> addr,  <span class="comment">/* IN */</span>
<a name="l00628"></a>00628                         <span class="keywordtype">int</span> do_demangle, <span class="comment">/* IN */</span>
<a name="l00629"></a>00629                         <span class="keywordtype">char</span> **<a class="code" href="aarch64-tdep_8c.html#acc128f98d9ceca227038c771308eff39">name</a>,     <span class="comment">/* OUT */</span>
<a name="l00630"></a>00630                         <span class="keywordtype">int</span> *<a class="code" href="common_2agent_8c.html#aed7ea92f45bd273dde380a45ddced592">offset</a>,     <span class="comment">/* OUT */</span>
<a name="l00631"></a>00631                         <span class="keywordtype">char</span> **filename, <span class="comment">/* OUT */</span>
<a name="l00632"></a>00632                         <span class="keywordtype">int</span> *<a class="code" href="symtab_8h.html#a41ebd28ef1d7c6ade45642cb6acc1039">line</a>,       <span class="comment">/* OUT */</span>
<a name="l00633"></a>00633                         <span class="keywordtype">int</span> *unmapped)   <span class="comment">/* OUT */</span>
<a name="l00634"></a>00634 {
<a name="l00635"></a>00635   <span class="keyword">struct </span><a class="code" href="structminimal__symbol.html">minimal_symbol</a> *msymbol;
<a name="l00636"></a>00636   <span class="keyword">struct </span><a class="code" href="structsymbol.html">symbol</a> *<a class="code" href="structsymbol.html">symbol</a>;
<a name="l00637"></a>00637   <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> name_location = 0;
<a name="l00638"></a>00638   <span class="keyword">struct </span><a class="code" href="structobj__section.html">obj_section</a> *section = NULL;
<a name="l00639"></a>00639   <span class="keyword">const</span> <span class="keywordtype">char</span> *name_temp = <span class="stringliteral">&quot;&quot;</span>;
<a name="l00640"></a>00640   
<a name="l00641"></a>00641   <span class="comment">/* Let&#39;s say it is mapped (not unmapped).  */</span>
<a name="l00642"></a>00642   *unmapped = 0;
<a name="l00643"></a>00643 
<a name="l00644"></a>00644   <span class="comment">/* Determine if the address is in an overlay, and whether it is</span>
<a name="l00645"></a>00645 <span class="comment">     mapped.  */</span>
<a name="l00646"></a>00646   <span class="keywordflow">if</span> (<a class="code" href="symfile_8c.html#ad96d01ef61ee2925825b3992d37408f5">overlay_debugging</a>)
<a name="l00647"></a>00647     {
<a name="l00648"></a>00648       section = <a class="code" href="symfile_8c.html#ae3387e3fa4dfcec140196f91111883c1">find_pc_overlay</a> (addr);
<a name="l00649"></a>00649       <span class="keywordflow">if</span> (<a class="code" href="symfile_8c.html#aa3051557047b5400b5c2086cd89d544a">pc_in_unmapped_range</a> (addr, section))
<a name="l00650"></a>00650         {
<a name="l00651"></a>00651           *unmapped = 1;
<a name="l00652"></a>00652           addr = <a class="code" href="symfile_8c.html#a78d95e95a9dbe47b55cfb92f9d555b4f">overlay_mapped_address</a> (addr, section);
<a name="l00653"></a>00653         }
<a name="l00654"></a>00654     }
<a name="l00655"></a>00655 
<a name="l00656"></a>00656   <span class="comment">/* First try to find the address in the symbol table, then</span>
<a name="l00657"></a>00657 <span class="comment">     in the minsyms.  Take the closest one.  */</span>
<a name="l00658"></a>00658 
<a name="l00659"></a>00659   <span class="comment">/* This is defective in the sense that it only finds text symbols.  So</span>
<a name="l00660"></a>00660 <span class="comment">     really this is kind of pointless--we should make sure that the</span>
<a name="l00661"></a>00661 <span class="comment">     minimal symbols have everything we need (by changing that we could</span>
<a name="l00662"></a>00662 <span class="comment">     save some memory, but for many debug format--ELF/DWARF or</span>
<a name="l00663"></a>00663 <span class="comment">     anything/stabs--it would be inconvenient to eliminate those minimal</span>
<a name="l00664"></a>00664 <span class="comment">     symbols anyway).  */</span>
<a name="l00665"></a>00665   msymbol = <a class="code" href="minsyms_8c.html#a611312eec21fbfffd8f7d28d490e32f2">lookup_minimal_symbol_by_pc_section</a> (addr, section).<a class="code" href="structbound__minimal__symbol.html#aabff08898c1d96d6c68a95f35b635214">minsym</a>;
<a name="l00666"></a>00666   symbol = <a class="code" href="blockframe_8c.html#a255def7e64445af1e9b15dfaa24b07a5">find_pc_sect_function</a> (addr, section);
<a name="l00667"></a>00667 
<a name="l00668"></a>00668   <span class="keywordflow">if</span> (symbol)
<a name="l00669"></a>00669     {
<a name="l00670"></a>00670       <span class="comment">/* If this is a function (i.e. a code address), strip out any</span>
<a name="l00671"></a>00671 <span class="comment">         non-address bits.  For instance, display a pointer to the</span>
<a name="l00672"></a>00672 <span class="comment">         first instruction of a Thumb function as &lt;function&gt;; the</span>
<a name="l00673"></a>00673 <span class="comment">         second instruction will be &lt;function+2&gt;, even though the</span>
<a name="l00674"></a>00674 <span class="comment">         pointer is &lt;function+3&gt;.  This matches the ISA behavior.  */</span>
<a name="l00675"></a>00675       addr = <a class="code" href="gdbarch_8c.html#abee635dc7cb9e9793c6100971df1a859">gdbarch_addr_bits_remove</a> (gdbarch, addr);
<a name="l00676"></a>00676 
<a name="l00677"></a>00677       name_location = <a class="code" href="block_8h.html#a08fdff319bcd75e92b61c79139592af6">BLOCK_START</a> (<a class="code" href="symtab_8h.html#a2c83ea82b28e9a9d8f9b655c2d502593">SYMBOL_BLOCK_VALUE</a> (symbol));
<a name="l00678"></a>00678       <span class="keywordflow">if</span> (do_demangle || <a class="code" href="demangle_8c.html#a09f8a8dab597257a580b00c1efd53757">asm_demangle</a>)
<a name="l00679"></a>00679         name_temp = <a class="code" href="symtab_8h.html#ac7f4cb1648125545fbd0e4f13b0c572c">SYMBOL_PRINT_NAME</a> (symbol);
<a name="l00680"></a>00680       <span class="keywordflow">else</span>
<a name="l00681"></a>00681         name_temp = <a class="code" href="symtab_8h.html#a956b56288511a18b855d8a263d60e87f">SYMBOL_LINKAGE_NAME</a> (symbol);
<a name="l00682"></a>00682     }
<a name="l00683"></a>00683 
<a name="l00684"></a>00684   <span class="keywordflow">if</span> (msymbol != NULL
<a name="l00685"></a>00685       &amp;&amp; <a class="code" href="symtab_8h.html#a817348c2240d20e5af12ee47f0b98611">MSYMBOL_HAS_SIZE</a> (msymbol)
<a name="l00686"></a>00686       &amp;&amp; <a class="code" href="symtab_8h.html#abe76c055206f09da801b760076c9f68a">MSYMBOL_SIZE</a> (msymbol) == 0
<a name="l00687"></a>00687       &amp;&amp; <a class="code" href="symtab_8h.html#a1d0b27d446f2622f464727b6a06ae263">MSYMBOL_TYPE</a> (msymbol) != <a class="code" href="symtab_8h.html#a91ee0a03aba3bbd0e221547c3d82c036af24db58d8996f50560c2f03d9c8514c0">mst_text</a>
<a name="l00688"></a>00688       &amp;&amp; <a class="code" href="symtab_8h.html#a1d0b27d446f2622f464727b6a06ae263">MSYMBOL_TYPE</a> (msymbol) != <a class="code" href="symtab_8h.html#a91ee0a03aba3bbd0e221547c3d82c036af6ba30d7a115e1618b8480a5628349e4">mst_text_gnu_ifunc</a>
<a name="l00689"></a>00689       &amp;&amp; <a class="code" href="symtab_8h.html#a1d0b27d446f2622f464727b6a06ae263">MSYMBOL_TYPE</a> (msymbol) != <a class="code" href="symtab_8h.html#a91ee0a03aba3bbd0e221547c3d82c036abe55ea8e467b6e7517e226164aa94adb">mst_file_text</a>)
<a name="l00690"></a>00690     msymbol = NULL;
<a name="l00691"></a>00691 
<a name="l00692"></a>00692   <span class="keywordflow">if</span> (msymbol != NULL)
<a name="l00693"></a>00693     {
<a name="l00694"></a>00694       <span class="keywordflow">if</span> (<a class="code" href="symtab_8h.html#abee697b9e3bb4f4d164ad920a87ab854">SYMBOL_VALUE_ADDRESS</a> (msymbol) &gt; name_location || symbol == NULL)
<a name="l00695"></a>00695         {
<a name="l00696"></a>00696           <span class="comment">/* If this is a function (i.e. a code address), strip out any</span>
<a name="l00697"></a>00697 <span class="comment">             non-address bits.  For instance, display a pointer to the</span>
<a name="l00698"></a>00698 <span class="comment">             first instruction of a Thumb function as &lt;function&gt;; the</span>
<a name="l00699"></a>00699 <span class="comment">             second instruction will be &lt;function+2&gt;, even though the</span>
<a name="l00700"></a>00700 <span class="comment">             pointer is &lt;function+3&gt;.  This matches the ISA behavior.  */</span>
<a name="l00701"></a>00701           <span class="keywordflow">if</span> (<a class="code" href="symtab_8h.html#a1d0b27d446f2622f464727b6a06ae263">MSYMBOL_TYPE</a> (msymbol) == <a class="code" href="symtab_8h.html#a91ee0a03aba3bbd0e221547c3d82c036af24db58d8996f50560c2f03d9c8514c0">mst_text</a>
<a name="l00702"></a>00702               || <a class="code" href="symtab_8h.html#a1d0b27d446f2622f464727b6a06ae263">MSYMBOL_TYPE</a> (msymbol) == <a class="code" href="symtab_8h.html#a91ee0a03aba3bbd0e221547c3d82c036af6ba30d7a115e1618b8480a5628349e4">mst_text_gnu_ifunc</a>
<a name="l00703"></a>00703               || <a class="code" href="symtab_8h.html#a1d0b27d446f2622f464727b6a06ae263">MSYMBOL_TYPE</a> (msymbol) == <a class="code" href="symtab_8h.html#a91ee0a03aba3bbd0e221547c3d82c036abe55ea8e467b6e7517e226164aa94adb">mst_file_text</a>
<a name="l00704"></a>00704               || <a class="code" href="symtab_8h.html#a1d0b27d446f2622f464727b6a06ae263">MSYMBOL_TYPE</a> (msymbol) == <a class="code" href="symtab_8h.html#a91ee0a03aba3bbd0e221547c3d82c036aa6ace68113ace3aafa25e705d9fce85d">mst_solib_trampoline</a>)
<a name="l00705"></a>00705             addr = <a class="code" href="gdbarch_8c.html#abee635dc7cb9e9793c6100971df1a859">gdbarch_addr_bits_remove</a> (gdbarch, addr);
<a name="l00706"></a>00706 
<a name="l00707"></a>00707           <span class="comment">/* The msymbol is closer to the address than the symbol;</span>
<a name="l00708"></a>00708 <span class="comment">             use the msymbol instead.  */</span>
<a name="l00709"></a>00709           symbol = 0;
<a name="l00710"></a>00710           name_location = <a class="code" href="symtab_8h.html#abee697b9e3bb4f4d164ad920a87ab854">SYMBOL_VALUE_ADDRESS</a> (msymbol);
<a name="l00711"></a>00711           <span class="keywordflow">if</span> (do_demangle || <a class="code" href="demangle_8c.html#a09f8a8dab597257a580b00c1efd53757">asm_demangle</a>)
<a name="l00712"></a>00712             name_temp = <a class="code" href="symtab_8h.html#ac7f4cb1648125545fbd0e4f13b0c572c">SYMBOL_PRINT_NAME</a> (msymbol);
<a name="l00713"></a>00713           <span class="keywordflow">else</span>
<a name="l00714"></a>00714             name_temp = <a class="code" href="symtab_8h.html#a956b56288511a18b855d8a263d60e87f">SYMBOL_LINKAGE_NAME</a> (msymbol);
<a name="l00715"></a>00715         }
<a name="l00716"></a>00716     }
<a name="l00717"></a>00717   <span class="keywordflow">if</span> (symbol == NULL &amp;&amp; msymbol == NULL)
<a name="l00718"></a>00718     <span class="keywordflow">return</span> 1;
<a name="l00719"></a>00719 
<a name="l00720"></a>00720   <span class="comment">/* If the nearest symbol is too far away, don&#39;t print anything symbolic.  */</span>
<a name="l00721"></a>00721 
<a name="l00722"></a>00722   <span class="comment">/* For when CORE_ADDR is larger than unsigned int, we do math in</span>
<a name="l00723"></a>00723 <span class="comment">     CORE_ADDR.  But when we detect unsigned wraparound in the</span>
<a name="l00724"></a>00724 <span class="comment">     CORE_ADDR math, we ignore this test and print the offset,</span>
<a name="l00725"></a>00725 <span class="comment">     because addr+max_symbolic_offset has wrapped through the end</span>
<a name="l00726"></a>00726 <span class="comment">     of the address space back to the beginning, giving bogus comparison.  */</span>
<a name="l00727"></a>00727   <span class="keywordflow">if</span> (addr &gt; name_location + max_symbolic_offset
<a name="l00728"></a>00728       &amp;&amp; name_location + max_symbolic_offset &gt; name_location)
<a name="l00729"></a>00729     <span class="keywordflow">return</span> 1;
<a name="l00730"></a>00730 
<a name="l00731"></a>00731   *offset = addr - name_location;
<a name="l00732"></a>00732 
<a name="l00733"></a>00733   *name = xstrdup (name_temp);
<a name="l00734"></a>00734 
<a name="l00735"></a>00735   <span class="keywordflow">if</span> (print_symbol_filename)
<a name="l00736"></a>00736     {
<a name="l00737"></a>00737       <span class="keyword">struct </span><a class="code" href="structsymtab__and__line.html">symtab_and_line</a> sal;
<a name="l00738"></a>00738 
<a name="l00739"></a>00739       sal = <a class="code" href="symtab_8c.html#a8370be588c9e67d637b813e8f565c7f0">find_pc_sect_line</a> (addr, section, 0);
<a name="l00740"></a>00740 
<a name="l00741"></a>00741       <span class="keywordflow">if</span> (sal.symtab)
<a name="l00742"></a>00742         {
<a name="l00743"></a>00743           *filename = xstrdup (<a class="code" href="source_8c.html#ae251616cab166301d5fed95cbdd31232">symtab_to_filename_for_display</a> (sal.symtab));
<a name="l00744"></a>00744           *line = sal.line;
<a name="l00745"></a>00745         }
<a name="l00746"></a>00746     }
<a name="l00747"></a>00747   <span class="keywordflow">return</span> 0;
<a name="l00748"></a>00748 }
<a name="l00749"></a>00749 
<a name="l00750"></a>00750 
<a name="l00751"></a>00751 <span class="comment">/* Print address ADDR symbolically on STREAM.</span>
<a name="l00752"></a>00752 <span class="comment">   First print it as a number.  Then perhaps print</span>
<a name="l00753"></a>00753 <span class="comment">   &lt;SYMBOL + OFFSET&gt; after the number.  */</span>
<a name="l00754"></a>00754 
<a name="l00755"></a>00755 <span class="keywordtype">void</span>
<a name="l00756"></a><a class="code" href="printcmd_8c.html#ae86b470bd3a609fbbe2210c643aff853">00756</a> <a class="code" href="defs_8h.html#ac859be6d454d5718fb6faf3bd34fc27e">print_address</a> (<span class="keyword">struct</span> gdbarch *gdbarch,
<a name="l00757"></a>00757                <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> addr, <span class="keyword">struct</span> ui_file *stream)
<a name="l00758"></a>00758 {
<a name="l00759"></a>00759   <a class="code" href="utils_8c.html#a4b28488051faf9ab4a2f07633225835f">fputs_filtered</a> (<a class="code" href="utils_8c.html#ab5c76d72090f01d3848b63dda4e37d1c">paddress</a> (gdbarch, addr), stream);
<a name="l00760"></a>00760   <a class="code" href="defs_8h.html#a8337015171b8b8e4f281dfcecdd510f6">print_address_symbolic</a> (gdbarch, addr, stream, <a class="code" href="demangle_8c.html#a09f8a8dab597257a580b00c1efd53757">asm_demangle</a>, <span class="stringliteral">&quot; &quot;</span>);
<a name="l00761"></a>00761 }
<a name="l00762"></a>00762 
<a name="l00763"></a>00763 <span class="comment">/* Return a prefix for instruction address:</span>
<a name="l00764"></a>00764 <span class="comment">   &quot;=&gt; &quot; for current instruction, else &quot;   &quot;.  */</span>
<a name="l00765"></a>00765 
<a name="l00766"></a>00766 <span class="keyword">const</span> <span class="keywordtype">char</span> *
<a name="l00767"></a><a class="code" href="printcmd_8c.html#a61007b2555202cc7390bcf9876754411">00767</a> <a class="code" href="defs_8h.html#abe2f42b7bbc3aa6bdc77094c975c1acd">pc_prefix</a> (<a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> addr)
<a name="l00768"></a>00768 {
<a name="l00769"></a>00769   <span class="keywordflow">if</span> (<a class="code" href="frame_8c.html#ad1e8bd5ac45df219a168640934f891cc">has_stack_frames</a> ())
<a name="l00770"></a>00770     {
<a name="l00771"></a>00771       <span class="keyword">struct </span>frame_info *frame;
<a name="l00772"></a>00772       <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> pc;
<a name="l00773"></a>00773 
<a name="l00774"></a>00774       frame = <a class="code" href="frame_8c.html#a8b714a78478670e14a297eba8d1a9915">get_selected_frame</a> (NULL);
<a name="l00775"></a>00775       <span class="keywordflow">if</span> (<a class="code" href="frame_8c.html#af87888489ef191ac98c292350017e84e">get_frame_pc_if_available</a> (frame, &amp;pc) &amp;&amp; pc == addr)
<a name="l00776"></a>00776         <span class="keywordflow">return</span> <span class="stringliteral">&quot;=&gt; &quot;</span>;
<a name="l00777"></a>00777     }
<a name="l00778"></a>00778   <span class="keywordflow">return</span> <span class="stringliteral">&quot;   &quot;</span>;
<a name="l00779"></a>00779 }
<a name="l00780"></a>00780 
<a name="l00781"></a>00781 <span class="comment">/* Print address ADDR symbolically on STREAM.  Parameter DEMANGLE</span>
<a name="l00782"></a>00782 <span class="comment">   controls whether to print the symbolic name &quot;raw&quot; or demangled.</span>
<a name="l00783"></a>00783 <span class="comment">   Return non-zero if anything was printed; zero otherwise.  */</span>
<a name="l00784"></a>00784 
<a name="l00785"></a>00785 <span class="keywordtype">int</span>
<a name="l00786"></a><a class="code" href="value_8h.html#ac610c16ff7198566f40571b8f01a6053">00786</a> <a class="code" href="printcmd_8c.html#ad35994b59efe2c81248d51b5f3c78716">print_address_demangle</a> (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structvalue__print__options.html">value_print_options</a> *opts,
<a name="l00787"></a>00787                         <span class="keyword">struct</span> gdbarch *gdbarch, <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> addr,
<a name="l00788"></a>00788                         <span class="keyword">struct</span> ui_file *stream, <span class="keywordtype">int</span> do_demangle)
<a name="l00789"></a>00789 {
<a name="l00790"></a>00790   <span class="keywordflow">if</span> (opts-&gt;<a class="code" href="structvalue__print__options.html#a43ff625f7e08533c0e5cc38eddca80cf">addressprint</a>)
<a name="l00791"></a>00791     {
<a name="l00792"></a>00792       <a class="code" href="utils_8c.html#a4b28488051faf9ab4a2f07633225835f">fputs_filtered</a> (<a class="code" href="utils_8c.html#ab5c76d72090f01d3848b63dda4e37d1c">paddress</a> (gdbarch, addr), stream);
<a name="l00793"></a>00793       <a class="code" href="defs_8h.html#a8337015171b8b8e4f281dfcecdd510f6">print_address_symbolic</a> (gdbarch, addr, stream, do_demangle, <span class="stringliteral">&quot; &quot;</span>);
<a name="l00794"></a>00794     }
<a name="l00795"></a>00795   <span class="keywordflow">else</span>
<a name="l00796"></a>00796     {
<a name="l00797"></a>00797       <span class="keywordflow">return</span> <a class="code" href="defs_8h.html#a8337015171b8b8e4f281dfcecdd510f6">print_address_symbolic</a> (gdbarch, addr, stream, do_demangle, <span class="stringliteral">&quot;&quot;</span>);
<a name="l00798"></a>00798     }
<a name="l00799"></a>00799   <span class="keywordflow">return</span> 1;
<a name="l00800"></a>00800 }
<a name="l00801"></a>00801 
<a name="l00802"></a>00802 
<a name="l00803"></a>00803 <span class="comment">/* Examine data at address ADDR in format FMT.</span>
<a name="l00804"></a>00804 <span class="comment">   Fetch it from memory and print on gdb_stdout.  */</span>
<a name="l00805"></a>00805 
<a name="l00806"></a>00806 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00807"></a>00807 do_examine (<span class="keyword">struct</span> format_data fmt, <span class="keyword">struct</span> gdbarch *gdbarch, <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> addr)
<a name="l00808"></a>00808 {
<a name="l00809"></a>00809   <span class="keywordtype">char</span> format = 0;
<a name="l00810"></a>00810   <span class="keywordtype">char</span> <a class="code" href="go32-nat_8c.html#a854352f53b148adc24983a58a1866d66">size</a>;
<a name="l00811"></a>00811   <span class="keywordtype">int</span> count = 1;
<a name="l00812"></a>00812   <span class="keyword">struct </span>type *val_type = NULL;
<a name="l00813"></a>00813   <span class="keywordtype">int</span> i;
<a name="l00814"></a>00814   <span class="keywordtype">int</span> maxelts;
<a name="l00815"></a>00815   <span class="keyword">struct </span><a class="code" href="structvalue__print__options.html">value_print_options</a> opts;
<a name="l00816"></a>00816 
<a name="l00817"></a>00817   format = fmt.format;
<a name="l00818"></a>00818   size = fmt.size;
<a name="l00819"></a>00819   count = fmt.count;
<a name="l00820"></a>00820   next_gdbarch = gdbarch;
<a name="l00821"></a>00821   next_address = addr;
<a name="l00822"></a>00822 
<a name="l00823"></a>00823   <span class="comment">/* Instruction format implies fetch single bytes</span>
<a name="l00824"></a>00824 <span class="comment">     regardless of the specified size.</span>
<a name="l00825"></a>00825 <span class="comment">     The case of strings is handled in decode_format, only explicit</span>
<a name="l00826"></a>00826 <span class="comment">     size operator are not changed to &#39;b&#39;.  */</span>
<a name="l00827"></a>00827   <span class="keywordflow">if</span> (format == <span class="charliteral">&#39;i&#39;</span>)
<a name="l00828"></a>00828     size = <span class="charliteral">&#39;b&#39;</span>;
<a name="l00829"></a>00829 
<a name="l00830"></a>00830   <span class="keywordflow">if</span> (size == <span class="charliteral">&#39;a&#39;</span>)
<a name="l00831"></a>00831     {
<a name="l00832"></a>00832       <span class="comment">/* Pick the appropriate size for an address.  */</span>
<a name="l00833"></a>00833       <span class="keywordflow">if</span> (<a class="code" href="gdbarch_8c.html#ae356193e481873e4377ff922d984f13f">gdbarch_ptr_bit</a> (next_gdbarch) == 64)
<a name="l00834"></a>00834         size = <span class="charliteral">&#39;g&#39;</span>;
<a name="l00835"></a>00835       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="gdbarch_8c.html#ae356193e481873e4377ff922d984f13f">gdbarch_ptr_bit</a> (next_gdbarch) == 32)
<a name="l00836"></a>00836         size = <span class="charliteral">&#39;w&#39;</span>;
<a name="l00837"></a>00837       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="gdbarch_8c.html#ae356193e481873e4377ff922d984f13f">gdbarch_ptr_bit</a> (next_gdbarch) == 16)
<a name="l00838"></a>00838         size = <span class="charliteral">&#39;h&#39;</span>;
<a name="l00839"></a>00839       <span class="keywordflow">else</span>
<a name="l00840"></a>00840         <span class="comment">/* Bad value for gdbarch_ptr_bit.  */</span>
<a name="l00841"></a>00841         <a class="code" href="common-utils_8h.html#aa14285d9d3d4171016ef9cf09447e8bb">internal_error</a> (__FILE__, __LINE__,
<a name="l00842"></a>00842                         <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;failed internal consistency check&quot;</span>));
<a name="l00843"></a>00843     }
<a name="l00844"></a>00844 
<a name="l00845"></a>00845   <span class="keywordflow">if</span> (size == <span class="charliteral">&#39;b&#39;</span>)
<a name="l00846"></a>00846     val_type = <a class="code" href="gdbtypes_8c.html#addd01ebc9ccdf2cacb33ab01e281ddb8">builtin_type</a> (next_gdbarch)-&gt;<a class="code" href="structbuiltin__type.html#a3bda6904e80e6a0de09549a1b51fb088">builtin_int8</a>;
<a name="l00847"></a>00847   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (size == <span class="charliteral">&#39;h&#39;</span>)
<a name="l00848"></a>00848     val_type = <a class="code" href="gdbtypes_8c.html#addd01ebc9ccdf2cacb33ab01e281ddb8">builtin_type</a> (next_gdbarch)-&gt;<a class="code" href="structbuiltin__type.html#adfd7e6377d8b18a3a019bdc9a7eff0b8">builtin_int16</a>;
<a name="l00849"></a>00849   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (size == <span class="charliteral">&#39;w&#39;</span>)
<a name="l00850"></a>00850     val_type = <a class="code" href="gdbtypes_8c.html#addd01ebc9ccdf2cacb33ab01e281ddb8">builtin_type</a> (next_gdbarch)-&gt;<a class="code" href="structbuiltin__type.html#ab514809bc3e50d6db51f7b1b0729f2cb">builtin_int32</a>;
<a name="l00851"></a>00851   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (size == <span class="charliteral">&#39;g&#39;</span>)
<a name="l00852"></a>00852     val_type = <a class="code" href="gdbtypes_8c.html#addd01ebc9ccdf2cacb33ab01e281ddb8">builtin_type</a> (next_gdbarch)-&gt;<a class="code" href="structbuiltin__type.html#a96f3cd71c9619fa5a5ae644402e841ec">builtin_int64</a>;
<a name="l00853"></a>00853 
<a name="l00854"></a>00854   <span class="keywordflow">if</span> (format == <span class="charliteral">&#39;s&#39;</span>)
<a name="l00855"></a>00855     {
<a name="l00856"></a>00856       <span class="keyword">struct </span>type *char_type = NULL;
<a name="l00857"></a>00857 
<a name="l00858"></a>00858       <span class="comment">/* Search for &quot;char16_t&quot;  or &quot;char32_t&quot; types or fall back to 8-bit char</span>
<a name="l00859"></a>00859 <span class="comment">         if type is not found.  */</span>
<a name="l00860"></a>00860       <span class="keywordflow">if</span> (size == <span class="charliteral">&#39;h&#39;</span>)
<a name="l00861"></a>00861         char_type = <a class="code" href="gdbtypes_8c.html#addd01ebc9ccdf2cacb33ab01e281ddb8">builtin_type</a> (next_gdbarch)-&gt;<a class="code" href="structbuiltin__type.html#a8415d7432f815241fb3e7380fe3a9523">builtin_char16</a>;
<a name="l00862"></a>00862       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (size == <span class="charliteral">&#39;w&#39;</span>)
<a name="l00863"></a>00863         char_type = <a class="code" href="gdbtypes_8c.html#addd01ebc9ccdf2cacb33ab01e281ddb8">builtin_type</a> (next_gdbarch)-&gt;<a class="code" href="structbuiltin__type.html#aca5c68334d371caf96361fd7be81d675">builtin_char32</a>;
<a name="l00864"></a>00864       <span class="keywordflow">if</span> (char_type)
<a name="l00865"></a>00865         val_type = char_type;
<a name="l00866"></a>00866       <span class="keywordflow">else</span>
<a name="l00867"></a>00867         {
<a name="l00868"></a>00868           <span class="keywordflow">if</span> (size != <span class="charliteral">&#39;\0&#39;</span> &amp;&amp; size != <span class="charliteral">&#39;b&#39;</span>)
<a name="l00869"></a>00869             <a class="code" href="utils_8c.html#a5fc201a4181499a6b4057a6caa15b5e2">warning</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Unable to display strings with &quot;</span>
<a name="l00870"></a>00870                        <span class="stringliteral">&quot;size &#39;%c&#39;, using &#39;b&#39; instead.&quot;</span>), size);
<a name="l00871"></a>00871           size = <span class="charliteral">&#39;b&#39;</span>;
<a name="l00872"></a>00872           val_type = <a class="code" href="gdbtypes_8c.html#addd01ebc9ccdf2cacb33ab01e281ddb8">builtin_type</a> (next_gdbarch)-&gt;<a class="code" href="structbuiltin__type.html#a3bda6904e80e6a0de09549a1b51fb088">builtin_int8</a>;
<a name="l00873"></a>00873         }
<a name="l00874"></a>00874     }
<a name="l00875"></a>00875 
<a name="l00876"></a>00876   maxelts = 8;
<a name="l00877"></a>00877   <span class="keywordflow">if</span> (size == <span class="charliteral">&#39;w&#39;</span>)
<a name="l00878"></a>00878     maxelts = 4;
<a name="l00879"></a>00879   <span class="keywordflow">if</span> (size == <span class="charliteral">&#39;g&#39;</span>)
<a name="l00880"></a>00880     maxelts = 2;
<a name="l00881"></a>00881   <span class="keywordflow">if</span> (format == <span class="charliteral">&#39;s&#39;</span> || format == <span class="charliteral">&#39;i&#39;</span>)
<a name="l00882"></a>00882     maxelts = 1;
<a name="l00883"></a>00883 
<a name="l00884"></a>00884   <a class="code" href="valprint_8c.html#a1177f66ae5a60db2a75604f268dba57f">get_formatted_print_options</a> (&amp;opts, format);
<a name="l00885"></a>00885 
<a name="l00886"></a>00886   <span class="comment">/* Print as many objects as specified in COUNT, at most maxelts per line,</span>
<a name="l00887"></a>00887 <span class="comment">     with the address of the next one at the start of each line.  */</span>
<a name="l00888"></a>00888 
<a name="l00889"></a>00889   <span class="keywordflow">while</span> (count &gt; 0)
<a name="l00890"></a>00890     {
<a name="l00891"></a>00891       <a class="code" href="defs_8h.html#ad24e2b54375e12474e65ebf7175988fb">QUIT</a>;
<a name="l00892"></a>00892       <span class="keywordflow">if</span> (format == <span class="charliteral">&#39;i&#39;</span>)
<a name="l00893"></a>00893         <a class="code" href="utils_8c.html#a4b28488051faf9ab4a2f07633225835f">fputs_filtered</a> (<a class="code" href="defs_8h.html#abe2f42b7bbc3aa6bdc77094c975c1acd">pc_prefix</a> (next_address), <a class="code" href="main_8c.html#a41a2b997ba5454df787d61f051dd918c">gdb_stdout</a>);
<a name="l00894"></a>00894       <a class="code" href="defs_8h.html#ac859be6d454d5718fb6faf3bd34fc27e">print_address</a> (next_gdbarch, next_address, <a class="code" href="main_8c.html#a41a2b997ba5454df787d61f051dd918c">gdb_stdout</a>);
<a name="l00895"></a>00895       <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;:&quot;</span>);
<a name="l00896"></a>00896       <span class="keywordflow">for</span> (i = maxelts;
<a name="l00897"></a>00897            i &gt; 0 &amp;&amp; count &gt; 0;
<a name="l00898"></a>00898            i--, count--)
<a name="l00899"></a>00899         {
<a name="l00900"></a>00900           <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;\t&quot;</span>);
<a name="l00901"></a>00901           <span class="comment">/* Note that print_formatted sets next_address for the next</span>
<a name="l00902"></a>00902 <span class="comment">             object.  */</span>
<a name="l00903"></a>00903           last_examine_address = next_address;
<a name="l00904"></a>00904 
<a name="l00905"></a>00905           <span class="keywordflow">if</span> (last_examine_value)
<a name="l00906"></a>00906             <a class="code" href="value_8c.html#a1f9b3ee232ece65ddc75c2407b97a50d">value_free</a> (last_examine_value);
<a name="l00907"></a>00907 
<a name="l00908"></a>00908           <span class="comment">/* The value to be displayed is not fetched greedily.</span>
<a name="l00909"></a>00909 <span class="comment">             Instead, to avoid the possibility of a fetched value not</span>
<a name="l00910"></a>00910 <span class="comment">             being used, its retrieval is delayed until the print code</span>
<a name="l00911"></a>00911 <span class="comment">             uses it.  When examining an instruction stream, the</span>
<a name="l00912"></a>00912 <span class="comment">             disassembler will perform its own memory fetch using just</span>
<a name="l00913"></a>00913 <span class="comment">             the address stored in LAST_EXAMINE_VALUE.  FIXME: Should</span>
<a name="l00914"></a>00914 <span class="comment">             the disassembler be modified so that LAST_EXAMINE_VALUE</span>
<a name="l00915"></a>00915 <span class="comment">             is left with the byte sequence from the last complete</span>
<a name="l00916"></a>00916 <span class="comment">             instruction fetched from memory?  */</span>
<a name="l00917"></a>00917           last_examine_value = <a class="code" href="valops_8c.html#ae8cdb6f0257c5b86c719c90621e184d6">value_at_lazy</a> (val_type, next_address);
<a name="l00918"></a>00918 
<a name="l00919"></a>00919           <span class="keywordflow">if</span> (last_examine_value)
<a name="l00920"></a>00920             <a class="code" href="value_8c.html#a5a9662fcdbefec2edef0b912ba593914">release_value</a> (last_examine_value);
<a name="l00921"></a>00921 
<a name="l00922"></a>00922           print_formatted (last_examine_value, size, &amp;opts, <a class="code" href="main_8c.html#a41a2b997ba5454df787d61f051dd918c">gdb_stdout</a>);
<a name="l00923"></a>00923 
<a name="l00924"></a>00924           <span class="comment">/* Display any branch delay slots following the final insn.  */</span>
<a name="l00925"></a>00925           <span class="keywordflow">if</span> (format == <span class="charliteral">&#39;i&#39;</span> &amp;&amp; count == 1)
<a name="l00926"></a>00926             count += branch_delay_insns;
<a name="l00927"></a>00927         }
<a name="l00928"></a>00928       <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l00929"></a>00929       <a class="code" href="ui-file_8c.html#a046f07b5ef1bcc35c28b4be983e39998">gdb_flush</a> (<a class="code" href="main_8c.html#a41a2b997ba5454df787d61f051dd918c">gdb_stdout</a>);
<a name="l00930"></a>00930     }
<a name="l00931"></a>00931 }
<a name="l00932"></a>00932 
<a name="l00933"></a>00933 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00934"></a>00934 validate_format (<span class="keyword">struct</span> format_data fmt, <span class="keywordtype">char</span> *cmdname)
<a name="l00935"></a>00935 {
<a name="l00936"></a>00936   <span class="keywordflow">if</span> (fmt.size != 0)
<a name="l00937"></a>00937     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Size letters are meaningless in \&quot;%s\&quot; command.&quot;</span>), cmdname);
<a name="l00938"></a>00938   <span class="keywordflow">if</span> (fmt.count != 1)
<a name="l00939"></a>00939     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Item count other than 1 is meaningless in \&quot;%s\&quot; command.&quot;</span>),
<a name="l00940"></a>00940            cmdname);
<a name="l00941"></a>00941   <span class="keywordflow">if</span> (fmt.format == <span class="charliteral">&#39;i&#39;</span>)
<a name="l00942"></a>00942     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Format letter \&quot;%c\&quot; is meaningless in \&quot;%s\&quot; command.&quot;</span>),
<a name="l00943"></a>00943            fmt.format, cmdname);
<a name="l00944"></a>00944 }
<a name="l00945"></a>00945 
<a name="l00946"></a>00946 <span class="comment">/* Evaluate string EXP as an expression in the current language and</span>
<a name="l00947"></a>00947 <span class="comment">   print the resulting value.  EXP may contain a format specifier as the</span>
<a name="l00948"></a>00948 <span class="comment">   first argument (&quot;/x myvar&quot; for example, to print myvar in hex).  */</span>
<a name="l00949"></a>00949 
<a name="l00950"></a>00950 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00951"></a>00951 print_command_1 (<span class="keyword">const</span> <span class="keywordtype">char</span> *exp, <span class="keywordtype">int</span> voidprint)
<a name="l00952"></a>00952 {
<a name="l00953"></a>00953   <span class="keyword">struct </span><a class="code" href="structexpression.html">expression</a> *expr;
<a name="l00954"></a>00954   <span class="keyword">struct </span>cleanup *old_chain = <a class="code" href="cleanups_8c.html#a3d418f8af424aec399898c2d48b26224">make_cleanup</a> (<a class="code" href="cleanups_8c.html#a1ec2a3980c2be1f31f2142103d1f7abf">null_cleanup</a>, NULL);
<a name="l00955"></a>00955   <span class="keywordtype">char</span> format = 0;
<a name="l00956"></a>00956   <span class="keyword">struct </span>value *val;
<a name="l00957"></a>00957   <span class="keyword">struct </span>format_data fmt;
<a name="l00958"></a>00958 
<a name="l00959"></a>00959   <span class="keywordflow">if</span> (exp &amp;&amp; *exp == <span class="charliteral">&#39;/&#39;</span>)
<a name="l00960"></a>00960     {
<a name="l00961"></a>00961       exp++;
<a name="l00962"></a>00962       fmt = decode_format (&amp;exp, last_format, 0);
<a name="l00963"></a>00963       validate_format (fmt, <span class="stringliteral">&quot;print&quot;</span>);
<a name="l00964"></a>00964       last_format = format = fmt.format;
<a name="l00965"></a>00965     }
<a name="l00966"></a>00966   <span class="keywordflow">else</span>
<a name="l00967"></a>00967     {
<a name="l00968"></a>00968       fmt.count = 1;
<a name="l00969"></a>00969       fmt.format = 0;
<a name="l00970"></a>00970       fmt.size = 0;
<a name="l00971"></a>00971       fmt.raw = 0;
<a name="l00972"></a>00972     }
<a name="l00973"></a>00973 
<a name="l00974"></a>00974   <span class="keywordflow">if</span> (exp &amp;&amp; *exp)
<a name="l00975"></a>00975     {
<a name="l00976"></a>00976       expr = <a class="code" href="expression_8h.html#a286599225dbfecf78c83d1eb5261f25a">parse_expression</a> (exp);
<a name="l00977"></a>00977       <a class="code" href="cleanups_8c.html#a3d418f8af424aec399898c2d48b26224">make_cleanup</a> (<a class="code" href="utils_8c.html#a6d8c21606d3f67a431a7bfbb1f47d12e">free_current_contents</a>, &amp;expr);
<a name="l00978"></a>00978       val = <a class="code" href="eval_8c.html#ab50151ccba3ea3184c114121d6bed422">evaluate_expression</a> (expr);
<a name="l00979"></a>00979     }
<a name="l00980"></a>00980   <span class="keywordflow">else</span>
<a name="l00981"></a>00981     val = <a class="code" href="value_8c.html#a0ff31b66986cc1b1363fbcfcff419596">access_value_history</a> (0);
<a name="l00982"></a>00982 
<a name="l00983"></a>00983   <span class="keywordflow">if</span> (voidprint || (val &amp;&amp; <a class="code" href="value_8c.html#a263a4c0bee0b0df41074b952d3c121d0">value_type</a> (val) &amp;&amp;
<a name="l00984"></a>00984                     <a class="code" href="gdbtypes_8h.html#a9505f41c7012665947c6b4065ce190e1">TYPE_CODE</a> (<a class="code" href="value_8c.html#a263a4c0bee0b0df41074b952d3c121d0">value_type</a> (val)) != <a class="code" href="gdbtypes_8h.html#a90e2a0fddaa6afff6a0a489ff4da3462ad142a78789548b777dee1a3313e3e64f">TYPE_CODE_VOID</a>))
<a name="l00985"></a>00985     {
<a name="l00986"></a>00986       <span class="keyword">struct </span><a class="code" href="structvalue__print__options.html">value_print_options</a> opts;
<a name="l00987"></a>00987       <span class="keywordtype">int</span> histindex = <a class="code" href="value_8c.html#a6926a048760aeb485c850b68c2062822">record_latest_value</a> (val);
<a name="l00988"></a>00988 
<a name="l00989"></a>00989       <span class="keywordflow">if</span> (histindex &gt;= 0)
<a name="l00990"></a>00990         <a class="code" href="annotate_8c.html#a7e6715298f55f9391e00f1a5d1e70b41">annotate_value_history_begin</a> (histindex, <a class="code" href="value_8c.html#a263a4c0bee0b0df41074b952d3c121d0">value_type</a> (val));
<a name="l00991"></a>00991       <span class="keywordflow">else</span>
<a name="l00992"></a>00992         <a class="code" href="annotate_8c.html#af9633e7ebb2d720c99ef39b550304929">annotate_value_begin</a> (<a class="code" href="value_8c.html#a263a4c0bee0b0df41074b952d3c121d0">value_type</a> (val));
<a name="l00993"></a>00993 
<a name="l00994"></a>00994       <span class="keywordflow">if</span> (histindex &gt;= 0)
<a name="l00995"></a>00995         <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;$%d = &quot;</span>, histindex);
<a name="l00996"></a>00996 
<a name="l00997"></a>00997       <span class="keywordflow">if</span> (histindex &gt;= 0)
<a name="l00998"></a>00998         <a class="code" href="annotate_8c.html#af4493bd604a22450bdb846b2bf5fd970">annotate_value_history_value</a> ();
<a name="l00999"></a>00999 
<a name="l01000"></a>01000       <a class="code" href="valprint_8c.html#a1177f66ae5a60db2a75604f268dba57f">get_formatted_print_options</a> (&amp;opts, format);
<a name="l01001"></a>01001       opts.raw = fmt.raw;
<a name="l01002"></a>01002 
<a name="l01003"></a>01003       print_formatted (val, fmt.size, &amp;opts, <a class="code" href="main_8c.html#a41a2b997ba5454df787d61f051dd918c">gdb_stdout</a>);
<a name="l01004"></a>01004       <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l01005"></a>01005 
<a name="l01006"></a>01006       <span class="keywordflow">if</span> (histindex &gt;= 0)
<a name="l01007"></a>01007         <a class="code" href="annotate_8c.html#af077077b88c55c66fe079e82c972a16d">annotate_value_history_end</a> ();
<a name="l01008"></a>01008       <span class="keywordflow">else</span>
<a name="l01009"></a>01009         <a class="code" href="annotate_8c.html#a6737e7c1c75fea6a55f7b260a1e3449e">annotate_value_end</a> ();
<a name="l01010"></a>01010     }
<a name="l01011"></a>01011 
<a name="l01012"></a>01012   <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (old_chain);
<a name="l01013"></a>01013 }
<a name="l01014"></a>01014 
<a name="l01015"></a>01015 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01016"></a>01016 print_command (<span class="keywordtype">char</span> *exp, <span class="keywordtype">int</span> from_tty)
<a name="l01017"></a>01017 {
<a name="l01018"></a>01018   print_command_1 (exp, 1);
<a name="l01019"></a>01019 }
<a name="l01020"></a>01020 
<a name="l01021"></a>01021 <span class="comment">/* Same as print, except it doesn&#39;t print void results.  */</span>
<a name="l01022"></a>01022 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01023"></a>01023 call_command (<span class="keywordtype">char</span> *exp, <span class="keywordtype">int</span> from_tty)
<a name="l01024"></a>01024 {
<a name="l01025"></a>01025   print_command_1 (exp, 0);
<a name="l01026"></a>01026 }
<a name="l01027"></a>01027 
<a name="l01028"></a>01028 <span class="comment">/* Implementation of the &quot;output&quot; command.  */</span>
<a name="l01029"></a>01029 
<a name="l01030"></a>01030 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01031"></a>01031 output_command (<span class="keywordtype">char</span> *exp, <span class="keywordtype">int</span> from_tty)
<a name="l01032"></a>01032 {
<a name="l01033"></a>01033   <a class="code" href="printcmd_8c.html#aef1f1503b0b1bfe21ea5340773b698d2">output_command_const</a> (exp, from_tty);
<a name="l01034"></a>01034 }
<a name="l01035"></a>01035 
<a name="l01036"></a>01036 <span class="comment">/* Like output_command, but takes a const string as argument.  */</span>
<a name="l01037"></a>01037 
<a name="l01038"></a>01038 <span class="keywordtype">void</span>
<a name="l01039"></a><a class="code" href="valprint_8h.html#ac5a4ef23a8c7fbada8ad587e04dac359">01039</a> <a class="code" href="printcmd_8c.html#aef1f1503b0b1bfe21ea5340773b698d2">output_command_const</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> *exp, <span class="keywordtype">int</span> from_tty)
<a name="l01040"></a>01040 {
<a name="l01041"></a>01041   <span class="keyword">struct </span><a class="code" href="structexpression.html">expression</a> *expr;
<a name="l01042"></a>01042   <span class="keyword">struct </span>cleanup *old_chain;
<a name="l01043"></a>01043   <span class="keywordtype">char</span> format = 0;
<a name="l01044"></a>01044   <span class="keyword">struct </span>value *val;
<a name="l01045"></a>01045   <span class="keyword">struct </span>format_data fmt;
<a name="l01046"></a>01046   <span class="keyword">struct </span><a class="code" href="structvalue__print__options.html">value_print_options</a> opts;
<a name="l01047"></a>01047 
<a name="l01048"></a>01048   fmt.size = 0;
<a name="l01049"></a>01049   fmt.raw = 0;
<a name="l01050"></a>01050 
<a name="l01051"></a>01051   <span class="keywordflow">if</span> (exp &amp;&amp; *exp == <span class="charliteral">&#39;/&#39;</span>)
<a name="l01052"></a>01052     {
<a name="l01053"></a>01053       exp++;
<a name="l01054"></a>01054       fmt = decode_format (&amp;exp, 0, 0);
<a name="l01055"></a>01055       validate_format (fmt, <span class="stringliteral">&quot;output&quot;</span>);
<a name="l01056"></a>01056       format = fmt.format;
<a name="l01057"></a>01057     }
<a name="l01058"></a>01058 
<a name="l01059"></a>01059   expr = <a class="code" href="expression_8h.html#a286599225dbfecf78c83d1eb5261f25a">parse_expression</a> (exp);
<a name="l01060"></a>01060   old_chain = <a class="code" href="cleanups_8c.html#a3d418f8af424aec399898c2d48b26224">make_cleanup</a> (<a class="code" href="utils_8c.html#a6d8c21606d3f67a431a7bfbb1f47d12e">free_current_contents</a>, &amp;expr);
<a name="l01061"></a>01061 
<a name="l01062"></a>01062   val = <a class="code" href="eval_8c.html#ab50151ccba3ea3184c114121d6bed422">evaluate_expression</a> (expr);
<a name="l01063"></a>01063 
<a name="l01064"></a>01064   <a class="code" href="annotate_8c.html#af9633e7ebb2d720c99ef39b550304929">annotate_value_begin</a> (<a class="code" href="value_8c.html#a263a4c0bee0b0df41074b952d3c121d0">value_type</a> (val));
<a name="l01065"></a>01065 
<a name="l01066"></a>01066   <a class="code" href="valprint_8c.html#a1177f66ae5a60db2a75604f268dba57f">get_formatted_print_options</a> (&amp;opts, format);
<a name="l01067"></a>01067   opts.<a class="code" href="structvalue__print__options.html#a906b0433c8e9bad5a42fa6430026e8cc">raw</a> = fmt.raw;
<a name="l01068"></a>01068   print_formatted (val, fmt.size, &amp;opts, <a class="code" href="main_8c.html#a41a2b997ba5454df787d61f051dd918c">gdb_stdout</a>);
<a name="l01069"></a>01069 
<a name="l01070"></a>01070   <a class="code" href="annotate_8c.html#a6737e7c1c75fea6a55f7b260a1e3449e">annotate_value_end</a> ();
<a name="l01071"></a>01071 
<a name="l01072"></a>01072   <a class="code" href="utils_8c.html#a857540a17ef1cd62fef4a33cc3b6a894">wrap_here</a> (<span class="stringliteral">&quot;&quot;</span>);
<a name="l01073"></a>01073   <a class="code" href="ui-file_8c.html#a046f07b5ef1bcc35c28b4be983e39998">gdb_flush</a> (<a class="code" href="main_8c.html#a41a2b997ba5454df787d61f051dd918c">gdb_stdout</a>);
<a name="l01074"></a>01074 
<a name="l01075"></a>01075   <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (old_chain);
<a name="l01076"></a>01076 }
<a name="l01077"></a>01077 
<a name="l01078"></a>01078 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01079"></a>01079 set_command (<span class="keywordtype">char</span> *exp, <span class="keywordtype">int</span> from_tty)
<a name="l01080"></a>01080 {
<a name="l01081"></a>01081   <span class="keyword">struct </span><a class="code" href="structexpression.html">expression</a> *expr = <a class="code" href="expression_8h.html#a286599225dbfecf78c83d1eb5261f25a">parse_expression</a> (exp);
<a name="l01082"></a>01082   <span class="keyword">struct </span>cleanup *old_chain =
<a name="l01083"></a>01083     <a class="code" href="cleanups_8c.html#a3d418f8af424aec399898c2d48b26224">make_cleanup</a> (<a class="code" href="utils_8c.html#a6d8c21606d3f67a431a7bfbb1f47d12e">free_current_contents</a>, &amp;expr);
<a name="l01084"></a>01084 
<a name="l01085"></a>01085   <span class="keywordflow">if</span> (expr-&gt;<a class="code" href="structexpression.html#ad5e1dbc7e3732d94d29b8c3d61696123">nelts</a> &gt;= 1)
<a name="l01086"></a>01086     <span class="keywordflow">switch</span> (expr-&gt;<a class="code" href="structexpression.html#a121cbb7647db0430c9e217dbcd27021f">elts</a>[0].<a class="code" href="unionexp__element.html#a732546b7148c98393e390e52d954bc83">opcode</a>)
<a name="l01087"></a>01087       {
<a name="l01088"></a>01088       <span class="keywordflow">case</span> UNOP_PREINCREMENT:
<a name="l01089"></a>01089       <span class="keywordflow">case</span> UNOP_POSTINCREMENT:
<a name="l01090"></a>01090       <span class="keywordflow">case</span> UNOP_PREDECREMENT:
<a name="l01091"></a>01091       <span class="keywordflow">case</span> UNOP_POSTDECREMENT:
<a name="l01092"></a>01092       <span class="keywordflow">case</span> BINOP_ASSIGN:
<a name="l01093"></a>01093       <span class="keywordflow">case</span> BINOP_ASSIGN_MODIFY:
<a name="l01094"></a>01094       <span class="keywordflow">case</span> BINOP_COMMA:
<a name="l01095"></a>01095         <span class="keywordflow">break</span>;
<a name="l01096"></a>01096       <span class="keywordflow">default</span>:
<a name="l01097"></a>01097         <a class="code" href="utils_8c.html#a5fc201a4181499a6b4057a6caa15b5e2">warning</a>
<a name="l01098"></a>01098           (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Expression is not an assignment (and might have no effect)&quot;</span>));
<a name="l01099"></a>01099       }
<a name="l01100"></a>01100 
<a name="l01101"></a>01101   <a class="code" href="eval_8c.html#ab50151ccba3ea3184c114121d6bed422">evaluate_expression</a> (expr);
<a name="l01102"></a>01102   <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (old_chain);
<a name="l01103"></a>01103 }
<a name="l01104"></a>01104 
<a name="l01105"></a>01105 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01106"></a>01106 sym_info (<span class="keywordtype">char</span> *arg, <span class="keywordtype">int</span> from_tty)
<a name="l01107"></a>01107 {
<a name="l01108"></a>01108   <span class="keyword">struct </span><a class="code" href="structminimal__symbol.html">minimal_symbol</a> *msymbol;
<a name="l01109"></a>01109   <span class="keyword">struct </span><a class="code" href="structobjfile.html">objfile</a> *<a class="code" href="structobjfile.html">objfile</a>;
<a name="l01110"></a>01110   <span class="keyword">struct </span><a class="code" href="structobj__section.html">obj_section</a> *osect;
<a name="l01111"></a>01111   <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> addr, sect_addr;
<a name="l01112"></a>01112   <span class="keywordtype">int</span> matches = 0;
<a name="l01113"></a>01113   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="common_2agent_8c.html#aed7ea92f45bd273dde380a45ddced592">offset</a>;
<a name="l01114"></a>01114 
<a name="l01115"></a>01115   <span class="keywordflow">if</span> (!arg)
<a name="l01116"></a>01116     <a class="code" href="cli-cmds_8c.html#a68aef78cdf72abc9df2495a4618842c3">error_no_arg</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;address&quot;</span>));
<a name="l01117"></a>01117 
<a name="l01118"></a>01118   addr = <a class="code" href="eval_8c.html#adc1b596b06e274a83197cdeaa0c2809c">parse_and_eval_address</a> (arg);
<a name="l01119"></a>01119   <a class="code" href="objfiles_8h.html#ac97332e8e963307538cd23e38ab820b9">ALL_OBJSECTIONS</a> (objfile, osect)
<a name="l01120"></a>01120   {
<a name="l01121"></a>01121     <span class="comment">/* Only process each object file once, even if there&#39;s a separate</span>
<a name="l01122"></a>01122 <span class="comment">       debug file.  */</span>
<a name="l01123"></a>01123     <span class="keywordflow">if</span> (objfile-&gt;<a class="code" href="structobjfile.html#a1ef5fed06f7a9c5864c9a0ce46a87710">separate_debug_objfile_backlink</a>)
<a name="l01124"></a>01124       <span class="keywordflow">continue</span>;
<a name="l01125"></a>01125 
<a name="l01126"></a>01126     sect_addr = <a class="code" href="symfile_8c.html#a78d95e95a9dbe47b55cfb92f9d555b4f">overlay_mapped_address</a> (addr, osect);
<a name="l01127"></a>01127 
<a name="l01128"></a>01128     <span class="keywordflow">if</span> (<a class="code" href="objfiles_8h.html#add2e3fffc531c5f6789a03324308ccf6">obj_section_addr</a> (osect) &lt;= sect_addr
<a name="l01129"></a>01129         &amp;&amp; sect_addr &lt; <a class="code" href="objfiles_8h.html#aa53c013212e4b756a307fe6d7e6f966a">obj_section_endaddr</a> (osect)
<a name="l01130"></a>01130         &amp;&amp; (msymbol
<a name="l01131"></a>01131             = <a class="code" href="minsyms_8c.html#a611312eec21fbfffd8f7d28d490e32f2">lookup_minimal_symbol_by_pc_section</a> (sect_addr, osect).minsym))
<a name="l01132"></a>01132       {
<a name="l01133"></a>01133         <span class="keyword">const</span> <span class="keywordtype">char</span> *obj_name, *mapped, *sec_name, *msym_name;
<a name="l01134"></a>01134         <span class="keywordtype">char</span> *loc_string;
<a name="l01135"></a>01135         <span class="keyword">struct </span>cleanup *old_chain;
<a name="l01136"></a>01136 
<a name="l01137"></a>01137         matches = 1;
<a name="l01138"></a>01138         offset = sect_addr - <a class="code" href="symtab_8h.html#abee697b9e3bb4f4d164ad920a87ab854">SYMBOL_VALUE_ADDRESS</a> (msymbol);
<a name="l01139"></a>01139         mapped = <a class="code" href="symfile_8c.html#a2d6f94d48a782be7460e704fec67adb4">section_is_mapped</a> (osect) ? <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;mapped&quot;</span>) : <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;unmapped&quot;</span>);
<a name="l01140"></a>01140         sec_name = osect-&gt;<a class="code" href="structobj__section.html#ad233927d4d1037bde66ab9628ae82345">the_bfd_section</a>-&gt;name;
<a name="l01141"></a>01141         msym_name = <a class="code" href="symtab_8h.html#ac7f4cb1648125545fbd0e4f13b0c572c">SYMBOL_PRINT_NAME</a> (msymbol);
<a name="l01142"></a>01142 
<a name="l01143"></a>01143         <span class="comment">/* Don&#39;t print the offset if it is zero.</span>
<a name="l01144"></a>01144 <span class="comment">           We assume there&#39;s no need to handle i18n of &quot;sym + offset&quot;.  */</span>
<a name="l01145"></a>01145         <span class="keywordflow">if</span> (offset)
<a name="l01146"></a>01146           loc_string = <a class="code" href="common-utils_8c.html#ab9bf7e1b4e68bdd0078e9e1e55c62cec">xstrprintf</a> (<span class="stringliteral">&quot;%s + %u&quot;</span>, msym_name, offset);
<a name="l01147"></a>01147         <span class="keywordflow">else</span>
<a name="l01148"></a>01148           loc_string = <a class="code" href="common-utils_8c.html#ab9bf7e1b4e68bdd0078e9e1e55c62cec">xstrprintf</a> (<span class="stringliteral">&quot;%s&quot;</span>, msym_name);
<a name="l01149"></a>01149 
<a name="l01150"></a>01150         <span class="comment">/* Use a cleanup to free loc_string in case the user quits</span>
<a name="l01151"></a>01151 <span class="comment">           a pagination request inside printf_filtered.  */</span>
<a name="l01152"></a>01152         old_chain = <a class="code" href="cleanups_8c.html#a3d418f8af424aec399898c2d48b26224">make_cleanup</a> (<a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a>, loc_string);
<a name="l01153"></a>01153 
<a name="l01154"></a>01154         <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (osect-&gt;<a class="code" href="structobj__section.html#a3dba4273f49b43a5e8c64bd29ac39ef1">objfile</a> &amp;&amp; <a class="code" href="objfiles_8c.html#a33e548a19b86b293435d3c2d6daaaec6">objfile_name</a> (osect-&gt;<a class="code" href="structobj__section.html#a3dba4273f49b43a5e8c64bd29ac39ef1">objfile</a>));
<a name="l01155"></a>01155         obj_name = <a class="code" href="objfiles_8c.html#a33e548a19b86b293435d3c2d6daaaec6">objfile_name</a> (osect-&gt;<a class="code" href="structobj__section.html#a3dba4273f49b43a5e8c64bd29ac39ef1">objfile</a>);
<a name="l01156"></a>01156 
<a name="l01157"></a>01157         <span class="keywordflow">if</span> (<a class="code" href="objfiles_8h.html#a929d5fdce429389f9b3602378b5eff42">MULTI_OBJFILE_P</a> ())
<a name="l01158"></a>01158           <span class="keywordflow">if</span> (<a class="code" href="symfile_8c.html#aa3051557047b5400b5c2086cd89d544a">pc_in_unmapped_range</a> (addr, osect))
<a name="l01159"></a>01159             <span class="keywordflow">if</span> (<a class="code" href="symfile_8c.html#ad63f10fe5266cd2e98883d6f4c054c3a">section_is_overlay</a> (osect))
<a name="l01160"></a>01160               <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;%s in load address range of &quot;</span>
<a name="l01161"></a>01161                                  <span class="stringliteral">&quot;%s overlay section %s of %s\n&quot;</span>),
<a name="l01162"></a>01162                                loc_string, mapped, sec_name, obj_name);
<a name="l01163"></a>01163             <span class="keywordflow">else</span>
<a name="l01164"></a>01164               <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;%s in load address range of &quot;</span>
<a name="l01165"></a>01165                                  <span class="stringliteral">&quot;section %s of %s\n&quot;</span>),
<a name="l01166"></a>01166                                loc_string, sec_name, obj_name);
<a name="l01167"></a>01167           <span class="keywordflow">else</span>
<a name="l01168"></a>01168             <span class="keywordflow">if</span> (<a class="code" href="symfile_8c.html#ad63f10fe5266cd2e98883d6f4c054c3a">section_is_overlay</a> (osect))
<a name="l01169"></a>01169               <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;%s in %s overlay section %s of %s\n&quot;</span>),
<a name="l01170"></a>01170                                loc_string, mapped, sec_name, obj_name);
<a name="l01171"></a>01171             <span class="keywordflow">else</span>
<a name="l01172"></a>01172               <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;%s in section %s of %s\n&quot;</span>),
<a name="l01173"></a>01173                                loc_string, sec_name, obj_name);
<a name="l01174"></a>01174         <span class="keywordflow">else</span>
<a name="l01175"></a>01175           <span class="keywordflow">if</span> (<a class="code" href="symfile_8c.html#aa3051557047b5400b5c2086cd89d544a">pc_in_unmapped_range</a> (addr, osect))
<a name="l01176"></a>01176             <span class="keywordflow">if</span> (<a class="code" href="symfile_8c.html#ad63f10fe5266cd2e98883d6f4c054c3a">section_is_overlay</a> (osect))
<a name="l01177"></a>01177               <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;%s in load address range of %s overlay &quot;</span>
<a name="l01178"></a>01178                                  <span class="stringliteral">&quot;section %s\n&quot;</span>),
<a name="l01179"></a>01179                                loc_string, mapped, sec_name);
<a name="l01180"></a>01180             <span class="keywordflow">else</span>
<a name="l01181"></a>01181               <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;%s in load address range of section %s\n&quot;</span>),
<a name="l01182"></a>01182                                loc_string, sec_name);
<a name="l01183"></a>01183           <span class="keywordflow">else</span>
<a name="l01184"></a>01184             <span class="keywordflow">if</span> (<a class="code" href="symfile_8c.html#ad63f10fe5266cd2e98883d6f4c054c3a">section_is_overlay</a> (osect))
<a name="l01185"></a>01185               <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;%s in %s overlay section %s\n&quot;</span>),
<a name="l01186"></a>01186                                loc_string, mapped, sec_name);
<a name="l01187"></a>01187             <span class="keywordflow">else</span>
<a name="l01188"></a>01188               <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;%s in section %s\n&quot;</span>),
<a name="l01189"></a>01189                                loc_string, sec_name);
<a name="l01190"></a>01190 
<a name="l01191"></a>01191         <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (old_chain);
<a name="l01192"></a>01192       }
<a name="l01193"></a>01193   }
<a name="l01194"></a>01194   <span class="keywordflow">if</span> (matches == 0)
<a name="l01195"></a>01195     <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;No symbol matches %s.\n&quot;</span>), arg);
<a name="l01196"></a>01196 }
<a name="l01197"></a>01197 
<a name="l01198"></a>01198 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01199"></a>01199 address_info (<span class="keywordtype">char</span> *exp, <span class="keywordtype">int</span> from_tty)
<a name="l01200"></a>01200 {
<a name="l01201"></a>01201   <span class="keyword">struct </span>gdbarch *gdbarch;
<a name="l01202"></a>01202   <span class="keywordtype">int</span> regno;
<a name="l01203"></a>01203   <span class="keyword">struct </span><a class="code" href="structsymbol.html">symbol</a> *sym;
<a name="l01204"></a>01204   <span class="keyword">struct </span><a class="code" href="structbound__minimal__symbol.html">bound_minimal_symbol</a> msymbol;
<a name="l01205"></a>01205   <span class="keywordtype">long</span> val;
<a name="l01206"></a>01206   <span class="keyword">struct </span><a class="code" href="structobj__section.html">obj_section</a> *section;
<a name="l01207"></a>01207   <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> load_addr, context_pc = 0;
<a name="l01208"></a>01208   <span class="keyword">struct </span><a class="code" href="structfield__of__this__result.html">field_of_this_result</a> is_a_field_of_this;
<a name="l01209"></a>01209 
<a name="l01210"></a>01210   <span class="keywordflow">if</span> (exp == 0)
<a name="l01211"></a>01211     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Argument required.&quot;</span>));
<a name="l01212"></a>01212 
<a name="l01213"></a>01213   sym = <a class="code" href="symtab_8c.html#a8a5c3f803198aed047a55c0e4f61b315">lookup_symbol</a> (exp, <a class="code" href="frame_8h.html#a91efbdcf182d840c28d378def97cfc23">get_selected_block</a> (&amp;context_pc), <a class="code" href="symtab_8h.html#a5c384cef81c5f50f32caadbfd6974a1aa15693f9d844450eb4bfd4b37114f4aed">VAR_DOMAIN</a>,
<a name="l01214"></a>01214                        &amp;is_a_field_of_this);
<a name="l01215"></a>01215   <span class="keywordflow">if</span> (sym == NULL)
<a name="l01216"></a>01216     {
<a name="l01217"></a>01217       <span class="keywordflow">if</span> (is_a_field_of_this.type != NULL)
<a name="l01218"></a>01218         {
<a name="l01219"></a>01219           <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;Symbol \&quot;&quot;</span>);
<a name="l01220"></a>01220           <a class="code" href="utils_8c.html#ab6cbc55040f60777508417f7708b7eb5">fprintf_symbol_filtered</a> (<a class="code" href="main_8c.html#a41a2b997ba5454df787d61f051dd918c">gdb_stdout</a>, exp,
<a name="l01221"></a>01221                                    <a class="code" href="language_8c.html#acd2505a014a95629da9c836f8914fc79">current_language</a>-&gt;<a class="code" href="structlanguage__defn.html#a1395b7eb05a09e5798dc29257f30810a">la_language</a>, DMGL_ANSI);
<a name="l01222"></a>01222           <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;\&quot; is a field of the local class variable &quot;</span>);
<a name="l01223"></a>01223           <span class="keywordflow">if</span> (<a class="code" href="language_8c.html#acd2505a014a95629da9c836f8914fc79">current_language</a>-&gt;<a class="code" href="structlanguage__defn.html#a1395b7eb05a09e5798dc29257f30810a">la_language</a> == <a class="code" href="defs_8h.html#aa37aa8979934d47ac32fd96ecff32202af970f874c431c7404837e92fe971e813">language_objc</a>)
<a name="l01224"></a>01224             <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;`self&#39;\n&quot;</span>);       <span class="comment">/* ObjC equivalent of &quot;this&quot; */</span>
<a name="l01225"></a>01225           <span class="keywordflow">else</span>
<a name="l01226"></a>01226             <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;`this&#39;\n&quot;</span>);
<a name="l01227"></a>01227           <span class="keywordflow">return</span>;
<a name="l01228"></a>01228         }
<a name="l01229"></a>01229 
<a name="l01230"></a>01230       msymbol = <a class="code" href="minsyms_8c.html#a897792988bedbb8b26bdc46838516a90">lookup_bound_minimal_symbol</a> (exp);
<a name="l01231"></a>01231 
<a name="l01232"></a>01232       <span class="keywordflow">if</span> (msymbol.minsym != NULL)
<a name="l01233"></a>01233         {
<a name="l01234"></a>01234           <span class="keyword">struct </span>objfile *objfile = msymbol.objfile;
<a name="l01235"></a>01235 
<a name="l01236"></a>01236           gdbarch = <a class="code" href="objfiles_8c.html#a1c7101234ac2edc601fa465e48bc3463">get_objfile_arch</a> (objfile);
<a name="l01237"></a>01237           load_addr = <a class="code" href="symtab_8h.html#abee697b9e3bb4f4d164ad920a87ab854">SYMBOL_VALUE_ADDRESS</a> (msymbol.minsym);
<a name="l01238"></a>01238 
<a name="l01239"></a>01239           <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;Symbol \&quot;&quot;</span>);
<a name="l01240"></a>01240           <a class="code" href="utils_8c.html#ab6cbc55040f60777508417f7708b7eb5">fprintf_symbol_filtered</a> (<a class="code" href="main_8c.html#a41a2b997ba5454df787d61f051dd918c">gdb_stdout</a>, exp,
<a name="l01241"></a>01241                                    <a class="code" href="language_8c.html#acd2505a014a95629da9c836f8914fc79">current_language</a>-&gt;<a class="code" href="structlanguage__defn.html#a1395b7eb05a09e5798dc29257f30810a">la_language</a>, DMGL_ANSI);
<a name="l01242"></a>01242           <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;\&quot; is at &quot;</span>);
<a name="l01243"></a>01243           <a class="code" href="utils_8c.html#a4b28488051faf9ab4a2f07633225835f">fputs_filtered</a> (<a class="code" href="utils_8c.html#ab5c76d72090f01d3848b63dda4e37d1c">paddress</a> (gdbarch, load_addr), <a class="code" href="main_8c.html#a41a2b997ba5454df787d61f051dd918c">gdb_stdout</a>);
<a name="l01244"></a>01244           <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot; in a file compiled without debugging&quot;</span>);
<a name="l01245"></a>01245           section = <a class="code" href="symtab_8h.html#a68f0685d666b6934c762f89d9b996c63">SYMBOL_OBJ_SECTION</a> (objfile, msymbol.minsym);
<a name="l01246"></a>01246           <span class="keywordflow">if</span> (<a class="code" href="symfile_8c.html#ad63f10fe5266cd2e98883d6f4c054c3a">section_is_overlay</a> (section))
<a name="l01247"></a>01247             {
<a name="l01248"></a>01248               load_addr = <a class="code" href="symfile_8c.html#a2636cd25fefea890cc48426ca960e502">overlay_unmapped_address</a> (load_addr, section);
<a name="l01249"></a>01249               <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;,\n -- loaded at &quot;</span>);
<a name="l01250"></a>01250               <a class="code" href="utils_8c.html#a4b28488051faf9ab4a2f07633225835f">fputs_filtered</a> (<a class="code" href="utils_8c.html#ab5c76d72090f01d3848b63dda4e37d1c">paddress</a> (gdbarch, load_addr), <a class="code" href="main_8c.html#a41a2b997ba5454df787d61f051dd918c">gdb_stdout</a>);
<a name="l01251"></a>01251               <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot; in overlay section %s&quot;</span>,
<a name="l01252"></a>01252                                section-&gt;<a class="code" href="structobj__section.html#ad233927d4d1037bde66ab9628ae82345">the_bfd_section</a>-&gt;name);
<a name="l01253"></a>01253             }
<a name="l01254"></a>01254           <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;.\n&quot;</span>);
<a name="l01255"></a>01255         }
<a name="l01256"></a>01256       <span class="keywordflow">else</span>
<a name="l01257"></a>01257         <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;No symbol \&quot;%s\&quot; in current context.&quot;</span>), exp);
<a name="l01258"></a>01258       <span class="keywordflow">return</span>;
<a name="l01259"></a>01259     }
<a name="l01260"></a>01260 
<a name="l01261"></a>01261   <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;Symbol \&quot;&quot;</span>);
<a name="l01262"></a>01262   <a class="code" href="utils_8c.html#ab6cbc55040f60777508417f7708b7eb5">fprintf_symbol_filtered</a> (<a class="code" href="main_8c.html#a41a2b997ba5454df787d61f051dd918c">gdb_stdout</a>, <a class="code" href="symtab_8h.html#ac7f4cb1648125545fbd0e4f13b0c572c">SYMBOL_PRINT_NAME</a> (sym),
<a name="l01263"></a>01263                            <a class="code" href="language_8c.html#acd2505a014a95629da9c836f8914fc79">current_language</a>-&gt;<a class="code" href="structlanguage__defn.html#a1395b7eb05a09e5798dc29257f30810a">la_language</a>, DMGL_ANSI);
<a name="l01264"></a>01264   <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;\&quot; is &quot;</span>);
<a name="l01265"></a>01265   val = <a class="code" href="symtab_8h.html#a31840856d8e3eed18cbe9ca90cd2bf39">SYMBOL_VALUE</a> (sym);
<a name="l01266"></a>01266   section = <a class="code" href="symtab_8h.html#a68f0685d666b6934c762f89d9b996c63">SYMBOL_OBJ_SECTION</a> (<a class="code" href="symtab_8h.html#a0b89069b6c35cf2b613c91f832b9b85f">SYMBOL_OBJFILE</a> (sym), sym);
<a name="l01267"></a>01267   gdbarch = <a class="code" href="objfiles_8c.html#a1c7101234ac2edc601fa465e48bc3463">get_objfile_arch</a> (<a class="code" href="symtab_8h.html#ae86281e4645c9471cb9cb496d7a5ee21">SYMBOL_SYMTAB</a> (sym)-&gt;objfile);
<a name="l01268"></a>01268 
<a name="l01269"></a>01269   <span class="keywordflow">if</span> (<a class="code" href="symtab_8h.html#a9d6910f7fd67567d273e8ee619e0ef4e">SYMBOL_COMPUTED_OPS</a> (sym) != NULL)
<a name="l01270"></a>01270     {
<a name="l01271"></a>01271       <a class="code" href="symtab_8h.html#a9d6910f7fd67567d273e8ee619e0ef4e">SYMBOL_COMPUTED_OPS</a> (sym)-&gt;describe_location (sym, context_pc,
<a name="l01272"></a>01272                                                     <a class="code" href="main_8c.html#a41a2b997ba5454df787d61f051dd918c">gdb_stdout</a>);
<a name="l01273"></a>01273       <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;.\n&quot;</span>);
<a name="l01274"></a>01274       <span class="keywordflow">return</span>;
<a name="l01275"></a>01275     }
<a name="l01276"></a>01276 
<a name="l01277"></a>01277   <span class="keywordflow">switch</span> (<a class="code" href="symtab_8h.html#a8394f2ba6c27e8026b2783db7cc0eb40">SYMBOL_CLASS</a> (sym))
<a name="l01278"></a>01278     {
<a name="l01279"></a>01279     <span class="keywordflow">case</span> <a class="code" href="symtab_8h.html#a40bca6cf3ed5cfa15b1275e6750cdda3a5268309778a6727d08106ff9f2966e54">LOC_CONST</a>:
<a name="l01280"></a>01280     <span class="keywordflow">case</span> <a class="code" href="symtab_8h.html#a40bca6cf3ed5cfa15b1275e6750cdda3a74c269ff88b13d3497422a9ebfd98b2d">LOC_CONST_BYTES</a>:
<a name="l01281"></a>01281       <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;constant&quot;</span>);
<a name="l01282"></a>01282       <span class="keywordflow">break</span>;
<a name="l01283"></a>01283 
<a name="l01284"></a>01284     <span class="keywordflow">case</span> <a class="code" href="symtab_8h.html#a40bca6cf3ed5cfa15b1275e6750cdda3a246b44ddd9acee8dac2a7d9d2c5d7c6e">LOC_LABEL</a>:
<a name="l01285"></a>01285       <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;a label at address &quot;</span>);
<a name="l01286"></a>01286       load_addr = <a class="code" href="symtab_8h.html#abee697b9e3bb4f4d164ad920a87ab854">SYMBOL_VALUE_ADDRESS</a> (sym);
<a name="l01287"></a>01287       <a class="code" href="utils_8c.html#a4b28488051faf9ab4a2f07633225835f">fputs_filtered</a> (<a class="code" href="utils_8c.html#ab5c76d72090f01d3848b63dda4e37d1c">paddress</a> (gdbarch, load_addr), <a class="code" href="main_8c.html#a41a2b997ba5454df787d61f051dd918c">gdb_stdout</a>);
<a name="l01288"></a>01288       <span class="keywordflow">if</span> (<a class="code" href="symfile_8c.html#ad63f10fe5266cd2e98883d6f4c054c3a">section_is_overlay</a> (section))
<a name="l01289"></a>01289         {
<a name="l01290"></a>01290           load_addr = <a class="code" href="symfile_8c.html#a2636cd25fefea890cc48426ca960e502">overlay_unmapped_address</a> (load_addr, section);
<a name="l01291"></a>01291           <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;,\n -- loaded at &quot;</span>);
<a name="l01292"></a>01292           <a class="code" href="utils_8c.html#a4b28488051faf9ab4a2f07633225835f">fputs_filtered</a> (<a class="code" href="utils_8c.html#ab5c76d72090f01d3848b63dda4e37d1c">paddress</a> (gdbarch, load_addr), <a class="code" href="main_8c.html#a41a2b997ba5454df787d61f051dd918c">gdb_stdout</a>);
<a name="l01293"></a>01293           <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot; in overlay section %s&quot;</span>,
<a name="l01294"></a>01294                            section-&gt;<a class="code" href="structobj__section.html#ad233927d4d1037bde66ab9628ae82345">the_bfd_section</a>-&gt;name);
<a name="l01295"></a>01295         }
<a name="l01296"></a>01296       <span class="keywordflow">break</span>;
<a name="l01297"></a>01297 
<a name="l01298"></a>01298     <span class="keywordflow">case</span> <a class="code" href="symtab_8h.html#a40bca6cf3ed5cfa15b1275e6750cdda3afd4303a25cda7805900ce8212c67ed45">LOC_COMPUTED</a>:
<a name="l01299"></a>01299       <a class="code" href="gdb__assert_8h.html#aa0526ecd768317edecf0b46c981cbcc0">gdb_assert_not_reached</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;LOC_COMPUTED variable missing a method&quot;</span>));
<a name="l01300"></a>01300 
<a name="l01301"></a>01301     <span class="keywordflow">case</span> <a class="code" href="symtab_8h.html#a40bca6cf3ed5cfa15b1275e6750cdda3a2a9bcb7d8487d7ccb3858184340712e7">LOC_REGISTER</a>:
<a name="l01302"></a>01302       <span class="comment">/* GDBARCH is the architecture associated with the objfile the symbol</span>
<a name="l01303"></a>01303 <span class="comment">         is defined in; the target architecture may be different, and may</span>
<a name="l01304"></a>01304 <span class="comment">         provide additional registers.  However, we do not know the target</span>
<a name="l01305"></a>01305 <span class="comment">         architecture at this point.  We assume the objfile architecture</span>
<a name="l01306"></a>01306 <span class="comment">         will contain all the standard registers that occur in debug info</span>
<a name="l01307"></a>01307 <span class="comment">         in that objfile.  */</span>
<a name="l01308"></a>01308       regno = <a class="code" href="symtab_8h.html#ac3bc5f478a60882fbe5c60f3d09a0d6e">SYMBOL_REGISTER_OPS</a> (sym)-&gt;register_number (sym, gdbarch);
<a name="l01309"></a>01309 
<a name="l01310"></a>01310       <span class="keywordflow">if</span> (<a class="code" href="symtab_8h.html#ab3de6f2d8c380d3ca8bef520b1b4dfb9">SYMBOL_IS_ARGUMENT</a> (sym))
<a name="l01311"></a>01311         <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;an argument in register %s&quot;</span>),
<a name="l01312"></a>01312                          <a class="code" href="gdbarch_8c.html#a86c0cf41eb88c54e943cd80e79af36e5">gdbarch_register_name</a> (gdbarch, regno));
<a name="l01313"></a>01313       <span class="keywordflow">else</span>
<a name="l01314"></a>01314         <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;a variable in register %s&quot;</span>),
<a name="l01315"></a>01315                          <a class="code" href="gdbarch_8c.html#a86c0cf41eb88c54e943cd80e79af36e5">gdbarch_register_name</a> (gdbarch, regno));
<a name="l01316"></a>01316       <span class="keywordflow">break</span>;
<a name="l01317"></a>01317 
<a name="l01318"></a>01318     <span class="keywordflow">case</span> <a class="code" href="symtab_8h.html#a40bca6cf3ed5cfa15b1275e6750cdda3a154b256439f7acd7ec7f6257d5881a0f">LOC_STATIC</a>:
<a name="l01319"></a>01319       <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;static storage at address &quot;</span>));
<a name="l01320"></a>01320       load_addr = <a class="code" href="symtab_8h.html#abee697b9e3bb4f4d164ad920a87ab854">SYMBOL_VALUE_ADDRESS</a> (sym);
<a name="l01321"></a>01321       <a class="code" href="utils_8c.html#a4b28488051faf9ab4a2f07633225835f">fputs_filtered</a> (<a class="code" href="utils_8c.html#ab5c76d72090f01d3848b63dda4e37d1c">paddress</a> (gdbarch, load_addr), <a class="code" href="main_8c.html#a41a2b997ba5454df787d61f051dd918c">gdb_stdout</a>);
<a name="l01322"></a>01322       <span class="keywordflow">if</span> (<a class="code" href="symfile_8c.html#ad63f10fe5266cd2e98883d6f4c054c3a">section_is_overlay</a> (section))
<a name="l01323"></a>01323         {
<a name="l01324"></a>01324           load_addr = <a class="code" href="symfile_8c.html#a2636cd25fefea890cc48426ca960e502">overlay_unmapped_address</a> (load_addr, section);
<a name="l01325"></a>01325           <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;,\n -- loaded at &quot;</span>));
<a name="l01326"></a>01326           <a class="code" href="utils_8c.html#a4b28488051faf9ab4a2f07633225835f">fputs_filtered</a> (<a class="code" href="utils_8c.html#ab5c76d72090f01d3848b63dda4e37d1c">paddress</a> (gdbarch, load_addr), <a class="code" href="main_8c.html#a41a2b997ba5454df787d61f051dd918c">gdb_stdout</a>);
<a name="l01327"></a>01327           <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot; in overlay section %s&quot;</span>),
<a name="l01328"></a>01328                            section-&gt;<a class="code" href="structobj__section.html#ad233927d4d1037bde66ab9628ae82345">the_bfd_section</a>-&gt;name);
<a name="l01329"></a>01329         }
<a name="l01330"></a>01330       <span class="keywordflow">break</span>;
<a name="l01331"></a>01331 
<a name="l01332"></a>01332     <span class="keywordflow">case</span> <a class="code" href="symtab_8h.html#a40bca6cf3ed5cfa15b1275e6750cdda3ad9b13677899a4fbbd0f44f39726416e7">LOC_REGPARM_ADDR</a>:
<a name="l01333"></a>01333       <span class="comment">/* Note comment at LOC_REGISTER.  */</span>
<a name="l01334"></a>01334       regno = <a class="code" href="symtab_8h.html#ac3bc5f478a60882fbe5c60f3d09a0d6e">SYMBOL_REGISTER_OPS</a> (sym)-&gt;register_number (sym, gdbarch);
<a name="l01335"></a>01335       <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;address of an argument in register %s&quot;</span>),
<a name="l01336"></a>01336                        <a class="code" href="gdbarch_8c.html#a86c0cf41eb88c54e943cd80e79af36e5">gdbarch_register_name</a> (gdbarch, regno));
<a name="l01337"></a>01337       <span class="keywordflow">break</span>;
<a name="l01338"></a>01338 
<a name="l01339"></a>01339     <span class="keywordflow">case</span> <a class="code" href="symtab_8h.html#a40bca6cf3ed5cfa15b1275e6750cdda3affc89e823125f8ae758aee5fb913b308">LOC_ARG</a>:
<a name="l01340"></a>01340       <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;an argument at offset %ld&quot;</span>), val);
<a name="l01341"></a>01341       <span class="keywordflow">break</span>;
<a name="l01342"></a>01342 
<a name="l01343"></a>01343     <span class="keywordflow">case</span> <a class="code" href="symtab_8h.html#a40bca6cf3ed5cfa15b1275e6750cdda3a495b83fa459ac0722b15a3e94afadbce">LOC_LOCAL</a>:
<a name="l01344"></a>01344       <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;a local variable at frame offset %ld&quot;</span>), val);
<a name="l01345"></a>01345       <span class="keywordflow">break</span>;
<a name="l01346"></a>01346 
<a name="l01347"></a>01347     <span class="keywordflow">case</span> <a class="code" href="symtab_8h.html#a40bca6cf3ed5cfa15b1275e6750cdda3a3c444a41d837bee346e19072ca35f8d3">LOC_REF_ARG</a>:
<a name="l01348"></a>01348       <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;a reference argument at offset %ld&quot;</span>), val);
<a name="l01349"></a>01349       <span class="keywordflow">break</span>;
<a name="l01350"></a>01350 
<a name="l01351"></a>01351     <span class="keywordflow">case</span> <a class="code" href="symtab_8h.html#a40bca6cf3ed5cfa15b1275e6750cdda3ac0b2498d37ddd0f48d23739bba4abca4">LOC_TYPEDEF</a>:
<a name="l01352"></a>01352       <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;a typedef&quot;</span>));
<a name="l01353"></a>01353       <span class="keywordflow">break</span>;
<a name="l01354"></a>01354 
<a name="l01355"></a>01355     <span class="keywordflow">case</span> <a class="code" href="symtab_8h.html#a40bca6cf3ed5cfa15b1275e6750cdda3a1f1e8d54397f35889104cd7766fcec2b">LOC_BLOCK</a>:
<a name="l01356"></a>01356       <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;a function at address &quot;</span>));
<a name="l01357"></a>01357       load_addr = <a class="code" href="block_8h.html#a08fdff319bcd75e92b61c79139592af6">BLOCK_START</a> (<a class="code" href="symtab_8h.html#a2c83ea82b28e9a9d8f9b655c2d502593">SYMBOL_BLOCK_VALUE</a> (sym));
<a name="l01358"></a>01358       <a class="code" href="utils_8c.html#a4b28488051faf9ab4a2f07633225835f">fputs_filtered</a> (<a class="code" href="utils_8c.html#ab5c76d72090f01d3848b63dda4e37d1c">paddress</a> (gdbarch, load_addr), <a class="code" href="main_8c.html#a41a2b997ba5454df787d61f051dd918c">gdb_stdout</a>);
<a name="l01359"></a>01359       <span class="keywordflow">if</span> (<a class="code" href="symfile_8c.html#ad63f10fe5266cd2e98883d6f4c054c3a">section_is_overlay</a> (section))
<a name="l01360"></a>01360         {
<a name="l01361"></a>01361           load_addr = <a class="code" href="symfile_8c.html#a2636cd25fefea890cc48426ca960e502">overlay_unmapped_address</a> (load_addr, section);
<a name="l01362"></a>01362           <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;,\n -- loaded at &quot;</span>));
<a name="l01363"></a>01363           <a class="code" href="utils_8c.html#a4b28488051faf9ab4a2f07633225835f">fputs_filtered</a> (<a class="code" href="utils_8c.html#ab5c76d72090f01d3848b63dda4e37d1c">paddress</a> (gdbarch, load_addr), <a class="code" href="main_8c.html#a41a2b997ba5454df787d61f051dd918c">gdb_stdout</a>);
<a name="l01364"></a>01364           <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot; in overlay section %s&quot;</span>),
<a name="l01365"></a>01365                            section-&gt;<a class="code" href="structobj__section.html#ad233927d4d1037bde66ab9628ae82345">the_bfd_section</a>-&gt;name);
<a name="l01366"></a>01366         }
<a name="l01367"></a>01367       <span class="keywordflow">break</span>;
<a name="l01368"></a>01368 
<a name="l01369"></a>01369     <span class="keywordflow">case</span> <a class="code" href="symtab_8h.html#a40bca6cf3ed5cfa15b1275e6750cdda3a3d61e7ad56c95328fba05416abc73f7a">LOC_UNRESOLVED</a>:
<a name="l01370"></a>01370       {
<a name="l01371"></a>01371         <span class="keyword">struct </span><a class="code" href="structbound__minimal__symbol.html">bound_minimal_symbol</a> msym;
<a name="l01372"></a>01372 
<a name="l01373"></a>01373         msym = <a class="code" href="minsyms_8c.html#a2b5c5e7cf36bc97a96d7cf488afe7e4f">lookup_minimal_symbol_and_objfile</a> (<a class="code" href="symtab_8h.html#a956b56288511a18b855d8a263d60e87f">SYMBOL_LINKAGE_NAME</a> (sym));
<a name="l01374"></a>01374         <span class="keywordflow">if</span> (msym.minsym == NULL)
<a name="l01375"></a>01375           <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;unresolved&quot;</span>);
<a name="l01376"></a>01376         <span class="keywordflow">else</span>
<a name="l01377"></a>01377           {
<a name="l01378"></a>01378             section = <a class="code" href="symtab_8h.html#a68f0685d666b6934c762f89d9b996c63">SYMBOL_OBJ_SECTION</a> (msym.objfile, msym.minsym);
<a name="l01379"></a>01379             load_addr = <a class="code" href="symtab_8h.html#abee697b9e3bb4f4d164ad920a87ab854">SYMBOL_VALUE_ADDRESS</a> (msym.minsym);
<a name="l01380"></a>01380 
<a name="l01381"></a>01381             <span class="keywordflow">if</span> (section
<a name="l01382"></a>01382                 &amp;&amp; (section-&gt;<a class="code" href="structobj__section.html#ad233927d4d1037bde66ab9628ae82345">the_bfd_section</a>-&gt;flags &amp; SEC_THREAD_LOCAL) != 0)
<a name="l01383"></a>01383               <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;a thread-local variable at offset %s &quot;</span>
<a name="l01384"></a>01384                                  <span class="stringliteral">&quot;in the thread-local storage for `%s&#39;&quot;</span>),
<a name="l01385"></a>01385                                <a class="code" href="utils_8c.html#ab5c76d72090f01d3848b63dda4e37d1c">paddress</a> (gdbarch, load_addr),
<a name="l01386"></a>01386                                <a class="code" href="objfiles_8c.html#a33e548a19b86b293435d3c2d6daaaec6">objfile_name</a> (section-&gt;<a class="code" href="structobj__section.html#a3dba4273f49b43a5e8c64bd29ac39ef1">objfile</a>));
<a name="l01387"></a>01387             <span class="keywordflow">else</span>
<a name="l01388"></a>01388               {
<a name="l01389"></a>01389                 <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;static storage at address &quot;</span>));
<a name="l01390"></a>01390                 <a class="code" href="utils_8c.html#a4b28488051faf9ab4a2f07633225835f">fputs_filtered</a> (<a class="code" href="utils_8c.html#ab5c76d72090f01d3848b63dda4e37d1c">paddress</a> (gdbarch, load_addr), <a class="code" href="main_8c.html#a41a2b997ba5454df787d61f051dd918c">gdb_stdout</a>);
<a name="l01391"></a>01391                 <span class="keywordflow">if</span> (<a class="code" href="symfile_8c.html#ad63f10fe5266cd2e98883d6f4c054c3a">section_is_overlay</a> (section))
<a name="l01392"></a>01392                   {
<a name="l01393"></a>01393                     load_addr = <a class="code" href="symfile_8c.html#a2636cd25fefea890cc48426ca960e502">overlay_unmapped_address</a> (load_addr, section);
<a name="l01394"></a>01394                     <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;,\n -- loaded at &quot;</span>));
<a name="l01395"></a>01395                     <a class="code" href="utils_8c.html#a4b28488051faf9ab4a2f07633225835f">fputs_filtered</a> (<a class="code" href="utils_8c.html#ab5c76d72090f01d3848b63dda4e37d1c">paddress</a> (gdbarch, load_addr), <a class="code" href="main_8c.html#a41a2b997ba5454df787d61f051dd918c">gdb_stdout</a>);
<a name="l01396"></a>01396                     <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot; in overlay section %s&quot;</span>),
<a name="l01397"></a>01397                                      section-&gt;<a class="code" href="structobj__section.html#ad233927d4d1037bde66ab9628ae82345">the_bfd_section</a>-&gt;name);
<a name="l01398"></a>01398                   }
<a name="l01399"></a>01399               }
<a name="l01400"></a>01400           }
<a name="l01401"></a>01401       }
<a name="l01402"></a>01402       <span class="keywordflow">break</span>;
<a name="l01403"></a>01403 
<a name="l01404"></a>01404     <span class="keywordflow">case</span> <a class="code" href="symtab_8h.html#a40bca6cf3ed5cfa15b1275e6750cdda3aa4f37f80c900ee253911325c30b8a60f">LOC_OPTIMIZED_OUT</a>:
<a name="l01405"></a>01405       <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;optimized out&quot;</span>));
<a name="l01406"></a>01406       <span class="keywordflow">break</span>;
<a name="l01407"></a>01407 
<a name="l01408"></a>01408     <span class="keywordflow">default</span>:
<a name="l01409"></a>01409       <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;of unknown (botched) type&quot;</span>));
<a name="l01410"></a>01410       <span class="keywordflow">break</span>;
<a name="l01411"></a>01411     }
<a name="l01412"></a>01412   <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;.\n&quot;</span>);
<a name="l01413"></a>01413 }
<a name="l01414"></a>01414 
<a name="l01415"></a>01415 
<a name="l01416"></a>01416 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01417"></a>01417 x_command (<span class="keywordtype">char</span> *exp, <span class="keywordtype">int</span> from_tty)
<a name="l01418"></a>01418 {
<a name="l01419"></a>01419   <span class="keyword">struct </span><a class="code" href="structexpression.html">expression</a> *expr;
<a name="l01420"></a>01420   <span class="keyword">struct </span>format_data fmt;
<a name="l01421"></a>01421   <span class="keyword">struct </span>cleanup *old_chain;
<a name="l01422"></a>01422   <span class="keyword">struct </span>value *val;
<a name="l01423"></a>01423 
<a name="l01424"></a>01424   fmt.format = last_format ? last_format : <span class="charliteral">&#39;x&#39;</span>;
<a name="l01425"></a>01425   fmt.size = last_size;
<a name="l01426"></a>01426   fmt.count = 1;
<a name="l01427"></a>01427   fmt.raw = 0;
<a name="l01428"></a>01428 
<a name="l01429"></a>01429   <span class="keywordflow">if</span> (exp &amp;&amp; *exp == <span class="charliteral">&#39;/&#39;</span>)
<a name="l01430"></a>01430     {
<a name="l01431"></a>01431       <span class="keyword">const</span> <span class="keywordtype">char</span> *tmp = exp + 1;
<a name="l01432"></a>01432 
<a name="l01433"></a>01433       fmt = decode_format (&amp;tmp, last_format, last_size);
<a name="l01434"></a>01434       exp = (<span class="keywordtype">char</span> *) tmp;
<a name="l01435"></a>01435     }
<a name="l01436"></a>01436 
<a name="l01437"></a>01437   <span class="comment">/* If we have an expression, evaluate it and use it as the address.  */</span>
<a name="l01438"></a>01438 
<a name="l01439"></a>01439   <span class="keywordflow">if</span> (exp != 0 &amp;&amp; *exp != 0)
<a name="l01440"></a>01440     {
<a name="l01441"></a>01441       expr = <a class="code" href="expression_8h.html#a286599225dbfecf78c83d1eb5261f25a">parse_expression</a> (exp);
<a name="l01442"></a>01442       <span class="comment">/* Cause expression not to be there any more if this command is</span>
<a name="l01443"></a>01443 <span class="comment">         repeated with Newline.  But don&#39;t clobber a user-defined</span>
<a name="l01444"></a>01444 <span class="comment">         command&#39;s definition.  */</span>
<a name="l01445"></a>01445       <span class="keywordflow">if</span> (from_tty)
<a name="l01446"></a>01446         *exp = 0;
<a name="l01447"></a>01447       old_chain = <a class="code" href="cleanups_8c.html#a3d418f8af424aec399898c2d48b26224">make_cleanup</a> (<a class="code" href="utils_8c.html#a6d8c21606d3f67a431a7bfbb1f47d12e">free_current_contents</a>, &amp;expr);
<a name="l01448"></a>01448       val = <a class="code" href="eval_8c.html#ab50151ccba3ea3184c114121d6bed422">evaluate_expression</a> (expr);
<a name="l01449"></a>01449       <span class="keywordflow">if</span> (<a class="code" href="gdbtypes_8h.html#a9505f41c7012665947c6b4065ce190e1">TYPE_CODE</a> (<a class="code" href="value_8c.html#a263a4c0bee0b0df41074b952d3c121d0">value_type</a> (val)) == <a class="code" href="gdbtypes_8h.html#a90e2a0fddaa6afff6a0a489ff4da3462a476430709e5a251f7e0f8e3fb48a713f">TYPE_CODE_REF</a>)
<a name="l01450"></a>01450         val = <a class="code" href="value_8c.html#aed5580291c7c798d71b3346932048a12">coerce_ref</a> (val);
<a name="l01451"></a>01451       <span class="comment">/* In rvalue contexts, such as this, functions are coerced into</span>
<a name="l01452"></a>01452 <span class="comment">         pointers to functions.  This makes &quot;x/i main&quot; work.  */</span>
<a name="l01453"></a>01453       <span class="keywordflow">if</span> (<span class="comment">/* last_format == &#39;i&#39;  &amp;&amp; */</span> 
<a name="l01454"></a>01454           <a class="code" href="gdbtypes_8h.html#a9505f41c7012665947c6b4065ce190e1">TYPE_CODE</a> (<a class="code" href="value_8c.html#a263a4c0bee0b0df41074b952d3c121d0">value_type</a> (val)) == <a class="code" href="gdbtypes_8h.html#a90e2a0fddaa6afff6a0a489ff4da3462a4b6327934915849a4e96eef151fe312b">TYPE_CODE_FUNC</a>
<a name="l01455"></a>01455            &amp;&amp; <a class="code" href="value_8h.html#a39f15e604dd7037545ce2774310b0cd5">VALUE_LVAL</a> (val) == <a class="code" href="defs_8h.html#aae40e9877f56980bf8fac75923a098aba04e4ffc3d93e9a0cdec974596a72c17e">lval_memory</a>)
<a name="l01456"></a>01456         next_address = <a class="code" href="value_8c.html#a64c795fa1a8854682b3b727025d0d31d">value_address</a> (val);
<a name="l01457"></a>01457       <span class="keywordflow">else</span>
<a name="l01458"></a>01458         next_address = <a class="code" href="value_8c.html#a2e64d8ca2ab5480e05097c6b2df1aa02">value_as_address</a> (val);
<a name="l01459"></a>01459 
<a name="l01460"></a>01460       next_gdbarch = expr-&gt;<a class="code" href="structexpression.html#ae549c2e4f2dd35e0c72338c37eee2961">gdbarch</a>;
<a name="l01461"></a>01461       <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (old_chain);
<a name="l01462"></a>01462     }
<a name="l01463"></a>01463 
<a name="l01464"></a>01464   <span class="keywordflow">if</span> (!next_gdbarch)
<a name="l01465"></a>01465     <a class="code" href="cli-cmds_8c.html#a68aef78cdf72abc9df2495a4618842c3">error_no_arg</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;starting display address&quot;</span>));
<a name="l01466"></a>01466 
<a name="l01467"></a>01467   do_examine (fmt, next_gdbarch, next_address);
<a name="l01468"></a>01468 
<a name="l01469"></a>01469   <span class="comment">/* If the examine succeeds, we remember its size and format for next</span>
<a name="l01470"></a>01470 <span class="comment">     time.  Set last_size to &#39;b&#39; for strings.  */</span>
<a name="l01471"></a>01471   <span class="keywordflow">if</span> (fmt.format == <span class="charliteral">&#39;s&#39;</span>)
<a name="l01472"></a>01472     last_size = <span class="charliteral">&#39;b&#39;</span>;
<a name="l01473"></a>01473   <span class="keywordflow">else</span>
<a name="l01474"></a>01474     last_size = fmt.size;
<a name="l01475"></a>01475   last_format = fmt.format;
<a name="l01476"></a>01476 
<a name="l01477"></a>01477   <span class="comment">/* Set a couple of internal variables if appropriate.  */</span>
<a name="l01478"></a>01478   <span class="keywordflow">if</span> (last_examine_value)
<a name="l01479"></a>01479     {
<a name="l01480"></a>01480       <span class="comment">/* Make last address examined available to the user as $_.  Use</span>
<a name="l01481"></a>01481 <span class="comment">         the correct pointer type.  */</span>
<a name="l01482"></a>01482       <span class="keyword">struct </span>type *<a class="code" href="language_8c.html#a34c67a62b04ac4b1e6131f6f6d009e3c">pointer_type</a>
<a name="l01483"></a>01483         = <a class="code" href="gdbtypes_8c.html#a8edb8d75a169b1455414b420088d1887">lookup_pointer_type</a> (<a class="code" href="value_8c.html#a263a4c0bee0b0df41074b952d3c121d0">value_type</a> (last_examine_value));
<a name="l01484"></a>01484       <a class="code" href="value_8c.html#a8e5fd3bd77e20876ececbe85d2c8b568">set_internalvar</a> (<a class="code" href="value_8c.html#ac96b41b37d2b8eeb44137ec148ca5c7c">lookup_internalvar</a> (<span class="stringliteral">&quot;_&quot;</span>),
<a name="l01485"></a>01485                        <a class="code" href="value_8c.html#a2f2d0d3d3ce482fc844f1fc4dc4c038e">value_from_pointer</a> (pointer_type,
<a name="l01486"></a>01486                                            last_examine_address));
<a name="l01487"></a>01487 
<a name="l01488"></a>01488       <span class="comment">/* Make contents of last address examined available to the user</span>
<a name="l01489"></a>01489 <span class="comment">         as $__.  If the last value has not been fetched from memory</span>
<a name="l01490"></a>01490 <span class="comment">         then don&#39;t fetch it now; instead mark it by voiding the $__</span>
<a name="l01491"></a>01491 <span class="comment">         variable.  */</span>
<a name="l01492"></a>01492       <span class="keywordflow">if</span> (<a class="code" href="value_8c.html#aa60bc8ecf77867a2d16bec57a4ccf983">value_lazy</a> (last_examine_value))
<a name="l01493"></a>01493         <a class="code" href="value_8c.html#a2276a7b2cff4903ca0e4818627a39ad0">clear_internalvar</a> (<a class="code" href="value_8c.html#ac96b41b37d2b8eeb44137ec148ca5c7c">lookup_internalvar</a> (<span class="stringliteral">&quot;__&quot;</span>));
<a name="l01494"></a>01494       <span class="keywordflow">else</span>
<a name="l01495"></a>01495         <a class="code" href="value_8c.html#a8e5fd3bd77e20876ececbe85d2c8b568">set_internalvar</a> (<a class="code" href="value_8c.html#ac96b41b37d2b8eeb44137ec148ca5c7c">lookup_internalvar</a> (<span class="stringliteral">&quot;__&quot;</span>), last_examine_value);
<a name="l01496"></a>01496     }
<a name="l01497"></a>01497 }
<a name="l01498"></a>01498 
<a name="l01499"></a>01499 
<a name="l01500"></a>01500 <span class="comment">/* Add an expression to the auto-display chain.</span>
<a name="l01501"></a>01501 <span class="comment">   Specify the expression.  */</span>
<a name="l01502"></a>01502 
<a name="l01503"></a>01503 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01504"></a>01504 display_command (<span class="keywordtype">char</span> *arg, <span class="keywordtype">int</span> from_tty)
<a name="l01505"></a>01505 {
<a name="l01506"></a>01506   <span class="keyword">struct </span>format_data fmt;
<a name="l01507"></a>01507   <span class="keyword">struct </span><a class="code" href="structexpression.html">expression</a> *expr;
<a name="l01508"></a>01508   <span class="keyword">struct </span>display *<span class="keyword">new</span>;
<a name="l01509"></a>01509   <span class="keywordtype">int</span> display_it = 1;
<a name="l01510"></a>01510   <span class="keyword">const</span> <span class="keywordtype">char</span> *exp = arg;
<a name="l01511"></a>01511 
<a name="l01512"></a>01512 <span class="preprocessor">#if defined(TUI)</span>
<a name="l01513"></a>01513 <span class="preprocessor"></span>  <span class="comment">/* NOTE: cagney/2003-02-13 The `tui_active&#39; was previously</span>
<a name="l01514"></a>01514 <span class="comment">     `tui_version&#39;.  */</span>
<a name="l01515"></a>01515   <span class="keywordflow">if</span> (<a class="code" href="tui_8c.html#af628f052355ae9fac2e99e35b7376d1f">tui_active</a> &amp;&amp; exp != NULL &amp;&amp; *exp == <span class="charliteral">&#39;$&#39;</span>)
<a name="l01516"></a>01516     display_it = (<a class="code" href="tui-layout_8c.html#a714e5da8daf6a16e1aeada6517b1ddf7">tui_set_layout_for_display_command</a> (exp) == <a class="code" href="tui_8h.html#a5e25e7ba791531c0c4f40e2b83477ce5a8abbd920e90138fbcc8d76dfa2666179">TUI_FAILURE</a>);
<a name="l01517"></a>01517 <span class="preprocessor">#endif</span>
<a name="l01518"></a>01518 <span class="preprocessor"></span>
<a name="l01519"></a>01519   <span class="keywordflow">if</span> (display_it)
<a name="l01520"></a>01520     {
<a name="l01521"></a>01521       <span class="keywordflow">if</span> (exp == 0)
<a name="l01522"></a>01522         {
<a name="l01523"></a>01523           <a class="code" href="breakpoint_8h.html#adee48b85cffb58177a89bd1b83ad5242">do_displays</a> ();
<a name="l01524"></a>01524           <span class="keywordflow">return</span>;
<a name="l01525"></a>01525         }
<a name="l01526"></a>01526 
<a name="l01527"></a>01527       <span class="keywordflow">if</span> (*exp == <span class="charliteral">&#39;/&#39;</span>)
<a name="l01528"></a>01528         {
<a name="l01529"></a>01529           exp++;
<a name="l01530"></a>01530           fmt = decode_format (&amp;exp, 0, 0);
<a name="l01531"></a>01531           <span class="keywordflow">if</span> (fmt.size &amp;&amp; fmt.format == 0)
<a name="l01532"></a>01532             fmt.format = <span class="charliteral">&#39;x&#39;</span>;
<a name="l01533"></a>01533           <span class="keywordflow">if</span> (fmt.format == <span class="charliteral">&#39;i&#39;</span> || fmt.format == <span class="charliteral">&#39;s&#39;</span>)
<a name="l01534"></a>01534             fmt.size = <span class="charliteral">&#39;b&#39;</span>;
<a name="l01535"></a>01535         }
<a name="l01536"></a>01536       <span class="keywordflow">else</span>
<a name="l01537"></a>01537         {
<a name="l01538"></a>01538           fmt.format = 0;
<a name="l01539"></a>01539           fmt.size = 0;
<a name="l01540"></a>01540           fmt.count = 0;
<a name="l01541"></a>01541           fmt.raw = 0;
<a name="l01542"></a>01542         }
<a name="l01543"></a>01543 
<a name="l01544"></a>01544       <a class="code" href="expression_8h.html#a6b2028f35010cd9648aa5d5e8f7d653d">innermost_block</a> = NULL;
<a name="l01545"></a>01545       expr = <a class="code" href="expression_8h.html#a286599225dbfecf78c83d1eb5261f25a">parse_expression</a> (exp);
<a name="l01546"></a>01546 
<a name="l01547"></a>01547       <span class="keyword">new</span> = (<span class="keyword">struct </span>display *) <a class="code" href="common-utils_8c.html#a634d6cd850bb831afebc499579303b3b">xmalloc</a> (<span class="keyword">sizeof</span> (<span class="keyword">struct</span> display));
<a name="l01548"></a>01548 
<a name="l01549"></a>01549       <span class="keyword">new</span>-&gt;exp_string = xstrdup (exp);
<a name="l01550"></a>01550       <span class="keyword">new</span>-&gt;exp = expr;
<a name="l01551"></a>01551       <span class="keyword">new</span>-&gt;block = <a class="code" href="expression_8h.html#a6b2028f35010cd9648aa5d5e8f7d653d">innermost_block</a>;
<a name="l01552"></a>01552       <span class="keyword">new</span>-&gt;pspace = <a class="code" href="progspace_8c.html#a07722ff15a98814c086dda44f93380c9">current_program_space</a>;
<a name="l01553"></a>01553       <span class="keyword">new</span>-&gt;<a class="code" href="structprogram__space.html#af670d427a30ed1ca21cec72d6429c4dc">next</a> = display_chain;
<a name="l01554"></a>01554       <span class="keyword">new</span>-&gt;number = ++display_number;
<a name="l01555"></a>01555       <span class="keyword">new</span>-&gt;format = fmt;
<a name="l01556"></a>01556       <span class="keyword">new</span>-&gt;enabled_p = 1;
<a name="l01557"></a>01557       display_chain = <span class="keyword">new</span>;
<a name="l01558"></a>01558 
<a name="l01559"></a>01559       <span class="keywordflow">if</span> (from_tty &amp;&amp; <a class="code" href="target_8h.html#a85885df22f7c1304269eaba1e1d618b7">target_has_execution</a>)
<a name="l01560"></a>01560         do_one_display (<span class="keyword">new</span>);
<a name="l01561"></a>01561 
<a name="l01562"></a>01562       <a class="code" href="command_8h.html#ac7af34b03605d65b114a173d49532050">dont_repeat</a> ();
<a name="l01563"></a>01563     }
<a name="l01564"></a>01564 }
<a name="l01565"></a>01565 
<a name="l01566"></a>01566 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01567"></a>01567 free_display (<span class="keyword">struct</span> display *d)
<a name="l01568"></a>01568 {
<a name="l01569"></a>01569   <a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a> (d-&gt;exp_string);
<a name="l01570"></a>01570   <a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a> (d-&gt;exp);
<a name="l01571"></a>01571   <a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a> (d);
<a name="l01572"></a>01572 }
<a name="l01573"></a>01573 
<a name="l01574"></a>01574 <span class="comment">/* Clear out the display_chain.  Done when new symtabs are loaded,</span>
<a name="l01575"></a>01575 <span class="comment">   since this invalidates the types stored in many expressions.  */</span>
<a name="l01576"></a>01576 
<a name="l01577"></a>01577 <span class="keywordtype">void</span>
<a name="l01578"></a><a class="code" href="printcmd_8c.html#ab30c38f8f81c6bfd1ff56ada4e4a2d53">01578</a> <a class="code" href="breakpoint_8h.html#ab30c38f8f81c6bfd1ff56ada4e4a2d53">clear_displays</a> (<span class="keywordtype">void</span>)
<a name="l01579"></a>01579 {
<a name="l01580"></a>01580   <span class="keyword">struct </span>display *d;
<a name="l01581"></a>01581 
<a name="l01582"></a>01582   <span class="keywordflow">while</span> ((d = display_chain) != NULL)
<a name="l01583"></a>01583     {
<a name="l01584"></a>01584       display_chain = d-&gt;next;
<a name="l01585"></a>01585       free_display (d);
<a name="l01586"></a>01586     }
<a name="l01587"></a>01587 }
<a name="l01588"></a>01588 
<a name="l01589"></a>01589 <span class="comment">/* Delete the auto-display DISPLAY.  */</span>
<a name="l01590"></a>01590 
<a name="l01591"></a>01591 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01592"></a>01592 delete_display (<span class="keyword">struct</span> display *display)
<a name="l01593"></a>01593 {
<a name="l01594"></a>01594   <span class="keyword">struct </span>display *d;
<a name="l01595"></a>01595 
<a name="l01596"></a>01596   <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (display != NULL);
<a name="l01597"></a>01597 
<a name="l01598"></a>01598   <span class="keywordflow">if</span> (display_chain == display)
<a name="l01599"></a>01599     display_chain = display-&gt;next;
<a name="l01600"></a>01600 
<a name="l01601"></a>01601   <a class="code" href="printcmd_8c.html#a60a8b7fbd6675e03f28c0f14bbffab2e">ALL_DISPLAYS</a> (d)
<a name="l01602"></a>01602     if (d-&gt;next == display)
<a name="l01603"></a>01603       {
<a name="l01604"></a>01604         d-&gt;next = display-&gt;next;
<a name="l01605"></a>01605         <span class="keywordflow">break</span>;
<a name="l01606"></a>01606       }
<a name="l01607"></a>01607 
<a name="l01608"></a>01608   free_display (display);
<a name="l01609"></a>01609 }
<a name="l01610"></a>01610 
<a name="l01611"></a>01611 <span class="comment">/* Call FUNCTION on each of the displays whose numbers are given in</span>
<a name="l01612"></a>01612 <span class="comment">   ARGS.  DATA is passed unmodified to FUNCTION.  */</span>
<a name="l01613"></a>01613 
<a name="l01614"></a>01614 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01615"></a>01615 map_display_numbers (<span class="keywordtype">char</span> *args,
<a name="l01616"></a>01616                      <span class="keywordtype">void</span> (*<span class="keyword">function</span>) (<span class="keyword">struct</span> display *,
<a name="l01617"></a>01617                                        <span class="keywordtype">void</span> *),
<a name="l01618"></a>01618                      <span class="keywordtype">void</span> *data)
<a name="l01619"></a>01619 {
<a name="l01620"></a>01620   <span class="keyword">struct </span><a class="code" href="structget__number__or__range__state.html">get_number_or_range_state</a> state;
<a name="l01621"></a>01621   <span class="keywordtype">int</span> num;
<a name="l01622"></a>01622 
<a name="l01623"></a>01623   <span class="keywordflow">if</span> (args == NULL)
<a name="l01624"></a>01624     <a class="code" href="cli-cmds_8c.html#a68aef78cdf72abc9df2495a4618842c3">error_no_arg</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;one or more display numbers&quot;</span>));
<a name="l01625"></a>01625 
<a name="l01626"></a>01626   <a class="code" href="cli-utils_8c.html#a8c5a78ced74fbfc685ab08664c47fa9b">init_number_or_range</a> (&amp;state, args);
<a name="l01627"></a>01627 
<a name="l01628"></a>01628   <span class="keywordflow">while</span> (!state.finished)
<a name="l01629"></a>01629     {
<a name="l01630"></a>01630       <span class="keywordtype">char</span> *p = state.string;
<a name="l01631"></a>01631 
<a name="l01632"></a>01632       num = <a class="code" href="cli-utils_8c.html#a6d6bbeb272a5fb5ac91e7e2a20e54fef">get_number_or_range</a> (&amp;state);
<a name="l01633"></a>01633       <span class="keywordflow">if</span> (num == 0)
<a name="l01634"></a>01634         <a class="code" href="utils_8c.html#a5fc201a4181499a6b4057a6caa15b5e2">warning</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;bad display number at or near &#39;%s&#39;&quot;</span>), p);
<a name="l01635"></a>01635       <span class="keywordflow">else</span>
<a name="l01636"></a>01636         {
<a name="l01637"></a>01637           <span class="keyword">struct </span>display *d, *tmp;
<a name="l01638"></a>01638 
<a name="l01639"></a>01639           <a class="code" href="printcmd_8c.html#ad8c91345cffaa94ab0113700552d2d8c">ALL_DISPLAYS_SAFE</a> (d, tmp)
<a name="l01640"></a>01640             if (d-&gt;number == num)
<a name="l01641"></a>01641               break;
<a name="l01642"></a>01642           if (d == NULL)
<a name="l01643"></a>01643             <a class="code" href="utils_8c.html#ad57145632bbcb0361dc1dfa134b1efd0">printf_unfiltered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(&quot;No display number %d.\n&quot;), num);
<a name="l01644"></a>01644           else
<a name="l01645"></a>01645             function (d, data);
<a name="l01646"></a>01646         }
<a name="l01647"></a>01647     }
<a name="l01648"></a>01648 }
<a name="l01649"></a>01649 
<a name="l01650"></a>01650 <span class="comment">/* Callback for map_display_numbers, that deletes a display.  */</span>
<a name="l01651"></a>01651 
<a name="l01652"></a>01652 static <span class="keywordtype">void</span>
<a name="l01653"></a>01653 do_delete_display (struct display *d, <span class="keywordtype">void</span> *data)
<a name="l01654"></a>01654 {
<a name="l01655"></a>01655   delete_display (d);
<a name="l01656"></a>01656 }
<a name="l01657"></a>01657 
<a name="l01658"></a>01658 <span class="comment">/* &quot;undisplay&quot; command.  */</span>
<a name="l01659"></a>01659 
<a name="l01660"></a>01660 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01661"></a>01661 undisplay_command (<span class="keywordtype">char</span> *args, <span class="keywordtype">int</span> from_tty)
<a name="l01662"></a>01662 {
<a name="l01663"></a>01663   <span class="keywordflow">if</span> (args == NULL)
<a name="l01664"></a>01664     {
<a name="l01665"></a>01665       <span class="keywordflow">if</span> (<a class="code" href="utils_8c.html#a4b369431cd1ce5d26bccf6b79a44c085">query</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Delete all auto-display expressions? &quot;</span>)))
<a name="l01666"></a>01666         <a class="code" href="breakpoint_8h.html#ab30c38f8f81c6bfd1ff56ada4e4a2d53">clear_displays</a> ();
<a name="l01667"></a>01667       <a class="code" href="command_8h.html#ac7af34b03605d65b114a173d49532050">dont_repeat</a> ();
<a name="l01668"></a>01668       <span class="keywordflow">return</span>;
<a name="l01669"></a>01669     }
<a name="l01670"></a>01670 
<a name="l01671"></a>01671   map_display_numbers (args, do_delete_display, NULL);
<a name="l01672"></a>01672   <a class="code" href="command_8h.html#ac7af34b03605d65b114a173d49532050">dont_repeat</a> ();
<a name="l01673"></a>01673 }
<a name="l01674"></a>01674 
<a name="l01675"></a>01675 <span class="comment">/* Display a single auto-display.  </span>
<a name="l01676"></a>01676 <span class="comment">   Do nothing if the display cannot be printed in the current context,</span>
<a name="l01677"></a>01677 <span class="comment">   or if the display is disabled.  */</span>
<a name="l01678"></a>01678 
<a name="l01679"></a>01679 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01680"></a>01680 do_one_display (<span class="keyword">struct</span> display *d)
<a name="l01681"></a>01681 {
<a name="l01682"></a>01682   <span class="keyword">struct </span>cleanup *old_chain;
<a name="l01683"></a>01683   <span class="keywordtype">int</span> within_current_scope;
<a name="l01684"></a>01684 
<a name="l01685"></a>01685   <span class="keywordflow">if</span> (d-&gt;enabled_p == 0)
<a name="l01686"></a>01686     <span class="keywordflow">return</span>;
<a name="l01687"></a>01687 
<a name="l01688"></a>01688   <span class="comment">/* The expression carries the architecture that was used at parse time.</span>
<a name="l01689"></a>01689 <span class="comment">     This is a problem if the expression depends on architecture features</span>
<a name="l01690"></a>01690 <span class="comment">     (e.g. register numbers), and the current architecture is now different.</span>
<a name="l01691"></a>01691 <span class="comment">     For example, a display statement like &quot;display/i $pc&quot; is expected to</span>
<a name="l01692"></a>01692 <span class="comment">     display the PC register of the current architecture, not the arch at</span>
<a name="l01693"></a>01693 <span class="comment">     the time the display command was given.  Therefore, we re-parse the</span>
<a name="l01694"></a>01694 <span class="comment">     expression if the current architecture has changed.  */</span>
<a name="l01695"></a>01695   <span class="keywordflow">if</span> (d-&gt;exp != NULL &amp;&amp; d-&gt;exp-&gt;gdbarch != <a class="code" href="arch-utils_8c.html#a0fe1e68475f442e5d6dda589e0c62454">get_current_arch</a> ())
<a name="l01696"></a>01696     {
<a name="l01697"></a>01697       <a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a> (d-&gt;exp);
<a name="l01698"></a>01698       d-&gt;exp = NULL;
<a name="l01699"></a>01699       d-&gt;block = NULL;
<a name="l01700"></a>01700     }
<a name="l01701"></a>01701 
<a name="l01702"></a>01702   <span class="keywordflow">if</span> (d-&gt;exp == NULL)
<a name="l01703"></a>01703     {
<a name="l01704"></a>01704       <span class="keyword">volatile</span> <span class="keyword">struct </span><a class="code" href="structgdb__exception.html">gdb_exception</a> ex;
<a name="l01705"></a>01705 
<a name="l01706"></a>01706       <a class="code" href="exceptions_8h.html#aef4514ee39b9305fddee27f49c7c34eb">TRY_CATCH</a> (ex, <a class="code" href="exceptions_8h.html#abfa3a3b99557b11f5766baf69465fdf6ab50fde886a7de8c013bf2bd4e7c073a4">RETURN_MASK_ALL</a>)
<a name="l01707"></a>01707         {
<a name="l01708"></a>01708           <a class="code" href="expression_8h.html#a6b2028f35010cd9648aa5d5e8f7d653d">innermost_block</a> = NULL;
<a name="l01709"></a>01709           d-&gt;exp = <a class="code" href="expression_8h.html#a286599225dbfecf78c83d1eb5261f25a">parse_expression</a> (d-&gt;exp_string);
<a name="l01710"></a>01710           d-&gt;block = <a class="code" href="expression_8h.html#a6b2028f35010cd9648aa5d5e8f7d653d">innermost_block</a>;
<a name="l01711"></a>01711         }
<a name="l01712"></a>01712       <span class="keywordflow">if</span> (ex.reason &lt; 0)
<a name="l01713"></a>01713         {
<a name="l01714"></a>01714           <span class="comment">/* Can&#39;t re-parse the expression.  Disable this display item.  */</span>
<a name="l01715"></a>01715           d-&gt;enabled_p = 0;
<a name="l01716"></a>01716           <a class="code" href="utils_8c.html#a5fc201a4181499a6b4057a6caa15b5e2">warning</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Unable to display \&quot;%s\&quot;: %s&quot;</span>),
<a name="l01717"></a>01717                    d-&gt;exp_string, ex.message);
<a name="l01718"></a>01718           <span class="keywordflow">return</span>;
<a name="l01719"></a>01719         }
<a name="l01720"></a>01720     }
<a name="l01721"></a>01721 
<a name="l01722"></a>01722   <span class="keywordflow">if</span> (d-&gt;block)
<a name="l01723"></a>01723     {
<a name="l01724"></a>01724       <span class="keywordflow">if</span> (d-&gt;pspace == <a class="code" href="progspace_8c.html#a07722ff15a98814c086dda44f93380c9">current_program_space</a>)
<a name="l01725"></a>01725         within_current_scope = <a class="code" href="block_8c.html#a24329baf96c81f9fa59a469df0a1b018">contained_in</a> (<a class="code" href="frame_8h.html#a91efbdcf182d840c28d378def97cfc23">get_selected_block</a> (0), d-&gt;block);
<a name="l01726"></a>01726       <span class="keywordflow">else</span>
<a name="l01727"></a>01727         within_current_scope = 0;
<a name="l01728"></a>01728     }
<a name="l01729"></a>01729   <span class="keywordflow">else</span>
<a name="l01730"></a>01730     within_current_scope = 1;
<a name="l01731"></a>01731   <span class="keywordflow">if</span> (!within_current_scope)
<a name="l01732"></a>01732     <span class="keywordflow">return</span>;
<a name="l01733"></a>01733 
<a name="l01734"></a>01734   old_chain = <a class="code" href="utils_8c.html#aa4b9e7f0b6abb5f93fc0ac366f7614c0">make_cleanup_restore_integer</a> (&amp;current_display_number);
<a name="l01735"></a>01735   current_display_number = d-&gt;number;
<a name="l01736"></a>01736 
<a name="l01737"></a>01737   <a class="code" href="annotate_8c.html#acb897dea5bbf416152a26d57eebadaae">annotate_display_begin</a> ();
<a name="l01738"></a>01738   <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;%d&quot;</span>, d-&gt;number);
<a name="l01739"></a>01739   <a class="code" href="annotate_8c.html#a121e35535f09cfda1939356114427867">annotate_display_number_end</a> ();
<a name="l01740"></a>01740   <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;: &quot;</span>);
<a name="l01741"></a>01741   <span class="keywordflow">if</span> (d-&gt;format.size)
<a name="l01742"></a>01742     {
<a name="l01743"></a>01743       <span class="keyword">volatile</span> <span class="keyword">struct </span><a class="code" href="structgdb__exception.html">gdb_exception</a> ex;
<a name="l01744"></a>01744 
<a name="l01745"></a>01745       <a class="code" href="annotate_8c.html#ace2f72bc1cab8a17688b07e7c047a757">annotate_display_format</a> ();
<a name="l01746"></a>01746 
<a name="l01747"></a>01747       <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;x/&quot;</span>);
<a name="l01748"></a>01748       <span class="keywordflow">if</span> (d-&gt;format.count != 1)
<a name="l01749"></a>01749         <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;%d&quot;</span>, d-&gt;format.count);
<a name="l01750"></a>01750       <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;%c&quot;</span>, d-&gt;format.format);
<a name="l01751"></a>01751       <span class="keywordflow">if</span> (d-&gt;format.format != <span class="charliteral">&#39;i&#39;</span> &amp;&amp; d-&gt;format.format != <span class="charliteral">&#39;s&#39;</span>)
<a name="l01752"></a>01752         <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;%c&quot;</span>, d-&gt;format.size);
<a name="l01753"></a>01753       <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot; &quot;</span>);
<a name="l01754"></a>01754 
<a name="l01755"></a>01755       <a class="code" href="annotate_8c.html#a26c57b6c91525f5e9b8737d8f3000e13">annotate_display_expression</a> ();
<a name="l01756"></a>01756 
<a name="l01757"></a>01757       <a class="code" href="utils_8c.html#ab4c30e1b3fe2dfa6e73f320a6758ad5f">puts_filtered</a> (d-&gt;exp_string);
<a name="l01758"></a>01758       <a class="code" href="annotate_8c.html#af38adef09219e3c0749ab0fc316b0399">annotate_display_expression_end</a> ();
<a name="l01759"></a>01759 
<a name="l01760"></a>01760       <span class="keywordflow">if</span> (d-&gt;format.count != 1 || d-&gt;format.format == <span class="charliteral">&#39;i&#39;</span>)
<a name="l01761"></a>01761         <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l01762"></a>01762       <span class="keywordflow">else</span>
<a name="l01763"></a>01763         <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;  &quot;</span>);
<a name="l01764"></a>01764 
<a name="l01765"></a>01765       <a class="code" href="annotate_8c.html#acb467327db2cb7ff9c6acf51b763ca1c">annotate_display_value</a> ();
<a name="l01766"></a>01766 
<a name="l01767"></a>01767       <a class="code" href="exceptions_8h.html#aef4514ee39b9305fddee27f49c7c34eb">TRY_CATCH</a> (ex, <a class="code" href="exceptions_8h.html#abfa3a3b99557b11f5766baf69465fdf6a44de51845416ac49ab08438792b908f0">RETURN_MASK_ERROR</a>)
<a name="l01768"></a>01768         {
<a name="l01769"></a>01769           <span class="keyword">struct </span>value *val;
<a name="l01770"></a>01770           <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> addr;
<a name="l01771"></a>01771 
<a name="l01772"></a>01772           val = <a class="code" href="eval_8c.html#ab50151ccba3ea3184c114121d6bed422">evaluate_expression</a> (d-&gt;exp);
<a name="l01773"></a>01773           addr = <a class="code" href="value_8c.html#a2e64d8ca2ab5480e05097c6b2df1aa02">value_as_address</a> (val);
<a name="l01774"></a>01774           <span class="keywordflow">if</span> (d-&gt;format.format == <span class="charliteral">&#39;i&#39;</span>)
<a name="l01775"></a>01775             addr = <a class="code" href="gdbarch_8c.html#abee635dc7cb9e9793c6100971df1a859">gdbarch_addr_bits_remove</a> (d-&gt;exp-&gt;gdbarch, addr);
<a name="l01776"></a>01776           do_examine (d-&gt;format, d-&gt;exp-&gt;gdbarch, addr);
<a name="l01777"></a>01777         }
<a name="l01778"></a>01778       <span class="keywordflow">if</span> (ex.reason &lt; 0)
<a name="l01779"></a>01779         <a class="code" href="utils_8c.html#aaa819b1a6c0b6c4090bdc0b027eaf64b">fprintf_filtered</a> (<a class="code" href="main_8c.html#a41a2b997ba5454df787d61f051dd918c">gdb_stdout</a>, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;&lt;error: %s&gt;\n&quot;</span>), ex.message);
<a name="l01780"></a>01780     }
<a name="l01781"></a>01781   <span class="keywordflow">else</span>
<a name="l01782"></a>01782     {
<a name="l01783"></a>01783       <span class="keyword">struct </span><a class="code" href="structvalue__print__options.html">value_print_options</a> opts;
<a name="l01784"></a>01784       <span class="keyword">volatile</span> <span class="keyword">struct </span><a class="code" href="structgdb__exception.html">gdb_exception</a> ex;
<a name="l01785"></a>01785 
<a name="l01786"></a>01786       <a class="code" href="annotate_8c.html#ace2f72bc1cab8a17688b07e7c047a757">annotate_display_format</a> ();
<a name="l01787"></a>01787 
<a name="l01788"></a>01788       <span class="keywordflow">if</span> (d-&gt;format.format)
<a name="l01789"></a>01789         <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;/%c &quot;</span>, d-&gt;format.format);
<a name="l01790"></a>01790 
<a name="l01791"></a>01791       <a class="code" href="annotate_8c.html#a26c57b6c91525f5e9b8737d8f3000e13">annotate_display_expression</a> ();
<a name="l01792"></a>01792 
<a name="l01793"></a>01793       <a class="code" href="utils_8c.html#ab4c30e1b3fe2dfa6e73f320a6758ad5f">puts_filtered</a> (d-&gt;exp_string);
<a name="l01794"></a>01794       <a class="code" href="annotate_8c.html#af38adef09219e3c0749ab0fc316b0399">annotate_display_expression_end</a> ();
<a name="l01795"></a>01795 
<a name="l01796"></a>01796       <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot; = &quot;</span>);
<a name="l01797"></a>01797 
<a name="l01798"></a>01798       <a class="code" href="annotate_8c.html#a26c57b6c91525f5e9b8737d8f3000e13">annotate_display_expression</a> ();
<a name="l01799"></a>01799 
<a name="l01800"></a>01800       <a class="code" href="valprint_8c.html#a1177f66ae5a60db2a75604f268dba57f">get_formatted_print_options</a> (&amp;opts, d-&gt;format.format);
<a name="l01801"></a>01801       opts.raw = d-&gt;format.raw;
<a name="l01802"></a>01802 
<a name="l01803"></a>01803       <a class="code" href="exceptions_8h.html#aef4514ee39b9305fddee27f49c7c34eb">TRY_CATCH</a> (ex, <a class="code" href="exceptions_8h.html#abfa3a3b99557b11f5766baf69465fdf6a44de51845416ac49ab08438792b908f0">RETURN_MASK_ERROR</a>)
<a name="l01804"></a>01804         {
<a name="l01805"></a>01805           <span class="keyword">struct </span>value *val;
<a name="l01806"></a>01806 
<a name="l01807"></a>01807           val = <a class="code" href="eval_8c.html#ab50151ccba3ea3184c114121d6bed422">evaluate_expression</a> (d-&gt;exp);
<a name="l01808"></a>01808           print_formatted (val, d-&gt;format.size, &amp;opts, <a class="code" href="main_8c.html#a41a2b997ba5454df787d61f051dd918c">gdb_stdout</a>);
<a name="l01809"></a>01809         }
<a name="l01810"></a>01810       <span class="keywordflow">if</span> (ex.reason &lt; 0)
<a name="l01811"></a>01811         <a class="code" href="utils_8c.html#aaa819b1a6c0b6c4090bdc0b027eaf64b">fprintf_filtered</a> (<a class="code" href="main_8c.html#a41a2b997ba5454df787d61f051dd918c">gdb_stdout</a>, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;&lt;error: %s&gt;&quot;</span>), ex.message);
<a name="l01812"></a>01812       <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l01813"></a>01813     }
<a name="l01814"></a>01814 
<a name="l01815"></a>01815   <a class="code" href="annotate_8c.html#a84007776b69cd0082fe18295327e32a8">annotate_display_end</a> ();
<a name="l01816"></a>01816 
<a name="l01817"></a>01817   <a class="code" href="ui-file_8c.html#a046f07b5ef1bcc35c28b4be983e39998">gdb_flush</a> (<a class="code" href="main_8c.html#a41a2b997ba5454df787d61f051dd918c">gdb_stdout</a>);
<a name="l01818"></a>01818   <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (old_chain);
<a name="l01819"></a>01819 }
<a name="l01820"></a>01820 
<a name="l01821"></a>01821 <span class="comment">/* Display all of the values on the auto-display chain which can be</span>
<a name="l01822"></a>01822 <span class="comment">   evaluated in the current scope.  */</span>
<a name="l01823"></a>01823 
<a name="l01824"></a>01824 <span class="keywordtype">void</span>
<a name="l01825"></a><a class="code" href="printcmd_8c.html#adee48b85cffb58177a89bd1b83ad5242">01825</a> <a class="code" href="breakpoint_8h.html#adee48b85cffb58177a89bd1b83ad5242">do_displays</a> (<span class="keywordtype">void</span>)
<a name="l01826"></a>01826 {
<a name="l01827"></a>01827   <span class="keyword">struct </span>display *d;
<a name="l01828"></a>01828 
<a name="l01829"></a>01829   <span class="keywordflow">for</span> (d = display_chain; d; d = d-&gt;next)
<a name="l01830"></a>01830     do_one_display (d);
<a name="l01831"></a>01831 }
<a name="l01832"></a>01832 
<a name="l01833"></a>01833 <span class="comment">/* Delete the auto-display which we were in the process of displaying.</span>
<a name="l01834"></a>01834 <span class="comment">   This is done when there is an error or a signal.  */</span>
<a name="l01835"></a>01835 
<a name="l01836"></a>01836 <span class="keywordtype">void</span>
<a name="l01837"></a><a class="code" href="printcmd_8c.html#a5d8a0805658db85049f3aeba74fd77b1">01837</a> <a class="code" href="breakpoint_8h.html#a19143542a39ba92d3eeff7cd3e2baa1d">disable_display</a> (<span class="keywordtype">int</span> num)
<a name="l01838"></a>01838 {
<a name="l01839"></a>01839   <span class="keyword">struct </span>display *d;
<a name="l01840"></a>01840 
<a name="l01841"></a>01841   <span class="keywordflow">for</span> (d = display_chain; d; d = d-&gt;next)
<a name="l01842"></a>01842     <span class="keywordflow">if</span> (d-&gt;number == num)
<a name="l01843"></a>01843       {
<a name="l01844"></a>01844         d-&gt;enabled_p = 0;
<a name="l01845"></a>01845         <span class="keywordflow">return</span>;
<a name="l01846"></a>01846       }
<a name="l01847"></a>01847   <a class="code" href="utils_8c.html#ad57145632bbcb0361dc1dfa134b1efd0">printf_unfiltered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;No display number %d.\n&quot;</span>), num);
<a name="l01848"></a>01848 }
<a name="l01849"></a>01849 
<a name="l01850"></a>01850 <span class="keywordtype">void</span>
<a name="l01851"></a><a class="code" href="printcmd_8c.html#a814fda6eef258809ef00de4c2fb909c6">01851</a> <a class="code" href="breakpoint_8h.html#a814fda6eef258809ef00de4c2fb909c6">disable_current_display</a> (<span class="keywordtype">void</span>)
<a name="l01852"></a>01852 {
<a name="l01853"></a>01853   <span class="keywordflow">if</span> (current_display_number &gt;= 0)
<a name="l01854"></a>01854     {
<a name="l01855"></a>01855       <a class="code" href="breakpoint_8h.html#a19143542a39ba92d3eeff7cd3e2baa1d">disable_display</a> (current_display_number);
<a name="l01856"></a>01856       <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (<a class="code" href="main_8c.html#a2a1dea1e551cadb9541353a004193a47">gdb_stderr</a>,
<a name="l01857"></a>01857                           <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Disabling display %d to &quot;</span>
<a name="l01858"></a>01858                             <span class="stringliteral">&quot;avoid infinite recursion.\n&quot;</span>),
<a name="l01859"></a>01859                           current_display_number);
<a name="l01860"></a>01860     }
<a name="l01861"></a>01861   current_display_number = -1;
<a name="l01862"></a>01862 }
<a name="l01863"></a>01863 
<a name="l01864"></a>01864 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01865"></a>01865 display_info (<span class="keywordtype">char</span> *ignore, <span class="keywordtype">int</span> from_tty)
<a name="l01866"></a>01866 {
<a name="l01867"></a>01867   <span class="keyword">struct </span>display *d;
<a name="l01868"></a>01868 
<a name="l01869"></a>01869   <span class="keywordflow">if</span> (!display_chain)
<a name="l01870"></a>01870     <a class="code" href="utils_8c.html#ad57145632bbcb0361dc1dfa134b1efd0">printf_unfiltered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;There are no auto-display expressions now.\n&quot;</span>));
<a name="l01871"></a>01871   <span class="keywordflow">else</span>
<a name="l01872"></a>01872     <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Auto-display expressions now in effect:\n\</span>
<a name="l01873"></a>01873 <span class="stringliteral">Num Enb Expression\n&quot;</span>));
<a name="l01874"></a>01874 
<a name="l01875"></a>01875   <span class="keywordflow">for</span> (d = display_chain; d; d = d-&gt;next)
<a name="l01876"></a>01876     {
<a name="l01877"></a>01877       <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;%d:   %c  &quot;</span>, d-&gt;number, <span class="stringliteral">&quot;ny&quot;</span>[(<span class="keywordtype">int</span>) d-&gt;enabled_p]);
<a name="l01878"></a>01878       <span class="keywordflow">if</span> (d-&gt;format.size)
<a name="l01879"></a>01879         <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;/%d%c%c &quot;</span>, d-&gt;format.count, d-&gt;format.size,
<a name="l01880"></a>01880                          d-&gt;format.format);
<a name="l01881"></a>01881       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (d-&gt;format.format)
<a name="l01882"></a>01882         <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;/%c &quot;</span>, d-&gt;format.format);
<a name="l01883"></a>01883       <a class="code" href="utils_8c.html#ab4c30e1b3fe2dfa6e73f320a6758ad5f">puts_filtered</a> (d-&gt;exp_string);
<a name="l01884"></a>01884       <span class="keywordflow">if</span> (d-&gt;block &amp;&amp; !<a class="code" href="block_8c.html#a24329baf96c81f9fa59a469df0a1b018">contained_in</a> (<a class="code" href="frame_8h.html#a91efbdcf182d840c28d378def97cfc23">get_selected_block</a> (0), d-&gt;block))
<a name="l01885"></a>01885         <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot; (cannot be evaluated in the current context)&quot;</span>));
<a name="l01886"></a>01886       <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l01887"></a>01887       <a class="code" href="ui-file_8c.html#a046f07b5ef1bcc35c28b4be983e39998">gdb_flush</a> (<a class="code" href="main_8c.html#a41a2b997ba5454df787d61f051dd918c">gdb_stdout</a>);
<a name="l01888"></a>01888     }
<a name="l01889"></a>01889 }
<a name="l01890"></a>01890 
<a name="l01891"></a>01891 <span class="comment">/* Callback fo map_display_numbers, that enables or disables the</span>
<a name="l01892"></a>01892 <span class="comment">   passed in display D.  */</span>
<a name="l01893"></a>01893 
<a name="l01894"></a>01894 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01895"></a>01895 do_enable_disable_display (<span class="keyword">struct</span> display *d, <span class="keywordtype">void</span> *data)
<a name="l01896"></a>01896 {
<a name="l01897"></a>01897   d-&gt;enabled_p = *(<span class="keywordtype">int</span> *) data;
<a name="l01898"></a>01898 }
<a name="l01899"></a>01899 
<a name="l01900"></a>01900 <span class="comment">/* Implamentation of both the &quot;disable display&quot; and &quot;enable display&quot;</span>
<a name="l01901"></a>01901 <span class="comment">   commands.  ENABLE decides what to do.  */</span>
<a name="l01902"></a>01902 
<a name="l01903"></a>01903 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01904"></a>01904 enable_disable_display_command (<span class="keywordtype">char</span> *args, <span class="keywordtype">int</span> from_tty, <span class="keywordtype">int</span> <a class="code" href="ser-go32_8c.html#ae61b5c3158fa65719b5b96ac35820400">enable</a>)
<a name="l01905"></a>01905 {
<a name="l01906"></a>01906   <span class="keywordflow">if</span> (args == NULL)
<a name="l01907"></a>01907     {
<a name="l01908"></a>01908       <span class="keyword">struct </span>display *d;
<a name="l01909"></a>01909 
<a name="l01910"></a>01910       <a class="code" href="printcmd_8c.html#a60a8b7fbd6675e03f28c0f14bbffab2e">ALL_DISPLAYS</a> (d)
<a name="l01911"></a>01911         d-&gt;enabled_p = enable;
<a name="l01912"></a>01912       return;
<a name="l01913"></a>01913     }
<a name="l01914"></a>01914 
<a name="l01915"></a>01915   map_display_numbers (args, do_enable_disable_display, &amp;enable);
<a name="l01916"></a>01916 }
<a name="l01917"></a>01917 
<a name="l01918"></a>01918 <span class="comment">/* The &quot;enable display&quot; command.  */</span>
<a name="l01919"></a>01919 
<a name="l01920"></a>01920 static <span class="keywordtype">void</span>
<a name="l01921"></a>01921 enable_display_command (<span class="keywordtype">char</span> *args, <span class="keywordtype">int</span> from_tty)
<a name="l01922"></a>01922 {
<a name="l01923"></a>01923   enable_disable_display_command (args, from_tty, 1);
<a name="l01924"></a>01924 }
<a name="l01925"></a>01925 
<a name="l01926"></a>01926 <span class="comment">/* The &quot;disable display&quot; command.  */</span>
<a name="l01927"></a>01927 
<a name="l01928"></a>01928 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01929"></a>01929 disable_display_command (<span class="keywordtype">char</span> *args, <span class="keywordtype">int</span> from_tty)
<a name="l01930"></a>01930 {
<a name="l01931"></a>01931   enable_disable_display_command (args, from_tty, 0);
<a name="l01932"></a>01932 }
<a name="l01933"></a>01933 
<a name="l01934"></a>01934 <span class="comment">/* display_chain items point to blocks and expressions.  Some expressions in</span>
<a name="l01935"></a>01935 <span class="comment">   turn may point to symbols.</span>
<a name="l01936"></a>01936 <span class="comment">   Both symbols and blocks are obstack_alloc&#39;d on objfile_stack, and are</span>
<a name="l01937"></a>01937 <span class="comment">   obstack_free&#39;d when a shared library is unloaded.</span>
<a name="l01938"></a>01938 <span class="comment">   Clear pointers that are about to become dangling.</span>
<a name="l01939"></a>01939 <span class="comment">   Both .exp and .block fields will be restored next time we need to display</span>
<a name="l01940"></a>01940 <span class="comment">   an item by re-parsing .exp_string field in the new execution context.  */</span>
<a name="l01941"></a>01941 
<a name="l01942"></a>01942 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01943"></a>01943 clear_dangling_display_expressions (<span class="keyword">struct</span> <a class="code" href="structso__list.html">so_list</a> *solib)
<a name="l01944"></a>01944 {
<a name="l01945"></a>01945   <span class="keyword">struct </span>objfile *objfile = solib-&gt;<a class="code" href="structso__list.html#ada33ba2c171b3b53b3414f616b680b8e">objfile</a>;
<a name="l01946"></a>01946   <span class="keyword">struct </span>display *d;
<a name="l01947"></a>01947 
<a name="l01948"></a>01948   <span class="comment">/* With no symbol file we cannot have a block or expression from it.  */</span>
<a name="l01949"></a>01949   <span class="keywordflow">if</span> (objfile == NULL)
<a name="l01950"></a>01950     <span class="keywordflow">return</span>;
<a name="l01951"></a>01951   <span class="keywordflow">if</span> (objfile-&gt;<a class="code" href="structobjfile.html#a1ef5fed06f7a9c5864c9a0ce46a87710">separate_debug_objfile_backlink</a>)
<a name="l01952"></a>01952     objfile = objfile-&gt;<a class="code" href="structobjfile.html#a1ef5fed06f7a9c5864c9a0ce46a87710">separate_debug_objfile_backlink</a>;
<a name="l01953"></a>01953   <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (objfile-&gt;<a class="code" href="structobjfile.html#a1f6ab738ce0b1fb1588709351b0c9091">pspace</a> == solib-&gt;<a class="code" href="structso__list.html#a6d29f4fcfead22ec0a7a184a0e31a455">pspace</a>);
<a name="l01954"></a>01954 
<a name="l01955"></a>01955   <span class="keywordflow">for</span> (d = display_chain; d != NULL; d = d-&gt;next)
<a name="l01956"></a>01956     {
<a name="l01957"></a>01957       <span class="keywordflow">if</span> (d-&gt;pspace != solib-&gt;<a class="code" href="structso__list.html#a6d29f4fcfead22ec0a7a184a0e31a455">pspace</a>)
<a name="l01958"></a>01958         <span class="keywordflow">continue</span>;
<a name="l01959"></a>01959 
<a name="l01960"></a>01960       <span class="keywordflow">if</span> (<a class="code" href="symtab_8c.html#ad8b96047323c72511df9c46ea54ab648">lookup_objfile_from_block</a> (d-&gt;block) == objfile
<a name="l01961"></a>01961           || (d-&gt;exp &amp;&amp; <a class="code" href="parse_8c.html#a3df56a662b304ee72766f154d7890b6b">exp_uses_objfile</a> (d-&gt;exp, objfile)))
<a name="l01962"></a>01962       {
<a name="l01963"></a>01963         <a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a> (d-&gt;exp);
<a name="l01964"></a>01964         d-&gt;exp = NULL;
<a name="l01965"></a>01965         d-&gt;block = NULL;
<a name="l01966"></a>01966       }
<a name="l01967"></a>01967     }
<a name="l01968"></a>01968 }
<a name="l01969"></a>01969 
<a name="l01970"></a>01970 
<a name="l01971"></a>01971 <span class="comment">/* Print the value in stack frame FRAME of a variable specified by a</span>
<a name="l01972"></a>01972 <span class="comment">   struct symbol.  NAME is the name to print; if NULL then VAR&#39;s print</span>
<a name="l01973"></a>01973 <span class="comment">   name will be used.  STREAM is the ui_file on which to print the</span>
<a name="l01974"></a>01974 <span class="comment">   value.  INDENT specifies the number of indent levels to print</span>
<a name="l01975"></a>01975 <span class="comment">   before printing the variable name.</span>
<a name="l01976"></a>01976 <span class="comment"></span>
<a name="l01977"></a>01977 <span class="comment">   This function invalidates FRAME.  */</span>
<a name="l01978"></a>01978 
<a name="l01979"></a>01979 <span class="keywordtype">void</span>
<a name="l01980"></a><a class="code" href="value_8h.html#a89788fe9b84e0174fc7fe2851928d0cc">01980</a> <a class="code" href="printcmd_8c.html#a89788fe9b84e0174fc7fe2851928d0cc">print_variable_and_value</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="aarch64-tdep_8c.html#acc128f98d9ceca227038c771308eff39">name</a>, <span class="keyword">struct</span> <a class="code" href="structsymbol.html">symbol</a> *var,
<a name="l01981"></a>01981                           <span class="keyword">struct</span> frame_info *frame,
<a name="l01982"></a>01982                           <span class="keyword">struct</span> ui_file *stream, <span class="keywordtype">int</span> indent)
<a name="l01983"></a>01983 {
<a name="l01984"></a>01984   <span class="keyword">volatile</span> <span class="keyword">struct </span><a class="code" href="structgdb__exception.html">gdb_exception</a> except;
<a name="l01985"></a>01985 
<a name="l01986"></a>01986   <span class="keywordflow">if</span> (!name)
<a name="l01987"></a>01987     name = <a class="code" href="symtab_8h.html#ac7f4cb1648125545fbd0e4f13b0c572c">SYMBOL_PRINT_NAME</a> (var);
<a name="l01988"></a>01988 
<a name="l01989"></a>01989   <a class="code" href="utils_8c.html#aaa819b1a6c0b6c4090bdc0b027eaf64b">fprintf_filtered</a> (stream, <span class="stringliteral">&quot;%s%s = &quot;</span>, <a class="code" href="utils_8c.html#a2a85f5cb0eded8f56cca4e139343f1c4">n_spaces</a> (2 * indent), name);
<a name="l01990"></a>01990   <a class="code" href="exceptions_8h.html#aef4514ee39b9305fddee27f49c7c34eb">TRY_CATCH</a> (except, <a class="code" href="exceptions_8h.html#abfa3a3b99557b11f5766baf69465fdf6a44de51845416ac49ab08438792b908f0">RETURN_MASK_ERROR</a>)
<a name="l01991"></a>01991     {
<a name="l01992"></a>01992       <span class="keyword">struct </span>value *val;
<a name="l01993"></a>01993       <span class="keyword">struct </span><a class="code" href="structvalue__print__options.html">value_print_options</a> opts;
<a name="l01994"></a>01994 
<a name="l01995"></a>01995       val = <a class="code" href="findvar_8c.html#afeb191a780ccc9cc2d95378bc1413751">read_var_value</a> (var, frame);
<a name="l01996"></a>01996       <a class="code" href="valprint_8c.html#aa2d4dfe4b11841ccafc4d0c0d410095d">get_user_print_options</a> (&amp;opts);
<a name="l01997"></a>01997       opts.<a class="code" href="structvalue__print__options.html#a60ebf7f26982bd56f13befa7ef7cc686">deref_ref</a> = 1;
<a name="l01998"></a>01998       <a class="code" href="valprint_8c.html#a3b8220f1b9270a2f8b8f4e197f2be9db">common_val_print</a> (val, stream, indent, &amp;opts, <a class="code" href="language_8c.html#acd2505a014a95629da9c836f8914fc79">current_language</a>);
<a name="l01999"></a>01999 
<a name="l02000"></a>02000       <span class="comment">/* common_val_print invalidates FRAME when a pretty printer calls inferior</span>
<a name="l02001"></a>02001 <span class="comment">         function.  */</span>
<a name="l02002"></a>02002       frame = NULL;
<a name="l02003"></a>02003     }
<a name="l02004"></a>02004   <span class="keywordflow">if</span> (except.<a class="code" href="structgdb__exception.html#ae0e14189c63f830024865d557c1122cc">reason</a> &lt; 0)
<a name="l02005"></a>02005     <a class="code" href="utils_8c.html#aaa819b1a6c0b6c4090bdc0b027eaf64b">fprintf_filtered</a>(stream, <span class="stringliteral">&quot;&lt;error reading variable %s (%s)&gt;&quot;</span>, name,
<a name="l02006"></a>02006                      except.<a class="code" href="structgdb__exception.html#a7f57f80c4d36200d121cee8cce513e5f">message</a>);
<a name="l02007"></a>02007   <a class="code" href="utils_8c.html#aaa819b1a6c0b6c4090bdc0b027eaf64b">fprintf_filtered</a> (stream, <span class="stringliteral">&quot;\n&quot;</span>);
<a name="l02008"></a>02008 }
<a name="l02009"></a>02009 
<a name="l02010"></a>02010 <span class="comment">/* Subroutine of ui_printf to simplify it.</span>
<a name="l02011"></a>02011 <span class="comment">   Print VALUE to STREAM using FORMAT.</span>
<a name="l02012"></a>02012 <span class="comment">   VALUE is a C-style string on the target.  */</span>
<a name="l02013"></a>02013 
<a name="l02014"></a>02014 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l02015"></a>02015 printf_c_string (<span class="keyword">struct</span> ui_file *stream, <span class="keyword">const</span> <span class="keywordtype">char</span> *format,
<a name="l02016"></a>02016                  <span class="keyword">struct</span> value *value)
<a name="l02017"></a>02017 {
<a name="l02018"></a>02018   <a class="code" href="defs_8h.html#a336b399b3b83dbcc61f176c33f26b607">gdb_byte</a> *str;
<a name="l02019"></a>02019   <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> tem;
<a name="l02020"></a>02020   <span class="keywordtype">int</span> j;
<a name="l02021"></a>02021 
<a name="l02022"></a>02022   tem = <a class="code" href="value_8c.html#a2e64d8ca2ab5480e05097c6b2df1aa02">value_as_address</a> (value);
<a name="l02023"></a>02023 
<a name="l02024"></a>02024   <span class="comment">/* This is a %s argument.  Find the length of the string.  */</span>
<a name="l02025"></a>02025   <span class="keywordflow">for</span> (j = 0;; j++)
<a name="l02026"></a>02026     {
<a name="l02027"></a>02027       <a class="code" href="defs_8h.html#a336b399b3b83dbcc61f176c33f26b607">gdb_byte</a> c;
<a name="l02028"></a>02028 
<a name="l02029"></a>02029       <a class="code" href="defs_8h.html#ad24e2b54375e12474e65ebf7175988fb">QUIT</a>;
<a name="l02030"></a>02030       <a class="code" href="corefile_8c.html#a5e0189c6f21f1c9321b379877183b819">read_memory</a> (tem + j, &amp;c, 1);
<a name="l02031"></a>02031       <span class="keywordflow">if</span> (c == 0)
<a name="l02032"></a>02032         <span class="keywordflow">break</span>;
<a name="l02033"></a>02033     }
<a name="l02034"></a>02034 
<a name="l02035"></a>02035   <span class="comment">/* Copy the string contents into a string inside GDB.  */</span>
<a name="l02036"></a>02036   str = (<a class="code" href="defs_8h.html#a336b399b3b83dbcc61f176c33f26b607">gdb_byte</a> *) alloca (j + 1);
<a name="l02037"></a>02037   <span class="keywordflow">if</span> (j != 0)
<a name="l02038"></a>02038     <a class="code" href="corefile_8c.html#a5e0189c6f21f1c9321b379877183b819">read_memory</a> (tem, str, j);
<a name="l02039"></a>02039   str[j] = 0;
<a name="l02040"></a>02040 
<a name="l02041"></a>02041   <a class="code" href="utils_8c.html#aaa819b1a6c0b6c4090bdc0b027eaf64b">fprintf_filtered</a> (stream, format, (<span class="keywordtype">char</span> *) str);
<a name="l02042"></a>02042 }
<a name="l02043"></a>02043 
<a name="l02044"></a>02044 <span class="comment">/* Subroutine of ui_printf to simplify it.</span>
<a name="l02045"></a>02045 <span class="comment">   Print VALUE to STREAM using FORMAT.</span>
<a name="l02046"></a>02046 <span class="comment">   VALUE is a wide C-style string on the target.  */</span>
<a name="l02047"></a>02047 
<a name="l02048"></a>02048 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l02049"></a>02049 printf_wide_c_string (<span class="keyword">struct</span> ui_file *stream, <span class="keyword">const</span> <span class="keywordtype">char</span> *format,
<a name="l02050"></a>02050                       <span class="keyword">struct</span> value *value)
<a name="l02051"></a>02051 {
<a name="l02052"></a>02052   <a class="code" href="defs_8h.html#a336b399b3b83dbcc61f176c33f26b607">gdb_byte</a> *str;
<a name="l02053"></a>02053   <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> tem;
<a name="l02054"></a>02054   <span class="keywordtype">int</span> j;
<a name="l02055"></a>02055   <span class="keyword">struct </span>gdbarch *gdbarch = <a class="code" href="gdbtypes_8c.html#a84ca61a6d58c2bd2c7dcedf19d56a39d">get_type_arch</a> (<a class="code" href="value_8c.html#a263a4c0bee0b0df41074b952d3c121d0">value_type</a> (value));
<a name="l02056"></a>02056   <span class="keyword">enum</span> bfd_endian byte_order = <a class="code" href="gdbarch_8c.html#abc300a3797421aa7342b288e1637483e">gdbarch_byte_order</a> (gdbarch);
<a name="l02057"></a>02057   <span class="keyword">struct </span>type *wctype = <a class="code" href="gdbtypes_8c.html#adadb1dc66dab92ad081c55f355a1582c">lookup_typename</a> (<a class="code" href="language_8c.html#acd2505a014a95629da9c836f8914fc79">current_language</a>, gdbarch,
<a name="l02058"></a>02058                                          <span class="stringliteral">&quot;wchar_t&quot;</span>, NULL, 0);
<a name="l02059"></a>02059   <span class="keywordtype">int</span> wcwidth = <a class="code" href="gdbtypes_8h.html#aeac33f868e763780094aec8a2dcb9a1a">TYPE_LENGTH</a> (wctype);
<a name="l02060"></a>02060   <a class="code" href="defs_8h.html#a336b399b3b83dbcc61f176c33f26b607">gdb_byte</a> *buf = alloca (wcwidth);
<a name="l02061"></a>02061   <span class="keyword">struct </span>obstack output;
<a name="l02062"></a>02062   <span class="keyword">struct </span>cleanup *inner_cleanup;
<a name="l02063"></a>02063 
<a name="l02064"></a>02064   tem = <a class="code" href="value_8c.html#a2e64d8ca2ab5480e05097c6b2df1aa02">value_as_address</a> (value);
<a name="l02065"></a>02065 
<a name="l02066"></a>02066   <span class="comment">/* This is a %s argument.  Find the length of the string.  */</span>
<a name="l02067"></a>02067   <span class="keywordflow">for</span> (j = 0;; j += wcwidth)
<a name="l02068"></a>02068     {
<a name="l02069"></a>02069       <a class="code" href="defs_8h.html#ad24e2b54375e12474e65ebf7175988fb">QUIT</a>;
<a name="l02070"></a>02070       <a class="code" href="corefile_8c.html#a5e0189c6f21f1c9321b379877183b819">read_memory</a> (tem + j, buf, wcwidth);
<a name="l02071"></a>02071       <span class="keywordflow">if</span> (<a class="code" href="defs_8h.html#a99aec65329508b4d449a4f881026f844">extract_unsigned_integer</a> (buf, wcwidth, byte_order) == 0)
<a name="l02072"></a>02072         <span class="keywordflow">break</span>;
<a name="l02073"></a>02073     }
<a name="l02074"></a>02074 
<a name="l02075"></a>02075   <span class="comment">/* Copy the string contents into a string inside GDB.  */</span>
<a name="l02076"></a>02076   str = (<a class="code" href="defs_8h.html#a336b399b3b83dbcc61f176c33f26b607">gdb_byte</a> *) alloca (j + wcwidth);
<a name="l02077"></a>02077   <span class="keywordflow">if</span> (j != 0)
<a name="l02078"></a>02078     <a class="code" href="corefile_8c.html#a5e0189c6f21f1c9321b379877183b819">read_memory</a> (tem, str, j);
<a name="l02079"></a>02079   <a class="code" href="gdb__string_8h.html#adb03df3679ce1445e801310614624ccb">memset</a> (&amp;str[j], 0, wcwidth);
<a name="l02080"></a>02080 
<a name="l02081"></a>02081   obstack_init (&amp;output);
<a name="l02082"></a>02082   inner_cleanup = <a class="code" href="utils_8c.html#a8aa2f0be9d477ee015e9e9bac43c005d">make_cleanup_obstack_free</a> (&amp;output);
<a name="l02083"></a>02083 
<a name="l02084"></a>02084   <a class="code" href="charset_8c.html#aeac3ff8d81523d650a70d77c311d8ddd">convert_between_encodings</a> (<a class="code" href="charset_8c.html#a175137e268aca09ba59c15ec0c035a30">target_wide_charset</a> (gdbarch),
<a name="l02085"></a>02085                              <a class="code" href="charset_8c.html#ae8979ed1b224684a2a61a7284f03942d">host_charset</a> (),
<a name="l02086"></a>02086                              str, j, wcwidth,
<a name="l02087"></a>02087                              &amp;output, <a class="code" href="charset_8h.html#a12114a8c20185cf7e9a430017013e97ca215dfc7e438195acd65657c290ee46f9">translit_char</a>);
<a name="l02088"></a>02088   <a class="code" href="gdb__obstack_8h.html#a33a401214fbeb33af25499e39697e2b9">obstack_grow_str0</a> (&amp;output, <span class="stringliteral">&quot;&quot;</span>);
<a name="l02089"></a>02089 
<a name="l02090"></a>02090   <a class="code" href="utils_8c.html#aaa819b1a6c0b6c4090bdc0b027eaf64b">fprintf_filtered</a> (stream, format, obstack_base (&amp;output));
<a name="l02091"></a>02091   <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (inner_cleanup);
<a name="l02092"></a>02092 }
<a name="l02093"></a>02093 
<a name="l02094"></a>02094 <span class="comment">/* Subroutine of ui_printf to simplify it.</span>
<a name="l02095"></a>02095 <span class="comment">   Print VALUE, a decimal floating point value, to STREAM using FORMAT.  */</span>
<a name="l02096"></a>02096 
<a name="l02097"></a>02097 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l02098"></a>02098 printf_decfloat (<span class="keyword">struct</span> ui_file *stream, <span class="keyword">const</span> <span class="keywordtype">char</span> *format,
<a name="l02099"></a>02099                  <span class="keyword">struct</span> value *value)
<a name="l02100"></a>02100 {
<a name="l02101"></a>02101   <span class="keyword">const</span> <a class="code" href="defs_8h.html#a336b399b3b83dbcc61f176c33f26b607">gdb_byte</a> *param_ptr = <a class="code" href="value_8c.html#ad41a6de8fde15c01e1ffabb603c4f108">value_contents</a> (value);
<a name="l02102"></a>02102 
<a name="l02103"></a>02103 <span class="preprocessor">#if defined (PRINTF_HAS_DECFLOAT)</span>
<a name="l02104"></a>02104 <span class="preprocessor"></span>  <span class="comment">/* If we have native support for Decimal floating</span>
<a name="l02105"></a>02105 <span class="comment">     printing, handle it here.  */</span>
<a name="l02106"></a>02106   <a class="code" href="utils_8c.html#aaa819b1a6c0b6c4090bdc0b027eaf64b">fprintf_filtered</a> (stream, format, param_ptr);
<a name="l02107"></a>02107 <span class="preprocessor">#else</span>
<a name="l02108"></a>02108 <span class="preprocessor"></span>  <span class="comment">/* As a workaround until vasprintf has native support for DFP</span>
<a name="l02109"></a>02109 <span class="comment">     we convert the DFP values to string and print them using</span>
<a name="l02110"></a>02110 <span class="comment">     the %s format specifier.  */</span>
<a name="l02111"></a>02111   <span class="keyword">const</span> <span class="keywordtype">char</span> *p;
<a name="l02112"></a>02112 
<a name="l02113"></a>02113   <span class="comment">/* Parameter data.  */</span>
<a name="l02114"></a>02114   <span class="keyword">struct </span>type *param_type = <a class="code" href="value_8c.html#a263a4c0bee0b0df41074b952d3c121d0">value_type</a> (value);
<a name="l02115"></a>02115   <span class="keyword">struct </span>gdbarch *gdbarch = <a class="code" href="gdbtypes_8c.html#a84ca61a6d58c2bd2c7dcedf19d56a39d">get_type_arch</a> (param_type);
<a name="l02116"></a>02116   <span class="keyword">enum</span> bfd_endian byte_order = <a class="code" href="gdbarch_8c.html#abc300a3797421aa7342b288e1637483e">gdbarch_byte_order</a> (gdbarch);
<a name="l02117"></a>02117 
<a name="l02118"></a>02118   <span class="comment">/* DFP output data.  */</span>
<a name="l02119"></a>02119   <span class="keyword">struct </span>value *dfp_value = NULL;
<a name="l02120"></a>02120   <a class="code" href="defs_8h.html#a336b399b3b83dbcc61f176c33f26b607">gdb_byte</a> *dfp_ptr;
<a name="l02121"></a>02121   <span class="keywordtype">int</span> dfp_len = 16;
<a name="l02122"></a>02122   <a class="code" href="defs_8h.html#a336b399b3b83dbcc61f176c33f26b607">gdb_byte</a> dec[16];
<a name="l02123"></a>02123   <span class="keyword">struct </span>type *dfp_type = NULL;
<a name="l02124"></a>02124   <span class="keywordtype">char</span> decstr[<a class="code" href="dfp_8h.html#abbbd9f981b80d84d33761399adf9498d">MAX_DECIMAL_STRING</a>];
<a name="l02125"></a>02125 
<a name="l02126"></a>02126   <span class="comment">/* Points to the end of the string so that we can go back</span>
<a name="l02127"></a>02127 <span class="comment">     and check for DFP length modifiers.  */</span>
<a name="l02128"></a>02128   p = format + strlen (format);
<a name="l02129"></a>02129 
<a name="l02130"></a>02130   <span class="comment">/* Look for the float/double format specifier.  */</span>
<a name="l02131"></a>02131   <span class="keywordflow">while</span> (*p != <span class="charliteral">&#39;f&#39;</span> &amp;&amp; *p != <span class="charliteral">&#39;e&#39;</span> &amp;&amp; *p != <span class="charliteral">&#39;E&#39;</span>
<a name="l02132"></a>02132          &amp;&amp; *p != <span class="charliteral">&#39;g&#39;</span> &amp;&amp; *p != <span class="charliteral">&#39;G&#39;</span>)
<a name="l02133"></a>02133     p--;
<a name="l02134"></a>02134 
<a name="l02135"></a>02135   <span class="comment">/* Search for the &#39;%&#39; char and extract the size and type of</span>
<a name="l02136"></a>02136 <span class="comment">     the output decimal value based on its modifiers</span>
<a name="l02137"></a>02137 <span class="comment">     (%Hf, %Df, %DDf).  */</span>
<a name="l02138"></a>02138   <span class="keywordflow">while</span> (*--p != <span class="charliteral">&#39;%&#39;</span>)
<a name="l02139"></a>02139     {
<a name="l02140"></a>02140       <span class="keywordflow">if</span> (*p == <span class="charliteral">&#39;H&#39;</span>)
<a name="l02141"></a>02141         {
<a name="l02142"></a>02142           dfp_len = 4;
<a name="l02143"></a>02143           dfp_type = <a class="code" href="gdbtypes_8c.html#addd01ebc9ccdf2cacb33ab01e281ddb8">builtin_type</a> (gdbarch)-&gt;<a class="code" href="structbuiltin__type.html#ab35ff0933e3e85c60028781395c69e0b">builtin_decfloat</a>;
<a name="l02144"></a>02144         }
<a name="l02145"></a>02145       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*p == <span class="charliteral">&#39;D&#39;</span> &amp;&amp; *(p - 1) == <span class="charliteral">&#39;D&#39;</span>)
<a name="l02146"></a>02146         {
<a name="l02147"></a>02147           dfp_len = 16;
<a name="l02148"></a>02148           dfp_type = <a class="code" href="gdbtypes_8c.html#addd01ebc9ccdf2cacb33ab01e281ddb8">builtin_type</a> (gdbarch)-&gt;<a class="code" href="structbuiltin__type.html#a08ba137b3f76b011d6213a2480776f86">builtin_declong</a>;
<a name="l02149"></a>02149           p--;
<a name="l02150"></a>02150         }
<a name="l02151"></a>02151       <span class="keywordflow">else</span>
<a name="l02152"></a>02152         {
<a name="l02153"></a>02153           dfp_len = 8;
<a name="l02154"></a>02154           dfp_type = <a class="code" href="gdbtypes_8c.html#addd01ebc9ccdf2cacb33ab01e281ddb8">builtin_type</a> (gdbarch)-&gt;<a class="code" href="structbuiltin__type.html#ac69a34335b9be0fe0603e8979e101f0d">builtin_decdouble</a>;
<a name="l02155"></a>02155         }
<a name="l02156"></a>02156     }
<a name="l02157"></a>02157 
<a name="l02158"></a>02158   <span class="comment">/* Conversion between different DFP types.  */</span>
<a name="l02159"></a>02159   <span class="keywordflow">if</span> (<a class="code" href="gdbtypes_8h.html#a9505f41c7012665947c6b4065ce190e1">TYPE_CODE</a> (param_type) == <a class="code" href="gdbtypes_8h.html#a90e2a0fddaa6afff6a0a489ff4da3462ace4e1a5aff0ea601f04c6f25eb8ed47b">TYPE_CODE_DECFLOAT</a>)
<a name="l02160"></a>02160     <a class="code" href="dfp_8c.html#a1b75ef24878b3cba6f681d969b7a641a">decimal_convert</a> (param_ptr, <a class="code" href="gdbtypes_8h.html#aeac33f868e763780094aec8a2dcb9a1a">TYPE_LENGTH</a> (param_type),
<a name="l02161"></a>02161                      byte_order, dec, dfp_len, byte_order);
<a name="l02162"></a>02162   <span class="keywordflow">else</span>
<a name="l02163"></a>02163     <span class="comment">/* If this is a non-trivial conversion, just output 0.</span>
<a name="l02164"></a>02164 <span class="comment">       A correct converted value can be displayed by explicitly</span>
<a name="l02165"></a>02165 <span class="comment">       casting to a DFP type.  */</span>
<a name="l02166"></a>02166     <a class="code" href="dfp_8c.html#a6b7196395d7d3386e8e98c707bfcfebf">decimal_from_string</a> (dec, dfp_len, byte_order, <span class="stringliteral">&quot;0&quot;</span>);
<a name="l02167"></a>02167 
<a name="l02168"></a>02168   dfp_value = <a class="code" href="value_8c.html#ab8645cba250bddc4b62ee9aa9629d755">value_from_decfloat</a> (dfp_type, dec);
<a name="l02169"></a>02169 
<a name="l02170"></a>02170   dfp_ptr = (<a class="code" href="defs_8h.html#a336b399b3b83dbcc61f176c33f26b607">gdb_byte</a> *) <a class="code" href="value_8c.html#ad41a6de8fde15c01e1ffabb603c4f108">value_contents</a> (dfp_value);
<a name="l02171"></a>02171 
<a name="l02172"></a>02172   <a class="code" href="dfp_8c.html#aecbf09233367a9540517d8cf8900c121">decimal_to_string</a> (dfp_ptr, dfp_len, byte_order, decstr);
<a name="l02173"></a>02173 
<a name="l02174"></a>02174   <span class="comment">/* Print the DFP value.  */</span>
<a name="l02175"></a>02175   <a class="code" href="utils_8c.html#aaa819b1a6c0b6c4090bdc0b027eaf64b">fprintf_filtered</a> (stream, <span class="stringliteral">&quot;%s&quot;</span>, decstr);
<a name="l02176"></a>02176 <span class="preprocessor">#endif</span>
<a name="l02177"></a>02177 <span class="preprocessor"></span>}
<a name="l02178"></a>02178 
<a name="l02179"></a>02179 <span class="comment">/* Subroutine of ui_printf to simplify it.</span>
<a name="l02180"></a>02180 <span class="comment">   Print VALUE, a target pointer, to STREAM using FORMAT.  */</span>
<a name="l02181"></a>02181 
<a name="l02182"></a>02182 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l02183"></a>02183 printf_pointer (<span class="keyword">struct</span> ui_file *stream, <span class="keyword">const</span> <span class="keywordtype">char</span> *format,
<a name="l02184"></a>02184                 <span class="keyword">struct</span> value *value)
<a name="l02185"></a>02185 {
<a name="l02186"></a>02186   <span class="comment">/* We avoid the host&#39;s %p because pointers are too</span>
<a name="l02187"></a>02187 <span class="comment">     likely to be the wrong size.  The only interesting</span>
<a name="l02188"></a>02188 <span class="comment">     modifier for %p is a width; extract that, and then</span>
<a name="l02189"></a>02189 <span class="comment">     handle %p as glibc would: %#x or a literal &quot;(nil)&quot;.  */</span>
<a name="l02190"></a>02190 
<a name="l02191"></a>02191   <span class="keyword">const</span> <span class="keywordtype">char</span> *p;
<a name="l02192"></a>02192   <span class="keywordtype">char</span> *fmt, *fmt_p;
<a name="l02193"></a>02193 <span class="preprocessor">#ifdef PRINTF_HAS_LONG_LONG</span>
<a name="l02194"></a>02194 <span class="preprocessor"></span>  <span class="keywordtype">long</span> <span class="keywordtype">long</span> val = <a class="code" href="value_8c.html#aa95e2692a6e5338edb5db75909064bc1">value_as_long</a> (value);
<a name="l02195"></a>02195 <span class="preprocessor">#else</span>
<a name="l02196"></a>02196 <span class="preprocessor"></span>  <span class="keywordtype">long</span> val = <a class="code" href="value_8c.html#aa95e2692a6e5338edb5db75909064bc1">value_as_long</a> (value);
<a name="l02197"></a>02197 <span class="preprocessor">#endif</span>
<a name="l02198"></a>02198 <span class="preprocessor"></span>
<a name="l02199"></a>02199   fmt = alloca (strlen (format) + 5);
<a name="l02200"></a>02200 
<a name="l02201"></a>02201   <span class="comment">/* Copy up to the leading %.  */</span>
<a name="l02202"></a>02202   p = format;
<a name="l02203"></a>02203   fmt_p = fmt;
<a name="l02204"></a>02204   <span class="keywordflow">while</span> (*p)
<a name="l02205"></a>02205     {
<a name="l02206"></a>02206       <span class="keywordtype">int</span> is_percent = (*p == <span class="charliteral">&#39;%&#39;</span>);
<a name="l02207"></a>02207 
<a name="l02208"></a>02208       *fmt_p++ = *p++;
<a name="l02209"></a>02209       <span class="keywordflow">if</span> (is_percent)
<a name="l02210"></a>02210         {
<a name="l02211"></a>02211           <span class="keywordflow">if</span> (*p == <span class="charliteral">&#39;%&#39;</span>)
<a name="l02212"></a>02212             *fmt_p++ = *p++;
<a name="l02213"></a>02213           <span class="keywordflow">else</span>
<a name="l02214"></a>02214             <span class="keywordflow">break</span>;
<a name="l02215"></a>02215         }
<a name="l02216"></a>02216     }
<a name="l02217"></a>02217 
<a name="l02218"></a>02218   <span class="keywordflow">if</span> (val != 0)
<a name="l02219"></a>02219     *fmt_p++ = <span class="charliteral">&#39;#&#39;</span>;
<a name="l02220"></a>02220 
<a name="l02221"></a>02221   <span class="comment">/* Copy any width.  */</span>
<a name="l02222"></a>02222   <span class="keywordflow">while</span> (*p &gt;= <span class="charliteral">&#39;0&#39;</span> &amp;&amp; *p &lt; <span class="charliteral">&#39;9&#39;</span>)
<a name="l02223"></a>02223     *fmt_p++ = *p++;
<a name="l02224"></a>02224 
<a name="l02225"></a>02225   <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (*p == <span class="charliteral">&#39;p&#39;</span> &amp;&amp; *(p + 1) == <span class="charliteral">&#39;\0&#39;</span>);
<a name="l02226"></a>02226   <span class="keywordflow">if</span> (val != 0)
<a name="l02227"></a>02227     {
<a name="l02228"></a>02228 <span class="preprocessor">#ifdef PRINTF_HAS_LONG_LONG</span>
<a name="l02229"></a>02229 <span class="preprocessor"></span>      *fmt_p++ = <span class="charliteral">&#39;l&#39;</span>;
<a name="l02230"></a>02230 <span class="preprocessor">#endif</span>
<a name="l02231"></a>02231 <span class="preprocessor"></span>      *fmt_p++ = <span class="charliteral">&#39;l&#39;</span>;
<a name="l02232"></a>02232       *fmt_p++ = <span class="charliteral">&#39;x&#39;</span>;
<a name="l02233"></a>02233       *fmt_p++ = <span class="charliteral">&#39;\0&#39;</span>;
<a name="l02234"></a>02234       <a class="code" href="utils_8c.html#aaa819b1a6c0b6c4090bdc0b027eaf64b">fprintf_filtered</a> (stream, fmt, val);
<a name="l02235"></a>02235     }
<a name="l02236"></a>02236   <span class="keywordflow">else</span>
<a name="l02237"></a>02237     {
<a name="l02238"></a>02238       *fmt_p++ = <span class="charliteral">&#39;s&#39;</span>;
<a name="l02239"></a>02239       *fmt_p++ = <span class="charliteral">&#39;\0&#39;</span>;
<a name="l02240"></a>02240       <a class="code" href="utils_8c.html#aaa819b1a6c0b6c4090bdc0b027eaf64b">fprintf_filtered</a> (stream, fmt, <span class="stringliteral">&quot;(nil)&quot;</span>);
<a name="l02241"></a>02241     }
<a name="l02242"></a>02242 }
<a name="l02243"></a>02243 
<a name="l02244"></a>02244 <span class="comment">/* printf &quot;printf format string&quot; ARG to STREAM.  */</span>
<a name="l02245"></a>02245 
<a name="l02246"></a>02246 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l02247"></a>02247 ui_printf (<span class="keyword">const</span> <span class="keywordtype">char</span> *arg, <span class="keyword">struct</span> ui_file *stream)
<a name="l02248"></a>02248 {
<a name="l02249"></a>02249   <span class="keyword">struct </span><a class="code" href="structformat__piece.html">format_piece</a> *fpieces;
<a name="l02250"></a>02250   <span class="keyword">const</span> <span class="keywordtype">char</span> *s = arg;
<a name="l02251"></a>02251   <span class="keyword">struct </span>value **val_args;
<a name="l02252"></a>02252   <span class="keywordtype">int</span> allocated_args = 20;
<a name="l02253"></a>02253   <span class="keyword">struct </span>cleanup *old_cleanups;
<a name="l02254"></a>02254 
<a name="l02255"></a>02255   val_args = <a class="code" href="common-utils_8c.html#a634d6cd850bb831afebc499579303b3b">xmalloc</a> (allocated_args * <span class="keyword">sizeof</span> (<span class="keyword">struct</span> value *));
<a name="l02256"></a>02256   old_cleanups = <a class="code" href="cleanups_8c.html#a3d418f8af424aec399898c2d48b26224">make_cleanup</a> (<a class="code" href="utils_8c.html#a6d8c21606d3f67a431a7bfbb1f47d12e">free_current_contents</a>, &amp;val_args);
<a name="l02257"></a>02257 
<a name="l02258"></a>02258   <span class="keywordflow">if</span> (s == 0)
<a name="l02259"></a>02259     <a class="code" href="cli-cmds_8c.html#a68aef78cdf72abc9df2495a4618842c3">error_no_arg</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;format-control string and values to print&quot;</span>));
<a name="l02260"></a>02260 
<a name="l02261"></a>02261   s = <a class="code" href="cli-utils_8c.html#aad7df612354d99c740a7ea12eccd3848">skip_spaces_const</a> (s);
<a name="l02262"></a>02262 
<a name="l02263"></a>02263   <span class="comment">/* A format string should follow, enveloped in double quotes.  */</span>
<a name="l02264"></a>02264   <span class="keywordflow">if</span> (*s++ != <span class="charliteral">&#39;&quot;&#39;</span>)
<a name="l02265"></a>02265     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Bad format string, missing &#39;\&quot;&#39;.&quot;</span>));
<a name="l02266"></a>02266 
<a name="l02267"></a>02267   fpieces = <a class="code" href="format_8c.html#a6791f6d4a5959f34267a30fcbf665539">parse_format_string</a> (&amp;s);
<a name="l02268"></a>02268 
<a name="l02269"></a>02269   <a class="code" href="cleanups_8c.html#a3d418f8af424aec399898c2d48b26224">make_cleanup</a> (<a class="code" href="format_8c.html#ab83323f8844808a76889725b63745525">free_format_pieces_cleanup</a>, &amp;fpieces);
<a name="l02270"></a>02270 
<a name="l02271"></a>02271   <span class="keywordflow">if</span> (*s++ != <span class="charliteral">&#39;&quot;&#39;</span>)
<a name="l02272"></a>02272     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Bad format string, non-terminated &#39;\&quot;&#39;.&quot;</span>));
<a name="l02273"></a>02273   
<a name="l02274"></a>02274   s = <a class="code" href="cli-utils_8c.html#aad7df612354d99c740a7ea12eccd3848">skip_spaces_const</a> (s);
<a name="l02275"></a>02275 
<a name="l02276"></a>02276   <span class="keywordflow">if</span> (*s != <span class="charliteral">&#39;,&#39;</span> &amp;&amp; *s != 0)
<a name="l02277"></a>02277     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Invalid argument syntax&quot;</span>));
<a name="l02278"></a>02278 
<a name="l02279"></a>02279   <span class="keywordflow">if</span> (*s == <span class="charliteral">&#39;,&#39;</span>)
<a name="l02280"></a>02280     s++;
<a name="l02281"></a>02281   s = <a class="code" href="cli-utils_8c.html#aad7df612354d99c740a7ea12eccd3848">skip_spaces_const</a> (s);
<a name="l02282"></a>02282 
<a name="l02283"></a>02283   {
<a name="l02284"></a>02284     <span class="keywordtype">int</span> nargs = 0;
<a name="l02285"></a>02285     <span class="keywordtype">int</span> nargs_wanted;
<a name="l02286"></a>02286     <span class="keywordtype">int</span> i, fr;
<a name="l02287"></a>02287     <span class="keywordtype">char</span> *current_substring;
<a name="l02288"></a>02288 
<a name="l02289"></a>02289     nargs_wanted = 0;
<a name="l02290"></a>02290     <span class="keywordflow">for</span> (fr = 0; fpieces[fr].<a class="code" href="structformat__piece.html#ab607ea636f54fedfb05f6bda5d31988e">string</a> != NULL; fr++)
<a name="l02291"></a>02291       <span class="keywordflow">if</span> (fpieces[fr].<a class="code" href="format_8h.html#acfe25efb8bb971dd9e124d9ba58dda49">argclass</a> != <a class="code" href="format_8h.html#acfe25efb8bb971dd9e124d9ba58dda49a4576cd306de90b968e9df7b467e9a08b">literal_piece</a>)
<a name="l02292"></a>02292         ++nargs_wanted;
<a name="l02293"></a>02293 
<a name="l02294"></a>02294     <span class="comment">/* Now, parse all arguments and evaluate them.</span>
<a name="l02295"></a>02295 <span class="comment">       Store the VALUEs in VAL_ARGS.  */</span>
<a name="l02296"></a>02296 
<a name="l02297"></a>02297     <span class="keywordflow">while</span> (*s != <span class="charliteral">&#39;\0&#39;</span>)
<a name="l02298"></a>02298       {
<a name="l02299"></a>02299         <span class="keyword">const</span> <span class="keywordtype">char</span> *s1;
<a name="l02300"></a>02300 
<a name="l02301"></a>02301         <span class="keywordflow">if</span> (nargs == allocated_args)
<a name="l02302"></a>02302           val_args = (<span class="keyword">struct </span>value **) <a class="code" href="common-utils_8c.html#af404b7244f442ce8c3069f31af566eae">xrealloc</a> ((<span class="keywordtype">char</span> *) val_args,
<a name="l02303"></a>02303                                                  (allocated_args *= 2)
<a name="l02304"></a>02304                                                  * <span class="keyword">sizeof</span> (<span class="keyword">struct</span> value *));
<a name="l02305"></a>02305         s1 = s;
<a name="l02306"></a>02306         val_args[nargs] = <a class="code" href="eval_8c.html#a5327f4a6f2481c9f8d6c13bb9b621688">parse_to_comma_and_eval</a> (&amp;s1);
<a name="l02307"></a>02307 
<a name="l02308"></a>02308         nargs++;
<a name="l02309"></a>02309         s = s1;
<a name="l02310"></a>02310         <span class="keywordflow">if</span> (*s == <span class="charliteral">&#39;,&#39;</span>)
<a name="l02311"></a>02311           s++;
<a name="l02312"></a>02312       }
<a name="l02313"></a>02313 
<a name="l02314"></a>02314     <span class="keywordflow">if</span> (nargs != nargs_wanted)
<a name="l02315"></a>02315       <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Wrong number of arguments for specified format-string&quot;</span>));
<a name="l02316"></a>02316 
<a name="l02317"></a>02317     <span class="comment">/* Now actually print them.  */</span>
<a name="l02318"></a>02318     i = 0;
<a name="l02319"></a>02319     <span class="keywordflow">for</span> (fr = 0; fpieces[fr].<a class="code" href="structformat__piece.html#ab607ea636f54fedfb05f6bda5d31988e">string</a> != NULL; fr++)
<a name="l02320"></a>02320       {
<a name="l02321"></a>02321         current_substring = fpieces[fr].<a class="code" href="structformat__piece.html#ab607ea636f54fedfb05f6bda5d31988e">string</a>;
<a name="l02322"></a>02322         <span class="keywordflow">switch</span> (fpieces[fr].<a class="code" href="format_8h.html#acfe25efb8bb971dd9e124d9ba58dda49">argclass</a>)
<a name="l02323"></a>02323           {
<a name="l02324"></a>02324           <span class="keywordflow">case</span> <a class="code" href="format_8h.html#acfe25efb8bb971dd9e124d9ba58dda49a6dc099d1717b03606427f4b70d5807c2">string_arg</a>:
<a name="l02325"></a>02325             printf_c_string (stream, current_substring, val_args[i]);
<a name="l02326"></a>02326             <span class="keywordflow">break</span>;
<a name="l02327"></a>02327           <span class="keywordflow">case</span> <a class="code" href="format_8h.html#acfe25efb8bb971dd9e124d9ba58dda49a5a697026ee4744b2b8bbfe37c09e02da">wide_string_arg</a>:
<a name="l02328"></a>02328             printf_wide_c_string (stream, current_substring, val_args[i]);
<a name="l02329"></a>02329             <span class="keywordflow">break</span>;
<a name="l02330"></a>02330           <span class="keywordflow">case</span> <a class="code" href="format_8h.html#acfe25efb8bb971dd9e124d9ba58dda49aeb39b25d6fa256120e3084c29b772f13">wide_char_arg</a>:
<a name="l02331"></a>02331             {
<a name="l02332"></a>02332               <span class="keyword">struct </span>gdbarch *gdbarch
<a name="l02333"></a>02333                 = <a class="code" href="gdbtypes_8c.html#a84ca61a6d58c2bd2c7dcedf19d56a39d">get_type_arch</a> (<a class="code" href="value_8c.html#a263a4c0bee0b0df41074b952d3c121d0">value_type</a> (val_args[i]));
<a name="l02334"></a>02334               <span class="keyword">struct </span>type *wctype = <a class="code" href="gdbtypes_8c.html#adadb1dc66dab92ad081c55f355a1582c">lookup_typename</a> (<a class="code" href="language_8c.html#acd2505a014a95629da9c836f8914fc79">current_language</a>, gdbarch,
<a name="l02335"></a>02335                                                      <span class="stringliteral">&quot;wchar_t&quot;</span>, NULL, 0);
<a name="l02336"></a>02336               <span class="keyword">struct </span>type *valtype;
<a name="l02337"></a>02337               <span class="keyword">struct </span>obstack output;
<a name="l02338"></a>02338               <span class="keyword">struct </span>cleanup *inner_cleanup;
<a name="l02339"></a>02339               <span class="keyword">const</span> <a class="code" href="defs_8h.html#a336b399b3b83dbcc61f176c33f26b607">gdb_byte</a> *bytes;
<a name="l02340"></a>02340 
<a name="l02341"></a>02341               valtype = <a class="code" href="value_8c.html#a263a4c0bee0b0df41074b952d3c121d0">value_type</a> (val_args[i]);
<a name="l02342"></a>02342               <span class="keywordflow">if</span> (<a class="code" href="gdbtypes_8h.html#aeac33f868e763780094aec8a2dcb9a1a">TYPE_LENGTH</a> (valtype) != <a class="code" href="gdbtypes_8h.html#aeac33f868e763780094aec8a2dcb9a1a">TYPE_LENGTH</a> (wctype)
<a name="l02343"></a>02343                   || <a class="code" href="gdbtypes_8h.html#a9505f41c7012665947c6b4065ce190e1">TYPE_CODE</a> (valtype) != <a class="code" href="gdbtypes_8h.html#a90e2a0fddaa6afff6a0a489ff4da3462a7071a71840688811b992838bb09d0ddd">TYPE_CODE_INT</a>)
<a name="l02344"></a>02344                 <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;expected wchar_t argument for %%lc&quot;</span>));
<a name="l02345"></a>02345 
<a name="l02346"></a>02346               bytes = <a class="code" href="value_8c.html#ad41a6de8fde15c01e1ffabb603c4f108">value_contents</a> (val_args[i]);
<a name="l02347"></a>02347 
<a name="l02348"></a>02348               obstack_init (&amp;output);
<a name="l02349"></a>02349               inner_cleanup = <a class="code" href="utils_8c.html#a8aa2f0be9d477ee015e9e9bac43c005d">make_cleanup_obstack_free</a> (&amp;output);
<a name="l02350"></a>02350 
<a name="l02351"></a>02351               <a class="code" href="charset_8c.html#aeac3ff8d81523d650a70d77c311d8ddd">convert_between_encodings</a> (<a class="code" href="charset_8c.html#a175137e268aca09ba59c15ec0c035a30">target_wide_charset</a> (gdbarch),
<a name="l02352"></a>02352                                          <a class="code" href="charset_8c.html#ae8979ed1b224684a2a61a7284f03942d">host_charset</a> (),
<a name="l02353"></a>02353                                          bytes, <a class="code" href="gdbtypes_8h.html#aeac33f868e763780094aec8a2dcb9a1a">TYPE_LENGTH</a> (valtype),
<a name="l02354"></a>02354                                          <a class="code" href="gdbtypes_8h.html#aeac33f868e763780094aec8a2dcb9a1a">TYPE_LENGTH</a> (valtype),
<a name="l02355"></a>02355                                          &amp;output, <a class="code" href="charset_8h.html#a12114a8c20185cf7e9a430017013e97ca215dfc7e438195acd65657c290ee46f9">translit_char</a>);
<a name="l02356"></a>02356               <a class="code" href="gdb__obstack_8h.html#a33a401214fbeb33af25499e39697e2b9">obstack_grow_str0</a> (&amp;output, <span class="stringliteral">&quot;&quot;</span>);
<a name="l02357"></a>02357 
<a name="l02358"></a>02358               <a class="code" href="utils_8c.html#aaa819b1a6c0b6c4090bdc0b027eaf64b">fprintf_filtered</a> (stream, current_substring,
<a name="l02359"></a>02359                                 obstack_base (&amp;output));
<a name="l02360"></a>02360               <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (inner_cleanup);
<a name="l02361"></a>02361             }
<a name="l02362"></a>02362             <span class="keywordflow">break</span>;
<a name="l02363"></a>02363           <span class="keywordflow">case</span> <a class="code" href="format_8h.html#acfe25efb8bb971dd9e124d9ba58dda49a83dee9ccae10a96b3700ef5265e083d9">double_arg</a>:
<a name="l02364"></a>02364             {
<a name="l02365"></a>02365               <span class="keyword">struct </span>type *type = <a class="code" href="value_8c.html#a263a4c0bee0b0df41074b952d3c121d0">value_type</a> (val_args[i]);
<a name="l02366"></a>02366               <a class="code" href="doublest_8h.html#ac1812677a2f11158956252854ec47a77">DOUBLEST</a> val;
<a name="l02367"></a>02367               <span class="keywordtype">int</span> inv;
<a name="l02368"></a>02368 
<a name="l02369"></a>02369               <span class="comment">/* If format string wants a float, unchecked-convert the value</span>
<a name="l02370"></a>02370 <span class="comment">                 to floating point of the same size.  */</span>
<a name="l02371"></a>02371               type = float_type_from_length (type);
<a name="l02372"></a>02372               val = <a class="code" href="value_8c.html#a406ae6370e403739bbfb6c5b5a24e9e3">unpack_double</a> (type, <a class="code" href="value_8c.html#ad41a6de8fde15c01e1ffabb603c4f108">value_contents</a> (val_args[i]), &amp;inv);
<a name="l02373"></a>02373               <span class="keywordflow">if</span> (inv)
<a name="l02374"></a>02374                 <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Invalid floating value found in program.&quot;</span>));
<a name="l02375"></a>02375 
<a name="l02376"></a>02376               <a class="code" href="utils_8c.html#aaa819b1a6c0b6c4090bdc0b027eaf64b">fprintf_filtered</a> (stream, current_substring, (<span class="keywordtype">double</span>) val);
<a name="l02377"></a>02377               <span class="keywordflow">break</span>;
<a name="l02378"></a>02378             }
<a name="l02379"></a>02379           <span class="keywordflow">case</span> <a class="code" href="format_8h.html#acfe25efb8bb971dd9e124d9ba58dda49a7c832d62fac8f4277dad867cff4d0f6c">long_double_arg</a>:
<a name="l02380"></a>02380 <span class="preprocessor">#ifdef HAVE_LONG_DOUBLE</span>
<a name="l02381"></a>02381 <span class="preprocessor"></span>            {
<a name="l02382"></a>02382               <span class="keyword">struct </span>type *type = <a class="code" href="value_8c.html#a263a4c0bee0b0df41074b952d3c121d0">value_type</a> (val_args[i]);
<a name="l02383"></a>02383               <a class="code" href="doublest_8h.html#ac1812677a2f11158956252854ec47a77">DOUBLEST</a> val;
<a name="l02384"></a>02384               <span class="keywordtype">int</span> inv;
<a name="l02385"></a>02385 
<a name="l02386"></a>02386               <span class="comment">/* If format string wants a float, unchecked-convert the value</span>
<a name="l02387"></a>02387 <span class="comment">                 to floating point of the same size.  */</span>
<a name="l02388"></a>02388               type = float_type_from_length (type);
<a name="l02389"></a>02389               val = <a class="code" href="value_8c.html#a406ae6370e403739bbfb6c5b5a24e9e3">unpack_double</a> (type, <a class="code" href="value_8c.html#ad41a6de8fde15c01e1ffabb603c4f108">value_contents</a> (val_args[i]), &amp;inv);
<a name="l02390"></a>02390               <span class="keywordflow">if</span> (inv)
<a name="l02391"></a>02391                 <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Invalid floating value found in program.&quot;</span>));
<a name="l02392"></a>02392 
<a name="l02393"></a>02393               <a class="code" href="utils_8c.html#aaa819b1a6c0b6c4090bdc0b027eaf64b">fprintf_filtered</a> (stream, current_substring,
<a name="l02394"></a>02394                                 (<span class="keywordtype">long</span> <span class="keywordtype">double</span>) val);
<a name="l02395"></a>02395               <span class="keywordflow">break</span>;
<a name="l02396"></a>02396             }
<a name="l02397"></a>02397 <span class="preprocessor">#else</span>
<a name="l02398"></a>02398 <span class="preprocessor"></span>            <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;long double not supported in printf&quot;</span>));
<a name="l02399"></a>02399 <span class="preprocessor">#endif</span>
<a name="l02400"></a>02400 <span class="preprocessor"></span>          <span class="keywordflow">case</span> <a class="code" href="format_8h.html#acfe25efb8bb971dd9e124d9ba58dda49a941086167c41858f6006e5f4a30e9441">long_long_arg</a>:
<a name="l02401"></a>02401 <span class="preprocessor">#ifdef PRINTF_HAS_LONG_LONG</span>
<a name="l02402"></a>02402 <span class="preprocessor"></span>            {
<a name="l02403"></a>02403               <span class="keywordtype">long</span> <span class="keywordtype">long</span> val = <a class="code" href="value_8c.html#aa95e2692a6e5338edb5db75909064bc1">value_as_long</a> (val_args[i]);
<a name="l02404"></a>02404 
<a name="l02405"></a>02405               <a class="code" href="utils_8c.html#aaa819b1a6c0b6c4090bdc0b027eaf64b">fprintf_filtered</a> (stream, current_substring, val);
<a name="l02406"></a>02406               <span class="keywordflow">break</span>;
<a name="l02407"></a>02407             }
<a name="l02408"></a>02408 <span class="preprocessor">#else</span>
<a name="l02409"></a>02409 <span class="preprocessor"></span>            <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;long long not supported in printf&quot;</span>));
<a name="l02410"></a>02410 <span class="preprocessor">#endif</span>
<a name="l02411"></a>02411 <span class="preprocessor"></span>          <span class="keywordflow">case</span> <a class="code" href="format_8h.html#acfe25efb8bb971dd9e124d9ba58dda49a411f79781f77bf9aa048252f9f8acfd5">int_arg</a>:
<a name="l02412"></a>02412             {
<a name="l02413"></a>02413               <span class="keywordtype">int</span> val = <a class="code" href="value_8c.html#aa95e2692a6e5338edb5db75909064bc1">value_as_long</a> (val_args[i]);
<a name="l02414"></a>02414 
<a name="l02415"></a>02415               <a class="code" href="utils_8c.html#aaa819b1a6c0b6c4090bdc0b027eaf64b">fprintf_filtered</a> (stream, current_substring, val);
<a name="l02416"></a>02416               <span class="keywordflow">break</span>;
<a name="l02417"></a>02417             }
<a name="l02418"></a>02418           <span class="keywordflow">case</span> <a class="code" href="format_8h.html#acfe25efb8bb971dd9e124d9ba58dda49a10fa003dddb41328dec4ac49dd276b08">long_arg</a>:
<a name="l02419"></a>02419             {
<a name="l02420"></a>02420               <span class="keywordtype">long</span> val = <a class="code" href="value_8c.html#aa95e2692a6e5338edb5db75909064bc1">value_as_long</a> (val_args[i]);
<a name="l02421"></a>02421 
<a name="l02422"></a>02422               <a class="code" href="utils_8c.html#aaa819b1a6c0b6c4090bdc0b027eaf64b">fprintf_filtered</a> (stream, current_substring, val);
<a name="l02423"></a>02423               <span class="keywordflow">break</span>;
<a name="l02424"></a>02424             }
<a name="l02425"></a>02425           <span class="comment">/* Handles decimal floating values.  */</span>
<a name="l02426"></a>02426           <span class="keywordflow">case</span> <a class="code" href="format_8h.html#acfe25efb8bb971dd9e124d9ba58dda49ae24a5e1fca068ad38e8e003b126c07ea">decfloat_arg</a>:
<a name="l02427"></a>02427             printf_decfloat (stream, current_substring, val_args[i]);
<a name="l02428"></a>02428             <span class="keywordflow">break</span>;
<a name="l02429"></a>02429           <span class="keywordflow">case</span> <a class="code" href="format_8h.html#acfe25efb8bb971dd9e124d9ba58dda49aa8fe214b81bbcddf3fc08666e9cc87de">ptr_arg</a>:
<a name="l02430"></a>02430             printf_pointer (stream, current_substring, val_args[i]);
<a name="l02431"></a>02431             <span class="keywordflow">break</span>;
<a name="l02432"></a>02432           <span class="keywordflow">case</span> <a class="code" href="format_8h.html#acfe25efb8bb971dd9e124d9ba58dda49a4576cd306de90b968e9df7b467e9a08b">literal_piece</a>:
<a name="l02433"></a>02433             <span class="comment">/* Print a portion of the format string that has no</span>
<a name="l02434"></a>02434 <span class="comment">               directives.  Note that this will not include any</span>
<a name="l02435"></a>02435 <span class="comment">               ordinary %-specs, but it might include &quot;%%&quot;.  That is</span>
<a name="l02436"></a>02436 <span class="comment">               why we use printf_filtered and not puts_filtered here.</span>
<a name="l02437"></a>02437 <span class="comment">               Also, we pass a dummy argument because some platforms</span>
<a name="l02438"></a>02438 <span class="comment">               have modified GCC to include -Wformat-security by</span>
<a name="l02439"></a>02439 <span class="comment">               default, which will warn here if there is no</span>
<a name="l02440"></a>02440 <span class="comment">               argument.  */</span>
<a name="l02441"></a>02441             <a class="code" href="utils_8c.html#aaa819b1a6c0b6c4090bdc0b027eaf64b">fprintf_filtered</a> (stream, current_substring, 0);
<a name="l02442"></a>02442             <span class="keywordflow">break</span>;
<a name="l02443"></a>02443           <span class="keywordflow">default</span>:
<a name="l02444"></a>02444             <a class="code" href="common-utils_8h.html#aa14285d9d3d4171016ef9cf09447e8bb">internal_error</a> (__FILE__, __LINE__,
<a name="l02445"></a>02445                             <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;failed internal consistency check&quot;</span>));
<a name="l02446"></a>02446           }
<a name="l02447"></a>02447         <span class="comment">/* Maybe advance to the next argument.  */</span>
<a name="l02448"></a>02448         <span class="keywordflow">if</span> (fpieces[fr].argclass != <a class="code" href="format_8h.html#acfe25efb8bb971dd9e124d9ba58dda49a4576cd306de90b968e9df7b467e9a08b">literal_piece</a>)
<a name="l02449"></a>02449           ++i;
<a name="l02450"></a>02450       }
<a name="l02451"></a>02451   }
<a name="l02452"></a>02452   <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (old_cleanups);
<a name="l02453"></a>02453 }
<a name="l02454"></a>02454 
<a name="l02455"></a>02455 <span class="comment">/* Implement the &quot;printf&quot; command.  */</span>
<a name="l02456"></a>02456 
<a name="l02457"></a>02457 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l02458"></a>02458 printf_command (<span class="keywordtype">char</span> *arg, <span class="keywordtype">int</span> from_tty)
<a name="l02459"></a>02459 {
<a name="l02460"></a>02460   ui_printf (arg, <a class="code" href="main_8c.html#a41a2b997ba5454df787d61f051dd918c">gdb_stdout</a>);
<a name="l02461"></a>02461 }
<a name="l02462"></a>02462 
<a name="l02463"></a>02463 <span class="comment">/* Implement the &quot;eval&quot; command.  */</span>
<a name="l02464"></a>02464 
<a name="l02465"></a>02465 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l02466"></a>02466 eval_command (<span class="keywordtype">char</span> *arg, <span class="keywordtype">int</span> from_tty)
<a name="l02467"></a>02467 {
<a name="l02468"></a>02468   <span class="keyword">struct </span>ui_file *ui_out = <a class="code" href="ui-file_8c.html#a340771735f105582d314e191a399a45c">mem_fileopen</a> ();
<a name="l02469"></a>02469   <span class="keyword">struct </span>cleanup *cleanups = <a class="code" href="utils_8c.html#a94dc56baeb57791e114136764f7763aa">make_cleanup_ui_file_delete</a> (ui_out);
<a name="l02470"></a>02470   <span class="keywordtype">char</span> *expanded;
<a name="l02471"></a>02471 
<a name="l02472"></a>02472   ui_printf (arg, ui_out);
<a name="l02473"></a>02473 
<a name="l02474"></a>02474   expanded = <a class="code" href="ui-file_8c.html#a995485039ce5a1d994a1863cd76a5356">ui_file_xstrdup</a> (ui_out, NULL);
<a name="l02475"></a>02475   <a class="code" href="cleanups_8c.html#a3d418f8af424aec399898c2d48b26224">make_cleanup</a> (<a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a>, expanded);
<a name="l02476"></a>02476 
<a name="l02477"></a>02477   <a class="code" href="gdbcmd_8h.html#ac4a1e7a1c71e9c45368a6c32bfe5637d">execute_command</a> (expanded, from_tty);
<a name="l02478"></a>02478 
<a name="l02479"></a>02479   <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (cleanups);
<a name="l02480"></a>02480 }
<a name="l02481"></a>02481 
<a name="l02482"></a>02482 <span class="keywordtype">void</span>
<a name="l02483"></a><a class="code" href="init_8c.html#a4304dafa58ec82a3e93687ae1c7a76d2">02483</a> <a class="code" href="init_8c.html#a4304dafa58ec82a3e93687ae1c7a76d2">_initialize_printcmd</a> (<span class="keywordtype">void</span>)
<a name="l02484"></a>02484 {
<a name="l02485"></a>02485   <span class="keyword">struct </span><a class="code" href="structcmd__list__element.html">cmd_list_element</a> *c;
<a name="l02486"></a>02486 
<a name="l02487"></a>02487   current_display_number = -1;
<a name="l02488"></a>02488 
<a name="l02489"></a>02489   <a class="code" href="observer_8h.html#adcc6152213c4fbd8094b5bd439c0747a">observer_attach_solib_unloaded</a> (clear_dangling_display_expressions);
<a name="l02490"></a>02490 
<a name="l02491"></a>02491   <a class="code" href="cli-decode_8c.html#a9f6cd2f7798c32a7a27cab617e71cf6a">add_info</a> (<span class="stringliteral">&quot;address&quot;</span>, address_info,
<a name="l02492"></a>02492             <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Describe where symbol SYM is stored.&quot;</span>));
<a name="l02493"></a>02493 
<a name="l02494"></a>02494   <a class="code" href="cli-decode_8c.html#a9f6cd2f7798c32a7a27cab617e71cf6a">add_info</a> (<span class="stringliteral">&quot;symbol&quot;</span>, sym_info, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l02495"></a>02495 <span class="stringliteral">Describe what symbol is at location ADDR.\n\</span>
<a name="l02496"></a>02496 <span class="stringliteral">Only for symbols with fixed locations (global or static scope).&quot;</span>));
<a name="l02497"></a>02497 
<a name="l02498"></a>02498   <a class="code" href="cli-decode_8c.html#a0df0ca36d9acd96440e24407cbef593c">add_com</a> (<span class="stringliteral">&quot;x&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a882324bfe96480c161105fe35d4cd58b">class_vars</a>, x_command, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l02499"></a>02499 <span class="stringliteral">Examine memory: x/FMT ADDRESS.\n\</span>
<a name="l02500"></a>02500 <span class="stringliteral">ADDRESS is an expression for the memory address to examine.\n\</span>
<a name="l02501"></a>02501 <span class="stringliteral">FMT is a repeat count followed by a format letter and a size letter.\n\</span>
<a name="l02502"></a>02502 <span class="stringliteral">Format letters are o(octal), x(hex), d(decimal), u(unsigned decimal),\n\</span>
<a name="l02503"></a>02503 <span class="stringliteral">  t(binary), f(float), a(address), i(instruction), c(char), s(string)\n\</span>
<a name="l02504"></a>02504 <span class="stringliteral">  and z(hex, zero padded on the left).\n\</span>
<a name="l02505"></a>02505 <span class="stringliteral">Size letters are b(byte), h(halfword), w(word), g(giant, 8 bytes).\n\</span>
<a name="l02506"></a>02506 <span class="stringliteral">The specified number of objects of the specified size are printed\n\</span>
<a name="l02507"></a>02507 <span class="stringliteral">according to the format.\n\n\</span>
<a name="l02508"></a>02508 <span class="stringliteral">Defaults for format and size letters are those previously used.\n\</span>
<a name="l02509"></a>02509 <span class="stringliteral">Default count is 1.  Default address is following last thing printed\n\</span>
<a name="l02510"></a>02510 <span class="stringliteral">with this command or \&quot;print\&quot;.&quot;</span>));
<a name="l02511"></a>02511 
<a name="l02512"></a>02512 <span class="preprocessor">#if 0</span>
<a name="l02513"></a>02513 <span class="preprocessor"></span>  <a class="code" href="cli-decode_8c.html#a0df0ca36d9acd96440e24407cbef593c">add_com</a> (<span class="stringliteral">&quot;whereis&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a882324bfe96480c161105fe35d4cd58b">class_vars</a>, whereis_command,
<a name="l02514"></a>02514            <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Print line number and file of definition of variable.&quot;</span>));
<a name="l02515"></a>02515 <span class="preprocessor">#endif</span>
<a name="l02516"></a>02516 <span class="preprocessor"></span>
<a name="l02517"></a>02517   <a class="code" href="cli-decode_8c.html#a9f6cd2f7798c32a7a27cab617e71cf6a">add_info</a> (<span class="stringliteral">&quot;display&quot;</span>, display_info, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l02518"></a>02518 <span class="stringliteral">Expressions to display when program stops, with code numbers.&quot;</span>));
<a name="l02519"></a>02519 
<a name="l02520"></a>02520   <a class="code" href="cli-decode_8c.html#ab87b0ba51ed9aa4c8aac0c96373537f8">add_cmd</a> (<span class="stringliteral">&quot;undisplay&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a882324bfe96480c161105fe35d4cd58b">class_vars</a>, undisplay_command, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l02521"></a>02521 <span class="stringliteral">Cancel some expressions to be displayed when program stops.\n\</span>
<a name="l02522"></a>02522 <span class="stringliteral">Arguments are the code numbers of the expressions to stop displaying.\n\</span>
<a name="l02523"></a>02523 <span class="stringliteral">No argument means cancel all automatic-display expressions.\n\</span>
<a name="l02524"></a>02524 <span class="stringliteral">\&quot;delete display\&quot; has the same effect as this command.\n\</span>
<a name="l02525"></a>02525 <span class="stringliteral">Do \&quot;info display\&quot; to see current list of code numbers.&quot;</span>),
<a name="l02526"></a>02526            &amp;<a class="code" href="cli-cmds_8c.html#a6b7ab0355d0fa8d6ce7d5feb83ff78e7">cmdlist</a>);
<a name="l02527"></a>02527 
<a name="l02528"></a>02528   <a class="code" href="cli-decode_8c.html#a0df0ca36d9acd96440e24407cbef593c">add_com</a> (<span class="stringliteral">&quot;display&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a882324bfe96480c161105fe35d4cd58b">class_vars</a>, display_command, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l02529"></a>02529 <span class="stringliteral">Print value of expression EXP each time the program stops.\n\</span>
<a name="l02530"></a>02530 <span class="stringliteral">/FMT may be used before EXP as in the \&quot;print\&quot; command.\n\</span>
<a name="l02531"></a>02531 <span class="stringliteral">/FMT \&quot;i\&quot; or \&quot;s\&quot; or including a size-letter is allowed,\n\</span>
<a name="l02532"></a>02532 <span class="stringliteral">as in the \&quot;x\&quot; command, and then EXP is used to get the address to examine\n\</span>
<a name="l02533"></a>02533 <span class="stringliteral">and examining is done as in the \&quot;x\&quot; command.\n\n\</span>
<a name="l02534"></a>02534 <span class="stringliteral">With no argument, display all currently requested auto-display expressions.\n\</span>
<a name="l02535"></a>02535 <span class="stringliteral">Use \&quot;undisplay\&quot; to cancel display requests previously made.&quot;</span>));
<a name="l02536"></a>02536 
<a name="l02537"></a>02537   <a class="code" href="cli-decode_8c.html#ab87b0ba51ed9aa4c8aac0c96373537f8">add_cmd</a> (<span class="stringliteral">&quot;display&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a882324bfe96480c161105fe35d4cd58b">class_vars</a>, enable_display_command, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l02538"></a>02538 <span class="stringliteral">Enable some expressions to be displayed when program stops.\n\</span>
<a name="l02539"></a>02539 <span class="stringliteral">Arguments are the code numbers of the expressions to resume displaying.\n\</span>
<a name="l02540"></a>02540 <span class="stringliteral">No argument means enable all automatic-display expressions.\n\</span>
<a name="l02541"></a>02541 <span class="stringliteral">Do \&quot;info display\&quot; to see current list of code numbers.&quot;</span>), &amp;<a class="code" href="cli-cmds_8c.html#ac657b85f876b2f45ced4c900825b6256">enablelist</a>);
<a name="l02542"></a>02542 
<a name="l02543"></a>02543   <a class="code" href="cli-decode_8c.html#ab87b0ba51ed9aa4c8aac0c96373537f8">add_cmd</a> (<span class="stringliteral">&quot;display&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a882324bfe96480c161105fe35d4cd58b">class_vars</a>, disable_display_command, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l02544"></a>02544 <span class="stringliteral">Disable some expressions to be displayed when program stops.\n\</span>
<a name="l02545"></a>02545 <span class="stringliteral">Arguments are the code numbers of the expressions to stop displaying.\n\</span>
<a name="l02546"></a>02546 <span class="stringliteral">No argument means disable all automatic-display expressions.\n\</span>
<a name="l02547"></a>02547 <span class="stringliteral">Do \&quot;info display\&quot; to see current list of code numbers.&quot;</span>), &amp;<a class="code" href="cli-cmds_8c.html#a8c0d2e4e2bfbed6c7cc589768fce36fb">disablelist</a>);
<a name="l02548"></a>02548 
<a name="l02549"></a>02549   <a class="code" href="cli-decode_8c.html#ab87b0ba51ed9aa4c8aac0c96373537f8">add_cmd</a> (<span class="stringliteral">&quot;display&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a882324bfe96480c161105fe35d4cd58b">class_vars</a>, undisplay_command, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l02550"></a>02550 <span class="stringliteral">Cancel some expressions to be displayed when program stops.\n\</span>
<a name="l02551"></a>02551 <span class="stringliteral">Arguments are the code numbers of the expressions to stop displaying.\n\</span>
<a name="l02552"></a>02552 <span class="stringliteral">No argument means cancel all automatic-display expressions.\n\</span>
<a name="l02553"></a>02553 <span class="stringliteral">Do \&quot;info display\&quot; to see current list of code numbers.&quot;</span>), &amp;<a class="code" href="cli-cmds_8c.html#a38161c9c3dd4b9956acc3ba4456bcdd7">deletelist</a>);
<a name="l02554"></a>02554 
<a name="l02555"></a>02555   <a class="code" href="cli-decode_8c.html#a0df0ca36d9acd96440e24407cbef593c">add_com</a> (<span class="stringliteral">&quot;printf&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a882324bfe96480c161105fe35d4cd58b">class_vars</a>, printf_command, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l02556"></a>02556 <span class="stringliteral">printf \&quot;printf format string\&quot;, arg1, arg2, arg3, ..., argn\n\</span>
<a name="l02557"></a>02557 <span class="stringliteral">This is useful for formatted output in user-defined commands.&quot;</span>));
<a name="l02558"></a>02558 
<a name="l02559"></a>02559   <a class="code" href="cli-decode_8c.html#a0df0ca36d9acd96440e24407cbef593c">add_com</a> (<span class="stringliteral">&quot;output&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a882324bfe96480c161105fe35d4cd58b">class_vars</a>, output_command, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l02560"></a>02560 <span class="stringliteral">Like \&quot;print\&quot; but don&#39;t put in value history and don&#39;t print newline.\n\</span>
<a name="l02561"></a>02561 <span class="stringliteral">This is useful in user-defined commands.&quot;</span>));
<a name="l02562"></a>02562 
<a name="l02563"></a>02563   <a class="code" href="cli-decode_8c.html#a8abc1e9af59eb3cb12bb03977d5e8e5a">add_prefix_cmd</a> (<span class="stringliteral">&quot;set&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a882324bfe96480c161105fe35d4cd58b">class_vars</a>, set_command, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l02564"></a>02564 <span class="stringliteral">Evaluate expression EXP and assign result to variable VAR, using assignment\n\</span>
<a name="l02565"></a>02565 <span class="stringliteral">syntax appropriate for the current language (VAR = EXP or VAR := EXP for\n\</span>
<a name="l02566"></a>02566 <span class="stringliteral">example).  VAR may be a debugger \&quot;convenience\&quot; variable (names starting\n\</span>
<a name="l02567"></a>02567 <span class="stringliteral">with $), a register (a few standard names starting with $), or an actual\n\</span>
<a name="l02568"></a>02568 <span class="stringliteral">variable in the program being debugged.  EXP is any valid expression.\n\</span>
<a name="l02569"></a>02569 <span class="stringliteral">Use \&quot;set variable\&quot; for variables with names identical to set subcommands.\n\</span>
<a name="l02570"></a>02570 <span class="stringliteral">\n\</span>
<a name="l02571"></a>02571 <span class="stringliteral">With a subcommand, this command modifies parts of the gdb environment.\n\</span>
<a name="l02572"></a>02572 <span class="stringliteral">You can see these environment settings with the \&quot;show\&quot; command.&quot;</span>),
<a name="l02573"></a>02573                   &amp;<a class="code" href="cli-cmds_8c.html#a723e0174d833cba0aa82fb936a56c8fa">setlist</a>, <span class="stringliteral">&quot;set &quot;</span>, 1, &amp;<a class="code" href="cli-cmds_8c.html#a6b7ab0355d0fa8d6ce7d5feb83ff78e7">cmdlist</a>);
<a name="l02574"></a>02574   <span class="keywordflow">if</span> (<a class="code" href="defs_8h.html#a05c64837f5abc518eec4f97238728111">dbx_commands</a>)
<a name="l02575"></a>02575     <a class="code" href="cli-decode_8c.html#a0df0ca36d9acd96440e24407cbef593c">add_com</a> (<span class="stringliteral">&quot;assign&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a882324bfe96480c161105fe35d4cd58b">class_vars</a>, set_command, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l02576"></a>02576 <span class="stringliteral">Evaluate expression EXP and assign result to variable VAR, using assignment\n\</span>
<a name="l02577"></a>02577 <span class="stringliteral">syntax appropriate for the current language (VAR = EXP or VAR := EXP for\n\</span>
<a name="l02578"></a>02578 <span class="stringliteral">example).  VAR may be a debugger \&quot;convenience\&quot; variable (names starting\n\</span>
<a name="l02579"></a>02579 <span class="stringliteral">with $), a register (a few standard names starting with $), or an actual\n\</span>
<a name="l02580"></a>02580 <span class="stringliteral">variable in the program being debugged.  EXP is any valid expression.\n\</span>
<a name="l02581"></a>02581 <span class="stringliteral">Use \&quot;set variable\&quot; for variables with names identical to set subcommands.\n\</span>
<a name="l02582"></a>02582 <span class="stringliteral">\nWith a subcommand, this command modifies parts of the gdb environment.\n\</span>
<a name="l02583"></a>02583 <span class="stringliteral">You can see these environment settings with the \&quot;show\&quot; command.&quot;</span>));
<a name="l02584"></a>02584 
<a name="l02585"></a>02585   <span class="comment">/* &quot;call&quot; is the same as &quot;set&quot;, but handy for dbx users to call fns.  */</span>
<a name="l02586"></a>02586   c = <a class="code" href="cli-decode_8c.html#a0df0ca36d9acd96440e24407cbef593c">add_com</a> (<span class="stringliteral">&quot;call&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a882324bfe96480c161105fe35d4cd58b">class_vars</a>, call_command, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l02587"></a>02587 <span class="stringliteral">Call a function in the program.\n\</span>
<a name="l02588"></a>02588 <span class="stringliteral">The argument is the function name and arguments, in the notation of the\n\</span>
<a name="l02589"></a>02589 <span class="stringliteral">current working language.  The result is printed and saved in the value\n\</span>
<a name="l02590"></a>02590 <span class="stringliteral">history, if it is not void.&quot;</span>));
<a name="l02591"></a>02591   <a class="code" href="command_8h.html#abe42a75e35cfa78e2574e94904d86713">set_cmd_completer</a> (c, expression_completer);
<a name="l02592"></a>02592 
<a name="l02593"></a>02593   <a class="code" href="cli-decode_8c.html#ab87b0ba51ed9aa4c8aac0c96373537f8">add_cmd</a> (<span class="stringliteral">&quot;variable&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a882324bfe96480c161105fe35d4cd58b">class_vars</a>, set_command, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l02594"></a>02594 <span class="stringliteral">Evaluate expression EXP and assign result to variable VAR, using assignment\n\</span>
<a name="l02595"></a>02595 <span class="stringliteral">syntax appropriate for the current language (VAR = EXP or VAR := EXP for\n\</span>
<a name="l02596"></a>02596 <span class="stringliteral">example).  VAR may be a debugger \&quot;convenience\&quot; variable (names starting\n\</span>
<a name="l02597"></a>02597 <span class="stringliteral">with $), a register (a few standard names starting with $), or an actual\n\</span>
<a name="l02598"></a>02598 <span class="stringliteral">variable in the program being debugged.  EXP is any valid expression.\n\</span>
<a name="l02599"></a>02599 <span class="stringliteral">This may usually be abbreviated to simply \&quot;set\&quot;.&quot;</span>),
<a name="l02600"></a>02600            &amp;<a class="code" href="cli-cmds_8c.html#a723e0174d833cba0aa82fb936a56c8fa">setlist</a>);
<a name="l02601"></a>02601 
<a name="l02602"></a>02602   c = <a class="code" href="cli-decode_8c.html#a0df0ca36d9acd96440e24407cbef593c">add_com</a> (<span class="stringliteral">&quot;print&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a882324bfe96480c161105fe35d4cd58b">class_vars</a>, print_command, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l02603"></a>02603 <span class="stringliteral">Print value of expression EXP.\n\</span>
<a name="l02604"></a>02604 <span class="stringliteral">Variables accessible are those of the lexical environment of the selected\n\</span>
<a name="l02605"></a>02605 <span class="stringliteral">stack frame, plus all those whose scope is global or an entire file.\n\</span>
<a name="l02606"></a>02606 <span class="stringliteral">\n\</span>
<a name="l02607"></a>02607 <span class="stringliteral">$NUM gets previous value number NUM.  $ and $$ are the last two values.\n\</span>
<a name="l02608"></a>02608 <span class="stringliteral">$$NUM refers to NUM&#39;th value back from the last one.\n\</span>
<a name="l02609"></a>02609 <span class="stringliteral">Names starting with $ refer to registers (with the values they would have\n\</span>
<a name="l02610"></a>02610 <span class="stringliteral">if the program were to return to the stack frame now selected, restoring\n\</span>
<a name="l02611"></a>02611 <span class="stringliteral">all registers saved by frames farther in) or else to debugger\n\</span>
<a name="l02612"></a>02612 <span class="stringliteral">\&quot;convenience\&quot; variables (any such name not a known register).\n\</span>
<a name="l02613"></a>02613 <span class="stringliteral">Use assignment expressions to give values to convenience variables.\n\</span>
<a name="l02614"></a>02614 <span class="stringliteral">\n\</span>
<a name="l02615"></a>02615 <span class="stringliteral">{TYPE}ADREXP refers to a datum of data type TYPE, located at address ADREXP.\n\</span>
<a name="l02616"></a>02616 <span class="stringliteral">@ is a binary operator for treating consecutive data objects\n\</span>
<a name="l02617"></a>02617 <span class="stringliteral">anywhere in memory as an array.  FOO@NUM gives an array whose first\n\</span>
<a name="l02618"></a>02618 <span class="stringliteral">element is FOO, whose second element is stored in the space following\n\</span>
<a name="l02619"></a>02619 <span class="stringliteral">where FOO is stored, etc.  FOO must be an expression whose value\n\</span>
<a name="l02620"></a>02620 <span class="stringliteral">resides in memory.\n\</span>
<a name="l02621"></a>02621 <span class="stringliteral">\n\</span>
<a name="l02622"></a>02622 <span class="stringliteral">EXP may be preceded with /FMT, where FMT is a format letter\n\</span>
<a name="l02623"></a>02623 <span class="stringliteral">but no count or size letter (see \&quot;x\&quot; command).&quot;</span>));
<a name="l02624"></a>02624   <a class="code" href="command_8h.html#abe42a75e35cfa78e2574e94904d86713">set_cmd_completer</a> (c, expression_completer);
<a name="l02625"></a>02625   <a class="code" href="cli-decode_8c.html#aeeea74da863db26c8d7fee1573f26a05">add_com_alias</a> (<span class="stringliteral">&quot;p&quot;</span>, <span class="stringliteral">&quot;print&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a882324bfe96480c161105fe35d4cd58b">class_vars</a>, 1);
<a name="l02626"></a>02626   <a class="code" href="cli-decode_8c.html#aeeea74da863db26c8d7fee1573f26a05">add_com_alias</a> (<span class="stringliteral">&quot;inspect&quot;</span>, <span class="stringliteral">&quot;print&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a882324bfe96480c161105fe35d4cd58b">class_vars</a>, 1);
<a name="l02627"></a>02627 
<a name="l02628"></a>02628   <a class="code" href="cli-decode_8c.html#a150c74d82f9429f06992c8831dcdd8b3">add_setshow_uinteger_cmd</a> (<span class="stringliteral">&quot;max-symbolic-offset&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49afbf489a4abce7e8770b178aa54f0908b">no_class</a>,
<a name="l02629"></a>02629                             &amp;max_symbolic_offset, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l02630"></a>02630 <span class="stringliteral">Set the largest offset that will be printed in &lt;symbol+1234&gt; form.&quot;</span>), <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l02631"></a>02631 <span class="stringliteral">Show the largest offset that will be printed in &lt;symbol+1234&gt; form.&quot;</span>), <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l02632"></a>02632 <span class="stringliteral">Tell GDB to only display the symbolic form of an address if the\n\</span>
<a name="l02633"></a>02633 <span class="stringliteral">offset between the closest earlier symbol and the address is less than\n\</span>
<a name="l02634"></a>02634 <span class="stringliteral">the specified maximum offset.  The default is \&quot;unlimited\&quot;, which tells GDB\n\</span>
<a name="l02635"></a>02635 <span class="stringliteral">to always print the symbolic form of an address if any symbol precedes\n\</span>
<a name="l02636"></a>02636 <span class="stringliteral">it.  Zero is equivalent to \&quot;unlimited\&quot;.&quot;</span>),
<a name="l02637"></a>02637                             NULL,
<a name="l02638"></a>02638                             show_max_symbolic_offset,
<a name="l02639"></a>02639                             &amp;<a class="code" href="cli-cmds_8c.html#a6ebc4c82da52b9e82c557b19081f1314">setprintlist</a>, &amp;<a class="code" href="cli-cmds_8c.html#a066724dffa9e968b6b6904c372807a80">showprintlist</a>);
<a name="l02640"></a>02640   <a class="code" href="cli-decode_8c.html#ad86a0f135b6c546ae7ffbb41fd72e14f">add_setshow_boolean_cmd</a> (<span class="stringliteral">&quot;symbol-filename&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49afbf489a4abce7e8770b178aa54f0908b">no_class</a>,
<a name="l02641"></a>02641                            &amp;print_symbol_filename, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l02642"></a>02642 <span class="stringliteral">Set printing of source filename and line number with &lt;symbol&gt;.&quot;</span>), <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l02643"></a>02643 <span class="stringliteral">Show printing of source filename and line number with &lt;symbol&gt;.&quot;</span>), NULL,
<a name="l02644"></a>02644                            NULL,
<a name="l02645"></a>02645                            show_print_symbol_filename,
<a name="l02646"></a>02646                            &amp;<a class="code" href="cli-cmds_8c.html#a6ebc4c82da52b9e82c557b19081f1314">setprintlist</a>, &amp;<a class="code" href="cli-cmds_8c.html#a066724dffa9e968b6b6904c372807a80">showprintlist</a>);
<a name="l02647"></a>02647 
<a name="l02648"></a>02648   <a class="code" href="cli-decode_8c.html#a0df0ca36d9acd96440e24407cbef593c">add_com</a> (<span class="stringliteral">&quot;eval&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49afbf489a4abce7e8770b178aa54f0908b">no_class</a>, eval_command, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l02649"></a>02649 <span class="stringliteral">Convert \&quot;printf format string\&quot;, arg1, arg2, arg3, ..., argn to\n\</span>
<a name="l02650"></a>02650 <span class="stringliteral">a command line, and call it.&quot;</span>));
<a name="l02651"></a>02651 }
</pre></div></div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated on Fri Oct 11 2013 14:12:22 for GDB (API) by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
