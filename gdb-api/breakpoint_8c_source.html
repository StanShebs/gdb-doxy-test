<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>GDB (API): /home/stan/gdb/src/gdb/breakpoint.c Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">GDB (API)
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">/home/stan/gdb/src/gdb/breakpoint.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="breakpoint_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/* Everything about breakpoints, for GDB.</span>
<a name="l00002"></a>00002 <span class="comment"></span>
<a name="l00003"></a>00003 <span class="comment">   Copyright (C) 1986-2013 Free Software Foundation, Inc.</span>
<a name="l00004"></a>00004 <span class="comment"></span>
<a name="l00005"></a>00005 <span class="comment">   This file is part of GDB.</span>
<a name="l00006"></a>00006 <span class="comment"></span>
<a name="l00007"></a>00007 <span class="comment">   This program is free software; you can redistribute it and/or modify</span>
<a name="l00008"></a>00008 <span class="comment">   it under the terms of the GNU General Public License as published by</span>
<a name="l00009"></a>00009 <span class="comment">   the Free Software Foundation; either version 3 of the License, or</span>
<a name="l00010"></a>00010 <span class="comment">   (at your option) any later version.</span>
<a name="l00011"></a>00011 <span class="comment"></span>
<a name="l00012"></a>00012 <span class="comment">   This program is distributed in the hope that it will be useful,</span>
<a name="l00013"></a>00013 <span class="comment">   but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00014"></a>00014 <span class="comment">   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00015"></a>00015 <span class="comment">   GNU General Public License for more details.</span>
<a name="l00016"></a>00016 <span class="comment"></span>
<a name="l00017"></a>00017 <span class="comment">   You should have received a copy of the GNU General Public License</span>
<a name="l00018"></a>00018 <span class="comment">   along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.  */</span>
<a name="l00019"></a>00019 
<a name="l00020"></a>00020 <span class="preprocessor">#include &quot;<a class="code" href="defs_8h.html">defs.h</a>&quot;</span>
<a name="l00021"></a>00021 <span class="preprocessor">#include &quot;<a class="code" href="arch-utils_8h.html">arch-utils.h</a>&quot;</span>
<a name="l00022"></a>00022 <span class="preprocessor">#include &lt;ctype.h&gt;</span>
<a name="l00023"></a>00023 <span class="preprocessor">#include &quot;hashtab.h&quot;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &quot;<a class="code" href="symtab_8h.html">symtab.h</a>&quot;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &quot;<a class="code" href="frame_8h.html">frame.h</a>&quot;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &quot;<a class="code" href="breakpoint_8h.html">breakpoint.h</a>&quot;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &quot;<a class="code" href="tracepoint_8h.html">tracepoint.h</a>&quot;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &quot;<a class="code" href="gdbtypes_8h.html">gdbtypes.h</a>&quot;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &quot;<a class="code" href="expression_8h.html">expression.h</a>&quot;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &quot;<a class="code" href="gdbcore_8h.html">gdbcore.h</a>&quot;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &quot;<a class="code" href="gdbcmd_8h.html">gdbcmd.h</a>&quot;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &quot;<a class="code" href="value_8h.html">value.h</a>&quot;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &quot;<a class="code" href="command_8h.html">command.h</a>&quot;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &quot;<a class="code" href="inferior_8h.html">inferior.h</a>&quot;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &quot;<a class="code" href="gdbthread_8h.html">gdbthread.h</a>&quot;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &quot;<a class="code" href="target_8h.html">target.h</a>&quot;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &quot;<a class="code" href="language_8h.html">language.h</a>&quot;</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include &quot;<a class="code" href="gdb__string_8h.html">gdb_string.h</a>&quot;</span>
<a name="l00039"></a>00039 <span class="preprocessor">#include &quot;<a class="code" href="gdb-demangle_8h.html">gdb-demangle.h</a>&quot;</span>
<a name="l00040"></a>00040 <span class="preprocessor">#include &quot;filenames.h&quot;</span>
<a name="l00041"></a>00041 <span class="preprocessor">#include &quot;<a class="code" href="annotate_8h.html">annotate.h</a>&quot;</span>
<a name="l00042"></a>00042 <span class="preprocessor">#include &quot;<a class="code" href="symfile_8h.html">symfile.h</a>&quot;</span>
<a name="l00043"></a>00043 <span class="preprocessor">#include &quot;<a class="code" href="objfiles_8h.html">objfiles.h</a>&quot;</span>
<a name="l00044"></a>00044 <span class="preprocessor">#include &quot;<a class="code" href="source_8h.html">source.h</a>&quot;</span>
<a name="l00045"></a>00045 <span class="preprocessor">#include &quot;<a class="code" href="linespec_8h.html">linespec.h</a>&quot;</span>
<a name="l00046"></a>00046 <span class="preprocessor">#include &quot;<a class="code" href="completer_8h.html">completer.h</a>&quot;</span>
<a name="l00047"></a>00047 <span class="preprocessor">#include &quot;<a class="code" href="gdb_8h.html">gdb.h</a>&quot;</span>
<a name="l00048"></a>00048 <span class="preprocessor">#include &quot;<a class="code" href="ui-out_8h.html">ui-out.h</a>&quot;</span>
<a name="l00049"></a>00049 <span class="preprocessor">#include &quot;<a class="code" href="cli-script_8h.html">cli/cli-script.h</a>&quot;</span>
<a name="l00050"></a>00050 <span class="preprocessor">#include &quot;<a class="code" href="gdb__assert_8h.html">gdb_assert.h</a>&quot;</span>
<a name="l00051"></a>00051 <span class="preprocessor">#include &quot;<a class="code" href="block_8h.html">block.h</a>&quot;</span>
<a name="l00052"></a>00052 <span class="preprocessor">#include &quot;<a class="code" href="solib_8h.html">solib.h</a>&quot;</span>
<a name="l00053"></a>00053 <span class="preprocessor">#include &quot;<a class="code" href="solist_8h.html">solist.h</a>&quot;</span>
<a name="l00054"></a>00054 <span class="preprocessor">#include &quot;<a class="code" href="observer_8h.html">observer.h</a>&quot;</span>
<a name="l00055"></a>00055 <span class="preprocessor">#include &quot;<a class="code" href="exceptions_8h.html">exceptions.h</a>&quot;</span>
<a name="l00056"></a>00056 <span class="preprocessor">#include &quot;<a class="code" href="memattr_8h.html">memattr.h</a>&quot;</span>
<a name="l00057"></a>00057 <span class="preprocessor">#include &quot;<a class="code" href="ada-lang_8h.html">ada-lang.h</a>&quot;</span>
<a name="l00058"></a>00058 <span class="preprocessor">#include &quot;<a class="code" href="top_8h.html">top.h</a>&quot;</span>
<a name="l00059"></a>00059 <span class="preprocessor">#include &quot;<a class="code" href="valprint_8h.html">valprint.h</a>&quot;</span>
<a name="l00060"></a>00060 <span class="preprocessor">#include &quot;<a class="code" href="jit_8h.html">jit.h</a>&quot;</span>
<a name="l00061"></a>00061 <span class="preprocessor">#include &quot;<a class="code" href="xml-syscall_8h.html">xml-syscall.h</a>&quot;</span>
<a name="l00062"></a>00062 <span class="preprocessor">#include &quot;<a class="code" href="parser-defs_8h.html">parser-defs.h</a>&quot;</span>
<a name="l00063"></a>00063 <span class="preprocessor">#include &quot;<a class="code" href="gdb__regex_8h.html">gdb_regex.h</a>&quot;</span>
<a name="l00064"></a>00064 <span class="preprocessor">#include &quot;<a class="code" href="probe_8h.html">probe.h</a>&quot;</span>
<a name="l00065"></a>00065 <span class="preprocessor">#include &quot;<a class="code" href="cli-utils_8h.html">cli/cli-utils.h</a>&quot;</span>
<a name="l00066"></a>00066 <span class="preprocessor">#include &quot;<a class="code" href="continuations_8h.html">continuations.h</a>&quot;</span>
<a name="l00067"></a>00067 <span class="preprocessor">#include &quot;<a class="code" href="stack_8h.html">stack.h</a>&quot;</span>
<a name="l00068"></a>00068 <span class="preprocessor">#include &quot;<a class="code" href="skip_8h.html">skip.h</a>&quot;</span>
<a name="l00069"></a>00069 <span class="preprocessor">#include &quot;<a class="code" href="gdb__regex_8h.html">gdb_regex.h</a>&quot;</span>
<a name="l00070"></a>00070 <span class="preprocessor">#include &quot;<a class="code" href="ax-gdb_8h.html">ax-gdb.h</a>&quot;</span>
<a name="l00071"></a>00071 <span class="preprocessor">#include &quot;<a class="code" href="dummy-frame_8h.html">dummy-frame.h</a>&quot;</span>
<a name="l00072"></a>00072 
<a name="l00073"></a>00073 <span class="preprocessor">#include &quot;<a class="code" href="format_8h.html">format.h</a>&quot;</span>
<a name="l00074"></a>00074 
<a name="l00075"></a>00075 <span class="comment">/* readline include files */</span>
<a name="l00076"></a>00076 <span class="preprocessor">#include &quot;readline/readline.h&quot;</span>
<a name="l00077"></a>00077 <span class="preprocessor">#include &quot;readline/history.h&quot;</span>
<a name="l00078"></a>00078 
<a name="l00079"></a>00079 <span class="comment">/* readline defines this.  */</span>
<a name="l00080"></a>00080 <span class="preprocessor">#undef savestring</span>
<a name="l00081"></a>00081 <span class="preprocessor"></span>
<a name="l00082"></a>00082 <span class="preprocessor">#include &quot;<a class="code" href="mi-common_8h.html">mi/mi-common.h</a>&quot;</span>
<a name="l00083"></a>00083 <span class="preprocessor">#include &quot;<a class="code" href="python_8h.html">python/python.h</a>&quot;</span>
<a name="l00084"></a>00084 
<a name="l00085"></a>00085 <span class="comment">/* Enums for exception-handling support.  */</span>
<a name="l00086"></a><a class="code" href="breakpoint_8c.html#a76b00cda05f685d6544027bb6e2d2019">00086</a> <span class="keyword">enum</span> <a class="code" href="break-catch-throw_8c.html#a76b00cda05f685d6544027bb6e2d2019">exception_event_kind</a>
<a name="l00087"></a>00087 {
<a name="l00088"></a><a class="code" href="breakpoint_8c.html#a76b00cda05f685d6544027bb6e2d2019ac63ba6cc4d9d83158aaf51d821e61ddb">00088</a>   <a class="code" href="break-catch-throw_8c.html#a76b00cda05f685d6544027bb6e2d2019ac63ba6cc4d9d83158aaf51d821e61ddb">EX_EVENT_THROW</a>,
<a name="l00089"></a><a class="code" href="breakpoint_8c.html#a76b00cda05f685d6544027bb6e2d2019aea2ef98086d56d9b1ec135cfb9364663">00089</a>   <a class="code" href="break-catch-throw_8c.html#a76b00cda05f685d6544027bb6e2d2019aea2ef98086d56d9b1ec135cfb9364663">EX_EVENT_RETHROW</a>,
<a name="l00090"></a><a class="code" href="breakpoint_8c.html#a76b00cda05f685d6544027bb6e2d2019a868ccea5413c450bcfd1d2b8073f8dc8">00090</a>   <a class="code" href="break-catch-throw_8c.html#a76b00cda05f685d6544027bb6e2d2019a868ccea5413c450bcfd1d2b8073f8dc8">EX_EVENT_CATCH</a>
<a name="l00091"></a>00091 };
<a name="l00092"></a>00092 
<a name="l00093"></a>00093 <span class="comment">/* Prototypes for local functions.  */</span>
<a name="l00094"></a>00094 
<a name="l00095"></a>00095 <span class="keyword">static</span> <span class="keywordtype">void</span> enable_delete_command (<span class="keywordtype">char</span> *, <span class="keywordtype">int</span>);
<a name="l00096"></a>00096 
<a name="l00097"></a>00097 <span class="keyword">static</span> <span class="keywordtype">void</span> enable_once_command (<span class="keywordtype">char</span> *, <span class="keywordtype">int</span>);
<a name="l00098"></a>00098 
<a name="l00099"></a>00099 <span class="keyword">static</span> <span class="keywordtype">void</span> enable_count_command (<span class="keywordtype">char</span> *, <span class="keywordtype">int</span>);
<a name="l00100"></a>00100 
<a name="l00101"></a>00101 <span class="keyword">static</span> <span class="keywordtype">void</span> disable_command (<span class="keywordtype">char</span> *, <span class="keywordtype">int</span>);
<a name="l00102"></a>00102 
<a name="l00103"></a>00103 <span class="keyword">static</span> <span class="keywordtype">void</span> enable_command (<span class="keywordtype">char</span> *, <span class="keywordtype">int</span>);
<a name="l00104"></a>00104 
<a name="l00105"></a>00105 <span class="keyword">static</span> <span class="keywordtype">void</span> map_breakpoint_numbers (<span class="keywordtype">char</span> *, <span class="keywordtype">void</span> (*) (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *,
<a name="l00106"></a>00106                                                       <span class="keywordtype">void</span> *),
<a name="l00107"></a>00107                                     <span class="keywordtype">void</span> *);
<a name="l00108"></a>00108 
<a name="l00109"></a>00109 <span class="keyword">static</span> <span class="keywordtype">void</span> ignore_command (<span class="keywordtype">char</span> *, <span class="keywordtype">int</span>);
<a name="l00110"></a>00110 
<a name="l00111"></a>00111 <span class="keyword">static</span> <span class="keywordtype">int</span> breakpoint_re_set_one (<span class="keywordtype">void</span> *);
<a name="l00112"></a>00112 
<a name="l00113"></a>00113 <span class="keyword">static</span> <span class="keywordtype">void</span> breakpoint_re_set_default (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *);
<a name="l00114"></a>00114 
<a name="l00115"></a>00115 <span class="keyword">static</span> <span class="keywordtype">void</span> create_sals_from_address_default (<span class="keywordtype">char</span> **,
<a name="l00116"></a>00116                                               <span class="keyword">struct</span> <a class="code" href="structlinespec__result.html">linespec_result</a> *,
<a name="l00117"></a>00117                                               <span class="keyword">enum</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cf">bptype</a>, <span class="keywordtype">char</span> *,
<a name="l00118"></a>00118                                               <span class="keywordtype">char</span> **);
<a name="l00119"></a>00119 
<a name="l00120"></a>00120 <span class="keyword">static</span> <span class="keywordtype">void</span> create_breakpoints_sal_default (<span class="keyword">struct</span> gdbarch *,
<a name="l00121"></a>00121                                             <span class="keyword">struct</span> <a class="code" href="structlinespec__result.html">linespec_result</a> *,
<a name="l00122"></a>00122                                             <span class="keywordtype">char</span> *, <span class="keywordtype">char</span> *, <span class="keyword">enum</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cf">bptype</a>,
<a name="l00123"></a>00123                                             <span class="keyword">enum</span> <a class="code" href="breakpoint_8h.html#a15f2bbd9012f59bc09d59feef0c15732">bpdisp</a>, <span class="keywordtype">int</span>, <span class="keywordtype">int</span>,
<a name="l00124"></a>00124                                             <span class="keywordtype">int</span>,
<a name="l00125"></a>00125                                             <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structbreakpoint__ops.html">breakpoint_ops</a> *,
<a name="l00126"></a>00126                                             <span class="keywordtype">int</span>, <span class="keywordtype">int</span>, <span class="keywordtype">int</span>, <span class="keywordtype">unsigned</span>);
<a name="l00127"></a>00127 
<a name="l00128"></a>00128 <span class="keyword">static</span> <span class="keywordtype">void</span> decode_linespec_default (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *, <span class="keywordtype">char</span> **,
<a name="l00129"></a>00129                                      <span class="keyword">struct</span> <a class="code" href="structsymtabs__and__lines.html">symtabs_and_lines</a> *);
<a name="l00130"></a>00130 
<a name="l00131"></a>00131 <span class="keyword">static</span> <span class="keywordtype">void</span> clear_command (<span class="keywordtype">char</span> *, <span class="keywordtype">int</span>);
<a name="l00132"></a>00132 
<a name="l00133"></a>00133 <span class="keyword">static</span> <span class="keywordtype">void</span> catch_command (<span class="keywordtype">char</span> *, <span class="keywordtype">int</span>);
<a name="l00134"></a>00134 
<a name="l00135"></a>00135 <span class="keyword">static</span> <span class="keywordtype">int</span> can_use_hardware_watchpoint (<span class="keyword">struct</span> value *);
<a name="l00136"></a>00136 
<a name="l00137"></a>00137 <span class="keyword">static</span> <span class="keywordtype">void</span> break_command_1 (<span class="keywordtype">char</span> *, <span class="keywordtype">int</span>, <span class="keywordtype">int</span>);
<a name="l00138"></a>00138 
<a name="l00139"></a>00139 <span class="keyword">static</span> <span class="keywordtype">void</span> mention (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *);
<a name="l00140"></a>00140 
<a name="l00141"></a>00141 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *set_raw_breakpoint_without_location (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html#aa044541ad4e4e66cf23affcd6d8b1759">gdbarch</a> *,
<a name="l00142"></a>00142                                                                <span class="keyword">enum</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cf">bptype</a>,
<a name="l00143"></a>00143                                                                <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structbreakpoint__ops.html">breakpoint_ops</a> *);
<a name="l00144"></a>00144 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structbp__location.html">bp_location</a> *add_location_to_breakpoint (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *,
<a name="l00145"></a>00145                                                        <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structsymtab__and__line.html">symtab_and_line</a> *);
<a name="l00146"></a>00146 
<a name="l00147"></a>00147 <span class="comment">/* This function is used in gdbtk sources and thus can not be made</span>
<a name="l00148"></a>00148 <span class="comment">   static.  */</span>
<a name="l00149"></a>00149 <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *<a class="code" href="breakpoint_8c.html#a99e75dcf89d9291dc55db2453cb16a0a">set_raw_breakpoint</a> (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html#aa044541ad4e4e66cf23affcd6d8b1759">gdbarch</a> *<a class="code" href="structbreakpoint.html#aa044541ad4e4e66cf23affcd6d8b1759">gdbarch</a>,
<a name="l00150"></a>00150                                        <span class="keyword">struct</span> <a class="code" href="structsymtab__and__line.html">symtab_and_line</a>,
<a name="l00151"></a>00151                                        <span class="keyword">enum</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cf">bptype</a>,
<a name="l00152"></a>00152                                        <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structbreakpoint__ops.html">breakpoint_ops</a> *);
<a name="l00153"></a>00153 
<a name="l00154"></a>00154 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *
<a name="l00155"></a>00155   momentary_breakpoint_from_master (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *orig,
<a name="l00156"></a>00156                                     <span class="keyword">enum</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cf">bptype</a> <a class="code" href="structtype.html">type</a>,
<a name="l00157"></a>00157                                     <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structbreakpoint__ops.html">breakpoint_ops</a> *<a class="code" href="structbreakpoint.html#aba258aa23496f6434aaa1cf8c8dc7ea7">ops</a>);
<a name="l00158"></a>00158 
<a name="l00159"></a>00159 <span class="keyword">static</span> <span class="keywordtype">void</span> breakpoint_adjustment_warning (<a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a>, <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a>, <span class="keywordtype">int</span>, <span class="keywordtype">int</span>);
<a name="l00160"></a>00160 
<a name="l00161"></a>00161 <span class="keyword">static</span> <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> adjust_breakpoint_address (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html#aa044541ad4e4e66cf23affcd6d8b1759">gdbarch</a> *<a class="code" href="structbreakpoint.html#aa044541ad4e4e66cf23affcd6d8b1759">gdbarch</a>,
<a name="l00162"></a>00162                                             <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> bpaddr,
<a name="l00163"></a>00163                                             <span class="keyword">enum</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cf">bptype</a> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cf">bptype</a>);
<a name="l00164"></a>00164 
<a name="l00165"></a>00165 <span class="keyword">static</span> <span class="keywordtype">void</span> describe_other_breakpoints (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html#aa044541ad4e4e66cf23affcd6d8b1759">gdbarch</a> *,
<a name="l00166"></a>00166                                         <span class="keyword">struct</span> <a class="code" href="structprogram__space.html">program_space</a> *, <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a>,
<a name="l00167"></a>00167                                         <span class="keyword">struct</span> <a class="code" href="structobj__section.html">obj_section</a> *, <span class="keywordtype">int</span>);
<a name="l00168"></a>00168 
<a name="l00169"></a>00169 <span class="keyword">static</span> <span class="keywordtype">int</span> breakpoint_address_match (<span class="keyword">struct</span> address_space *aspace1,
<a name="l00170"></a>00170                                      <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> addr1,
<a name="l00171"></a>00171                                      <span class="keyword">struct</span> address_space *aspace2,
<a name="l00172"></a>00172                                      <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> addr2);
<a name="l00173"></a>00173 
<a name="l00174"></a>00174 <span class="keyword">static</span> <span class="keywordtype">int</span> watchpoint_locations_match (<span class="keyword">struct</span> <a class="code" href="structbp__location.html">bp_location</a> *loc1,
<a name="l00175"></a>00175                                        <span class="keyword">struct</span> <a class="code" href="structbp__location.html">bp_location</a> *loc2);
<a name="l00176"></a>00176 
<a name="l00177"></a>00177 <span class="keyword">static</span> <span class="keywordtype">int</span> breakpoint_location_address_match (<span class="keyword">struct</span> <a class="code" href="structbp__location.html">bp_location</a> *bl,
<a name="l00178"></a>00178                                               <span class="keyword">struct</span> address_space *aspace,
<a name="l00179"></a>00179                                               <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> addr);
<a name="l00180"></a>00180 
<a name="l00181"></a>00181 <span class="keyword">static</span> <span class="keywordtype">void</span> breakpoints_info (<span class="keywordtype">char</span> *, <span class="keywordtype">int</span>);
<a name="l00182"></a>00182 
<a name="l00183"></a>00183 <span class="keyword">static</span> <span class="keywordtype">void</span> watchpoints_info (<span class="keywordtype">char</span> *, <span class="keywordtype">int</span>);
<a name="l00184"></a>00184 
<a name="l00185"></a>00185 <span class="keyword">static</span> <span class="keywordtype">int</span> breakpoint_1 (<span class="keywordtype">char</span> *, <span class="keywordtype">int</span>, 
<a name="l00186"></a>00186                          <span class="keywordtype">int</span> (*) (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *));
<a name="l00187"></a>00187 
<a name="l00188"></a>00188 <span class="keyword">static</span> <span class="keywordtype">int</span> breakpoint_cond_eval (<span class="keywordtype">void</span> *);
<a name="l00189"></a>00189 
<a name="l00190"></a>00190 <span class="keyword">static</span> <span class="keywordtype">void</span> cleanup_executing_breakpoints (<span class="keywordtype">void</span> *);
<a name="l00191"></a>00191 
<a name="l00192"></a>00192 <span class="keyword">static</span> <span class="keywordtype">void</span> commands_command (<span class="keywordtype">char</span> *, <span class="keywordtype">int</span>);
<a name="l00193"></a>00193 
<a name="l00194"></a>00194 <span class="keyword">static</span> <span class="keywordtype">void</span> condition_command (<span class="keywordtype">char</span> *, <span class="keywordtype">int</span>);
<a name="l00195"></a>00195 
<a name="l00196"></a><a class="code" href="breakpoint_8c.html#a644fb6ed981d6c6fe6276d324ac6be1c">00196</a> <span class="keyword">typedef</span> <span class="keyword">enum</span>
<a name="l00197"></a>00197   {
<a name="l00198"></a><a class="code" href="breakpoint_8c.html#a644fb6ed981d6c6fe6276d324ac6be1caf02d5e895cc076528970b6c586250c9e">00198</a>     <a class="code" href="breakpoint_8c.html#a644fb6ed981d6c6fe6276d324ac6be1caf02d5e895cc076528970b6c586250c9e">mark_inserted</a>,
<a name="l00199"></a><a class="code" href="breakpoint_8c.html#a644fb6ed981d6c6fe6276d324ac6be1caf92bac8f4a4afba3b9b475022a52dde2">00199</a>     <a class="code" href="breakpoint_8c.html#a644fb6ed981d6c6fe6276d324ac6be1caf92bac8f4a4afba3b9b475022a52dde2">mark_uninserted</a>
<a name="l00200"></a>00200   }
<a name="l00201"></a>00201 <a class="code" href="breakpoint_8c.html#a644fb6ed981d6c6fe6276d324ac6be1c">insertion_state_t</a>;
<a name="l00202"></a>00202 
<a name="l00203"></a>00203 <span class="keyword">static</span> <span class="keywordtype">int</span> remove_breakpoint (<span class="keyword">struct</span> <a class="code" href="structbp__location.html">bp_location</a> *, <a class="code" href="breakpoint_8c.html#a644fb6ed981d6c6fe6276d324ac6be1c">insertion_state_t</a>);
<a name="l00204"></a>00204 <span class="keyword">static</span> <span class="keywordtype">int</span> remove_breakpoint_1 (<span class="keyword">struct</span> <a class="code" href="structbp__location.html">bp_location</a> *, <a class="code" href="breakpoint_8c.html#a644fb6ed981d6c6fe6276d324ac6be1c">insertion_state_t</a>);
<a name="l00205"></a>00205 
<a name="l00206"></a>00206 <span class="keyword">static</span> <span class="keyword">enum</span> <a class="code" href="breakpoint_8h.html#ab6ab1d6a867561653e32a901b41be66b">print_stop_action</a> print_bp_stop_message (<a class="code" href="structbpstats.html">bpstat</a> bs);
<a name="l00207"></a>00207 
<a name="l00208"></a>00208 <span class="keyword">static</span> <span class="keywordtype">int</span> watchpoint_check (<span class="keywordtype">void</span> *);
<a name="l00209"></a>00209 
<a name="l00210"></a>00210 <span class="keyword">static</span> <span class="keywordtype">void</span> maintenance_info_breakpoints (<span class="keywordtype">char</span> *, <span class="keywordtype">int</span>);
<a name="l00211"></a>00211 
<a name="l00212"></a>00212 <span class="keyword">static</span> <span class="keywordtype">int</span> hw_breakpoint_used_count (<span class="keywordtype">void</span>);
<a name="l00213"></a>00213 
<a name="l00214"></a>00214 <span class="keyword">static</span> <span class="keywordtype">int</span> hw_watchpoint_use_count (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *);
<a name="l00215"></a>00215 
<a name="l00216"></a>00216 <span class="keyword">static</span> <span class="keywordtype">int</span> hw_watchpoint_used_count_others (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *except,
<a name="l00217"></a>00217                                             <span class="keyword">enum</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cf">bptype</a> <a class="code" href="structtype.html">type</a>,
<a name="l00218"></a>00218                                             <span class="keywordtype">int</span> *other_type_used);
<a name="l00219"></a>00219 
<a name="l00220"></a>00220 <span class="keyword">static</span> <span class="keywordtype">void</span> hbreak_command (<span class="keywordtype">char</span> *, <span class="keywordtype">int</span>);
<a name="l00221"></a>00221 
<a name="l00222"></a>00222 <span class="keyword">static</span> <span class="keywordtype">void</span> thbreak_command (<span class="keywordtype">char</span> *, <span class="keywordtype">int</span>);
<a name="l00223"></a>00223 
<a name="l00224"></a>00224 <span class="keyword">static</span> <span class="keywordtype">void</span> enable_breakpoint_disp (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *, <span class="keyword">enum</span> <a class="code" href="breakpoint_8h.html#a15f2bbd9012f59bc09d59feef0c15732">bpdisp</a>,
<a name="l00225"></a>00225                                     <span class="keywordtype">int</span> count);
<a name="l00226"></a>00226 
<a name="l00227"></a>00227 <span class="keyword">static</span> <span class="keywordtype">void</span> stop_command (<span class="keywordtype">char</span> *arg, <span class="keywordtype">int</span> from_tty);
<a name="l00228"></a>00228 
<a name="l00229"></a>00229 <span class="keyword">static</span> <span class="keywordtype">void</span> stopin_command (<span class="keywordtype">char</span> *arg, <span class="keywordtype">int</span> from_tty);
<a name="l00230"></a>00230 
<a name="l00231"></a>00231 <span class="keyword">static</span> <span class="keywordtype">void</span> stopat_command (<span class="keywordtype">char</span> *arg, <span class="keywordtype">int</span> from_tty);
<a name="l00232"></a>00232 
<a name="l00233"></a>00233 <span class="keyword">static</span> <span class="keywordtype">void</span> tcatch_command (<span class="keywordtype">char</span> *arg, <span class="keywordtype">int</span> from_tty);
<a name="l00234"></a>00234 
<a name="l00235"></a>00235 <span class="keyword">static</span> <span class="keywordtype">void</span> detach_single_step_breakpoints (<span class="keywordtype">void</span>);
<a name="l00236"></a>00236 
<a name="l00237"></a>00237 <span class="keyword">static</span> <span class="keywordtype">int</span> single_step_breakpoint_inserted_here_p (<span class="keyword">struct</span> address_space *,
<a name="l00238"></a>00238                                                    <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> pc);
<a name="l00239"></a>00239 
<a name="l00240"></a>00240 <span class="keyword">static</span> <span class="keywordtype">void</span> free_bp_location (<span class="keyword">struct</span> <a class="code" href="structbp__location.html">bp_location</a> *<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>);
<a name="l00241"></a>00241 <span class="keyword">static</span> <span class="keywordtype">void</span> incref_bp_location (<span class="keyword">struct</span> <a class="code" href="structbp__location.html">bp_location</a> *<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>);
<a name="l00242"></a>00242 <span class="keyword">static</span> <span class="keywordtype">void</span> decref_bp_location (<span class="keyword">struct</span> <a class="code" href="structbp__location.html">bp_location</a> **<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>);
<a name="l00243"></a>00243 
<a name="l00244"></a>00244 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structbp__location.html">bp_location</a> *allocate_bp_location (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *bpt);
<a name="l00245"></a>00245 
<a name="l00246"></a>00246 <span class="keyword">static</span> <span class="keywordtype">void</span> update_global_location_list (<span class="keywordtype">int</span>);
<a name="l00247"></a>00247 
<a name="l00248"></a>00248 <span class="keyword">static</span> <span class="keywordtype">void</span> update_global_location_list_nothrow (<span class="keywordtype">int</span>);
<a name="l00249"></a>00249 
<a name="l00250"></a>00250 <span class="keyword">static</span> <span class="keywordtype">int</span> is_hardware_watchpoint (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *bpt);
<a name="l00251"></a>00251 
<a name="l00252"></a>00252 <span class="keyword">static</span> <span class="keywordtype">void</span> insert_breakpoint_locations (<span class="keywordtype">void</span>);
<a name="l00253"></a>00253 
<a name="l00254"></a>00254 <span class="keyword">static</span> <span class="keywordtype">int</span> syscall_catchpoint_p (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b);
<a name="l00255"></a>00255 
<a name="l00256"></a>00256 <span class="keyword">static</span> <span class="keywordtype">void</span> tracepoints_info (<span class="keywordtype">char</span> *, <span class="keywordtype">int</span>);
<a name="l00257"></a>00257 
<a name="l00258"></a>00258 <span class="keyword">static</span> <span class="keywordtype">void</span> delete_trace_command (<span class="keywordtype">char</span> *, <span class="keywordtype">int</span>);
<a name="l00259"></a>00259 
<a name="l00260"></a>00260 <span class="keyword">static</span> <span class="keywordtype">void</span> enable_trace_command (<span class="keywordtype">char</span> *, <span class="keywordtype">int</span>);
<a name="l00261"></a>00261 
<a name="l00262"></a>00262 <span class="keyword">static</span> <span class="keywordtype">void</span> disable_trace_command (<span class="keywordtype">char</span> *, <span class="keywordtype">int</span>);
<a name="l00263"></a>00263 
<a name="l00264"></a>00264 <span class="keyword">static</span> <span class="keywordtype">void</span> trace_pass_command (<span class="keywordtype">char</span> *, <span class="keywordtype">int</span>);
<a name="l00265"></a>00265 
<a name="l00266"></a>00266 <span class="keyword">static</span> <span class="keywordtype">void</span> set_tracepoint_count (<span class="keywordtype">int</span> num);
<a name="l00267"></a>00267 
<a name="l00268"></a>00268 <span class="keyword">static</span> <span class="keywordtype">int</span> is_masked_watchpoint (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b);
<a name="l00269"></a>00269 
<a name="l00270"></a>00270 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structbp__location.html">bp_location</a> **get_first_locp_gte_addr (<a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> <a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>);
<a name="l00271"></a>00271 
<a name="l00272"></a>00272 <span class="comment">/* Return 1 if B refers to a static tracepoint set by marker (&quot;-m&quot;), zero</span>
<a name="l00273"></a>00273 <span class="comment">   otherwise.  */</span>
<a name="l00274"></a>00274 
<a name="l00275"></a>00275 <span class="keyword">static</span> <span class="keywordtype">int</span> strace_marker_p (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b);
<a name="l00276"></a>00276 
<a name="l00277"></a>00277 <span class="comment">/* The abstract base class all breakpoint_ops structures inherit</span>
<a name="l00278"></a>00278 <span class="comment">   from.  */</span>
<a name="l00279"></a><a class="code" href="breakpoint_8h.html#aefe1d12780f2d7ae5fb89ac113e204e0">00279</a> <span class="keyword">struct </span><a class="code" href="structbreakpoint__ops.html">breakpoint_ops</a> <a class="code" href="breakpoint_8c.html#aefe1d12780f2d7ae5fb89ac113e204e0">base_breakpoint_ops</a>;
<a name="l00280"></a>00280 
<a name="l00281"></a>00281 <span class="comment">/* The breakpoint_ops structure to be inherited by all breakpoint_ops</span>
<a name="l00282"></a>00282 <span class="comment">   that are implemented on top of software or hardware breakpoints</span>
<a name="l00283"></a>00283 <span class="comment">   (user breakpoints, internal and momentary breakpoints, etc.).  */</span>
<a name="l00284"></a>00284 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structbreakpoint__ops.html">breakpoint_ops</a> bkpt_base_breakpoint_ops;
<a name="l00285"></a>00285 
<a name="l00286"></a>00286 <span class="comment">/* Internal breakpoints class type.  */</span>
<a name="l00287"></a>00287 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structbreakpoint__ops.html">breakpoint_ops</a> internal_breakpoint_ops;
<a name="l00288"></a>00288 
<a name="l00289"></a>00289 <span class="comment">/* Momentary breakpoints class type.  */</span>
<a name="l00290"></a>00290 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structbreakpoint__ops.html">breakpoint_ops</a> momentary_breakpoint_ops;
<a name="l00291"></a>00291 
<a name="l00292"></a>00292 <span class="comment">/* Momentary breakpoints for bp_longjmp and bp_exception class type.  */</span>
<a name="l00293"></a>00293 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structbreakpoint__ops.html">breakpoint_ops</a> longjmp_breakpoint_ops;
<a name="l00294"></a>00294 
<a name="l00295"></a>00295 <span class="comment">/* The breakpoint_ops structure to be used in regular user created</span>
<a name="l00296"></a>00296 <span class="comment">   breakpoints.  */</span>
<a name="l00297"></a><a class="code" href="breakpoint_8h.html#a9b47dd7cd982ec63ffd303246d93cf7a">00297</a> <span class="keyword">struct </span><a class="code" href="structbreakpoint__ops.html">breakpoint_ops</a> <a class="code" href="breakpoint_8c.html#a9b47dd7cd982ec63ffd303246d93cf7a">bkpt_breakpoint_ops</a>;
<a name="l00298"></a>00298 
<a name="l00299"></a>00299 <span class="comment">/* Breakpoints set on probes.  */</span>
<a name="l00300"></a>00300 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structbreakpoint__ops.html">breakpoint_ops</a> bkpt_probe_breakpoint_ops;
<a name="l00301"></a>00301 
<a name="l00302"></a>00302 <span class="comment">/* Dynamic printf class type.  */</span>
<a name="l00303"></a><a class="code" href="breakpoint_8h.html#a21625ec72da41a93186216198d3bceae">00303</a> <span class="keyword">struct </span><a class="code" href="structbreakpoint__ops.html">breakpoint_ops</a> <a class="code" href="breakpoint_8c.html#a21625ec72da41a93186216198d3bceae">dprintf_breakpoint_ops</a>;
<a name="l00304"></a>00304 
<a name="l00305"></a>00305 <span class="comment">/* The style in which to perform a dynamic printf.  This is a user</span>
<a name="l00306"></a>00306 <span class="comment">   option because different output options have different tradeoffs;</span>
<a name="l00307"></a>00307 <span class="comment">   if GDB does the printing, there is better error handling if there</span>
<a name="l00308"></a>00308 <span class="comment">   is a problem with any of the arguments, but using an inferior</span>
<a name="l00309"></a>00309 <span class="comment">   function lets you have special-purpose printers and sending of</span>
<a name="l00310"></a>00310 <span class="comment">   output to the same place as compiled-in print functions.  */</span>
<a name="l00311"></a>00311 
<a name="l00312"></a>00312 <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> dprintf_style_gdb[] = <span class="stringliteral">&quot;gdb&quot;</span>;
<a name="l00313"></a>00313 <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> dprintf_style_call[] = <span class="stringliteral">&quot;call&quot;</span>;
<a name="l00314"></a>00314 <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> dprintf_style_agent[] = <span class="stringliteral">&quot;agent&quot;</span>;
<a name="l00315"></a>00315 <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> dprintf_style_enums[] = {
<a name="l00316"></a>00316   dprintf_style_gdb,
<a name="l00317"></a>00317   dprintf_style_call,
<a name="l00318"></a>00318   dprintf_style_agent,
<a name="l00319"></a>00319   NULL
<a name="l00320"></a>00320 };
<a name="l00321"></a>00321 <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *dprintf_style = dprintf_style_gdb;
<a name="l00322"></a>00322 
<a name="l00323"></a>00323 <span class="comment">/* The function to use for dynamic printf if the preferred style is to</span>
<a name="l00324"></a>00324 <span class="comment">   call into the inferior.  The value is simply a string that is</span>
<a name="l00325"></a>00325 <span class="comment">   copied into the command, so it can be anything that GDB can</span>
<a name="l00326"></a>00326 <span class="comment">   evaluate to a callable address, not necessarily a function name.  */</span>
<a name="l00327"></a>00327 
<a name="l00328"></a>00328 <span class="keyword">static</span> <span class="keywordtype">char</span> *dprintf_function = <span class="stringliteral">&quot;&quot;</span>;
<a name="l00329"></a>00329 
<a name="l00330"></a>00330 <span class="comment">/* The channel to use for dynamic printf if the preferred style is to</span>
<a name="l00331"></a>00331 <span class="comment">   call into the inferior; if a nonempty string, it will be passed to</span>
<a name="l00332"></a>00332 <span class="comment">   the call as the first argument, with the format string as the</span>
<a name="l00333"></a>00333 <span class="comment">   second.  As with the dprintf function, this can be anything that</span>
<a name="l00334"></a>00334 <span class="comment">   GDB knows how to evaluate, so in addition to common choices like</span>
<a name="l00335"></a>00335 <span class="comment">   &quot;stderr&quot;, this could be an app-specific expression like</span>
<a name="l00336"></a>00336 <span class="comment">   &quot;mystreams[curlogger]&quot;.  */</span>
<a name="l00337"></a>00337 
<a name="l00338"></a>00338 <span class="keyword">static</span> <span class="keywordtype">char</span> *dprintf_channel = <span class="stringliteral">&quot;&quot;</span>;
<a name="l00339"></a>00339 
<a name="l00340"></a>00340 <span class="comment">/* True if dprintf commands should continue to operate even if GDB</span>
<a name="l00341"></a>00341 <span class="comment">   has disconnected.  */</span>
<a name="l00342"></a>00342 <span class="keyword">static</span> <span class="keywordtype">int</span> disconnected_dprintf = 1;
<a name="l00343"></a>00343 
<a name="l00344"></a>00344 <span class="comment">/* A reference-counted struct command_line.  This lets multiple</span>
<a name="l00345"></a>00345 <span class="comment">   breakpoints share a single command list.  */</span>
<a name="l00346"></a>00346 <span class="keyword">struct </span>counted_command_line
<a name="l00347"></a>00347 {
<a name="l00348"></a>00348   <span class="comment">/* The reference count.  */</span>
<a name="l00349"></a>00349   <span class="keywordtype">int</span> refc;
<a name="l00350"></a>00350 
<a name="l00351"></a>00351   <span class="comment">/* The command list.  */</span>
<a name="l00352"></a>00352   <span class="keyword">struct </span><a class="code" href="structcommand__line.html">command_line</a> *commands;
<a name="l00353"></a>00353 };
<a name="l00354"></a>00354 
<a name="l00355"></a>00355 <span class="keyword">struct </span><a class="code" href="structcommand__line.html">command_line</a> *
<a name="l00356"></a><a class="code" href="breakpoint_8h.html#a16d90a8a7538ab83a10635a1881af060">00356</a> <a class="code" href="breakpoint_8c.html#a16d90a8a7538ab83a10635a1881af060">breakpoint_commands</a> (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b)
<a name="l00357"></a>00357 {
<a name="l00358"></a>00358   <span class="keywordflow">return</span> b-&gt;<a class="code" href="structbreakpoint.html#a054780dffadb1a4af0fc35037834fe4b">commands</a> ? b-&gt;<a class="code" href="structbreakpoint.html#a054780dffadb1a4af0fc35037834fe4b">commands</a>-&gt;commands : NULL;
<a name="l00359"></a>00359 }
<a name="l00360"></a>00360 
<a name="l00361"></a>00361 <span class="comment">/* Flag indicating that a command has proceeded the inferior past the</span>
<a name="l00362"></a>00362 <span class="comment">   current breakpoint.  */</span>
<a name="l00363"></a>00363 
<a name="l00364"></a>00364 <span class="keyword">static</span> <span class="keywordtype">int</span> breakpoint_proceeded;
<a name="l00365"></a>00365 
<a name="l00366"></a>00366 <span class="keyword">const</span> <span class="keywordtype">char</span> *
<a name="l00367"></a><a class="code" href="breakpoint_8h.html#a6f45019563f41b3ae4dc92df09f12618">00367</a> <a class="code" href="breakpoint_8c.html#a6f45019563f41b3ae4dc92df09f12618">bpdisp_text</a> (<span class="keyword">enum</span> <a class="code" href="breakpoint_8h.html#a15f2bbd9012f59bc09d59feef0c15732">bpdisp</a> disp)
<a name="l00368"></a>00368 {
<a name="l00369"></a>00369   <span class="comment">/* NOTE: the following values are a part of MI protocol and</span>
<a name="l00370"></a>00370 <span class="comment">     represent values of &#39;disp&#39; field returned when inferior stops at</span>
<a name="l00371"></a>00371 <span class="comment">     a breakpoint.  */</span>
<a name="l00372"></a>00372   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> * <span class="keyword">const</span> bpdisps[] = {<span class="stringliteral">&quot;del&quot;</span>, <span class="stringliteral">&quot;dstp&quot;</span>, <span class="stringliteral">&quot;dis&quot;</span>, <span class="stringliteral">&quot;keep&quot;</span>};
<a name="l00373"></a>00373 
<a name="l00374"></a>00374   <span class="keywordflow">return</span> bpdisps[(<a class="code" href="command_8h.html#a74f207b5aa4ba51c3a2ad59b219a423b">int</a>) disp];
<a name="l00375"></a>00375 }
<a name="l00376"></a>00376 
<a name="l00377"></a>00377 <span class="comment">/* Prototypes for exported functions.  */</span>
<a name="l00378"></a>00378 <span class="comment">/* If FALSE, gdb will not use hardware support for watchpoints, even</span>
<a name="l00379"></a>00379 <span class="comment">   if such is available.  */</span>
<a name="l00380"></a>00380 <span class="keyword">static</span> <span class="keywordtype">int</span> can_use_hw_watchpoints;
<a name="l00381"></a>00381 
<a name="l00382"></a>00382 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00383"></a>00383 show_can_use_hw_watchpoints (<span class="keyword">struct</span> ui_file *file, <span class="keywordtype">int</span> from_tty,
<a name="l00384"></a>00384                              <span class="keyword">struct</span> <a class="code" href="structcmd__list__element.html">cmd_list_element</a> *c,
<a name="l00385"></a>00385                              <span class="keyword">const</span> <span class="keywordtype">char</span> *value)
<a name="l00386"></a>00386 {
<a name="l00387"></a>00387   <a class="code" href="utils_8c.html#aaa819b1a6c0b6c4090bdc0b027eaf64b">fprintf_filtered</a> (file,
<a name="l00388"></a>00388                     <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Debugger&#39;s willingness to use &quot;</span>
<a name="l00389"></a>00389                       <span class="stringliteral">&quot;watchpoint hardware is %s.\n&quot;</span>),
<a name="l00390"></a>00390                     value);
<a name="l00391"></a>00391 }
<a name="l00392"></a>00392 
<a name="l00393"></a>00393 <span class="comment">/* If AUTO_BOOLEAN_FALSE, gdb will not attempt to create pending breakpoints.</span>
<a name="l00394"></a>00394 <span class="comment">   If AUTO_BOOLEAN_TRUE, gdb will automatically create pending breakpoints</span>
<a name="l00395"></a>00395 <span class="comment">   for unrecognized breakpoint locations.</span>
<a name="l00396"></a>00396 <span class="comment">   If AUTO_BOOLEAN_AUTO, gdb will query when breakpoints are unrecognized.  */</span>
<a name="l00397"></a>00397 <span class="keyword">static</span> <span class="keyword">enum</span> <a class="code" href="defs_8h.html#a7e28c5d9363062b4fd5eec5fed14448f">auto_boolean</a> pending_break_support;
<a name="l00398"></a>00398 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00399"></a>00399 show_pending_break_support (<span class="keyword">struct</span> ui_file *file, <span class="keywordtype">int</span> from_tty,
<a name="l00400"></a>00400                             <span class="keyword">struct</span> <a class="code" href="structcmd__list__element.html">cmd_list_element</a> *c,
<a name="l00401"></a>00401                             <span class="keyword">const</span> <span class="keywordtype">char</span> *value)
<a name="l00402"></a>00402 {
<a name="l00403"></a>00403   <a class="code" href="utils_8c.html#aaa819b1a6c0b6c4090bdc0b027eaf64b">fprintf_filtered</a> (file,
<a name="l00404"></a>00404                     <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Debugger&#39;s behavior regarding &quot;</span>
<a name="l00405"></a>00405                       <span class="stringliteral">&quot;pending breakpoints is %s.\n&quot;</span>),
<a name="l00406"></a>00406                     value);
<a name="l00407"></a>00407 }
<a name="l00408"></a>00408 
<a name="l00409"></a>00409 <span class="comment">/* If 1, gdb will automatically use hardware breakpoints for breakpoints</span>
<a name="l00410"></a>00410 <span class="comment">   set with &quot;break&quot; but falling in read-only memory.</span>
<a name="l00411"></a>00411 <span class="comment">   If 0, gdb will warn about such breakpoints, but won&#39;t automatically</span>
<a name="l00412"></a>00412 <span class="comment">   use hardware breakpoints.  */</span>
<a name="l00413"></a>00413 <span class="keyword">static</span> <span class="keywordtype">int</span> automatic_hardware_breakpoints;
<a name="l00414"></a>00414 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00415"></a>00415 show_automatic_hardware_breakpoints (<span class="keyword">struct</span> ui_file *file, <span class="keywordtype">int</span> from_tty,
<a name="l00416"></a>00416                                      <span class="keyword">struct</span> <a class="code" href="structcmd__list__element.html">cmd_list_element</a> *c,
<a name="l00417"></a>00417                                      <span class="keyword">const</span> <span class="keywordtype">char</span> *value)
<a name="l00418"></a>00418 {
<a name="l00419"></a>00419   <a class="code" href="utils_8c.html#aaa819b1a6c0b6c4090bdc0b027eaf64b">fprintf_filtered</a> (file,
<a name="l00420"></a>00420                     <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Automatic usage of hardware breakpoints is %s.\n&quot;</span>),
<a name="l00421"></a>00421                     value);
<a name="l00422"></a>00422 }
<a name="l00423"></a>00423 
<a name="l00424"></a>00424 <span class="comment">/* If on, gdb will keep breakpoints inserted even as inferior is</span>
<a name="l00425"></a>00425 <span class="comment">   stopped, and immediately insert any new breakpoints.  If off, gdb</span>
<a name="l00426"></a>00426 <span class="comment">   will insert breakpoints into inferior only when resuming it, and</span>
<a name="l00427"></a>00427 <span class="comment">   will remove breakpoints upon stop.  If auto, GDB will behave as ON</span>
<a name="l00428"></a>00428 <span class="comment">   if in non-stop mode, and as OFF if all-stop mode.*/</span>
<a name="l00429"></a>00429 
<a name="l00430"></a>00430 <span class="keyword">static</span> <span class="keyword">enum</span> <a class="code" href="defs_8h.html#a7e28c5d9363062b4fd5eec5fed14448f">auto_boolean</a> always_inserted_mode = <a class="code" href="defs_8h.html#a7e28c5d9363062b4fd5eec5fed14448fa48f3bffd79907d65a7ee3aee7aabc163">AUTO_BOOLEAN_AUTO</a>;
<a name="l00431"></a>00431 
<a name="l00432"></a>00432 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00433"></a>00433 show_always_inserted_mode (<span class="keyword">struct</span> ui_file *file, <span class="keywordtype">int</span> from_tty,
<a name="l00434"></a>00434                      <span class="keyword">struct</span> <a class="code" href="structcmd__list__element.html">cmd_list_element</a> *c, <span class="keyword">const</span> <span class="keywordtype">char</span> *value)
<a name="l00435"></a>00435 {
<a name="l00436"></a>00436   <span class="keywordflow">if</span> (always_inserted_mode == <a class="code" href="defs_8h.html#a7e28c5d9363062b4fd5eec5fed14448fa48f3bffd79907d65a7ee3aee7aabc163">AUTO_BOOLEAN_AUTO</a>)
<a name="l00437"></a>00437     <a class="code" href="utils_8c.html#aaa819b1a6c0b6c4090bdc0b027eaf64b">fprintf_filtered</a> (file,
<a name="l00438"></a>00438                       <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Always inserted breakpoint &quot;</span>
<a name="l00439"></a>00439                         <span class="stringliteral">&quot;mode is %s (currently %s).\n&quot;</span>),
<a name="l00440"></a>00440                       value,
<a name="l00441"></a>00441                       <a class="code" href="breakpoint_8c.html#a95acbb90087d0c5f6bd455fa8fcdafdc">breakpoints_always_inserted_mode</a> () ? <span class="stringliteral">&quot;on&quot;</span> : <span class="stringliteral">&quot;off&quot;</span>);
<a name="l00442"></a>00442   <span class="keywordflow">else</span>
<a name="l00443"></a>00443     <a class="code" href="utils_8c.html#aaa819b1a6c0b6c4090bdc0b027eaf64b">fprintf_filtered</a> (file, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Always inserted breakpoint mode is %s.\n&quot;</span>),
<a name="l00444"></a>00444                       value);
<a name="l00445"></a>00445 }
<a name="l00446"></a>00446 
<a name="l00447"></a>00447 <span class="keywordtype">int</span>
<a name="l00448"></a><a class="code" href="breakpoint_8h.html#a95acbb90087d0c5f6bd455fa8fcdafdc">00448</a> <a class="code" href="breakpoint_8c.html#a95acbb90087d0c5f6bd455fa8fcdafdc">breakpoints_always_inserted_mode</a> (<span class="keywordtype">void</span>)
<a name="l00449"></a>00449 {
<a name="l00450"></a>00450   <span class="keywordflow">return</span> (always_inserted_mode == <a class="code" href="defs_8h.html#a7e28c5d9363062b4fd5eec5fed14448fa167e41bbf39564ded650f13ba73c3e22">AUTO_BOOLEAN_TRUE</a>
<a name="l00451"></a>00451           || (always_inserted_mode == <a class="code" href="defs_8h.html#a7e28c5d9363062b4fd5eec5fed14448fa48f3bffd79907d65a7ee3aee7aabc163">AUTO_BOOLEAN_AUTO</a> &amp;&amp; <a class="code" href="inferior_8h.html#af01b8288bc30e83805793d6908408e81">non_stop</a>));
<a name="l00452"></a>00452 }
<a name="l00453"></a>00453 
<a name="l00454"></a>00454 <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> condition_evaluation_both[] = <span class="stringliteral">&quot;host or target&quot;</span>;
<a name="l00455"></a>00455 
<a name="l00456"></a>00456 <span class="comment">/* Modes for breakpoint condition evaluation.  */</span>
<a name="l00457"></a>00457 <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> condition_evaluation_auto[] = <span class="stringliteral">&quot;auto&quot;</span>;
<a name="l00458"></a>00458 <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> condition_evaluation_host[] = <span class="stringliteral">&quot;host&quot;</span>;
<a name="l00459"></a>00459 <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> condition_evaluation_target[] = <span class="stringliteral">&quot;target&quot;</span>;
<a name="l00460"></a>00460 <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> condition_evaluation_enums[] = {
<a name="l00461"></a>00461   condition_evaluation_auto,
<a name="l00462"></a>00462   condition_evaluation_host,
<a name="l00463"></a>00463   condition_evaluation_target,
<a name="l00464"></a>00464   NULL
<a name="l00465"></a>00465 };
<a name="l00466"></a>00466 
<a name="l00467"></a>00467 <span class="comment">/* Global that holds the current mode for breakpoint condition evaluation.  */</span>
<a name="l00468"></a>00468 <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *condition_evaluation_mode_1 = condition_evaluation_auto;
<a name="l00469"></a>00469 
<a name="l00470"></a>00470 <span class="comment">/* Global that we use to display information to the user (gets its value from</span>
<a name="l00471"></a>00471 <span class="comment">   condition_evaluation_mode_1.  */</span>
<a name="l00472"></a>00472 <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *condition_evaluation_mode = condition_evaluation_auto;
<a name="l00473"></a>00473 
<a name="l00474"></a>00474 <span class="comment">/* Translate a condition evaluation mode MODE into either &quot;host&quot;</span>
<a name="l00475"></a>00475 <span class="comment">   or &quot;target&quot;.  This is used mostly to translate from &quot;auto&quot; to the</span>
<a name="l00476"></a>00476 <span class="comment">   real setting that is being used.  It returns the translated</span>
<a name="l00477"></a>00477 <span class="comment">   evaluation mode.  */</span>
<a name="l00478"></a>00478 
<a name="l00479"></a>00479 <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *
<a name="l00480"></a>00480 translate_condition_evaluation_mode (<span class="keyword">const</span> <span class="keywordtype">char</span> *mode)
<a name="l00481"></a>00481 {
<a name="l00482"></a>00482   <span class="keywordflow">if</span> (mode == condition_evaluation_auto)
<a name="l00483"></a>00483     {
<a name="l00484"></a>00484       <span class="keywordflow">if</span> (<a class="code" href="target_8h.html#a029407c9baebfcab86e0488e2d75a2a0">target_supports_evaluation_of_breakpoint_conditions</a> ())
<a name="l00485"></a>00485         <span class="keywordflow">return</span> condition_evaluation_target;
<a name="l00486"></a>00486       <span class="keywordflow">else</span>
<a name="l00487"></a>00487         <span class="keywordflow">return</span> condition_evaluation_host;
<a name="l00488"></a>00488     }
<a name="l00489"></a>00489   <span class="keywordflow">else</span>
<a name="l00490"></a>00490     <span class="keywordflow">return</span> mode;
<a name="l00491"></a>00491 }
<a name="l00492"></a>00492 
<a name="l00493"></a>00493 <span class="comment">/* Discovers what condition_evaluation_auto translates to.  */</span>
<a name="l00494"></a>00494 
<a name="l00495"></a>00495 <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *
<a name="l00496"></a>00496 breakpoint_condition_evaluation_mode (<span class="keywordtype">void</span>)
<a name="l00497"></a>00497 {
<a name="l00498"></a>00498   <span class="keywordflow">return</span> translate_condition_evaluation_mode (condition_evaluation_mode);
<a name="l00499"></a>00499 }
<a name="l00500"></a>00500 
<a name="l00501"></a>00501 <span class="comment">/* Return true if GDB should evaluate breakpoint conditions or false</span>
<a name="l00502"></a>00502 <span class="comment">   otherwise.  */</span>
<a name="l00503"></a>00503 
<a name="l00504"></a>00504 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l00505"></a>00505 gdb_evaluates_breakpoint_condition_p (<span class="keywordtype">void</span>)
<a name="l00506"></a>00506 {
<a name="l00507"></a>00507   <span class="keyword">const</span> <span class="keywordtype">char</span> *mode = breakpoint_condition_evaluation_mode ();
<a name="l00508"></a>00508 
<a name="l00509"></a>00509   <span class="keywordflow">return</span> (mode == condition_evaluation_host);
<a name="l00510"></a>00510 }
<a name="l00511"></a>00511 
<a name="l00512"></a>00512 <span class="keywordtype">void</span> <a class="code" href="init_8c.html#a4a4836c6f20eed2fd07ca4779285a7bf">_initialize_breakpoint</a> (<span class="keywordtype">void</span>);
<a name="l00513"></a>00513 
<a name="l00514"></a>00514 <span class="comment">/* Are we executing breakpoint commands?  */</span>
<a name="l00515"></a>00515 <span class="keyword">static</span> <span class="keywordtype">int</span> executing_breakpoint_commands;
<a name="l00516"></a>00516 
<a name="l00517"></a>00517 <span class="comment">/* Are overlay event breakpoints enabled? */</span>
<a name="l00518"></a>00518 <span class="keyword">static</span> <span class="keywordtype">int</span> overlay_events_enabled;
<a name="l00519"></a>00519 
<a name="l00520"></a>00520 <span class="comment">/* See description in breakpoint.h. */</span>
<a name="l00521"></a><a class="code" href="breakpoint_8h.html#a4f281b4f2d2864ddf705bfe6280a9214">00521</a> <span class="keywordtype">int</span> <a class="code" href="breakpoint_8c.html#a4f281b4f2d2864ddf705bfe6280a9214">target_exact_watchpoints</a> = 0;
<a name="l00522"></a>00522 
<a name="l00523"></a>00523 <span class="comment">/* Walk the following statement or block through all breakpoints.</span>
<a name="l00524"></a>00524 <span class="comment">   ALL_BREAKPOINTS_SAFE does so even if the statement deletes the</span>
<a name="l00525"></a>00525 <span class="comment">   current breakpoint.  */</span>
<a name="l00526"></a>00526 
<a name="l00527"></a><a class="code" href="breakpoint_8c.html#a781d5d3dc50a92364edfbacac3d0c107">00527</a> <span class="preprocessor">#define ALL_BREAKPOINTS(B)  for (B = breakpoint_chain; B; B = B-&gt;next)</span>
<a name="l00528"></a>00528 <span class="preprocessor"></span>
<a name="l00529"></a><a class="code" href="breakpoint_8c.html#ace15af58ae54149fbef6d72ecb61e12d">00529</a> <span class="preprocessor">#define ALL_BREAKPOINTS_SAFE(B,TMP)     \</span>
<a name="l00530"></a>00530 <span class="preprocessor">        for (B = breakpoint_chain;      \</span>
<a name="l00531"></a>00531 <span class="preprocessor">             B ? (TMP=B-&gt;next, 1): 0;   \</span>
<a name="l00532"></a>00532 <span class="preprocessor">             B = TMP)</span>
<a name="l00533"></a>00533 <span class="preprocessor"></span>
<a name="l00534"></a>00534 <span class="comment">/* Similar iterator for the low-level breakpoints.  SAFE variant is</span>
<a name="l00535"></a>00535 <span class="comment">   not provided so update_global_location_list must not be called</span>
<a name="l00536"></a>00536 <span class="comment">   while executing the block of ALL_BP_LOCATIONS.  */</span>
<a name="l00537"></a>00537 
<a name="l00538"></a><a class="code" href="breakpoint_8c.html#a6f97c7962df1d91150e0e8de40ff7fe4">00538</a> <span class="preprocessor">#define ALL_BP_LOCATIONS(B,BP_TMP)                                      \</span>
<a name="l00539"></a>00539 <span class="preprocessor">        for (BP_TMP = bp_location;                                      \</span>
<a name="l00540"></a>00540 <span class="preprocessor">             BP_TMP &lt; bp_location + bp_location_count &amp;&amp; (B = *BP_TMP); \</span>
<a name="l00541"></a>00541 <span class="preprocessor">             BP_TMP++)</span>
<a name="l00542"></a>00542 <span class="preprocessor"></span>
<a name="l00543"></a>00543 <span class="comment">/* Iterates through locations with address ADDRESS for the currently selected</span>
<a name="l00544"></a>00544 <span class="comment">   program space.  BP_LOCP_TMP points to each object.  BP_LOCP_START points</span>
<a name="l00545"></a>00545 <span class="comment">   to where the loop should start from.</span>
<a name="l00546"></a>00546 <span class="comment">   If BP_LOCP_START is a NULL pointer, the macro automatically seeks the</span>
<a name="l00547"></a>00547 <span class="comment">   appropriate location to start with.  */</span>
<a name="l00548"></a>00548 
<a name="l00549"></a><a class="code" href="breakpoint_8c.html#af132e38cf4dda2bca037851da14a80bd">00549</a> <span class="preprocessor">#define ALL_BP_LOCATIONS_AT_ADDR(BP_LOCP_TMP, BP_LOCP_START, ADDRESS)   \</span>
<a name="l00550"></a>00550 <span class="preprocessor">        for (BP_LOCP_START = BP_LOCP_START == NULL ? get_first_locp_gte_addr (ADDRESS) : BP_LOCP_START, \</span>
<a name="l00551"></a>00551 <span class="preprocessor">             BP_LOCP_TMP = BP_LOCP_START;                               \</span>
<a name="l00552"></a>00552 <span class="preprocessor">             BP_LOCP_START                                              \</span>
<a name="l00553"></a>00553 <span class="preprocessor">             &amp;&amp; (BP_LOCP_TMP &lt; bp_location + bp_location_count          \</span>
<a name="l00554"></a>00554 <span class="preprocessor">             &amp;&amp; (*BP_LOCP_TMP)-&gt;address == ADDRESS);                    \</span>
<a name="l00555"></a>00555 <span class="preprocessor">             BP_LOCP_TMP++)</span>
<a name="l00556"></a>00556 <span class="preprocessor"></span>
<a name="l00557"></a>00557 <span class="comment">/* Iterator for tracepoints only.  */</span>
<a name="l00558"></a>00558 
<a name="l00559"></a><a class="code" href="breakpoint_8c.html#ab5d28883ea0eb745187fab7613ec67d6">00559</a> <span class="preprocessor">#define ALL_TRACEPOINTS(B)  \</span>
<a name="l00560"></a>00560 <span class="preprocessor">  for (B = breakpoint_chain; B; B = B-&gt;next)  \</span>
<a name="l00561"></a>00561 <span class="preprocessor">    if (is_tracepoint (B))</span>
<a name="l00562"></a>00562 <span class="preprocessor"></span>
<a name="l00563"></a>00563 <span class="comment">/* Chains of all breakpoints defined.  */</span>
<a name="l00564"></a>00564 
<a name="l00565"></a><a class="code" href="gdbtk-bp_8c.html#a1c06bbc271c9a0aced429d597a65c28c">00565</a> <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *<a class="code" href="breakpoint_8c.html#a1c06bbc271c9a0aced429d597a65c28c">breakpoint_chain</a>;
<a name="l00566"></a>00566 
<a name="l00567"></a>00567 <span class="comment">/* Array is sorted by bp_location_compare - primarily by the ADDRESS.  */</span>
<a name="l00568"></a>00568 
<a name="l00569"></a>00569 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structbp__location.html">bp_location</a> **<a class="code" href="structbp__location.html">bp_location</a>;
<a name="l00570"></a>00570 
<a name="l00571"></a>00571 <span class="comment">/* Number of elements of BP_LOCATION.  */</span>
<a name="l00572"></a>00572 
<a name="l00573"></a>00573 <span class="keyword">static</span> <span class="keywordtype">unsigned</span> bp_location_count;
<a name="l00574"></a>00574 
<a name="l00575"></a>00575 <span class="comment">/* Maximum alignment offset between bp_target_info.PLACED_ADDRESS and</span>
<a name="l00576"></a>00576 <span class="comment">   ADDRESS for the current elements of BP_LOCATION which get a valid</span>
<a name="l00577"></a>00577 <span class="comment">   result from bp_location_has_shadow.  You can use it for roughly</span>
<a name="l00578"></a>00578 <span class="comment">   limiting the subrange of BP_LOCATION to scan for shadow bytes for</span>
<a name="l00579"></a>00579 <span class="comment">   an address you need to read.  */</span>
<a name="l00580"></a>00580 
<a name="l00581"></a>00581 <span class="keyword">static</span> <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> bp_location_placed_address_before_address_max;
<a name="l00582"></a>00582 
<a name="l00583"></a>00583 <span class="comment">/* Maximum offset plus alignment between bp_target_info.PLACED_ADDRESS</span>
<a name="l00584"></a>00584 <span class="comment">   + bp_target_info.SHADOW_LEN and ADDRESS for the current elements of</span>
<a name="l00585"></a>00585 <span class="comment">   BP_LOCATION which get a valid result from bp_location_has_shadow.</span>
<a name="l00586"></a>00586 <span class="comment">   You can use it for roughly limiting the subrange of BP_LOCATION to</span>
<a name="l00587"></a>00587 <span class="comment">   scan for shadow bytes for an address you need to read.  */</span>
<a name="l00588"></a>00588 
<a name="l00589"></a>00589 <span class="keyword">static</span> <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> bp_location_shadow_len_after_address_max;
<a name="l00590"></a>00590 
<a name="l00591"></a>00591 <span class="comment">/* The locations that no longer correspond to any breakpoint, unlinked</span>
<a name="l00592"></a>00592 <span class="comment">   from bp_location array, but for which a hit may still be reported</span>
<a name="l00593"></a>00593 <span class="comment">   by a target.  */</span>
<a name="l00594"></a><a class="code" href="breakpoint_8c.html#a75aa18398f8b45678e90ecc964b378d3">00594</a> <a class="code" href="vec_8h.html#ab084f6f29fcf16a6b15d15feb653d414">VEC</a>(<a class="code" href="structbp__location.html">bp_location_p</a>) *moribund_locations = NULL;
<a name="l00595"></a>00595 
<a name="l00596"></a>00596 <span class="comment">/* Number of last breakpoint made.  */</span>
<a name="l00597"></a>00597 
<a name="l00598"></a>00598 <span class="keyword">static</span> <span class="keywordtype">int</span> breakpoint_count;
<a name="l00599"></a>00599 
<a name="l00600"></a>00600 <span class="comment">/* The value of `breakpoint_count&#39; before the last command that</span>
<a name="l00601"></a>00601 <span class="comment">   created breakpoints.  If the last (break-like) command created more</span>
<a name="l00602"></a>00602 <span class="comment">   than one breakpoint, then the difference between BREAKPOINT_COUNT</span>
<a name="l00603"></a>00603 <span class="comment">   and PREV_BREAKPOINT_COUNT is more than one.  */</span>
<a name="l00604"></a>00604 <span class="keyword">static</span> <span class="keywordtype">int</span> prev_breakpoint_count;
<a name="l00605"></a>00605 
<a name="l00606"></a>00606 <span class="comment">/* Number of last tracepoint made.  */</span>
<a name="l00607"></a>00607 
<a name="l00608"></a>00608 <span class="keyword">static</span> <span class="keywordtype">int</span> tracepoint_count;
<a name="l00609"></a>00609 
<a name="l00610"></a>00610 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structcmd__list__element.html">cmd_list_element</a> *breakpoint_set_cmdlist;
<a name="l00611"></a>00611 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structcmd__list__element.html">cmd_list_element</a> *breakpoint_show_cmdlist;
<a name="l00612"></a>00612 <span class="keyword">struct </span><a class="code" href="structcmd__list__element.html">cmd_list_element</a> *<a class="code" href="gdbcmd_8h.html#aa9a6709904be4a4e00f298a5642fe94d">save_cmdlist</a>;
<a name="l00613"></a>00613 
<a name="l00614"></a>00614 <span class="comment">/* Return whether a breakpoint is an active enabled breakpoint.  */</span>
<a name="l00615"></a>00615 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l00616"></a>00616 breakpoint_enabled (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b)
<a name="l00617"></a>00617 {
<a name="l00618"></a>00618   <span class="keywordflow">return</span> (b-&gt;<a class="code" href="structbreakpoint.html#acb53352fd35aaad37054508fabc0f3bf">enable_state</a> == <a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577a72f1fa981d13a62d05324c1de974b44b">bp_enabled</a>);
<a name="l00619"></a>00619 }
<a name="l00620"></a>00620 
<a name="l00621"></a>00621 <span class="comment">/* Set breakpoint count to NUM.  */</span>
<a name="l00622"></a>00622 
<a name="l00623"></a>00623 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00624"></a>00624 set_breakpoint_count (<span class="keywordtype">int</span> num)
<a name="l00625"></a>00625 {
<a name="l00626"></a>00626   prev_breakpoint_count = breakpoint_count;
<a name="l00627"></a>00627   breakpoint_count = num;
<a name="l00628"></a>00628   <a class="code" href="value_8c.html#ac0d9f889423ba9ff189ea48da13204a3">set_internalvar_integer</a> (<a class="code" href="value_8c.html#ac96b41b37d2b8eeb44137ec148ca5c7c">lookup_internalvar</a> (<span class="stringliteral">&quot;bpnum&quot;</span>), num);
<a name="l00629"></a>00629 }
<a name="l00630"></a>00630 
<a name="l00631"></a>00631 <span class="comment">/* Used by `start_rbreak_breakpoints&#39; below, to record the current</span>
<a name="l00632"></a>00632 <span class="comment">   breakpoint count before &quot;rbreak&quot; creates any breakpoint.  */</span>
<a name="l00633"></a>00633 <span class="keyword">static</span> <span class="keywordtype">int</span> rbreak_start_breakpoint_count;
<a name="l00634"></a>00634 
<a name="l00635"></a>00635 <span class="comment">/* Called at the start an &quot;rbreak&quot; command to record the first</span>
<a name="l00636"></a>00636 <span class="comment">   breakpoint made.  */</span>
<a name="l00637"></a>00637 
<a name="l00638"></a>00638 <span class="keywordtype">void</span>
<a name="l00639"></a><a class="code" href="breakpoint_8h.html#ad76992b6f5d387b1099a10b053c5b9d3">00639</a> <a class="code" href="breakpoint_8c.html#ad76992b6f5d387b1099a10b053c5b9d3">start_rbreak_breakpoints</a> (<span class="keywordtype">void</span>)
<a name="l00640"></a>00640 {
<a name="l00641"></a>00641   rbreak_start_breakpoint_count = breakpoint_count;
<a name="l00642"></a>00642 }
<a name="l00643"></a>00643 
<a name="l00644"></a>00644 <span class="comment">/* Called at the end of an &quot;rbreak&quot; command to record the last</span>
<a name="l00645"></a>00645 <span class="comment">   breakpoint made.  */</span>
<a name="l00646"></a>00646 
<a name="l00647"></a>00647 <span class="keywordtype">void</span>
<a name="l00648"></a><a class="code" href="breakpoint_8h.html#a184f9ce5f4cf83715a87b263908d4c7b">00648</a> <a class="code" href="breakpoint_8c.html#a184f9ce5f4cf83715a87b263908d4c7b">end_rbreak_breakpoints</a> (<span class="keywordtype">void</span>)
<a name="l00649"></a>00649 {
<a name="l00650"></a>00650   prev_breakpoint_count = rbreak_start_breakpoint_count;
<a name="l00651"></a>00651 }
<a name="l00652"></a>00652 
<a name="l00653"></a>00653 <span class="comment">/* Used in run_command to zero the hit count when a new run starts.  */</span>
<a name="l00654"></a>00654 
<a name="l00655"></a>00655 <span class="keywordtype">void</span>
<a name="l00656"></a><a class="code" href="breakpoint_8h.html#abf5245820cf7eff4c0f91151a897e60a">00656</a> <a class="code" href="breakpoint_8c.html#abf5245820cf7eff4c0f91151a897e60a">clear_breakpoint_hit_counts</a> (<span class="keywordtype">void</span>)
<a name="l00657"></a>00657 {
<a name="l00658"></a>00658   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b;
<a name="l00659"></a>00659 
<a name="l00660"></a>00660   <a class="code" href="breakpoint_8c.html#a781d5d3dc50a92364edfbacac3d0c107">ALL_BREAKPOINTS</a> (b)
<a name="l00661"></a>00661     b-&gt;<a class="code" href="structbreakpoint.html#a4431b9e9db0a123962a90e8a82419494">hit_count</a> = 0;
<a name="l00662"></a>00662 }
<a name="l00663"></a>00663 
<a name="l00664"></a>00664 <span class="comment">/* Allocate a new counted_command_line with reference count of 1.</span>
<a name="l00665"></a>00665 <span class="comment">   The new structure owns COMMANDS.  */</span>
<a name="l00666"></a>00666 
<a name="l00667"></a>00667 <span class="keyword">static</span> <span class="keyword">struct </span>counted_command_line *
<a name="l00668"></a>00668 alloc_counted_command_line (<span class="keyword">struct</span> <a class="code" href="structcommand__line.html">command_line</a> *commands)
<a name="l00669"></a>00669 {
<a name="l00670"></a>00670   <span class="keyword">struct </span>counted_command_line *result
<a name="l00671"></a>00671     = <a class="code" href="common-utils_8c.html#a634d6cd850bb831afebc499579303b3b">xmalloc</a> (<span class="keyword">sizeof</span> (<span class="keyword">struct</span> counted_command_line));
<a name="l00672"></a>00672 
<a name="l00673"></a>00673   result-&gt;refc = 1;
<a name="l00674"></a>00674   result-&gt;commands = commands;
<a name="l00675"></a>00675   <span class="keywordflow">return</span> result;
<a name="l00676"></a>00676 }
<a name="l00677"></a>00677 
<a name="l00678"></a>00678 <span class="comment">/* Increment reference count.  This does nothing if CMD is NULL.  */</span>
<a name="l00679"></a>00679 
<a name="l00680"></a>00680 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00681"></a>00681 incref_counted_command_line (<span class="keyword">struct</span> counted_command_line *cmd)
<a name="l00682"></a>00682 {
<a name="l00683"></a>00683   <span class="keywordflow">if</span> (cmd)
<a name="l00684"></a>00684     ++cmd-&gt;refc;
<a name="l00685"></a>00685 }
<a name="l00686"></a>00686 
<a name="l00687"></a>00687 <span class="comment">/* Decrement reference count.  If the reference count reaches 0,</span>
<a name="l00688"></a>00688 <span class="comment">   destroy the counted_command_line.  Sets *CMDP to NULL.  This does</span>
<a name="l00689"></a>00689 <span class="comment">   nothing if *CMDP is NULL.  */</span>
<a name="l00690"></a>00690 
<a name="l00691"></a>00691 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00692"></a>00692 decref_counted_command_line (<span class="keyword">struct</span> counted_command_line **cmdp)
<a name="l00693"></a>00693 {
<a name="l00694"></a>00694   <span class="keywordflow">if</span> (*cmdp)
<a name="l00695"></a>00695     {
<a name="l00696"></a>00696       <span class="keywordflow">if</span> (--(*cmdp)-&gt;refc == 0)
<a name="l00697"></a>00697         {
<a name="l00698"></a>00698           <a class="code" href="cli-script_8c.html#aeab50f19caaa70d8c2a942fd5f10e901">free_command_lines</a> (&amp;(*cmdp)-&gt;commands);
<a name="l00699"></a>00699           <a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a> (*cmdp);
<a name="l00700"></a>00700         }
<a name="l00701"></a>00701       *cmdp = NULL;
<a name="l00702"></a>00702     }
<a name="l00703"></a>00703 }
<a name="l00704"></a>00704 
<a name="l00705"></a>00705 <span class="comment">/* A cleanup function that calls decref_counted_command_line.  */</span>
<a name="l00706"></a>00706 
<a name="l00707"></a>00707 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00708"></a>00708 do_cleanup_counted_command_line (<span class="keywordtype">void</span> *arg)
<a name="l00709"></a>00709 {
<a name="l00710"></a>00710   decref_counted_command_line (arg);
<a name="l00711"></a>00711 }
<a name="l00712"></a>00712 
<a name="l00713"></a>00713 <span class="comment">/* Create a cleanup that calls decref_counted_command_line on the</span>
<a name="l00714"></a>00714 <span class="comment">   argument.  */</span>
<a name="l00715"></a>00715 
<a name="l00716"></a>00716 <span class="keyword">static</span> <span class="keyword">struct </span>cleanup *
<a name="l00717"></a>00717 make_cleanup_decref_counted_command_line (<span class="keyword">struct</span> counted_command_line **cmdp)
<a name="l00718"></a>00718 {
<a name="l00719"></a>00719   <span class="keywordflow">return</span> <a class="code" href="cleanups_8c.html#a3d418f8af424aec399898c2d48b26224">make_cleanup</a> (do_cleanup_counted_command_line, cmdp);
<a name="l00720"></a>00720 }
<a name="l00721"></a>00721 
<a name="l00722"></a>00722 
<a name="l00723"></a>00723 <span class="comment">/* Return the breakpoint with the specified number, or NULL</span>
<a name="l00724"></a>00724 <span class="comment">   if the number does not refer to an existing breakpoint.  */</span>
<a name="l00725"></a>00725 
<a name="l00726"></a>00726 <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *
<a name="l00727"></a><a class="code" href="breakpoint_8h.html#a54558190ca590522df6f231013971af0">00727</a> <a class="code" href="breakpoint_8c.html#a54558190ca590522df6f231013971af0">get_breakpoint</a> (<span class="keywordtype">int</span> num)
<a name="l00728"></a>00728 {
<a name="l00729"></a>00729   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b;
<a name="l00730"></a>00730 
<a name="l00731"></a>00731   <a class="code" href="breakpoint_8c.html#a781d5d3dc50a92364edfbacac3d0c107">ALL_BREAKPOINTS</a> (b)
<a name="l00732"></a>00732     <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a> == num)
<a name="l00733"></a>00733       <span class="keywordflow">return</span> b;
<a name="l00734"></a>00734   
<a name="l00735"></a>00735   <span class="keywordflow">return</span> NULL;
<a name="l00736"></a>00736 }
<a name="l00737"></a>00737 
<a name="l00738"></a>00738 
<a name="l00739"></a>00739 
<a name="l00740"></a>00740 <span class="comment">/* Mark locations as &quot;conditions have changed&quot; in case the target supports</span>
<a name="l00741"></a>00741 <span class="comment">   evaluating conditions on its side.  */</span>
<a name="l00742"></a>00742 
<a name="l00743"></a>00743 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00744"></a>00744 mark_breakpoint_modified (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b)
<a name="l00745"></a>00745 {
<a name="l00746"></a>00746   <span class="keyword">struct </span>bp_location *loc;
<a name="l00747"></a>00747 
<a name="l00748"></a>00748   <span class="comment">/* This is only meaningful if the target is</span>
<a name="l00749"></a>00749 <span class="comment">     evaluating conditions and if the user has</span>
<a name="l00750"></a>00750 <span class="comment">     opted for condition evaluation on the target&#39;s</span>
<a name="l00751"></a>00751 <span class="comment">     side.  */</span>
<a name="l00752"></a>00752   <span class="keywordflow">if</span> (gdb_evaluates_breakpoint_condition_p ()
<a name="l00753"></a>00753       || !<a class="code" href="target_8h.html#a029407c9baebfcab86e0488e2d75a2a0">target_supports_evaluation_of_breakpoint_conditions</a> ())
<a name="l00754"></a>00754     <span class="keywordflow">return</span>;
<a name="l00755"></a>00755 
<a name="l00756"></a>00756   <span class="keywordflow">if</span> (!<a class="code" href="breakpoint_8c.html#a5de9005cc5b36d1d327aa9127ea64f9c">is_breakpoint</a> (b))
<a name="l00757"></a>00757     <span class="keywordflow">return</span>;
<a name="l00758"></a>00758 
<a name="l00759"></a>00759   <span class="keywordflow">for</span> (loc = b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>; loc; loc = loc-&gt;<a class="code" href="structbp__location.html#ab193cb38f87fea89105db96d94191541">next</a>)
<a name="l00760"></a>00760     loc-&gt;<a class="code" href="structbp__location.html#a98650d2e2ec957abcf79ce803484e918">condition_changed</a> = <a class="code" href="breakpoint_8h.html#aa20936ce427010a0e9ecaea42e6c3ac3ac369e1dd04e8f50ff2d6825b42a65185">condition_modified</a>;
<a name="l00761"></a>00761 }
<a name="l00762"></a>00762 
<a name="l00763"></a>00763 <span class="comment">/* Mark location as &quot;conditions have changed&quot; in case the target supports</span>
<a name="l00764"></a>00764 <span class="comment">   evaluating conditions on its side.  */</span>
<a name="l00765"></a>00765 
<a name="l00766"></a>00766 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00767"></a>00767 mark_breakpoint_location_modified (<span class="keyword">struct</span> bp_location *loc)
<a name="l00768"></a>00768 {
<a name="l00769"></a>00769   <span class="comment">/* This is only meaningful if the target is</span>
<a name="l00770"></a>00770 <span class="comment">     evaluating conditions and if the user has</span>
<a name="l00771"></a>00771 <span class="comment">     opted for condition evaluation on the target&#39;s</span>
<a name="l00772"></a>00772 <span class="comment">     side.  */</span>
<a name="l00773"></a>00773   <span class="keywordflow">if</span> (gdb_evaluates_breakpoint_condition_p ()
<a name="l00774"></a>00774       || !<a class="code" href="target_8h.html#a029407c9baebfcab86e0488e2d75a2a0">target_supports_evaluation_of_breakpoint_conditions</a> ())
<a name="l00775"></a>00775 
<a name="l00776"></a>00776     <span class="keywordflow">return</span>;
<a name="l00777"></a>00777 
<a name="l00778"></a>00778   <span class="keywordflow">if</span> (!<a class="code" href="breakpoint_8c.html#a5de9005cc5b36d1d327aa9127ea64f9c">is_breakpoint</a> (loc-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>))
<a name="l00779"></a>00779     <span class="keywordflow">return</span>;
<a name="l00780"></a>00780 
<a name="l00781"></a>00781   loc-&gt;<a class="code" href="structbp__location.html#a98650d2e2ec957abcf79ce803484e918">condition_changed</a> = <a class="code" href="breakpoint_8h.html#aa20936ce427010a0e9ecaea42e6c3ac3ac369e1dd04e8f50ff2d6825b42a65185">condition_modified</a>;
<a name="l00782"></a>00782 }
<a name="l00783"></a>00783 
<a name="l00784"></a>00784 <span class="comment">/* Sets the condition-evaluation mode using the static global</span>
<a name="l00785"></a>00785 <span class="comment">   condition_evaluation_mode.  */</span>
<a name="l00786"></a>00786 
<a name="l00787"></a>00787 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00788"></a>00788 set_condition_evaluation_mode (<span class="keywordtype">char</span> *args, <span class="keywordtype">int</span> from_tty,
<a name="l00789"></a>00789                                <span class="keyword">struct</span> <a class="code" href="structcmd__list__element.html">cmd_list_element</a> *c)
<a name="l00790"></a>00790 {
<a name="l00791"></a>00791   <span class="keyword">const</span> <span class="keywordtype">char</span> *old_mode, *new_mode;
<a name="l00792"></a>00792 
<a name="l00793"></a>00793   <span class="keywordflow">if</span> ((condition_evaluation_mode_1 == condition_evaluation_target)
<a name="l00794"></a>00794       &amp;&amp; !<a class="code" href="target_8h.html#a029407c9baebfcab86e0488e2d75a2a0">target_supports_evaluation_of_breakpoint_conditions</a> ())
<a name="l00795"></a>00795     {
<a name="l00796"></a>00796       condition_evaluation_mode_1 = condition_evaluation_mode;
<a name="l00797"></a>00797       <a class="code" href="utils_8c.html#a5fc201a4181499a6b4057a6caa15b5e2">warning</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Target does not support breakpoint condition evaluation.\n&quot;</span>
<a name="l00798"></a>00798                  <span class="stringliteral">&quot;Using host evaluation mode instead.&quot;</span>));
<a name="l00799"></a>00799       <span class="keywordflow">return</span>;
<a name="l00800"></a>00800     }
<a name="l00801"></a>00801 
<a name="l00802"></a>00802   new_mode = translate_condition_evaluation_mode (condition_evaluation_mode_1);
<a name="l00803"></a>00803   old_mode = translate_condition_evaluation_mode (condition_evaluation_mode);
<a name="l00804"></a>00804 
<a name="l00805"></a>00805   <span class="comment">/* Flip the switch.  Flip it even if OLD_MODE == NEW_MODE as one of the</span>
<a name="l00806"></a>00806 <span class="comment">     settings was &quot;auto&quot;.  */</span>
<a name="l00807"></a>00807   condition_evaluation_mode = condition_evaluation_mode_1;
<a name="l00808"></a>00808 
<a name="l00809"></a>00809   <span class="comment">/* Only update the mode if the user picked a different one.  */</span>
<a name="l00810"></a>00810   <span class="keywordflow">if</span> (new_mode != old_mode)
<a name="l00811"></a>00811     {
<a name="l00812"></a>00812       <span class="keyword">struct </span>bp_location *loc, **loc_tmp;
<a name="l00813"></a>00813       <span class="comment">/* If the user switched to a different evaluation mode, we</span>
<a name="l00814"></a>00814 <span class="comment">         need to synch the changes with the target as follows:</span>
<a name="l00815"></a>00815 <span class="comment"></span>
<a name="l00816"></a>00816 <span class="comment">         &quot;host&quot; -&gt; &quot;target&quot;: Send all (valid) conditions to the target.</span>
<a name="l00817"></a>00817 <span class="comment">         &quot;target&quot; -&gt; &quot;host&quot;: Remove all the conditions from the target.</span>
<a name="l00818"></a>00818 <span class="comment">      */</span>
<a name="l00819"></a>00819 
<a name="l00820"></a>00820       <span class="keywordflow">if</span> (new_mode == condition_evaluation_target)
<a name="l00821"></a>00821         {
<a name="l00822"></a>00822           <span class="comment">/* Mark everything modified and synch conditions with the</span>
<a name="l00823"></a>00823 <span class="comment">             target.  */</span>
<a name="l00824"></a>00824           <a class="code" href="breakpoint_8c.html#a6f97c7962df1d91150e0e8de40ff7fe4">ALL_BP_LOCATIONS</a> (loc, loc_tmp)
<a name="l00825"></a>00825             mark_breakpoint_location_modified (loc);
<a name="l00826"></a>00826         }
<a name="l00827"></a>00827       else
<a name="l00828"></a>00828         {
<a name="l00829"></a>00829           <span class="comment">/* Manually mark non-duplicate locations to synch conditions</span>
<a name="l00830"></a>00830 <span class="comment">             with the target.  We do this to remove all the conditions the</span>
<a name="l00831"></a>00831 <span class="comment">             target knows about.  */</span>
<a name="l00832"></a>00832           <a class="code" href="breakpoint_8c.html#a6f97c7962df1d91150e0e8de40ff7fe4">ALL_BP_LOCATIONS</a> (loc, loc_tmp)
<a name="l00833"></a>00833             if (<a class="code" href="breakpoint_8c.html#a5de9005cc5b36d1d327aa9127ea64f9c">is_breakpoint</a> (loc-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>) &amp;&amp; loc-&gt;<a class="code" href="structbp__location.html#acb0b475579bbe5dabeb8ed4504527105">inserted</a>)
<a name="l00834"></a>00834               loc-&gt;<a class="code" href="structbp__location.html#a5bd9bf988af6d6e3d330fca3361a6a6b">needs_update</a> = 1;
<a name="l00835"></a>00835         }
<a name="l00836"></a>00836 
<a name="l00837"></a>00837       <span class="comment">/* Do the update.  */</span>
<a name="l00838"></a>00838       update_global_location_list (1);
<a name="l00839"></a>00839     }
<a name="l00840"></a>00840 
<a name="l00841"></a>00841   return;
<a name="l00842"></a>00842 }
<a name="l00843"></a>00843 
<a name="l00844"></a>00844 <span class="comment">/* Shows the current mode of breakpoint condition evaluation.  Explicitly shows</span>
<a name="l00845"></a>00845 <span class="comment">   what &quot;auto&quot; is translating to.  */</span>
<a name="l00846"></a>00846 
<a name="l00847"></a>00847 static <span class="keywordtype">void</span>
<a name="l00848"></a>00848 show_condition_evaluation_mode (struct ui_file *file, <span class="keywordtype">int</span> from_tty,
<a name="l00849"></a>00849                                 struct <a class="code" href="structcmd__list__element.html">cmd_list_element</a> *c, <a class="code" href="p-lang_8h.html#a21296fc6f36ba2fc4d9780fdd126acb5">const</a> <span class="keywordtype">char</span> *value)
<a name="l00850"></a>00850 {
<a name="l00851"></a>00851   <span class="keywordflow">if</span> (condition_evaluation_mode == condition_evaluation_auto)
<a name="l00852"></a>00852     <a class="code" href="utils_8c.html#aaa819b1a6c0b6c4090bdc0b027eaf64b">fprintf_filtered</a> (file,
<a name="l00853"></a>00853                       <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Breakpoint condition evaluation &quot;</span>
<a name="l00854"></a>00854                         <span class="stringliteral">&quot;mode is %s (currently %s).\n&quot;</span>),
<a name="l00855"></a>00855                       value,
<a name="l00856"></a>00856                       breakpoint_condition_evaluation_mode ());
<a name="l00857"></a>00857   <span class="keywordflow">else</span>
<a name="l00858"></a>00858     <a class="code" href="utils_8c.html#aaa819b1a6c0b6c4090bdc0b027eaf64b">fprintf_filtered</a> (file, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Breakpoint condition evaluation mode is %s.\n&quot;</span>),
<a name="l00859"></a>00859                       value);
<a name="l00860"></a>00860 }
<a name="l00861"></a>00861 
<a name="l00862"></a>00862 <span class="comment">/* A comparison function for bp_location AP and BP that is used by</span>
<a name="l00863"></a>00863 <span class="comment">   bsearch.  This comparison function only cares about addresses, unlike</span>
<a name="l00864"></a>00864 <span class="comment">   the more general bp_location_compare function.  */</span>
<a name="l00865"></a>00865 
<a name="l00866"></a>00866 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l00867"></a>00867 bp_location_compare_addrs (<span class="keyword">const</span> <span class="keywordtype">void</span> *ap, <span class="keyword">const</span> <span class="keywordtype">void</span> *bp)
<a name="l00868"></a>00868 {
<a name="l00869"></a>00869   <span class="keyword">struct </span>bp_location *a = *(<span class="keywordtype">void</span> **) ap;
<a name="l00870"></a>00870   <span class="keyword">struct </span>bp_location *b = *(<span class="keywordtype">void</span> **) bp;
<a name="l00871"></a>00871 
<a name="l00872"></a>00872   <span class="keywordflow">if</span> (a-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a> == b-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>)
<a name="l00873"></a>00873     <span class="keywordflow">return</span> 0;
<a name="l00874"></a>00874   <span class="keywordflow">else</span>
<a name="l00875"></a>00875     <span class="keywordflow">return</span> ((a-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a> &gt; b-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>) - (a-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a> &lt; b-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>));
<a name="l00876"></a>00876 }
<a name="l00877"></a>00877 
<a name="l00878"></a>00878 <span class="comment">/* Helper function to skip all bp_locations with addresses</span>
<a name="l00879"></a>00879 <span class="comment">   less than ADDRESS.  It returns the first bp_location that</span>
<a name="l00880"></a>00880 <span class="comment">   is greater than or equal to ADDRESS.  If none is found, just</span>
<a name="l00881"></a>00881 <span class="comment">   return NULL.  */</span>
<a name="l00882"></a>00882 
<a name="l00883"></a>00883 <span class="keyword">static</span> <span class="keyword">struct </span>bp_location **
<a name="l00884"></a>00884 get_first_locp_gte_addr (<a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> <a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>)
<a name="l00885"></a>00885 {
<a name="l00886"></a>00886   <span class="keyword">struct </span>bp_location dummy_loc;
<a name="l00887"></a>00887   <span class="keyword">struct </span>bp_location *dummy_locp = &amp;dummy_loc;
<a name="l00888"></a>00888   <span class="keyword">struct </span>bp_location **locp_found = NULL;
<a name="l00889"></a>00889 
<a name="l00890"></a>00890   <span class="comment">/* Initialize the dummy location&#39;s address field.  */</span>
<a name="l00891"></a>00891   <a class="code" href="gdb__string_8h.html#adb03df3679ce1445e801310614624ccb">memset</a> (&amp;dummy_loc, 0, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> bp_location));
<a name="l00892"></a>00892   dummy_loc.address = <a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>;
<a name="l00893"></a>00893 
<a name="l00894"></a>00894   <span class="comment">/* Find a close match to the first location at ADDRESS.  */</span>
<a name="l00895"></a>00895   locp_found = bsearch (&amp;dummy_locp, bp_location, bp_location_count,
<a name="l00896"></a>00896                         <span class="keyword">sizeof</span> (<span class="keyword">struct</span> bp_location **),
<a name="l00897"></a>00897                         bp_location_compare_addrs);
<a name="l00898"></a>00898 
<a name="l00899"></a>00899   <span class="comment">/* Nothing was found, nothing left to do.  */</span>
<a name="l00900"></a>00900   <span class="keywordflow">if</span> (locp_found == NULL)
<a name="l00901"></a>00901     <span class="keywordflow">return</span> NULL;
<a name="l00902"></a>00902 
<a name="l00903"></a>00903   <span class="comment">/* We may have found a location that is at ADDRESS but is not the first in the</span>
<a name="l00904"></a>00904 <span class="comment">     location&#39;s list.  Go backwards (if possible) and locate the first one.  */</span>
<a name="l00905"></a>00905   <span class="keywordflow">while</span> ((locp_found - 1) &gt;= bp_location
<a name="l00906"></a>00906          &amp;&amp; (*(locp_found - 1))-&gt;address == address)
<a name="l00907"></a>00907     locp_found--;
<a name="l00908"></a>00908 
<a name="l00909"></a>00909   <span class="keywordflow">return</span> locp_found;
<a name="l00910"></a>00910 }
<a name="l00911"></a>00911 
<a name="l00912"></a>00912 <span class="keywordtype">void</span>
<a name="l00913"></a><a class="code" href="breakpoint_8h.html#adffcf1e43632816a9b049605ab609502">00913</a> <a class="code" href="breakpoint_8c.html#adffcf1e43632816a9b049605ab609502">set_breakpoint_condition</a> (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b, <span class="keywordtype">char</span> *exp,
<a name="l00914"></a>00914                           <span class="keywordtype">int</span> from_tty)
<a name="l00915"></a>00915 {
<a name="l00916"></a>00916   <a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a> (b-&gt;<a class="code" href="structbreakpoint.html#a817904eee4ded1a9e18ab46709c1245b">cond_string</a>);
<a name="l00917"></a>00917   b-&gt;<a class="code" href="structbreakpoint.html#a817904eee4ded1a9e18ab46709c1245b">cond_string</a> = NULL;
<a name="l00918"></a>00918 
<a name="l00919"></a>00919   <span class="keywordflow">if</span> (<a class="code" href="breakpoint_8c.html#a49f0d5ff628dd506db5b81f660eb4610">is_watchpoint</a> (b))
<a name="l00920"></a>00920     {
<a name="l00921"></a>00921       <span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *w = (<span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *) b;
<a name="l00922"></a>00922 
<a name="l00923"></a>00923       <a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a> (w-&gt;<a class="code" href="structwatchpoint.html#af56cdd0c2d7782c70177feb9b0d9e676">cond_exp</a>);
<a name="l00924"></a>00924       w-&gt;<a class="code" href="structwatchpoint.html#af56cdd0c2d7782c70177feb9b0d9e676">cond_exp</a> = NULL;
<a name="l00925"></a>00925     }
<a name="l00926"></a>00926   <span class="keywordflow">else</span>
<a name="l00927"></a>00927     {
<a name="l00928"></a>00928       <span class="keyword">struct </span>bp_location *loc;
<a name="l00929"></a>00929 
<a name="l00930"></a>00930       <span class="keywordflow">for</span> (loc = b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>; loc; loc = loc-&gt;<a class="code" href="structbp__location.html#ab193cb38f87fea89105db96d94191541">next</a>)
<a name="l00931"></a>00931         {
<a name="l00932"></a>00932           <a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a> (loc-&gt;<a class="code" href="structbp__location.html#a1594433a0c3734e79b98d8296984ec7a">cond</a>);
<a name="l00933"></a>00933           loc-&gt;<a class="code" href="structbp__location.html#a1594433a0c3734e79b98d8296984ec7a">cond</a> = NULL;
<a name="l00934"></a>00934 
<a name="l00935"></a>00935           <span class="comment">/* No need to free the condition agent expression</span>
<a name="l00936"></a>00936 <span class="comment">             bytecode (if we have one).  We will handle this</span>
<a name="l00937"></a>00937 <span class="comment">             when we go through update_global_location_list.  */</span>
<a name="l00938"></a>00938         }
<a name="l00939"></a>00939     }
<a name="l00940"></a>00940 
<a name="l00941"></a>00941   <span class="keywordflow">if</span> (*exp == 0)
<a name="l00942"></a>00942     {
<a name="l00943"></a>00943       <span class="keywordflow">if</span> (from_tty)
<a name="l00944"></a>00944         <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Breakpoint %d now unconditional.\n&quot;</span>), b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>);
<a name="l00945"></a>00945     }
<a name="l00946"></a>00946   <span class="keywordflow">else</span>
<a name="l00947"></a>00947     {
<a name="l00948"></a>00948       <span class="keyword">const</span> <span class="keywordtype">char</span> *arg = exp;
<a name="l00949"></a>00949 
<a name="l00950"></a>00950       <span class="comment">/* I don&#39;t know if it matters whether this is the string the user</span>
<a name="l00951"></a>00951 <span class="comment">         typed in or the decompiled expression.  */</span>
<a name="l00952"></a>00952       b-&gt;<a class="code" href="structbreakpoint.html#a817904eee4ded1a9e18ab46709c1245b">cond_string</a> = xstrdup (arg);
<a name="l00953"></a>00953       b-&gt;<a class="code" href="structbreakpoint.html#a565b2fa013dcbed6f07157c73c978577">condition_not_parsed</a> = 0;
<a name="l00954"></a>00954 
<a name="l00955"></a>00955       <span class="keywordflow">if</span> (<a class="code" href="breakpoint_8c.html#a49f0d5ff628dd506db5b81f660eb4610">is_watchpoint</a> (b))
<a name="l00956"></a>00956         {
<a name="l00957"></a>00957           <span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *w = (<span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *) b;
<a name="l00958"></a>00958 
<a name="l00959"></a>00959           <a class="code" href="expression_8h.html#a6b2028f35010cd9648aa5d5e8f7d653d">innermost_block</a> = NULL;
<a name="l00960"></a>00960           arg = <a class="code" href="structwatchpoint.html#a10a51823c12ea43c95d767fb3a65d982">exp</a>;
<a name="l00961"></a>00961           w-&gt;<a class="code" href="structwatchpoint.html#af56cdd0c2d7782c70177feb9b0d9e676">cond_exp</a> = <a class="code" href="expression_8h.html#abdad295cc4b5351f6e6ec024ab665475">parse_exp_1</a> (&amp;arg, 0, 0, 0);
<a name="l00962"></a>00962           <span class="keywordflow">if</span> (*arg)
<a name="l00963"></a>00963             <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Junk at end of expression&quot;</span>));
<a name="l00964"></a>00964           w-&gt;<a class="code" href="structwatchpoint.html#a8efc24adb7be3137ae593d26cb22436f">cond_exp_valid_block</a> = <a class="code" href="expression_8h.html#a6b2028f35010cd9648aa5d5e8f7d653d">innermost_block</a>;
<a name="l00965"></a>00965         }
<a name="l00966"></a>00966       <span class="keywordflow">else</span>
<a name="l00967"></a>00967         {
<a name="l00968"></a>00968           <span class="keyword">struct </span>bp_location *loc;
<a name="l00969"></a>00969 
<a name="l00970"></a>00970           <span class="keywordflow">for</span> (loc = b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>; loc; loc = loc-&gt;<a class="code" href="structbp__location.html#ab193cb38f87fea89105db96d94191541">next</a>)
<a name="l00971"></a>00971             {
<a name="l00972"></a>00972               arg = exp;
<a name="l00973"></a>00973               loc-&gt;<a class="code" href="structbp__location.html#a1594433a0c3734e79b98d8296984ec7a">cond</a> =
<a name="l00974"></a>00974                 <a class="code" href="expression_8h.html#abdad295cc4b5351f6e6ec024ab665475">parse_exp_1</a> (&amp;arg, loc-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>,
<a name="l00975"></a>00975                              <a class="code" href="block_8c.html#a35aadf82f92cb4a47ec068dba0e1b36c">block_for_pc</a> (loc-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>), 0);
<a name="l00976"></a>00976               <span class="keywordflow">if</span> (*arg)
<a name="l00977"></a>00977                 <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Junk at end of expression&quot;</span>));
<a name="l00978"></a>00978             }
<a name="l00979"></a>00979         }
<a name="l00980"></a>00980     }
<a name="l00981"></a>00981   mark_breakpoint_modified (b);
<a name="l00982"></a>00982 
<a name="l00983"></a>00983   <a class="code" href="observer_8h.html#a3edacfe44ac49f71646caded92072cad">observer_notify_breakpoint_modified</a> (b);
<a name="l00984"></a>00984 }
<a name="l00985"></a>00985 
<a name="l00986"></a>00986 <span class="comment">/* Completion for the &quot;condition&quot; command.  */</span>
<a name="l00987"></a>00987 
<a name="l00988"></a>00988 <span class="keyword">static</span> <a class="code" href="vec_8h.html#ab084f6f29fcf16a6b15d15feb653d414">VEC</a> (<a class="code" href="gdb__vecs_8h.html#a5ea7d3fefa2144d9bddaf2053c9691a1">char_ptr</a>) *
<a name="l00989"></a>00989 condition_completer (<span class="keyword">struct</span> <a class="code" href="structcmd__list__element.html">cmd_list_element</a> *cmd,
<a name="l00990"></a>00990                      <span class="keyword">const</span> <span class="keywordtype">char</span> *text, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="symtab_8h.html#adc1f34651f7bbfa3ba5af27db5f53817">word</a>)
<a name="l00991"></a>00991 {
<a name="l00992"></a>00992   <span class="keyword">const</span> <span class="keywordtype">char</span> *space;
<a name="l00993"></a>00993 
<a name="l00994"></a>00994   text = <a class="code" href="cli-utils_8c.html#aad7df612354d99c740a7ea12eccd3848">skip_spaces_const</a> (text);
<a name="l00995"></a>00995   space = <a class="code" href="cli-utils_8c.html#a698bb5c8505ebecdcca9a193c18b7c8a">skip_to_space_const</a> (text);
<a name="l00996"></a>00996   <span class="keywordflow">if</span> (*space == <span class="charliteral">&#39;\0&#39;</span>)
<a name="l00997"></a>00997     {
<a name="l00998"></a>00998       <span class="keywordtype">int</span> <a class="code" href="exec_8h.html#a00f945351279d3c8935f13d2b9f9b808">len</a>;
<a name="l00999"></a>00999       <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b;
<a name="l01000"></a>01000       <a class="code" href="vec_8h.html#ab084f6f29fcf16a6b15d15feb653d414">VEC</a> (<a class="code" href="gdb__vecs_8h.html#a5ea7d3fefa2144d9bddaf2053c9691a1">char_ptr</a>) *result = NULL;
<a name="l01001"></a>01001 
<a name="l01002"></a>01002       <span class="keywordflow">if</span> (text[0] == <span class="charliteral">&#39;$&#39;</span>)
<a name="l01003"></a>01003         {
<a name="l01004"></a>01004           <span class="comment">/* We don&#39;t support completion of history indices.  */</span>
<a name="l01005"></a>01005           <span class="keywordflow">if</span> (isdigit (text[1]))
<a name="l01006"></a>01006             <span class="keywordflow">return</span> NULL;
<a name="l01007"></a>01007           <span class="keywordflow">return</span> complete_internalvar (&amp;text[1]);
<a name="l01008"></a>01008         }
<a name="l01009"></a>01009 
<a name="l01010"></a>01010       <span class="comment">/* We&#39;re completing the breakpoint number.  */</span>
<a name="l01011"></a>01011       len = strlen (text);
<a name="l01012"></a>01012 
<a name="l01013"></a>01013       <a class="code" href="breakpoint_8c.html#a781d5d3dc50a92364edfbacac3d0c107">ALL_BREAKPOINTS</a> (b)
<a name="l01014"></a>01014         {
<a name="l01015"></a>01015           <span class="keywordtype">char</span> <a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>[50];
<a name="l01016"></a>01016 
<a name="l01017"></a>01017           <a class="code" href="common-utils_8c.html#ad9940337ec98983dae9951c947879fc8">xsnprintf</a> (number, <span class="keyword">sizeof</span> (number), <span class="stringliteral">&quot;%d&quot;</span>, b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>);
<a name="l01018"></a>01018 
<a name="l01019"></a>01019           <span class="keywordflow">if</span> (strncmp (number, text, len) == 0)
<a name="l01020"></a>01020             <a class="code" href="vec_8h.html#a8d090c0524726d00931070e0c438ba3f">VEC_safe_push</a> (<a class="code" href="gdb__vecs_8h.html#a5ea7d3fefa2144d9bddaf2053c9691a1">char_ptr</a>, result, xstrdup (number));
<a name="l01021"></a>01021         }
<a name="l01022"></a>01022 
<a name="l01023"></a>01023       <span class="keywordflow">return</span> result;
<a name="l01024"></a>01024     }
<a name="l01025"></a>01025 
<a name="l01026"></a>01026   <span class="comment">/* We&#39;re completing the expression part.  */</span>
<a name="l01027"></a>01027   text = <a class="code" href="cli-utils_8c.html#aad7df612354d99c740a7ea12eccd3848">skip_spaces_const</a> (space);
<a name="l01028"></a>01028   <span class="keywordflow">return</span> expression_completer (cmd, text, word);
<a name="l01029"></a>01029 }
<a name="l01030"></a>01030 
<a name="l01031"></a>01031 <span class="comment">/* condition N EXP -- set break condition of breakpoint N to EXP.  */</span>
<a name="l01032"></a>01032 
<a name="l01033"></a>01033 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01034"></a>01034 condition_command (<span class="keywordtype">char</span> *arg, <span class="keywordtype">int</span> from_tty)
<a name="l01035"></a>01035 {
<a name="l01036"></a>01036   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b;
<a name="l01037"></a>01037   <span class="keywordtype">char</span> *<a class="code" href="windows-nat_8c.html#ade66e4ccafbc33b117610bbc0d85feb0">p</a>;
<a name="l01038"></a>01038   <span class="keywordtype">int</span> bnum;
<a name="l01039"></a>01039 
<a name="l01040"></a>01040   <span class="keywordflow">if</span> (arg == 0)
<a name="l01041"></a>01041     <a class="code" href="cli-cmds_8c.html#a68aef78cdf72abc9df2495a4618842c3">error_no_arg</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;breakpoint number&quot;</span>));
<a name="l01042"></a>01042 
<a name="l01043"></a>01043   p = arg;
<a name="l01044"></a>01044   bnum = <a class="code" href="cli-utils_8c.html#a90dc5fbdc073138a035cd142f0739e8b">get_number</a> (&amp;p);
<a name="l01045"></a>01045   <span class="keywordflow">if</span> (bnum == 0)
<a name="l01046"></a>01046     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Bad breakpoint argument: &#39;%s&#39;&quot;</span>), arg);
<a name="l01047"></a>01047 
<a name="l01048"></a>01048   <a class="code" href="breakpoint_8c.html#a781d5d3dc50a92364edfbacac3d0c107">ALL_BREAKPOINTS</a> (b)
<a name="l01049"></a>01049     if (b-&gt;number == bnum)
<a name="l01050"></a>01050       {
<a name="l01051"></a>01051         <span class="comment">/* Check if this breakpoint has a Python object assigned to</span>
<a name="l01052"></a>01052 <span class="comment">           it, and if it has a definition of the &quot;stop&quot;</span>
<a name="l01053"></a>01053 <span class="comment">           method.  This method and conditions entered into GDB from</span>
<a name="l01054"></a>01054 <span class="comment">           the CLI are mutually exclusive.  */</span>
<a name="l01055"></a>01055         <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#aa0bcabd2a66e44f812a927b9ce574a13">py_bp_object</a>
<a name="l01056"></a>01056             &amp;&amp; <a class="code" href="py-breakpoint_8c.html#a60523da0e03dae4754b6252271fe628e">gdbpy_breakpoint_has_py_cond</a> (b-&gt;<a class="code" href="structbreakpoint.html#aa0bcabd2a66e44f812a927b9ce574a13">py_bp_object</a>))
<a name="l01057"></a>01057           <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Cannot set a condition where a Python &#39;stop&#39; &quot;</span>
<a name="l01058"></a>01058                    <span class="stringliteral">&quot;method has been defined in the breakpoint.&quot;</span>));
<a name="l01059"></a>01059         <a class="code" href="breakpoint_8c.html#adffcf1e43632816a9b049605ab609502">set_breakpoint_condition</a> (b, p, from_tty);
<a name="l01060"></a>01060 
<a name="l01061"></a>01061         <span class="keywordflow">if</span> (<a class="code" href="breakpoint_8c.html#a5de9005cc5b36d1d327aa9127ea64f9c">is_breakpoint</a> (b))
<a name="l01062"></a>01062           update_global_location_list (1);
<a name="l01063"></a>01063 
<a name="l01064"></a>01064         <span class="keywordflow">return</span>;
<a name="l01065"></a>01065       }
<a name="l01066"></a>01066 
<a name="l01067"></a>01067   <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;No breakpoint number %d.&quot;</span>), bnum);
<a name="l01068"></a>01068 }
<a name="l01069"></a>01069 
<a name="l01070"></a>01070 <span class="comment">/* Check that COMMAND do not contain commands that are suitable</span>
<a name="l01071"></a>01071 <span class="comment">   only for tracepoints and not suitable for ordinary breakpoints.</span>
<a name="l01072"></a>01072 <span class="comment">   Throw if any such commands is found.  */</span>
<a name="l01073"></a>01073 
<a name="l01074"></a>01074 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01075"></a>01075 check_no_tracepoint_commands (<span class="keyword">struct</span> <a class="code" href="structcommand__line.html">command_line</a> *commands)
<a name="l01076"></a>01076 {
<a name="l01077"></a>01077   <span class="keyword">struct </span><a class="code" href="structcommand__line.html">command_line</a> *c;
<a name="l01078"></a>01078 
<a name="l01079"></a>01079   <span class="keywordflow">for</span> (c = commands; c; c = c-&gt;<a class="code" href="structcommand__line.html#aa3aea4183824359fc95edf1bf4e5291c">next</a>)
<a name="l01080"></a>01080     {
<a name="l01081"></a>01081       <span class="keywordtype">int</span> i;
<a name="l01082"></a>01082 
<a name="l01083"></a>01083       <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcommand__line.html#ab4945ad7bd82e7ece55e463c3a52155f">control_type</a> == <a class="code" href="defs_8h.html#acd2d66ca4b77ba7ac2fbfc6149bf1cdda36f7c51204f96e685736200246761503">while_stepping_control</a>)
<a name="l01084"></a>01084         <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;The &#39;while-stepping&#39; command can &quot;</span>
<a name="l01085"></a>01085                  <span class="stringliteral">&quot;only be used for tracepoints&quot;</span>));
<a name="l01086"></a>01086 
<a name="l01087"></a>01087       <span class="keywordflow">for</span> (i = 0; i &lt; c-&gt;<a class="code" href="structcommand__line.html#aeb5463cf08c771552fb0a9b579edd592">body_count</a>; ++i)
<a name="l01088"></a>01088         check_no_tracepoint_commands ((c-&gt;<a class="code" href="structcommand__line.html#ab44cb6b34417ec8a326a4ed5b3316e20">body_list</a>)[i]);
<a name="l01089"></a>01089 
<a name="l01090"></a>01090       <span class="comment">/* Not that command parsing removes leading whitespace and comment</span>
<a name="l01091"></a>01091 <span class="comment">         lines and also empty lines.  So, we only need to check for</span>
<a name="l01092"></a>01092 <span class="comment">         command directly.  */</span>
<a name="l01093"></a>01093       <span class="keywordflow">if</span> (<a class="code" href="gdb__string_8h.html#a55c8e1e0e5f3578988a2feb0d417ad1c">strstr</a> (c-&gt;<a class="code" href="structcommand__line.html#ac3bdd932f280976d7751ee96783a2c71">line</a>, <span class="stringliteral">&quot;collect &quot;</span>) == c-&gt;<a class="code" href="structcommand__line.html#ac3bdd932f280976d7751ee96783a2c71">line</a>)
<a name="l01094"></a>01094         <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;The &#39;collect&#39; command can only be used for tracepoints&quot;</span>));
<a name="l01095"></a>01095 
<a name="l01096"></a>01096       <span class="keywordflow">if</span> (<a class="code" href="gdb__string_8h.html#a55c8e1e0e5f3578988a2feb0d417ad1c">strstr</a> (c-&gt;<a class="code" href="structcommand__line.html#ac3bdd932f280976d7751ee96783a2c71">line</a>, <span class="stringliteral">&quot;teval &quot;</span>) == c-&gt;<a class="code" href="structcommand__line.html#ac3bdd932f280976d7751ee96783a2c71">line</a>)
<a name="l01097"></a>01097         <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;The &#39;teval&#39; command can only be used for tracepoints&quot;</span>));
<a name="l01098"></a>01098     }
<a name="l01099"></a>01099 }
<a name="l01100"></a>01100 
<a name="l01101"></a>01101 <span class="comment">/* Encapsulate tests for different types of tracepoints.  */</span>
<a name="l01102"></a>01102 
<a name="l01103"></a>01103 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l01104"></a>01104 is_tracepoint_type (<span class="keyword">enum</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cf">bptype</a> <a class="code" href="structtype.html">type</a>)
<a name="l01105"></a>01105 {
<a name="l01106"></a>01106   <span class="keywordflow">return</span> (type == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfae87f3c5422e7ecec815f5cb7254b4b4c">bp_tracepoint</a>
<a name="l01107"></a>01107           || type == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa563d27bd02a1303a86081828b40002db">bp_fast_tracepoint</a>
<a name="l01108"></a>01108           || type == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfae4357544e8e764b68ef3729aa9ac2be3">bp_static_tracepoint</a>);
<a name="l01109"></a>01109 }
<a name="l01110"></a>01110 
<a name="l01111"></a>01111 <span class="keywordtype">int</span>
<a name="l01112"></a><a class="code" href="breakpoint_8h.html#ac537492fb781218601862c78225bd118">01112</a> <a class="code" href="breakpoint_8c.html#ac537492fb781218601862c78225bd118">is_tracepoint</a> (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b)
<a name="l01113"></a>01113 {
<a name="l01114"></a>01114   <span class="keywordflow">return</span> is_tracepoint_type (b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a>);
<a name="l01115"></a>01115 }
<a name="l01116"></a>01116 
<a name="l01117"></a>01117 <span class="comment">/* A helper function that validates that COMMANDS are valid for a</span>
<a name="l01118"></a>01118 <span class="comment">   breakpoint.  This function will throw an exception if a problem is</span>
<a name="l01119"></a>01119 <span class="comment">   found.  */</span>
<a name="l01120"></a>01120 
<a name="l01121"></a>01121 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01122"></a>01122 validate_commands_for_breakpoint (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b,
<a name="l01123"></a>01123                                   <span class="keyword">struct</span> <a class="code" href="structcommand__line.html">command_line</a> *commands)
<a name="l01124"></a>01124 {
<a name="l01125"></a>01125   <span class="keywordflow">if</span> (<a class="code" href="breakpoint_8c.html#ac537492fb781218601862c78225bd118">is_tracepoint</a> (b))
<a name="l01126"></a>01126     {
<a name="l01127"></a>01127       <span class="keyword">struct </span><a class="code" href="structtracepoint.html">tracepoint</a> *t = (<span class="keyword">struct </span><a class="code" href="structtracepoint.html">tracepoint</a> *) b;
<a name="l01128"></a>01128       <span class="keyword">struct </span><a class="code" href="structcommand__line.html">command_line</a> *c;
<a name="l01129"></a>01129       <span class="keyword">struct </span><a class="code" href="structcommand__line.html">command_line</a> *while_stepping = 0;
<a name="l01130"></a>01130 
<a name="l01131"></a>01131       <span class="comment">/* Reset the while-stepping step count.  The previous commands</span>
<a name="l01132"></a>01132 <span class="comment">         might have included a while-stepping action, while the new</span>
<a name="l01133"></a>01133 <span class="comment">         ones might not.  */</span>
<a name="l01134"></a>01134       t-&gt;<a class="code" href="structtracepoint.html#a23f952627bff1b293662478997684f30">step_count</a> = 0;
<a name="l01135"></a>01135 
<a name="l01136"></a>01136       <span class="comment">/* We need to verify that each top-level element of commands is</span>
<a name="l01137"></a>01137 <span class="comment">         valid for tracepoints, that there&#39;s at most one</span>
<a name="l01138"></a>01138 <span class="comment">         while-stepping element, and that the while-stepping&#39;s body</span>
<a name="l01139"></a>01139 <span class="comment">         has valid tracing commands excluding nested while-stepping.</span>
<a name="l01140"></a>01140 <span class="comment">         We also need to validate the tracepoint action line in the</span>
<a name="l01141"></a>01141 <span class="comment">         context of the tracepoint --- validate_actionline actually</span>
<a name="l01142"></a>01142 <span class="comment">         has side effects, like setting the tracepoint&#39;s</span>
<a name="l01143"></a>01143 <span class="comment">         while-stepping STEP_COUNT, in addition to checking if the</span>
<a name="l01144"></a>01144 <span class="comment">         collect/teval actions parse and make sense in the</span>
<a name="l01145"></a>01145 <span class="comment">         tracepoint&#39;s context.  */</span>
<a name="l01146"></a>01146       <span class="keywordflow">for</span> (c = commands; c; c = c-&gt;<a class="code" href="structcommand__line.html#aa3aea4183824359fc95edf1bf4e5291c">next</a>)
<a name="l01147"></a>01147         {
<a name="l01148"></a>01148           <span class="keywordflow">if</span> (c-&gt;<a class="code" href="structcommand__line.html#ab4945ad7bd82e7ece55e463c3a52155f">control_type</a> == <a class="code" href="defs_8h.html#acd2d66ca4b77ba7ac2fbfc6149bf1cdda36f7c51204f96e685736200246761503">while_stepping_control</a>)
<a name="l01149"></a>01149             {
<a name="l01150"></a>01150               <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa563d27bd02a1303a86081828b40002db">bp_fast_tracepoint</a>)
<a name="l01151"></a>01151                 <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;The &#39;while-stepping&#39; command &quot;</span>
<a name="l01152"></a>01152                          <span class="stringliteral">&quot;cannot be used for fast tracepoint&quot;</span>));
<a name="l01153"></a>01153               <span class="keywordflow">else</span> <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfae4357544e8e764b68ef3729aa9ac2be3">bp_static_tracepoint</a>)
<a name="l01154"></a>01154                 <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;The &#39;while-stepping&#39; command &quot;</span>
<a name="l01155"></a>01155                          <span class="stringliteral">&quot;cannot be used for static tracepoint&quot;</span>));
<a name="l01156"></a>01156 
<a name="l01157"></a>01157               <span class="keywordflow">if</span> (while_stepping)
<a name="l01158"></a>01158                 <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;The &#39;while-stepping&#39; command &quot;</span>
<a name="l01159"></a>01159                          <span class="stringliteral">&quot;can be used only once&quot;</span>));
<a name="l01160"></a>01160               <span class="keywordflow">else</span>
<a name="l01161"></a>01161                 while_stepping = c;
<a name="l01162"></a>01162             }
<a name="l01163"></a>01163 
<a name="l01164"></a>01164           <a class="code" href="tracepoint_8c.html#ae9b04bda0e4d8d4de77644aa0da39154">validate_actionline</a> (c-&gt;<a class="code" href="structcommand__line.html#ac3bdd932f280976d7751ee96783a2c71">line</a>, b);
<a name="l01165"></a>01165         }
<a name="l01166"></a>01166       <span class="keywordflow">if</span> (while_stepping)
<a name="l01167"></a>01167         {
<a name="l01168"></a>01168           <span class="keyword">struct </span><a class="code" href="structcommand__line.html">command_line</a> *c2;
<a name="l01169"></a>01169 
<a name="l01170"></a>01170           <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (while_stepping-&gt;<a class="code" href="structcommand__line.html#aeb5463cf08c771552fb0a9b579edd592">body_count</a> == 1);
<a name="l01171"></a>01171           c2 = while_stepping-&gt;<a class="code" href="structcommand__line.html#ab44cb6b34417ec8a326a4ed5b3316e20">body_list</a>[0];
<a name="l01172"></a>01172           <span class="keywordflow">for</span> (; c2; c2 = c2-&gt;<a class="code" href="structcommand__line.html#aa3aea4183824359fc95edf1bf4e5291c">next</a>)
<a name="l01173"></a>01173             {
<a name="l01174"></a>01174               <span class="keywordflow">if</span> (c2-&gt;<a class="code" href="structcommand__line.html#ab4945ad7bd82e7ece55e463c3a52155f">control_type</a> == <a class="code" href="defs_8h.html#acd2d66ca4b77ba7ac2fbfc6149bf1cdda36f7c51204f96e685736200246761503">while_stepping_control</a>)
<a name="l01175"></a>01175                 <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;The &#39;while-stepping&#39; command cannot be nested&quot;</span>));
<a name="l01176"></a>01176             }
<a name="l01177"></a>01177         }
<a name="l01178"></a>01178     }
<a name="l01179"></a>01179   <span class="keywordflow">else</span>
<a name="l01180"></a>01180     {
<a name="l01181"></a>01181       check_no_tracepoint_commands (commands);
<a name="l01182"></a>01182     }
<a name="l01183"></a>01183 }
<a name="l01184"></a>01184 
<a name="l01185"></a>01185 <span class="comment">/* Return a vector of all the static tracepoints set at ADDR.  The</span>
<a name="l01186"></a>01186 <span class="comment">   caller is responsible for releasing the vector.  */</span>
<a name="l01187"></a>01187 
<a name="l01188"></a><a class="code" href="breakpoint_8h.html#a9e2a022270b0e9165163da5cd5433638">01188</a> <a class="code" href="vec_8h.html#ab084f6f29fcf16a6b15d15feb653d414">VEC</a>(<a class="code" href="structbreakpoint.html">breakpoint_p</a>) *
<a name="l01189"></a>01189 static_tracepoints_here (<a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> addr)
<a name="l01190"></a>01190 {
<a name="l01191"></a>01191   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b;
<a name="l01192"></a>01192   <a class="code" href="vec_8h.html#ab084f6f29fcf16a6b15d15feb653d414">VEC</a>(<a class="code" href="structbreakpoint.html">breakpoint_p</a>) *found = 0;
<a name="l01193"></a>01193   <span class="keyword">struct </span>bp_location *loc;
<a name="l01194"></a>01194 
<a name="l01195"></a>01195   <a class="code" href="breakpoint_8c.html#a781d5d3dc50a92364edfbacac3d0c107">ALL_BREAKPOINTS</a> (b)
<a name="l01196"></a>01196     <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfae4357544e8e764b68ef3729aa9ac2be3">bp_static_tracepoint</a>)
<a name="l01197"></a>01197       {
<a name="l01198"></a>01198         <span class="keywordflow">for</span> (loc = b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>; loc; loc = loc-&gt;<a class="code" href="structbp__location.html#ab193cb38f87fea89105db96d94191541">next</a>)
<a name="l01199"></a>01199           <span class="keywordflow">if</span> (loc-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a> == addr)
<a name="l01200"></a>01200             <a class="code" href="vec_8h.html#a8d090c0524726d00931070e0c438ba3f">VEC_safe_push</a>(<a class="code" href="structbreakpoint.html">breakpoint_p</a>, found, b);
<a name="l01201"></a>01201       }
<a name="l01202"></a>01202 
<a name="l01203"></a>01203   <span class="keywordflow">return</span> found;
<a name="l01204"></a>01204 }
<a name="l01205"></a>01205 
<a name="l01206"></a>01206 <span class="comment">/* Set the command list of B to COMMANDS.  If breakpoint is tracepoint,</span>
<a name="l01207"></a>01207 <span class="comment">   validate that only allowed commands are included.  */</span>
<a name="l01208"></a>01208 
<a name="l01209"></a>01209 <span class="keywordtype">void</span>
<a name="l01210"></a><a class="code" href="breakpoint_8h.html#af44da744b723fb36892418db535ed855">01210</a> <a class="code" href="breakpoint_8c.html#af44da744b723fb36892418db535ed855">breakpoint_set_commands</a> (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b, 
<a name="l01211"></a>01211                          <span class="keyword">struct</span> <a class="code" href="structcommand__line.html">command_line</a> *commands)
<a name="l01212"></a>01212 {
<a name="l01213"></a>01213   validate_commands_for_breakpoint (b, commands);
<a name="l01214"></a>01214 
<a name="l01215"></a>01215   decref_counted_command_line (&amp;b-&gt;<a class="code" href="structbreakpoint.html#a054780dffadb1a4af0fc35037834fe4b">commands</a>);
<a name="l01216"></a>01216   b-&gt;<a class="code" href="structbreakpoint.html#a054780dffadb1a4af0fc35037834fe4b">commands</a> = alloc_counted_command_line (commands);
<a name="l01217"></a>01217   <a class="code" href="observer_8h.html#a3edacfe44ac49f71646caded92072cad">observer_notify_breakpoint_modified</a> (b);
<a name="l01218"></a>01218 }
<a name="l01219"></a>01219 
<a name="l01220"></a>01220 <span class="comment">/* Set the internal `silent&#39; flag on the breakpoint.  Note that this</span>
<a name="l01221"></a>01221 <span class="comment">   is not the same as the &quot;silent&quot; that may appear in the breakpoint&#39;s</span>
<a name="l01222"></a>01222 <span class="comment">   commands.  */</span>
<a name="l01223"></a>01223 
<a name="l01224"></a>01224 <span class="keywordtype">void</span>
<a name="l01225"></a><a class="code" href="breakpoint_8h.html#a71ab1242cb12bacb692f67fe48a774ce">01225</a> <a class="code" href="breakpoint_8c.html#a71ab1242cb12bacb692f67fe48a774ce">breakpoint_set_silent</a> (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b, <span class="keywordtype">int</span> silent)
<a name="l01226"></a>01226 {
<a name="l01227"></a>01227   <span class="keywordtype">int</span> old_silent = b-&gt;<a class="code" href="structbreakpoint.html#a7f6e5535a40a44f8f686da006afdf7b0">silent</a>;
<a name="l01228"></a>01228 
<a name="l01229"></a>01229   b-&gt;<a class="code" href="structbreakpoint.html#a7f6e5535a40a44f8f686da006afdf7b0">silent</a> = silent;
<a name="l01230"></a>01230   <span class="keywordflow">if</span> (old_silent != silent)
<a name="l01231"></a>01231     <a class="code" href="observer_8h.html#a3edacfe44ac49f71646caded92072cad">observer_notify_breakpoint_modified</a> (b);
<a name="l01232"></a>01232 }
<a name="l01233"></a>01233 
<a name="l01234"></a>01234 <span class="comment">/* Set the thread for this breakpoint.  If THREAD is -1, make the</span>
<a name="l01235"></a>01235 <span class="comment">   breakpoint work for any thread.  */</span>
<a name="l01236"></a>01236 
<a name="l01237"></a>01237 <span class="keywordtype">void</span>
<a name="l01238"></a><a class="code" href="breakpoint_8h.html#a1a9c231f42607451d75f04f6f3e3096d">01238</a> <a class="code" href="breakpoint_8c.html#a1a9c231f42607451d75f04f6f3e3096d">breakpoint_set_thread</a> (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b, <span class="keywordtype">int</span> thread)
<a name="l01239"></a>01239 {
<a name="l01240"></a>01240   <span class="keywordtype">int</span> old_thread = b-&gt;<a class="code" href="structbreakpoint.html#ae8613b6d8cf464f30ea39597be0cc192">thread</a>;
<a name="l01241"></a>01241 
<a name="l01242"></a>01242   b-&gt;<a class="code" href="structbreakpoint.html#ae8613b6d8cf464f30ea39597be0cc192">thread</a> = thread;
<a name="l01243"></a>01243   <span class="keywordflow">if</span> (old_thread != thread)
<a name="l01244"></a>01244     <a class="code" href="observer_8h.html#a3edacfe44ac49f71646caded92072cad">observer_notify_breakpoint_modified</a> (b);
<a name="l01245"></a>01245 }
<a name="l01246"></a>01246 
<a name="l01247"></a>01247 <span class="comment">/* Set the task for this breakpoint.  If TASK is 0, make the</span>
<a name="l01248"></a>01248 <span class="comment">   breakpoint work for any task.  */</span>
<a name="l01249"></a>01249 
<a name="l01250"></a>01250 <span class="keywordtype">void</span>
<a name="l01251"></a><a class="code" href="breakpoint_8h.html#a97dfb74be01afdcdb909788d053121f8">01251</a> <a class="code" href="breakpoint_8c.html#a97dfb74be01afdcdb909788d053121f8">breakpoint_set_task</a> (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b, <span class="keywordtype">int</span> task)
<a name="l01252"></a>01252 {
<a name="l01253"></a>01253   <span class="keywordtype">int</span> old_task = b-&gt;<a class="code" href="structbreakpoint.html#a9dc2d2b94cb051b28f86f8780dbad907">task</a>;
<a name="l01254"></a>01254 
<a name="l01255"></a>01255   b-&gt;<a class="code" href="structbreakpoint.html#a9dc2d2b94cb051b28f86f8780dbad907">task</a> = task;
<a name="l01256"></a>01256   <span class="keywordflow">if</span> (old_task != task)
<a name="l01257"></a>01257     <a class="code" href="observer_8h.html#a3edacfe44ac49f71646caded92072cad">observer_notify_breakpoint_modified</a> (b);
<a name="l01258"></a>01258 }
<a name="l01259"></a>01259 
<a name="l01260"></a>01260 <span class="keywordtype">void</span>
<a name="l01261"></a><a class="code" href="breakpoint_8h.html#ac150d03b018dda5d60dbf71a30d5b80a">01261</a> <a class="code" href="breakpoint_8c.html#ac150d03b018dda5d60dbf71a30d5b80a">check_tracepoint_command</a> (<span class="keywordtype">char</span> *<a class="code" href="symtab_8h.html#a41ebd28ef1d7c6ade45642cb6acc1039">line</a>, <span class="keywordtype">void</span> *closure)
<a name="l01262"></a>01262 {
<a name="l01263"></a>01263   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b = closure;
<a name="l01264"></a>01264 
<a name="l01265"></a>01265   <a class="code" href="tracepoint_8c.html#ae9b04bda0e4d8d4de77644aa0da39154">validate_actionline</a> (line, b);
<a name="l01266"></a>01266 }
<a name="l01267"></a>01267 
<a name="l01268"></a>01268 <span class="comment">/* A structure used to pass information through</span>
<a name="l01269"></a>01269 <span class="comment">   map_breakpoint_numbers.  */</span>
<a name="l01270"></a>01270 
<a name="l01271"></a>01271 <span class="keyword">struct </span>commands_info
<a name="l01272"></a>01272 {
<a name="l01273"></a>01273   <span class="comment">/* True if the command was typed at a tty.  */</span>
<a name="l01274"></a>01274   <span class="keywordtype">int</span> from_tty;
<a name="l01275"></a>01275 
<a name="l01276"></a>01276   <span class="comment">/* The breakpoint range spec.  */</span>
<a name="l01277"></a>01277   <span class="keywordtype">char</span> *arg;
<a name="l01278"></a>01278 
<a name="l01279"></a>01279   <span class="comment">/* Non-NULL if the body of the commands are being read from this</span>
<a name="l01280"></a>01280 <span class="comment">     already-parsed command.  */</span>
<a name="l01281"></a>01281   <span class="keyword">struct </span><a class="code" href="structcommand__line.html">command_line</a> *control;
<a name="l01282"></a>01282 
<a name="l01283"></a>01283   <span class="comment">/* The command lines read from the user, or NULL if they have not</span>
<a name="l01284"></a>01284 <span class="comment">     yet been read.  */</span>
<a name="l01285"></a>01285   <span class="keyword">struct </span>counted_command_line *cmd;
<a name="l01286"></a>01286 };
<a name="l01287"></a>01287 
<a name="l01288"></a>01288 <span class="comment">/* A callback for map_breakpoint_numbers that sets the commands for</span>
<a name="l01289"></a>01289 <span class="comment">   commands_command.  */</span>
<a name="l01290"></a>01290 
<a name="l01291"></a>01291 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01292"></a>01292 do_map_commands_command (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b, <span class="keywordtype">void</span> *data)
<a name="l01293"></a>01293 {
<a name="l01294"></a>01294   <span class="keyword">struct </span>commands_info *info = data;
<a name="l01295"></a>01295 
<a name="l01296"></a>01296   <span class="keywordflow">if</span> (info-&gt;cmd == NULL)
<a name="l01297"></a>01297     {
<a name="l01298"></a>01298       <span class="keyword">struct </span><a class="code" href="structcommand__line.html">command_line</a> *l;
<a name="l01299"></a>01299 
<a name="l01300"></a>01300       <span class="keywordflow">if</span> (info-&gt;control != NULL)
<a name="l01301"></a>01301         l = <a class="code" href="cli-script_8c.html#af5bad21a5c6328afda159b3e5986d01f">copy_command_lines</a> (info-&gt;control-&gt;body_list[0]);
<a name="l01302"></a>01302       <span class="keywordflow">else</span>
<a name="l01303"></a>01303         {
<a name="l01304"></a>01304           <span class="keyword">struct </span>cleanup *old_chain;
<a name="l01305"></a>01305           <span class="keywordtype">char</span> *str;
<a name="l01306"></a>01306 
<a name="l01307"></a>01307           str = <a class="code" href="common-utils_8c.html#ab9bf7e1b4e68bdd0078e9e1e55c62cec">xstrprintf</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Type commands for breakpoint(s) &quot;</span>
<a name="l01308"></a>01308                               <span class="stringliteral">&quot;%s, one per line.&quot;</span>),
<a name="l01309"></a>01309                             info-&gt;arg);
<a name="l01310"></a>01310 
<a name="l01311"></a>01311           old_chain = <a class="code" href="cleanups_8c.html#a3d418f8af424aec399898c2d48b26224">make_cleanup</a> (<a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a>, str);
<a name="l01312"></a>01312 
<a name="l01313"></a>01313           l = <a class="code" href="cli-script_8c.html#a23f6f7584a163a2b29e4a9d2ce469832">read_command_lines</a> (str,
<a name="l01314"></a>01314                                   info-&gt;from_tty, 1,
<a name="l01315"></a>01315                                   (<a class="code" href="breakpoint_8c.html#ac537492fb781218601862c78225bd118">is_tracepoint</a> (b)
<a name="l01316"></a>01316                                    ? <a class="code" href="breakpoint_8c.html#ac150d03b018dda5d60dbf71a30d5b80a">check_tracepoint_command</a> : 0),
<a name="l01317"></a>01317                                   b);
<a name="l01318"></a>01318 
<a name="l01319"></a>01319           <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (old_chain);
<a name="l01320"></a>01320         }
<a name="l01321"></a>01321 
<a name="l01322"></a>01322       info-&gt;cmd = alloc_counted_command_line (l);
<a name="l01323"></a>01323     }
<a name="l01324"></a>01324 
<a name="l01325"></a>01325   <span class="comment">/* If a breakpoint was on the list more than once, we don&#39;t need to</span>
<a name="l01326"></a>01326 <span class="comment">     do anything.  */</span>
<a name="l01327"></a>01327   <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#a054780dffadb1a4af0fc35037834fe4b">commands</a> != info-&gt;cmd)
<a name="l01328"></a>01328     {
<a name="l01329"></a>01329       validate_commands_for_breakpoint (b, info-&gt;cmd-&gt;commands);
<a name="l01330"></a>01330       incref_counted_command_line (info-&gt;cmd);
<a name="l01331"></a>01331       decref_counted_command_line (&amp;b-&gt;<a class="code" href="structbreakpoint.html#a054780dffadb1a4af0fc35037834fe4b">commands</a>);
<a name="l01332"></a>01332       b-&gt;<a class="code" href="structbreakpoint.html#a054780dffadb1a4af0fc35037834fe4b">commands</a> = info-&gt;cmd;
<a name="l01333"></a>01333       <a class="code" href="observer_8h.html#a3edacfe44ac49f71646caded92072cad">observer_notify_breakpoint_modified</a> (b);
<a name="l01334"></a>01334     }
<a name="l01335"></a>01335 }
<a name="l01336"></a>01336 
<a name="l01337"></a>01337 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01338"></a>01338 commands_command_1 (<span class="keywordtype">char</span> *arg, <span class="keywordtype">int</span> from_tty, 
<a name="l01339"></a>01339                     <span class="keyword">struct</span> <a class="code" href="structcommand__line.html">command_line</a> *control)
<a name="l01340"></a>01340 {
<a name="l01341"></a>01341   <span class="keyword">struct </span>cleanup *cleanups;
<a name="l01342"></a>01342   <span class="keyword">struct </span>commands_info info;
<a name="l01343"></a>01343 
<a name="l01344"></a>01344   info.from_tty = from_tty;
<a name="l01345"></a>01345   info.control = control;
<a name="l01346"></a>01346   info.cmd = NULL;
<a name="l01347"></a>01347   <span class="comment">/* If we read command lines from the user, then `info&#39; will hold an</span>
<a name="l01348"></a>01348 <span class="comment">     extra reference to the commands that we must clean up.  */</span>
<a name="l01349"></a>01349   cleanups = make_cleanup_decref_counted_command_line (&amp;info.cmd);
<a name="l01350"></a>01350 
<a name="l01351"></a>01351   <span class="keywordflow">if</span> (arg == NULL || !*arg)
<a name="l01352"></a>01352     {
<a name="l01353"></a>01353       <span class="keywordflow">if</span> (breakpoint_count - prev_breakpoint_count &gt; 1)
<a name="l01354"></a>01354         arg = <a class="code" href="common-utils_8c.html#ab9bf7e1b4e68bdd0078e9e1e55c62cec">xstrprintf</a> (<span class="stringliteral">&quot;%d-%d&quot;</span>, prev_breakpoint_count + 1, 
<a name="l01355"></a>01355                           breakpoint_count);
<a name="l01356"></a>01356       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (breakpoint_count &gt; 0)
<a name="l01357"></a>01357         arg = <a class="code" href="common-utils_8c.html#ab9bf7e1b4e68bdd0078e9e1e55c62cec">xstrprintf</a> (<span class="stringliteral">&quot;%d&quot;</span>, breakpoint_count);
<a name="l01358"></a>01358       <span class="keywordflow">else</span>
<a name="l01359"></a>01359         {
<a name="l01360"></a>01360           <span class="comment">/* So that we don&#39;t try to free the incoming non-NULL</span>
<a name="l01361"></a>01361 <span class="comment">             argument in the cleanup below.  Mapping breakpoint</span>
<a name="l01362"></a>01362 <span class="comment">             numbers will fail in this case.  */</span>
<a name="l01363"></a>01363           arg = NULL;
<a name="l01364"></a>01364         }
<a name="l01365"></a>01365     }
<a name="l01366"></a>01366   <span class="keywordflow">else</span>
<a name="l01367"></a>01367     <span class="comment">/* The command loop has some static state, so we need to preserve</span>
<a name="l01368"></a>01368 <span class="comment">       our argument.  */</span>
<a name="l01369"></a>01369     arg = xstrdup (arg);
<a name="l01370"></a>01370 
<a name="l01371"></a>01371   <span class="keywordflow">if</span> (arg != NULL)
<a name="l01372"></a>01372     <a class="code" href="cleanups_8c.html#a3d418f8af424aec399898c2d48b26224">make_cleanup</a> (<a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a>, arg);
<a name="l01373"></a>01373 
<a name="l01374"></a>01374   info.arg = arg;
<a name="l01375"></a>01375 
<a name="l01376"></a>01376   map_breakpoint_numbers (arg, do_map_commands_command, &amp;info);
<a name="l01377"></a>01377 
<a name="l01378"></a>01378   <span class="keywordflow">if</span> (info.cmd == NULL)
<a name="l01379"></a>01379     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;No breakpoints specified.&quot;</span>));
<a name="l01380"></a>01380 
<a name="l01381"></a>01381   <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (cleanups);
<a name="l01382"></a>01382 }
<a name="l01383"></a>01383 
<a name="l01384"></a>01384 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01385"></a>01385 commands_command (<span class="keywordtype">char</span> *arg, <span class="keywordtype">int</span> from_tty)
<a name="l01386"></a>01386 {
<a name="l01387"></a>01387   commands_command_1 (arg, from_tty, NULL);
<a name="l01388"></a>01388 }
<a name="l01389"></a>01389 
<a name="l01390"></a>01390 <span class="comment">/* Like commands_command, but instead of reading the commands from</span>
<a name="l01391"></a>01391 <span class="comment">   input stream, takes them from an already parsed command structure.</span>
<a name="l01392"></a>01392 <span class="comment"></span>
<a name="l01393"></a>01393 <span class="comment">   This is used by cli-script.c to DTRT with breakpoint commands</span>
<a name="l01394"></a>01394 <span class="comment">   that are part of if and while bodies.  */</span>
<a name="l01395"></a>01395 <span class="keyword">enum</span> <a class="code" href="defs_8h.html#acd2d66ca4b77ba7ac2fbfc6149bf1cdd">command_control_type</a>
<a name="l01396"></a><a class="code" href="breakpoint_8h.html#a5c591dd764f20b82bedae612be186d9c">01396</a> <a class="code" href="breakpoint_8c.html#a5c591dd764f20b82bedae612be186d9c">commands_from_control_command</a> (<span class="keywordtype">char</span> *arg, <span class="keyword">struct</span> <a class="code" href="structcommand__line.html">command_line</a> *cmd)
<a name="l01397"></a>01397 {
<a name="l01398"></a>01398   commands_command_1 (arg, 0, cmd);
<a name="l01399"></a>01399   <span class="keywordflow">return</span> <a class="code" href="defs_8h.html#acd2d66ca4b77ba7ac2fbfc6149bf1cddad85c97f8ce050d876f3bc5bccba65c40">simple_control</a>;
<a name="l01400"></a>01400 }
<a name="l01401"></a>01401 
<a name="l01402"></a>01402 <span class="comment">/* Return non-zero if BL-&gt;TARGET_INFO contains valid information.  */</span>
<a name="l01403"></a>01403 
<a name="l01404"></a>01404 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l01405"></a>01405 bp_location_has_shadow (<span class="keyword">struct</span> bp_location *bl)
<a name="l01406"></a>01406 {
<a name="l01407"></a>01407   <span class="keywordflow">if</span> (bl-&gt;<a class="code" href="structbp__location.html#aefe49818487e5876fc995f7831e2e809">loc_type</a> != <a class="code" href="breakpoint_8h.html#ad7006ab95a9d2493c6ad2c685f45f5dcaa74492f6095e7a1ae08e3eed468ba47d">bp_loc_software_breakpoint</a>)
<a name="l01408"></a>01408     <span class="keywordflow">return</span> 0;
<a name="l01409"></a>01409   <span class="keywordflow">if</span> (!bl-&gt;<a class="code" href="structbp__location.html#acb0b475579bbe5dabeb8ed4504527105">inserted</a>)
<a name="l01410"></a>01410     <span class="keywordflow">return</span> 0;
<a name="l01411"></a>01411   <span class="keywordflow">if</span> (bl-&gt;<a class="code" href="structbp__location.html#a72be6a63cd025a9a040df0325fa507af">target_info</a>.<a class="code" href="structbp__target__info.html#acb1afc503e5b60c3f351ef664fc74931">shadow_len</a> == 0)
<a name="l01412"></a>01412     <span class="comment">/* BL isn&#39;t valid, or doesn&#39;t shadow memory.  */</span>
<a name="l01413"></a>01413     <span class="keywordflow">return</span> 0;
<a name="l01414"></a>01414   <span class="keywordflow">return</span> 1;
<a name="l01415"></a>01415 }
<a name="l01416"></a>01416 
<a name="l01417"></a>01417 <span class="comment">/* Update BUF, which is LEN bytes read from the target address MEMADDR,</span>
<a name="l01418"></a>01418 <span class="comment">   by replacing any memory breakpoints with their shadowed contents.</span>
<a name="l01419"></a>01419 <span class="comment"></span>
<a name="l01420"></a>01420 <span class="comment">   If READBUF is not NULL, this buffer must not overlap with any of</span>
<a name="l01421"></a>01421 <span class="comment">   the breakpoint location&#39;s shadow_contents buffers.  Otherwise,</span>
<a name="l01422"></a>01422 <span class="comment">   a failed assertion internal error will be raised.</span>
<a name="l01423"></a>01423 <span class="comment"></span>
<a name="l01424"></a>01424 <span class="comment">   The range of shadowed area by each bp_location is:</span>
<a name="l01425"></a>01425 <span class="comment">     bl-&gt;address - bp_location_placed_address_before_address_max</span>
<a name="l01426"></a>01426 <span class="comment">     up to bl-&gt;address + bp_location_shadow_len_after_address_max</span>
<a name="l01427"></a>01427 <span class="comment">   The range we were requested to resolve shadows for is:</span>
<a name="l01428"></a>01428 <span class="comment">     memaddr ... memaddr + len</span>
<a name="l01429"></a>01429 <span class="comment">   Thus the safe cutoff boundaries for performance optimization are</span>
<a name="l01430"></a>01430 <span class="comment">     memaddr + len &lt;= (bl-&gt;address</span>
<a name="l01431"></a>01431 <span class="comment">                       - bp_location_placed_address_before_address_max)</span>
<a name="l01432"></a>01432 <span class="comment">   and:</span>
<a name="l01433"></a>01433 <span class="comment">     bl-&gt;address + bp_location_shadow_len_after_address_max &lt;= memaddr  */</span>
<a name="l01434"></a>01434 
<a name="l01435"></a>01435 <span class="keywordtype">void</span>
<a name="l01436"></a><a class="code" href="breakpoint_8h.html#ace7ee1b04d601661f1a7f86d83407580">01436</a> <a class="code" href="breakpoint_8c.html#ace7ee1b04d601661f1a7f86d83407580">breakpoint_xfer_memory</a> (<a class="code" href="defs_8h.html#a336b399b3b83dbcc61f176c33f26b607">gdb_byte</a> *readbuf, <a class="code" href="defs_8h.html#a336b399b3b83dbcc61f176c33f26b607">gdb_byte</a> *writebuf,
<a name="l01437"></a>01437                         <span class="keyword">const</span> <a class="code" href="defs_8h.html#a336b399b3b83dbcc61f176c33f26b607">gdb_byte</a> *writebuf_org,
<a name="l01438"></a>01438                         <a class="code" href="defs_8h.html#a4df4af8771b1016a24976757026f4984">ULONGEST</a> <a class="code" href="exec_8h.html#ab268c3184bf49615e16de006a296a542">memaddr</a>, <a class="code" href="defs_8h.html#ac7647a3f71533007c9e128f3ddda1987">LONGEST</a> len)
<a name="l01439"></a>01439 {
<a name="l01440"></a>01440   <span class="comment">/* Left boundary, right boundary and median element of our binary</span>
<a name="l01441"></a>01441 <span class="comment">     search.  */</span>
<a name="l01442"></a>01442   <span class="keywordtype">unsigned</span> bc_l, bc_r, bc;
<a name="l01443"></a>01443 
<a name="l01444"></a>01444   <span class="comment">/* Find BC_L which is a leftmost element which may affect BUF</span>
<a name="l01445"></a>01445 <span class="comment">     content.  It is safe to report lower value but a failure to</span>
<a name="l01446"></a>01446 <span class="comment">     report higher one.  */</span>
<a name="l01447"></a>01447 
<a name="l01448"></a>01448   bc_l = 0;
<a name="l01449"></a>01449   bc_r = bp_location_count;
<a name="l01450"></a>01450   <span class="keywordflow">while</span> (bc_l + 1 &lt; bc_r)
<a name="l01451"></a>01451     {
<a name="l01452"></a>01452       <span class="keyword">struct </span>bp_location *bl;
<a name="l01453"></a>01453 
<a name="l01454"></a>01454       bc = (bc_l + bc_r) / 2;
<a name="l01455"></a>01455       bl = bp_location[bc];
<a name="l01456"></a>01456 
<a name="l01457"></a>01457       <span class="comment">/* Check first BL-&gt;ADDRESS will not overflow due to the added</span>
<a name="l01458"></a>01458 <span class="comment">         constant.  Then advance the left boundary only if we are sure</span>
<a name="l01459"></a>01459 <span class="comment">         the BC element can in no way affect the BUF content (MEMADDR</span>
<a name="l01460"></a>01460 <span class="comment">         to MEMADDR + LEN range).</span>
<a name="l01461"></a>01461 <span class="comment"></span>
<a name="l01462"></a>01462 <span class="comment">         Use the BP_LOCATION_SHADOW_LEN_AFTER_ADDRESS_MAX safety</span>
<a name="l01463"></a>01463 <span class="comment">         offset so that we cannot miss a breakpoint with its shadow</span>
<a name="l01464"></a>01464 <span class="comment">         range tail still reaching MEMADDR.  */</span>
<a name="l01465"></a>01465 
<a name="l01466"></a>01466       <span class="keywordflow">if</span> ((bl-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a> + bp_location_shadow_len_after_address_max
<a name="l01467"></a>01467            &gt;= bl-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>)
<a name="l01468"></a>01468           &amp;&amp; (bl-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a> + bp_location_shadow_len_after_address_max
<a name="l01469"></a>01469               &lt;= <a class="code" href="exec_8h.html#ab268c3184bf49615e16de006a296a542">memaddr</a>))
<a name="l01470"></a>01470         bc_l = bc;
<a name="l01471"></a>01471       <span class="keywordflow">else</span>
<a name="l01472"></a>01472         bc_r = bc;
<a name="l01473"></a>01473     }
<a name="l01474"></a>01474 
<a name="l01475"></a>01475   <span class="comment">/* Due to the binary search above, we need to make sure we pick the</span>
<a name="l01476"></a>01476 <span class="comment">     first location that&#39;s at BC_L&#39;s address.  E.g., if there are</span>
<a name="l01477"></a>01477 <span class="comment">     multiple locations at the same address, BC_L may end up pointing</span>
<a name="l01478"></a>01478 <span class="comment">     at a duplicate location, and miss the &quot;master&quot;/&quot;inserted&quot;</span>
<a name="l01479"></a>01479 <span class="comment">     location.  Say, given locations L1, L2 and L3 at addresses A and</span>
<a name="l01480"></a>01480 <span class="comment">     B:</span>
<a name="l01481"></a>01481 <span class="comment"></span>
<a name="l01482"></a>01482 <span class="comment">      L1@A, L2@A, L3@B, ...</span>
<a name="l01483"></a>01483 <span class="comment"></span>
<a name="l01484"></a>01484 <span class="comment">     BC_L could end up pointing at location L2, while the &quot;master&quot;</span>
<a name="l01485"></a>01485 <span class="comment">     location could be L1.  Since the `loc-&gt;inserted&#39; flag is only set</span>
<a name="l01486"></a>01486 <span class="comment">     on &quot;master&quot; locations, we&#39;d forget to restore the shadow of L1</span>
<a name="l01487"></a>01487 <span class="comment">     and L2.  */</span>
<a name="l01488"></a>01488   <span class="keywordflow">while</span> (bc_l &gt; 0
<a name="l01489"></a>01489          &amp;&amp; bp_location[bc_l]-&gt;address == bp_location[bc_l - 1]-&gt;address)
<a name="l01490"></a>01490     bc_l--;
<a name="l01491"></a>01491 
<a name="l01492"></a>01492   <span class="comment">/* Now do full processing of the found relevant range of elements.  */</span>
<a name="l01493"></a>01493 
<a name="l01494"></a>01494   <span class="keywordflow">for</span> (bc = bc_l; bc &lt; bp_location_count; bc++)
<a name="l01495"></a>01495   {
<a name="l01496"></a>01496     <span class="keyword">struct </span>bp_location *bl = bp_location[bc];
<a name="l01497"></a>01497     <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> bp_addr = 0;
<a name="l01498"></a>01498     <span class="keywordtype">int</span> bp_size = 0;
<a name="l01499"></a>01499     <span class="keywordtype">int</span> bptoffset = 0;
<a name="l01500"></a>01500 
<a name="l01501"></a>01501     <span class="comment">/* bp_location array has BL-&gt;OWNER always non-NULL.  */</span>
<a name="l01502"></a>01502     <span class="keywordflow">if</span> (bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfac0517cbb17f625d6cf900fb3aa64636e">bp_none</a>)
<a name="l01503"></a>01503       <a class="code" href="utils_8c.html#a5fc201a4181499a6b4057a6caa15b5e2">warning</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;reading through apparently deleted breakpoint #%d?&quot;</span>),
<a name="l01504"></a>01504                bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>);
<a name="l01505"></a>01505 
<a name="l01506"></a>01506     <span class="comment">/* Performance optimization: any further element can no longer affect BUF</span>
<a name="l01507"></a>01507 <span class="comment">       content.  */</span>
<a name="l01508"></a>01508 
<a name="l01509"></a>01509     <span class="keywordflow">if</span> (bl-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a> &gt;= bp_location_placed_address_before_address_max
<a name="l01510"></a>01510         &amp;&amp; memaddr + len &lt;= (bl-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>
<a name="l01511"></a>01511                              - bp_location_placed_address_before_address_max))
<a name="l01512"></a>01512       <span class="keywordflow">break</span>;
<a name="l01513"></a>01513 
<a name="l01514"></a>01514     <span class="keywordflow">if</span> (!bp_location_has_shadow (bl))
<a name="l01515"></a>01515       <span class="keywordflow">continue</span>;
<a name="l01516"></a>01516     <span class="keywordflow">if</span> (!breakpoint_address_match (bl-&gt;<a class="code" href="structbp__location.html#a72be6a63cd025a9a040df0325fa507af">target_info</a>.<a class="code" href="structbp__target__info.html#afe5a9e41037d27e13353a24f733c4693">placed_address_space</a>, 0,
<a name="l01517"></a>01517                                    <a class="code" href="progspace_8c.html#a07722ff15a98814c086dda44f93380c9">current_program_space</a>-&gt;<a class="code" href="structprogram__space.html#abf2a489f5ed3c1d5cad74d14dbb318e4">aspace</a>, 0))
<a name="l01518"></a>01518       <span class="keywordflow">continue</span>;
<a name="l01519"></a>01519 
<a name="l01520"></a>01520     <span class="comment">/* Addresses and length of the part of the breakpoint that</span>
<a name="l01521"></a>01521 <span class="comment">       we need to copy.  */</span>
<a name="l01522"></a>01522     bp_addr = bl-&gt;<a class="code" href="structbp__location.html#a72be6a63cd025a9a040df0325fa507af">target_info</a>.<a class="code" href="structbp__target__info.html#a8e3d47e670e13db11873c3ff52934fbb">placed_address</a>;
<a name="l01523"></a>01523     bp_size = bl-&gt;<a class="code" href="structbp__location.html#a72be6a63cd025a9a040df0325fa507af">target_info</a>.<a class="code" href="structbp__target__info.html#acb1afc503e5b60c3f351ef664fc74931">shadow_len</a>;
<a name="l01524"></a>01524 
<a name="l01525"></a>01525     <span class="keywordflow">if</span> (bp_addr + bp_size &lt;= memaddr)
<a name="l01526"></a>01526       <span class="comment">/* The breakpoint is entirely before the chunk of memory we</span>
<a name="l01527"></a>01527 <span class="comment">         are reading.  */</span>
<a name="l01528"></a>01528       <span class="keywordflow">continue</span>;
<a name="l01529"></a>01529 
<a name="l01530"></a>01530     <span class="keywordflow">if</span> (bp_addr &gt;= memaddr + len)
<a name="l01531"></a>01531       <span class="comment">/* The breakpoint is entirely after the chunk of memory we are</span>
<a name="l01532"></a>01532 <span class="comment">         reading.  */</span>
<a name="l01533"></a>01533       <span class="keywordflow">continue</span>;
<a name="l01534"></a>01534 
<a name="l01535"></a>01535     <span class="comment">/* Offset within shadow_contents.  */</span>
<a name="l01536"></a>01536     <span class="keywordflow">if</span> (bp_addr &lt; memaddr)
<a name="l01537"></a>01537       {
<a name="l01538"></a>01538         <span class="comment">/* Only copy the second part of the breakpoint.  */</span>
<a name="l01539"></a>01539         bp_size -= memaddr - bp_addr;
<a name="l01540"></a>01540         bptoffset = memaddr - bp_addr;
<a name="l01541"></a>01541         bp_addr = <a class="code" href="exec_8h.html#ab268c3184bf49615e16de006a296a542">memaddr</a>;
<a name="l01542"></a>01542       }
<a name="l01543"></a>01543 
<a name="l01544"></a>01544     <span class="keywordflow">if</span> (bp_addr + bp_size &gt; memaddr + len)
<a name="l01545"></a>01545       {
<a name="l01546"></a>01546         <span class="comment">/* Only copy the first part of the breakpoint.  */</span>
<a name="l01547"></a>01547         bp_size -= (bp_addr + bp_size) - (memaddr + len);
<a name="l01548"></a>01548       }
<a name="l01549"></a>01549 
<a name="l01550"></a>01550     <span class="keywordflow">if</span> (readbuf != NULL)
<a name="l01551"></a>01551       {
<a name="l01552"></a>01552         <span class="comment">/* Verify that the readbuf buffer does not overlap with</span>
<a name="l01553"></a>01553 <span class="comment">           the shadow_contents buffer.  */</span>
<a name="l01554"></a>01554         <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (bl-&gt;<a class="code" href="structbp__location.html#a72be6a63cd025a9a040df0325fa507af">target_info</a>.<a class="code" href="structbp__target__info.html#a6cd55458954d89985ae221f986c48cbc">shadow_contents</a> &gt;= readbuf + len
<a name="l01555"></a>01555                     || readbuf &gt;= (bl-&gt;<a class="code" href="structbp__location.html#a72be6a63cd025a9a040df0325fa507af">target_info</a>.<a class="code" href="structbp__target__info.html#a6cd55458954d89985ae221f986c48cbc">shadow_contents</a>
<a name="l01556"></a>01556                                    + bl-&gt;<a class="code" href="structbp__location.html#a72be6a63cd025a9a040df0325fa507af">target_info</a>.<a class="code" href="structbp__target__info.html#acb1afc503e5b60c3f351ef664fc74931">shadow_len</a>));
<a name="l01557"></a>01557 
<a name="l01558"></a>01558         <span class="comment">/* Update the read buffer with this inserted breakpoint&#39;s</span>
<a name="l01559"></a>01559 <span class="comment">           shadow.  */</span>
<a name="l01560"></a>01560         <a class="code" href="gdb__string_8h.html#a39ebe6a4e122707997e78b549a1e8c5e">memcpy</a> (readbuf + bp_addr - memaddr,
<a name="l01561"></a>01561                 bl-&gt;<a class="code" href="structbp__location.html#a72be6a63cd025a9a040df0325fa507af">target_info</a>.<a class="code" href="structbp__target__info.html#a6cd55458954d89985ae221f986c48cbc">shadow_contents</a> + bptoffset, bp_size);
<a name="l01562"></a>01562       }
<a name="l01563"></a>01563     <span class="keywordflow">else</span>
<a name="l01564"></a>01564       {
<a name="l01565"></a>01565         <span class="keyword">struct </span>gdbarch *gdbarch = bl-&gt;<a class="code" href="structbp__location.html#a55f3ff99d536775f5095f11e5f5c3f3e">gdbarch</a>;
<a name="l01566"></a>01566         <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *bp;
<a name="l01567"></a>01567         <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> placed_address = bl-&gt;<a class="code" href="structbp__location.html#a72be6a63cd025a9a040df0325fa507af">target_info</a>.<a class="code" href="structbp__target__info.html#a8e3d47e670e13db11873c3ff52934fbb">placed_address</a>;
<a name="l01568"></a>01568         <span class="keywordtype">int</span> placed_size = bl-&gt;<a class="code" href="structbp__location.html#a72be6a63cd025a9a040df0325fa507af">target_info</a>.<a class="code" href="structbp__target__info.html#abc2b7aee9a9068a49542091716faed84">placed_size</a>;
<a name="l01569"></a>01569 
<a name="l01570"></a>01570         <span class="comment">/* Update the shadow with what we want to write to memory.  */</span>
<a name="l01571"></a>01571         <a class="code" href="gdb__string_8h.html#a39ebe6a4e122707997e78b549a1e8c5e">memcpy</a> (bl-&gt;<a class="code" href="structbp__location.html#a72be6a63cd025a9a040df0325fa507af">target_info</a>.<a class="code" href="structbp__target__info.html#a6cd55458954d89985ae221f986c48cbc">shadow_contents</a> + bptoffset,
<a name="l01572"></a>01572                 writebuf_org + bp_addr - memaddr, bp_size);
<a name="l01573"></a>01573 
<a name="l01574"></a>01574         <span class="comment">/* Determine appropriate breakpoint contents and size for this</span>
<a name="l01575"></a>01575 <span class="comment">           address.  */</span>
<a name="l01576"></a>01576         bp = <a class="code" href="gdbarch_8c.html#a097194ad55d5379bab42ce9bf8029a69">gdbarch_breakpoint_from_pc</a> (gdbarch, &amp;placed_address, &amp;placed_size);
<a name="l01577"></a>01577 
<a name="l01578"></a>01578         <span class="comment">/* Update the final write buffer with this inserted</span>
<a name="l01579"></a>01579 <span class="comment">           breakpoint&#39;s INSN.  */</span>
<a name="l01580"></a>01580         <a class="code" href="gdb__string_8h.html#a39ebe6a4e122707997e78b549a1e8c5e">memcpy</a> (writebuf + bp_addr - memaddr, bp + bptoffset, bp_size);
<a name="l01581"></a>01581       }
<a name="l01582"></a>01582   }
<a name="l01583"></a>01583 }
<a name="l01584"></a>01584 
<a name="l01585"></a>01585 
<a name="l01586"></a>01586 <span class="comment">/* Return true if BPT is either a software breakpoint or a hardware</span>
<a name="l01587"></a>01587 <span class="comment">   breakpoint.  */</span>
<a name="l01588"></a>01588 
<a name="l01589"></a>01589 <span class="keywordtype">int</span>
<a name="l01590"></a><a class="code" href="breakpoint_8h.html#a5de9005cc5b36d1d327aa9127ea64f9c">01590</a> <a class="code" href="breakpoint_8c.html#a5de9005cc5b36d1d327aa9127ea64f9c">is_breakpoint</a> (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *bpt)
<a name="l01591"></a>01591 {
<a name="l01592"></a>01592   <span class="keywordflow">return</span> (bpt-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa17768c2bd9137ec6e30c922c5c1d0ffa">bp_breakpoint</a>
<a name="l01593"></a>01593           || bpt-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa657fad68a9d83a24532fb06715b77628">bp_hardware_breakpoint</a>
<a name="l01594"></a>01594           || bpt-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa404b00503edb7eba238aea705ea34231">bp_dprintf</a>);
<a name="l01595"></a>01595 }
<a name="l01596"></a>01596 
<a name="l01597"></a>01597 <span class="comment">/* Return true if BPT is of any hardware watchpoint kind.  */</span>
<a name="l01598"></a>01598 
<a name="l01599"></a>01599 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l01600"></a>01600 is_hardware_watchpoint (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *bpt)
<a name="l01601"></a>01601 {
<a name="l01602"></a>01602   <span class="keywordflow">return</span> (bpt-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfae38a33f5a6725fbca8b5da2d491cfbcb">bp_hardware_watchpoint</a>
<a name="l01603"></a>01603           || bpt-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa7013ee22be60f470b10b2de2f9d22c21">bp_read_watchpoint</a>
<a name="l01604"></a>01604           || bpt-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa9148c330e0f813ed6fb421af9d7da820">bp_access_watchpoint</a>);
<a name="l01605"></a>01605 }
<a name="l01606"></a>01606 
<a name="l01607"></a>01607 <span class="comment">/* Return true if BPT is of any watchpoint kind, hardware or</span>
<a name="l01608"></a>01608 <span class="comment">   software.  */</span>
<a name="l01609"></a>01609 
<a name="l01610"></a>01610 <span class="keywordtype">int</span>
<a name="l01611"></a><a class="code" href="breakpoint_8h.html#a49f0d5ff628dd506db5b81f660eb4610">01611</a> <a class="code" href="breakpoint_8c.html#a49f0d5ff628dd506db5b81f660eb4610">is_watchpoint</a> (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *bpt)
<a name="l01612"></a>01612 {
<a name="l01613"></a>01613   <span class="keywordflow">return</span> (is_hardware_watchpoint (bpt)
<a name="l01614"></a>01614           || bpt-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa2a35cc5d65b66d6228def5615d6827ce">bp_watchpoint</a>);
<a name="l01615"></a>01615 }
<a name="l01616"></a>01616 
<a name="l01617"></a>01617 <span class="comment">/* Returns true if the current thread and its running state are safe</span>
<a name="l01618"></a>01618 <span class="comment">   to evaluate or update watchpoint B.  Watchpoints on local</span>
<a name="l01619"></a>01619 <span class="comment">   expressions need to be evaluated in the context of the thread that</span>
<a name="l01620"></a>01620 <span class="comment">   was current when the watchpoint was created, and, that thread needs</span>
<a name="l01621"></a>01621 <span class="comment">   to be stopped to be able to select the correct frame context.</span>
<a name="l01622"></a>01622 <span class="comment">   Watchpoints on global expressions can be evaluated on any thread,</span>
<a name="l01623"></a>01623 <span class="comment">   and in any state.  It is presently left to the target allowing</span>
<a name="l01624"></a>01624 <span class="comment">   memory accesses when threads are running.  */</span>
<a name="l01625"></a>01625 
<a name="l01626"></a>01626 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l01627"></a>01627 watchpoint_in_thread_scope (<span class="keyword">struct</span> <a class="code" href="structwatchpoint.html">watchpoint</a> *b)
<a name="l01628"></a>01628 {
<a name="l01629"></a>01629   <span class="keywordflow">return</span> (b-&gt;<a class="code" href="structwatchpoint.html#a01b7a13518becdd7631c9d701b70cbd1">base</a>.<a class="code" href="structbreakpoint.html#a82f4fd8ee6ddee61f3529fbd747c78b2">pspace</a> == <a class="code" href="progspace_8c.html#a07722ff15a98814c086dda44f93380c9">current_program_space</a>
<a name="l01630"></a>01630           &amp;&amp; (<a class="code" href="ptid_8c.html#a0df58c8db2620a2cec647934b4f77266">ptid_equal</a> (b-&gt;<a class="code" href="structwatchpoint.html#a0bd62e44295bf4a0cdce4ecfdefaaee7">watchpoint_thread</a>, <a class="code" href="ptid_8c.html#acba69c857786546b204883bbcc90a64e">null_ptid</a>)
<a name="l01631"></a>01631               || (<a class="code" href="ptid_8c.html#a0df58c8db2620a2cec647934b4f77266">ptid_equal</a> (<a class="code" href="infcmd_8c.html#a428c5be9ce5e70bd03760e828e19c6b7">inferior_ptid</a>, b-&gt;<a class="code" href="structwatchpoint.html#a0bd62e44295bf4a0cdce4ecfdefaaee7">watchpoint_thread</a>)
<a name="l01632"></a>01632                   &amp;&amp; !<a class="code" href="gdbthread_8h.html#a9cb93190294c3de16f2bb6aebc5238e4">is_executing</a> (<a class="code" href="infcmd_8c.html#a428c5be9ce5e70bd03760e828e19c6b7">inferior_ptid</a>))));
<a name="l01633"></a>01633 }
<a name="l01634"></a>01634 
<a name="l01635"></a>01635 <span class="comment">/* Set watchpoint B to disp_del_at_next_stop, even including its possible</span>
<a name="l01636"></a>01636 <span class="comment">   associated bp_watchpoint_scope breakpoint.  */</span>
<a name="l01637"></a>01637 
<a name="l01638"></a>01638 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01639"></a>01639 watchpoint_del_at_next_stop (<span class="keyword">struct</span> <a class="code" href="structwatchpoint.html">watchpoint</a> *w)
<a name="l01640"></a>01640 {
<a name="l01641"></a>01641   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b = &amp;w-&gt;<a class="code" href="structwatchpoint.html#a01b7a13518becdd7631c9d701b70cbd1">base</a>;
<a name="l01642"></a>01642 
<a name="l01643"></a>01643   <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#a7d9882daea896de8ff1f7981e9508500">related_breakpoint</a> != b)
<a name="l01644"></a>01644     {
<a name="l01645"></a>01645       <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (b-&gt;<a class="code" href="structbreakpoint.html#a7d9882daea896de8ff1f7981e9508500">related_breakpoint</a>-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfad6bfd2f2654949462085c78f02480366">bp_watchpoint_scope</a>);
<a name="l01646"></a>01646       <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (b-&gt;<a class="code" href="structbreakpoint.html#a7d9882daea896de8ff1f7981e9508500">related_breakpoint</a>-&gt;<a class="code" href="structbreakpoint.html#a7d9882daea896de8ff1f7981e9508500">related_breakpoint</a> == b);
<a name="l01647"></a>01647       b-&gt;<a class="code" href="structbreakpoint.html#a7d9882daea896de8ff1f7981e9508500">related_breakpoint</a>-&gt;<a class="code" href="structbreakpoint.html#a75f0f9a837eac292ab6e768e8d8f1bd7">disposition</a> = <a class="code" href="breakpoint_8h.html#a15f2bbd9012f59bc09d59feef0c15732a9b0a2ed54849261d15631bb5e654843b">disp_del_at_next_stop</a>;
<a name="l01648"></a>01648       b-&gt;<a class="code" href="structbreakpoint.html#a7d9882daea896de8ff1f7981e9508500">related_breakpoint</a>-&gt;<a class="code" href="structbreakpoint.html#a7d9882daea896de8ff1f7981e9508500">related_breakpoint</a> = b-&gt;<a class="code" href="structbreakpoint.html#a7d9882daea896de8ff1f7981e9508500">related_breakpoint</a>;
<a name="l01649"></a>01649       b-&gt;<a class="code" href="structbreakpoint.html#a7d9882daea896de8ff1f7981e9508500">related_breakpoint</a> = b;
<a name="l01650"></a>01650     }
<a name="l01651"></a>01651   b-&gt;<a class="code" href="structbreakpoint.html#a75f0f9a837eac292ab6e768e8d8f1bd7">disposition</a> = <a class="code" href="breakpoint_8h.html#a15f2bbd9012f59bc09d59feef0c15732a9b0a2ed54849261d15631bb5e654843b">disp_del_at_next_stop</a>;
<a name="l01652"></a>01652 }
<a name="l01653"></a>01653 
<a name="l01654"></a>01654 <span class="comment">/* Assuming that B is a watchpoint:</span>
<a name="l01655"></a>01655 <span class="comment">   - Reparse watchpoint expression, if REPARSE is non-zero</span>
<a name="l01656"></a>01656 <span class="comment">   - Evaluate expression and store the result in B-&gt;val</span>
<a name="l01657"></a>01657 <span class="comment">   - Evaluate the condition if there is one, and store the result</span>
<a name="l01658"></a>01658 <span class="comment">     in b-&gt;loc-&gt;cond.</span>
<a name="l01659"></a>01659 <span class="comment">   - Update the list of values that must be watched in B-&gt;loc.</span>
<a name="l01660"></a>01660 <span class="comment"></span>
<a name="l01661"></a>01661 <span class="comment">   If the watchpoint disposition is disp_del_at_next_stop, then do</span>
<a name="l01662"></a>01662 <span class="comment">   nothing.  If this is local watchpoint that is out of scope, delete</span>
<a name="l01663"></a>01663 <span class="comment">   it.</span>
<a name="l01664"></a>01664 <span class="comment"></span>
<a name="l01665"></a>01665 <span class="comment">   Even with `set breakpoint always-inserted on&#39; the watchpoints are</span>
<a name="l01666"></a>01666 <span class="comment">   removed + inserted on each stop here.  Normal breakpoints must</span>
<a name="l01667"></a>01667 <span class="comment">   never be removed because they might be missed by a running thread</span>
<a name="l01668"></a>01668 <span class="comment">   when debugging in non-stop mode.  On the other hand, hardware</span>
<a name="l01669"></a>01669 <span class="comment">   watchpoints (is_hardware_watchpoint; processed here) are specific</span>
<a name="l01670"></a>01670 <span class="comment">   to each LWP since they are stored in each LWP&#39;s hardware debug</span>
<a name="l01671"></a>01671 <span class="comment">   registers.  Therefore, such LWP must be stopped first in order to</span>
<a name="l01672"></a>01672 <span class="comment">   be able to modify its hardware watchpoints.</span>
<a name="l01673"></a>01673 <span class="comment"></span>
<a name="l01674"></a>01674 <span class="comment">   Hardware watchpoints must be reset exactly once after being</span>
<a name="l01675"></a>01675 <span class="comment">   presented to the user.  It cannot be done sooner, because it would</span>
<a name="l01676"></a>01676 <span class="comment">   reset the data used to present the watchpoint hit to the user.  And</span>
<a name="l01677"></a>01677 <span class="comment">   it must not be done later because it could display the same single</span>
<a name="l01678"></a>01678 <span class="comment">   watchpoint hit during multiple GDB stops.  Note that the latter is</span>
<a name="l01679"></a>01679 <span class="comment">   relevant only to the hardware watchpoint types bp_read_watchpoint</span>
<a name="l01680"></a>01680 <span class="comment">   and bp_access_watchpoint.  False hit by bp_hardware_watchpoint is</span>
<a name="l01681"></a>01681 <span class="comment">   not user-visible - its hit is suppressed if the memory content has</span>
<a name="l01682"></a>01682 <span class="comment">   not changed.</span>
<a name="l01683"></a>01683 <span class="comment"></span>
<a name="l01684"></a>01684 <span class="comment">   The following constraints influence the location where we can reset</span>
<a name="l01685"></a>01685 <span class="comment">   hardware watchpoints:</span>
<a name="l01686"></a>01686 <span class="comment"></span>
<a name="l01687"></a>01687 <span class="comment">   * target_stopped_by_watchpoint and target_stopped_data_address are</span>
<a name="l01688"></a>01688 <span class="comment">     called several times when GDB stops.</span>
<a name="l01689"></a>01689 <span class="comment"></span>
<a name="l01690"></a>01690 <span class="comment">   [linux] </span>
<a name="l01691"></a>01691 <span class="comment">   * Multiple hardware watchpoints can be hit at the same time,</span>
<a name="l01692"></a>01692 <span class="comment">     causing GDB to stop.  GDB only presents one hardware watchpoint</span>
<a name="l01693"></a>01693 <span class="comment">     hit at a time as the reason for stopping, and all the other hits</span>
<a name="l01694"></a>01694 <span class="comment">     are presented later, one after the other, each time the user</span>
<a name="l01695"></a>01695 <span class="comment">     requests the execution to be resumed.  Execution is not resumed</span>
<a name="l01696"></a>01696 <span class="comment">     for the threads still having pending hit event stored in</span>
<a name="l01697"></a>01697 <span class="comment">     LWP_INFO-&gt;STATUS.  While the watchpoint is already removed from</span>
<a name="l01698"></a>01698 <span class="comment">     the inferior on the first stop the thread hit event is kept being</span>
<a name="l01699"></a>01699 <span class="comment">     reported from its cached value by linux_nat_stopped_data_address</span>
<a name="l01700"></a>01700 <span class="comment">     until the real thread resume happens after the watchpoint gets</span>
<a name="l01701"></a>01701 <span class="comment">     presented and thus its LWP_INFO-&gt;STATUS gets reset.</span>
<a name="l01702"></a>01702 <span class="comment"></span>
<a name="l01703"></a>01703 <span class="comment">   Therefore the hardware watchpoint hit can get safely reset on the</span>
<a name="l01704"></a>01704 <span class="comment">   watchpoint removal from inferior.  */</span>
<a name="l01705"></a>01705 
<a name="l01706"></a>01706 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01707"></a>01707 update_watchpoint (<span class="keyword">struct</span> <a class="code" href="structwatchpoint.html">watchpoint</a> *b, <span class="keywordtype">int</span> reparse)
<a name="l01708"></a>01708 {
<a name="l01709"></a>01709   <span class="keywordtype">int</span> within_current_scope;
<a name="l01710"></a>01710   <span class="keyword">struct </span><a class="code" href="structframe__id.html">frame_id</a> saved_frame_id;
<a name="l01711"></a>01711   <span class="keywordtype">int</span> frame_saved;
<a name="l01712"></a>01712 
<a name="l01713"></a>01713   <span class="comment">/* If this is a local watchpoint, we only want to check if the</span>
<a name="l01714"></a>01714 <span class="comment">     watchpoint frame is in scope if the current thread is the thread</span>
<a name="l01715"></a>01715 <span class="comment">     that was used to create the watchpoint.  */</span>
<a name="l01716"></a>01716   <span class="keywordflow">if</span> (!watchpoint_in_thread_scope (b))
<a name="l01717"></a>01717     <span class="keywordflow">return</span>;
<a name="l01718"></a>01718 
<a name="l01719"></a>01719   <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structwatchpoint.html#a01b7a13518becdd7631c9d701b70cbd1">base</a>.<a class="code" href="structbreakpoint.html#a75f0f9a837eac292ab6e768e8d8f1bd7">disposition</a> == <a class="code" href="breakpoint_8h.html#a15f2bbd9012f59bc09d59feef0c15732a9b0a2ed54849261d15631bb5e654843b">disp_del_at_next_stop</a>)
<a name="l01720"></a>01720     <span class="keywordflow">return</span>;
<a name="l01721"></a>01721  
<a name="l01722"></a>01722   frame_saved = 0;
<a name="l01723"></a>01723 
<a name="l01724"></a>01724   <span class="comment">/* Determine if the watchpoint is within scope.  */</span>
<a name="l01725"></a>01725   <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structwatchpoint.html#ab553c881e6ca32b9ae05bf9baee18c63">exp_valid_block</a> == NULL)
<a name="l01726"></a>01726     within_current_scope = 1;
<a name="l01727"></a>01727   <span class="keywordflow">else</span>
<a name="l01728"></a>01728     {
<a name="l01729"></a>01729       <span class="keyword">struct </span>frame_info *fi = <a class="code" href="frame_8c.html#a5ab254510728049878a232ed1b889820">get_current_frame</a> ();
<a name="l01730"></a>01730       <span class="keyword">struct </span>gdbarch *frame_arch = <a class="code" href="frame_8c.html#ab44507b5655da44e522ed5857835ede7">get_frame_arch</a> (fi);
<a name="l01731"></a>01731       <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> frame_pc = <a class="code" href="frame_8c.html#a27aafb00e05cba145dfba0e4bc7b1d70">get_frame_pc</a> (fi);
<a name="l01732"></a>01732 
<a name="l01733"></a>01733       <span class="comment">/* If we&#39;re in a function epilogue, unwinding may not work</span>
<a name="l01734"></a>01734 <span class="comment">         properly, so do not attempt to recreate locations at this</span>
<a name="l01735"></a>01735 <span class="comment">         point.  See similar comments in watchpoint_check.  */</span>
<a name="l01736"></a>01736       <span class="keywordflow">if</span> (<a class="code" href="gdbarch_8c.html#a294342b0ab88e8ff11e0628d23e2d444">gdbarch_in_function_epilogue_p</a> (frame_arch, frame_pc))
<a name="l01737"></a>01737         <span class="keywordflow">return</span>;
<a name="l01738"></a>01738 
<a name="l01739"></a>01739       <span class="comment">/* Save the current frame&#39;s ID so we can restore it after</span>
<a name="l01740"></a>01740 <span class="comment">         evaluating the watchpoint expression on its own frame.  */</span>
<a name="l01741"></a>01741       <span class="comment">/* FIXME drow/2003-09-09: It would be nice if evaluate_expression</span>
<a name="l01742"></a>01742 <span class="comment">         took a frame parameter, so that we didn&#39;t have to change the</span>
<a name="l01743"></a>01743 <span class="comment">         selected frame.  */</span>
<a name="l01744"></a>01744       frame_saved = 1;
<a name="l01745"></a>01745       saved_frame_id = <a class="code" href="frame_8c.html#a4d69effe10c03fa7c702d490081012bf">get_frame_id</a> (<a class="code" href="frame_8c.html#a8b714a78478670e14a297eba8d1a9915">get_selected_frame</a> (NULL));
<a name="l01746"></a>01746 
<a name="l01747"></a>01747       fi = <a class="code" href="frame_8c.html#a09616280d1811c8f06c46e26a8e07960">frame_find_by_id</a> (b-&gt;<a class="code" href="structwatchpoint.html#a4be20e56c1fa9de45dece05f164c1060">watchpoint_frame</a>);
<a name="l01748"></a>01748       within_current_scope = (fi != NULL);
<a name="l01749"></a>01749       <span class="keywordflow">if</span> (within_current_scope)
<a name="l01750"></a>01750         <a class="code" href="frame_8c.html#a400fa273ac86863322cdc65683ef2356">select_frame</a> (fi);
<a name="l01751"></a>01751     }
<a name="l01752"></a>01752 
<a name="l01753"></a>01753   <span class="comment">/* We don&#39;t free locations.  They are stored in the bp_location array</span>
<a name="l01754"></a>01754 <span class="comment">     and update_global_location_list will eventually delete them and</span>
<a name="l01755"></a>01755 <span class="comment">     remove breakpoints if needed.  */</span>
<a name="l01756"></a>01756   b-&gt;<a class="code" href="structwatchpoint.html#a01b7a13518becdd7631c9d701b70cbd1">base</a>.<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a> = NULL;
<a name="l01757"></a>01757 
<a name="l01758"></a>01758   <span class="keywordflow">if</span> (within_current_scope &amp;&amp; reparse)
<a name="l01759"></a>01759     {
<a name="l01760"></a>01760       <span class="keyword">const</span> <span class="keywordtype">char</span> *s;
<a name="l01761"></a>01761 
<a name="l01762"></a>01762       <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structwatchpoint.html#a10a51823c12ea43c95d767fb3a65d982">exp</a>)
<a name="l01763"></a>01763         {
<a name="l01764"></a>01764           <a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a> (b-&gt;<a class="code" href="structwatchpoint.html#a10a51823c12ea43c95d767fb3a65d982">exp</a>);
<a name="l01765"></a>01765           b-&gt;<a class="code" href="structwatchpoint.html#a10a51823c12ea43c95d767fb3a65d982">exp</a> = NULL;
<a name="l01766"></a>01766         }
<a name="l01767"></a>01767       s = b-&gt;<a class="code" href="structwatchpoint.html#a7e2fef584a035e0ea43d84b579946ed3">exp_string_reparse</a> ? b-&gt;<a class="code" href="structwatchpoint.html#a7e2fef584a035e0ea43d84b579946ed3">exp_string_reparse</a> : b-&gt;<a class="code" href="structwatchpoint.html#a1464eddbdf2f6d8d6dff4a61097c8dc8">exp_string</a>;
<a name="l01768"></a>01768       b-&gt;<a class="code" href="structwatchpoint.html#a10a51823c12ea43c95d767fb3a65d982">exp</a> = <a class="code" href="expression_8h.html#abdad295cc4b5351f6e6ec024ab665475">parse_exp_1</a> (&amp;s, 0, b-&gt;<a class="code" href="structwatchpoint.html#ab553c881e6ca32b9ae05bf9baee18c63">exp_valid_block</a>, 0);
<a name="l01769"></a>01769       <span class="comment">/* If the meaning of expression itself changed, the old value is</span>
<a name="l01770"></a>01770 <span class="comment">         no longer relevant.  We don&#39;t want to report a watchpoint hit</span>
<a name="l01771"></a>01771 <span class="comment">         to the user when the old value and the new value may actually</span>
<a name="l01772"></a>01772 <span class="comment">         be completely different objects.  */</span>
<a name="l01773"></a>01773       <a class="code" href="value_8c.html#a1f9b3ee232ece65ddc75c2407b97a50d">value_free</a> (b-&gt;<a class="code" href="structwatchpoint.html#afafe9b6d8ed19e6c10764499cb35a7d1">val</a>);
<a name="l01774"></a>01774       b-&gt;<a class="code" href="structwatchpoint.html#afafe9b6d8ed19e6c10764499cb35a7d1">val</a> = NULL;
<a name="l01775"></a>01775       b-&gt;<a class="code" href="structwatchpoint.html#ab2e6ea6495c9663c86652b00af5bea1d">val_valid</a> = 0;
<a name="l01776"></a>01776 
<a name="l01777"></a>01777       <span class="comment">/* Note that unlike with breakpoints, the watchpoint&#39;s condition</span>
<a name="l01778"></a>01778 <span class="comment">         expression is stored in the breakpoint object, not in the</span>
<a name="l01779"></a>01779 <span class="comment">         locations (re)created below.  */</span>
<a name="l01780"></a>01780       <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structwatchpoint.html#a01b7a13518becdd7631c9d701b70cbd1">base</a>.<a class="code" href="structbreakpoint.html#a817904eee4ded1a9e18ab46709c1245b">cond_string</a> != NULL)
<a name="l01781"></a>01781         {
<a name="l01782"></a>01782           <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structwatchpoint.html#af56cdd0c2d7782c70177feb9b0d9e676">cond_exp</a> != NULL)
<a name="l01783"></a>01783             {
<a name="l01784"></a>01784               <a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a> (b-&gt;<a class="code" href="structwatchpoint.html#af56cdd0c2d7782c70177feb9b0d9e676">cond_exp</a>);
<a name="l01785"></a>01785               b-&gt;<a class="code" href="structwatchpoint.html#af56cdd0c2d7782c70177feb9b0d9e676">cond_exp</a> = NULL;
<a name="l01786"></a>01786             }
<a name="l01787"></a>01787 
<a name="l01788"></a>01788           s = b-&gt;<a class="code" href="structwatchpoint.html#a01b7a13518becdd7631c9d701b70cbd1">base</a>.<a class="code" href="structbreakpoint.html#a817904eee4ded1a9e18ab46709c1245b">cond_string</a>;
<a name="l01789"></a>01789           b-&gt;<a class="code" href="structwatchpoint.html#af56cdd0c2d7782c70177feb9b0d9e676">cond_exp</a> = <a class="code" href="expression_8h.html#abdad295cc4b5351f6e6ec024ab665475">parse_exp_1</a> (&amp;s, 0, b-&gt;<a class="code" href="structwatchpoint.html#a8efc24adb7be3137ae593d26cb22436f">cond_exp_valid_block</a>, 0);
<a name="l01790"></a>01790         }
<a name="l01791"></a>01791     }
<a name="l01792"></a>01792 
<a name="l01793"></a>01793   <span class="comment">/* If we failed to parse the expression, for example because</span>
<a name="l01794"></a>01794 <span class="comment">     it refers to a global variable in a not-yet-loaded shared library,</span>
<a name="l01795"></a>01795 <span class="comment">     don&#39;t try to insert watchpoint.  We don&#39;t automatically delete</span>
<a name="l01796"></a>01796 <span class="comment">     such watchpoint, though, since failure to parse expression</span>
<a name="l01797"></a>01797 <span class="comment">     is different from out-of-scope watchpoint.  */</span>
<a name="l01798"></a>01798   <span class="keywordflow">if</span> ( !<a class="code" href="target_8h.html#a85885df22f7c1304269eaba1e1d618b7">target_has_execution</a>)
<a name="l01799"></a>01799     {
<a name="l01800"></a>01800       <span class="comment">/* Without execution, memory can&#39;t change.  No use to try and</span>
<a name="l01801"></a>01801 <span class="comment">         set watchpoint locations.  The watchpoint will be reset when</span>
<a name="l01802"></a>01802 <span class="comment">         the target gains execution, through breakpoint_re_set.  */</span>
<a name="l01803"></a>01803     }
<a name="l01804"></a>01804   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (within_current_scope &amp;&amp; b-&gt;<a class="code" href="structwatchpoint.html#a10a51823c12ea43c95d767fb3a65d982">exp</a>)
<a name="l01805"></a>01805     {
<a name="l01806"></a>01806       <span class="keywordtype">int</span> pc = 0;
<a name="l01807"></a>01807       <span class="keyword">struct </span>value *val_chain, *v, *result, *next;
<a name="l01808"></a>01808       <span class="keyword">struct </span><a class="code" href="structprogram__space.html">program_space</a> *frame_pspace;
<a name="l01809"></a>01809 
<a name="l01810"></a>01810       <a class="code" href="eval_8c.html#a0f904e0082858aca1865f842481e67b3">fetch_subexp_value</a> (b-&gt;<a class="code" href="structwatchpoint.html#a10a51823c12ea43c95d767fb3a65d982">exp</a>, &amp;pc, &amp;v, &amp;result, &amp;val_chain, 0);
<a name="l01811"></a>01811 
<a name="l01812"></a>01812       <span class="comment">/* Avoid setting b-&gt;val if it&#39;s already set.  The meaning of</span>
<a name="l01813"></a>01813 <span class="comment">         b-&gt;val is &#39;the last value&#39; user saw, and we should update</span>
<a name="l01814"></a>01814 <span class="comment">         it only if we reported that last value to user.  As it</span>
<a name="l01815"></a>01815 <span class="comment">         happens, the code that reports it updates b-&gt;val directly.</span>
<a name="l01816"></a>01816 <span class="comment">         We don&#39;t keep track of the memory value for masked</span>
<a name="l01817"></a>01817 <span class="comment">         watchpoints.  */</span>
<a name="l01818"></a>01818       <span class="keywordflow">if</span> (!b-&gt;<a class="code" href="structwatchpoint.html#ab2e6ea6495c9663c86652b00af5bea1d">val_valid</a> &amp;&amp; !is_masked_watchpoint (&amp;b-&gt;<a class="code" href="structwatchpoint.html#a01b7a13518becdd7631c9d701b70cbd1">base</a>))
<a name="l01819"></a>01819         {
<a name="l01820"></a>01820           b-&gt;<a class="code" href="structwatchpoint.html#afafe9b6d8ed19e6c10764499cb35a7d1">val</a> = v;
<a name="l01821"></a>01821           b-&gt;<a class="code" href="structwatchpoint.html#ab2e6ea6495c9663c86652b00af5bea1d">val_valid</a> = 1;
<a name="l01822"></a>01822         }
<a name="l01823"></a>01823 
<a name="l01824"></a>01824       frame_pspace = <a class="code" href="frame_8c.html#a6f51a6f34937e7139176ab67b404076d">get_frame_program_space</a> (<a class="code" href="frame_8c.html#a8b714a78478670e14a297eba8d1a9915">get_selected_frame</a> (NULL));
<a name="l01825"></a>01825 
<a name="l01826"></a>01826       <span class="comment">/* Look at each value on the value chain.  */</span>
<a name="l01827"></a>01827       <span class="keywordflow">for</span> (v = val_chain; v; v = <a class="code" href="value_8c.html#aeeff72ffd5db1d14bf0d7534da4ed624">value_next</a> (v))
<a name="l01828"></a>01828         {
<a name="l01829"></a>01829           <span class="comment">/* If it&#39;s a memory location, and GDB actually needed</span>
<a name="l01830"></a>01830 <span class="comment">             its contents to evaluate the expression, then we</span>
<a name="l01831"></a>01831 <span class="comment">             must watch it.  If the first value returned is</span>
<a name="l01832"></a>01832 <span class="comment">             still lazy, that means an error occurred reading it;</span>
<a name="l01833"></a>01833 <span class="comment">             watch it anyway in case it becomes readable.  */</span>
<a name="l01834"></a>01834           <span class="keywordflow">if</span> (<a class="code" href="value_8h.html#a39f15e604dd7037545ce2774310b0cd5">VALUE_LVAL</a> (v) == <a class="code" href="defs_8h.html#aae40e9877f56980bf8fac75923a098aba04e4ffc3d93e9a0cdec974596a72c17e">lval_memory</a>
<a name="l01835"></a>01835               &amp;&amp; (v == val_chain || ! <a class="code" href="value_8c.html#aa60bc8ecf77867a2d16bec57a4ccf983">value_lazy</a> (v)))
<a name="l01836"></a>01836             {
<a name="l01837"></a>01837               <span class="keyword">struct </span>type *vtype = <a class="code" href="gdbtypes_8c.html#a0bf29d7521d8a8b8735b9a259e380386">check_typedef</a> (<a class="code" href="value_8c.html#a263a4c0bee0b0df41074b952d3c121d0">value_type</a> (v));
<a name="l01838"></a>01838 
<a name="l01839"></a>01839               <span class="comment">/* We only watch structs and arrays if user asked</span>
<a name="l01840"></a>01840 <span class="comment">                 for it explicitly, never if they just happen to</span>
<a name="l01841"></a>01841 <span class="comment">                 appear in the middle of some value chain.  */</span>
<a name="l01842"></a>01842               <span class="keywordflow">if</span> (v == result
<a name="l01843"></a>01843                   || (<a class="code" href="gdbtypes_8h.html#a9505f41c7012665947c6b4065ce190e1">TYPE_CODE</a> (vtype) != <a class="code" href="gdbtypes_8h.html#a90e2a0fddaa6afff6a0a489ff4da3462af3b3fc76f66c95e12946c0ef84409365">TYPE_CODE_STRUCT</a>
<a name="l01844"></a>01844                       &amp;&amp; <a class="code" href="gdbtypes_8h.html#a9505f41c7012665947c6b4065ce190e1">TYPE_CODE</a> (vtype) != <a class="code" href="gdbtypes_8h.html#a90e2a0fddaa6afff6a0a489ff4da3462a00c795b43d1a39f57d3e222385f14fc0">TYPE_CODE_ARRAY</a>))
<a name="l01845"></a>01845                 {
<a name="l01846"></a>01846                   <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> addr;
<a name="l01847"></a>01847                   <span class="keywordtype">int</span> type;
<a name="l01848"></a>01848                   <span class="keyword">struct </span>bp_location *loc, **tmp;
<a name="l01849"></a>01849 
<a name="l01850"></a>01850                   addr = <a class="code" href="value_8c.html#a64c795fa1a8854682b3b727025d0d31d">value_address</a> (v);
<a name="l01851"></a>01851                   type = <a class="code" href="break-common_8h.html#ae1f701210980578c2ab1bc4ae89e69f3a7948cdb19d0afe80f18ac82ef466e07e">hw_write</a>;
<a name="l01852"></a>01852                   <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structwatchpoint.html#a01b7a13518becdd7631c9d701b70cbd1">base</a>.<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa7013ee22be60f470b10b2de2f9d22c21">bp_read_watchpoint</a>)
<a name="l01853"></a>01853                     type = <a class="code" href="break-common_8h.html#ae1f701210980578c2ab1bc4ae89e69f3afb52ba78eb7679d11a25bd2c44eb0606">hw_read</a>;
<a name="l01854"></a>01854                   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structwatchpoint.html#a01b7a13518becdd7631c9d701b70cbd1">base</a>.<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa9148c330e0f813ed6fb421af9d7da820">bp_access_watchpoint</a>)
<a name="l01855"></a>01855                     type = <a class="code" href="break-common_8h.html#ae1f701210980578c2ab1bc4ae89e69f3a8bef3f5dcfc5f1c5b482627a8ddf5736">hw_access</a>;
<a name="l01856"></a>01856 
<a name="l01857"></a>01857                   loc = allocate_bp_location (&amp;b-&gt;<a class="code" href="structwatchpoint.html#a01b7a13518becdd7631c9d701b70cbd1">base</a>);
<a name="l01858"></a>01858                   <span class="keywordflow">for</span> (tmp = &amp;(b-&gt;<a class="code" href="structwatchpoint.html#a01b7a13518becdd7631c9d701b70cbd1">base</a>.<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>); *tmp != NULL; tmp = &amp;((*tmp)-&gt;next))
<a name="l01859"></a>01859                     ;
<a name="l01860"></a>01860                   *tmp = loc;
<a name="l01861"></a>01861                   loc-&gt;<a class="code" href="structbp__location.html#a55f3ff99d536775f5095f11e5f5c3f3e">gdbarch</a> = <a class="code" href="gdbtypes_8c.html#a84ca61a6d58c2bd2c7dcedf19d56a39d">get_type_arch</a> (<a class="code" href="value_8c.html#a263a4c0bee0b0df41074b952d3c121d0">value_type</a> (v));
<a name="l01862"></a>01862 
<a name="l01863"></a>01863                   loc-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a> = frame_pspace;
<a name="l01864"></a>01864                   loc-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a> = addr;
<a name="l01865"></a>01865                   loc-&gt;<a class="code" href="structbp__location.html#a3d4ad6914964554ca761607f9e8fab62">length</a> = <a class="code" href="gdbtypes_8h.html#aeac33f868e763780094aec8a2dcb9a1a">TYPE_LENGTH</a> (<a class="code" href="value_8c.html#a263a4c0bee0b0df41074b952d3c121d0">value_type</a> (v));
<a name="l01866"></a>01866                   loc-&gt;<a class="code" href="structbp__location.html#a0480880dc590f47b72d7af91ab5d5802">watchpoint_type</a> = type;
<a name="l01867"></a>01867                 }
<a name="l01868"></a>01868             }
<a name="l01869"></a>01869         }
<a name="l01870"></a>01870 
<a name="l01871"></a>01871       <span class="comment">/* Change the type of breakpoint between hardware assisted or</span>
<a name="l01872"></a>01872 <span class="comment">         an ordinary watchpoint depending on the hardware support</span>
<a name="l01873"></a>01873 <span class="comment">         and free hardware slots.  REPARSE is set when the inferior</span>
<a name="l01874"></a>01874 <span class="comment">         is started.  */</span>
<a name="l01875"></a>01875       <span class="keywordflow">if</span> (reparse)
<a name="l01876"></a>01876         {
<a name="l01877"></a>01877           <span class="keywordtype">int</span> reg_cnt;
<a name="l01878"></a>01878           <span class="keyword">enum</span> <a class="code" href="breakpoint_8h.html#ad7006ab95a9d2493c6ad2c685f45f5dc">bp_loc_type</a> <a class="code" href="structbp__location.html#aefe49818487e5876fc995f7831e2e809">loc_type</a>;
<a name="l01879"></a>01879           <span class="keyword">struct </span>bp_location *bl;
<a name="l01880"></a>01880 
<a name="l01881"></a>01881           reg_cnt = can_use_hardware_watchpoint (val_chain);
<a name="l01882"></a>01882 
<a name="l01883"></a>01883           <span class="keywordflow">if</span> (reg_cnt)
<a name="l01884"></a>01884             {
<a name="l01885"></a>01885               <span class="keywordtype">int</span> i, target_resources_ok, other_type_used;
<a name="l01886"></a>01886               <span class="keyword">enum</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cf">bptype</a> type;
<a name="l01887"></a>01887 
<a name="l01888"></a>01888               <span class="comment">/* Use an exact watchpoint when there&#39;s only one memory region to be</span>
<a name="l01889"></a>01889 <span class="comment">                 watched, and only one debug register is needed to watch it.  */</span>
<a name="l01890"></a>01890               b-&gt;<a class="code" href="structwatchpoint.html#a2fc9d822f077ae06bdfd6fa2aca9a255">exact</a> = target_exact_watchpoints &amp;&amp; reg_cnt == 1;
<a name="l01891"></a>01891 
<a name="l01892"></a>01892               <span class="comment">/* We need to determine how many resources are already</span>
<a name="l01893"></a>01893 <span class="comment">                 used for all other hardware watchpoints plus this one</span>
<a name="l01894"></a>01894 <span class="comment">                 to see if we still have enough resources to also fit</span>
<a name="l01895"></a>01895 <span class="comment">                 this watchpoint in as well.  */</span>
<a name="l01896"></a>01896 
<a name="l01897"></a>01897               <span class="comment">/* If this is a software watchpoint, we try to turn it</span>
<a name="l01898"></a>01898 <span class="comment">                 to a hardware one -- count resources as if B was of</span>
<a name="l01899"></a>01899 <span class="comment">                 hardware watchpoint type.  */</span>
<a name="l01900"></a>01900               type = b-&gt;<a class="code" href="structwatchpoint.html#a01b7a13518becdd7631c9d701b70cbd1">base</a>.<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a>;
<a name="l01901"></a>01901               <span class="keywordflow">if</span> (type == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa2a35cc5d65b66d6228def5615d6827ce">bp_watchpoint</a>)
<a name="l01902"></a>01902                 type = <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfae38a33f5a6725fbca8b5da2d491cfbcb">bp_hardware_watchpoint</a>;
<a name="l01903"></a>01903 
<a name="l01904"></a>01904               <span class="comment">/* This watchpoint may or may not have been placed on</span>
<a name="l01905"></a>01905 <span class="comment">                 the list yet at this point (it won&#39;t be in the list</span>
<a name="l01906"></a>01906 <span class="comment">                 if we&#39;re trying to create it for the first time,</span>
<a name="l01907"></a>01907 <span class="comment">                 through watch_command), so always account for it</span>
<a name="l01908"></a>01908 <span class="comment">                 manually.  */</span>
<a name="l01909"></a>01909 
<a name="l01910"></a>01910               <span class="comment">/* Count resources used by all watchpoints except B.  */</span>
<a name="l01911"></a>01911               i = hw_watchpoint_used_count_others (&amp;b-&gt;<a class="code" href="structwatchpoint.html#a01b7a13518becdd7631c9d701b70cbd1">base</a>, type, &amp;other_type_used);
<a name="l01912"></a>01912 
<a name="l01913"></a>01913               <span class="comment">/* Add in the resources needed for B.  */</span>
<a name="l01914"></a>01914               i += hw_watchpoint_use_count (&amp;b-&gt;<a class="code" href="structwatchpoint.html#a01b7a13518becdd7631c9d701b70cbd1">base</a>);
<a name="l01915"></a>01915 
<a name="l01916"></a>01916               target_resources_ok
<a name="l01917"></a>01917                 = <a class="code" href="target_8h.html#a426728386dc9c2a6d50a7a20e90fe13b">target_can_use_hardware_watchpoint</a> (type, i, other_type_used);
<a name="l01918"></a>01918               <span class="keywordflow">if</span> (target_resources_ok &lt;= 0)
<a name="l01919"></a>01919                 {
<a name="l01920"></a>01920                   <span class="keywordtype">int</span> sw_mode = b-&gt;<a class="code" href="structwatchpoint.html#a01b7a13518becdd7631c9d701b70cbd1">base</a>.<a class="code" href="structbreakpoint.html#aba258aa23496f6434aaa1cf8c8dc7ea7">ops</a>-&gt;<a class="code" href="structbreakpoint__ops.html#a733bd8f4226e832bf9992b3352e0e8b5">works_in_software_mode</a> (&amp;b-&gt;<a class="code" href="structwatchpoint.html#a01b7a13518becdd7631c9d701b70cbd1">base</a>);
<a name="l01921"></a>01921 
<a name="l01922"></a>01922                   <span class="keywordflow">if</span> (target_resources_ok == 0 &amp;&amp; !sw_mode)
<a name="l01923"></a>01923                     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Target does not support this type of &quot;</span>
<a name="l01924"></a>01924                              <span class="stringliteral">&quot;hardware watchpoint.&quot;</span>));
<a name="l01925"></a>01925                   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (target_resources_ok &lt; 0 &amp;&amp; !sw_mode)
<a name="l01926"></a>01926                     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;There are not enough available hardware &quot;</span>
<a name="l01927"></a>01927                              <span class="stringliteral">&quot;resources for this watchpoint.&quot;</span>));
<a name="l01928"></a>01928 
<a name="l01929"></a>01929                   <span class="comment">/* Downgrade to software watchpoint.  */</span>
<a name="l01930"></a>01930                   b-&gt;<a class="code" href="structwatchpoint.html#a01b7a13518becdd7631c9d701b70cbd1">base</a>.<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> = <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa2a35cc5d65b66d6228def5615d6827ce">bp_watchpoint</a>;
<a name="l01931"></a>01931                 }
<a name="l01932"></a>01932               <span class="keywordflow">else</span>
<a name="l01933"></a>01933                 {
<a name="l01934"></a>01934                   <span class="comment">/* If this was a software watchpoint, we&#39;ve just</span>
<a name="l01935"></a>01935 <span class="comment">                     found we have enough resources to turn it to a</span>
<a name="l01936"></a>01936 <span class="comment">                     hardware watchpoint.  Otherwise, this is a</span>
<a name="l01937"></a>01937 <span class="comment">                     nop.  */</span>
<a name="l01938"></a>01938                   b-&gt;<a class="code" href="structwatchpoint.html#a01b7a13518becdd7631c9d701b70cbd1">base</a>.<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> = type;
<a name="l01939"></a>01939                 }
<a name="l01940"></a>01940             }
<a name="l01941"></a>01941           <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!b-&gt;<a class="code" href="structwatchpoint.html#a01b7a13518becdd7631c9d701b70cbd1">base</a>.<a class="code" href="structbreakpoint.html#aba258aa23496f6434aaa1cf8c8dc7ea7">ops</a>-&gt;<a class="code" href="structbreakpoint__ops.html#a733bd8f4226e832bf9992b3352e0e8b5">works_in_software_mode</a> (&amp;b-&gt;<a class="code" href="structwatchpoint.html#a01b7a13518becdd7631c9d701b70cbd1">base</a>))
<a name="l01942"></a>01942             <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Expression cannot be implemented with &quot;</span>
<a name="l01943"></a>01943                      <span class="stringliteral">&quot;read/access watchpoint.&quot;</span>));
<a name="l01944"></a>01944           <span class="keywordflow">else</span>
<a name="l01945"></a>01945             b-&gt;<a class="code" href="structwatchpoint.html#a01b7a13518becdd7631c9d701b70cbd1">base</a>.<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> = <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa2a35cc5d65b66d6228def5615d6827ce">bp_watchpoint</a>;
<a name="l01946"></a>01946 
<a name="l01947"></a>01947           loc_type = (b-&gt;<a class="code" href="structwatchpoint.html#a01b7a13518becdd7631c9d701b70cbd1">base</a>.<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa2a35cc5d65b66d6228def5615d6827ce">bp_watchpoint</a>? <a class="code" href="breakpoint_8h.html#ad7006ab95a9d2493c6ad2c685f45f5dca7e299c37c01da7ced4469575ef811ee2">bp_loc_other</a>
<a name="l01948"></a>01948                       : <a class="code" href="breakpoint_8h.html#ad7006ab95a9d2493c6ad2c685f45f5dcaf30d35565c228c0d80de4d7af9d9fbd2">bp_loc_hardware_watchpoint</a>);
<a name="l01949"></a>01949           <span class="keywordflow">for</span> (bl = b-&gt;<a class="code" href="structwatchpoint.html#a01b7a13518becdd7631c9d701b70cbd1">base</a>.<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>; bl; bl = bl-&gt;<a class="code" href="structbp__location.html#ab193cb38f87fea89105db96d94191541">next</a>)
<a name="l01950"></a>01950             bl-&gt;<a class="code" href="structbp__location.html#aefe49818487e5876fc995f7831e2e809">loc_type</a> = <a class="code" href="structbp__location.html#aefe49818487e5876fc995f7831e2e809">loc_type</a>;
<a name="l01951"></a>01951         }
<a name="l01952"></a>01952 
<a name="l01953"></a>01953       <span class="keywordflow">for</span> (v = val_chain; v; v = <a class="code" href="structbp__location.html#ab193cb38f87fea89105db96d94191541">next</a>)
<a name="l01954"></a>01954         {
<a name="l01955"></a>01955           next = <a class="code" href="value_8c.html#aeeff72ffd5db1d14bf0d7534da4ed624">value_next</a> (v);
<a name="l01956"></a>01956           <span class="keywordflow">if</span> (v != b-&gt;<a class="code" href="structwatchpoint.html#afafe9b6d8ed19e6c10764499cb35a7d1">val</a>)
<a name="l01957"></a>01957             <a class="code" href="value_8c.html#a1f9b3ee232ece65ddc75c2407b97a50d">value_free</a> (v);
<a name="l01958"></a>01958         }
<a name="l01959"></a>01959 
<a name="l01960"></a>01960       <span class="comment">/* If a software watchpoint is not watching any memory, then the</span>
<a name="l01961"></a>01961 <span class="comment">         above left it without any location set up.  But,</span>
<a name="l01962"></a>01962 <span class="comment">         bpstat_stop_status requires a location to be able to report</span>
<a name="l01963"></a>01963 <span class="comment">         stops, so make sure there&#39;s at least a dummy one.  */</span>
<a name="l01964"></a>01964       <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structwatchpoint.html#a01b7a13518becdd7631c9d701b70cbd1">base</a>.<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa2a35cc5d65b66d6228def5615d6827ce">bp_watchpoint</a> &amp;&amp; b-&gt;<a class="code" href="structwatchpoint.html#a01b7a13518becdd7631c9d701b70cbd1">base</a>.<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a> == NULL)
<a name="l01965"></a>01965         {
<a name="l01966"></a>01966           <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *base = &amp;b-&gt;<a class="code" href="structwatchpoint.html#a01b7a13518becdd7631c9d701b70cbd1">base</a>;
<a name="l01967"></a>01967           base-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a> = allocate_bp_location (base);
<a name="l01968"></a>01968           base-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a> = frame_pspace;
<a name="l01969"></a>01969           base-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a> = -1;
<a name="l01970"></a>01970           base-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>-&gt;<a class="code" href="structbp__location.html#a3d4ad6914964554ca761607f9e8fab62">length</a> = -1;
<a name="l01971"></a>01971           base-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>-&gt;<a class="code" href="structbp__location.html#a0480880dc590f47b72d7af91ab5d5802">watchpoint_type</a> = -1;
<a name="l01972"></a>01972         }
<a name="l01973"></a>01973     }
<a name="l01974"></a>01974   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!within_current_scope)
<a name="l01975"></a>01975     {
<a name="l01976"></a>01976       <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l01977"></a>01977 <span class="stringliteral">Watchpoint %d deleted because the program has left the block\n\</span>
<a name="l01978"></a>01978 <span class="stringliteral">in which its expression is valid.\n&quot;</span>),
<a name="l01979"></a>01979                        b-&gt;<a class="code" href="structwatchpoint.html#a01b7a13518becdd7631c9d701b70cbd1">base</a>.<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>);
<a name="l01980"></a>01980       watchpoint_del_at_next_stop (b);
<a name="l01981"></a>01981     }
<a name="l01982"></a>01982 
<a name="l01983"></a>01983   <span class="comment">/* Restore the selected frame.  */</span>
<a name="l01984"></a>01984   <span class="keywordflow">if</span> (frame_saved)
<a name="l01985"></a>01985     <a class="code" href="frame_8c.html#a400fa273ac86863322cdc65683ef2356">select_frame</a> (<a class="code" href="frame_8c.html#a09616280d1811c8f06c46e26a8e07960">frame_find_by_id</a> (saved_frame_id));
<a name="l01986"></a>01986 }
<a name="l01987"></a>01987 
<a name="l01988"></a>01988 
<a name="l01989"></a>01989 <span class="comment">/* Returns 1 iff breakpoint location should be</span>
<a name="l01990"></a>01990 <span class="comment">   inserted in the inferior.  We don&#39;t differentiate the type of BL&#39;s owner</span>
<a name="l01991"></a>01991 <span class="comment">   (breakpoint vs. tracepoint), although insert_location in tracepoint&#39;s</span>
<a name="l01992"></a>01992 <span class="comment">   breakpoint_ops is not defined, because in insert_bp_location,</span>
<a name="l01993"></a>01993 <span class="comment">   tracepoint&#39;s insert_location will not be called.  */</span>
<a name="l01994"></a>01994 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l01995"></a>01995 should_be_inserted (<span class="keyword">struct</span> bp_location *bl)
<a name="l01996"></a>01996 {
<a name="l01997"></a>01997   <span class="keywordflow">if</span> (bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a> == NULL || !breakpoint_enabled (bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>))
<a name="l01998"></a>01998     <span class="keywordflow">return</span> 0;
<a name="l01999"></a>01999 
<a name="l02000"></a>02000   <span class="keywordflow">if</span> (bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#a75f0f9a837eac292ab6e768e8d8f1bd7">disposition</a> == <a class="code" href="breakpoint_8h.html#a15f2bbd9012f59bc09d59feef0c15732a9b0a2ed54849261d15631bb5e654843b">disp_del_at_next_stop</a>)
<a name="l02001"></a>02001     <span class="keywordflow">return</span> 0;
<a name="l02002"></a>02002 
<a name="l02003"></a>02003   <span class="keywordflow">if</span> (!bl-&gt;<a class="code" href="structbp__location.html#abe93e091d18373d27bda3ad3eb6316f8">enabled</a> || bl-&gt;<a class="code" href="structbp__location.html#a3732b41958ed311106bffd202cbfe4ff">shlib_disabled</a> || bl-&gt;<a class="code" href="structbp__location.html#a1d15bb8313f27fdcdd035bedcfd89199">duplicate</a>)
<a name="l02004"></a>02004     <span class="keywordflow">return</span> 0;
<a name="l02005"></a>02005 
<a name="l02006"></a>02006   <span class="keywordflow">if</span> (<a class="code" href="breakpoint_8c.html#ac7893fb93c9f1d907b89a1655481602d">user_breakpoint_p</a> (bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>) &amp;&amp; bl-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a>-&gt;<a class="code" href="structprogram__space.html#a66c8a669a715e0f3c717bf0fd8951724">executing_startup</a>)
<a name="l02007"></a>02007     <span class="keywordflow">return</span> 0;
<a name="l02008"></a>02008 
<a name="l02009"></a>02009   <span class="comment">/* This is set for example, when we&#39;re attached to the parent of a</span>
<a name="l02010"></a>02010 <span class="comment">     vfork, and have detached from the child.  The child is running</span>
<a name="l02011"></a>02011 <span class="comment">     free, and we expect it to do an exec or exit, at which point the</span>
<a name="l02012"></a>02012 <span class="comment">     OS makes the parent schedulable again (and the target reports</span>
<a name="l02013"></a>02013 <span class="comment">     that the vfork is done).  Until the child is done with the shared</span>
<a name="l02014"></a>02014 <span class="comment">     memory region, do not insert breakpoints in the parent, otherwise</span>
<a name="l02015"></a>02015 <span class="comment">     the child could still trip on the parent&#39;s breakpoints.  Since</span>
<a name="l02016"></a>02016 <span class="comment">     the parent is blocked anyway, it won&#39;t miss any breakpoint.  */</span>
<a name="l02017"></a>02017   <span class="keywordflow">if</span> (bl-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a>-&gt;<a class="code" href="structprogram__space.html#a91e073dfecbbb5aa77b5d054527bd2db">breakpoints_not_allowed</a>)
<a name="l02018"></a>02018     <span class="keywordflow">return</span> 0;
<a name="l02019"></a>02019 
<a name="l02020"></a>02020   <span class="keywordflow">return</span> 1;
<a name="l02021"></a>02021 }
<a name="l02022"></a>02022 
<a name="l02023"></a>02023 <span class="comment">/* Same as should_be_inserted but does the check assuming</span>
<a name="l02024"></a>02024 <span class="comment">   that the location is not duplicated.  */</span>
<a name="l02025"></a>02025 
<a name="l02026"></a>02026 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l02027"></a>02027 unduplicated_should_be_inserted (<span class="keyword">struct</span> bp_location *bl)
<a name="l02028"></a>02028 {
<a name="l02029"></a>02029   <span class="keywordtype">int</span> result;
<a name="l02030"></a>02030   <span class="keyword">const</span> <span class="keywordtype">int</span> save_duplicate = bl-&gt;<a class="code" href="structbp__location.html#a1d15bb8313f27fdcdd035bedcfd89199">duplicate</a>;
<a name="l02031"></a>02031 
<a name="l02032"></a>02032   bl-&gt;<a class="code" href="structbp__location.html#a1d15bb8313f27fdcdd035bedcfd89199">duplicate</a> = 0;
<a name="l02033"></a>02033   result = should_be_inserted (bl);
<a name="l02034"></a>02034   bl-&gt;<a class="code" href="structbp__location.html#a1d15bb8313f27fdcdd035bedcfd89199">duplicate</a> = save_duplicate;
<a name="l02035"></a>02035   <span class="keywordflow">return</span> result;
<a name="l02036"></a>02036 }
<a name="l02037"></a>02037 
<a name="l02038"></a>02038 <span class="comment">/* Parses a conditional described by an expression COND into an</span>
<a name="l02039"></a>02039 <span class="comment">   agent expression bytecode suitable for evaluation</span>
<a name="l02040"></a>02040 <span class="comment">   by the bytecode interpreter.  Return NULL if there was</span>
<a name="l02041"></a>02041 <span class="comment">   any error during parsing.  */</span>
<a name="l02042"></a>02042 
<a name="l02043"></a>02043 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structagent__expr.html">agent_expr</a> *
<a name="l02044"></a>02044 parse_cond_to_aexpr (<a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> <a class="code" href="structagent__expr.html#a42fde11ab8ed2348e58fe5a01bd06d1c">scope</a>, <span class="keyword">struct</span> <a class="code" href="structexpression.html">expression</a> *cond)
<a name="l02045"></a>02045 {
<a name="l02046"></a>02046   <span class="keyword">struct </span><a class="code" href="structagent__expr.html">agent_expr</a> *aexpr = NULL;
<a name="l02047"></a>02047   <span class="keyword">volatile</span> <span class="keyword">struct </span><a class="code" href="structgdb__exception.html">gdb_exception</a> ex;
<a name="l02048"></a>02048 
<a name="l02049"></a>02049   <span class="keywordflow">if</span> (!cond)
<a name="l02050"></a>02050     <span class="keywordflow">return</span> NULL;
<a name="l02051"></a>02051 
<a name="l02052"></a>02052   <span class="comment">/* We don&#39;t want to stop processing, so catch any errors</span>
<a name="l02053"></a>02053 <span class="comment">     that may show up.  */</span>
<a name="l02054"></a>02054   <a class="code" href="exceptions_8h.html#aef4514ee39b9305fddee27f49c7c34eb">TRY_CATCH</a> (ex, <a class="code" href="exceptions_8h.html#abfa3a3b99557b11f5766baf69465fdf6a44de51845416ac49ab08438792b908f0">RETURN_MASK_ERROR</a>)
<a name="l02055"></a>02055     {
<a name="l02056"></a>02056       aexpr = <a class="code" href="ax-gdb_8c.html#aa9b3b3364a9fd201c6c0f9a99a57da44">gen_eval_for_expr</a> (scope, cond);
<a name="l02057"></a>02057     }
<a name="l02058"></a>02058 
<a name="l02059"></a>02059   <span class="keywordflow">if</span> (ex.reason &lt; 0)
<a name="l02060"></a>02060     {
<a name="l02061"></a>02061       <span class="comment">/* If we got here, it means the condition could not be parsed to a valid</span>
<a name="l02062"></a>02062 <span class="comment">         bytecode expression and thus can&#39;t be evaluated on the target&#39;s side.</span>
<a name="l02063"></a>02063 <span class="comment">         It&#39;s no use iterating through the conditions.  */</span>
<a name="l02064"></a>02064       <span class="keywordflow">return</span> NULL;
<a name="l02065"></a>02065     }
<a name="l02066"></a>02066 
<a name="l02067"></a>02067   <span class="comment">/* We have a valid agent expression.  */</span>
<a name="l02068"></a>02068   <span class="keywordflow">return</span> aexpr;
<a name="l02069"></a>02069 }
<a name="l02070"></a>02070 
<a name="l02071"></a>02071 <span class="comment">/* Based on location BL, create a list of breakpoint conditions to be</span>
<a name="l02072"></a>02072 <span class="comment">   passed on to the target.  If we have duplicated locations with different</span>
<a name="l02073"></a>02073 <span class="comment">   conditions, we will add such conditions to the list.  The idea is that the</span>
<a name="l02074"></a>02074 <span class="comment">   target will evaluate the list of conditions and will only notify GDB when</span>
<a name="l02075"></a>02075 <span class="comment">   one of them is true.  */</span>
<a name="l02076"></a>02076 
<a name="l02077"></a>02077 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l02078"></a>02078 build_target_condition_list (<span class="keyword">struct</span> bp_location *bl)
<a name="l02079"></a>02079 {
<a name="l02080"></a>02080   <span class="keyword">struct </span>bp_location **locp = NULL, **loc2p;
<a name="l02081"></a>02081   <span class="keywordtype">int</span> null_condition_or_parse_error = 0;
<a name="l02082"></a>02082   <span class="keywordtype">int</span> modified = bl-&gt;<a class="code" href="structbp__location.html#a5bd9bf988af6d6e3d330fca3361a6a6b">needs_update</a>;
<a name="l02083"></a>02083   <span class="keyword">struct </span>bp_location *loc;
<a name="l02084"></a>02084 
<a name="l02085"></a>02085   <span class="comment">/* This is only meaningful if the target is</span>
<a name="l02086"></a>02086 <span class="comment">     evaluating conditions and if the user has</span>
<a name="l02087"></a>02087 <span class="comment">     opted for condition evaluation on the target&#39;s</span>
<a name="l02088"></a>02088 <span class="comment">     side.  */</span>
<a name="l02089"></a>02089   <span class="keywordflow">if</span> (gdb_evaluates_breakpoint_condition_p ()
<a name="l02090"></a>02090       || !<a class="code" href="target_8h.html#a029407c9baebfcab86e0488e2d75a2a0">target_supports_evaluation_of_breakpoint_conditions</a> ())
<a name="l02091"></a>02091     <span class="keywordflow">return</span>;
<a name="l02092"></a>02092 
<a name="l02093"></a>02093   <span class="comment">/* Do a first pass to check for locations with no assigned</span>
<a name="l02094"></a>02094 <span class="comment">     conditions or conditions that fail to parse to a valid agent expression</span>
<a name="l02095"></a>02095 <span class="comment">     bytecode.  If any of these happen, then it&#39;s no use to send conditions</span>
<a name="l02096"></a>02096 <span class="comment">     to the target since this location will always trigger and generate a</span>
<a name="l02097"></a>02097 <span class="comment">     response back to GDB.  */</span>
<a name="l02098"></a>02098   <a class="code" href="breakpoint_8c.html#af132e38cf4dda2bca037851da14a80bd">ALL_BP_LOCATIONS_AT_ADDR</a> (loc2p, locp, bl-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>)
<a name="l02099"></a>02099     {
<a name="l02100"></a>02100       loc = (*loc2p);
<a name="l02101"></a>02101       <span class="keywordflow">if</span> (<a class="code" href="breakpoint_8c.html#a5de9005cc5b36d1d327aa9127ea64f9c">is_breakpoint</a> (loc-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>) &amp;&amp; loc-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a>-&gt;<a class="code" href="structprogram__space.html#af030e0b6155dde239ce3c3379f8eac96">num</a> == bl-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a>-&gt;<a class="code" href="structprogram__space.html#af030e0b6155dde239ce3c3379f8eac96">num</a>)
<a name="l02102"></a>02102         {
<a name="l02103"></a>02103           <span class="keywordflow">if</span> (modified)
<a name="l02104"></a>02104             {
<a name="l02105"></a>02105               <span class="keyword">struct </span><a class="code" href="structagent__expr.html">agent_expr</a> *aexpr;
<a name="l02106"></a>02106 
<a name="l02107"></a>02107               <span class="comment">/* Re-parse the conditions since something changed.  In that</span>
<a name="l02108"></a>02108 <span class="comment">                 case we already freed the condition bytecodes (see</span>
<a name="l02109"></a>02109 <span class="comment">                 force_breakpoint_reinsertion).  We just</span>
<a name="l02110"></a>02110 <span class="comment">                 need to parse the condition to bytecodes again.  */</span>
<a name="l02111"></a>02111               aexpr = parse_cond_to_aexpr (bl-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>, loc-&gt;<a class="code" href="structbp__location.html#a1594433a0c3734e79b98d8296984ec7a">cond</a>);
<a name="l02112"></a>02112               loc-&gt;<a class="code" href="structbp__location.html#ae8f603085b6974cd8f01aef7a833e6e9">cond_bytecode</a> = aexpr;
<a name="l02113"></a>02113 
<a name="l02114"></a>02114               <span class="comment">/* Check if we managed to parse the conditional expression</span>
<a name="l02115"></a>02115 <span class="comment">                 correctly.  If not, we will not send this condition</span>
<a name="l02116"></a>02116 <span class="comment">                 to the target.  */</span>
<a name="l02117"></a>02117               <span class="keywordflow">if</span> (aexpr)
<a name="l02118"></a>02118                 <span class="keywordflow">continue</span>;
<a name="l02119"></a>02119             }
<a name="l02120"></a>02120 
<a name="l02121"></a>02121           <span class="comment">/* If we have a NULL bytecode expression, it means something</span>
<a name="l02122"></a>02122 <span class="comment">             went wrong or we have a null condition expression.  */</span>
<a name="l02123"></a>02123           <span class="keywordflow">if</span> (!loc-&gt;<a class="code" href="structbp__location.html#ae8f603085b6974cd8f01aef7a833e6e9">cond_bytecode</a>)
<a name="l02124"></a>02124             {
<a name="l02125"></a>02125               null_condition_or_parse_error = 1;
<a name="l02126"></a>02126               <span class="keywordflow">break</span>;
<a name="l02127"></a>02127             }
<a name="l02128"></a>02128         }
<a name="l02129"></a>02129     }
<a name="l02130"></a>02130 
<a name="l02131"></a>02131   <span class="comment">/* If any of these happened, it means we will have to evaluate the conditions</span>
<a name="l02132"></a>02132 <span class="comment">     for the location&#39;s address on gdb&#39;s side.  It is no use keeping bytecodes</span>
<a name="l02133"></a>02133 <span class="comment">     for all the other duplicate locations, thus we free all of them here.</span>
<a name="l02134"></a>02134 <span class="comment"></span>
<a name="l02135"></a>02135 <span class="comment">     This is so we have a finer control over which locations&#39; conditions are</span>
<a name="l02136"></a>02136 <span class="comment">     being evaluated by GDB or the remote stub.  */</span>
<a name="l02137"></a>02137   <span class="keywordflow">if</span> (null_condition_or_parse_error)
<a name="l02138"></a>02138     {
<a name="l02139"></a>02139       <a class="code" href="breakpoint_8c.html#af132e38cf4dda2bca037851da14a80bd">ALL_BP_LOCATIONS_AT_ADDR</a> (loc2p, locp, bl-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>)
<a name="l02140"></a>02140         {
<a name="l02141"></a>02141           loc = (*loc2p);
<a name="l02142"></a>02142           <span class="keywordflow">if</span> (<a class="code" href="breakpoint_8c.html#a5de9005cc5b36d1d327aa9127ea64f9c">is_breakpoint</a> (loc-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>) &amp;&amp; loc-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a>-&gt;<a class="code" href="structprogram__space.html#af030e0b6155dde239ce3c3379f8eac96">num</a> == bl-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a>-&gt;<a class="code" href="structprogram__space.html#af030e0b6155dde239ce3c3379f8eac96">num</a>)
<a name="l02143"></a>02143             {
<a name="l02144"></a>02144               <span class="comment">/* Only go as far as the first NULL bytecode is</span>
<a name="l02145"></a>02145 <span class="comment">                 located.  */</span>
<a name="l02146"></a>02146               <span class="keywordflow">if</span> (!loc-&gt;<a class="code" href="structbp__location.html#ae8f603085b6974cd8f01aef7a833e6e9">cond_bytecode</a>)
<a name="l02147"></a>02147                 <span class="keywordflow">return</span>;
<a name="l02148"></a>02148 
<a name="l02149"></a>02149               <a class="code" href="ax-general_8c.html#a212888d48dd043f9a37823fb799cd8e4">free_agent_expr</a> (loc-&gt;<a class="code" href="structbp__location.html#ae8f603085b6974cd8f01aef7a833e6e9">cond_bytecode</a>);
<a name="l02150"></a>02150               loc-&gt;<a class="code" href="structbp__location.html#ae8f603085b6974cd8f01aef7a833e6e9">cond_bytecode</a> = NULL;
<a name="l02151"></a>02151             }
<a name="l02152"></a>02152         }
<a name="l02153"></a>02153     }
<a name="l02154"></a>02154 
<a name="l02155"></a>02155   <span class="comment">/* No NULL conditions or failed bytecode generation.  Build a condition list</span>
<a name="l02156"></a>02156 <span class="comment">     for this location&#39;s address.  */</span>
<a name="l02157"></a>02157   <a class="code" href="breakpoint_8c.html#af132e38cf4dda2bca037851da14a80bd">ALL_BP_LOCATIONS_AT_ADDR</a> (loc2p, locp, bl-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>)
<a name="l02158"></a>02158     {
<a name="l02159"></a>02159       loc = (*loc2p);
<a name="l02160"></a>02160       <span class="keywordflow">if</span> (loc-&gt;<a class="code" href="structbp__location.html#a1594433a0c3734e79b98d8296984ec7a">cond</a>
<a name="l02161"></a>02161           &amp;&amp; <a class="code" href="breakpoint_8c.html#a5de9005cc5b36d1d327aa9127ea64f9c">is_breakpoint</a> (loc-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>)
<a name="l02162"></a>02162           &amp;&amp; loc-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a>-&gt;<a class="code" href="structprogram__space.html#af030e0b6155dde239ce3c3379f8eac96">num</a> == bl-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a>-&gt;<a class="code" href="structprogram__space.html#af030e0b6155dde239ce3c3379f8eac96">num</a>
<a name="l02163"></a>02163           &amp;&amp; loc-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#acb53352fd35aaad37054508fabc0f3bf">enable_state</a> == <a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577a72f1fa981d13a62d05324c1de974b44b">bp_enabled</a>
<a name="l02164"></a>02164           &amp;&amp; loc-&gt;<a class="code" href="structbp__location.html#abe93e091d18373d27bda3ad3eb6316f8">enabled</a>)
<a name="l02165"></a>02165         <span class="comment">/* Add the condition to the vector.  This will be used later to send the</span>
<a name="l02166"></a>02166 <span class="comment">           conditions to the target.  */</span>
<a name="l02167"></a>02167         <a class="code" href="vec_8h.html#a8d090c0524726d00931070e0c438ba3f">VEC_safe_push</a> (<a class="code" href="structagent__expr.html">agent_expr_p</a>, bl-&gt;<a class="code" href="structbp__location.html#a72be6a63cd025a9a040df0325fa507af">target_info</a>.conditions,
<a name="l02168"></a>02168                        loc-&gt;<a class="code" href="structbp__location.html#ae8f603085b6974cd8f01aef7a833e6e9">cond_bytecode</a>);
<a name="l02169"></a>02169     }
<a name="l02170"></a>02170 
<a name="l02171"></a>02171   <span class="keywordflow">return</span>;
<a name="l02172"></a>02172 }
<a name="l02173"></a>02173 
<a name="l02174"></a>02174 <span class="comment">/* Parses a command described by string CMD into an agent expression</span>
<a name="l02175"></a>02175 <span class="comment">   bytecode suitable for evaluation by the bytecode interpreter.</span>
<a name="l02176"></a>02176 <span class="comment">   Return NULL if there was any error during parsing.  */</span>
<a name="l02177"></a>02177 
<a name="l02178"></a>02178 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structagent__expr.html">agent_expr</a> *
<a name="l02179"></a>02179 parse_cmd_to_aexpr (<a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> scope, <span class="keywordtype">char</span> *cmd)
<a name="l02180"></a>02180 {
<a name="l02181"></a>02181   <span class="keyword">struct </span>cleanup *old_cleanups = 0;
<a name="l02182"></a>02182   <span class="keyword">struct </span><a class="code" href="structexpression.html">expression</a> *expr, **argvec;
<a name="l02183"></a>02183   <span class="keyword">struct </span><a class="code" href="structagent__expr.html">agent_expr</a> *aexpr = NULL;
<a name="l02184"></a>02184   <span class="keyword">volatile</span> <span class="keyword">struct </span><a class="code" href="structgdb__exception.html">gdb_exception</a> ex;
<a name="l02185"></a>02185   <span class="keyword">const</span> <span class="keywordtype">char</span> *cmdrest;
<a name="l02186"></a>02186   <span class="keyword">const</span> <span class="keywordtype">char</span> *format_start, *format_end;
<a name="l02187"></a>02187   <span class="keyword">struct </span><a class="code" href="structformat__piece.html">format_piece</a> *fpieces;
<a name="l02188"></a>02188   <span class="keywordtype">int</span> nargs;
<a name="l02189"></a>02189   <span class="keyword">struct </span>gdbarch *gdbarch = <a class="code" href="arch-utils_8c.html#a0fe1e68475f442e5d6dda589e0c62454">get_current_arch</a> ();
<a name="l02190"></a>02190 
<a name="l02191"></a>02191   <span class="keywordflow">if</span> (!cmd)
<a name="l02192"></a>02192     <span class="keywordflow">return</span> NULL;
<a name="l02193"></a>02193 
<a name="l02194"></a>02194   cmdrest = cmd;
<a name="l02195"></a>02195 
<a name="l02196"></a>02196   <span class="keywordflow">if</span> (*cmdrest == <span class="charliteral">&#39;,&#39;</span>)
<a name="l02197"></a>02197     ++cmdrest;
<a name="l02198"></a>02198   cmdrest = <a class="code" href="cli-utils_8c.html#aad7df612354d99c740a7ea12eccd3848">skip_spaces_const</a> (cmdrest);
<a name="l02199"></a>02199 
<a name="l02200"></a>02200   <span class="keywordflow">if</span> (*cmdrest++ != <span class="charliteral">&#39;&quot;&#39;</span>)
<a name="l02201"></a>02201     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;No format string following the location&quot;</span>));
<a name="l02202"></a>02202 
<a name="l02203"></a>02203   format_start = cmdrest;
<a name="l02204"></a>02204 
<a name="l02205"></a>02205   fpieces = <a class="code" href="format_8c.html#a6791f6d4a5959f34267a30fcbf665539">parse_format_string</a> (&amp;cmdrest);
<a name="l02206"></a>02206 
<a name="l02207"></a>02207   old_cleanups = <a class="code" href="cleanups_8c.html#a3d418f8af424aec399898c2d48b26224">make_cleanup</a> (<a class="code" href="format_8c.html#ab83323f8844808a76889725b63745525">free_format_pieces_cleanup</a>, &amp;fpieces);
<a name="l02208"></a>02208 
<a name="l02209"></a>02209   format_end = cmdrest;
<a name="l02210"></a>02210 
<a name="l02211"></a>02211   <span class="keywordflow">if</span> (*cmdrest++ != <span class="charliteral">&#39;&quot;&#39;</span>)
<a name="l02212"></a>02212     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Bad format string, non-terminated &#39;\&quot;&#39;.&quot;</span>));
<a name="l02213"></a>02213   
<a name="l02214"></a>02214   cmdrest = <a class="code" href="cli-utils_8c.html#aad7df612354d99c740a7ea12eccd3848">skip_spaces_const</a> (cmdrest);
<a name="l02215"></a>02215 
<a name="l02216"></a>02216   <span class="keywordflow">if</span> (!(*cmdrest == <span class="charliteral">&#39;,&#39;</span> || *cmdrest == <span class="charliteral">&#39;\0&#39;</span>))
<a name="l02217"></a>02217     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Invalid argument syntax&quot;</span>));
<a name="l02218"></a>02218 
<a name="l02219"></a>02219   <span class="keywordflow">if</span> (*cmdrest == <span class="charliteral">&#39;,&#39;</span>)
<a name="l02220"></a>02220     cmdrest++;
<a name="l02221"></a>02221   cmdrest = <a class="code" href="cli-utils_8c.html#aad7df612354d99c740a7ea12eccd3848">skip_spaces_const</a> (cmdrest);
<a name="l02222"></a>02222 
<a name="l02223"></a>02223   <span class="comment">/* For each argument, make an expression.  */</span>
<a name="l02224"></a>02224 
<a name="l02225"></a>02225   argvec = (<span class="keyword">struct </span><a class="code" href="structexpression.html">expression</a> **) alloca (strlen (cmd)
<a name="l02226"></a>02226                                          * <span class="keyword">sizeof</span> (<span class="keyword">struct </span><a class="code" href="structexpression.html">expression</a> *));
<a name="l02227"></a>02227 
<a name="l02228"></a>02228   nargs = 0;
<a name="l02229"></a>02229   <span class="keywordflow">while</span> (*cmdrest != <span class="charliteral">&#39;\0&#39;</span>)
<a name="l02230"></a>02230     {
<a name="l02231"></a>02231       <span class="keyword">const</span> <span class="keywordtype">char</span> *cmd1;
<a name="l02232"></a>02232 
<a name="l02233"></a>02233       cmd1 = cmdrest;
<a name="l02234"></a>02234       expr = <a class="code" href="expression_8h.html#abdad295cc4b5351f6e6ec024ab665475">parse_exp_1</a> (&amp;cmd1, scope, <a class="code" href="block_8c.html#a35aadf82f92cb4a47ec068dba0e1b36c">block_for_pc</a> (scope), 1);
<a name="l02235"></a>02235       argvec[nargs++] = expr;
<a name="l02236"></a>02236       cmdrest = cmd1;
<a name="l02237"></a>02237       <span class="keywordflow">if</span> (*cmdrest == <span class="charliteral">&#39;,&#39;</span>)
<a name="l02238"></a>02238         ++cmdrest;
<a name="l02239"></a>02239     }
<a name="l02240"></a>02240 
<a name="l02241"></a>02241   <span class="comment">/* We don&#39;t want to stop processing, so catch any errors</span>
<a name="l02242"></a>02242 <span class="comment">     that may show up.  */</span>
<a name="l02243"></a>02243   <a class="code" href="exceptions_8h.html#aef4514ee39b9305fddee27f49c7c34eb">TRY_CATCH</a> (ex, <a class="code" href="exceptions_8h.html#abfa3a3b99557b11f5766baf69465fdf6a44de51845416ac49ab08438792b908f0">RETURN_MASK_ERROR</a>)
<a name="l02244"></a>02244     {
<a name="l02245"></a>02245       aexpr = <a class="code" href="ax-gdb_8c.html#a8f744b74d46784c16d6448506a47ce70">gen_printf</a> (scope, gdbarch, 0, 0,
<a name="l02246"></a>02246                           format_start, format_end - format_start,
<a name="l02247"></a>02247                           fpieces, nargs, argvec);
<a name="l02248"></a>02248     }
<a name="l02249"></a>02249 
<a name="l02250"></a>02250   <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (old_cleanups);
<a name="l02251"></a>02251 
<a name="l02252"></a>02252   <span class="keywordflow">if</span> (ex.reason &lt; 0)
<a name="l02253"></a>02253     {
<a name="l02254"></a>02254       <span class="comment">/* If we got here, it means the command could not be parsed to a valid</span>
<a name="l02255"></a>02255 <span class="comment">         bytecode expression and thus can&#39;t be evaluated on the target&#39;s side.</span>
<a name="l02256"></a>02256 <span class="comment">         It&#39;s no use iterating through the other commands.  */</span>
<a name="l02257"></a>02257       <span class="keywordflow">return</span> NULL;
<a name="l02258"></a>02258     }
<a name="l02259"></a>02259 
<a name="l02260"></a>02260   <span class="comment">/* We have a valid agent expression, return it.  */</span>
<a name="l02261"></a>02261   <span class="keywordflow">return</span> aexpr;
<a name="l02262"></a>02262 }
<a name="l02263"></a>02263 
<a name="l02264"></a>02264 <span class="comment">/* Based on location BL, create a list of breakpoint commands to be</span>
<a name="l02265"></a>02265 <span class="comment">   passed on to the target.  If we have duplicated locations with</span>
<a name="l02266"></a>02266 <span class="comment">   different commands, we will add any such to the list.  */</span>
<a name="l02267"></a>02267 
<a name="l02268"></a>02268 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l02269"></a>02269 build_target_command_list (<span class="keyword">struct</span> bp_location *bl)
<a name="l02270"></a>02270 {
<a name="l02271"></a>02271   <span class="keyword">struct </span>bp_location **locp = NULL, **loc2p;
<a name="l02272"></a>02272   <span class="keywordtype">int</span> null_command_or_parse_error = 0;
<a name="l02273"></a>02273   <span class="keywordtype">int</span> modified = bl-&gt;<a class="code" href="structbp__location.html#a5bd9bf988af6d6e3d330fca3361a6a6b">needs_update</a>;
<a name="l02274"></a>02274   <span class="keyword">struct </span>bp_location *loc;
<a name="l02275"></a>02275 
<a name="l02276"></a>02276   <span class="comment">/* For now, limit to agent-style dprintf breakpoints.  */</span>
<a name="l02277"></a>02277   <span class="keywordflow">if</span> (bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> != <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa404b00503edb7eba238aea705ea34231">bp_dprintf</a>
<a name="l02278"></a>02278       || strcmp (dprintf_style, dprintf_style_agent) != 0)
<a name="l02279"></a>02279     <span class="keywordflow">return</span>;
<a name="l02280"></a>02280 
<a name="l02281"></a>02281   <span class="keywordflow">if</span> (!<a class="code" href="target_8h.html#a0f238e36b27ab62c468bef80dd432273">target_can_run_breakpoint_commands</a> ())
<a name="l02282"></a>02282     <span class="keywordflow">return</span>;
<a name="l02283"></a>02283 
<a name="l02284"></a>02284   <span class="comment">/* Do a first pass to check for locations with no assigned</span>
<a name="l02285"></a>02285 <span class="comment">     conditions or conditions that fail to parse to a valid agent expression</span>
<a name="l02286"></a>02286 <span class="comment">     bytecode.  If any of these happen, then it&#39;s no use to send conditions</span>
<a name="l02287"></a>02287 <span class="comment">     to the target since this location will always trigger and generate a</span>
<a name="l02288"></a>02288 <span class="comment">     response back to GDB.  */</span>
<a name="l02289"></a>02289   <a class="code" href="breakpoint_8c.html#af132e38cf4dda2bca037851da14a80bd">ALL_BP_LOCATIONS_AT_ADDR</a> (loc2p, locp, bl-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>)
<a name="l02290"></a>02290     {
<a name="l02291"></a>02291       loc = (*loc2p);
<a name="l02292"></a>02292       <span class="keywordflow">if</span> (<a class="code" href="breakpoint_8c.html#a5de9005cc5b36d1d327aa9127ea64f9c">is_breakpoint</a> (loc-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>) &amp;&amp; loc-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a>-&gt;<a class="code" href="structprogram__space.html#af030e0b6155dde239ce3c3379f8eac96">num</a> == bl-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a>-&gt;<a class="code" href="structprogram__space.html#af030e0b6155dde239ce3c3379f8eac96">num</a>)
<a name="l02293"></a>02293         {
<a name="l02294"></a>02294           <span class="keywordflow">if</span> (modified)
<a name="l02295"></a>02295             {
<a name="l02296"></a>02296               <span class="keyword">struct </span><a class="code" href="structagent__expr.html">agent_expr</a> *aexpr;
<a name="l02297"></a>02297 
<a name="l02298"></a>02298               <span class="comment">/* Re-parse the commands since something changed.  In that</span>
<a name="l02299"></a>02299 <span class="comment">                 case we already freed the command bytecodes (see</span>
<a name="l02300"></a>02300 <span class="comment">                 force_breakpoint_reinsertion).  We just</span>
<a name="l02301"></a>02301 <span class="comment">                 need to parse the command to bytecodes again.  */</span>
<a name="l02302"></a>02302               aexpr = parse_cmd_to_aexpr (bl-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>,
<a name="l02303"></a>02303                                           loc-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#a814299ce6585ae3945072a6df05ecb83">extra_string</a>);
<a name="l02304"></a>02304               loc-&gt;<a class="code" href="structbp__location.html#a9b7a1d66204534e7109b9cb66bbced34">cmd_bytecode</a> = aexpr;
<a name="l02305"></a>02305 
<a name="l02306"></a>02306               <span class="keywordflow">if</span> (!aexpr)
<a name="l02307"></a>02307                 <span class="keywordflow">continue</span>;
<a name="l02308"></a>02308             }
<a name="l02309"></a>02309 
<a name="l02310"></a>02310           <span class="comment">/* If we have a NULL bytecode expression, it means something</span>
<a name="l02311"></a>02311 <span class="comment">             went wrong or we have a null command expression.  */</span>
<a name="l02312"></a>02312           <span class="keywordflow">if</span> (!loc-&gt;<a class="code" href="structbp__location.html#a9b7a1d66204534e7109b9cb66bbced34">cmd_bytecode</a>)
<a name="l02313"></a>02313             {
<a name="l02314"></a>02314               null_command_or_parse_error = 1;
<a name="l02315"></a>02315               <span class="keywordflow">break</span>;
<a name="l02316"></a>02316             }
<a name="l02317"></a>02317         }
<a name="l02318"></a>02318     }
<a name="l02319"></a>02319 
<a name="l02320"></a>02320   <span class="comment">/* If anything failed, then we&#39;re not doing target-side commands,</span>
<a name="l02321"></a>02321 <span class="comment">     and so clean up.  */</span>
<a name="l02322"></a>02322   <span class="keywordflow">if</span> (null_command_or_parse_error)
<a name="l02323"></a>02323     {
<a name="l02324"></a>02324       <a class="code" href="breakpoint_8c.html#af132e38cf4dda2bca037851da14a80bd">ALL_BP_LOCATIONS_AT_ADDR</a> (loc2p, locp, bl-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>)
<a name="l02325"></a>02325         {
<a name="l02326"></a>02326           loc = (*loc2p);
<a name="l02327"></a>02327           <span class="keywordflow">if</span> (<a class="code" href="breakpoint_8c.html#a5de9005cc5b36d1d327aa9127ea64f9c">is_breakpoint</a> (loc-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>)
<a name="l02328"></a>02328               &amp;&amp; loc-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a>-&gt;<a class="code" href="structprogram__space.html#af030e0b6155dde239ce3c3379f8eac96">num</a> == bl-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a>-&gt;<a class="code" href="structprogram__space.html#af030e0b6155dde239ce3c3379f8eac96">num</a>)
<a name="l02329"></a>02329             {
<a name="l02330"></a>02330               <span class="comment">/* Only go as far as the first NULL bytecode is</span>
<a name="l02331"></a>02331 <span class="comment">                 located.  */</span>
<a name="l02332"></a>02332               <span class="keywordflow">if</span> (loc-&gt;<a class="code" href="structbp__location.html#a9b7a1d66204534e7109b9cb66bbced34">cmd_bytecode</a> == NULL)
<a name="l02333"></a>02333                 <span class="keywordflow">return</span>;
<a name="l02334"></a>02334 
<a name="l02335"></a>02335               <a class="code" href="ax-general_8c.html#a212888d48dd043f9a37823fb799cd8e4">free_agent_expr</a> (loc-&gt;<a class="code" href="structbp__location.html#a9b7a1d66204534e7109b9cb66bbced34">cmd_bytecode</a>);
<a name="l02336"></a>02336               loc-&gt;<a class="code" href="structbp__location.html#a9b7a1d66204534e7109b9cb66bbced34">cmd_bytecode</a> = NULL;
<a name="l02337"></a>02337             }
<a name="l02338"></a>02338         }
<a name="l02339"></a>02339     }
<a name="l02340"></a>02340 
<a name="l02341"></a>02341   <span class="comment">/* No NULL commands or failed bytecode generation.  Build a command list</span>
<a name="l02342"></a>02342 <span class="comment">     for this location&#39;s address.  */</span>
<a name="l02343"></a>02343   <a class="code" href="breakpoint_8c.html#af132e38cf4dda2bca037851da14a80bd">ALL_BP_LOCATIONS_AT_ADDR</a> (loc2p, locp, bl-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>)
<a name="l02344"></a>02344     {
<a name="l02345"></a>02345       loc = (*loc2p);
<a name="l02346"></a>02346       <span class="keywordflow">if</span> (loc-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#a814299ce6585ae3945072a6df05ecb83">extra_string</a>
<a name="l02347"></a>02347           &amp;&amp; <a class="code" href="breakpoint_8c.html#a5de9005cc5b36d1d327aa9127ea64f9c">is_breakpoint</a> (loc-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>)
<a name="l02348"></a>02348           &amp;&amp; loc-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a>-&gt;<a class="code" href="structprogram__space.html#af030e0b6155dde239ce3c3379f8eac96">num</a> == bl-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a>-&gt;<a class="code" href="structprogram__space.html#af030e0b6155dde239ce3c3379f8eac96">num</a>
<a name="l02349"></a>02349           &amp;&amp; loc-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#acb53352fd35aaad37054508fabc0f3bf">enable_state</a> == <a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577a72f1fa981d13a62d05324c1de974b44b">bp_enabled</a>
<a name="l02350"></a>02350           &amp;&amp; loc-&gt;<a class="code" href="structbp__location.html#abe93e091d18373d27bda3ad3eb6316f8">enabled</a>)
<a name="l02351"></a>02351         <span class="comment">/* Add the command to the vector.  This will be used later</span>
<a name="l02352"></a>02352 <span class="comment">           to send the commands to the target.  */</span>
<a name="l02353"></a>02353         <a class="code" href="vec_8h.html#a8d090c0524726d00931070e0c438ba3f">VEC_safe_push</a> (<a class="code" href="structagent__expr.html">agent_expr_p</a>, bl-&gt;<a class="code" href="structbp__location.html#a72be6a63cd025a9a040df0325fa507af">target_info</a>.tcommands,
<a name="l02354"></a>02354                        loc-&gt;<a class="code" href="structbp__location.html#a9b7a1d66204534e7109b9cb66bbced34">cmd_bytecode</a>);
<a name="l02355"></a>02355     }
<a name="l02356"></a>02356 
<a name="l02357"></a>02357   bl-&gt;<a class="code" href="structbp__location.html#a72be6a63cd025a9a040df0325fa507af">target_info</a>.<a class="code" href="structbp__target__info.html#ae65f9eb5e5902c9e0a002c20015c3ee4">persist</a> = 0;
<a name="l02358"></a>02358   <span class="comment">/* Maybe flag this location as persistent.  */</span>
<a name="l02359"></a>02359   <span class="keywordflow">if</span> (bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa404b00503edb7eba238aea705ea34231">bp_dprintf</a> &amp;&amp; disconnected_dprintf)
<a name="l02360"></a>02360     bl-&gt;<a class="code" href="structbp__location.html#a72be6a63cd025a9a040df0325fa507af">target_info</a>.<a class="code" href="structbp__target__info.html#ae65f9eb5e5902c9e0a002c20015c3ee4">persist</a> = 1;
<a name="l02361"></a>02361 }
<a name="l02362"></a>02362 
<a name="l02363"></a>02363 <span class="comment">/* Insert a low-level &quot;breakpoint&quot; of some type.  BL is the breakpoint</span>
<a name="l02364"></a>02364 <span class="comment">   location.  Any error messages are printed to TMP_ERROR_STREAM; and</span>
<a name="l02365"></a>02365 <span class="comment">   DISABLED_BREAKS, and HW_BREAKPOINT_ERROR are used to report problems.</span>
<a name="l02366"></a>02366 <span class="comment">   Returns 0 for success, 1 if the bp_location type is not supported or</span>
<a name="l02367"></a>02367 <span class="comment">   -1 for failure.</span>
<a name="l02368"></a>02368 <span class="comment"></span>
<a name="l02369"></a>02369 <span class="comment">   NOTE drow/2003-09-09: This routine could be broken down to an</span>
<a name="l02370"></a>02370 <span class="comment">   object-style method for each breakpoint or catchpoint type.  */</span>
<a name="l02371"></a>02371 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l02372"></a>02372 insert_bp_location (<span class="keyword">struct</span> bp_location *bl,
<a name="l02373"></a>02373                     <span class="keyword">struct</span> ui_file *tmp_error_stream,
<a name="l02374"></a>02374                     <span class="keywordtype">int</span> *disabled_breaks,
<a name="l02375"></a>02375                     <span class="keywordtype">int</span> *hw_breakpoint_error,
<a name="l02376"></a>02376                     <span class="keywordtype">int</span> *hw_bp_error_explained_already)
<a name="l02377"></a>02377 {
<a name="l02378"></a>02378   <span class="keywordtype">int</span> val = 0;
<a name="l02379"></a>02379   <span class="keywordtype">char</span> *hw_bp_err_string = NULL;
<a name="l02380"></a>02380   <span class="keyword">struct </span><a class="code" href="structgdb__exception.html">gdb_exception</a> e;
<a name="l02381"></a>02381 
<a name="l02382"></a>02382   <span class="keywordflow">if</span> (!should_be_inserted (bl) || (bl-&gt;<a class="code" href="structbp__location.html#acb0b475579bbe5dabeb8ed4504527105">inserted</a> &amp;&amp; !bl-&gt;<a class="code" href="structbp__location.html#a5bd9bf988af6d6e3d330fca3361a6a6b">needs_update</a>))
<a name="l02383"></a>02383     <span class="keywordflow">return</span> 0;
<a name="l02384"></a>02384 
<a name="l02385"></a>02385   <span class="comment">/* Note we don&#39;t initialize bl-&gt;target_info, as that wipes out</span>
<a name="l02386"></a>02386 <span class="comment">     the breakpoint location&#39;s shadow_contents if the breakpoint</span>
<a name="l02387"></a>02387 <span class="comment">     is still inserted at that location.  This in turn breaks</span>
<a name="l02388"></a>02388 <span class="comment">     target_read_memory which depends on these buffers when</span>
<a name="l02389"></a>02389 <span class="comment">     a memory read is requested at the breakpoint location:</span>
<a name="l02390"></a>02390 <span class="comment">     Once the target_info has been wiped, we fail to see that</span>
<a name="l02391"></a>02391 <span class="comment">     we have a breakpoint inserted at that address and thus</span>
<a name="l02392"></a>02392 <span class="comment">     read the breakpoint instead of returning the data saved in</span>
<a name="l02393"></a>02393 <span class="comment">     the breakpoint location&#39;s shadow contents.  */</span>
<a name="l02394"></a>02394   bl-&gt;<a class="code" href="structbp__location.html#a72be6a63cd025a9a040df0325fa507af">target_info</a>.<a class="code" href="structbp__target__info.html#a8e3d47e670e13db11873c3ff52934fbb">placed_address</a> = bl-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>;
<a name="l02395"></a>02395   bl-&gt;<a class="code" href="structbp__location.html#a72be6a63cd025a9a040df0325fa507af">target_info</a>.<a class="code" href="structbp__target__info.html#afe5a9e41037d27e13353a24f733c4693">placed_address_space</a> = bl-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a>-&gt;<a class="code" href="structprogram__space.html#abf2a489f5ed3c1d5cad74d14dbb318e4">aspace</a>;
<a name="l02396"></a>02396   bl-&gt;<a class="code" href="structbp__location.html#a72be6a63cd025a9a040df0325fa507af">target_info</a>.<a class="code" href="structbp__target__info.html#a825ea9094e1f332555fc8f880483d79f">length</a> = bl-&gt;<a class="code" href="structbp__location.html#a3d4ad6914964554ca761607f9e8fab62">length</a>;
<a name="l02397"></a>02397 
<a name="l02398"></a>02398   <span class="comment">/* When working with target-side conditions, we must pass all the conditions</span>
<a name="l02399"></a>02399 <span class="comment">     for the same breakpoint address down to the target since GDB will not</span>
<a name="l02400"></a>02400 <span class="comment">     insert those locations.  With a list of breakpoint conditions, the target</span>
<a name="l02401"></a>02401 <span class="comment">     can decide when to stop and notify GDB.  */</span>
<a name="l02402"></a>02402 
<a name="l02403"></a>02403   <span class="keywordflow">if</span> (<a class="code" href="breakpoint_8c.html#a5de9005cc5b36d1d327aa9127ea64f9c">is_breakpoint</a> (bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>))
<a name="l02404"></a>02404     {
<a name="l02405"></a>02405       build_target_condition_list (bl);
<a name="l02406"></a>02406       build_target_command_list (bl);
<a name="l02407"></a>02407       <span class="comment">/* Reset the modification marker.  */</span>
<a name="l02408"></a>02408       bl-&gt;<a class="code" href="structbp__location.html#a5bd9bf988af6d6e3d330fca3361a6a6b">needs_update</a> = 0;
<a name="l02409"></a>02409     }
<a name="l02410"></a>02410 
<a name="l02411"></a>02411   <span class="keywordflow">if</span> (bl-&gt;<a class="code" href="structbp__location.html#aefe49818487e5876fc995f7831e2e809">loc_type</a> == <a class="code" href="breakpoint_8h.html#ad7006ab95a9d2493c6ad2c685f45f5dcaa74492f6095e7a1ae08e3eed468ba47d">bp_loc_software_breakpoint</a>
<a name="l02412"></a>02412       || bl-&gt;<a class="code" href="structbp__location.html#aefe49818487e5876fc995f7831e2e809">loc_type</a> == <a class="code" href="breakpoint_8h.html#ad7006ab95a9d2493c6ad2c685f45f5dca4a1949653a3b3c36db5cb269a46adb60">bp_loc_hardware_breakpoint</a>)
<a name="l02413"></a>02413     {
<a name="l02414"></a>02414       <span class="keywordflow">if</span> (bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> != <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa657fad68a9d83a24532fb06715b77628">bp_hardware_breakpoint</a>)
<a name="l02415"></a>02415         {
<a name="l02416"></a>02416           <span class="comment">/* If the explicitly specified breakpoint type</span>
<a name="l02417"></a>02417 <span class="comment">             is not hardware breakpoint, check the memory map to see</span>
<a name="l02418"></a>02418 <span class="comment">             if the breakpoint address is in read only memory or not.</span>
<a name="l02419"></a>02419 <span class="comment"></span>
<a name="l02420"></a>02420 <span class="comment">             Two important cases are:</span>
<a name="l02421"></a>02421 <span class="comment">             - location type is not hardware breakpoint, memory</span>
<a name="l02422"></a>02422 <span class="comment">             is readonly.  We change the type of the location to</span>
<a name="l02423"></a>02423 <span class="comment">             hardware breakpoint.</span>
<a name="l02424"></a>02424 <span class="comment">             - location type is hardware breakpoint, memory is</span>
<a name="l02425"></a>02425 <span class="comment">             read-write.  This means we&#39;ve previously made the</span>
<a name="l02426"></a>02426 <span class="comment">             location hardware one, but then the memory map changed,</span>
<a name="l02427"></a>02427 <span class="comment">             so we undo.</span>
<a name="l02428"></a>02428 <span class="comment">             </span>
<a name="l02429"></a>02429 <span class="comment">             When breakpoints are removed, remove_breakpoints will use</span>
<a name="l02430"></a>02430 <span class="comment">             location types we&#39;ve just set here, the only possible</span>
<a name="l02431"></a>02431 <span class="comment">             problem is that memory map has changed during running</span>
<a name="l02432"></a>02432 <span class="comment">             program, but it&#39;s not going to work anyway with current</span>
<a name="l02433"></a>02433 <span class="comment">             gdb.  */</span>
<a name="l02434"></a>02434           <span class="keyword">struct </span><a class="code" href="structmem__region.html">mem_region</a> *mr 
<a name="l02435"></a>02435             = <a class="code" href="memattr_8c.html#a74f6664807a4680693d70b0c3171b3de">lookup_mem_region</a> (bl-&gt;<a class="code" href="structbp__location.html#a72be6a63cd025a9a040df0325fa507af">target_info</a>.<a class="code" href="structbp__target__info.html#a8e3d47e670e13db11873c3ff52934fbb">placed_address</a>);
<a name="l02436"></a>02436           
<a name="l02437"></a>02437           <span class="keywordflow">if</span> (mr)
<a name="l02438"></a>02438             {
<a name="l02439"></a>02439               <span class="keywordflow">if</span> (automatic_hardware_breakpoints)
<a name="l02440"></a>02440                 {
<a name="l02441"></a>02441                   <span class="keyword">enum</span> <a class="code" href="breakpoint_8h.html#ad7006ab95a9d2493c6ad2c685f45f5dc">bp_loc_type</a> new_type;
<a name="l02442"></a>02442                   
<a name="l02443"></a>02443                   <span class="keywordflow">if</span> (mr-&gt;<a class="code" href="structmem__region.html#abe9b8da30882da3ae49900bbd9ee2216">attrib</a>.<a class="code" href="structmem__attrib.html#a497db642b7905d147fd3d1d99c62479d">mode</a> != <a class="code" href="memattr_8h.html#a3f4ace0e38d799b499aad31727002b18a6310d919764fd34b556bb9155593d186">MEM_RW</a>)
<a name="l02444"></a>02444                     new_type = <a class="code" href="breakpoint_8h.html#ad7006ab95a9d2493c6ad2c685f45f5dca4a1949653a3b3c36db5cb269a46adb60">bp_loc_hardware_breakpoint</a>;
<a name="l02445"></a>02445                   <span class="keywordflow">else</span> 
<a name="l02446"></a>02446                     new_type = <a class="code" href="breakpoint_8h.html#ad7006ab95a9d2493c6ad2c685f45f5dcaa74492f6095e7a1ae08e3eed468ba47d">bp_loc_software_breakpoint</a>;
<a name="l02447"></a>02447                   
<a name="l02448"></a>02448                   <span class="keywordflow">if</span> (new_type != bl-&gt;<a class="code" href="structbp__location.html#aefe49818487e5876fc995f7831e2e809">loc_type</a>)
<a name="l02449"></a>02449                     {
<a name="l02450"></a>02450                       <span class="keyword">static</span> <span class="keywordtype">int</span> said = 0;
<a name="l02451"></a>02451 
<a name="l02452"></a>02452                       bl-&gt;<a class="code" href="structbp__location.html#aefe49818487e5876fc995f7831e2e809">loc_type</a> = new_type;
<a name="l02453"></a>02453                       <span class="keywordflow">if</span> (!said)
<a name="l02454"></a>02454                         {
<a name="l02455"></a>02455                           <a class="code" href="utils_8c.html#aaa819b1a6c0b6c4090bdc0b027eaf64b">fprintf_filtered</a> (<a class="code" href="main_8c.html#a41a2b997ba5454df787d61f051dd918c">gdb_stdout</a>,
<a name="l02456"></a>02456                                             <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Note: automatically using &quot;</span>
<a name="l02457"></a>02457                                               <span class="stringliteral">&quot;hardware breakpoints for &quot;</span>
<a name="l02458"></a>02458                                               <span class="stringliteral">&quot;read-only addresses.\n&quot;</span>));
<a name="l02459"></a>02459                           said = 1;
<a name="l02460"></a>02460                         }
<a name="l02461"></a>02461                     }
<a name="l02462"></a>02462                 }
<a name="l02463"></a>02463               <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bl-&gt;<a class="code" href="structbp__location.html#aefe49818487e5876fc995f7831e2e809">loc_type</a> == <a class="code" href="breakpoint_8h.html#ad7006ab95a9d2493c6ad2c685f45f5dcaa74492f6095e7a1ae08e3eed468ba47d">bp_loc_software_breakpoint</a>
<a name="l02464"></a>02464                        &amp;&amp; mr-&gt;<a class="code" href="structmem__region.html#abe9b8da30882da3ae49900bbd9ee2216">attrib</a>.<a class="code" href="structmem__attrib.html#a497db642b7905d147fd3d1d99c62479d">mode</a> != <a class="code" href="memattr_8h.html#a3f4ace0e38d799b499aad31727002b18a6310d919764fd34b556bb9155593d186">MEM_RW</a>)        
<a name="l02465"></a>02465                 <a class="code" href="utils_8c.html#a5fc201a4181499a6b4057a6caa15b5e2">warning</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;cannot set software breakpoint &quot;</span>
<a name="l02466"></a>02466                            <span class="stringliteral">&quot;at readonly address %s&quot;</span>),
<a name="l02467"></a>02467                          <a class="code" href="utils_8c.html#ab5c76d72090f01d3848b63dda4e37d1c">paddress</a> (bl-&gt;<a class="code" href="structbp__location.html#a55f3ff99d536775f5095f11e5f5c3f3e">gdbarch</a>, bl-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>));
<a name="l02468"></a>02468             }
<a name="l02469"></a>02469         }
<a name="l02470"></a>02470         
<a name="l02471"></a>02471       <span class="comment">/* First check to see if we have to handle an overlay.  */</span>
<a name="l02472"></a>02472       <span class="keywordflow">if</span> (<a class="code" href="symfile_8c.html#ad96d01ef61ee2925825b3992d37408f5">overlay_debugging</a> == <a class="code" href="symfile_8h.html#aac35fb60df366f285fe7fda072f3edc2aadd8d8442094fe5bb20a1e1a5217ff38">ovly_off</a>
<a name="l02473"></a>02473           || bl-&gt;<a class="code" href="structbp__location.html#ac6d8286e46db5c4be6dab9139c43a00d">section</a> == NULL
<a name="l02474"></a>02474           || !(<a class="code" href="symfile_8c.html#ad63f10fe5266cd2e98883d6f4c054c3a">section_is_overlay</a> (bl-&gt;<a class="code" href="structbp__location.html#ac6d8286e46db5c4be6dab9139c43a00d">section</a>)))
<a name="l02475"></a>02475         {
<a name="l02476"></a>02476           <span class="comment">/* No overlay handling: just set the breakpoint.  */</span>
<a name="l02477"></a>02477           <a class="code" href="exceptions_8h.html#aef4514ee39b9305fddee27f49c7c34eb">TRY_CATCH</a> (e, <a class="code" href="exceptions_8h.html#abfa3a3b99557b11f5766baf69465fdf6ab50fde886a7de8c013bf2bd4e7c073a4">RETURN_MASK_ALL</a>)
<a name="l02478"></a>02478             {
<a name="l02479"></a>02479               val = bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#aba258aa23496f6434aaa1cf8c8dc7ea7">ops</a>-&gt;<a class="code" href="structbreakpoint__ops.html#a36581d1abf4c42e5b9aac2febd1b72ff">insert_location</a> (bl);
<a name="l02480"></a>02480             }
<a name="l02481"></a>02481           <span class="keywordflow">if</span> (e.reason &lt; 0)
<a name="l02482"></a>02482             {
<a name="l02483"></a>02483               val = 1;
<a name="l02484"></a>02484               hw_bp_err_string = (<span class="keywordtype">char</span> *) e.message;
<a name="l02485"></a>02485             }
<a name="l02486"></a>02486         }
<a name="l02487"></a>02487       <span class="keywordflow">else</span>
<a name="l02488"></a>02488         {
<a name="l02489"></a>02489           <span class="comment">/* This breakpoint is in an overlay section.</span>
<a name="l02490"></a>02490 <span class="comment">             Shall we set a breakpoint at the LMA?  */</span>
<a name="l02491"></a>02491           <span class="keywordflow">if</span> (!overlay_events_enabled)
<a name="l02492"></a>02492             {
<a name="l02493"></a>02493               <span class="comment">/* Yes -- overlay event support is not active, </span>
<a name="l02494"></a>02494 <span class="comment">                 so we must try to set a breakpoint at the LMA.</span>
<a name="l02495"></a>02495 <span class="comment">                 This will not work for a hardware breakpoint.  */</span>
<a name="l02496"></a>02496               <span class="keywordflow">if</span> (bl-&gt;<a class="code" href="structbp__location.html#aefe49818487e5876fc995f7831e2e809">loc_type</a> == <a class="code" href="breakpoint_8h.html#ad7006ab95a9d2493c6ad2c685f45f5dca4a1949653a3b3c36db5cb269a46adb60">bp_loc_hardware_breakpoint</a>)
<a name="l02497"></a>02497                 <a class="code" href="utils_8c.html#a5fc201a4181499a6b4057a6caa15b5e2">warning</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;hardware breakpoint %d not supported in overlay!&quot;</span>),
<a name="l02498"></a>02498                          bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>);
<a name="l02499"></a>02499               <span class="keywordflow">else</span>
<a name="l02500"></a>02500                 {
<a name="l02501"></a>02501                   <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> addr = <a class="code" href="symfile_8c.html#a2636cd25fefea890cc48426ca960e502">overlay_unmapped_address</a> (bl-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>,
<a name="l02502"></a>02502                                                              bl-&gt;<a class="code" href="structbp__location.html#ac6d8286e46db5c4be6dab9139c43a00d">section</a>);
<a name="l02503"></a>02503                   <span class="comment">/* Set a software (trap) breakpoint at the LMA.  */</span>
<a name="l02504"></a>02504                   bl-&gt;<a class="code" href="structbp__location.html#a673c3836b1a8fc6cb89bccdd1f2c2841">overlay_target_info</a> = bl-&gt;<a class="code" href="structbp__location.html#a72be6a63cd025a9a040df0325fa507af">target_info</a>;
<a name="l02505"></a>02505                   bl-&gt;<a class="code" href="structbp__location.html#a673c3836b1a8fc6cb89bccdd1f2c2841">overlay_target_info</a>.<a class="code" href="structbp__target__info.html#a8e3d47e670e13db11873c3ff52934fbb">placed_address</a> = addr;
<a name="l02506"></a>02506                   val = <a class="code" href="target_8c.html#a4a288f6e92a74cf83fdae9d6ac05cd80">target_insert_breakpoint</a> (bl-&gt;<a class="code" href="structbp__location.html#a55f3ff99d536775f5095f11e5f5c3f3e">gdbarch</a>,
<a name="l02507"></a>02507                                                   &amp;bl-&gt;<a class="code" href="structbp__location.html#a673c3836b1a8fc6cb89bccdd1f2c2841">overlay_target_info</a>);
<a name="l02508"></a>02508                   <span class="keywordflow">if</span> (val != 0)
<a name="l02509"></a>02509                     <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (tmp_error_stream,
<a name="l02510"></a>02510                                         <span class="stringliteral">&quot;Overlay breakpoint %d &quot;</span>
<a name="l02511"></a>02511                                         <span class="stringliteral">&quot;failed: in ROM?\n&quot;</span>,
<a name="l02512"></a>02512                                         bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>);
<a name="l02513"></a>02513                 }
<a name="l02514"></a>02514             }
<a name="l02515"></a>02515           <span class="comment">/* Shall we set a breakpoint at the VMA? */</span>
<a name="l02516"></a>02516           <span class="keywordflow">if</span> (<a class="code" href="symfile_8c.html#a2d6f94d48a782be7460e704fec67adb4">section_is_mapped</a> (bl-&gt;<a class="code" href="structbp__location.html#ac6d8286e46db5c4be6dab9139c43a00d">section</a>))
<a name="l02517"></a>02517             {
<a name="l02518"></a>02518               <span class="comment">/* Yes.  This overlay section is mapped into memory.  */</span>
<a name="l02519"></a>02519               <a class="code" href="exceptions_8h.html#aef4514ee39b9305fddee27f49c7c34eb">TRY_CATCH</a> (e, <a class="code" href="exceptions_8h.html#abfa3a3b99557b11f5766baf69465fdf6ab50fde886a7de8c013bf2bd4e7c073a4">RETURN_MASK_ALL</a>)
<a name="l02520"></a>02520                 {
<a name="l02521"></a>02521                   val = bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#aba258aa23496f6434aaa1cf8c8dc7ea7">ops</a>-&gt;<a class="code" href="structbreakpoint__ops.html#a36581d1abf4c42e5b9aac2febd1b72ff">insert_location</a> (bl);
<a name="l02522"></a>02522                 }
<a name="l02523"></a>02523               <span class="keywordflow">if</span> (e.reason &lt; 0)
<a name="l02524"></a>02524                 {
<a name="l02525"></a>02525                   val = 1;
<a name="l02526"></a>02526                   hw_bp_err_string = (<span class="keywordtype">char</span> *) e.message;
<a name="l02527"></a>02527                 }
<a name="l02528"></a>02528             }
<a name="l02529"></a>02529           <span class="keywordflow">else</span>
<a name="l02530"></a>02530             {
<a name="l02531"></a>02531               <span class="comment">/* No.  This breakpoint will not be inserted.  </span>
<a name="l02532"></a>02532 <span class="comment">                 No error, but do not mark the bp as &#39;inserted&#39;.  */</span>
<a name="l02533"></a>02533               <span class="keywordflow">return</span> 0;
<a name="l02534"></a>02534             }
<a name="l02535"></a>02535         }
<a name="l02536"></a>02536 
<a name="l02537"></a>02537       <span class="keywordflow">if</span> (val)
<a name="l02538"></a>02538         {
<a name="l02539"></a>02539           <span class="comment">/* Can&#39;t set the breakpoint.  */</span>
<a name="l02540"></a>02540           <span class="keywordflow">if</span> (<a class="code" href="solib_8c.html#aeb7eeab1d9375e787425078df3a08b9d">solib_name_from_address</a> (bl-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a>, bl-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>))
<a name="l02541"></a>02541             {
<a name="l02542"></a>02542               <span class="comment">/* See also: disable_breakpoints_in_shlibs.  */</span>
<a name="l02543"></a>02543               val = 0;
<a name="l02544"></a>02544               bl-&gt;<a class="code" href="structbp__location.html#a3732b41958ed311106bffd202cbfe4ff">shlib_disabled</a> = 1;
<a name="l02545"></a>02545               <a class="code" href="observer_8h.html#a3edacfe44ac49f71646caded92072cad">observer_notify_breakpoint_modified</a> (bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>);
<a name="l02546"></a>02546               <span class="keywordflow">if</span> (!*disabled_breaks)
<a name="l02547"></a>02547                 {
<a name="l02548"></a>02548                   <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (tmp_error_stream, 
<a name="l02549"></a>02549                                       <span class="stringliteral">&quot;Cannot insert breakpoint %d.\n&quot;</span>, 
<a name="l02550"></a>02550                                       bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>);
<a name="l02551"></a>02551                   <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (tmp_error_stream, 
<a name="l02552"></a>02552                                       <span class="stringliteral">&quot;Temporarily disabling shared &quot;</span>
<a name="l02553"></a>02553                                       <span class="stringliteral">&quot;library breakpoints:\n&quot;</span>);
<a name="l02554"></a>02554                 }
<a name="l02555"></a>02555               *disabled_breaks = 1;
<a name="l02556"></a>02556               <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (tmp_error_stream,
<a name="l02557"></a>02557                                   <span class="stringliteral">&quot;breakpoint #%d\n&quot;</span>, bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>);
<a name="l02558"></a>02558             }
<a name="l02559"></a>02559           <span class="keywordflow">else</span>
<a name="l02560"></a>02560             {
<a name="l02561"></a>02561               <span class="keywordflow">if</span> (bl-&gt;<a class="code" href="structbp__location.html#aefe49818487e5876fc995f7831e2e809">loc_type</a> == <a class="code" href="breakpoint_8h.html#ad7006ab95a9d2493c6ad2c685f45f5dca4a1949653a3b3c36db5cb269a46adb60">bp_loc_hardware_breakpoint</a>)
<a name="l02562"></a>02562                 {
<a name="l02563"></a>02563                   *hw_breakpoint_error = 1;
<a name="l02564"></a>02564                   *hw_bp_error_explained_already = hw_bp_err_string != NULL;
<a name="l02565"></a>02565                   <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (tmp_error_stream,
<a name="l02566"></a>02566                                       <span class="stringliteral">&quot;Cannot insert hardware breakpoint %d%s&quot;</span>,
<a name="l02567"></a>02567                                       bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>, hw_bp_err_string ? <span class="stringliteral">&quot;:&quot;</span> : <span class="stringliteral">&quot;.\n&quot;</span>);
<a name="l02568"></a>02568                   <span class="keywordflow">if</span> (hw_bp_err_string)
<a name="l02569"></a>02569                     <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (tmp_error_stream, <span class="stringliteral">&quot;%s.\n&quot;</span>, hw_bp_err_string);
<a name="l02570"></a>02570                 }
<a name="l02571"></a>02571               <span class="keywordflow">else</span>
<a name="l02572"></a>02572                 {
<a name="l02573"></a>02573                   <span class="keywordtype">char</span> *message = <a class="code" href="corefile_8c.html#aa8f5cf81ee6522886495501440fcdfa9">memory_error_message</a> (<a class="code" href="target_8h.html#abb2b4914eed57f72aa554a606ec7a6a8a0acd1eebf730af465bb2f90e781420a8">TARGET_XFER_E_IO</a>,
<a name="l02574"></a>02574                                                         bl-&gt;<a class="code" href="structbp__location.html#a55f3ff99d536775f5095f11e5f5c3f3e">gdbarch</a>, bl-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>);
<a name="l02575"></a>02575                   <span class="keyword">struct </span>cleanup *old_chain = <a class="code" href="cleanups_8c.html#a3d418f8af424aec399898c2d48b26224">make_cleanup</a> (<a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a>, message);
<a name="l02576"></a>02576 
<a name="l02577"></a>02577                   <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (tmp_error_stream, 
<a name="l02578"></a>02578                                       <span class="stringliteral">&quot;Cannot insert breakpoint %d.\n&quot;</span>
<a name="l02579"></a>02579                                       <span class="stringliteral">&quot;%s\n&quot;</span>,
<a name="l02580"></a>02580                                       bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>, message);
<a name="l02581"></a>02581 
<a name="l02582"></a>02582                   <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (old_chain);
<a name="l02583"></a>02583                 }
<a name="l02584"></a>02584 
<a name="l02585"></a>02585             }
<a name="l02586"></a>02586         }
<a name="l02587"></a>02587       <span class="keywordflow">else</span>
<a name="l02588"></a>02588         bl-&gt;<a class="code" href="structbp__location.html#acb0b475579bbe5dabeb8ed4504527105">inserted</a> = 1;
<a name="l02589"></a>02589 
<a name="l02590"></a>02590       <span class="keywordflow">return</span> val;
<a name="l02591"></a>02591     }
<a name="l02592"></a>02592 
<a name="l02593"></a>02593   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bl-&gt;<a class="code" href="structbp__location.html#aefe49818487e5876fc995f7831e2e809">loc_type</a> == <a class="code" href="breakpoint_8h.html#ad7006ab95a9d2493c6ad2c685f45f5dcaf30d35565c228c0d80de4d7af9d9fbd2">bp_loc_hardware_watchpoint</a>
<a name="l02594"></a>02594            <span class="comment">/* NOTE drow/2003-09-08: This state only exists for removing</span>
<a name="l02595"></a>02595 <span class="comment">              watchpoints.  It&#39;s not clear that it&#39;s necessary...  */</span>
<a name="l02596"></a>02596            &amp;&amp; bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#a75f0f9a837eac292ab6e768e8d8f1bd7">disposition</a> != <a class="code" href="breakpoint_8h.html#a15f2bbd9012f59bc09d59feef0c15732a9b0a2ed54849261d15631bb5e654843b">disp_del_at_next_stop</a>)
<a name="l02597"></a>02597     {
<a name="l02598"></a>02598       <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#aba258aa23496f6434aaa1cf8c8dc7ea7">ops</a> != NULL
<a name="l02599"></a>02599                   &amp;&amp; bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#aba258aa23496f6434aaa1cf8c8dc7ea7">ops</a>-&gt;<a class="code" href="structbreakpoint__ops.html#a36581d1abf4c42e5b9aac2febd1b72ff">insert_location</a> != NULL);
<a name="l02600"></a>02600 
<a name="l02601"></a>02601       val = bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#aba258aa23496f6434aaa1cf8c8dc7ea7">ops</a>-&gt;<a class="code" href="structbreakpoint__ops.html#a36581d1abf4c42e5b9aac2febd1b72ff">insert_location</a> (bl);
<a name="l02602"></a>02602 
<a name="l02603"></a>02603       <span class="comment">/* If trying to set a read-watchpoint, and it turns out it&#39;s not</span>
<a name="l02604"></a>02604 <span class="comment">         supported, try emulating one with an access watchpoint.  */</span>
<a name="l02605"></a>02605       <span class="keywordflow">if</span> (val == 1 &amp;&amp; bl-&gt;<a class="code" href="structbp__location.html#a0480880dc590f47b72d7af91ab5d5802">watchpoint_type</a> == <a class="code" href="break-common_8h.html#ae1f701210980578c2ab1bc4ae89e69f3afb52ba78eb7679d11a25bd2c44eb0606">hw_read</a>)
<a name="l02606"></a>02606         {
<a name="l02607"></a>02607           <span class="keyword">struct </span>bp_location *loc, **loc_temp;
<a name="l02608"></a>02608 
<a name="l02609"></a>02609           <span class="comment">/* But don&#39;t try to insert it, if there&#39;s already another</span>
<a name="l02610"></a>02610 <span class="comment">             hw_access location that would be considered a duplicate</span>
<a name="l02611"></a>02611 <span class="comment">             of this one.  */</span>
<a name="l02612"></a>02612           <a class="code" href="breakpoint_8c.html#a6f97c7962df1d91150e0e8de40ff7fe4">ALL_BP_LOCATIONS</a> (loc, loc_temp)
<a name="l02613"></a>02613             if (loc != bl
<a name="l02614"></a>02614                 &amp;&amp; loc-&gt;<a class="code" href="structbp__location.html#a0480880dc590f47b72d7af91ab5d5802">watchpoint_type</a> == <a class="code" href="break-common_8h.html#ae1f701210980578c2ab1bc4ae89e69f3a8bef3f5dcfc5f1c5b482627a8ddf5736">hw_access</a>
<a name="l02615"></a>02615                 &amp;&amp; watchpoint_locations_match (bl, loc))
<a name="l02616"></a>02616               {
<a name="l02617"></a>02617                 bl-&gt;duplicate = 1;
<a name="l02618"></a>02618                 bl-&gt;inserted = 1;
<a name="l02619"></a>02619                 bl-&gt;target_info = loc-&gt;target_info;
<a name="l02620"></a>02620                 bl-&gt;watchpoint_type = <a class="code" href="break-common_8h.html#ae1f701210980578c2ab1bc4ae89e69f3a8bef3f5dcfc5f1c5b482627a8ddf5736">hw_access</a>;
<a name="l02621"></a>02621                 val = 0;
<a name="l02622"></a>02622                 <span class="keywordflow">break</span>;
<a name="l02623"></a>02623               }
<a name="l02624"></a>02624 
<a name="l02625"></a>02625           <span class="keywordflow">if</span> (val == 1)
<a name="l02626"></a>02626             {
<a name="l02627"></a>02627               bl-&gt;<a class="code" href="structbp__location.html#a0480880dc590f47b72d7af91ab5d5802">watchpoint_type</a> = <a class="code" href="break-common_8h.html#ae1f701210980578c2ab1bc4ae89e69f3a8bef3f5dcfc5f1c5b482627a8ddf5736">hw_access</a>;
<a name="l02628"></a>02628               val = bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#aba258aa23496f6434aaa1cf8c8dc7ea7">ops</a>-&gt;<a class="code" href="structbreakpoint__ops.html#a36581d1abf4c42e5b9aac2febd1b72ff">insert_location</a> (bl);
<a name="l02629"></a>02629 
<a name="l02630"></a>02630               <span class="keywordflow">if</span> (val)
<a name="l02631"></a>02631                 <span class="comment">/* Back to the original value.  */</span>
<a name="l02632"></a>02632                 bl-&gt;<a class="code" href="structbp__location.html#a0480880dc590f47b72d7af91ab5d5802">watchpoint_type</a> = <a class="code" href="break-common_8h.html#ae1f701210980578c2ab1bc4ae89e69f3afb52ba78eb7679d11a25bd2c44eb0606">hw_read</a>;
<a name="l02633"></a>02633             }
<a name="l02634"></a>02634         }
<a name="l02635"></a>02635 
<a name="l02636"></a>02636       bl-&gt;<a class="code" href="structbp__location.html#acb0b475579bbe5dabeb8ed4504527105">inserted</a> = (val == 0);
<a name="l02637"></a>02637     }
<a name="l02638"></a>02638 
<a name="l02639"></a>02639   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa8ebb961cef940b8ddef84696b7ac9694">bp_catchpoint</a>)
<a name="l02640"></a>02640     {
<a name="l02641"></a>02641       <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#aba258aa23496f6434aaa1cf8c8dc7ea7">ops</a> != NULL
<a name="l02642"></a>02642                   &amp;&amp; bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#aba258aa23496f6434aaa1cf8c8dc7ea7">ops</a>-&gt;<a class="code" href="structbreakpoint__ops.html#a36581d1abf4c42e5b9aac2febd1b72ff">insert_location</a> != NULL);
<a name="l02643"></a>02643 
<a name="l02644"></a>02644       val = bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#aba258aa23496f6434aaa1cf8c8dc7ea7">ops</a>-&gt;<a class="code" href="structbreakpoint__ops.html#a36581d1abf4c42e5b9aac2febd1b72ff">insert_location</a> (bl);
<a name="l02645"></a>02645       <span class="keywordflow">if</span> (val)
<a name="l02646"></a>02646         {
<a name="l02647"></a>02647           bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#acb53352fd35aaad37054508fabc0f3bf">enable_state</a> = <a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577a4605f207d0d15bd8195c9b1aa1bfee96">bp_disabled</a>;
<a name="l02648"></a>02648 
<a name="l02649"></a>02649           <span class="keywordflow">if</span> (val == 1)
<a name="l02650"></a>02650             <a class="code" href="utils_8c.html#a5fc201a4181499a6b4057a6caa15b5e2">warning</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l02651"></a>02651 <span class="stringliteral">Error inserting catchpoint %d: Your system does not support this type\n\</span>
<a name="l02652"></a>02652 <span class="stringliteral">of catchpoint.&quot;</span>), bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>);
<a name="l02653"></a>02653           <span class="keywordflow">else</span>
<a name="l02654"></a>02654             <a class="code" href="utils_8c.html#a5fc201a4181499a6b4057a6caa15b5e2">warning</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Error inserting catchpoint %d.&quot;</span>), bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>);
<a name="l02655"></a>02655         }
<a name="l02656"></a>02656 
<a name="l02657"></a>02657       bl-&gt;<a class="code" href="structbp__location.html#acb0b475579bbe5dabeb8ed4504527105">inserted</a> = (val == 0);
<a name="l02658"></a>02658 
<a name="l02659"></a>02659       <span class="comment">/* We&#39;ve already printed an error message if there was a problem</span>
<a name="l02660"></a>02660 <span class="comment">         inserting this catchpoint, and we&#39;ve disabled the catchpoint,</span>
<a name="l02661"></a>02661 <span class="comment">         so just return success.  */</span>
<a name="l02662"></a>02662       <span class="keywordflow">return</span> 0;
<a name="l02663"></a>02663     }
<a name="l02664"></a>02664 
<a name="l02665"></a>02665   <span class="keywordflow">return</span> 0;
<a name="l02666"></a>02666 }
<a name="l02667"></a>02667 
<a name="l02668"></a>02668 <span class="comment">/* This function is called when program space PSPACE is about to be</span>
<a name="l02669"></a>02669 <span class="comment">   deleted.  It takes care of updating breakpoints to not reference</span>
<a name="l02670"></a>02670 <span class="comment">   PSPACE anymore.  */</span>
<a name="l02671"></a>02671 
<a name="l02672"></a>02672 <span class="keywordtype">void</span>
<a name="l02673"></a><a class="code" href="breakpoint_8h.html#a039e3f8bf8845a4afee4d94cf27f216f">02673</a> <a class="code" href="breakpoint_8c.html#a039e3f8bf8845a4afee4d94cf27f216f">breakpoint_program_space_exit</a> (<span class="keyword">struct</span> <a class="code" href="structprogram__space.html">program_space</a> *<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a>)
<a name="l02674"></a>02674 {
<a name="l02675"></a>02675   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b, *b_temp;
<a name="l02676"></a>02676   <span class="keyword">struct </span>bp_location *loc, **loc_temp;
<a name="l02677"></a>02677 
<a name="l02678"></a>02678   <span class="comment">/* Remove any breakpoint that was set through this program space.  */</span>
<a name="l02679"></a>02679   <a class="code" href="breakpoint_8c.html#ace15af58ae54149fbef6d72ecb61e12d">ALL_BREAKPOINTS_SAFE</a> (b, b_temp)
<a name="l02680"></a>02680     {
<a name="l02681"></a>02681       <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#a82f4fd8ee6ddee61f3529fbd747c78b2">pspace</a> == pspace)
<a name="l02682"></a>02682         <a class="code" href="breakpoint_8c.html#a0701191361b1ed0d40d76661e88de3f4">delete_breakpoint</a> (b);
<a name="l02683"></a>02683     }
<a name="l02684"></a>02684 
<a name="l02685"></a>02685   <span class="comment">/* Breakpoints set through other program spaces could have locations</span>
<a name="l02686"></a>02686 <span class="comment">     bound to PSPACE as well.  Remove those.  */</span>
<a name="l02687"></a>02687   <a class="code" href="breakpoint_8c.html#a6f97c7962df1d91150e0e8de40ff7fe4">ALL_BP_LOCATIONS</a> (loc, loc_temp)
<a name="l02688"></a>02688     {
<a name="l02689"></a>02689       <span class="keyword">struct </span>bp_location *tmp;
<a name="l02690"></a>02690 
<a name="l02691"></a>02691       <span class="keywordflow">if</span> (loc-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a> == pspace)
<a name="l02692"></a>02692         {
<a name="l02693"></a>02693           <span class="comment">/* ALL_BP_LOCATIONS bp_location has LOC-&gt;OWNER always non-NULL.  */</span>
<a name="l02694"></a>02694           <span class="keywordflow">if</span> (loc-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a> == loc)
<a name="l02695"></a>02695             loc-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a> = loc-&gt;<a class="code" href="structbp__location.html#ab193cb38f87fea89105db96d94191541">next</a>;
<a name="l02696"></a>02696           <span class="keywordflow">else</span>
<a name="l02697"></a>02697             <span class="keywordflow">for</span> (tmp = loc-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>; tmp-&gt;<a class="code" href="structbp__location.html#ab193cb38f87fea89105db96d94191541">next</a> != NULL; tmp = tmp-&gt;<a class="code" href="structbp__location.html#ab193cb38f87fea89105db96d94191541">next</a>)
<a name="l02698"></a>02698               <span class="keywordflow">if</span> (tmp-&gt;<a class="code" href="structbp__location.html#ab193cb38f87fea89105db96d94191541">next</a> == loc)
<a name="l02699"></a>02699                 {
<a name="l02700"></a>02700                   tmp-&gt;<a class="code" href="structbp__location.html#ab193cb38f87fea89105db96d94191541">next</a> = loc-&gt;<a class="code" href="structbp__location.html#ab193cb38f87fea89105db96d94191541">next</a>;
<a name="l02701"></a>02701                   <span class="keywordflow">break</span>;
<a name="l02702"></a>02702                 }
<a name="l02703"></a>02703         }
<a name="l02704"></a>02704     }
<a name="l02705"></a>02705 
<a name="l02706"></a>02706   <span class="comment">/* Now update the global location list to permanently delete the</span>
<a name="l02707"></a>02707 <span class="comment">     removed locations above.  */</span>
<a name="l02708"></a>02708   update_global_location_list (0);
<a name="l02709"></a>02709 }
<a name="l02710"></a>02710 
<a name="l02711"></a>02711 <span class="comment">/* Make sure all breakpoints are inserted in inferior.</span>
<a name="l02712"></a>02712 <span class="comment">   Throws exception on any error.</span>
<a name="l02713"></a>02713 <span class="comment">   A breakpoint that is already inserted won&#39;t be inserted</span>
<a name="l02714"></a>02714 <span class="comment">   again, so calling this function twice is safe.  */</span>
<a name="l02715"></a>02715 <span class="keywordtype">void</span>
<a name="l02716"></a><a class="code" href="breakpoint_8h.html#ad7f103d97fab3402a0d4273193d45cf4">02716</a> <a class="code" href="breakpoint_8c.html#ad7f103d97fab3402a0d4273193d45cf4">insert_breakpoints</a> (<span class="keywordtype">void</span>)
<a name="l02717"></a>02717 {
<a name="l02718"></a>02718   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *bpt;
<a name="l02719"></a>02719 
<a name="l02720"></a>02720   <a class="code" href="breakpoint_8c.html#a781d5d3dc50a92364edfbacac3d0c107">ALL_BREAKPOINTS</a> (bpt)
<a name="l02721"></a>02721     <span class="keywordflow">if</span> (is_hardware_watchpoint (bpt))
<a name="l02722"></a>02722       {
<a name="l02723"></a>02723         <span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *w = (<span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *) bpt;
<a name="l02724"></a>02724 
<a name="l02725"></a>02725         update_watchpoint (w, 0 <span class="comment">/* don&#39;t reparse.  */</span>);
<a name="l02726"></a>02726       }
<a name="l02727"></a>02727 
<a name="l02728"></a>02728   update_global_location_list (1);
<a name="l02729"></a>02729 
<a name="l02730"></a>02730   <span class="comment">/* update_global_location_list does not insert breakpoints when</span>
<a name="l02731"></a>02731 <span class="comment">     always_inserted_mode is not enabled.  Explicitly insert them</span>
<a name="l02732"></a>02732 <span class="comment">     now.  */</span>
<a name="l02733"></a>02733   <span class="keywordflow">if</span> (!<a class="code" href="breakpoint_8c.html#a95acbb90087d0c5f6bd455fa8fcdafdc">breakpoints_always_inserted_mode</a> ())
<a name="l02734"></a>02734     insert_breakpoint_locations ();
<a name="l02735"></a>02735 }
<a name="l02736"></a>02736 
<a name="l02737"></a>02737 <span class="comment">/* Invoke CALLBACK for each of bp_location.  */</span>
<a name="l02738"></a>02738 
<a name="l02739"></a>02739 <span class="keywordtype">void</span>
<a name="l02740"></a><a class="code" href="breakpoint_8h.html#a478fa98f77e0ace372c5c85f43ad27b4">02740</a> <a class="code" href="breakpoint_8c.html#a69c23766a7dc86fd6b043e222996244f">iterate_over_bp_locations</a> (<a class="code" href="breakpoint_8h.html#a7e2ec63317e09656785b89bd99d53578">walk_bp_location_callback</a> callback)
<a name="l02741"></a>02741 {
<a name="l02742"></a>02742   <span class="keyword">struct </span>bp_location *loc, **loc_tmp;
<a name="l02743"></a>02743 
<a name="l02744"></a>02744   <a class="code" href="breakpoint_8c.html#a6f97c7962df1d91150e0e8de40ff7fe4">ALL_BP_LOCATIONS</a> (loc, loc_tmp)
<a name="l02745"></a>02745     {
<a name="l02746"></a>02746       callback (loc, NULL);
<a name="l02747"></a>02747     }
<a name="l02748"></a>02748 }
<a name="l02749"></a>02749 
<a name="l02750"></a>02750 <span class="comment">/* This is used when we need to synch breakpoint conditions between GDB and the</span>
<a name="l02751"></a>02751 <span class="comment">   target.  It is the case with deleting and disabling of breakpoints when using</span>
<a name="l02752"></a>02752 <span class="comment">   always-inserted mode.  */</span>
<a name="l02753"></a>02753 
<a name="l02754"></a>02754 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l02755"></a>02755 update_inserted_breakpoint_locations (<span class="keywordtype">void</span>)
<a name="l02756"></a>02756 {
<a name="l02757"></a>02757   <span class="keyword">struct </span>bp_location *bl, **blp_tmp;
<a name="l02758"></a>02758   <span class="keywordtype">int</span> error_flag = 0;
<a name="l02759"></a>02759   <span class="keywordtype">int</span> val = 0;
<a name="l02760"></a>02760   <span class="keywordtype">int</span> disabled_breaks = 0;
<a name="l02761"></a>02761   <span class="keywordtype">int</span> hw_breakpoint_error = 0;
<a name="l02762"></a>02762   <span class="keywordtype">int</span> hw_bp_details_reported = 0;
<a name="l02763"></a>02763 
<a name="l02764"></a>02764   <span class="keyword">struct </span>ui_file *tmp_error_stream = <a class="code" href="ui-file_8c.html#a340771735f105582d314e191a399a45c">mem_fileopen</a> ();
<a name="l02765"></a>02765   <span class="keyword">struct </span>cleanup *cleanups = <a class="code" href="utils_8c.html#a94dc56baeb57791e114136764f7763aa">make_cleanup_ui_file_delete</a> (tmp_error_stream);
<a name="l02766"></a>02766 
<a name="l02767"></a>02767   <span class="comment">/* Explicitly mark the warning -- this will only be printed if</span>
<a name="l02768"></a>02768 <span class="comment">     there was an error.  */</span>
<a name="l02769"></a>02769   <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (tmp_error_stream, <span class="stringliteral">&quot;Warning:\n&quot;</span>);
<a name="l02770"></a>02770 
<a name="l02771"></a>02771   <a class="code" href="progspace_8c.html#a6326460454db4e192e2bc221cb322977">save_current_space_and_thread</a> ();
<a name="l02772"></a>02772 
<a name="l02773"></a>02773   <a class="code" href="breakpoint_8c.html#a6f97c7962df1d91150e0e8de40ff7fe4">ALL_BP_LOCATIONS</a> (bl, blp_tmp)
<a name="l02774"></a>02774     {
<a name="l02775"></a>02775       <span class="comment">/* We only want to update software breakpoints and hardware</span>
<a name="l02776"></a>02776 <span class="comment">         breakpoints.  */</span>
<a name="l02777"></a>02777       <span class="keywordflow">if</span> (!<a class="code" href="breakpoint_8c.html#a5de9005cc5b36d1d327aa9127ea64f9c">is_breakpoint</a> (bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>))
<a name="l02778"></a>02778         <span class="keywordflow">continue</span>;
<a name="l02779"></a>02779 
<a name="l02780"></a>02780       <span class="comment">/* We only want to update locations that are already inserted</span>
<a name="l02781"></a>02781 <span class="comment">         and need updating.  This is to avoid unwanted insertion during</span>
<a name="l02782"></a>02782 <span class="comment">         deletion of breakpoints.  */</span>
<a name="l02783"></a>02783       <span class="keywordflow">if</span> (!bl-&gt;<a class="code" href="structbp__location.html#acb0b475579bbe5dabeb8ed4504527105">inserted</a> || (bl-&gt;<a class="code" href="structbp__location.html#acb0b475579bbe5dabeb8ed4504527105">inserted</a> &amp;&amp; !bl-&gt;<a class="code" href="structbp__location.html#a5bd9bf988af6d6e3d330fca3361a6a6b">needs_update</a>))
<a name="l02784"></a>02784         <span class="keywordflow">continue</span>;
<a name="l02785"></a>02785 
<a name="l02786"></a>02786       <a class="code" href="progspace_8c.html#a58d979e46585ad85280e488204e0147e">switch_to_program_space_and_thread</a> (bl-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a>);
<a name="l02787"></a>02787 
<a name="l02788"></a>02788       <span class="comment">/* For targets that support global breakpoints, there&#39;s no need</span>
<a name="l02789"></a>02789 <span class="comment">         to select an inferior to insert breakpoint to.  In fact, even</span>
<a name="l02790"></a>02790 <span class="comment">         if we aren&#39;t attached to any process yet, we should still</span>
<a name="l02791"></a>02791 <span class="comment">         insert breakpoints.  */</span>
<a name="l02792"></a>02792       <span class="keywordflow">if</span> (!<a class="code" href="gdbarch_8c.html#a5e7deb9f392fcd0f807759896fe00919">gdbarch_has_global_breakpoints</a> (<a class="code" href="gdbarch_8c.html#ad648a33f69abe34e9679744a0c5a0580">target_gdbarch</a> ())
<a name="l02793"></a>02793           &amp;&amp; <a class="code" href="ptid_8c.html#a0df58c8db2620a2cec647934b4f77266">ptid_equal</a> (<a class="code" href="infcmd_8c.html#a428c5be9ce5e70bd03760e828e19c6b7">inferior_ptid</a>, <a class="code" href="ptid_8c.html#acba69c857786546b204883bbcc90a64e">null_ptid</a>))
<a name="l02794"></a>02794         <span class="keywordflow">continue</span>;
<a name="l02795"></a>02795 
<a name="l02796"></a>02796       val = insert_bp_location (bl, tmp_error_stream, &amp;disabled_breaks,
<a name="l02797"></a>02797                                     &amp;hw_breakpoint_error, &amp;hw_bp_details_reported);
<a name="l02798"></a>02798       <span class="keywordflow">if</span> (val)
<a name="l02799"></a>02799         error_flag = val;
<a name="l02800"></a>02800     }
<a name="l02801"></a>02801 
<a name="l02802"></a>02802   <span class="keywordflow">if</span> (error_flag)
<a name="l02803"></a>02803     {
<a name="l02804"></a>02804       <a class="code" href="target_8h.html#a7369fcccf2537d98bda58de2a655e1d2">target_terminal_ours_for_output</a> ();
<a name="l02805"></a>02805       <a class="code" href="utils_8c.html#a69e8a646c36b9b168a29f57ceb282cec">error_stream</a> (tmp_error_stream);
<a name="l02806"></a>02806     }
<a name="l02807"></a>02807 
<a name="l02808"></a>02808   <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (cleanups);
<a name="l02809"></a>02809 }
<a name="l02810"></a>02810 
<a name="l02811"></a>02811 <span class="comment">/* Used when starting or continuing the program.  */</span>
<a name="l02812"></a>02812 
<a name="l02813"></a>02813 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l02814"></a>02814 insert_breakpoint_locations (<span class="keywordtype">void</span>)
<a name="l02815"></a>02815 {
<a name="l02816"></a>02816   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *bpt;
<a name="l02817"></a>02817   <span class="keyword">struct </span>bp_location *bl, **blp_tmp;
<a name="l02818"></a>02818   <span class="keywordtype">int</span> error_flag = 0;
<a name="l02819"></a>02819   <span class="keywordtype">int</span> val = 0;
<a name="l02820"></a>02820   <span class="keywordtype">int</span> disabled_breaks = 0;
<a name="l02821"></a>02821   <span class="keywordtype">int</span> hw_breakpoint_error = 0;
<a name="l02822"></a>02822   <span class="keywordtype">int</span> hw_bp_error_explained_already = 0;
<a name="l02823"></a>02823 
<a name="l02824"></a>02824   <span class="keyword">struct </span>ui_file *tmp_error_stream = <a class="code" href="ui-file_8c.html#a340771735f105582d314e191a399a45c">mem_fileopen</a> ();
<a name="l02825"></a>02825   <span class="keyword">struct </span>cleanup *cleanups = <a class="code" href="utils_8c.html#a94dc56baeb57791e114136764f7763aa">make_cleanup_ui_file_delete</a> (tmp_error_stream);
<a name="l02826"></a>02826   
<a name="l02827"></a>02827   <span class="comment">/* Explicitly mark the warning -- this will only be printed if</span>
<a name="l02828"></a>02828 <span class="comment">     there was an error.  */</span>
<a name="l02829"></a>02829   <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (tmp_error_stream, <span class="stringliteral">&quot;Warning:\n&quot;</span>);
<a name="l02830"></a>02830 
<a name="l02831"></a>02831   <a class="code" href="progspace_8c.html#a6326460454db4e192e2bc221cb322977">save_current_space_and_thread</a> ();
<a name="l02832"></a>02832 
<a name="l02833"></a>02833   <a class="code" href="breakpoint_8c.html#a6f97c7962df1d91150e0e8de40ff7fe4">ALL_BP_LOCATIONS</a> (bl, blp_tmp)
<a name="l02834"></a>02834     {
<a name="l02835"></a>02835       <span class="keywordflow">if</span> (!should_be_inserted (bl) || (bl-&gt;<a class="code" href="structbp__location.html#acb0b475579bbe5dabeb8ed4504527105">inserted</a> &amp;&amp; !bl-&gt;<a class="code" href="structbp__location.html#a5bd9bf988af6d6e3d330fca3361a6a6b">needs_update</a>))
<a name="l02836"></a>02836         <span class="keywordflow">continue</span>;
<a name="l02837"></a>02837 
<a name="l02838"></a>02838       <span class="comment">/* There is no point inserting thread-specific breakpoints if</span>
<a name="l02839"></a>02839 <span class="comment">         the thread no longer exists.  ALL_BP_LOCATIONS bp_location</span>
<a name="l02840"></a>02840 <span class="comment">         has BL-&gt;OWNER always non-NULL.  */</span>
<a name="l02841"></a>02841       <span class="keywordflow">if</span> (bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#ae8613b6d8cf464f30ea39597be0cc192">thread</a> != -1
<a name="l02842"></a>02842           &amp;&amp; !<a class="code" href="gdbthread_8h.html#aeadadfd9ed468cfe8d004dcb4b31f471">valid_thread_id</a> (bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#ae8613b6d8cf464f30ea39597be0cc192">thread</a>))
<a name="l02843"></a>02843         <span class="keywordflow">continue</span>;
<a name="l02844"></a>02844 
<a name="l02845"></a>02845       <a class="code" href="progspace_8c.html#a58d979e46585ad85280e488204e0147e">switch_to_program_space_and_thread</a> (bl-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a>);
<a name="l02846"></a>02846 
<a name="l02847"></a>02847       <span class="comment">/* For targets that support global breakpoints, there&#39;s no need</span>
<a name="l02848"></a>02848 <span class="comment">         to select an inferior to insert breakpoint to.  In fact, even</span>
<a name="l02849"></a>02849 <span class="comment">         if we aren&#39;t attached to any process yet, we should still</span>
<a name="l02850"></a>02850 <span class="comment">         insert breakpoints.  */</span>
<a name="l02851"></a>02851       <span class="keywordflow">if</span> (!<a class="code" href="gdbarch_8c.html#a5e7deb9f392fcd0f807759896fe00919">gdbarch_has_global_breakpoints</a> (<a class="code" href="gdbarch_8c.html#ad648a33f69abe34e9679744a0c5a0580">target_gdbarch</a> ())
<a name="l02852"></a>02852           &amp;&amp; <a class="code" href="ptid_8c.html#a0df58c8db2620a2cec647934b4f77266">ptid_equal</a> (<a class="code" href="infcmd_8c.html#a428c5be9ce5e70bd03760e828e19c6b7">inferior_ptid</a>, <a class="code" href="ptid_8c.html#acba69c857786546b204883bbcc90a64e">null_ptid</a>))
<a name="l02853"></a>02853         <span class="keywordflow">continue</span>;
<a name="l02854"></a>02854 
<a name="l02855"></a>02855       val = insert_bp_location (bl, tmp_error_stream, &amp;disabled_breaks,
<a name="l02856"></a>02856                                     &amp;hw_breakpoint_error, &amp;hw_bp_error_explained_already);
<a name="l02857"></a>02857       <span class="keywordflow">if</span> (val)
<a name="l02858"></a>02858         error_flag = val;
<a name="l02859"></a>02859     }
<a name="l02860"></a>02860 
<a name="l02861"></a>02861   <span class="comment">/* If we failed to insert all locations of a watchpoint, remove</span>
<a name="l02862"></a>02862 <span class="comment">     them, as half-inserted watchpoint is of limited use.  */</span>
<a name="l02863"></a>02863   <a class="code" href="breakpoint_8c.html#a781d5d3dc50a92364edfbacac3d0c107">ALL_BREAKPOINTS</a> (bpt)  
<a name="l02864"></a>02864     {
<a name="l02865"></a>02865       <span class="keywordtype">int</span> some_failed = 0;
<a name="l02866"></a>02866       <span class="keyword">struct </span>bp_location *loc;
<a name="l02867"></a>02867 
<a name="l02868"></a>02868       <span class="keywordflow">if</span> (!is_hardware_watchpoint (bpt))
<a name="l02869"></a>02869         <span class="keywordflow">continue</span>;
<a name="l02870"></a>02870 
<a name="l02871"></a>02871       <span class="keywordflow">if</span> (!breakpoint_enabled (bpt))
<a name="l02872"></a>02872         <span class="keywordflow">continue</span>;
<a name="l02873"></a>02873 
<a name="l02874"></a>02874       <span class="keywordflow">if</span> (bpt-&gt;<a class="code" href="structbreakpoint.html#a75f0f9a837eac292ab6e768e8d8f1bd7">disposition</a> == <a class="code" href="breakpoint_8h.html#a15f2bbd9012f59bc09d59feef0c15732a9b0a2ed54849261d15631bb5e654843b">disp_del_at_next_stop</a>)
<a name="l02875"></a>02875         <span class="keywordflow">continue</span>;
<a name="l02876"></a>02876       
<a name="l02877"></a>02877       <span class="keywordflow">for</span> (loc = bpt-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>; loc; loc = loc-&gt;<a class="code" href="structbp__location.html#ab193cb38f87fea89105db96d94191541">next</a>)
<a name="l02878"></a>02878         <span class="keywordflow">if</span> (!loc-&gt;<a class="code" href="structbp__location.html#acb0b475579bbe5dabeb8ed4504527105">inserted</a> &amp;&amp; should_be_inserted (loc))
<a name="l02879"></a>02879           {
<a name="l02880"></a>02880             some_failed = 1;
<a name="l02881"></a>02881             <span class="keywordflow">break</span>;
<a name="l02882"></a>02882           }
<a name="l02883"></a>02883       <span class="keywordflow">if</span> (some_failed)
<a name="l02884"></a>02884         {
<a name="l02885"></a>02885           <span class="keywordflow">for</span> (loc = bpt-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>; loc; loc = loc-&gt;<a class="code" href="structbp__location.html#ab193cb38f87fea89105db96d94191541">next</a>)
<a name="l02886"></a>02886             <span class="keywordflow">if</span> (loc-&gt;<a class="code" href="structbp__location.html#acb0b475579bbe5dabeb8ed4504527105">inserted</a>)
<a name="l02887"></a>02887               remove_breakpoint (loc, <a class="code" href="breakpoint_8c.html#a644fb6ed981d6c6fe6276d324ac6be1caf92bac8f4a4afba3b9b475022a52dde2">mark_uninserted</a>);
<a name="l02888"></a>02888 
<a name="l02889"></a>02889           hw_breakpoint_error = 1;
<a name="l02890"></a>02890           <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (tmp_error_stream,
<a name="l02891"></a>02891                               <span class="stringliteral">&quot;Could not insert hardware watchpoint %d.\n&quot;</span>, 
<a name="l02892"></a>02892                               bpt-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>);
<a name="l02893"></a>02893           error_flag = -1;
<a name="l02894"></a>02894         }
<a name="l02895"></a>02895     }
<a name="l02896"></a>02896 
<a name="l02897"></a>02897   <span class="keywordflow">if</span> (error_flag)
<a name="l02898"></a>02898     {
<a name="l02899"></a>02899       <span class="comment">/* If a hardware breakpoint or watchpoint was inserted, add a</span>
<a name="l02900"></a>02900 <span class="comment">         message about possibly exhausted resources.  */</span>
<a name="l02901"></a>02901       <span class="keywordflow">if</span> (hw_breakpoint_error &amp;&amp; !hw_bp_error_explained_already)
<a name="l02902"></a>02902         {
<a name="l02903"></a>02903           <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (tmp_error_stream, 
<a name="l02904"></a>02904                               <span class="stringliteral">&quot;Could not insert hardware breakpoints:\n\</span>
<a name="l02905"></a>02905 <span class="stringliteral">You may have requested too many hardware breakpoints/watchpoints.\n&quot;</span>);
<a name="l02906"></a>02906         }
<a name="l02907"></a>02907       <a class="code" href="target_8h.html#a7369fcccf2537d98bda58de2a655e1d2">target_terminal_ours_for_output</a> ();
<a name="l02908"></a>02908       <a class="code" href="utils_8c.html#a69e8a646c36b9b168a29f57ceb282cec">error_stream</a> (tmp_error_stream);
<a name="l02909"></a>02909     }
<a name="l02910"></a>02910 
<a name="l02911"></a>02911   <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (cleanups);
<a name="l02912"></a>02912 }
<a name="l02913"></a>02913 
<a name="l02914"></a>02914 <span class="comment">/* Used when the program stops.</span>
<a name="l02915"></a>02915 <span class="comment">   Returns zero if successful, or non-zero if there was a problem</span>
<a name="l02916"></a>02916 <span class="comment">   removing a breakpoint location.  */</span>
<a name="l02917"></a>02917 
<a name="l02918"></a>02918 <span class="keywordtype">int</span>
<a name="l02919"></a><a class="code" href="breakpoint_8h.html#a2db16b74521896c3272f36c1b09c28e6">02919</a> <a class="code" href="breakpoint_8c.html#a2db16b74521896c3272f36c1b09c28e6">remove_breakpoints</a> (<span class="keywordtype">void</span>)
<a name="l02920"></a>02920 {
<a name="l02921"></a>02921   <span class="keyword">struct </span>bp_location *bl, **blp_tmp;
<a name="l02922"></a>02922   <span class="keywordtype">int</span> val = 0;
<a name="l02923"></a>02923 
<a name="l02924"></a>02924   <a class="code" href="breakpoint_8c.html#a6f97c7962df1d91150e0e8de40ff7fe4">ALL_BP_LOCATIONS</a> (bl, blp_tmp)
<a name="l02925"></a>02925   {
<a name="l02926"></a>02926     <span class="keywordflow">if</span> (bl-&gt;<a class="code" href="structbp__location.html#acb0b475579bbe5dabeb8ed4504527105">inserted</a> &amp;&amp; !<a class="code" href="breakpoint_8c.html#ac537492fb781218601862c78225bd118">is_tracepoint</a> (bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>))
<a name="l02927"></a>02927       val |= remove_breakpoint (bl, <a class="code" href="breakpoint_8c.html#a644fb6ed981d6c6fe6276d324ac6be1caf92bac8f4a4afba3b9b475022a52dde2">mark_uninserted</a>);
<a name="l02928"></a>02928   }
<a name="l02929"></a>02929   <span class="keywordflow">return</span> val;
<a name="l02930"></a>02930 }
<a name="l02931"></a>02931 
<a name="l02932"></a>02932 <span class="comment">/* When a thread exits, remove breakpoints that are related to</span>
<a name="l02933"></a>02933 <span class="comment">   that thread.  */</span>
<a name="l02934"></a>02934 
<a name="l02935"></a>02935 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l02936"></a>02936 remove_threaded_breakpoints (<span class="keyword">struct</span> <a class="code" href="structthread__info.html">thread_info</a> *tp, <span class="keywordtype">int</span> silent)
<a name="l02937"></a>02937 {
<a name="l02938"></a>02938   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b, *b_tmp;
<a name="l02939"></a>02939 
<a name="l02940"></a>02940   <a class="code" href="breakpoint_8c.html#ace15af58ae54149fbef6d72ecb61e12d">ALL_BREAKPOINTS_SAFE</a> (b, b_tmp)
<a name="l02941"></a>02941     {
<a name="l02942"></a>02942       <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#ae8613b6d8cf464f30ea39597be0cc192">thread</a> == tp-&gt;<a class="code" href="structthread__info.html#a64accc7e3d39da1d926c23877f9f9d0d">num</a> &amp;&amp; <a class="code" href="breakpoint_8c.html#ac7893fb93c9f1d907b89a1655481602d">user_breakpoint_p</a> (b))
<a name="l02943"></a>02943         {
<a name="l02944"></a>02944           b-&gt;<a class="code" href="structbreakpoint.html#a75f0f9a837eac292ab6e768e8d8f1bd7">disposition</a> = <a class="code" href="breakpoint_8h.html#a15f2bbd9012f59bc09d59feef0c15732a9b0a2ed54849261d15631bb5e654843b">disp_del_at_next_stop</a>;
<a name="l02945"></a>02945 
<a name="l02946"></a>02946           <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l02947"></a>02947 <span class="stringliteral">Thread-specific breakpoint %d deleted - thread %d no longer in the thread list.\n&quot;</span>),
<a name="l02948"></a>02948                           b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>, tp-&gt;<a class="code" href="structthread__info.html#a64accc7e3d39da1d926c23877f9f9d0d">num</a>);
<a name="l02949"></a>02949 
<a name="l02950"></a>02950           <span class="comment">/* Hide it from the user.  */</span>
<a name="l02951"></a>02951           b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a> = 0;
<a name="l02952"></a>02952        }
<a name="l02953"></a>02953     }
<a name="l02954"></a>02954 }
<a name="l02955"></a>02955 
<a name="l02956"></a>02956 <span class="comment">/* Remove breakpoints of process PID.  */</span>
<a name="l02957"></a>02957 
<a name="l02958"></a>02958 <span class="keywordtype">int</span>
<a name="l02959"></a><a class="code" href="breakpoint_8h.html#a551eab542ba19a046c7f4a9f1563b924">02959</a> <a class="code" href="breakpoint_8c.html#a551eab542ba19a046c7f4a9f1563b924">remove_breakpoints_pid</a> (<span class="keywordtype">int</span> pid)
<a name="l02960"></a>02960 {
<a name="l02961"></a>02961   <span class="keyword">struct </span>bp_location *bl, **blp_tmp;
<a name="l02962"></a>02962   <span class="keywordtype">int</span> val;
<a name="l02963"></a>02963   <span class="keyword">struct </span><a class="code" href="structinferior.html">inferior</a> *<a class="code" href="namespacearm-linux.html#aaf6bae53545ee96f24d7ba560ed0a205">inf</a> = <a class="code" href="inferior_8c.html#aa6cb4e509f05c4b88a55198f804dc2cc">find_inferior_pid</a> (pid);
<a name="l02964"></a>02964 
<a name="l02965"></a>02965   <a class="code" href="breakpoint_8c.html#a6f97c7962df1d91150e0e8de40ff7fe4">ALL_BP_LOCATIONS</a> (bl, blp_tmp)
<a name="l02966"></a>02966   {
<a name="l02967"></a>02967     <span class="keywordflow">if</span> (bl-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a> != inf-&gt;<a class="code" href="structinferior.html#afc6a557206fd753b89e34bd33e038cfe">pspace</a>)
<a name="l02968"></a>02968       <span class="keywordflow">continue</span>;
<a name="l02969"></a>02969 
<a name="l02970"></a>02970     <span class="keywordflow">if</span> (bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa404b00503edb7eba238aea705ea34231">bp_dprintf</a>)
<a name="l02971"></a>02971       <span class="keywordflow">continue</span>;
<a name="l02972"></a>02972 
<a name="l02973"></a>02973     <span class="keywordflow">if</span> (bl-&gt;<a class="code" href="structbp__location.html#acb0b475579bbe5dabeb8ed4504527105">inserted</a>)
<a name="l02974"></a>02974       {
<a name="l02975"></a>02975         val = remove_breakpoint (bl, <a class="code" href="breakpoint_8c.html#a644fb6ed981d6c6fe6276d324ac6be1caf92bac8f4a4afba3b9b475022a52dde2">mark_uninserted</a>);
<a name="l02976"></a>02976         <span class="keywordflow">if</span> (val != 0)
<a name="l02977"></a>02977           <span class="keywordflow">return</span> val;
<a name="l02978"></a>02978       }
<a name="l02979"></a>02979   }
<a name="l02980"></a>02980   <span class="keywordflow">return</span> 0;
<a name="l02981"></a>02981 }
<a name="l02982"></a>02982 
<a name="l02983"></a>02983 <span class="keywordtype">int</span>
<a name="l02984"></a><a class="code" href="breakpoint_8h.html#a151fc355495ddeb927a21546481b4aeb">02984</a> <a class="code" href="breakpoint_8c.html#a45b35de78cac5d3b7c95515e7911a381">reattach_breakpoints</a> (<span class="keywordtype">int</span> <a class="code" href="structinferior.html#a1be87f581dbb6c893dbe1f2ff701636a">pid</a>)
<a name="l02985"></a>02985 {
<a name="l02986"></a>02986   <span class="keyword">struct </span>cleanup *old_chain;
<a name="l02987"></a>02987   <span class="keyword">struct </span>bp_location *bl, **blp_tmp;
<a name="l02988"></a>02988   <span class="keywordtype">int</span> val;
<a name="l02989"></a>02989   <span class="keyword">struct </span>ui_file *tmp_error_stream;
<a name="l02990"></a>02990   <span class="keywordtype">int</span> dummy1 = 0, dummy2 = 0, dummy3 = 0;
<a name="l02991"></a>02991   <span class="keyword">struct </span><a class="code" href="structinferior.html">inferior</a> *<a class="code" href="namespacearm-linux.html#aaf6bae53545ee96f24d7ba560ed0a205">inf</a>;
<a name="l02992"></a>02992   <span class="keyword">struct </span><a class="code" href="structthread__info.html">thread_info</a> *tp;
<a name="l02993"></a>02993 
<a name="l02994"></a>02994   tp = <a class="code" href="gdbthread_8h.html#a57e86f519208adb580413258d6992f85">any_live_thread_of_process</a> (pid);
<a name="l02995"></a>02995   <span class="keywordflow">if</span> (tp == NULL)
<a name="l02996"></a>02996     <span class="keywordflow">return</span> 1;
<a name="l02997"></a>02997 
<a name="l02998"></a>02998   inf = <a class="code" href="inferior_8c.html#aa6cb4e509f05c4b88a55198f804dc2cc">find_inferior_pid</a> (pid);
<a name="l02999"></a>02999   old_chain = <a class="code" href="inferior_8h.html#a3f4175640dba9bda8c87957bb0c183fb">save_inferior_ptid</a> ();
<a name="l03000"></a>03000 
<a name="l03001"></a>03001   <a class="code" href="infcmd_8c.html#a428c5be9ce5e70bd03760e828e19c6b7">inferior_ptid</a> = tp-&gt;<a class="code" href="structthread__info.html#a533aa3979b60affd446e9fbff93fdd2c">ptid</a>;
<a name="l03002"></a>03002 
<a name="l03003"></a>03003   tmp_error_stream = <a class="code" href="ui-file_8c.html#a340771735f105582d314e191a399a45c">mem_fileopen</a> ();
<a name="l03004"></a>03004   <a class="code" href="utils_8c.html#a94dc56baeb57791e114136764f7763aa">make_cleanup_ui_file_delete</a> (tmp_error_stream);
<a name="l03005"></a>03005 
<a name="l03006"></a>03006   <a class="code" href="breakpoint_8c.html#a6f97c7962df1d91150e0e8de40ff7fe4">ALL_BP_LOCATIONS</a> (bl, blp_tmp)
<a name="l03007"></a>03007   {
<a name="l03008"></a>03008     <span class="keywordflow">if</span> (bl-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a> != inf-&gt;<a class="code" href="structinferior.html#afc6a557206fd753b89e34bd33e038cfe">pspace</a>)
<a name="l03009"></a>03009       <span class="keywordflow">continue</span>;
<a name="l03010"></a>03010 
<a name="l03011"></a>03011     <span class="keywordflow">if</span> (bl-&gt;<a class="code" href="structbp__location.html#acb0b475579bbe5dabeb8ed4504527105">inserted</a>)
<a name="l03012"></a>03012       {
<a name="l03013"></a>03013         bl-&gt;<a class="code" href="structbp__location.html#acb0b475579bbe5dabeb8ed4504527105">inserted</a> = 0;
<a name="l03014"></a>03014         val = insert_bp_location (bl, tmp_error_stream, &amp;dummy1, &amp;dummy2, &amp;dummy3);
<a name="l03015"></a>03015         <span class="keywordflow">if</span> (val != 0)
<a name="l03016"></a>03016           {
<a name="l03017"></a>03017             <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (old_chain);
<a name="l03018"></a>03018             <span class="keywordflow">return</span> val;
<a name="l03019"></a>03019           }
<a name="l03020"></a>03020       }
<a name="l03021"></a>03021   }
<a name="l03022"></a>03022   <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (old_chain);
<a name="l03023"></a>03023   <span class="keywordflow">return</span> 0;
<a name="l03024"></a>03024 }
<a name="l03025"></a>03025 
<a name="l03026"></a>03026 <span class="keyword">static</span> <span class="keywordtype">int</span> internal_breakpoint_number = -1;
<a name="l03027"></a>03027 
<a name="l03028"></a>03028 <span class="comment">/* Set the breakpoint number of B, depending on the value of INTERNAL.</span>
<a name="l03029"></a>03029 <span class="comment">   If INTERNAL is non-zero, the breakpoint number will be populated</span>
<a name="l03030"></a>03030 <span class="comment">   from internal_breakpoint_number and that variable decremented.</span>
<a name="l03031"></a>03031 <span class="comment">   Otherwise the breakpoint number will be populated from</span>
<a name="l03032"></a>03032 <span class="comment">   breakpoint_count and that value incremented.  Internal breakpoints</span>
<a name="l03033"></a>03033 <span class="comment">   do not set the internal var bpnum.  */</span>
<a name="l03034"></a>03034 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l03035"></a>03035 set_breakpoint_number (<span class="keywordtype">int</span> <span class="keyword">internal</span>, <span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b)
<a name="l03036"></a>03036 {
<a name="l03037"></a>03037   <span class="keywordflow">if</span> (<span class="keyword">internal</span>)
<a name="l03038"></a>03038     b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a> = internal_breakpoint_number--;
<a name="l03039"></a>03039   <span class="keywordflow">else</span>
<a name="l03040"></a>03040     {
<a name="l03041"></a>03041       set_breakpoint_count (breakpoint_count + 1);
<a name="l03042"></a>03042       b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a> = breakpoint_count;
<a name="l03043"></a>03043     }
<a name="l03044"></a>03044 }
<a name="l03045"></a>03045 
<a name="l03046"></a>03046 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *
<a name="l03047"></a>03047 create_internal_breakpoint (<span class="keyword">struct</span> gdbarch *gdbarch,
<a name="l03048"></a>03048                             <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> address, <span class="keyword">enum</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cf">bptype</a> type,
<a name="l03049"></a>03049                             <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structbreakpoint__ops.html">breakpoint_ops</a> *<a class="code" href="structbreakpoint.html#aba258aa23496f6434aaa1cf8c8dc7ea7">ops</a>)
<a name="l03050"></a>03050 {
<a name="l03051"></a>03051   <span class="keyword">struct </span><a class="code" href="structsymtab__and__line.html">symtab_and_line</a> sal;
<a name="l03052"></a>03052   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b;
<a name="l03053"></a>03053 
<a name="l03054"></a>03054   <a class="code" href="symtab_8c.html#aca3a01a4f0e1a09f99e8308faecc9028">init_sal</a> (&amp;sal);              <span class="comment">/* Initialize to zeroes.  */</span>
<a name="l03055"></a>03055 
<a name="l03056"></a>03056   sal.pc = address;
<a name="l03057"></a>03057   sal.section = <a class="code" href="symfile_8c.html#ae3387e3fa4dfcec140196f91111883c1">find_pc_overlay</a> (sal.pc);
<a name="l03058"></a>03058   sal.pspace = <a class="code" href="progspace_8c.html#a07722ff15a98814c086dda44f93380c9">current_program_space</a>;
<a name="l03059"></a>03059 
<a name="l03060"></a>03060   b = <a class="code" href="breakpoint_8c.html#a99e75dcf89d9291dc55db2453cb16a0a">set_raw_breakpoint</a> (gdbarch, sal, type, ops);
<a name="l03061"></a>03061   b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a> = internal_breakpoint_number--;
<a name="l03062"></a>03062   b-&gt;<a class="code" href="structbreakpoint.html#a75f0f9a837eac292ab6e768e8d8f1bd7">disposition</a> = <a class="code" href="breakpoint_8h.html#a15f2bbd9012f59bc09d59feef0c15732a01c974d9083d524653d3a437364958be">disp_donttouch</a>;
<a name="l03063"></a>03063 
<a name="l03064"></a>03064   <span class="keywordflow">return</span> b;
<a name="l03065"></a>03065 }
<a name="l03066"></a>03066 
<a name="l03067"></a>03067 <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> longjmp_names[] =
<a name="l03068"></a>03068   {
<a name="l03069"></a>03069     <span class="stringliteral">&quot;longjmp&quot;</span>, <span class="stringliteral">&quot;_longjmp&quot;</span>, <span class="stringliteral">&quot;siglongjmp&quot;</span>, <span class="stringliteral">&quot;_siglongjmp&quot;</span>
<a name="l03070"></a>03070   };
<a name="l03071"></a><a class="code" href="breakpoint_8c.html#aaaeef6c7d06931ad974f4d1c6eb530de">03071</a> <span class="preprocessor">#define NUM_LONGJMP_NAMES ARRAY_SIZE(longjmp_names)</span>
<a name="l03072"></a>03072 <span class="preprocessor"></span>
<a name="l03073"></a>03073 <span class="comment">/* Per-objfile data private to breakpoint.c.  */</span>
<a name="l03074"></a>03074 <span class="keyword">struct </span>breakpoint_objfile_data
<a name="l03075"></a>03075 {
<a name="l03076"></a>03076   <span class="comment">/* Minimal symbol for &quot;_ovly_debug_event&quot; (if any).  */</span>
<a name="l03077"></a>03077   <span class="keyword">struct </span><a class="code" href="structminimal__symbol.html">minimal_symbol</a> *overlay_msym;
<a name="l03078"></a>03078 
<a name="l03079"></a>03079   <span class="comment">/* Minimal symbol(s) for &quot;longjmp&quot;, &quot;siglongjmp&quot;, etc. (if any).  */</span>
<a name="l03080"></a>03080   <span class="keyword">struct </span><a class="code" href="structminimal__symbol.html">minimal_symbol</a> *longjmp_msym[<a class="code" href="breakpoint_8c.html#aaaeef6c7d06931ad974f4d1c6eb530de">NUM_LONGJMP_NAMES</a>];
<a name="l03081"></a>03081 
<a name="l03082"></a>03082   <span class="comment">/* True if we have looked for longjmp probes.  */</span>
<a name="l03083"></a>03083   <span class="keywordtype">int</span> longjmp_searched;
<a name="l03084"></a>03084 
<a name="l03085"></a>03085   <span class="comment">/* SystemTap probe points for longjmp (if any).  */</span>
<a name="l03086"></a>03086   <a class="code" href="vec_8h.html#ab084f6f29fcf16a6b15d15feb653d414">VEC</a> (<a class="code" href="structprobe.html">probe_p</a>) *longjmp_probes;
<a name="l03087"></a>03087 
<a name="l03088"></a>03088   <span class="comment">/* Minimal symbol for &quot;std::terminate()&quot; (if any).  */</span>
<a name="l03089"></a>03089   <span class="keyword">struct </span><a class="code" href="structminimal__symbol.html">minimal_symbol</a> *terminate_msym;
<a name="l03090"></a>03090 
<a name="l03091"></a>03091   <span class="comment">/* Minimal symbol for &quot;_Unwind_DebugHook&quot; (if any).  */</span>
<a name="l03092"></a>03092   <span class="keyword">struct </span><a class="code" href="structminimal__symbol.html">minimal_symbol</a> *exception_msym;
<a name="l03093"></a>03093 
<a name="l03094"></a>03094   <span class="comment">/* True if we have looked for exception probes.  */</span>
<a name="l03095"></a>03095   <span class="keywordtype">int</span> exception_searched;
<a name="l03096"></a>03096 
<a name="l03097"></a>03097   <span class="comment">/* SystemTap probe points for unwinding (if any).  */</span>
<a name="l03098"></a>03098   <a class="code" href="vec_8h.html#ab084f6f29fcf16a6b15d15feb653d414">VEC</a> (<a class="code" href="structprobe.html">probe_p</a>) *exception_probes;
<a name="l03099"></a>03099 };
<a name="l03100"></a>03100 
<a name="l03101"></a>03101 <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span>objfile_data *breakpoint_objfile_key;
<a name="l03102"></a>03102 
<a name="l03103"></a>03103 <span class="comment">/* Minimal symbol not found sentinel.  */</span>
<a name="l03104"></a>03104 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structminimal__symbol.html">minimal_symbol</a> msym_not_found;
<a name="l03105"></a>03105 
<a name="l03106"></a>03106 <span class="comment">/* Returns TRUE if MSYM point to the &quot;not found&quot; sentinel.  */</span>
<a name="l03107"></a>03107 
<a name="l03108"></a>03108 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l03109"></a>03109 msym_not_found_p (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structminimal__symbol.html">minimal_symbol</a> *msym)
<a name="l03110"></a>03110 {
<a name="l03111"></a>03111   <span class="keywordflow">return</span> msym == &amp;msym_not_found;
<a name="l03112"></a>03112 }
<a name="l03113"></a>03113 
<a name="l03114"></a>03114 <span class="comment">/* Return per-objfile data needed by breakpoint.c.</span>
<a name="l03115"></a>03115 <span class="comment">   Allocate the data if necessary.  */</span>
<a name="l03116"></a>03116 
<a name="l03117"></a>03117 <span class="keyword">static</span> <span class="keyword">struct </span>breakpoint_objfile_data *
<a name="l03118"></a>03118 get_breakpoint_objfile_data (<span class="keyword">struct</span> <a class="code" href="structobjfile.html">objfile</a> *<a class="code" href="structobjfile.html">objfile</a>)
<a name="l03119"></a>03119 {
<a name="l03120"></a>03120   <span class="keyword">struct </span>breakpoint_objfile_data *bp_objfile_data;
<a name="l03121"></a>03121 
<a name="l03122"></a>03122   bp_objfile_data = objfile_data (objfile, breakpoint_objfile_key);
<a name="l03123"></a>03123   <span class="keywordflow">if</span> (bp_objfile_data == NULL)
<a name="l03124"></a>03124     {
<a name="l03125"></a>03125       bp_objfile_data = obstack_alloc (&amp;objfile-&gt;<a class="code" href="structobjfile.html#aab9cedc53383f1b540f0b725edd2d9be">objfile_obstack</a>,
<a name="l03126"></a>03126                                        sizeof (*bp_objfile_data));
<a name="l03127"></a>03127 
<a name="l03128"></a>03128       <a class="code" href="gdb__string_8h.html#adb03df3679ce1445e801310614624ccb">memset</a> (bp_objfile_data, 0, <span class="keyword">sizeof</span> (*bp_objfile_data));
<a name="l03129"></a>03129       set_objfile_data (objfile, breakpoint_objfile_key, bp_objfile_data);
<a name="l03130"></a>03130     }
<a name="l03131"></a>03131   <span class="keywordflow">return</span> bp_objfile_data;
<a name="l03132"></a>03132 }
<a name="l03133"></a>03133 
<a name="l03134"></a>03134 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l03135"></a>03135 free_breakpoint_probes (<span class="keyword">struct</span> objfile *obj, <span class="keywordtype">void</span> *data)
<a name="l03136"></a>03136 {
<a name="l03137"></a>03137   <span class="keyword">struct </span>breakpoint_objfile_data *bp_objfile_data = data;
<a name="l03138"></a>03138 
<a name="l03139"></a>03139   <a class="code" href="vec_8h.html#af5724b2bbce65103300279f9abe7f577">VEC_free</a> (<a class="code" href="structprobe.html">probe_p</a>, bp_objfile_data-&gt;longjmp_probes);
<a name="l03140"></a>03140   <a class="code" href="vec_8h.html#af5724b2bbce65103300279f9abe7f577">VEC_free</a> (<a class="code" href="structprobe.html">probe_p</a>, bp_objfile_data-&gt;exception_probes);
<a name="l03141"></a>03141 }
<a name="l03142"></a>03142 
<a name="l03143"></a>03143 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l03144"></a>03144 create_overlay_event_breakpoint (<span class="keywordtype">void</span>)
<a name="l03145"></a>03145 {
<a name="l03146"></a>03146   <span class="keyword">struct </span>objfile *objfile;
<a name="l03147"></a>03147   <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> func_name = <span class="stringliteral">&quot;_ovly_debug_event&quot;</span>;
<a name="l03148"></a>03148 
<a name="l03149"></a>03149   <a class="code" href="objfiles_8h.html#a8efee3b85a322006131a6056d45058b3">ALL_OBJFILES</a> (objfile)
<a name="l03150"></a>03150     {
<a name="l03151"></a>03151       <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b;
<a name="l03152"></a>03152       <span class="keyword">struct </span>breakpoint_objfile_data *bp_objfile_data;
<a name="l03153"></a>03153       <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> addr;
<a name="l03154"></a>03154 
<a name="l03155"></a>03155       bp_objfile_data = get_breakpoint_objfile_data (objfile);
<a name="l03156"></a>03156 
<a name="l03157"></a>03157       <span class="keywordflow">if</span> (msym_not_found_p (bp_objfile_data-&gt;overlay_msym))
<a name="l03158"></a>03158         <span class="keywordflow">continue</span>;
<a name="l03159"></a>03159 
<a name="l03160"></a>03160       <span class="keywordflow">if</span> (bp_objfile_data-&gt;overlay_msym == NULL)
<a name="l03161"></a>03161         {
<a name="l03162"></a>03162           <span class="keyword">struct </span><a class="code" href="structminimal__symbol.html">minimal_symbol</a> *<a class="code" href="namespacearm-linux.html#a8594a1214bfb32c5d61201101374a289">m</a>;
<a name="l03163"></a>03163 
<a name="l03164"></a>03164           m = <a class="code" href="minsyms_8c.html#aa2b6e25aa7423f6b0dc0880b0bd58b14">lookup_minimal_symbol_text</a> (func_name, objfile);
<a name="l03165"></a>03165           <span class="keywordflow">if</span> (m == NULL)
<a name="l03166"></a>03166             {
<a name="l03167"></a>03167               <span class="comment">/* Avoid future lookups in this objfile.  */</span>
<a name="l03168"></a>03168               bp_objfile_data-&gt;overlay_msym = &amp;msym_not_found;
<a name="l03169"></a>03169               <span class="keywordflow">continue</span>;
<a name="l03170"></a>03170             }
<a name="l03171"></a>03171           bp_objfile_data-&gt;overlay_msym = <a class="code" href="namespacearm-linux.html#a8594a1214bfb32c5d61201101374a289">m</a>;
<a name="l03172"></a>03172         }
<a name="l03173"></a>03173 
<a name="l03174"></a>03174       addr = <a class="code" href="symtab_8h.html#abee697b9e3bb4f4d164ad920a87ab854">SYMBOL_VALUE_ADDRESS</a> (bp_objfile_data-&gt;overlay_msym);
<a name="l03175"></a>03175       b = create_internal_breakpoint (<a class="code" href="objfiles_8c.html#a1c7101234ac2edc601fa465e48bc3463">get_objfile_arch</a> (objfile), addr,
<a name="l03176"></a>03176                                       <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa5bd9bbdb42933350595475584c48d844">bp_overlay_event</a>,
<a name="l03177"></a>03177                                       &amp;internal_breakpoint_ops);
<a name="l03178"></a>03178       b-&gt;<a class="code" href="structbreakpoint.html#a885e704e5cdcfc314069b970c396d1a4">addr_string</a> = xstrdup (func_name);
<a name="l03179"></a>03179 
<a name="l03180"></a>03180       <span class="keywordflow">if</span> (<a class="code" href="symfile_8c.html#ad96d01ef61ee2925825b3992d37408f5">overlay_debugging</a> == <a class="code" href="symfile_8h.html#aac35fb60df366f285fe7fda072f3edc2a4249ec155dcffd7f56466ba608603dcc">ovly_auto</a>)
<a name="l03181"></a>03181         {
<a name="l03182"></a>03182           b-&gt;<a class="code" href="structbreakpoint.html#acb53352fd35aaad37054508fabc0f3bf">enable_state</a> = <a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577a72f1fa981d13a62d05324c1de974b44b">bp_enabled</a>;
<a name="l03183"></a>03183           overlay_events_enabled = 1;
<a name="l03184"></a>03184         }
<a name="l03185"></a>03185       <span class="keywordflow">else</span>
<a name="l03186"></a>03186        {
<a name="l03187"></a>03187          b-&gt;<a class="code" href="structbreakpoint.html#acb53352fd35aaad37054508fabc0f3bf">enable_state</a> = <a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577a4605f207d0d15bd8195c9b1aa1bfee96">bp_disabled</a>;
<a name="l03188"></a>03188          overlay_events_enabled = 0;
<a name="l03189"></a>03189        }
<a name="l03190"></a>03190     }
<a name="l03191"></a>03191   update_global_location_list (1);
<a name="l03192"></a>03192 }
<a name="l03193"></a>03193 
<a name="l03194"></a>03194 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l03195"></a>03195 create_longjmp_master_breakpoint (<span class="keywordtype">void</span>)
<a name="l03196"></a>03196 {
<a name="l03197"></a>03197   <span class="keyword">struct </span><a class="code" href="structprogram__space.html">program_space</a> *pspace;
<a name="l03198"></a>03198   <span class="keyword">struct </span>cleanup *old_chain;
<a name="l03199"></a>03199 
<a name="l03200"></a>03200   old_chain = <a class="code" href="progspace_8c.html#a702df4a5aa34e81fc0bb38dd8c2d68df">save_current_program_space</a> ();
<a name="l03201"></a>03201 
<a name="l03202"></a>03202   <a class="code" href="progspace_8h.html#a9e4091a3fcf8c96cb18cf2042cbe21f6">ALL_PSPACES</a> (pspace)
<a name="l03203"></a>03203   {
<a name="l03204"></a>03204     <span class="keyword">struct </span>objfile *objfile;
<a name="l03205"></a>03205 
<a name="l03206"></a>03206     <a class="code" href="progspace_8c.html#a394457638b3e584a3ecd019df372209f">set_current_program_space</a> (pspace);
<a name="l03207"></a>03207 
<a name="l03208"></a>03208     <a class="code" href="objfiles_8h.html#a8efee3b85a322006131a6056d45058b3">ALL_OBJFILES</a> (objfile)
<a name="l03209"></a>03209     {
<a name="l03210"></a>03210       <span class="keywordtype">int</span> i;
<a name="l03211"></a>03211       <span class="keyword">struct </span>gdbarch *gdbarch;
<a name="l03212"></a>03212       <span class="keyword">struct </span>breakpoint_objfile_data *bp_objfile_data;
<a name="l03213"></a>03213 
<a name="l03214"></a>03214       gdbarch = <a class="code" href="objfiles_8c.html#a1c7101234ac2edc601fa465e48bc3463">get_objfile_arch</a> (objfile);
<a name="l03215"></a>03215       <span class="keywordflow">if</span> (!<a class="code" href="gdbarch_8c.html#abf1e5781187b97ec381c0717d239b349">gdbarch_get_longjmp_target_p</a> (gdbarch))
<a name="l03216"></a>03216         <span class="keywordflow">continue</span>;
<a name="l03217"></a>03217 
<a name="l03218"></a>03218       bp_objfile_data = get_breakpoint_objfile_data (objfile);
<a name="l03219"></a>03219 
<a name="l03220"></a>03220       <span class="keywordflow">if</span> (!bp_objfile_data-&gt;longjmp_searched)
<a name="l03221"></a>03221         {
<a name="l03222"></a>03222           <a class="code" href="vec_8h.html#ab084f6f29fcf16a6b15d15feb653d414">VEC</a> (<a class="code" href="structprobe.html">probe_p</a>) *ret;
<a name="l03223"></a>03223 
<a name="l03224"></a>03224           ret = find_probes_in_objfile (objfile, <span class="stringliteral">&quot;libc&quot;</span>, <span class="stringliteral">&quot;longjmp&quot;</span>);
<a name="l03225"></a>03225           <span class="keywordflow">if</span> (ret != NULL)
<a name="l03226"></a>03226             {
<a name="l03227"></a>03227               <span class="comment">/* We are only interested in checking one element.  */</span>
<a name="l03228"></a>03228               <span class="keyword">struct </span><a class="code" href="structprobe.html">probe</a> *p = <a class="code" href="vec_8h.html#a49c128c353995ea8fca27be70829ca52">VEC_index</a> (<a class="code" href="structprobe.html">probe_p</a>, ret, 0);
<a name="l03229"></a>03229 
<a name="l03230"></a>03230               <span class="keywordflow">if</span> (!<a class="code" href="probe_8c.html#a92e2dbe7e3a842adfed9a31ad8424db5">can_evaluate_probe_arguments</a> (p))
<a name="l03231"></a>03231                 {
<a name="l03232"></a>03232                   <span class="comment">/* We cannot use the probe interface here, because it does</span>
<a name="l03233"></a>03233 <span class="comment">                     not know how to evaluate arguments.  */</span>
<a name="l03234"></a>03234                   <a class="code" href="vec_8h.html#af5724b2bbce65103300279f9abe7f577">VEC_free</a> (<a class="code" href="structprobe.html">probe_p</a>, ret);
<a name="l03235"></a>03235                   ret = NULL;
<a name="l03236"></a>03236                 }
<a name="l03237"></a>03237             }
<a name="l03238"></a>03238           bp_objfile_data-&gt;longjmp_probes = ret;
<a name="l03239"></a>03239           bp_objfile_data-&gt;longjmp_searched = 1;
<a name="l03240"></a>03240         }
<a name="l03241"></a>03241 
<a name="l03242"></a>03242       <span class="keywordflow">if</span> (bp_objfile_data-&gt;longjmp_probes != NULL)
<a name="l03243"></a>03243         {
<a name="l03244"></a>03244           <span class="keywordtype">int</span> i;
<a name="l03245"></a>03245           <span class="keyword">struct </span><a class="code" href="structprobe.html">probe</a> *<a class="code" href="structprobe.html">probe</a>;
<a name="l03246"></a>03246           <span class="keyword">struct </span>gdbarch *gdbarch = <a class="code" href="objfiles_8c.html#a1c7101234ac2edc601fa465e48bc3463">get_objfile_arch</a> (objfile);
<a name="l03247"></a>03247 
<a name="l03248"></a>03248           <span class="keywordflow">for</span> (i = 0;
<a name="l03249"></a>03249                <a class="code" href="vec_8h.html#ae7795b0c8e65f45eb49aac5ec2c0fa52">VEC_iterate</a> (<a class="code" href="structprobe.html">probe_p</a>,
<a name="l03250"></a>03250                             bp_objfile_data-&gt;longjmp_probes,
<a name="l03251"></a>03251                             i, probe);
<a name="l03252"></a>03252                ++i)
<a name="l03253"></a>03253             {
<a name="l03254"></a>03254               <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b;
<a name="l03255"></a>03255 
<a name="l03256"></a>03256               b = create_internal_breakpoint (gdbarch, probe-&gt;<a class="code" href="structprobe.html#aa64b386768e4a6db93180e37ad764769">address</a>,
<a name="l03257"></a>03257                                               <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfad159b4f5b0a64a88067c3d310ebed7ce">bp_longjmp_master</a>,
<a name="l03258"></a>03258                                               &amp;internal_breakpoint_ops);
<a name="l03259"></a>03259               b-&gt;<a class="code" href="structbreakpoint.html#a885e704e5cdcfc314069b970c396d1a4">addr_string</a> = xstrdup (<span class="stringliteral">&quot;-probe-stap libc:longjmp&quot;</span>);
<a name="l03260"></a>03260               b-&gt;<a class="code" href="structbreakpoint.html#acb53352fd35aaad37054508fabc0f3bf">enable_state</a> = <a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577a4605f207d0d15bd8195c9b1aa1bfee96">bp_disabled</a>;
<a name="l03261"></a>03261             }
<a name="l03262"></a>03262 
<a name="l03263"></a>03263           <span class="keywordflow">continue</span>;
<a name="l03264"></a>03264         }
<a name="l03265"></a>03265 
<a name="l03266"></a>03266       <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="breakpoint_8c.html#aaaeef6c7d06931ad974f4d1c6eb530de">NUM_LONGJMP_NAMES</a>; i++)
<a name="l03267"></a>03267         {
<a name="l03268"></a>03268           <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b;
<a name="l03269"></a>03269           <span class="keyword">const</span> <span class="keywordtype">char</span> *func_name;
<a name="l03270"></a>03270           <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> addr;
<a name="l03271"></a>03271 
<a name="l03272"></a>03272           <span class="keywordflow">if</span> (msym_not_found_p (bp_objfile_data-&gt;longjmp_msym[i]))
<a name="l03273"></a>03273             <span class="keywordflow">continue</span>;
<a name="l03274"></a>03274 
<a name="l03275"></a>03275           func_name = longjmp_names[i];
<a name="l03276"></a>03276           <span class="keywordflow">if</span> (bp_objfile_data-&gt;longjmp_msym[i] == NULL)
<a name="l03277"></a>03277             {
<a name="l03278"></a>03278               <span class="keyword">struct </span><a class="code" href="structminimal__symbol.html">minimal_symbol</a> *<a class="code" href="namespacearm-linux.html#a8594a1214bfb32c5d61201101374a289">m</a>;
<a name="l03279"></a>03279 
<a name="l03280"></a>03280               m = <a class="code" href="minsyms_8c.html#aa2b6e25aa7423f6b0dc0880b0bd58b14">lookup_minimal_symbol_text</a> (func_name, objfile);
<a name="l03281"></a>03281               <span class="keywordflow">if</span> (m == NULL)
<a name="l03282"></a>03282                 {
<a name="l03283"></a>03283                   <span class="comment">/* Prevent future lookups in this objfile.  */</span>
<a name="l03284"></a>03284                   bp_objfile_data-&gt;longjmp_msym[i] = &amp;msym_not_found;
<a name="l03285"></a>03285                   <span class="keywordflow">continue</span>;
<a name="l03286"></a>03286                 }
<a name="l03287"></a>03287               bp_objfile_data-&gt;longjmp_msym[i] = <a class="code" href="namespacearm-linux.html#a8594a1214bfb32c5d61201101374a289">m</a>;
<a name="l03288"></a>03288             }
<a name="l03289"></a>03289 
<a name="l03290"></a>03290           addr = <a class="code" href="symtab_8h.html#abee697b9e3bb4f4d164ad920a87ab854">SYMBOL_VALUE_ADDRESS</a> (bp_objfile_data-&gt;longjmp_msym[i]);
<a name="l03291"></a>03291           b = create_internal_breakpoint (gdbarch, addr, <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfad159b4f5b0a64a88067c3d310ebed7ce">bp_longjmp_master</a>,
<a name="l03292"></a>03292                                           &amp;internal_breakpoint_ops);
<a name="l03293"></a>03293           b-&gt;<a class="code" href="structbreakpoint.html#a885e704e5cdcfc314069b970c396d1a4">addr_string</a> = xstrdup (func_name);
<a name="l03294"></a>03294           b-&gt;<a class="code" href="structbreakpoint.html#acb53352fd35aaad37054508fabc0f3bf">enable_state</a> = <a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577a4605f207d0d15bd8195c9b1aa1bfee96">bp_disabled</a>;
<a name="l03295"></a>03295         }
<a name="l03296"></a>03296     }
<a name="l03297"></a>03297   }
<a name="l03298"></a>03298   update_global_location_list (1);
<a name="l03299"></a>03299 
<a name="l03300"></a>03300   <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (old_chain);
<a name="l03301"></a>03301 }
<a name="l03302"></a>03302 
<a name="l03303"></a>03303 <span class="comment">/* Create a master std::terminate breakpoint.  */</span>
<a name="l03304"></a>03304 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l03305"></a>03305 create_std_terminate_master_breakpoint (<span class="keywordtype">void</span>)
<a name="l03306"></a>03306 {
<a name="l03307"></a>03307   <span class="keyword">struct </span><a class="code" href="structprogram__space.html">program_space</a> *pspace;
<a name="l03308"></a>03308   <span class="keyword">struct </span>cleanup *old_chain;
<a name="l03309"></a>03309   <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> func_name = <span class="stringliteral">&quot;std::terminate()&quot;</span>;
<a name="l03310"></a>03310 
<a name="l03311"></a>03311   old_chain = <a class="code" href="progspace_8c.html#a702df4a5aa34e81fc0bb38dd8c2d68df">save_current_program_space</a> ();
<a name="l03312"></a>03312 
<a name="l03313"></a>03313   <a class="code" href="progspace_8h.html#a9e4091a3fcf8c96cb18cf2042cbe21f6">ALL_PSPACES</a> (pspace)
<a name="l03314"></a>03314   {
<a name="l03315"></a>03315     <span class="keyword">struct </span>objfile *objfile;
<a name="l03316"></a>03316     <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> addr;
<a name="l03317"></a>03317 
<a name="l03318"></a>03318     <a class="code" href="progspace_8c.html#a394457638b3e584a3ecd019df372209f">set_current_program_space</a> (pspace);
<a name="l03319"></a>03319 
<a name="l03320"></a>03320     <a class="code" href="objfiles_8h.html#a8efee3b85a322006131a6056d45058b3">ALL_OBJFILES</a> (objfile)
<a name="l03321"></a>03321     {
<a name="l03322"></a>03322       <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b;
<a name="l03323"></a>03323       <span class="keyword">struct </span>breakpoint_objfile_data *bp_objfile_data;
<a name="l03324"></a>03324 
<a name="l03325"></a>03325       bp_objfile_data = get_breakpoint_objfile_data (objfile);
<a name="l03326"></a>03326 
<a name="l03327"></a>03327       <span class="keywordflow">if</span> (msym_not_found_p (bp_objfile_data-&gt;terminate_msym))
<a name="l03328"></a>03328         <span class="keywordflow">continue</span>;
<a name="l03329"></a>03329 
<a name="l03330"></a>03330       <span class="keywordflow">if</span> (bp_objfile_data-&gt;terminate_msym == NULL)
<a name="l03331"></a>03331         {
<a name="l03332"></a>03332           <span class="keyword">struct </span><a class="code" href="structminimal__symbol.html">minimal_symbol</a> *<a class="code" href="namespacearm-linux.html#a8594a1214bfb32c5d61201101374a289">m</a>;
<a name="l03333"></a>03333 
<a name="l03334"></a>03334           m = <a class="code" href="minsyms_8c.html#af87f7a894386515074ddd71365bc09b8">lookup_minimal_symbol</a> (func_name, NULL, objfile);
<a name="l03335"></a>03335           <span class="keywordflow">if</span> (m == NULL || (<a class="code" href="symtab_8h.html#a1d0b27d446f2622f464727b6a06ae263">MSYMBOL_TYPE</a> (m) != <a class="code" href="symtab_8h.html#a91ee0a03aba3bbd0e221547c3d82c036af24db58d8996f50560c2f03d9c8514c0">mst_text</a>
<a name="l03336"></a>03336                             &amp;&amp; <a class="code" href="symtab_8h.html#a1d0b27d446f2622f464727b6a06ae263">MSYMBOL_TYPE</a> (m) != <a class="code" href="symtab_8h.html#a91ee0a03aba3bbd0e221547c3d82c036abe55ea8e467b6e7517e226164aa94adb">mst_file_text</a>))
<a name="l03337"></a>03337             {
<a name="l03338"></a>03338               <span class="comment">/* Prevent future lookups in this objfile.  */</span>
<a name="l03339"></a>03339               bp_objfile_data-&gt;terminate_msym = &amp;msym_not_found;
<a name="l03340"></a>03340               <span class="keywordflow">continue</span>;
<a name="l03341"></a>03341             }
<a name="l03342"></a>03342           bp_objfile_data-&gt;terminate_msym = <a class="code" href="namespacearm-linux.html#a8594a1214bfb32c5d61201101374a289">m</a>;
<a name="l03343"></a>03343         }
<a name="l03344"></a>03344 
<a name="l03345"></a>03345       addr = <a class="code" href="symtab_8h.html#abee697b9e3bb4f4d164ad920a87ab854">SYMBOL_VALUE_ADDRESS</a> (bp_objfile_data-&gt;terminate_msym);
<a name="l03346"></a>03346       b = create_internal_breakpoint (<a class="code" href="objfiles_8c.html#a1c7101234ac2edc601fa465e48bc3463">get_objfile_arch</a> (objfile), addr,
<a name="l03347"></a>03347                                       <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa0d6052d15a11c79e0c6703aeef4148ba">bp_std_terminate_master</a>,
<a name="l03348"></a>03348                                       &amp;internal_breakpoint_ops);
<a name="l03349"></a>03349       b-&gt;<a class="code" href="structbreakpoint.html#a885e704e5cdcfc314069b970c396d1a4">addr_string</a> = xstrdup (func_name);
<a name="l03350"></a>03350       b-&gt;<a class="code" href="structbreakpoint.html#acb53352fd35aaad37054508fabc0f3bf">enable_state</a> = <a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577a4605f207d0d15bd8195c9b1aa1bfee96">bp_disabled</a>;
<a name="l03351"></a>03351     }
<a name="l03352"></a>03352   }
<a name="l03353"></a>03353 
<a name="l03354"></a>03354   update_global_location_list (1);
<a name="l03355"></a>03355 
<a name="l03356"></a>03356   <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (old_chain);
<a name="l03357"></a>03357 }
<a name="l03358"></a>03358 
<a name="l03359"></a>03359 <span class="comment">/* Install a master breakpoint on the unwinder&#39;s debug hook.  */</span>
<a name="l03360"></a>03360 
<a name="l03361"></a>03361 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l03362"></a>03362 create_exception_master_breakpoint (<span class="keywordtype">void</span>)
<a name="l03363"></a>03363 {
<a name="l03364"></a>03364   <span class="keyword">struct </span>objfile *objfile;
<a name="l03365"></a>03365   <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">const</span> func_name = <span class="stringliteral">&quot;_Unwind_DebugHook&quot;</span>;
<a name="l03366"></a>03366 
<a name="l03367"></a>03367   <a class="code" href="objfiles_8h.html#a8efee3b85a322006131a6056d45058b3">ALL_OBJFILES</a> (objfile)
<a name="l03368"></a>03368     {
<a name="l03369"></a>03369       <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b;
<a name="l03370"></a>03370       <span class="keyword">struct </span>gdbarch *gdbarch;
<a name="l03371"></a>03371       <span class="keyword">struct </span>breakpoint_objfile_data *bp_objfile_data;
<a name="l03372"></a>03372       <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> addr;
<a name="l03373"></a>03373 
<a name="l03374"></a>03374       bp_objfile_data = get_breakpoint_objfile_data (objfile);
<a name="l03375"></a>03375 
<a name="l03376"></a>03376       <span class="comment">/* We prefer the SystemTap probe point if it exists.  */</span>
<a name="l03377"></a>03377       <span class="keywordflow">if</span> (!bp_objfile_data-&gt;exception_searched)
<a name="l03378"></a>03378         {
<a name="l03379"></a>03379           <a class="code" href="vec_8h.html#ab084f6f29fcf16a6b15d15feb653d414">VEC</a> (<a class="code" href="structprobe.html">probe_p</a>) *ret;
<a name="l03380"></a>03380 
<a name="l03381"></a>03381           ret = find_probes_in_objfile (objfile, <span class="stringliteral">&quot;libgcc&quot;</span>, <span class="stringliteral">&quot;unwind&quot;</span>);
<a name="l03382"></a>03382 
<a name="l03383"></a>03383           <span class="keywordflow">if</span> (ret != NULL)
<a name="l03384"></a>03384             {
<a name="l03385"></a>03385               <span class="comment">/* We are only interested in checking one element.  */</span>
<a name="l03386"></a>03386               <span class="keyword">struct </span>probe *p = <a class="code" href="vec_8h.html#a49c128c353995ea8fca27be70829ca52">VEC_index</a> (<a class="code" href="structprobe.html">probe_p</a>, ret, 0);
<a name="l03387"></a>03387 
<a name="l03388"></a>03388               <span class="keywordflow">if</span> (!<a class="code" href="probe_8c.html#a92e2dbe7e3a842adfed9a31ad8424db5">can_evaluate_probe_arguments</a> (p))
<a name="l03389"></a>03389                 {
<a name="l03390"></a>03390                   <span class="comment">/* We cannot use the probe interface here, because it does</span>
<a name="l03391"></a>03391 <span class="comment">                     not know how to evaluate arguments.  */</span>
<a name="l03392"></a>03392                   <a class="code" href="vec_8h.html#af5724b2bbce65103300279f9abe7f577">VEC_free</a> (<a class="code" href="structprobe.html">probe_p</a>, ret);
<a name="l03393"></a>03393                   ret = NULL;
<a name="l03394"></a>03394                 }
<a name="l03395"></a>03395             }
<a name="l03396"></a>03396           bp_objfile_data-&gt;exception_probes = ret;
<a name="l03397"></a>03397           bp_objfile_data-&gt;exception_searched = 1;
<a name="l03398"></a>03398         }
<a name="l03399"></a>03399 
<a name="l03400"></a>03400       <span class="keywordflow">if</span> (bp_objfile_data-&gt;exception_probes != NULL)
<a name="l03401"></a>03401         {
<a name="l03402"></a>03402           <span class="keyword">struct </span>gdbarch *gdbarch = <a class="code" href="objfiles_8c.html#a1c7101234ac2edc601fa465e48bc3463">get_objfile_arch</a> (objfile);
<a name="l03403"></a>03403           <span class="keywordtype">int</span> i;
<a name="l03404"></a>03404           <span class="keyword">struct </span>probe *probe;
<a name="l03405"></a>03405 
<a name="l03406"></a>03406           <span class="keywordflow">for</span> (i = 0;
<a name="l03407"></a>03407                <a class="code" href="vec_8h.html#ae7795b0c8e65f45eb49aac5ec2c0fa52">VEC_iterate</a> (<a class="code" href="structprobe.html">probe_p</a>,
<a name="l03408"></a>03408                             bp_objfile_data-&gt;exception_probes,
<a name="l03409"></a>03409                             i, probe);
<a name="l03410"></a>03410                ++i)
<a name="l03411"></a>03411             {
<a name="l03412"></a>03412               <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b;
<a name="l03413"></a>03413 
<a name="l03414"></a>03414               b = create_internal_breakpoint (gdbarch, probe-&gt;<a class="code" href="structprobe.html#aa64b386768e4a6db93180e37ad764769">address</a>,
<a name="l03415"></a>03415                                               <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa6d04f06608676691bf5f211117427b48">bp_exception_master</a>,
<a name="l03416"></a>03416                                               &amp;internal_breakpoint_ops);
<a name="l03417"></a>03417               b-&gt;<a class="code" href="structbreakpoint.html#a885e704e5cdcfc314069b970c396d1a4">addr_string</a> = xstrdup (<span class="stringliteral">&quot;-probe-stap libgcc:unwind&quot;</span>);
<a name="l03418"></a>03418               b-&gt;<a class="code" href="structbreakpoint.html#acb53352fd35aaad37054508fabc0f3bf">enable_state</a> = <a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577a4605f207d0d15bd8195c9b1aa1bfee96">bp_disabled</a>;
<a name="l03419"></a>03419             }
<a name="l03420"></a>03420 
<a name="l03421"></a>03421           <span class="keywordflow">continue</span>;
<a name="l03422"></a>03422         }
<a name="l03423"></a>03423 
<a name="l03424"></a>03424       <span class="comment">/* Otherwise, try the hook function.  */</span>
<a name="l03425"></a>03425 
<a name="l03426"></a>03426       <span class="keywordflow">if</span> (msym_not_found_p (bp_objfile_data-&gt;exception_msym))
<a name="l03427"></a>03427         <span class="keywordflow">continue</span>;
<a name="l03428"></a>03428 
<a name="l03429"></a>03429       gdbarch = <a class="code" href="objfiles_8c.html#a1c7101234ac2edc601fa465e48bc3463">get_objfile_arch</a> (objfile);
<a name="l03430"></a>03430 
<a name="l03431"></a>03431       <span class="keywordflow">if</span> (bp_objfile_data-&gt;exception_msym == NULL)
<a name="l03432"></a>03432         {
<a name="l03433"></a>03433           <span class="keyword">struct </span><a class="code" href="structminimal__symbol.html">minimal_symbol</a> *debug_hook;
<a name="l03434"></a>03434 
<a name="l03435"></a>03435           debug_hook = <a class="code" href="minsyms_8c.html#af87f7a894386515074ddd71365bc09b8">lookup_minimal_symbol</a> (func_name, NULL, objfile);
<a name="l03436"></a>03436           <span class="keywordflow">if</span> (debug_hook == NULL)
<a name="l03437"></a>03437             {
<a name="l03438"></a>03438               bp_objfile_data-&gt;exception_msym = &amp;msym_not_found;
<a name="l03439"></a>03439               <span class="keywordflow">continue</span>;
<a name="l03440"></a>03440             }
<a name="l03441"></a>03441 
<a name="l03442"></a>03442           bp_objfile_data-&gt;exception_msym = debug_hook;
<a name="l03443"></a>03443         }
<a name="l03444"></a>03444 
<a name="l03445"></a>03445       addr = <a class="code" href="symtab_8h.html#abee697b9e3bb4f4d164ad920a87ab854">SYMBOL_VALUE_ADDRESS</a> (bp_objfile_data-&gt;exception_msym);
<a name="l03446"></a>03446       addr = <a class="code" href="gdbarch_8c.html#adc1ce8006630950c775890c6fe36faa1">gdbarch_convert_from_func_ptr_addr</a> (gdbarch, addr,
<a name="l03447"></a>03447                                                  &amp;current_target);
<a name="l03448"></a>03448       b = create_internal_breakpoint (gdbarch, addr, <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa6d04f06608676691bf5f211117427b48">bp_exception_master</a>,
<a name="l03449"></a>03449                                       &amp;internal_breakpoint_ops);
<a name="l03450"></a>03450       b-&gt;<a class="code" href="structbreakpoint.html#a885e704e5cdcfc314069b970c396d1a4">addr_string</a> = xstrdup (func_name);
<a name="l03451"></a>03451       b-&gt;<a class="code" href="structbreakpoint.html#acb53352fd35aaad37054508fabc0f3bf">enable_state</a> = <a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577a4605f207d0d15bd8195c9b1aa1bfee96">bp_disabled</a>;
<a name="l03452"></a>03452     }
<a name="l03453"></a>03453 
<a name="l03454"></a>03454   update_global_location_list (1);
<a name="l03455"></a>03455 }
<a name="l03456"></a>03456 
<a name="l03457"></a>03457 <span class="keywordtype">void</span>
<a name="l03458"></a><a class="code" href="breakpoint_8h.html#adadc8e0e59062b3705d69c1c5530a069">03458</a> <a class="code" href="breakpoint_8c.html#adadc8e0e59062b3705d69c1c5530a069">update_breakpoints_after_exec</a> (<span class="keywordtype">void</span>)
<a name="l03459"></a>03459 {
<a name="l03460"></a>03460   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b, *b_tmp;
<a name="l03461"></a>03461   <span class="keyword">struct </span>bp_location *bploc, **bplocp_tmp;
<a name="l03462"></a>03462 
<a name="l03463"></a>03463   <span class="comment">/* We&#39;re about to delete breakpoints from GDB&#39;s lists.  If the</span>
<a name="l03464"></a>03464 <span class="comment">     INSERTED flag is true, GDB will try to lift the breakpoints by</span>
<a name="l03465"></a>03465 <span class="comment">     writing the breakpoints&#39; &quot;shadow contents&quot; back into memory.  The</span>
<a name="l03466"></a>03466 <span class="comment">     &quot;shadow contents&quot; are NOT valid after an exec, so GDB should not</span>
<a name="l03467"></a>03467 <span class="comment">     do that.  Instead, the target is responsible from marking</span>
<a name="l03468"></a>03468 <span class="comment">     breakpoints out as soon as it detects an exec.  We don&#39;t do that</span>
<a name="l03469"></a>03469 <span class="comment">     here instead, because there may be other attempts to delete</span>
<a name="l03470"></a>03470 <span class="comment">     breakpoints after detecting an exec and before reaching here.  */</span>
<a name="l03471"></a>03471   <a class="code" href="breakpoint_8c.html#a6f97c7962df1d91150e0e8de40ff7fe4">ALL_BP_LOCATIONS</a> (bploc, bplocp_tmp)
<a name="l03472"></a>03472     <span class="keywordflow">if</span> (bploc-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a> == <a class="code" href="progspace_8c.html#a07722ff15a98814c086dda44f93380c9">current_program_space</a>)
<a name="l03473"></a>03473       <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (!bploc-&gt;<a class="code" href="structbp__location.html#acb0b475579bbe5dabeb8ed4504527105">inserted</a>);
<a name="l03474"></a>03474 
<a name="l03475"></a>03475   <a class="code" href="breakpoint_8c.html#ace15af58ae54149fbef6d72ecb61e12d">ALL_BREAKPOINTS_SAFE</a> (b, b_tmp)
<a name="l03476"></a>03476   {
<a name="l03477"></a>03477     <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#a82f4fd8ee6ddee61f3529fbd747c78b2">pspace</a> != <a class="code" href="progspace_8c.html#a07722ff15a98814c086dda44f93380c9">current_program_space</a>)
<a name="l03478"></a>03478       <span class="keywordflow">continue</span>;
<a name="l03479"></a>03479 
<a name="l03480"></a>03480     <span class="comment">/* Solib breakpoints must be explicitly reset after an exec().  */</span>
<a name="l03481"></a>03481     <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa7ff3ee755a0635e1c8aa45bbeba6734a">bp_shlib_event</a>)
<a name="l03482"></a>03482       {
<a name="l03483"></a>03483         <a class="code" href="breakpoint_8c.html#a0701191361b1ed0d40d76661e88de3f4">delete_breakpoint</a> (b);
<a name="l03484"></a>03484         <span class="keywordflow">continue</span>;
<a name="l03485"></a>03485       }
<a name="l03486"></a>03486 
<a name="l03487"></a>03487     <span class="comment">/* JIT breakpoints must be explicitly reset after an exec().  */</span>
<a name="l03488"></a>03488     <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfaa189ad5fdf786f2921ba9635bdb926fe">bp_jit_event</a>)
<a name="l03489"></a>03489       {
<a name="l03490"></a>03490         <a class="code" href="breakpoint_8c.html#a0701191361b1ed0d40d76661e88de3f4">delete_breakpoint</a> (b);
<a name="l03491"></a>03491         <span class="keywordflow">continue</span>;
<a name="l03492"></a>03492       }
<a name="l03493"></a>03493 
<a name="l03494"></a>03494     <span class="comment">/* Thread event breakpoints must be set anew after an exec(),</span>
<a name="l03495"></a>03495 <span class="comment">       as must overlay event and longjmp master breakpoints.  */</span>
<a name="l03496"></a>03496     <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa363ddd674339fdbb98fc4b0525905172">bp_thread_event</a> || b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa5bd9bbdb42933350595475584c48d844">bp_overlay_event</a>
<a name="l03497"></a>03497         || b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfad159b4f5b0a64a88067c3d310ebed7ce">bp_longjmp_master</a> || b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa0d6052d15a11c79e0c6703aeef4148ba">bp_std_terminate_master</a>
<a name="l03498"></a>03498         || b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa6d04f06608676691bf5f211117427b48">bp_exception_master</a>)
<a name="l03499"></a>03499       {
<a name="l03500"></a>03500         <a class="code" href="breakpoint_8c.html#a0701191361b1ed0d40d76661e88de3f4">delete_breakpoint</a> (b);
<a name="l03501"></a>03501         <span class="keywordflow">continue</span>;
<a name="l03502"></a>03502       }
<a name="l03503"></a>03503 
<a name="l03504"></a>03504     <span class="comment">/* Step-resume breakpoints are meaningless after an exec().  */</span>
<a name="l03505"></a>03505     <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa47c0a1a603215fb93c5db2cbb15e1edc">bp_step_resume</a> || b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfacb66952952620a78cd9e0f6c84078395">bp_hp_step_resume</a>)
<a name="l03506"></a>03506       {
<a name="l03507"></a>03507         <a class="code" href="breakpoint_8c.html#a0701191361b1ed0d40d76661e88de3f4">delete_breakpoint</a> (b);
<a name="l03508"></a>03508         <span class="keywordflow">continue</span>;
<a name="l03509"></a>03509       }
<a name="l03510"></a>03510 
<a name="l03511"></a>03511     <span class="comment">/* Longjmp and longjmp-resume breakpoints are also meaningless</span>
<a name="l03512"></a>03512 <span class="comment">       after an exec.  */</span>
<a name="l03513"></a>03513     <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa4ca499075e7b45a6ff9b546b71860124">bp_longjmp</a> || b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfad27e062da5217e29ab1a859e41946669">bp_longjmp_resume</a>
<a name="l03514"></a>03514         || b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa2bc2f9a597a0b3730d45e715048f76d3">bp_longjmp_call_dummy</a>
<a name="l03515"></a>03515         || b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfae83abf56e7e24d4c7b7c63e78dc3e270">bp_exception</a> || b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa190706cc3be7f60fa934d8aa83f533de">bp_exception_resume</a>)
<a name="l03516"></a>03516       {
<a name="l03517"></a>03517         <a class="code" href="breakpoint_8c.html#a0701191361b1ed0d40d76661e88de3f4">delete_breakpoint</a> (b);
<a name="l03518"></a>03518         <span class="keywordflow">continue</span>;
<a name="l03519"></a>03519       }
<a name="l03520"></a>03520 
<a name="l03521"></a>03521     <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa8ebb961cef940b8ddef84696b7ac9694">bp_catchpoint</a>)
<a name="l03522"></a>03522       {
<a name="l03523"></a>03523         <span class="comment">/* For now, none of the bp_catchpoint breakpoints need to</span>
<a name="l03524"></a>03524 <span class="comment">           do anything at this point.  In the future, if some of</span>
<a name="l03525"></a>03525 <span class="comment">           the catchpoints need to something, we will need to add</span>
<a name="l03526"></a>03526 <span class="comment">           a new method, and call this method from here.  */</span>
<a name="l03527"></a>03527         <span class="keywordflow">continue</span>;
<a name="l03528"></a>03528       }
<a name="l03529"></a>03529 
<a name="l03530"></a>03530     <span class="comment">/* bp_finish is a special case.  The only way we ought to be able</span>
<a name="l03531"></a>03531 <span class="comment">       to see one of these when an exec() has happened, is if the user</span>
<a name="l03532"></a>03532 <span class="comment">       caught a vfork, and then said &quot;finish&quot;.  Ordinarily a finish just</span>
<a name="l03533"></a>03533 <span class="comment">       carries them to the call-site of the current callee, by setting</span>
<a name="l03534"></a>03534 <span class="comment">       a temporary bp there and resuming.  But in this case, the finish</span>
<a name="l03535"></a>03535 <span class="comment">       will carry them entirely through the vfork &amp; exec.</span>
<a name="l03536"></a>03536 <span class="comment"></span>
<a name="l03537"></a>03537 <span class="comment">       We don&#39;t want to allow a bp_finish to remain inserted now.  But</span>
<a name="l03538"></a>03538 <span class="comment">       we can&#39;t safely delete it, &#39;cause finish_command has a handle to</span>
<a name="l03539"></a>03539 <span class="comment">       the bp on a bpstat, and will later want to delete it.  There&#39;s a</span>
<a name="l03540"></a>03540 <span class="comment">       chance (and I&#39;ve seen it happen) that if we delete the bp_finish</span>
<a name="l03541"></a>03541 <span class="comment">       here, that its storage will get reused by the time finish_command</span>
<a name="l03542"></a>03542 <span class="comment">       gets &#39;round to deleting the &quot;use to be a bp_finish&quot; breakpoint.</span>
<a name="l03543"></a>03543 <span class="comment">       We really must allow finish_command to delete a bp_finish.</span>
<a name="l03544"></a>03544 <span class="comment"></span>
<a name="l03545"></a>03545 <span class="comment">       In the absence of a general solution for the &quot;how do we know</span>
<a name="l03546"></a>03546 <span class="comment">       it&#39;s safe to delete something others may have handles to?&quot;</span>
<a name="l03547"></a>03547 <span class="comment">       problem, what we&#39;ll do here is just uninsert the bp_finish, and</span>
<a name="l03548"></a>03548 <span class="comment">       let finish_command delete it.</span>
<a name="l03549"></a>03549 <span class="comment"></span>
<a name="l03550"></a>03550 <span class="comment">       (We know the bp_finish is &quot;doomed&quot; in the sense that it&#39;s</span>
<a name="l03551"></a>03551 <span class="comment">       momentary, and will be deleted as soon as finish_command sees</span>
<a name="l03552"></a>03552 <span class="comment">       the inferior stopped.  So it doesn&#39;t matter that the bp&#39;s</span>
<a name="l03553"></a>03553 <span class="comment">       address is probably bogus in the new a.out, unlike e.g., the</span>
<a name="l03554"></a>03554 <span class="comment">       solib breakpoints.)  */</span>
<a name="l03555"></a>03555 
<a name="l03556"></a>03556     <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa86f9369de92fbd10422ccc3d4ea68a20">bp_finish</a>)
<a name="l03557"></a>03557       {
<a name="l03558"></a>03558         <span class="keywordflow">continue</span>;
<a name="l03559"></a>03559       }
<a name="l03560"></a>03560 
<a name="l03561"></a>03561     <span class="comment">/* Without a symbolic address, we have little hope of the</span>
<a name="l03562"></a>03562 <span class="comment">       pre-exec() address meaning the same thing in the post-exec()</span>
<a name="l03563"></a>03563 <span class="comment">       a.out.  */</span>
<a name="l03564"></a>03564     <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#a885e704e5cdcfc314069b970c396d1a4">addr_string</a> == NULL)
<a name="l03565"></a>03565       {
<a name="l03566"></a>03566         <a class="code" href="breakpoint_8c.html#a0701191361b1ed0d40d76661e88de3f4">delete_breakpoint</a> (b);
<a name="l03567"></a>03567         <span class="keywordflow">continue</span>;
<a name="l03568"></a>03568       }
<a name="l03569"></a>03569   }
<a name="l03570"></a>03570   <span class="comment">/* FIXME what about longjmp breakpoints?  Re-create them here?  */</span>
<a name="l03571"></a>03571   create_overlay_event_breakpoint ();
<a name="l03572"></a>03572   create_longjmp_master_breakpoint ();
<a name="l03573"></a>03573   create_std_terminate_master_breakpoint ();
<a name="l03574"></a>03574   create_exception_master_breakpoint ();
<a name="l03575"></a>03575 }
<a name="l03576"></a>03576 
<a name="l03577"></a>03577 <span class="keywordtype">int</span>
<a name="l03578"></a><a class="code" href="breakpoint_8h.html#a32a6118c467d07be13d8c4a561a28ab3">03578</a> <a class="code" href="breakpoint_8c.html#a32a6118c467d07be13d8c4a561a28ab3">detach_breakpoints</a> (<a class="code" href="structptid.html">ptid_t</a> <a class="code" href="structptid.html">ptid</a>)
<a name="l03579"></a>03579 {
<a name="l03580"></a>03580   <span class="keyword">struct </span>bp_location *bl, **blp_tmp;
<a name="l03581"></a>03581   <span class="keywordtype">int</span> val = 0;
<a name="l03582"></a>03582   <span class="keyword">struct </span>cleanup *old_chain = <a class="code" href="inferior_8h.html#a3f4175640dba9bda8c87957bb0c183fb">save_inferior_ptid</a> ();
<a name="l03583"></a>03583   <span class="keyword">struct </span><a class="code" href="structinferior.html">inferior</a> *<a class="code" href="namespacearm-linux.html#aaf6bae53545ee96f24d7ba560ed0a205">inf</a> = <a class="code" href="inferior_8c.html#a9e592c83e7c0c1f89f1a4a392bd1a277">current_inferior</a> ();
<a name="l03584"></a>03584 
<a name="l03585"></a>03585   <span class="keywordflow">if</span> (<a class="code" href="ptid_8c.html#a264ba40fc2a0cf3d4fb24a55fe32aede">ptid_get_pid</a> (ptid) == <a class="code" href="ptid_8c.html#a264ba40fc2a0cf3d4fb24a55fe32aede">ptid_get_pid</a> (<a class="code" href="infcmd_8c.html#a428c5be9ce5e70bd03760e828e19c6b7">inferior_ptid</a>))
<a name="l03586"></a>03586     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Cannot detach breakpoints of inferior_ptid&quot;</span>));
<a name="l03587"></a>03587 
<a name="l03588"></a>03588   <span class="comment">/* Set inferior_ptid; remove_breakpoint_1 uses this global.  */</span>
<a name="l03589"></a>03589   <a class="code" href="infcmd_8c.html#a428c5be9ce5e70bd03760e828e19c6b7">inferior_ptid</a> = ptid;
<a name="l03590"></a>03590   <a class="code" href="breakpoint_8c.html#a6f97c7962df1d91150e0e8de40ff7fe4">ALL_BP_LOCATIONS</a> (bl, blp_tmp)
<a name="l03591"></a>03591   {
<a name="l03592"></a>03592     <span class="keywordflow">if</span> (bl-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a> != inf-&gt;<a class="code" href="structinferior.html#afc6a557206fd753b89e34bd33e038cfe">pspace</a>)
<a name="l03593"></a>03593       <span class="keywordflow">continue</span>;
<a name="l03594"></a>03594 
<a name="l03595"></a>03595     <span class="comment">/* This function must physically remove breakpoints locations</span>
<a name="l03596"></a>03596 <span class="comment">       from the specified ptid, without modifying the breakpoint</span>
<a name="l03597"></a>03597 <span class="comment">       package&#39;s state.  Locations of type bp_loc_other are only</span>
<a name="l03598"></a>03598 <span class="comment">       maintained at GDB side.  So, there is no need to remove</span>
<a name="l03599"></a>03599 <span class="comment">       these bp_loc_other locations.  Moreover, removing these</span>
<a name="l03600"></a>03600 <span class="comment">       would modify the breakpoint package&#39;s state.  */</span>
<a name="l03601"></a>03601     <span class="keywordflow">if</span> (bl-&gt;<a class="code" href="structbp__location.html#aefe49818487e5876fc995f7831e2e809">loc_type</a> == <a class="code" href="breakpoint_8h.html#ad7006ab95a9d2493c6ad2c685f45f5dca7e299c37c01da7ced4469575ef811ee2">bp_loc_other</a>)
<a name="l03602"></a>03602       <span class="keywordflow">continue</span>;
<a name="l03603"></a>03603 
<a name="l03604"></a>03604     <span class="keywordflow">if</span> (bl-&gt;<a class="code" href="structbp__location.html#acb0b475579bbe5dabeb8ed4504527105">inserted</a>)
<a name="l03605"></a>03605       val |= remove_breakpoint_1 (bl, <a class="code" href="breakpoint_8c.html#a644fb6ed981d6c6fe6276d324ac6be1caf02d5e895cc076528970b6c586250c9e">mark_inserted</a>);
<a name="l03606"></a>03606   }
<a name="l03607"></a>03607 
<a name="l03608"></a>03608   <span class="comment">/* Detach single-step breakpoints as well.  */</span>
<a name="l03609"></a>03609   detach_single_step_breakpoints ();
<a name="l03610"></a>03610 
<a name="l03611"></a>03611   <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (old_chain);
<a name="l03612"></a>03612   <span class="keywordflow">return</span> val;
<a name="l03613"></a>03613 }
<a name="l03614"></a>03614 
<a name="l03615"></a>03615 <span class="comment">/* Remove the breakpoint location BL from the current address space.</span>
<a name="l03616"></a>03616 <span class="comment">   Note that this is used to detach breakpoints from a child fork.</span>
<a name="l03617"></a>03617 <span class="comment">   When we get here, the child isn&#39;t in the inferior list, and neither</span>
<a name="l03618"></a>03618 <span class="comment">   do we have objects to represent its address space --- we should</span>
<a name="l03619"></a>03619 <span class="comment">   *not* look at bl-&gt;pspace-&gt;aspace here.  */</span>
<a name="l03620"></a>03620 
<a name="l03621"></a>03621 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l03622"></a>03622 remove_breakpoint_1 (<span class="keyword">struct</span> bp_location *bl, <a class="code" href="breakpoint_8c.html#a644fb6ed981d6c6fe6276d324ac6be1c">insertion_state_t</a> is)
<a name="l03623"></a>03623 {
<a name="l03624"></a>03624   <span class="keywordtype">int</span> val;
<a name="l03625"></a>03625 
<a name="l03626"></a>03626   <span class="comment">/* BL is never in moribund_locations by our callers.  */</span>
<a name="l03627"></a>03627   <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a> != NULL);
<a name="l03628"></a>03628 
<a name="l03629"></a>03629   <span class="keywordflow">if</span> (bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#acb53352fd35aaad37054508fabc0f3bf">enable_state</a> == <a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577adbf2e9b210d33b1ac7e8a7ed87a2b46f">bp_permanent</a>)
<a name="l03630"></a>03630     <span class="comment">/* Permanent breakpoints cannot be inserted or removed.  */</span>
<a name="l03631"></a>03631     <span class="keywordflow">return</span> 0;
<a name="l03632"></a>03632 
<a name="l03633"></a>03633   <span class="comment">/* The type of none suggests that owner is actually deleted.</span>
<a name="l03634"></a>03634 <span class="comment">     This should not ever happen.  */</span>
<a name="l03635"></a>03635   <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> != <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfac0517cbb17f625d6cf900fb3aa64636e">bp_none</a>);
<a name="l03636"></a>03636 
<a name="l03637"></a>03637   <span class="keywordflow">if</span> (bl-&gt;<a class="code" href="structbp__location.html#aefe49818487e5876fc995f7831e2e809">loc_type</a> == <a class="code" href="breakpoint_8h.html#ad7006ab95a9d2493c6ad2c685f45f5dcaa74492f6095e7a1ae08e3eed468ba47d">bp_loc_software_breakpoint</a>
<a name="l03638"></a>03638       || bl-&gt;<a class="code" href="structbp__location.html#aefe49818487e5876fc995f7831e2e809">loc_type</a> == <a class="code" href="breakpoint_8h.html#ad7006ab95a9d2493c6ad2c685f45f5dca4a1949653a3b3c36db5cb269a46adb60">bp_loc_hardware_breakpoint</a>)
<a name="l03639"></a>03639     {
<a name="l03640"></a>03640       <span class="comment">/* &quot;Normal&quot; instruction breakpoint: either the standard</span>
<a name="l03641"></a>03641 <span class="comment">         trap-instruction bp (bp_breakpoint), or a</span>
<a name="l03642"></a>03642 <span class="comment">         bp_hardware_breakpoint.  */</span>
<a name="l03643"></a>03643 
<a name="l03644"></a>03644       <span class="comment">/* First check to see if we have to handle an overlay.  */</span>
<a name="l03645"></a>03645       <span class="keywordflow">if</span> (<a class="code" href="symfile_8c.html#ad96d01ef61ee2925825b3992d37408f5">overlay_debugging</a> == <a class="code" href="symfile_8h.html#aac35fb60df366f285fe7fda072f3edc2aadd8d8442094fe5bb20a1e1a5217ff38">ovly_off</a>
<a name="l03646"></a>03646           || bl-&gt;<a class="code" href="structbp__location.html#ac6d8286e46db5c4be6dab9139c43a00d">section</a> == NULL
<a name="l03647"></a>03647           || !(<a class="code" href="symfile_8c.html#ad63f10fe5266cd2e98883d6f4c054c3a">section_is_overlay</a> (bl-&gt;<a class="code" href="structbp__location.html#ac6d8286e46db5c4be6dab9139c43a00d">section</a>)))
<a name="l03648"></a>03648         {
<a name="l03649"></a>03649           <span class="comment">/* No overlay handling: just remove the breakpoint.  */</span>
<a name="l03650"></a>03650           val = bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#aba258aa23496f6434aaa1cf8c8dc7ea7">ops</a>-&gt;<a class="code" href="structbreakpoint__ops.html#ad2f8547a4949f5480fa4c4dc7487cb78">remove_location</a> (bl);
<a name="l03651"></a>03651         }
<a name="l03652"></a>03652       <span class="keywordflow">else</span>
<a name="l03653"></a>03653         {
<a name="l03654"></a>03654           <span class="comment">/* This breakpoint is in an overlay section.</span>
<a name="l03655"></a>03655 <span class="comment">             Did we set a breakpoint at the LMA?  */</span>
<a name="l03656"></a>03656           <span class="keywordflow">if</span> (!overlay_events_enabled)
<a name="l03657"></a>03657               {
<a name="l03658"></a>03658                 <span class="comment">/* Yes -- overlay event support is not active, so we</span>
<a name="l03659"></a>03659 <span class="comment">                   should have set a breakpoint at the LMA.  Remove it.  </span>
<a name="l03660"></a>03660 <span class="comment">                */</span>
<a name="l03661"></a>03661                 <span class="comment">/* Ignore any failures: if the LMA is in ROM, we will</span>
<a name="l03662"></a>03662 <span class="comment">                   have already warned when we failed to insert it.  */</span>
<a name="l03663"></a>03663                 <span class="keywordflow">if</span> (bl-&gt;<a class="code" href="structbp__location.html#aefe49818487e5876fc995f7831e2e809">loc_type</a> == <a class="code" href="breakpoint_8h.html#ad7006ab95a9d2493c6ad2c685f45f5dca4a1949653a3b3c36db5cb269a46adb60">bp_loc_hardware_breakpoint</a>)
<a name="l03664"></a>03664                   <a class="code" href="target_8h.html#a8cb43153c60123ceebd4597888b2d8bf">target_remove_hw_breakpoint</a> (bl-&gt;<a class="code" href="structbp__location.html#a55f3ff99d536775f5095f11e5f5c3f3e">gdbarch</a>,
<a name="l03665"></a>03665                                                &amp;bl-&gt;<a class="code" href="structbp__location.html#a673c3836b1a8fc6cb89bccdd1f2c2841">overlay_target_info</a>);
<a name="l03666"></a>03666                 <span class="keywordflow">else</span>
<a name="l03667"></a>03667                   <a class="code" href="target_8c.html#a9c2f1e0aacdecef04948e3714a934b70">target_remove_breakpoint</a> (bl-&gt;<a class="code" href="structbp__location.html#a55f3ff99d536775f5095f11e5f5c3f3e">gdbarch</a>,
<a name="l03668"></a>03668                                             &amp;bl-&gt;<a class="code" href="structbp__location.html#a673c3836b1a8fc6cb89bccdd1f2c2841">overlay_target_info</a>);
<a name="l03669"></a>03669               }
<a name="l03670"></a>03670           <span class="comment">/* Did we set a breakpoint at the VMA? </span>
<a name="l03671"></a>03671 <span class="comment">             If so, we will have marked the breakpoint &#39;inserted&#39;.  */</span>
<a name="l03672"></a>03672           <span class="keywordflow">if</span> (bl-&gt;<a class="code" href="structbp__location.html#acb0b475579bbe5dabeb8ed4504527105">inserted</a>)
<a name="l03673"></a>03673             {
<a name="l03674"></a>03674               <span class="comment">/* Yes -- remove it.  Previously we did not bother to</span>
<a name="l03675"></a>03675 <span class="comment">                 remove the breakpoint if the section had been</span>
<a name="l03676"></a>03676 <span class="comment">                 unmapped, but let&#39;s not rely on that being safe.  We</span>
<a name="l03677"></a>03677 <span class="comment">                 don&#39;t know what the overlay manager might do.  */</span>
<a name="l03678"></a>03678 
<a name="l03679"></a>03679               <span class="comment">/* However, we should remove *software* breakpoints only</span>
<a name="l03680"></a>03680 <span class="comment">                 if the section is still mapped, or else we overwrite</span>
<a name="l03681"></a>03681 <span class="comment">                 wrong code with the saved shadow contents.  */</span>
<a name="l03682"></a>03682               <span class="keywordflow">if</span> (bl-&gt;<a class="code" href="structbp__location.html#aefe49818487e5876fc995f7831e2e809">loc_type</a> == <a class="code" href="breakpoint_8h.html#ad7006ab95a9d2493c6ad2c685f45f5dca4a1949653a3b3c36db5cb269a46adb60">bp_loc_hardware_breakpoint</a>
<a name="l03683"></a>03683                   || <a class="code" href="symfile_8c.html#a2d6f94d48a782be7460e704fec67adb4">section_is_mapped</a> (bl-&gt;<a class="code" href="structbp__location.html#ac6d8286e46db5c4be6dab9139c43a00d">section</a>))
<a name="l03684"></a>03684                 val = bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#aba258aa23496f6434aaa1cf8c8dc7ea7">ops</a>-&gt;<a class="code" href="structbreakpoint__ops.html#ad2f8547a4949f5480fa4c4dc7487cb78">remove_location</a> (bl);
<a name="l03685"></a>03685               <span class="keywordflow">else</span>
<a name="l03686"></a>03686                 val = 0;
<a name="l03687"></a>03687             }
<a name="l03688"></a>03688           <span class="keywordflow">else</span>
<a name="l03689"></a>03689             {
<a name="l03690"></a>03690               <span class="comment">/* No -- not inserted, so no need to remove.  No error.  */</span>
<a name="l03691"></a>03691               val = 0;
<a name="l03692"></a>03692             }
<a name="l03693"></a>03693         }
<a name="l03694"></a>03694 
<a name="l03695"></a>03695       <span class="comment">/* In some cases, we might not be able to remove a breakpoint</span>
<a name="l03696"></a>03696 <span class="comment">         in a shared library that has already been removed, but we</span>
<a name="l03697"></a>03697 <span class="comment">         have not yet processed the shlib unload event.  */</span>
<a name="l03698"></a>03698       <span class="keywordflow">if</span> (val &amp;&amp; <a class="code" href="solib_8c.html#aeb7eeab1d9375e787425078df3a08b9d">solib_name_from_address</a> (bl-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a>, bl-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>))
<a name="l03699"></a>03699         val = 0;
<a name="l03700"></a>03700 
<a name="l03701"></a>03701       <span class="keywordflow">if</span> (val)
<a name="l03702"></a>03702         <span class="keywordflow">return</span> val;
<a name="l03703"></a>03703       bl-&gt;<a class="code" href="structbp__location.html#acb0b475579bbe5dabeb8ed4504527105">inserted</a> = (is == <a class="code" href="breakpoint_8c.html#a644fb6ed981d6c6fe6276d324ac6be1caf02d5e895cc076528970b6c586250c9e">mark_inserted</a>);
<a name="l03704"></a>03704     }
<a name="l03705"></a>03705   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bl-&gt;<a class="code" href="structbp__location.html#aefe49818487e5876fc995f7831e2e809">loc_type</a> == <a class="code" href="breakpoint_8h.html#ad7006ab95a9d2493c6ad2c685f45f5dcaf30d35565c228c0d80de4d7af9d9fbd2">bp_loc_hardware_watchpoint</a>)
<a name="l03706"></a>03706     {
<a name="l03707"></a>03707       <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#aba258aa23496f6434aaa1cf8c8dc7ea7">ops</a> != NULL
<a name="l03708"></a>03708                   &amp;&amp; bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#aba258aa23496f6434aaa1cf8c8dc7ea7">ops</a>-&gt;<a class="code" href="structbreakpoint__ops.html#ad2f8547a4949f5480fa4c4dc7487cb78">remove_location</a> != NULL);
<a name="l03709"></a>03709 
<a name="l03710"></a>03710       bl-&gt;<a class="code" href="structbp__location.html#acb0b475579bbe5dabeb8ed4504527105">inserted</a> = (is == <a class="code" href="breakpoint_8c.html#a644fb6ed981d6c6fe6276d324ac6be1caf02d5e895cc076528970b6c586250c9e">mark_inserted</a>);
<a name="l03711"></a>03711       bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#aba258aa23496f6434aaa1cf8c8dc7ea7">ops</a>-&gt;<a class="code" href="structbreakpoint__ops.html#ad2f8547a4949f5480fa4c4dc7487cb78">remove_location</a> (bl);
<a name="l03712"></a>03712 
<a name="l03713"></a>03713       <span class="comment">/* Failure to remove any of the hardware watchpoints comes here.  */</span>
<a name="l03714"></a>03714       <span class="keywordflow">if</span> ((is == <a class="code" href="breakpoint_8c.html#a644fb6ed981d6c6fe6276d324ac6be1caf92bac8f4a4afba3b9b475022a52dde2">mark_uninserted</a>) &amp;&amp; (bl-&gt;<a class="code" href="structbp__location.html#acb0b475579bbe5dabeb8ed4504527105">inserted</a>))
<a name="l03715"></a>03715         <a class="code" href="utils_8c.html#a5fc201a4181499a6b4057a6caa15b5e2">warning</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Could not remove hardware watchpoint %d.&quot;</span>),
<a name="l03716"></a>03716                  bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>);
<a name="l03717"></a>03717     }
<a name="l03718"></a>03718   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa8ebb961cef940b8ddef84696b7ac9694">bp_catchpoint</a>
<a name="l03719"></a>03719            &amp;&amp; breakpoint_enabled (bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>)
<a name="l03720"></a>03720            &amp;&amp; !bl-&gt;<a class="code" href="structbp__location.html#a1d15bb8313f27fdcdd035bedcfd89199">duplicate</a>)
<a name="l03721"></a>03721     {
<a name="l03722"></a>03722       <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#aba258aa23496f6434aaa1cf8c8dc7ea7">ops</a> != NULL
<a name="l03723"></a>03723                   &amp;&amp; bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#aba258aa23496f6434aaa1cf8c8dc7ea7">ops</a>-&gt;<a class="code" href="structbreakpoint__ops.html#ad2f8547a4949f5480fa4c4dc7487cb78">remove_location</a> != NULL);
<a name="l03724"></a>03724 
<a name="l03725"></a>03725       val = bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#aba258aa23496f6434aaa1cf8c8dc7ea7">ops</a>-&gt;<a class="code" href="structbreakpoint__ops.html#ad2f8547a4949f5480fa4c4dc7487cb78">remove_location</a> (bl);
<a name="l03726"></a>03726       <span class="keywordflow">if</span> (val)
<a name="l03727"></a>03727         <span class="keywordflow">return</span> val;
<a name="l03728"></a>03728 
<a name="l03729"></a>03729       bl-&gt;<a class="code" href="structbp__location.html#acb0b475579bbe5dabeb8ed4504527105">inserted</a> = (is == <a class="code" href="breakpoint_8c.html#a644fb6ed981d6c6fe6276d324ac6be1caf02d5e895cc076528970b6c586250c9e">mark_inserted</a>);
<a name="l03730"></a>03730     }
<a name="l03731"></a>03731 
<a name="l03732"></a>03732   <span class="keywordflow">return</span> 0;
<a name="l03733"></a>03733 }
<a name="l03734"></a>03734 
<a name="l03735"></a>03735 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l03736"></a>03736 remove_breakpoint (<span class="keyword">struct</span> bp_location *bl, <a class="code" href="breakpoint_8c.html#a644fb6ed981d6c6fe6276d324ac6be1c">insertion_state_t</a> is)
<a name="l03737"></a>03737 {
<a name="l03738"></a>03738   <span class="keywordtype">int</span> ret;
<a name="l03739"></a>03739   <span class="keyword">struct </span>cleanup *old_chain;
<a name="l03740"></a>03740 
<a name="l03741"></a>03741   <span class="comment">/* BL is never in moribund_locations by our callers.  */</span>
<a name="l03742"></a>03742   <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a> != NULL);
<a name="l03743"></a>03743 
<a name="l03744"></a>03744   <span class="keywordflow">if</span> (bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#acb53352fd35aaad37054508fabc0f3bf">enable_state</a> == <a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577adbf2e9b210d33b1ac7e8a7ed87a2b46f">bp_permanent</a>)
<a name="l03745"></a>03745     <span class="comment">/* Permanent breakpoints cannot be inserted or removed.  */</span>
<a name="l03746"></a>03746     <span class="keywordflow">return</span> 0;
<a name="l03747"></a>03747 
<a name="l03748"></a>03748   <span class="comment">/* The type of none suggests that owner is actually deleted.</span>
<a name="l03749"></a>03749 <span class="comment">     This should not ever happen.  */</span>
<a name="l03750"></a>03750   <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> != <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfac0517cbb17f625d6cf900fb3aa64636e">bp_none</a>);
<a name="l03751"></a>03751 
<a name="l03752"></a>03752   old_chain = <a class="code" href="progspace_8c.html#a6326460454db4e192e2bc221cb322977">save_current_space_and_thread</a> ();
<a name="l03753"></a>03753 
<a name="l03754"></a>03754   <a class="code" href="progspace_8c.html#a58d979e46585ad85280e488204e0147e">switch_to_program_space_and_thread</a> (bl-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a>);
<a name="l03755"></a>03755 
<a name="l03756"></a>03756   ret = remove_breakpoint_1 (bl, is);
<a name="l03757"></a>03757 
<a name="l03758"></a>03758   <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (old_chain);
<a name="l03759"></a>03759   <span class="keywordflow">return</span> ret;
<a name="l03760"></a>03760 }
<a name="l03761"></a>03761 
<a name="l03762"></a>03762 <span class="comment">/* Clear the &quot;inserted&quot; flag in all breakpoints.  */</span>
<a name="l03763"></a>03763 
<a name="l03764"></a>03764 <span class="keywordtype">void</span>
<a name="l03765"></a><a class="code" href="breakpoint_8h.html#acf2b71e937efe6a6a9defdbf6fbe7f39">03765</a> <a class="code" href="breakpoint_8c.html#acf2b71e937efe6a6a9defdbf6fbe7f39">mark_breakpoints_out</a> (<span class="keywordtype">void</span>)
<a name="l03766"></a>03766 {
<a name="l03767"></a>03767   <span class="keyword">struct </span>bp_location *bl, **blp_tmp;
<a name="l03768"></a>03768 
<a name="l03769"></a>03769   <a class="code" href="breakpoint_8c.html#a6f97c7962df1d91150e0e8de40ff7fe4">ALL_BP_LOCATIONS</a> (bl, blp_tmp)
<a name="l03770"></a>03770     <span class="keywordflow">if</span> (bl-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a> == <a class="code" href="progspace_8c.html#a07722ff15a98814c086dda44f93380c9">current_program_space</a>)
<a name="l03771"></a>03771       bl-&gt;<a class="code" href="structbp__location.html#acb0b475579bbe5dabeb8ed4504527105">inserted</a> = 0;
<a name="l03772"></a>03772 }
<a name="l03773"></a>03773 
<a name="l03774"></a>03774 <span class="comment">/* Clear the &quot;inserted&quot; flag in all breakpoints and delete any</span>
<a name="l03775"></a>03775 <span class="comment">   breakpoints which should go away between runs of the program.</span>
<a name="l03776"></a>03776 <span class="comment"></span>
<a name="l03777"></a>03777 <span class="comment">   Plus other such housekeeping that has to be done for breakpoints</span>
<a name="l03778"></a>03778 <span class="comment">   between runs.</span>
<a name="l03779"></a>03779 <span class="comment"></span>
<a name="l03780"></a>03780 <span class="comment">   Note: this function gets called at the end of a run (by</span>
<a name="l03781"></a>03781 <span class="comment">   generic_mourn_inferior) and when a run begins (by</span>
<a name="l03782"></a>03782 <span class="comment">   init_wait_for_inferior).  */</span>
<a name="l03783"></a>03783 
<a name="l03784"></a>03784 
<a name="l03785"></a>03785 
<a name="l03786"></a>03786 <span class="keywordtype">void</span>
<a name="l03787"></a><a class="code" href="breakpoint_8h.html#aba22eda02d0856fffebc88288bcd4997">03787</a> <a class="code" href="breakpoint_8c.html#a15f8ae6401ea78d7a5f6a718de58cfd0">breakpoint_init_inferior</a> (<span class="keyword">enum</span> <a class="code" href="breakpoint_8h.html#a6e8726030dbc36e8aa71d8a8e94f6695">inf_context</a> context)
<a name="l03788"></a>03788 {
<a name="l03789"></a>03789   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b, *b_tmp;
<a name="l03790"></a>03790   <span class="keyword">struct </span>bp_location *bl, **blp_tmp;
<a name="l03791"></a>03791   <span class="keywordtype">int</span> ix;
<a name="l03792"></a>03792   <span class="keyword">struct </span><a class="code" href="structprogram__space.html">program_space</a> *pspace = <a class="code" href="progspace_8c.html#a07722ff15a98814c086dda44f93380c9">current_program_space</a>;
<a name="l03793"></a>03793 
<a name="l03794"></a>03794   <span class="comment">/* If breakpoint locations are shared across processes, then there&#39;s</span>
<a name="l03795"></a>03795 <span class="comment">     nothing to do.  */</span>
<a name="l03796"></a>03796   <span class="keywordflow">if</span> (<a class="code" href="gdbarch_8c.html#a5e7deb9f392fcd0f807759896fe00919">gdbarch_has_global_breakpoints</a> (<a class="code" href="gdbarch_8c.html#ad648a33f69abe34e9679744a0c5a0580">target_gdbarch</a> ()))
<a name="l03797"></a>03797     <span class="keywordflow">return</span>;
<a name="l03798"></a>03798 
<a name="l03799"></a>03799   <a class="code" href="breakpoint_8c.html#a6f97c7962df1d91150e0e8de40ff7fe4">ALL_BP_LOCATIONS</a> (bl, blp_tmp)
<a name="l03800"></a>03800   {
<a name="l03801"></a>03801     <span class="comment">/* ALL_BP_LOCATIONS bp_location has BL-&gt;OWNER always non-NULL.  */</span>
<a name="l03802"></a>03802     <span class="keywordflow">if</span> (bl-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a> == pspace
<a name="l03803"></a>03803         &amp;&amp; bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#acb53352fd35aaad37054508fabc0f3bf">enable_state</a> != <a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577adbf2e9b210d33b1ac7e8a7ed87a2b46f">bp_permanent</a>)
<a name="l03804"></a>03804       bl-&gt;<a class="code" href="structbp__location.html#acb0b475579bbe5dabeb8ed4504527105">inserted</a> = 0;
<a name="l03805"></a>03805   }
<a name="l03806"></a>03806 
<a name="l03807"></a>03807   <a class="code" href="breakpoint_8c.html#ace15af58ae54149fbef6d72ecb61e12d">ALL_BREAKPOINTS_SAFE</a> (b, b_tmp)
<a name="l03808"></a>03808   {
<a name="l03809"></a>03809     <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a> &amp;&amp; b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a> != pspace)
<a name="l03810"></a>03810       <span class="keywordflow">continue</span>;
<a name="l03811"></a>03811 
<a name="l03812"></a>03812     <span class="keywordflow">switch</span> (b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a>)
<a name="l03813"></a>03813       {
<a name="l03814"></a>03814       <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa9ea01014e7cd4e2bb4ed925696cc0e8d">bp_call_dummy</a>:
<a name="l03815"></a>03815       <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa2bc2f9a597a0b3730d45e715048f76d3">bp_longjmp_call_dummy</a>:
<a name="l03816"></a>03816 
<a name="l03817"></a>03817         <span class="comment">/* If the call dummy breakpoint is at the entry point it will</span>
<a name="l03818"></a>03818 <span class="comment">           cause problems when the inferior is rerun, so we better get</span>
<a name="l03819"></a>03819 <span class="comment">           rid of it.  */</span>
<a name="l03820"></a>03820 
<a name="l03821"></a>03821       <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfad6bfd2f2654949462085c78f02480366">bp_watchpoint_scope</a>:
<a name="l03822"></a>03822 
<a name="l03823"></a>03823         <span class="comment">/* Also get rid of scope breakpoints.  */</span>
<a name="l03824"></a>03824 
<a name="l03825"></a>03825       <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa7ff3ee755a0635e1c8aa45bbeba6734a">bp_shlib_event</a>:
<a name="l03826"></a>03826 
<a name="l03827"></a>03827         <span class="comment">/* Also remove solib event breakpoints.  Their addresses may</span>
<a name="l03828"></a>03828 <span class="comment">           have changed since the last time we ran the program.</span>
<a name="l03829"></a>03829 <span class="comment">           Actually we may now be debugging against different target;</span>
<a name="l03830"></a>03830 <span class="comment">           and so the solib backend that installed this breakpoint may</span>
<a name="l03831"></a>03831 <span class="comment">           not be used in by the target.  E.g.,</span>
<a name="l03832"></a>03832 <span class="comment"></span>
<a name="l03833"></a>03833 <span class="comment">           (gdb) file prog-linux</span>
<a name="l03834"></a>03834 <span class="comment">           (gdb) run               # native linux target</span>
<a name="l03835"></a>03835 <span class="comment">           ...</span>
<a name="l03836"></a>03836 <span class="comment">           (gdb) kill</span>
<a name="l03837"></a>03837 <span class="comment">           (gdb) file prog-win.exe</span>
<a name="l03838"></a>03838 <span class="comment">           (gdb) tar rem :9999     # remote Windows gdbserver.</span>
<a name="l03839"></a>03839 <span class="comment">        */</span>
<a name="l03840"></a>03840 
<a name="l03841"></a>03841       <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa47c0a1a603215fb93c5db2cbb15e1edc">bp_step_resume</a>:
<a name="l03842"></a>03842 
<a name="l03843"></a>03843         <span class="comment">/* Also remove step-resume breakpoints.  */</span>
<a name="l03844"></a>03844 
<a name="l03845"></a>03845         <a class="code" href="breakpoint_8c.html#a0701191361b1ed0d40d76661e88de3f4">delete_breakpoint</a> (b);
<a name="l03846"></a>03846         <span class="keywordflow">break</span>;
<a name="l03847"></a>03847 
<a name="l03848"></a>03848       <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa2a35cc5d65b66d6228def5615d6827ce">bp_watchpoint</a>:
<a name="l03849"></a>03849       <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfae38a33f5a6725fbca8b5da2d491cfbcb">bp_hardware_watchpoint</a>:
<a name="l03850"></a>03850       <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa7013ee22be60f470b10b2de2f9d22c21">bp_read_watchpoint</a>:
<a name="l03851"></a>03851       <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa9148c330e0f813ed6fb421af9d7da820">bp_access_watchpoint</a>:
<a name="l03852"></a>03852         {
<a name="l03853"></a>03853           <span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *w = (<span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *) b;
<a name="l03854"></a>03854 
<a name="l03855"></a>03855           <span class="comment">/* Likewise for watchpoints on local expressions.  */</span>
<a name="l03856"></a>03856           <span class="keywordflow">if</span> (w-&gt;<a class="code" href="structwatchpoint.html#ab553c881e6ca32b9ae05bf9baee18c63">exp_valid_block</a> != NULL)
<a name="l03857"></a>03857             <a class="code" href="breakpoint_8c.html#a0701191361b1ed0d40d76661e88de3f4">delete_breakpoint</a> (b);
<a name="l03858"></a>03858           <span class="keywordflow">else</span> <span class="keywordflow">if</span> (context == <a class="code" href="breakpoint_8h.html#a6e8726030dbc36e8aa71d8a8e94f6695a98dda9a3cb4fad3abe37ab7160aaf945">inf_starting</a>)
<a name="l03859"></a>03859             {
<a name="l03860"></a>03860               <span class="comment">/* Reset val field to force reread of starting value in</span>
<a name="l03861"></a>03861 <span class="comment">                 insert_breakpoints.  */</span>
<a name="l03862"></a>03862               <span class="keywordflow">if</span> (w-&gt;<a class="code" href="structwatchpoint.html#afafe9b6d8ed19e6c10764499cb35a7d1">val</a>)
<a name="l03863"></a>03863                 <a class="code" href="value_8c.html#a1f9b3ee232ece65ddc75c2407b97a50d">value_free</a> (w-&gt;<a class="code" href="structwatchpoint.html#afafe9b6d8ed19e6c10764499cb35a7d1">val</a>);
<a name="l03864"></a>03864               w-&gt;<a class="code" href="structwatchpoint.html#afafe9b6d8ed19e6c10764499cb35a7d1">val</a> = NULL;
<a name="l03865"></a>03865               w-&gt;<a class="code" href="structwatchpoint.html#ab2e6ea6495c9663c86652b00af5bea1d">val_valid</a> = 0;
<a name="l03866"></a>03866           }
<a name="l03867"></a>03867         }
<a name="l03868"></a>03868         <span class="keywordflow">break</span>;
<a name="l03869"></a>03869       <span class="keywordflow">default</span>:
<a name="l03870"></a>03870         <span class="keywordflow">break</span>;
<a name="l03871"></a>03871       }
<a name="l03872"></a>03872   }
<a name="l03873"></a>03873 
<a name="l03874"></a>03874   <span class="comment">/* Get rid of the moribund locations.  */</span>
<a name="l03875"></a>03875   <span class="keywordflow">for</span> (ix = 0; <a class="code" href="vec_8h.html#ae7795b0c8e65f45eb49aac5ec2c0fa52">VEC_iterate</a> (<a class="code" href="structbp__location.html">bp_location_p</a>, moribund_locations, ix, bl); ++ix)
<a name="l03876"></a>03876     decref_bp_location (&amp;bl);
<a name="l03877"></a>03877   <a class="code" href="vec_8h.html#af5724b2bbce65103300279f9abe7f577">VEC_free</a> (<a class="code" href="structbp__location.html">bp_location_p</a>, moribund_locations);
<a name="l03878"></a>03878 }
<a name="l03879"></a>03879 
<a name="l03880"></a>03880 <span class="comment">/* These functions concern about actual breakpoints inserted in the</span>
<a name="l03881"></a>03881 <span class="comment">   target --- to e.g. check if we need to do decr_pc adjustment or if</span>
<a name="l03882"></a>03882 <span class="comment">   we need to hop over the bkpt --- so we check for address space</span>
<a name="l03883"></a>03883 <span class="comment">   match, not program space.  */</span>
<a name="l03884"></a>03884 
<a name="l03885"></a>03885 <span class="comment">/* breakpoint_here_p (PC) returns non-zero if an enabled breakpoint</span>
<a name="l03886"></a>03886 <span class="comment">   exists at PC.  It returns ordinary_breakpoint_here if it&#39;s an</span>
<a name="l03887"></a>03887 <span class="comment">   ordinary breakpoint, or permanent_breakpoint_here if it&#39;s a</span>
<a name="l03888"></a>03888 <span class="comment">   permanent breakpoint.</span>
<a name="l03889"></a>03889 <span class="comment">   - When continuing from a location with an ordinary breakpoint, we</span>
<a name="l03890"></a>03890 <span class="comment">     actually single step once before calling insert_breakpoints.</span>
<a name="l03891"></a>03891 <span class="comment">   - When continuing from a location with a permanent breakpoint, we</span>
<a name="l03892"></a>03892 <span class="comment">     need to use the `SKIP_PERMANENT_BREAKPOINT&#39; macro, provided by</span>
<a name="l03893"></a>03893 <span class="comment">     the target, to advance the PC past the breakpoint.  */</span>
<a name="l03894"></a>03894 
<a name="l03895"></a>03895 <span class="keyword">enum</span> <a class="code" href="breakpoint_8h.html#abf22af172864b1d25a16196a689d5c90">breakpoint_here</a>
<a name="l03896"></a><a class="code" href="breakpoint_8h.html#a4a4f4e47ad087d2a375e17e56582ece8">03896</a> <a class="code" href="breakpoint_8c.html#ac9dd4d0139663deadca80549a5833324">breakpoint_here_p</a> (<span class="keyword">struct</span> address_space *aspace, <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> pc)
<a name="l03897"></a>03897 {
<a name="l03898"></a>03898   <span class="keyword">struct </span>bp_location *bl, **blp_tmp;
<a name="l03899"></a>03899   <span class="keywordtype">int</span> any_breakpoint_here = 0;
<a name="l03900"></a>03900 
<a name="l03901"></a>03901   <a class="code" href="breakpoint_8c.html#a6f97c7962df1d91150e0e8de40ff7fe4">ALL_BP_LOCATIONS</a> (bl, blp_tmp)
<a name="l03902"></a>03902     {
<a name="l03903"></a>03903       <span class="keywordflow">if</span> (bl-&gt;<a class="code" href="structbp__location.html#aefe49818487e5876fc995f7831e2e809">loc_type</a> != <a class="code" href="breakpoint_8h.html#ad7006ab95a9d2493c6ad2c685f45f5dcaa74492f6095e7a1ae08e3eed468ba47d">bp_loc_software_breakpoint</a>
<a name="l03904"></a>03904           &amp;&amp; bl-&gt;<a class="code" href="structbp__location.html#aefe49818487e5876fc995f7831e2e809">loc_type</a> != <a class="code" href="breakpoint_8h.html#ad7006ab95a9d2493c6ad2c685f45f5dca4a1949653a3b3c36db5cb269a46adb60">bp_loc_hardware_breakpoint</a>)
<a name="l03905"></a>03905         <span class="keywordflow">continue</span>;
<a name="l03906"></a>03906 
<a name="l03907"></a>03907       <span class="comment">/* ALL_BP_LOCATIONS bp_location has BL-&gt;OWNER always non-NULL.  */</span>
<a name="l03908"></a>03908       <span class="keywordflow">if</span> ((breakpoint_enabled (bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>)
<a name="l03909"></a>03909            || bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#acb53352fd35aaad37054508fabc0f3bf">enable_state</a> == <a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577adbf2e9b210d33b1ac7e8a7ed87a2b46f">bp_permanent</a>)
<a name="l03910"></a>03910           &amp;&amp; breakpoint_location_address_match (bl, aspace, pc))
<a name="l03911"></a>03911         {
<a name="l03912"></a>03912           <span class="keywordflow">if</span> (<a class="code" href="symfile_8c.html#ad96d01ef61ee2925825b3992d37408f5">overlay_debugging</a> 
<a name="l03913"></a>03913               &amp;&amp; <a class="code" href="symfile_8c.html#ad63f10fe5266cd2e98883d6f4c054c3a">section_is_overlay</a> (bl-&gt;<a class="code" href="structbp__location.html#ac6d8286e46db5c4be6dab9139c43a00d">section</a>)
<a name="l03914"></a>03914               &amp;&amp; !<a class="code" href="symfile_8c.html#a2d6f94d48a782be7460e704fec67adb4">section_is_mapped</a> (bl-&gt;<a class="code" href="structbp__location.html#ac6d8286e46db5c4be6dab9139c43a00d">section</a>))
<a name="l03915"></a>03915             <span class="keywordflow">continue</span>;           <span class="comment">/* unmapped overlay -- can&#39;t be a match */</span>
<a name="l03916"></a>03916           <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#acb53352fd35aaad37054508fabc0f3bf">enable_state</a> == <a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577adbf2e9b210d33b1ac7e8a7ed87a2b46f">bp_permanent</a>)
<a name="l03917"></a>03917             <span class="keywordflow">return</span> <a class="code" href="breakpoint_8h.html#abf22af172864b1d25a16196a689d5c90ae64f665243f6e5553a6741e405b69ab7">permanent_breakpoint_here</a>;
<a name="l03918"></a>03918           <span class="keywordflow">else</span>
<a name="l03919"></a>03919             any_breakpoint_here = 1;
<a name="l03920"></a>03920         }
<a name="l03921"></a>03921     }
<a name="l03922"></a>03922 
<a name="l03923"></a>03923   <span class="keywordflow">return</span> any_breakpoint_here ? <a class="code" href="breakpoint_8h.html#abf22af172864b1d25a16196a689d5c90a3fde135655a2e9f9bc9ee78fdf07b66a">ordinary_breakpoint_here</a> : 0;
<a name="l03924"></a>03924 }
<a name="l03925"></a>03925 
<a name="l03926"></a>03926 <span class="comment">/* Return true if there&#39;s a moribund breakpoint at PC.  */</span>
<a name="l03927"></a>03927 
<a name="l03928"></a>03928 <span class="keywordtype">int</span>
<a name="l03929"></a><a class="code" href="breakpoint_8h.html#ac7f2c3363448051d5eaa47af77f41a89">03929</a> <a class="code" href="breakpoint_8c.html#a65fe4bf6bc5ac1fae671d39cad34eb9f">moribund_breakpoint_here_p</a> (<span class="keyword">struct</span> address_space *aspace, <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> pc)
<a name="l03930"></a>03930 {
<a name="l03931"></a>03931   <span class="keyword">struct </span>bp_location *loc;
<a name="l03932"></a>03932   <span class="keywordtype">int</span> ix;
<a name="l03933"></a>03933 
<a name="l03934"></a>03934   <span class="keywordflow">for</span> (ix = 0; <a class="code" href="vec_8h.html#ae7795b0c8e65f45eb49aac5ec2c0fa52">VEC_iterate</a> (<a class="code" href="structbp__location.html">bp_location_p</a>, moribund_locations, ix, loc); ++ix)
<a name="l03935"></a>03935     <span class="keywordflow">if</span> (breakpoint_location_address_match (loc, aspace, pc))
<a name="l03936"></a>03936       <span class="keywordflow">return</span> 1;
<a name="l03937"></a>03937 
<a name="l03938"></a>03938   <span class="keywordflow">return</span> 0;
<a name="l03939"></a>03939 }
<a name="l03940"></a>03940 
<a name="l03941"></a>03941 <span class="comment">/* Returns non-zero if there&#39;s a breakpoint inserted at PC, which is</span>
<a name="l03942"></a>03942 <span class="comment">   inserted using regular breakpoint_chain / bp_location array</span>
<a name="l03943"></a>03943 <span class="comment">   mechanism.  This does not check for single-step breakpoints, which</span>
<a name="l03944"></a>03944 <span class="comment">   are inserted and removed using direct target manipulation.  */</span>
<a name="l03945"></a>03945 
<a name="l03946"></a>03946 <span class="keywordtype">int</span>
<a name="l03947"></a><a class="code" href="breakpoint_8h.html#ab8bb21886b25550496e171eb55d536d7">03947</a> <a class="code" href="breakpoint_8c.html#ad060833d2474fab39a82541928b96359">regular_breakpoint_inserted_here_p</a> (<span class="keyword">struct</span> address_space *aspace, 
<a name="l03948"></a>03948                                     <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> pc)
<a name="l03949"></a>03949 {
<a name="l03950"></a>03950   <span class="keyword">struct </span>bp_location *bl, **blp_tmp;
<a name="l03951"></a>03951 
<a name="l03952"></a>03952   <a class="code" href="breakpoint_8c.html#a6f97c7962df1d91150e0e8de40ff7fe4">ALL_BP_LOCATIONS</a> (bl, blp_tmp)
<a name="l03953"></a>03953     {
<a name="l03954"></a>03954       <span class="keywordflow">if</span> (bl-&gt;<a class="code" href="structbp__location.html#aefe49818487e5876fc995f7831e2e809">loc_type</a> != <a class="code" href="breakpoint_8h.html#ad7006ab95a9d2493c6ad2c685f45f5dcaa74492f6095e7a1ae08e3eed468ba47d">bp_loc_software_breakpoint</a>
<a name="l03955"></a>03955           &amp;&amp; bl-&gt;<a class="code" href="structbp__location.html#aefe49818487e5876fc995f7831e2e809">loc_type</a> != <a class="code" href="breakpoint_8h.html#ad7006ab95a9d2493c6ad2c685f45f5dca4a1949653a3b3c36db5cb269a46adb60">bp_loc_hardware_breakpoint</a>)
<a name="l03956"></a>03956         <span class="keywordflow">continue</span>;
<a name="l03957"></a>03957 
<a name="l03958"></a>03958       <span class="keywordflow">if</span> (bl-&gt;<a class="code" href="structbp__location.html#acb0b475579bbe5dabeb8ed4504527105">inserted</a>
<a name="l03959"></a>03959           &amp;&amp; breakpoint_location_address_match (bl, aspace, pc))
<a name="l03960"></a>03960         {
<a name="l03961"></a>03961           <span class="keywordflow">if</span> (<a class="code" href="symfile_8c.html#ad96d01ef61ee2925825b3992d37408f5">overlay_debugging</a> 
<a name="l03962"></a>03962               &amp;&amp; <a class="code" href="symfile_8c.html#ad63f10fe5266cd2e98883d6f4c054c3a">section_is_overlay</a> (bl-&gt;<a class="code" href="structbp__location.html#ac6d8286e46db5c4be6dab9139c43a00d">section</a>)
<a name="l03963"></a>03963               &amp;&amp; !<a class="code" href="symfile_8c.html#a2d6f94d48a782be7460e704fec67adb4">section_is_mapped</a> (bl-&gt;<a class="code" href="structbp__location.html#ac6d8286e46db5c4be6dab9139c43a00d">section</a>))
<a name="l03964"></a>03964             <span class="keywordflow">continue</span>;           <span class="comment">/* unmapped overlay -- can&#39;t be a match */</span>
<a name="l03965"></a>03965           <span class="keywordflow">else</span>
<a name="l03966"></a>03966             <span class="keywordflow">return</span> 1;
<a name="l03967"></a>03967         }
<a name="l03968"></a>03968     }
<a name="l03969"></a>03969   <span class="keywordflow">return</span> 0;
<a name="l03970"></a>03970 }
<a name="l03971"></a>03971 
<a name="l03972"></a>03972 <span class="comment">/* Returns non-zero iff there&#39;s either regular breakpoint</span>
<a name="l03973"></a>03973 <span class="comment">   or a single step breakpoint inserted at PC.  */</span>
<a name="l03974"></a>03974 
<a name="l03975"></a>03975 <span class="keywordtype">int</span>
<a name="l03976"></a><a class="code" href="breakpoint_8h.html#a1d8edc32fc47810a06ec3eda795e47f7">03976</a> <a class="code" href="breakpoint_8c.html#a4f22948f03a2b4e781b6d6c950672faf">breakpoint_inserted_here_p</a> (<span class="keyword">struct</span> address_space *aspace, <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> pc)
<a name="l03977"></a>03977 {
<a name="l03978"></a>03978   <span class="keywordflow">if</span> (<a class="code" href="breakpoint_8c.html#ad060833d2474fab39a82541928b96359">regular_breakpoint_inserted_here_p</a> (aspace, pc))
<a name="l03979"></a>03979     <span class="keywordflow">return</span> 1;
<a name="l03980"></a>03980 
<a name="l03981"></a>03981   <span class="keywordflow">if</span> (single_step_breakpoint_inserted_here_p (aspace, pc))
<a name="l03982"></a>03982     <span class="keywordflow">return</span> 1;
<a name="l03983"></a>03983 
<a name="l03984"></a>03984   <span class="keywordflow">return</span> 0;
<a name="l03985"></a>03985 }
<a name="l03986"></a>03986 
<a name="l03987"></a>03987 <span class="comment">/* This function returns non-zero iff there is a software breakpoint</span>
<a name="l03988"></a>03988 <span class="comment">   inserted at PC.  */</span>
<a name="l03989"></a>03989 
<a name="l03990"></a>03990 <span class="keywordtype">int</span>
<a name="l03991"></a><a class="code" href="breakpoint_8h.html#aed69355bcd540adde0fe77838b1092e2">03991</a> <a class="code" href="breakpoint_8c.html#a4059e1be3362d8309b4ec79a92503ed6">software_breakpoint_inserted_here_p</a> (<span class="keyword">struct</span> address_space *aspace,
<a name="l03992"></a>03992                                      <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> pc)
<a name="l03993"></a>03993 {
<a name="l03994"></a>03994   <span class="keyword">struct </span>bp_location *bl, **blp_tmp;
<a name="l03995"></a>03995 
<a name="l03996"></a>03996   <a class="code" href="breakpoint_8c.html#a6f97c7962df1d91150e0e8de40ff7fe4">ALL_BP_LOCATIONS</a> (bl, blp_tmp)
<a name="l03997"></a>03997     {
<a name="l03998"></a>03998       <span class="keywordflow">if</span> (bl-&gt;<a class="code" href="structbp__location.html#aefe49818487e5876fc995f7831e2e809">loc_type</a> != <a class="code" href="breakpoint_8h.html#ad7006ab95a9d2493c6ad2c685f45f5dcaa74492f6095e7a1ae08e3eed468ba47d">bp_loc_software_breakpoint</a>)
<a name="l03999"></a>03999         <span class="keywordflow">continue</span>;
<a name="l04000"></a>04000 
<a name="l04001"></a>04001       <span class="keywordflow">if</span> (bl-&gt;<a class="code" href="structbp__location.html#acb0b475579bbe5dabeb8ed4504527105">inserted</a>
<a name="l04002"></a>04002           &amp;&amp; breakpoint_address_match (bl-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a>-&gt;<a class="code" href="structprogram__space.html#abf2a489f5ed3c1d5cad74d14dbb318e4">aspace</a>, bl-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>,
<a name="l04003"></a>04003                                        aspace, pc))
<a name="l04004"></a>04004         {
<a name="l04005"></a>04005           <span class="keywordflow">if</span> (<a class="code" href="symfile_8c.html#ad96d01ef61ee2925825b3992d37408f5">overlay_debugging</a> 
<a name="l04006"></a>04006               &amp;&amp; <a class="code" href="symfile_8c.html#ad63f10fe5266cd2e98883d6f4c054c3a">section_is_overlay</a> (bl-&gt;<a class="code" href="structbp__location.html#ac6d8286e46db5c4be6dab9139c43a00d">section</a>)
<a name="l04007"></a>04007               &amp;&amp; !<a class="code" href="symfile_8c.html#a2d6f94d48a782be7460e704fec67adb4">section_is_mapped</a> (bl-&gt;<a class="code" href="structbp__location.html#ac6d8286e46db5c4be6dab9139c43a00d">section</a>))
<a name="l04008"></a>04008             <span class="keywordflow">continue</span>;           <span class="comment">/* unmapped overlay -- can&#39;t be a match */</span>
<a name="l04009"></a>04009           <span class="keywordflow">else</span>
<a name="l04010"></a>04010             <span class="keywordflow">return</span> 1;
<a name="l04011"></a>04011         }
<a name="l04012"></a>04012     }
<a name="l04013"></a>04013 
<a name="l04014"></a>04014   <span class="comment">/* Also check for software single-step breakpoints.  */</span>
<a name="l04015"></a>04015   <span class="keywordflow">if</span> (single_step_breakpoint_inserted_here_p (aspace, pc))
<a name="l04016"></a>04016     <span class="keywordflow">return</span> 1;
<a name="l04017"></a>04017 
<a name="l04018"></a>04018   <span class="keywordflow">return</span> 0;
<a name="l04019"></a>04019 }
<a name="l04020"></a>04020 
<a name="l04021"></a>04021 <span class="keywordtype">int</span>
<a name="l04022"></a><a class="code" href="breakpoint_8h.html#aa248df89648898368987d90e3f83c5a5">04022</a> <a class="code" href="breakpoint_8c.html#a256b3400d25f9731dcea9d4c4763f4d8">hardware_watchpoint_inserted_in_range</a> (<span class="keyword">struct</span> address_space *aspace,
<a name="l04023"></a>04023                                        <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> addr, <a class="code" href="defs_8h.html#a4df4af8771b1016a24976757026f4984">ULONGEST</a> len)
<a name="l04024"></a>04024 {
<a name="l04025"></a>04025   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *bpt;
<a name="l04026"></a>04026 
<a name="l04027"></a>04027   <a class="code" href="breakpoint_8c.html#a781d5d3dc50a92364edfbacac3d0c107">ALL_BREAKPOINTS</a> (bpt)
<a name="l04028"></a>04028     {
<a name="l04029"></a>04029       <span class="keyword">struct </span>bp_location *loc;
<a name="l04030"></a>04030 
<a name="l04031"></a>04031       <span class="keywordflow">if</span> (bpt-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> != <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfae38a33f5a6725fbca8b5da2d491cfbcb">bp_hardware_watchpoint</a>
<a name="l04032"></a>04032           &amp;&amp; bpt-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> != <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa9148c330e0f813ed6fb421af9d7da820">bp_access_watchpoint</a>)
<a name="l04033"></a>04033         <span class="keywordflow">continue</span>;
<a name="l04034"></a>04034 
<a name="l04035"></a>04035       <span class="keywordflow">if</span> (!breakpoint_enabled (bpt))
<a name="l04036"></a>04036         <span class="keywordflow">continue</span>;
<a name="l04037"></a>04037 
<a name="l04038"></a>04038       <span class="keywordflow">for</span> (loc = bpt-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>; loc; loc = loc-&gt;<a class="code" href="structbp__location.html#ab193cb38f87fea89105db96d94191541">next</a>)
<a name="l04039"></a>04039         <span class="keywordflow">if</span> (loc-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a>-&gt;<a class="code" href="structprogram__space.html#abf2a489f5ed3c1d5cad74d14dbb318e4">aspace</a> == aspace &amp;&amp; loc-&gt;<a class="code" href="structbp__location.html#acb0b475579bbe5dabeb8ed4504527105">inserted</a>)
<a name="l04040"></a>04040           {
<a name="l04041"></a>04041             <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> l, h;
<a name="l04042"></a>04042 
<a name="l04043"></a>04043             <span class="comment">/* Check for intersection.  */</span>
<a name="l04044"></a>04044             l = <a class="code" href="environ_8c.html#affe776513b24d84b39af8ab0930fef7f">max</a> (loc-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>, addr);
<a name="l04045"></a>04045             h = <a class="code" href="environ_8c.html#ac6afabdc09a49a433ee19d8a9486056d">min</a> (loc-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a> + loc-&gt;<a class="code" href="structbp__location.html#a3d4ad6914964554ca761607f9e8fab62">length</a>, addr + len);
<a name="l04046"></a>04046             <span class="keywordflow">if</span> (l &lt; h)
<a name="l04047"></a>04047               <span class="keywordflow">return</span> 1;
<a name="l04048"></a>04048           }
<a name="l04049"></a>04049     }
<a name="l04050"></a>04050   <span class="keywordflow">return</span> 0;
<a name="l04051"></a>04051 }
<a name="l04052"></a>04052 
<a name="l04053"></a>04053 <span class="comment">/* breakpoint_thread_match (PC, PTID) returns true if the breakpoint at</span>
<a name="l04054"></a>04054 <span class="comment">   PC is valid for process/thread PTID.  */</span>
<a name="l04055"></a>04055 
<a name="l04056"></a>04056 <span class="keywordtype">int</span>
<a name="l04057"></a><a class="code" href="breakpoint_8h.html#a4907b42b08bdea6e94ec398fa039ecfb">04057</a> <a class="code" href="breakpoint_8c.html#a3b0249b6669206b4e445ccdaff77a372">breakpoint_thread_match</a> (<span class="keyword">struct</span> address_space *aspace, <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> pc,
<a name="l04058"></a>04058                          <a class="code" href="structptid.html">ptid_t</a> <a class="code" href="structptid.html">ptid</a>)
<a name="l04059"></a>04059 {
<a name="l04060"></a>04060   <span class="keyword">struct </span>bp_location *bl, **blp_tmp;
<a name="l04061"></a>04061   <span class="comment">/* The thread and task IDs associated to PTID, computed lazily.  */</span>
<a name="l04062"></a>04062   <span class="keywordtype">int</span> thread = -1;
<a name="l04063"></a>04063   <span class="keywordtype">int</span> task = 0;
<a name="l04064"></a>04064   
<a name="l04065"></a>04065   <a class="code" href="breakpoint_8c.html#a6f97c7962df1d91150e0e8de40ff7fe4">ALL_BP_LOCATIONS</a> (bl, blp_tmp)
<a name="l04066"></a>04066     {
<a name="l04067"></a>04067       <span class="keywordflow">if</span> (bl-&gt;<a class="code" href="structbp__location.html#aefe49818487e5876fc995f7831e2e809">loc_type</a> != <a class="code" href="breakpoint_8h.html#ad7006ab95a9d2493c6ad2c685f45f5dcaa74492f6095e7a1ae08e3eed468ba47d">bp_loc_software_breakpoint</a>
<a name="l04068"></a>04068           &amp;&amp; bl-&gt;<a class="code" href="structbp__location.html#aefe49818487e5876fc995f7831e2e809">loc_type</a> != <a class="code" href="breakpoint_8h.html#ad7006ab95a9d2493c6ad2c685f45f5dca4a1949653a3b3c36db5cb269a46adb60">bp_loc_hardware_breakpoint</a>)
<a name="l04069"></a>04069         <span class="keywordflow">continue</span>;
<a name="l04070"></a>04070 
<a name="l04071"></a>04071       <span class="comment">/* ALL_BP_LOCATIONS bp_location has bl-&gt;OWNER always non-NULL.  */</span>
<a name="l04072"></a>04072       <span class="keywordflow">if</span> (!breakpoint_enabled (bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>)
<a name="l04073"></a>04073           &amp;&amp; bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#acb53352fd35aaad37054508fabc0f3bf">enable_state</a> != <a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577adbf2e9b210d33b1ac7e8a7ed87a2b46f">bp_permanent</a>)
<a name="l04074"></a>04074         <span class="keywordflow">continue</span>;
<a name="l04075"></a>04075 
<a name="l04076"></a>04076       <span class="keywordflow">if</span> (!breakpoint_location_address_match (bl, aspace, pc))
<a name="l04077"></a>04077         <span class="keywordflow">continue</span>;
<a name="l04078"></a>04078 
<a name="l04079"></a>04079       <span class="keywordflow">if</span> (bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#ae8613b6d8cf464f30ea39597be0cc192">thread</a> != -1)
<a name="l04080"></a>04080         {
<a name="l04081"></a>04081           <span class="comment">/* This is a thread-specific breakpoint.  Check that ptid</span>
<a name="l04082"></a>04082 <span class="comment">             matches that thread.  If thread hasn&#39;t been computed yet,</span>
<a name="l04083"></a>04083 <span class="comment">             it is now time to do so.  */</span>
<a name="l04084"></a>04084           <span class="keywordflow">if</span> (thread == -1)
<a name="l04085"></a>04085             thread = <a class="code" href="gdbthread_8h.html#a3dbd3518561f91d8aa7621a65d39f305">pid_to_thread_id</a> (ptid);
<a name="l04086"></a>04086           <span class="keywordflow">if</span> (bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#ae8613b6d8cf464f30ea39597be0cc192">thread</a> != thread)
<a name="l04087"></a>04087             <span class="keywordflow">continue</span>;
<a name="l04088"></a>04088         }
<a name="l04089"></a>04089 
<a name="l04090"></a>04090       <span class="keywordflow">if</span> (bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#a9dc2d2b94cb051b28f86f8780dbad907">task</a> != 0)
<a name="l04091"></a>04091         {
<a name="l04092"></a>04092           <span class="comment">/* This is a task-specific breakpoint.  Check that ptid</span>
<a name="l04093"></a>04093 <span class="comment">             matches that task.  If task hasn&#39;t been computed yet,</span>
<a name="l04094"></a>04094 <span class="comment">             it is now time to do so.  */</span>
<a name="l04095"></a>04095           <span class="keywordflow">if</span> (task == 0)
<a name="l04096"></a>04096             task = <a class="code" href="ada-lang_8h.html#ad13fb631adf7eb9d110194476496d6b0">ada_get_task_number</a> (ptid);
<a name="l04097"></a>04097           <span class="keywordflow">if</span> (bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#a9dc2d2b94cb051b28f86f8780dbad907">task</a> != task)
<a name="l04098"></a>04098             <span class="keywordflow">continue</span>;
<a name="l04099"></a>04099         }
<a name="l04100"></a>04100 
<a name="l04101"></a>04101       <span class="keywordflow">if</span> (<a class="code" href="symfile_8c.html#ad96d01ef61ee2925825b3992d37408f5">overlay_debugging</a> 
<a name="l04102"></a>04102           &amp;&amp; <a class="code" href="symfile_8c.html#ad63f10fe5266cd2e98883d6f4c054c3a">section_is_overlay</a> (bl-&gt;<a class="code" href="structbp__location.html#ac6d8286e46db5c4be6dab9139c43a00d">section</a>)
<a name="l04103"></a>04103           &amp;&amp; !<a class="code" href="symfile_8c.html#a2d6f94d48a782be7460e704fec67adb4">section_is_mapped</a> (bl-&gt;<a class="code" href="structbp__location.html#ac6d8286e46db5c4be6dab9139c43a00d">section</a>))
<a name="l04104"></a>04104         <span class="keywordflow">continue</span>;           <span class="comment">/* unmapped overlay -- can&#39;t be a match */</span>
<a name="l04105"></a>04105 
<a name="l04106"></a>04106       <span class="keywordflow">return</span> 1;
<a name="l04107"></a>04107     }
<a name="l04108"></a>04108 
<a name="l04109"></a>04109   <span class="keywordflow">return</span> 0;
<a name="l04110"></a>04110 }
<a name="l04111"></a>04111 
<a name="l04112"></a>04112 
<a name="l04113"></a>04113 <span class="comment">/* bpstat stuff.  External routines&#39; interfaces are documented</span>
<a name="l04114"></a>04114 <span class="comment">   in breakpoint.h.  */</span>
<a name="l04115"></a>04115 
<a name="l04116"></a>04116 <span class="keywordtype">int</span>
<a name="l04117"></a><a class="code" href="breakpoint_8h.html#a2b1707477d3c643552d00b13a5f33da0">04117</a> <a class="code" href="breakpoint_8c.html#acc3e8e9fba058800f42671adebbfa950">is_catchpoint</a> (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *ep)
<a name="l04118"></a>04118 {
<a name="l04119"></a>04119   <span class="keywordflow">return</span> (ep-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa8ebb961cef940b8ddef84696b7ac9694">bp_catchpoint</a>);
<a name="l04120"></a>04120 }
<a name="l04121"></a>04121 
<a name="l04122"></a>04122 <span class="comment">/* Frees any storage that is part of a bpstat.  Does not walk the</span>
<a name="l04123"></a>04123 <span class="comment">   &#39;next&#39; chain.  */</span>
<a name="l04124"></a>04124 
<a name="l04125"></a>04125 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l04126"></a>04126 bpstat_free (<a class="code" href="structbpstats.html">bpstat</a> bs)
<a name="l04127"></a>04127 {
<a name="l04128"></a>04128   <span class="keywordflow">if</span> (bs-&gt;<a class="code" href="structbpstats.html#aa68c6ad7e88a1d21640560008a44c287">old_val</a> != NULL)
<a name="l04129"></a>04129     <a class="code" href="value_8c.html#a1f9b3ee232ece65ddc75c2407b97a50d">value_free</a> (bs-&gt;<a class="code" href="structbpstats.html#aa68c6ad7e88a1d21640560008a44c287">old_val</a>);
<a name="l04130"></a>04130   decref_counted_command_line (&amp;bs-&gt;<a class="code" href="structbpstats.html#a2c06ba2ce8217014988be902dc5228a4">commands</a>);
<a name="l04131"></a>04131   decref_bp_location (&amp;bs-&gt;<a class="code" href="structbpstats.html#a510428e7ce2e4852e0613b3b5579142b">bp_location_at</a>);
<a name="l04132"></a>04132   <a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a> (bs);
<a name="l04133"></a>04133 }
<a name="l04134"></a>04134 
<a name="l04135"></a>04135 <span class="comment">/* Clear a bpstat so that it says we are not at any breakpoint.</span>
<a name="l04136"></a>04136 <span class="comment">   Also free any storage that is part of a bpstat.  */</span>
<a name="l04137"></a>04137 
<a name="l04138"></a>04138 <span class="keywordtype">void</span>
<a name="l04139"></a><a class="code" href="breakpoint_8h.html#adfe68ada34a9dc9313d1413dfb8ff5e0">04139</a> <a class="code" href="breakpoint_8c.html#a5c8ed8f97f7726ca3b0996ac81b4967f">bpstat_clear</a> (<a class="code" href="structbpstats.html">bpstat</a> *bsp)
<a name="l04140"></a>04140 {
<a name="l04141"></a>04141   <a class="code" href="structbpstats.html">bpstat</a> p;
<a name="l04142"></a>04142   <a class="code" href="structbpstats.html">bpstat</a> q;
<a name="l04143"></a>04143 
<a name="l04144"></a>04144   <span class="keywordflow">if</span> (bsp == 0)
<a name="l04145"></a>04145     <span class="keywordflow">return</span>;
<a name="l04146"></a>04146   p = *bsp;
<a name="l04147"></a>04147   <span class="keywordflow">while</span> (p != NULL)
<a name="l04148"></a>04148     {
<a name="l04149"></a>04149       q = p-&gt;<a class="code" href="structbpstats.html#a48ed65e040defb4d45e1cea1a8414d6c">next</a>;
<a name="l04150"></a>04150       bpstat_free (p);
<a name="l04151"></a>04151       p = q;
<a name="l04152"></a>04152     }
<a name="l04153"></a>04153   *bsp = NULL;
<a name="l04154"></a>04154 }
<a name="l04155"></a>04155 
<a name="l04156"></a>04156 <span class="comment">/* Return a copy of a bpstat.  Like &quot;bs1 = bs2&quot; but all storage that</span>
<a name="l04157"></a>04157 <span class="comment">   is part of the bpstat is copied as well.  */</span>
<a name="l04158"></a>04158 
<a name="l04159"></a>04159 <a class="code" href="structbpstats.html">bpstat</a>
<a name="l04160"></a><a class="code" href="breakpoint_8h.html#aeb65dbdf2c74dbeb5ca72ec6bc47b353">04160</a> <a class="code" href="breakpoint_8c.html#a450706c66b42459b76839110df979d45">bpstat_copy</a> (<a class="code" href="structbpstats.html">bpstat</a> bs)
<a name="l04161"></a>04161 {
<a name="l04162"></a>04162   <a class="code" href="structbpstats.html">bpstat</a> p = NULL;
<a name="l04163"></a>04163   <a class="code" href="structbpstats.html">bpstat</a> tmp;
<a name="l04164"></a>04164   <a class="code" href="structbpstats.html">bpstat</a> retval = NULL;
<a name="l04165"></a>04165 
<a name="l04166"></a>04166   <span class="keywordflow">if</span> (bs == NULL)
<a name="l04167"></a>04167     <span class="keywordflow">return</span> bs;
<a name="l04168"></a>04168 
<a name="l04169"></a>04169   <span class="keywordflow">for</span> (; bs != NULL; bs = bs-&gt;<a class="code" href="structbpstats.html#a48ed65e040defb4d45e1cea1a8414d6c">next</a>)
<a name="l04170"></a>04170     {
<a name="l04171"></a>04171       tmp = (<a class="code" href="breakpoint_8h.html#a133118f2ec2fad53196153b5b47e57dd">bpstat</a>) <a class="code" href="common-utils_8c.html#a634d6cd850bb831afebc499579303b3b">xmalloc</a> (<span class="keyword">sizeof</span> (*tmp));
<a name="l04172"></a>04172       <a class="code" href="gdb__string_8h.html#a39ebe6a4e122707997e78b549a1e8c5e">memcpy</a> (tmp, bs, <span class="keyword">sizeof</span> (*tmp));
<a name="l04173"></a>04173       incref_counted_command_line (tmp-&gt;<a class="code" href="structbpstats.html#a2c06ba2ce8217014988be902dc5228a4">commands</a>);
<a name="l04174"></a>04174       incref_bp_location (tmp-&gt;<a class="code" href="structbpstats.html#a510428e7ce2e4852e0613b3b5579142b">bp_location_at</a>);
<a name="l04175"></a>04175       <span class="keywordflow">if</span> (bs-&gt;<a class="code" href="structbpstats.html#aa68c6ad7e88a1d21640560008a44c287">old_val</a> != NULL)
<a name="l04176"></a>04176         {
<a name="l04177"></a>04177           tmp-&gt;<a class="code" href="structbpstats.html#aa68c6ad7e88a1d21640560008a44c287">old_val</a> = <a class="code" href="value_8c.html#abe2b4f6342cfefdbb63666b6bcba636b">value_copy</a> (bs-&gt;<a class="code" href="structbpstats.html#aa68c6ad7e88a1d21640560008a44c287">old_val</a>);
<a name="l04178"></a>04178           <a class="code" href="value_8c.html#a5a9662fcdbefec2edef0b912ba593914">release_value</a> (tmp-&gt;<a class="code" href="structbpstats.html#aa68c6ad7e88a1d21640560008a44c287">old_val</a>);
<a name="l04179"></a>04179         }
<a name="l04180"></a>04180 
<a name="l04181"></a>04181       <span class="keywordflow">if</span> (p == NULL)
<a name="l04182"></a>04182         <span class="comment">/* This is the first thing in the chain.  */</span>
<a name="l04183"></a>04183         retval = tmp;
<a name="l04184"></a>04184       <span class="keywordflow">else</span>
<a name="l04185"></a>04185         p-&gt;<a class="code" href="structbpstats.html#a48ed65e040defb4d45e1cea1a8414d6c">next</a> = tmp;
<a name="l04186"></a>04186       p = tmp;
<a name="l04187"></a>04187     }
<a name="l04188"></a>04188   p-&gt;<a class="code" href="structbpstats.html#a48ed65e040defb4d45e1cea1a8414d6c">next</a> = NULL;
<a name="l04189"></a>04189   <span class="keywordflow">return</span> retval;
<a name="l04190"></a>04190 }
<a name="l04191"></a>04191 
<a name="l04192"></a>04192 <span class="comment">/* Find the bpstat associated with this breakpoint.  */</span>
<a name="l04193"></a>04193 
<a name="l04194"></a>04194 <a class="code" href="structbpstats.html">bpstat</a>
<a name="l04195"></a><a class="code" href="breakpoint_8h.html#ac40bdd8c807e1948e4ae7896dcb3563a">04195</a> <a class="code" href="breakpoint_8c.html#a818299498e8cef8417fb3c2de5367d73">bpstat_find_breakpoint</a> (<a class="code" href="structbpstats.html">bpstat</a> bsp, <span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *<a class="code" href="structbreakpoint.html">breakpoint</a>)
<a name="l04196"></a>04196 {
<a name="l04197"></a>04197   <span class="keywordflow">if</span> (bsp == NULL)
<a name="l04198"></a>04198     <span class="keywordflow">return</span> NULL;
<a name="l04199"></a>04199 
<a name="l04200"></a>04200   <span class="keywordflow">for</span> (; bsp != NULL; bsp = bsp-&gt;<a class="code" href="structbpstats.html#a48ed65e040defb4d45e1cea1a8414d6c">next</a>)
<a name="l04201"></a>04201     {
<a name="l04202"></a>04202       <span class="keywordflow">if</span> (bsp-&gt;<a class="code" href="structbpstats.html#ac105ed7263dd10f9d65e92e706b04e39">breakpoint_at</a> == breakpoint)
<a name="l04203"></a>04203         <span class="keywordflow">return</span> bsp;
<a name="l04204"></a>04204     }
<a name="l04205"></a>04205   <span class="keywordflow">return</span> NULL;
<a name="l04206"></a>04206 }
<a name="l04207"></a>04207 
<a name="l04208"></a>04208 <span class="comment">/* See breakpoint.h.  */</span>
<a name="l04209"></a>04209 
<a name="l04210"></a>04210 <span class="keyword">enum</span> <a class="code" href="breakpoint_8h.html#a5ac39ee414da54677fa916b1d5579d6f">bpstat_signal_value</a>
<a name="l04211"></a><a class="code" href="breakpoint_8h.html#ac9f3cb40c8a7e560b47b926cb120d122">04211</a> <a class="code" href="breakpoint_8c.html#ab66a9a0cd3f1401bb7dc095e10871cd6">bpstat_explains_signal</a> (<a class="code" href="structbpstats.html">bpstat</a> bsp, <span class="keyword">enum</span> <a class="code" href="signals_8h.html#a1169a44d7b94bdcf747c3f69138dafe7">gdb_signal</a> sig)
<a name="l04212"></a>04212 {
<a name="l04213"></a>04213   <span class="keyword">enum</span> <a class="code" href="breakpoint_8h.html#a5ac39ee414da54677fa916b1d5579d6f">bpstat_signal_value</a> result = <a class="code" href="breakpoint_8h.html#a5ac39ee414da54677fa916b1d5579d6fa334caf0845d82433a64ddb70eeef7b46">BPSTAT_SIGNAL_NO</a>;
<a name="l04214"></a>04214 
<a name="l04215"></a>04215   <span class="keywordflow">for</span> (; bsp != NULL; bsp = bsp-&gt;<a class="code" href="structbpstats.html#a48ed65e040defb4d45e1cea1a8414d6c">next</a>)
<a name="l04216"></a>04216     {
<a name="l04217"></a>04217       <span class="comment">/* Ensure that, if we ever entered this loop, then we at least</span>
<a name="l04218"></a>04218 <span class="comment">         return BPSTAT_SIGNAL_HIDE.  */</span>
<a name="l04219"></a>04219       <span class="keyword">enum</span> <a class="code" href="breakpoint_8h.html#a5ac39ee414da54677fa916b1d5579d6f">bpstat_signal_value</a> newval;
<a name="l04220"></a>04220 
<a name="l04221"></a>04221       <span class="keywordflow">if</span> (bsp-&gt;<a class="code" href="structbpstats.html#ac105ed7263dd10f9d65e92e706b04e39">breakpoint_at</a> == NULL)
<a name="l04222"></a>04222         {
<a name="l04223"></a>04223           <span class="comment">/* A moribund location can never explain a signal other than</span>
<a name="l04224"></a>04224 <span class="comment">             GDB_SIGNAL_TRAP.  */</span>
<a name="l04225"></a>04225           <span class="keywordflow">if</span> (sig == GDB_SIGNAL_TRAP)
<a name="l04226"></a>04226             newval = <a class="code" href="breakpoint_8h.html#a5ac39ee414da54677fa916b1d5579d6fa7c293d7c0de70c6e2549b8fc0e84cbfe">BPSTAT_SIGNAL_HIDE</a>;
<a name="l04227"></a>04227           <span class="keywordflow">else</span>
<a name="l04228"></a>04228             newval = <a class="code" href="breakpoint_8h.html#a5ac39ee414da54677fa916b1d5579d6fa334caf0845d82433a64ddb70eeef7b46">BPSTAT_SIGNAL_NO</a>;
<a name="l04229"></a>04229         }
<a name="l04230"></a>04230       <span class="keywordflow">else</span>
<a name="l04231"></a>04231         newval = bsp-&gt;<a class="code" href="structbpstats.html#ac105ed7263dd10f9d65e92e706b04e39">breakpoint_at</a>-&gt;<a class="code" href="structbreakpoint.html#aba258aa23496f6434aaa1cf8c8dc7ea7">ops</a>-&gt;<a class="code" href="structbreakpoint__ops.html#a5d8be90b4517d50f92133e164e1b5c93">explains_signal</a> (bsp-&gt;<a class="code" href="structbpstats.html#ac105ed7263dd10f9d65e92e706b04e39">breakpoint_at</a>,
<a name="l04232"></a>04232                                                            sig);
<a name="l04233"></a>04233 
<a name="l04234"></a>04234       <span class="keywordflow">if</span> (newval &gt; result)
<a name="l04235"></a>04235         result = newval;
<a name="l04236"></a>04236     }
<a name="l04237"></a>04237 
<a name="l04238"></a>04238   <span class="keywordflow">return</span> result;
<a name="l04239"></a>04239 }
<a name="l04240"></a>04240 
<a name="l04241"></a>04241 <span class="comment">/* Put in *NUM the breakpoint number of the first breakpoint we are</span>
<a name="l04242"></a>04242 <span class="comment">   stopped at.  *BSP upon return is a bpstat which points to the</span>
<a name="l04243"></a>04243 <span class="comment">   remaining breakpoints stopped at (but which is not guaranteed to be</span>
<a name="l04244"></a>04244 <span class="comment">   good for anything but further calls to bpstat_num).</span>
<a name="l04245"></a>04245 <span class="comment"></span>
<a name="l04246"></a>04246 <span class="comment">   Return 0 if passed a bpstat which does not indicate any breakpoints.</span>
<a name="l04247"></a>04247 <span class="comment">   Return -1 if stopped at a breakpoint that has been deleted since</span>
<a name="l04248"></a>04248 <span class="comment">   we set it.</span>
<a name="l04249"></a>04249 <span class="comment">   Return 1 otherwise.  */</span>
<a name="l04250"></a>04250 
<a name="l04251"></a>04251 <span class="keywordtype">int</span>
<a name="l04252"></a><a class="code" href="breakpoint_8h.html#a2e868bc2e233426d2431ed60fe12de9a">04252</a> <a class="code" href="breakpoint_8c.html#a3bc0c092a893e369b0f44fa29806ab42">bpstat_num</a> (<a class="code" href="structbpstats.html">bpstat</a> *bsp, <span class="keywordtype">int</span> *num)
<a name="l04253"></a>04253 {
<a name="l04254"></a>04254   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b;
<a name="l04255"></a>04255 
<a name="l04256"></a>04256   <span class="keywordflow">if</span> ((*bsp) == NULL)
<a name="l04257"></a>04257     <span class="keywordflow">return</span> 0;                   <span class="comment">/* No more breakpoint values */</span>
<a name="l04258"></a>04258 
<a name="l04259"></a>04259   <span class="comment">/* We assume we&#39;ll never have several bpstats that correspond to a</span>
<a name="l04260"></a>04260 <span class="comment">     single breakpoint -- otherwise, this function might return the</span>
<a name="l04261"></a>04261 <span class="comment">     same number more than once and this will look ugly.  */</span>
<a name="l04262"></a>04262   b = (*bsp)-&gt;breakpoint_at;
<a name="l04263"></a>04263   *bsp = (*bsp)-&gt;<a class="code" href="structbpstats.html#a48ed65e040defb4d45e1cea1a8414d6c">next</a>;
<a name="l04264"></a>04264   <span class="keywordflow">if</span> (b == NULL)
<a name="l04265"></a>04265     <span class="keywordflow">return</span> -1;                  <span class="comment">/* breakpoint that&#39;s been deleted since */</span>
<a name="l04266"></a>04266 
<a name="l04267"></a>04267   *num = b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>;             <span class="comment">/* We have its number */</span>
<a name="l04268"></a>04268   <span class="keywordflow">return</span> 1;
<a name="l04269"></a>04269 }
<a name="l04270"></a>04270 
<a name="l04271"></a>04271 <span class="comment">/* See breakpoint.h.  */</span>
<a name="l04272"></a>04272 
<a name="l04273"></a>04273 <span class="keywordtype">void</span>
<a name="l04274"></a><a class="code" href="breakpoint_8h.html#a67da14c34e451a56dbabb3656ebe632a">04274</a> <a class="code" href="breakpoint_8c.html#a67da14c34e451a56dbabb3656ebe632a">bpstat_clear_actions</a> (<span class="keywordtype">void</span>)
<a name="l04275"></a>04275 {
<a name="l04276"></a>04276   <span class="keyword">struct </span><a class="code" href="structthread__info.html">thread_info</a> *tp;
<a name="l04277"></a>04277   <a class="code" href="structbpstats.html">bpstat</a> bs;
<a name="l04278"></a>04278 
<a name="l04279"></a>04279   <span class="keywordflow">if</span> (<a class="code" href="ptid_8c.html#a0df58c8db2620a2cec647934b4f77266">ptid_equal</a> (<a class="code" href="infcmd_8c.html#a428c5be9ce5e70bd03760e828e19c6b7">inferior_ptid</a>, <a class="code" href="ptid_8c.html#acba69c857786546b204883bbcc90a64e">null_ptid</a>))
<a name="l04280"></a>04280     <span class="keywordflow">return</span>;
<a name="l04281"></a>04281 
<a name="l04282"></a>04282   tp = <a class="code" href="gdbthread_8h.html#ac9a7f4c3c173f717f0da44f83745384c">find_thread_ptid</a> (<a class="code" href="infcmd_8c.html#a428c5be9ce5e70bd03760e828e19c6b7">inferior_ptid</a>);
<a name="l04283"></a>04283   <span class="keywordflow">if</span> (tp == NULL)
<a name="l04284"></a>04284     <span class="keywordflow">return</span>;
<a name="l04285"></a>04285 
<a name="l04286"></a>04286   <span class="keywordflow">for</span> (bs = tp-&gt;<a class="code" href="structthread__info.html#a223c3ebf1726773195c6e75c247ddd3c">control</a>.<a class="code" href="structthread__control__state.html#a15ed8032aa30422557798ba220c38073">stop_bpstat</a>; bs != NULL; bs = bs-&gt;<a class="code" href="structbpstats.html#a48ed65e040defb4d45e1cea1a8414d6c">next</a>)
<a name="l04287"></a>04287     {
<a name="l04288"></a>04288       decref_counted_command_line (&amp;bs-&gt;<a class="code" href="structbpstats.html#a2c06ba2ce8217014988be902dc5228a4">commands</a>);
<a name="l04289"></a>04289 
<a name="l04290"></a>04290       <span class="keywordflow">if</span> (bs-&gt;<a class="code" href="structbpstats.html#aa68c6ad7e88a1d21640560008a44c287">old_val</a> != NULL)
<a name="l04291"></a>04291         {
<a name="l04292"></a>04292           <a class="code" href="value_8c.html#a1f9b3ee232ece65ddc75c2407b97a50d">value_free</a> (bs-&gt;<a class="code" href="structbpstats.html#aa68c6ad7e88a1d21640560008a44c287">old_val</a>);
<a name="l04293"></a>04293           bs-&gt;<a class="code" href="structbpstats.html#aa68c6ad7e88a1d21640560008a44c287">old_val</a> = NULL;
<a name="l04294"></a>04294         }
<a name="l04295"></a>04295     }
<a name="l04296"></a>04296 }
<a name="l04297"></a>04297 
<a name="l04298"></a>04298 <span class="comment">/* Called when a command is about to proceed the inferior.  */</span>
<a name="l04299"></a>04299 
<a name="l04300"></a>04300 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l04301"></a>04301 breakpoint_about_to_proceed (<span class="keywordtype">void</span>)
<a name="l04302"></a>04302 {
<a name="l04303"></a>04303   <span class="keywordflow">if</span> (!<a class="code" href="ptid_8c.html#a0df58c8db2620a2cec647934b4f77266">ptid_equal</a> (<a class="code" href="infcmd_8c.html#a428c5be9ce5e70bd03760e828e19c6b7">inferior_ptid</a>, <a class="code" href="ptid_8c.html#acba69c857786546b204883bbcc90a64e">null_ptid</a>))
<a name="l04304"></a>04304     {
<a name="l04305"></a>04305       <span class="keyword">struct </span><a class="code" href="structthread__info.html">thread_info</a> *tp = <a class="code" href="gdbthread_8h.html#a668af1dd99cac24599dc0f3ef6458924">inferior_thread</a> ();
<a name="l04306"></a>04306 
<a name="l04307"></a>04307       <span class="comment">/* Allow inferior function calls in breakpoint commands to not</span>
<a name="l04308"></a>04308 <span class="comment">         interrupt the command list.  When the call finishes</span>
<a name="l04309"></a>04309 <span class="comment">         successfully, the inferior will be standing at the same</span>
<a name="l04310"></a>04310 <span class="comment">         breakpoint as if nothing happened.  */</span>
<a name="l04311"></a>04311       <span class="keywordflow">if</span> (tp-&gt;<a class="code" href="structthread__info.html#a223c3ebf1726773195c6e75c247ddd3c">control</a>.<a class="code" href="structthread__control__state.html#a340358c8f365b4f792bbfc16059a4e0a">in_infcall</a>)
<a name="l04312"></a>04312         <span class="keywordflow">return</span>;
<a name="l04313"></a>04313     }
<a name="l04314"></a>04314 
<a name="l04315"></a>04315   breakpoint_proceeded = 1;
<a name="l04316"></a>04316 }
<a name="l04317"></a>04317 
<a name="l04318"></a>04318 <span class="comment">/* Stub for cleaning up our state if we error-out of a breakpoint</span>
<a name="l04319"></a>04319 <span class="comment">   command.  */</span>
<a name="l04320"></a>04320 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l04321"></a>04321 cleanup_executing_breakpoints (<span class="keywordtype">void</span> *ignore)
<a name="l04322"></a>04322 {
<a name="l04323"></a>04323   executing_breakpoint_commands = 0;
<a name="l04324"></a>04324 }
<a name="l04325"></a>04325 
<a name="l04326"></a>04326 <span class="comment">/* Return non-zero iff CMD as the first line of a command sequence is `silent&#39;</span>
<a name="l04327"></a>04327 <span class="comment">   or its equivalent.  */</span>
<a name="l04328"></a>04328 
<a name="l04329"></a>04329 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l04330"></a>04330 command_line_is_silent (<span class="keyword">struct</span> <a class="code" href="structcommand__line.html">command_line</a> *cmd)
<a name="l04331"></a>04331 {
<a name="l04332"></a>04332   <span class="keywordflow">return</span> cmd &amp;&amp; (strcmp (<span class="stringliteral">&quot;silent&quot;</span>, cmd-&gt;<a class="code" href="structcommand__line.html#ac3bdd932f280976d7751ee96783a2c71">line</a>) == 0
<a name="l04333"></a>04333                  || (<a class="code" href="defs_8h.html#a195fb001f0890cfc064403357feecca1">xdb_commands</a> &amp;&amp; strcmp (<span class="stringliteral">&quot;Q&quot;</span>, cmd-&gt;<a class="code" href="structcommand__line.html#ac3bdd932f280976d7751ee96783a2c71">line</a>) == 0));
<a name="l04334"></a>04334 }
<a name="l04335"></a>04335 
<a name="l04336"></a>04336 <span class="comment">/* Execute all the commands associated with all the breakpoints at</span>
<a name="l04337"></a>04337 <span class="comment">   this location.  Any of these commands could cause the process to</span>
<a name="l04338"></a>04338 <span class="comment">   proceed beyond this point, etc.  We look out for such changes by</span>
<a name="l04339"></a>04339 <span class="comment">   checking the global &quot;breakpoint_proceeded&quot; after each command.</span>
<a name="l04340"></a>04340 <span class="comment"></span>
<a name="l04341"></a>04341 <span class="comment">   Returns true if a breakpoint command resumed the inferior.  In that</span>
<a name="l04342"></a>04342 <span class="comment">   case, it is the caller&#39;s responsibility to recall it again with the</span>
<a name="l04343"></a>04343 <span class="comment">   bpstat of the current thread.  */</span>
<a name="l04344"></a>04344 
<a name="l04345"></a>04345 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l04346"></a>04346 bpstat_do_actions_1 (<a class="code" href="structbpstats.html">bpstat</a> *bsp)
<a name="l04347"></a>04347 {
<a name="l04348"></a>04348   <a class="code" href="structbpstats.html">bpstat</a> bs;
<a name="l04349"></a>04349   <span class="keyword">struct </span>cleanup *old_chain;
<a name="l04350"></a>04350   <span class="keywordtype">int</span> again = 0;
<a name="l04351"></a>04351 
<a name="l04352"></a>04352   <span class="comment">/* Avoid endless recursion if a `source&#39; command is contained</span>
<a name="l04353"></a>04353 <span class="comment">     in bs-&gt;commands.  */</span>
<a name="l04354"></a>04354   <span class="keywordflow">if</span> (executing_breakpoint_commands)
<a name="l04355"></a>04355     <span class="keywordflow">return</span> 0;
<a name="l04356"></a>04356 
<a name="l04357"></a>04357   executing_breakpoint_commands = 1;
<a name="l04358"></a>04358   old_chain = <a class="code" href="cleanups_8c.html#a3d418f8af424aec399898c2d48b26224">make_cleanup</a> (cleanup_executing_breakpoints, 0);
<a name="l04359"></a>04359 
<a name="l04360"></a>04360   <a class="code" href="command_8h.html#a19ab75cb50d31ff69c48c3e310a538be">prevent_dont_repeat</a> ();
<a name="l04361"></a>04361 
<a name="l04362"></a>04362   <span class="comment">/* This pointer will iterate over the list of bpstat&#39;s.  */</span>
<a name="l04363"></a>04363   bs = *bsp;
<a name="l04364"></a>04364 
<a name="l04365"></a>04365   breakpoint_proceeded = 0;
<a name="l04366"></a>04366   <span class="keywordflow">for</span> (; bs != NULL; bs = bs-&gt;<a class="code" href="structbpstats.html#a48ed65e040defb4d45e1cea1a8414d6c">next</a>)
<a name="l04367"></a>04367     {
<a name="l04368"></a>04368       <span class="keyword">struct </span>counted_command_line *ccmd;
<a name="l04369"></a>04369       <span class="keyword">struct </span><a class="code" href="structcommand__line.html">command_line</a> *cmd;
<a name="l04370"></a>04370       <span class="keyword">struct </span>cleanup *this_cmd_tree_chain;
<a name="l04371"></a>04371 
<a name="l04372"></a>04372       <span class="comment">/* Take ownership of the BSP&#39;s command tree, if it has one.</span>
<a name="l04373"></a>04373 <span class="comment"></span>
<a name="l04374"></a>04374 <span class="comment">         The command tree could legitimately contain commands like</span>
<a name="l04375"></a>04375 <span class="comment">         &#39;step&#39; and &#39;next&#39;, which call clear_proceed_status, which</span>
<a name="l04376"></a>04376 <span class="comment">         frees stop_bpstat&#39;s command tree.  To make sure this doesn&#39;t</span>
<a name="l04377"></a>04377 <span class="comment">         free the tree we&#39;re executing out from under us, we need to</span>
<a name="l04378"></a>04378 <span class="comment">         take ownership of the tree ourselves.  Since a given bpstat&#39;s</span>
<a name="l04379"></a>04379 <span class="comment">         commands are only executed once, we don&#39;t need to copy it; we</span>
<a name="l04380"></a>04380 <span class="comment">         can clear the pointer in the bpstat, and make sure we free</span>
<a name="l04381"></a>04381 <span class="comment">         the tree when we&#39;re done.  */</span>
<a name="l04382"></a>04382       ccmd = bs-&gt;<a class="code" href="structbpstats.html#a2c06ba2ce8217014988be902dc5228a4">commands</a>;
<a name="l04383"></a>04383       bs-&gt;<a class="code" href="structbpstats.html#a2c06ba2ce8217014988be902dc5228a4">commands</a> = NULL;
<a name="l04384"></a>04384       this_cmd_tree_chain = make_cleanup_decref_counted_command_line (&amp;ccmd);
<a name="l04385"></a>04385       cmd = ccmd ? ccmd-&gt;commands : NULL;
<a name="l04386"></a>04386       <span class="keywordflow">if</span> (command_line_is_silent (cmd))
<a name="l04387"></a>04387         {
<a name="l04388"></a>04388           <span class="comment">/* The action has been already done by bpstat_stop_status.  */</span>
<a name="l04389"></a>04389           cmd = cmd-&gt;<a class="code" href="structcommand__line.html#aa3aea4183824359fc95edf1bf4e5291c">next</a>;
<a name="l04390"></a>04390         }
<a name="l04391"></a>04391 
<a name="l04392"></a>04392       <span class="keywordflow">while</span> (cmd != NULL)
<a name="l04393"></a>04393         {
<a name="l04394"></a>04394           <a class="code" href="cli-script_8c.html#a039b8430d3fd1ef9adf71225c99273de">execute_control_command</a> (cmd);
<a name="l04395"></a>04395 
<a name="l04396"></a>04396           <span class="keywordflow">if</span> (breakpoint_proceeded)
<a name="l04397"></a>04397             <span class="keywordflow">break</span>;
<a name="l04398"></a>04398           <span class="keywordflow">else</span>
<a name="l04399"></a>04399             cmd = cmd-&gt;<a class="code" href="structcommand__line.html#aa3aea4183824359fc95edf1bf4e5291c">next</a>;
<a name="l04400"></a>04400         }
<a name="l04401"></a>04401 
<a name="l04402"></a>04402       <span class="comment">/* We can free this command tree now.  */</span>
<a name="l04403"></a>04403       <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (this_cmd_tree_chain);
<a name="l04404"></a>04404 
<a name="l04405"></a>04405       <span class="keywordflow">if</span> (breakpoint_proceeded)
<a name="l04406"></a>04406         {
<a name="l04407"></a>04407           <span class="keywordflow">if</span> (<a class="code" href="target_8h.html#a2b6015c90130096b2e9757013e49c1e9">target_can_async_p</a> ())
<a name="l04408"></a>04408             <span class="comment">/* If we are in async mode, then the target might be still</span>
<a name="l04409"></a>04409 <span class="comment">               running, not stopped at any breakpoint, so nothing for</span>
<a name="l04410"></a>04410 <span class="comment">               us to do here -- just return to the event loop.  */</span>
<a name="l04411"></a>04411             ;
<a name="l04412"></a>04412           <span class="keywordflow">else</span>
<a name="l04413"></a>04413             <span class="comment">/* In sync mode, when execute_control_command returns</span>
<a name="l04414"></a>04414 <span class="comment">               we&#39;re already standing on the next breakpoint.</span>
<a name="l04415"></a>04415 <span class="comment">               Breakpoint commands for that stop were not run, since</span>
<a name="l04416"></a>04416 <span class="comment">               execute_command does not run breakpoint commands --</span>
<a name="l04417"></a>04417 <span class="comment">               only command_line_handler does, but that one is not</span>
<a name="l04418"></a>04418 <span class="comment">               involved in execution of breakpoint commands.  So, we</span>
<a name="l04419"></a>04419 <span class="comment">               can now execute breakpoint commands.  It should be</span>
<a name="l04420"></a>04420 <span class="comment">               noted that making execute_command do bpstat actions is</span>
<a name="l04421"></a>04421 <span class="comment">               not an option -- in this case we&#39;ll have recursive</span>
<a name="l04422"></a>04422 <span class="comment">               invocation of bpstat for each breakpoint with a</span>
<a name="l04423"></a>04423 <span class="comment">               command, and can easily blow up GDB stack.  Instead, we</span>
<a name="l04424"></a>04424 <span class="comment">               return true, which will trigger the caller to recall us</span>
<a name="l04425"></a>04425 <span class="comment">               with the new stop_bpstat.  */</span>
<a name="l04426"></a>04426             again = 1;
<a name="l04427"></a>04427           <span class="keywordflow">break</span>;
<a name="l04428"></a>04428         }
<a name="l04429"></a>04429     }
<a name="l04430"></a>04430   <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (old_chain);
<a name="l04431"></a>04431   <span class="keywordflow">return</span> again;
<a name="l04432"></a>04432 }
<a name="l04433"></a>04433 
<a name="l04434"></a>04434 <span class="keywordtype">void</span>
<a name="l04435"></a><a class="code" href="breakpoint_8h.html#a79945bcb0451d40f8a21f2d2c266e4d6">04435</a> <a class="code" href="breakpoint_8c.html#a79945bcb0451d40f8a21f2d2c266e4d6">bpstat_do_actions</a> (<span class="keywordtype">void</span>)
<a name="l04436"></a>04436 {
<a name="l04437"></a>04437   <span class="keyword">struct </span>cleanup *cleanup_if_error = <a class="code" href="utils_8c.html#aa4e904b8234e16309bb0d5c411502125">make_bpstat_clear_actions_cleanup</a> ();
<a name="l04438"></a>04438 
<a name="l04439"></a>04439   <span class="comment">/* Do any commands attached to breakpoint we are stopped at.  */</span>
<a name="l04440"></a>04440   <span class="keywordflow">while</span> (!<a class="code" href="ptid_8c.html#a0df58c8db2620a2cec647934b4f77266">ptid_equal</a> (<a class="code" href="infcmd_8c.html#a428c5be9ce5e70bd03760e828e19c6b7">inferior_ptid</a>, <a class="code" href="ptid_8c.html#acba69c857786546b204883bbcc90a64e">null_ptid</a>)
<a name="l04441"></a>04441          &amp;&amp; <a class="code" href="target_8h.html#a85885df22f7c1304269eaba1e1d618b7">target_has_execution</a>
<a name="l04442"></a>04442          &amp;&amp; !<a class="code" href="gdbthread_8h.html#a4b919e1603e4636f9bc421f4a89c1d5d">is_exited</a> (<a class="code" href="infcmd_8c.html#a428c5be9ce5e70bd03760e828e19c6b7">inferior_ptid</a>)
<a name="l04443"></a>04443          &amp;&amp; !<a class="code" href="gdbthread_8h.html#a9cb93190294c3de16f2bb6aebc5238e4">is_executing</a> (<a class="code" href="infcmd_8c.html#a428c5be9ce5e70bd03760e828e19c6b7">inferior_ptid</a>))
<a name="l04444"></a>04444     <span class="comment">/* Since in sync mode, bpstat_do_actions may resume the inferior,</span>
<a name="l04445"></a>04445 <span class="comment">       and only return when it is stopped at the next breakpoint, we</span>
<a name="l04446"></a>04446 <span class="comment">       keep doing breakpoint actions until it returns false to</span>
<a name="l04447"></a>04447 <span class="comment">       indicate the inferior was not resumed.  */</span>
<a name="l04448"></a>04448     <span class="keywordflow">if</span> (!bpstat_do_actions_1 (&amp;<a class="code" href="gdbthread_8h.html#a668af1dd99cac24599dc0f3ef6458924">inferior_thread</a> ()-&gt;control.stop_bpstat))
<a name="l04449"></a>04449       <span class="keywordflow">break</span>;
<a name="l04450"></a>04450 
<a name="l04451"></a>04451   <a class="code" href="cleanups_8c.html#a5ec3987bf995edcc44def9e17ada6eba">discard_cleanups</a> (cleanup_if_error);
<a name="l04452"></a>04452 }
<a name="l04453"></a>04453 
<a name="l04454"></a>04454 <span class="comment">/* Print out the (old or new) value associated with a watchpoint.  */</span>
<a name="l04455"></a>04455 
<a name="l04456"></a>04456 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l04457"></a>04457 watchpoint_value_print (<span class="keyword">struct</span> value *val, <span class="keyword">struct</span> ui_file *stream)
<a name="l04458"></a>04458 {
<a name="l04459"></a>04459   <span class="keywordflow">if</span> (val == NULL)
<a name="l04460"></a>04460     <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (stream, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;&lt;unreadable&gt;&quot;</span>));
<a name="l04461"></a>04461   <span class="keywordflow">else</span>
<a name="l04462"></a>04462     {
<a name="l04463"></a>04463       <span class="keyword">struct </span><a class="code" href="structvalue__print__options.html">value_print_options</a> opts;
<a name="l04464"></a>04464       <a class="code" href="valprint_8c.html#aa2d4dfe4b11841ccafc4d0c0d410095d">get_user_print_options</a> (&amp;opts);
<a name="l04465"></a>04465       <a class="code" href="valprint_8c.html#a1e41c7430a7b838beec1717ced3e9d94">value_print</a> (val, stream, &amp;opts);
<a name="l04466"></a>04466     }
<a name="l04467"></a>04467 }
<a name="l04468"></a>04468 
<a name="l04469"></a>04469 <span class="comment">/* Generic routine for printing messages indicating why we</span>
<a name="l04470"></a>04470 <span class="comment">   stopped.  The behavior of this function depends on the value</span>
<a name="l04471"></a>04471 <span class="comment">   &#39;print_it&#39; in the bpstat structure.  Under some circumstances we</span>
<a name="l04472"></a>04472 <span class="comment">   may decide not to print anything here and delegate the task to</span>
<a name="l04473"></a>04473 <span class="comment">   normal_stop().  */</span>
<a name="l04474"></a>04474 
<a name="l04475"></a>04475 <span class="keyword">static</span> <span class="keyword">enum</span> <a class="code" href="breakpoint_8h.html#ab6ab1d6a867561653e32a901b41be66b">print_stop_action</a>
<a name="l04476"></a>04476 print_bp_stop_message (<a class="code" href="structbpstats.html">bpstat</a> bs)
<a name="l04477"></a>04477 {
<a name="l04478"></a>04478   <span class="keywordflow">switch</span> (bs-&gt;<a class="code" href="structbpstats.html#aa7d7990c1285ae7d002f1ab22aa5cf1c">print_it</a>)
<a name="l04479"></a>04479     {
<a name="l04480"></a>04480     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a3c71b66ef0df7811590693f77ca1c643ab105e1b64aa8f28dd69ccb8f1ed14c61">print_it_noop</a>:
<a name="l04481"></a>04481       <span class="comment">/* Nothing should be printed for this bpstat entry.  */</span>
<a name="l04482"></a>04482       <span class="keywordflow">return</span> <a class="code" href="breakpoint_8h.html#ab6ab1d6a867561653e32a901b41be66ba84f0c3d5c073b6e26479e7b2ae2c7df0">PRINT_UNKNOWN</a>;
<a name="l04483"></a>04483       <span class="keywordflow">break</span>;
<a name="l04484"></a>04484 
<a name="l04485"></a>04485     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a3c71b66ef0df7811590693f77ca1c643add30a20c45ddf585f9c6c15681986635">print_it_done</a>:
<a name="l04486"></a>04486       <span class="comment">/* We still want to print the frame, but we already printed the</span>
<a name="l04487"></a>04487 <span class="comment">         relevant messages.  */</span>
<a name="l04488"></a>04488       <span class="keywordflow">return</span> <a class="code" href="breakpoint_8h.html#ab6ab1d6a867561653e32a901b41be66ba322bad7b3370a43f44f33ae73a196231">PRINT_SRC_AND_LOC</a>;
<a name="l04489"></a>04489       <span class="keywordflow">break</span>;
<a name="l04490"></a>04490 
<a name="l04491"></a>04491     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a3c71b66ef0df7811590693f77ca1c643afb7fe5c57b7fc9128b85e41421f38416">print_it_normal</a>:
<a name="l04492"></a>04492       {
<a name="l04493"></a>04493         <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b = bs-&gt;<a class="code" href="structbpstats.html#ac105ed7263dd10f9d65e92e706b04e39">breakpoint_at</a>;
<a name="l04494"></a>04494 
<a name="l04495"></a>04495         <span class="comment">/* bs-&gt;breakpoint_at can be NULL if it was a momentary breakpoint</span>
<a name="l04496"></a>04496 <span class="comment">           which has since been deleted.  */</span>
<a name="l04497"></a>04497         <span class="keywordflow">if</span> (b == NULL)
<a name="l04498"></a>04498           <span class="keywordflow">return</span> <a class="code" href="breakpoint_8h.html#ab6ab1d6a867561653e32a901b41be66ba84f0c3d5c073b6e26479e7b2ae2c7df0">PRINT_UNKNOWN</a>;
<a name="l04499"></a>04499 
<a name="l04500"></a>04500         <span class="comment">/* Normal case.  Call the breakpoint&#39;s print_it method.  */</span>
<a name="l04501"></a>04501         <span class="keywordflow">return</span> b-&gt;<a class="code" href="structbreakpoint.html#aba258aa23496f6434aaa1cf8c8dc7ea7">ops</a>-&gt;<a class="code" href="structbreakpoint__ops.html#aa8d21fdff10f7839583383d6397fe6a0">print_it</a> (bs);
<a name="l04502"></a>04502       }
<a name="l04503"></a>04503       <span class="keywordflow">break</span>;
<a name="l04504"></a>04504 
<a name="l04505"></a>04505     <span class="keywordflow">default</span>:
<a name="l04506"></a>04506       <a class="code" href="common-utils_8h.html#aa14285d9d3d4171016ef9cf09447e8bb">internal_error</a> (__FILE__, __LINE__,
<a name="l04507"></a>04507                       <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;print_bp_stop_message: unrecognized enum value&quot;</span>));
<a name="l04508"></a>04508       <span class="keywordflow">break</span>;
<a name="l04509"></a>04509     }
<a name="l04510"></a>04510 }
<a name="l04511"></a>04511 
<a name="l04512"></a>04512 <span class="comment">/* A helper function that prints a shared library stopped event.  */</span>
<a name="l04513"></a>04513 
<a name="l04514"></a>04514 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l04515"></a>04515 print_solib_event (<span class="keywordtype">int</span> <a class="code" href="breakpoint_8c.html#acc3e8e9fba058800f42671adebbfa950">is_catchpoint</a>)
<a name="l04516"></a>04516 {
<a name="l04517"></a>04517   <span class="keywordtype">int</span> any_deleted
<a name="l04518"></a>04518     = !<a class="code" href="vec_8h.html#ac9981d313a5e114db0e05b7b9cd16319">VEC_empty</a> (<a class="code" href="gdb__vecs_8h.html#a5ea7d3fefa2144d9bddaf2053c9691a1">char_ptr</a>, <a class="code" href="progspace_8c.html#a07722ff15a98814c086dda44f93380c9">current_program_space</a>-&gt;deleted_solibs);
<a name="l04519"></a>04519   <span class="keywordtype">int</span> any_added
<a name="l04520"></a>04520     = !<a class="code" href="vec_8h.html#ac9981d313a5e114db0e05b7b9cd16319">VEC_empty</a> (<a class="code" href="structso__list.html">so_list_ptr</a>, <a class="code" href="progspace_8c.html#a07722ff15a98814c086dda44f93380c9">current_program_space</a>-&gt;added_solibs);
<a name="l04521"></a>04521 
<a name="l04522"></a>04522   <span class="keywordflow">if</span> (!is_catchpoint)
<a name="l04523"></a>04523     {
<a name="l04524"></a>04524       <span class="keywordflow">if</span> (any_added || any_deleted)
<a name="l04525"></a>04525         <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>,
<a name="l04526"></a>04526                      <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Stopped due to shared library event:\n&quot;</span>));
<a name="l04527"></a>04527       <span class="keywordflow">else</span>
<a name="l04528"></a>04528         <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>,
<a name="l04529"></a>04529                      <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Stopped due to shared library event (no &quot;</span>
<a name="l04530"></a>04530                        <span class="stringliteral">&quot;libraries added or removed)\n&quot;</span>));
<a name="l04531"></a>04531     }
<a name="l04532"></a>04532 
<a name="l04533"></a>04533   <span class="keywordflow">if</span> (<a class="code" href="ui-out_8c.html#a473db54efcfbc60feeb5a4f54f27af46">ui_out_is_mi_like_p</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>))
<a name="l04534"></a>04534     <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, <span class="stringliteral">&quot;reason&quot;</span>,
<a name="l04535"></a>04535                          <a class="code" href="mi-common_8c.html#a619e7d180d78af6e6d63a611c6680e90">async_reason_lookup</a> (<a class="code" href="mi-common_8h.html#a06d7bf56f98dcc556d686f49ea570daea87cd2b18abc0d74adb0e2366eda6bd17">EXEC_ASYNC_SOLIB_EVENT</a>));
<a name="l04536"></a>04536 
<a name="l04537"></a>04537   <span class="keywordflow">if</span> (any_deleted)
<a name="l04538"></a>04538     {
<a name="l04539"></a>04539       <span class="keyword">struct </span>cleanup *cleanup;
<a name="l04540"></a>04540       <span class="keywordtype">char</span> *<a class="code" href="aarch64-tdep_8c.html#acc128f98d9ceca227038c771308eff39">name</a>;
<a name="l04541"></a>04541       <span class="keywordtype">int</span> ix;
<a name="l04542"></a>04542 
<a name="l04543"></a>04543       <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;  Inferior unloaded &quot;</span>));
<a name="l04544"></a>04544       cleanup = <a class="code" href="ui-out_8c.html#aa6e8e9b18ba11e13617a6c56cbfab08f">make_cleanup_ui_out_list_begin_end</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>,
<a name="l04545"></a>04545                                                     <span class="stringliteral">&quot;removed&quot;</span>);
<a name="l04546"></a>04546       <span class="keywordflow">for</span> (ix = 0;
<a name="l04547"></a>04547            <a class="code" href="vec_8h.html#ae7795b0c8e65f45eb49aac5ec2c0fa52">VEC_iterate</a> (<a class="code" href="gdb__vecs_8h.html#a5ea7d3fefa2144d9bddaf2053c9691a1">char_ptr</a>, <a class="code" href="progspace_8c.html#a07722ff15a98814c086dda44f93380c9">current_program_space</a>-&gt;deleted_solibs,
<a name="l04548"></a>04548                         ix, name);
<a name="l04549"></a>04549            ++ix)
<a name="l04550"></a>04550         {
<a name="l04551"></a>04551           <span class="keywordflow">if</span> (ix &gt; 0)
<a name="l04552"></a>04552             <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, <span class="stringliteral">&quot;    &quot;</span>);
<a name="l04553"></a>04553           <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, <span class="stringliteral">&quot;library&quot;</span>, name);
<a name="l04554"></a>04554           <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, <span class="stringliteral">&quot;\n&quot;</span>);
<a name="l04555"></a>04555         }
<a name="l04556"></a>04556 
<a name="l04557"></a>04557       <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (cleanup);
<a name="l04558"></a>04558     }
<a name="l04559"></a>04559 
<a name="l04560"></a>04560   <span class="keywordflow">if</span> (any_added)
<a name="l04561"></a>04561     {
<a name="l04562"></a>04562       <span class="keyword">struct </span><a class="code" href="structso__list.html">so_list</a> *iter;
<a name="l04563"></a>04563       <span class="keywordtype">int</span> ix;
<a name="l04564"></a>04564       <span class="keyword">struct </span>cleanup *cleanup;
<a name="l04565"></a>04565 
<a name="l04566"></a>04566       <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;  Inferior loaded &quot;</span>));
<a name="l04567"></a>04567       cleanup = <a class="code" href="ui-out_8c.html#aa6e8e9b18ba11e13617a6c56cbfab08f">make_cleanup_ui_out_list_begin_end</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>,
<a name="l04568"></a>04568                                                     <span class="stringliteral">&quot;added&quot;</span>);
<a name="l04569"></a>04569       <span class="keywordflow">for</span> (ix = 0;
<a name="l04570"></a>04570            <a class="code" href="vec_8h.html#ae7795b0c8e65f45eb49aac5ec2c0fa52">VEC_iterate</a> (<a class="code" href="structso__list.html">so_list_ptr</a>, <a class="code" href="progspace_8c.html#a07722ff15a98814c086dda44f93380c9">current_program_space</a>-&gt;added_solibs,
<a name="l04571"></a>04571                         ix, iter);
<a name="l04572"></a>04572            ++ix)
<a name="l04573"></a>04573         {
<a name="l04574"></a>04574           <span class="keywordflow">if</span> (ix &gt; 0)
<a name="l04575"></a>04575             <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, <span class="stringliteral">&quot;    &quot;</span>);
<a name="l04576"></a>04576           <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, <span class="stringliteral">&quot;library&quot;</span>, iter-&gt;<a class="code" href="structso__list.html#a140beac8c60259f8debd88cd693b8fb4">so_name</a>);
<a name="l04577"></a>04577           <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, <span class="stringliteral">&quot;\n&quot;</span>);
<a name="l04578"></a>04578         }
<a name="l04579"></a>04579 
<a name="l04580"></a>04580       <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (cleanup);
<a name="l04581"></a>04581     }
<a name="l04582"></a>04582 }
<a name="l04583"></a>04583 
<a name="l04584"></a>04584 <span class="comment">/* Print a message indicating what happened.  This is called from</span>
<a name="l04585"></a>04585 <span class="comment">   normal_stop().  The input to this routine is the head of the bpstat</span>
<a name="l04586"></a>04586 <span class="comment">   list - a list of the eventpoints that caused this stop.  KIND is</span>
<a name="l04587"></a>04587 <span class="comment">   the target_waitkind for the stopping event.  This</span>
<a name="l04588"></a>04588 <span class="comment">   routine calls the generic print routine for printing a message</span>
<a name="l04589"></a>04589 <span class="comment">   about reasons for stopping.  This will print (for example) the</span>
<a name="l04590"></a>04590 <span class="comment">   &quot;Breakpoint n,&quot; part of the output.  The return value of this</span>
<a name="l04591"></a>04591 <span class="comment">   routine is one of:</span>
<a name="l04592"></a>04592 <span class="comment"></span>
<a name="l04593"></a>04593 <span class="comment">   PRINT_UNKNOWN: Means we printed nothing.</span>
<a name="l04594"></a>04594 <span class="comment">   PRINT_SRC_AND_LOC: Means we printed something, and expect subsequent</span>
<a name="l04595"></a>04595 <span class="comment">   code to print the location.  An example is </span>
<a name="l04596"></a>04596 <span class="comment">   &quot;Breakpoint 1, &quot; which should be followed by</span>
<a name="l04597"></a>04597 <span class="comment">   the location.</span>
<a name="l04598"></a>04598 <span class="comment">   PRINT_SRC_ONLY: Means we printed something, but there is no need</span>
<a name="l04599"></a>04599 <span class="comment">   to also print the location part of the message.</span>
<a name="l04600"></a>04600 <span class="comment">   An example is the catch/throw messages, which</span>
<a name="l04601"></a>04601 <span class="comment">   don&#39;t require a location appended to the end.</span>
<a name="l04602"></a>04602 <span class="comment">   PRINT_NOTHING: We have done some printing and we don&#39;t need any </span>
<a name="l04603"></a>04603 <span class="comment">   further info to be printed.  */</span>
<a name="l04604"></a>04604 
<a name="l04605"></a>04605 <span class="keyword">enum</span> <a class="code" href="breakpoint_8h.html#ab6ab1d6a867561653e32a901b41be66b">print_stop_action</a>
<a name="l04606"></a><a class="code" href="breakpoint_8h.html#a201b7f4900b3986195b366394c8fd34e">04606</a> <a class="code" href="breakpoint_8c.html#a1e1d6bc375a82c26b53ee3614ff3f4bf">bpstat_print</a> (<a class="code" href="structbpstats.html">bpstat</a> bs, <span class="keywordtype">int</span> kind)
<a name="l04607"></a>04607 {
<a name="l04608"></a>04608   <span class="keywordtype">int</span> val;
<a name="l04609"></a>04609 
<a name="l04610"></a>04610   <span class="comment">/* Maybe another breakpoint in the chain caused us to stop.</span>
<a name="l04611"></a>04611 <span class="comment">     (Currently all watchpoints go on the bpstat whether hit or not.</span>
<a name="l04612"></a>04612 <span class="comment">     That probably could (should) be changed, provided care is taken</span>
<a name="l04613"></a>04613 <span class="comment">     with respect to bpstat_explains_signal).  */</span>
<a name="l04614"></a>04614   <span class="keywordflow">for</span> (; bs; bs = bs-&gt;<a class="code" href="structbpstats.html#a48ed65e040defb4d45e1cea1a8414d6c">next</a>)
<a name="l04615"></a>04615     {
<a name="l04616"></a>04616       val = print_bp_stop_message (bs);
<a name="l04617"></a>04617       <span class="keywordflow">if</span> (val == <a class="code" href="breakpoint_8h.html#ab6ab1d6a867561653e32a901b41be66baf5c1d9187c548320f8e21fc06578c2ab">PRINT_SRC_ONLY</a> 
<a name="l04618"></a>04618           || val == <a class="code" href="breakpoint_8h.html#ab6ab1d6a867561653e32a901b41be66ba322bad7b3370a43f44f33ae73a196231">PRINT_SRC_AND_LOC</a> 
<a name="l04619"></a>04619           || val == <a class="code" href="breakpoint_8h.html#ab6ab1d6a867561653e32a901b41be66ba7a9d478397b9193cdbdce184d31446d4">PRINT_NOTHING</a>)
<a name="l04620"></a>04620         <span class="keywordflow">return</span> val;
<a name="l04621"></a>04621     }
<a name="l04622"></a>04622 
<a name="l04623"></a>04623   <span class="comment">/* If we had hit a shared library event breakpoint,</span>
<a name="l04624"></a>04624 <span class="comment">     print_bp_stop_message would print out this message.  If we hit an</span>
<a name="l04625"></a>04625 <span class="comment">     OS-level shared library event, do the same thing.  */</span>
<a name="l04626"></a>04626   <span class="keywordflow">if</span> (kind == <a class="code" href="waitstatus_8h.html#aa3229b489ec985f04f7e9f652138b7c3a6628f2c3117782406e2eeb38c4067002">TARGET_WAITKIND_LOADED</a>)
<a name="l04627"></a>04627     {
<a name="l04628"></a>04628       print_solib_event (0);
<a name="l04629"></a>04629       <span class="keywordflow">return</span> <a class="code" href="breakpoint_8h.html#ab6ab1d6a867561653e32a901b41be66ba7a9d478397b9193cdbdce184d31446d4">PRINT_NOTHING</a>;
<a name="l04630"></a>04630     }
<a name="l04631"></a>04631 
<a name="l04632"></a>04632   <span class="comment">/* We reached the end of the chain, or we got a null BS to start</span>
<a name="l04633"></a>04633 <span class="comment">     with and nothing was printed.  */</span>
<a name="l04634"></a>04634   <span class="keywordflow">return</span> <a class="code" href="breakpoint_8h.html#ab6ab1d6a867561653e32a901b41be66ba84f0c3d5c073b6e26479e7b2ae2c7df0">PRINT_UNKNOWN</a>;
<a name="l04635"></a>04635 }
<a name="l04636"></a>04636 
<a name="l04637"></a>04637 <span class="comment">/* Evaluate the expression EXP and return 1 if value is zero.  This is</span>
<a name="l04638"></a>04638 <span class="comment">   used inside a catch_errors to evaluate the breakpoint condition.</span>
<a name="l04639"></a>04639 <span class="comment">   The argument is a &quot;struct expression *&quot; that has been cast to a</span>
<a name="l04640"></a>04640 <span class="comment">   &quot;char *&quot; to make it pass through catch_errors.  */</span>
<a name="l04641"></a>04641 
<a name="l04642"></a>04642 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l04643"></a>04643 breakpoint_cond_eval (<span class="keywordtype">void</span> *exp)
<a name="l04644"></a>04644 {
<a name="l04645"></a>04645   <span class="keyword">struct </span>value *mark = <a class="code" href="value_8c.html#a427a12b0dd4d5663b103d29f07a0e1c6">value_mark</a> ();
<a name="l04646"></a>04646   <span class="keywordtype">int</span> i = !<a class="code" href="language_8c.html#ac4c03bad1fa69801b9ca23e550fe2e2c">value_true</a> (<a class="code" href="eval_8c.html#ab50151ccba3ea3184c114121d6bed422">evaluate_expression</a> ((<span class="keyword">struct</span> <a class="code" href="structexpression.html">expression</a> *) exp));
<a name="l04647"></a>04647 
<a name="l04648"></a>04648   <a class="code" href="value_8c.html#a10aad9b72e08c5e90e3051156fa83318">value_free_to_mark</a> (mark);
<a name="l04649"></a>04649   <span class="keywordflow">return</span> i;
<a name="l04650"></a>04650 }
<a name="l04651"></a>04651 
<a name="l04652"></a>04652 <span class="comment">/* Allocate a new bpstat.  Link it to the FIFO list by BS_LINK_POINTER.  */</span>
<a name="l04653"></a>04653 
<a name="l04654"></a>04654 <span class="keyword">static</span> <a class="code" href="structbpstats.html">bpstat</a>
<a name="l04655"></a>04655 bpstat_alloc (<span class="keyword">struct</span> bp_location *bl, <a class="code" href="structbpstats.html">bpstat</a> **bs_link_pointer)
<a name="l04656"></a>04656 {
<a name="l04657"></a>04657   <a class="code" href="structbpstats.html">bpstat</a> bs;
<a name="l04658"></a>04658 
<a name="l04659"></a>04659   bs = (<a class="code" href="breakpoint_8h.html#a133118f2ec2fad53196153b5b47e57dd">bpstat</a>) <a class="code" href="common-utils_8c.html#a634d6cd850bb831afebc499579303b3b">xmalloc</a> (<span class="keyword">sizeof</span> (*bs));
<a name="l04660"></a>04660   bs-&gt;<a class="code" href="structbpstats.html#a48ed65e040defb4d45e1cea1a8414d6c">next</a> = NULL;
<a name="l04661"></a>04661   **bs_link_pointer = bs;
<a name="l04662"></a>04662   *bs_link_pointer = &amp;bs-&gt;<a class="code" href="structbpstats.html#a48ed65e040defb4d45e1cea1a8414d6c">next</a>;
<a name="l04663"></a>04663   bs-&gt;<a class="code" href="structbpstats.html#ac105ed7263dd10f9d65e92e706b04e39">breakpoint_at</a> = bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>;
<a name="l04664"></a>04664   bs-&gt;<a class="code" href="structbpstats.html#a510428e7ce2e4852e0613b3b5579142b">bp_location_at</a> = bl;
<a name="l04665"></a>04665   incref_bp_location (bl);
<a name="l04666"></a>04666   <span class="comment">/* If the condition is false, etc., don&#39;t do the commands.  */</span>
<a name="l04667"></a>04667   bs-&gt;<a class="code" href="structbpstats.html#a2c06ba2ce8217014988be902dc5228a4">commands</a> = NULL;
<a name="l04668"></a>04668   bs-&gt;<a class="code" href="structbpstats.html#aa68c6ad7e88a1d21640560008a44c287">old_val</a> = NULL;
<a name="l04669"></a>04669   bs-&gt;<a class="code" href="structbpstats.html#aa7d7990c1285ae7d002f1ab22aa5cf1c">print_it</a> = <a class="code" href="breakpoint_8h.html#a3c71b66ef0df7811590693f77ca1c643afb7fe5c57b7fc9128b85e41421f38416">print_it_normal</a>;
<a name="l04670"></a>04670   <span class="keywordflow">return</span> bs;
<a name="l04671"></a>04671 }
<a name="l04672"></a>04672 
<a name="l04673"></a>04673 <span class="comment">/* The target has stopped with waitstatus WS.  Check if any hardware</span>
<a name="l04674"></a>04674 <span class="comment">   watchpoints have triggered, according to the target.  */</span>
<a name="l04675"></a>04675 
<a name="l04676"></a>04676 <span class="keywordtype">int</span>
<a name="l04677"></a><a class="code" href="breakpoint_8h.html#a0d8e14a49cdbeaf0151918df007bd6bd">04677</a> <a class="code" href="breakpoint_8c.html#aea88604ac16ebaa2358a3c23994b5572">watchpoints_triggered</a> (<span class="keyword">struct</span> <a class="code" href="structtarget__waitstatus.html">target_waitstatus</a> *ws)
<a name="l04678"></a>04678 {
<a name="l04679"></a>04679   <span class="keywordtype">int</span> stopped_by_watchpoint = <a class="code" href="target_8h.html#a11018e2c860bb03c890cce86024a9823">target_stopped_by_watchpoint</a> ();
<a name="l04680"></a>04680   <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> addr;
<a name="l04681"></a>04681   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b;
<a name="l04682"></a>04682 
<a name="l04683"></a>04683   <span class="keywordflow">if</span> (!stopped_by_watchpoint)
<a name="l04684"></a>04684     {
<a name="l04685"></a>04685       <span class="comment">/* We were not stopped by a watchpoint.  Mark all watchpoints</span>
<a name="l04686"></a>04686 <span class="comment">         as not triggered.  */</span>
<a name="l04687"></a>04687       <a class="code" href="breakpoint_8c.html#a781d5d3dc50a92364edfbacac3d0c107">ALL_BREAKPOINTS</a> (b)
<a name="l04688"></a>04688         <span class="keywordflow">if</span> (is_hardware_watchpoint (b))
<a name="l04689"></a>04689           {
<a name="l04690"></a>04690             <span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *w = (<span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *) b;
<a name="l04691"></a>04691 
<a name="l04692"></a>04692             w-&gt;<a class="code" href="structwatchpoint.html#ad73d8e3d495e46d149b23a36b225daba">watchpoint_triggered</a> = <a class="code" href="breakpoint_8h.html#aee5eff1f9c0902dcf85bf1a18c2a1bdea0fd19712ffeb3d885b686c77b7d49b7f">watch_triggered_no</a>;
<a name="l04693"></a>04693           }
<a name="l04694"></a>04694 
<a name="l04695"></a>04695       <span class="keywordflow">return</span> 0;
<a name="l04696"></a>04696     }
<a name="l04697"></a>04697 
<a name="l04698"></a>04698   <span class="keywordflow">if</span> (!<a class="code" href="target_8h.html#a05417aa04fe57e215fb1b5fdc87f92fa">target_stopped_data_address</a> (&amp;<a class="code" href="target_8h.html#a2d8640b030266b58d3821eb5cfd112b9">current_target</a>, &amp;addr))
<a name="l04699"></a>04699     {
<a name="l04700"></a>04700       <span class="comment">/* We were stopped by a watchpoint, but we don&#39;t know where.</span>
<a name="l04701"></a>04701 <span class="comment">         Mark all watchpoints as unknown.  */</span>
<a name="l04702"></a>04702       <a class="code" href="breakpoint_8c.html#a781d5d3dc50a92364edfbacac3d0c107">ALL_BREAKPOINTS</a> (b)
<a name="l04703"></a>04703         <span class="keywordflow">if</span> (is_hardware_watchpoint (b))
<a name="l04704"></a>04704           {
<a name="l04705"></a>04705             <span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *w = (<span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *) b;
<a name="l04706"></a>04706 
<a name="l04707"></a>04707             w-&gt;<a class="code" href="structwatchpoint.html#ad73d8e3d495e46d149b23a36b225daba">watchpoint_triggered</a> = <a class="code" href="breakpoint_8h.html#aee5eff1f9c0902dcf85bf1a18c2a1bdea4e5cedd852c5c38b527d86e42621cdbe">watch_triggered_unknown</a>;
<a name="l04708"></a>04708           }
<a name="l04709"></a>04709 
<a name="l04710"></a>04710       <span class="keywordflow">return</span> stopped_by_watchpoint;
<a name="l04711"></a>04711     }
<a name="l04712"></a>04712 
<a name="l04713"></a>04713   <span class="comment">/* The target could report the data address.  Mark watchpoints</span>
<a name="l04714"></a>04714 <span class="comment">     affected by this data address as triggered, and all others as not</span>
<a name="l04715"></a>04715 <span class="comment">     triggered.  */</span>
<a name="l04716"></a>04716 
<a name="l04717"></a>04717   <a class="code" href="breakpoint_8c.html#a781d5d3dc50a92364edfbacac3d0c107">ALL_BREAKPOINTS</a> (b)
<a name="l04718"></a>04718     <span class="keywordflow">if</span> (is_hardware_watchpoint (b))
<a name="l04719"></a>04719       {
<a name="l04720"></a>04720         <span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *w = (<span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *) b;
<a name="l04721"></a>04721         <span class="keyword">struct </span>bp_location *loc;
<a name="l04722"></a>04722 
<a name="l04723"></a>04723         w-&gt;<a class="code" href="structwatchpoint.html#ad73d8e3d495e46d149b23a36b225daba">watchpoint_triggered</a> = <a class="code" href="breakpoint_8h.html#aee5eff1f9c0902dcf85bf1a18c2a1bdea0fd19712ffeb3d885b686c77b7d49b7f">watch_triggered_no</a>;
<a name="l04724"></a>04724         <span class="keywordflow">for</span> (loc = b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>; loc; loc = loc-&gt;<a class="code" href="structbp__location.html#ab193cb38f87fea89105db96d94191541">next</a>)
<a name="l04725"></a>04725           {
<a name="l04726"></a>04726             <span class="keywordflow">if</span> (is_masked_watchpoint (b))
<a name="l04727"></a>04727               {
<a name="l04728"></a>04728                 <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> newaddr = addr &amp; w-&gt;<a class="code" href="structwatchpoint.html#a8d9efbe7ba574b6af52dec3d99ab28a3">hw_wp_mask</a>;
<a name="l04729"></a>04729                 <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> start = loc-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a> &amp; w-&gt;<a class="code" href="structwatchpoint.html#a8d9efbe7ba574b6af52dec3d99ab28a3">hw_wp_mask</a>;
<a name="l04730"></a>04730 
<a name="l04731"></a>04731                 <span class="keywordflow">if</span> (newaddr == start)
<a name="l04732"></a>04732                   {
<a name="l04733"></a>04733                     w-&gt;<a class="code" href="structwatchpoint.html#ad73d8e3d495e46d149b23a36b225daba">watchpoint_triggered</a> = <a class="code" href="breakpoint_8h.html#aee5eff1f9c0902dcf85bf1a18c2a1bdeaaa456969ebe18c987a8159fc613d1e21">watch_triggered_yes</a>;
<a name="l04734"></a>04734                     <span class="keywordflow">break</span>;
<a name="l04735"></a>04735                   }
<a name="l04736"></a>04736               }
<a name="l04737"></a>04737             <span class="comment">/* Exact match not required.  Within range is sufficient.  */</span>
<a name="l04738"></a>04738             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="target_8h.html#ac7234bfc83cdfd95e29ce2fb3462ead3">target_watchpoint_addr_within_range</a> (&amp;<a class="code" href="target_8h.html#a2d8640b030266b58d3821eb5cfd112b9">current_target</a>,
<a name="l04739"></a>04739                                                          addr, loc-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>,
<a name="l04740"></a>04740                                                          loc-&gt;<a class="code" href="structbp__location.html#a3d4ad6914964554ca761607f9e8fab62">length</a>))
<a name="l04741"></a>04741               {
<a name="l04742"></a>04742                 w-&gt;<a class="code" href="structwatchpoint.html#ad73d8e3d495e46d149b23a36b225daba">watchpoint_triggered</a> = <a class="code" href="breakpoint_8h.html#aee5eff1f9c0902dcf85bf1a18c2a1bdeaaa456969ebe18c987a8159fc613d1e21">watch_triggered_yes</a>;
<a name="l04743"></a>04743                 <span class="keywordflow">break</span>;
<a name="l04744"></a>04744               }
<a name="l04745"></a>04745           }
<a name="l04746"></a>04746       }
<a name="l04747"></a>04747 
<a name="l04748"></a>04748   <span class="keywordflow">return</span> 1;
<a name="l04749"></a>04749 }
<a name="l04750"></a>04750 
<a name="l04751"></a>04751 <span class="comment">/* Possible return values for watchpoint_check (this can&#39;t be an enum</span>
<a name="l04752"></a>04752 <span class="comment">   because of check_errors).  */</span>
<a name="l04753"></a>04753 <span class="comment">/* The watchpoint has been deleted.  */</span>
<a name="l04754"></a><a class="code" href="breakpoint_8c.html#a29b7b16728e24b4495694b687f11fe5d">04754</a> <span class="preprocessor">#define WP_DELETED 1</span>
<a name="l04755"></a>04755 <span class="preprocessor"></span><span class="comment">/* The value has changed.  */</span>
<a name="l04756"></a><a class="code" href="breakpoint_8c.html#a1d8449f786bd1bdff7c4e545cb997734">04756</a> <span class="preprocessor">#define WP_VALUE_CHANGED 2</span>
<a name="l04757"></a>04757 <span class="preprocessor"></span><span class="comment">/* The value has not changed.  */</span>
<a name="l04758"></a><a class="code" href="breakpoint_8c.html#ae36c32e2b38502ff199be11f92109a57">04758</a> <span class="preprocessor">#define WP_VALUE_NOT_CHANGED 3</span>
<a name="l04759"></a>04759 <span class="preprocessor"></span><span class="comment">/* Ignore this watchpoint, no matter if the value changed or not.  */</span>
<a name="l04760"></a><a class="code" href="breakpoint_8c.html#a0bc4dd62242a0560eb112bd82bac8ec5">04760</a> <span class="preprocessor">#define WP_IGNORE 4</span>
<a name="l04761"></a>04761 <span class="preprocessor"></span>
<a name="l04762"></a><a class="code" href="breakpoint_8c.html#a05d955ad3bcf2b3f6206038725b58057">04762</a> <span class="preprocessor">#define BP_TEMPFLAG 1</span>
<a name="l04763"></a><a class="code" href="breakpoint_8c.html#a2f40dc2b6e0bcf2bfbd0ce7553849889">04763</a> <span class="preprocessor"></span><span class="preprocessor">#define BP_HARDWAREFLAG 2</span>
<a name="l04764"></a>04764 <span class="preprocessor"></span>
<a name="l04765"></a>04765 <span class="comment">/* Evaluate watchpoint condition expression and check if its value</span>
<a name="l04766"></a>04766 <span class="comment">   changed.</span>
<a name="l04767"></a>04767 <span class="comment"></span>
<a name="l04768"></a>04768 <span class="comment">   P should be a pointer to struct bpstat, but is defined as a void *</span>
<a name="l04769"></a>04769 <span class="comment">   in order for this function to be usable with catch_errors.  */</span>
<a name="l04770"></a>04770 
<a name="l04771"></a>04771 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l04772"></a>04772 watchpoint_check (<span class="keywordtype">void</span> *p)
<a name="l04773"></a>04773 {
<a name="l04774"></a>04774   <a class="code" href="structbpstats.html">bpstat</a> bs = (<a class="code" href="breakpoint_8h.html#a133118f2ec2fad53196153b5b47e57dd">bpstat</a>) p;
<a name="l04775"></a>04775   <span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *b;
<a name="l04776"></a>04776   <span class="keyword">struct </span>frame_info *fr;
<a name="l04777"></a>04777   <span class="keywordtype">int</span> within_current_scope;
<a name="l04778"></a>04778 
<a name="l04779"></a>04779   <span class="comment">/* BS is built from an existing struct breakpoint.  */</span>
<a name="l04780"></a>04780   <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (bs-&gt;<a class="code" href="structbpstats.html#ac105ed7263dd10f9d65e92e706b04e39">breakpoint_at</a> != NULL);
<a name="l04781"></a>04781   b = (<span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *) bs-&gt;<a class="code" href="structbpstats.html#ac105ed7263dd10f9d65e92e706b04e39">breakpoint_at</a>;
<a name="l04782"></a>04782 
<a name="l04783"></a>04783   <span class="comment">/* If this is a local watchpoint, we only want to check if the</span>
<a name="l04784"></a>04784 <span class="comment">     watchpoint frame is in scope if the current thread is the thread</span>
<a name="l04785"></a>04785 <span class="comment">     that was used to create the watchpoint.  */</span>
<a name="l04786"></a>04786   if (!watchpoint_in_thread_scope (b))
<a name="l04787"></a>04787     <span class="keywordflow">return</span> <a class="code" href="breakpoint_8c.html#a0bc4dd62242a0560eb112bd82bac8ec5">WP_IGNORE</a>;
<a name="l04788"></a>04788 
<a name="l04789"></a>04789   <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structwatchpoint.html#ab553c881e6ca32b9ae05bf9baee18c63">exp_valid_block</a> == NULL)
<a name="l04790"></a>04790     within_current_scope = 1;
<a name="l04791"></a>04791   <span class="keywordflow">else</span>
<a name="l04792"></a>04792     {
<a name="l04793"></a>04793       <span class="keyword">struct </span>frame_info *frame = <a class="code" href="frame_8c.html#a5ab254510728049878a232ed1b889820">get_current_frame</a> ();
<a name="l04794"></a>04794       <span class="keyword">struct </span>gdbarch *frame_arch = <a class="code" href="frame_8c.html#ab44507b5655da44e522ed5857835ede7">get_frame_arch</a> (frame);
<a name="l04795"></a>04795       <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> frame_pc = <a class="code" href="frame_8c.html#a27aafb00e05cba145dfba0e4bc7b1d70">get_frame_pc</a> (frame);
<a name="l04796"></a>04796 
<a name="l04797"></a>04797       <span class="comment">/* in_function_epilogue_p() returns a non-zero value if we&#39;re</span>
<a name="l04798"></a>04798 <span class="comment">         still in the function but the stack frame has already been</span>
<a name="l04799"></a>04799 <span class="comment">         invalidated.  Since we can&#39;t rely on the values of local</span>
<a name="l04800"></a>04800 <span class="comment">         variables after the stack has been destroyed, we are treating</span>
<a name="l04801"></a>04801 <span class="comment">         the watchpoint in that state as `not changed&#39; without further</span>
<a name="l04802"></a>04802 <span class="comment">         checking.  Don&#39;t mark watchpoints as changed if the current</span>
<a name="l04803"></a>04803 <span class="comment">         frame is in an epilogue - even if they are in some other</span>
<a name="l04804"></a>04804 <span class="comment">         frame, our view of the stack is likely to be wrong and</span>
<a name="l04805"></a>04805 <span class="comment">         frame_find_by_id could error out.  */</span>
<a name="l04806"></a>04806       <span class="keywordflow">if</span> (<a class="code" href="gdbarch_8c.html#a294342b0ab88e8ff11e0628d23e2d444">gdbarch_in_function_epilogue_p</a> (frame_arch, frame_pc))
<a name="l04807"></a>04807         <span class="keywordflow">return</span> <a class="code" href="breakpoint_8c.html#a0bc4dd62242a0560eb112bd82bac8ec5">WP_IGNORE</a>;
<a name="l04808"></a>04808 
<a name="l04809"></a>04809       fr = <a class="code" href="frame_8c.html#a09616280d1811c8f06c46e26a8e07960">frame_find_by_id</a> (b-&gt;<a class="code" href="structwatchpoint.html#a4be20e56c1fa9de45dece05f164c1060">watchpoint_frame</a>);
<a name="l04810"></a>04810       within_current_scope = (fr != NULL);
<a name="l04811"></a>04811 
<a name="l04812"></a>04812       <span class="comment">/* If we&#39;ve gotten confused in the unwinder, we might have</span>
<a name="l04813"></a>04813 <span class="comment">         returned a frame that can&#39;t describe this variable.  */</span>
<a name="l04814"></a>04814       <span class="keywordflow">if</span> (within_current_scope)
<a name="l04815"></a>04815         {
<a name="l04816"></a>04816           <span class="keyword">struct </span><a class="code" href="structsymbol.html">symbol</a> *<span class="keyword">function</span>;
<a name="l04817"></a>04817 
<a name="l04818"></a>04818           <span class="keyword">function</span> = <a class="code" href="blockframe_8c.html#a901685553101d7f605ab9f3d7d328cd6">get_frame_function</a> (fr);
<a name="l04819"></a>04819           <span class="keywordflow">if</span> (<span class="keyword">function</span> == NULL
<a name="l04820"></a>04820               || !<a class="code" href="block_8c.html#a24329baf96c81f9fa59a469df0a1b018">contained_in</a> (b-&gt;<a class="code" href="structwatchpoint.html#ab553c881e6ca32b9ae05bf9baee18c63">exp_valid_block</a>,
<a name="l04821"></a>04821                                 <a class="code" href="symtab_8h.html#a2c83ea82b28e9a9d8f9b655c2d502593">SYMBOL_BLOCK_VALUE</a> (<span class="keyword">function</span>)))
<a name="l04822"></a>04822             within_current_scope = 0;
<a name="l04823"></a>04823         }
<a name="l04824"></a>04824 
<a name="l04825"></a>04825       <span class="keywordflow">if</span> (within_current_scope)
<a name="l04826"></a>04826         <span class="comment">/* If we end up stopping, the current frame will get selected</span>
<a name="l04827"></a>04827 <span class="comment">           in normal_stop.  So this call to select_frame won&#39;t affect</span>
<a name="l04828"></a>04828 <span class="comment">           the user.  */</span>
<a name="l04829"></a>04829         <a class="code" href="frame_8c.html#a400fa273ac86863322cdc65683ef2356">select_frame</a> (fr);
<a name="l04830"></a>04830     }
<a name="l04831"></a>04831 
<a name="l04832"></a>04832   <span class="keywordflow">if</span> (within_current_scope)
<a name="l04833"></a>04833     {
<a name="l04834"></a>04834       <span class="comment">/* We use value_{,free_to_}mark because it could be a *long*</span>
<a name="l04835"></a>04835 <span class="comment">         time before we return to the command level and call</span>
<a name="l04836"></a>04836 <span class="comment">         free_all_values.  We can&#39;t call free_all_values because we</span>
<a name="l04837"></a>04837 <span class="comment">         might be in the middle of evaluating a function call.  */</span>
<a name="l04838"></a>04838 
<a name="l04839"></a>04839       <span class="keywordtype">int</span> pc = 0;
<a name="l04840"></a>04840       <span class="keyword">struct </span>value *mark;
<a name="l04841"></a>04841       <span class="keyword">struct </span>value *new_val;
<a name="l04842"></a>04842 
<a name="l04843"></a>04843       <span class="keywordflow">if</span> (is_masked_watchpoint (&amp;b-&gt;<a class="code" href="structwatchpoint.html#a01b7a13518becdd7631c9d701b70cbd1">base</a>))
<a name="l04844"></a>04844         <span class="comment">/* Since we don&#39;t know the exact trigger address (from</span>
<a name="l04845"></a>04845 <span class="comment">           stopped_data_address), just tell the user we&#39;ve triggered</span>
<a name="l04846"></a>04846 <span class="comment">           a mask watchpoint.  */</span>
<a name="l04847"></a>04847         <span class="keywordflow">return</span> <a class="code" href="breakpoint_8c.html#a1d8449f786bd1bdff7c4e545cb997734">WP_VALUE_CHANGED</a>;
<a name="l04848"></a>04848 
<a name="l04849"></a>04849       mark = <a class="code" href="value_8c.html#a427a12b0dd4d5663b103d29f07a0e1c6">value_mark</a> ();
<a name="l04850"></a>04850       <a class="code" href="eval_8c.html#a0f904e0082858aca1865f842481e67b3">fetch_subexp_value</a> (b-&gt;<a class="code" href="structwatchpoint.html#a10a51823c12ea43c95d767fb3a65d982">exp</a>, &amp;pc, &amp;new_val, NULL, NULL, 0);
<a name="l04851"></a>04851 
<a name="l04852"></a>04852       <span class="comment">/* We use value_equal_contents instead of value_equal because</span>
<a name="l04853"></a>04853 <span class="comment">         the latter coerces an array to a pointer, thus comparing just</span>
<a name="l04854"></a>04854 <span class="comment">         the address of the array instead of its contents.  This is</span>
<a name="l04855"></a>04855 <span class="comment">         not what we want.  */</span>
<a name="l04856"></a>04856       <span class="keywordflow">if</span> ((b-&gt;<a class="code" href="structwatchpoint.html#afafe9b6d8ed19e6c10764499cb35a7d1">val</a> != NULL) != (new_val != NULL)
<a name="l04857"></a>04857           || (b-&gt;<a class="code" href="structwatchpoint.html#afafe9b6d8ed19e6c10764499cb35a7d1">val</a> != NULL &amp;&amp; !<a class="code" href="valarith_8c.html#a16c7db8dfc3b458b56d393b14aa92816">value_equal_contents</a> (b-&gt;<a class="code" href="structwatchpoint.html#afafe9b6d8ed19e6c10764499cb35a7d1">val</a>, new_val)))
<a name="l04858"></a>04858         {
<a name="l04859"></a>04859           <span class="keywordflow">if</span> (new_val != NULL)
<a name="l04860"></a>04860             {
<a name="l04861"></a>04861               <a class="code" href="value_8c.html#a5a9662fcdbefec2edef0b912ba593914">release_value</a> (new_val);
<a name="l04862"></a>04862               <a class="code" href="value_8c.html#a10aad9b72e08c5e90e3051156fa83318">value_free_to_mark</a> (mark);
<a name="l04863"></a>04863             }
<a name="l04864"></a>04864           bs-&gt;<a class="code" href="structbpstats.html#aa68c6ad7e88a1d21640560008a44c287">old_val</a> = b-&gt;<a class="code" href="structwatchpoint.html#afafe9b6d8ed19e6c10764499cb35a7d1">val</a>;
<a name="l04865"></a>04865           b-&gt;<a class="code" href="structwatchpoint.html#afafe9b6d8ed19e6c10764499cb35a7d1">val</a> = new_val;
<a name="l04866"></a>04866           b-&gt;<a class="code" href="structwatchpoint.html#ab2e6ea6495c9663c86652b00af5bea1d">val_valid</a> = 1;
<a name="l04867"></a>04867           <span class="keywordflow">return</span> <a class="code" href="breakpoint_8c.html#a1d8449f786bd1bdff7c4e545cb997734">WP_VALUE_CHANGED</a>;
<a name="l04868"></a>04868         }
<a name="l04869"></a>04869       <span class="keywordflow">else</span>
<a name="l04870"></a>04870         {
<a name="l04871"></a>04871           <span class="comment">/* Nothing changed.  */</span>
<a name="l04872"></a>04872           <a class="code" href="value_8c.html#a10aad9b72e08c5e90e3051156fa83318">value_free_to_mark</a> (mark);
<a name="l04873"></a>04873           <span class="keywordflow">return</span> <a class="code" href="breakpoint_8c.html#ae36c32e2b38502ff199be11f92109a57">WP_VALUE_NOT_CHANGED</a>;
<a name="l04874"></a>04874         }
<a name="l04875"></a>04875     }
<a name="l04876"></a>04876   <span class="keywordflow">else</span>
<a name="l04877"></a>04877     {
<a name="l04878"></a>04878       <span class="keyword">struct </span>ui_out *uiout = <a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>;
<a name="l04879"></a>04879 
<a name="l04880"></a>04880       <span class="comment">/* This seems like the only logical thing to do because</span>
<a name="l04881"></a>04881 <span class="comment">         if we temporarily ignored the watchpoint, then when</span>
<a name="l04882"></a>04882 <span class="comment">         we reenter the block in which it is valid it contains</span>
<a name="l04883"></a>04883 <span class="comment">         garbage (in the case of a function, it may have two</span>
<a name="l04884"></a>04884 <span class="comment">         garbage values, one before and one after the prologue).</span>
<a name="l04885"></a>04885 <span class="comment">         So we can&#39;t even detect the first assignment to it and</span>
<a name="l04886"></a>04886 <span class="comment">         watch after that (since the garbage may or may not equal</span>
<a name="l04887"></a>04887 <span class="comment">         the first value assigned).  */</span>
<a name="l04888"></a>04888       <span class="comment">/* We print all the stop information in</span>
<a name="l04889"></a>04889 <span class="comment">         breakpoint_ops-&gt;print_it, but in this case, by the time we</span>
<a name="l04890"></a>04890 <span class="comment">         call breakpoint_ops-&gt;print_it this bp will be deleted</span>
<a name="l04891"></a>04891 <span class="comment">         already.  So we have no choice but print the information</span>
<a name="l04892"></a>04892 <span class="comment">         here.  */</span>
<a name="l04893"></a>04893       <span class="keywordflow">if</span> (<a class="code" href="ui-out_8c.html#a473db54efcfbc60feeb5a4f54f27af46">ui_out_is_mi_like_p</a> (uiout))
<a name="l04894"></a>04894         <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a>
<a name="l04895"></a>04895           (uiout, <span class="stringliteral">&quot;reason&quot;</span>, <a class="code" href="mi-common_8c.html#a619e7d180d78af6e6d63a611c6680e90">async_reason_lookup</a> (<a class="code" href="mi-common_8h.html#a06d7bf56f98dcc556d686f49ea570daea1fcd93091fec4eff605c41aaf96e6f64">EXEC_ASYNC_WATCHPOINT_SCOPE</a>));
<a name="l04896"></a>04896       <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;\nWatchpoint &quot;</span>);
<a name="l04897"></a>04897       <a class="code" href="ui-out_8c.html#aa6f66551d03db456fb94ca1c9038f5a0">ui_out_field_int</a> (uiout, <span class="stringliteral">&quot;wpnum&quot;</span>, b-&gt;<a class="code" href="structwatchpoint.html#a01b7a13518becdd7631c9d701b70cbd1">base</a>.<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>);
<a name="l04898"></a>04898       <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout,
<a name="l04899"></a>04899                    <span class="stringliteral">&quot; deleted because the program has left the block in\n\</span>
<a name="l04900"></a>04900 <span class="stringliteral">which its expression is valid.\n&quot;</span>);     
<a name="l04901"></a>04901 
<a name="l04902"></a>04902       <span class="comment">/* Make sure the watchpoint&#39;s commands aren&#39;t executed.  */</span>
<a name="l04903"></a>04903       decref_counted_command_line (&amp;b-&gt;<a class="code" href="structwatchpoint.html#a01b7a13518becdd7631c9d701b70cbd1">base</a>.<a class="code" href="structbreakpoint.html#a054780dffadb1a4af0fc35037834fe4b">commands</a>);
<a name="l04904"></a>04904       watchpoint_del_at_next_stop (b);
<a name="l04905"></a>04905 
<a name="l04906"></a>04906       <span class="keywordflow">return</span> <a class="code" href="breakpoint_8c.html#a29b7b16728e24b4495694b687f11fe5d">WP_DELETED</a>;
<a name="l04907"></a>04907     }
<a name="l04908"></a>04908 }
<a name="l04909"></a>04909 
<a name="l04910"></a>04910 <span class="comment">/* Return true if it looks like target has stopped due to hitting</span>
<a name="l04911"></a>04911 <span class="comment">   breakpoint location BL.  This function does not check if we should</span>
<a name="l04912"></a>04912 <span class="comment">   stop, only if BL explains the stop.  */</span>
<a name="l04913"></a>04913 
<a name="l04914"></a>04914 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l04915"></a>04915 bpstat_check_location (<span class="keyword">const</span> <span class="keyword">struct</span> bp_location *bl,
<a name="l04916"></a>04916                        <span class="keyword">struct</span> address_space *aspace, <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> bp_addr,
<a name="l04917"></a>04917                        <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structtarget__waitstatus.html">target_waitstatus</a> *ws)
<a name="l04918"></a>04918 {
<a name="l04919"></a>04919   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b = bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>;
<a name="l04920"></a>04920 
<a name="l04921"></a>04921   <span class="comment">/* BL is from an existing breakpoint.  */</span>
<a name="l04922"></a>04922   <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (b != NULL);
<a name="l04923"></a>04923 
<a name="l04924"></a>04924   <span class="keywordflow">return</span> b-&gt;<a class="code" href="structbreakpoint.html#aba258aa23496f6434aaa1cf8c8dc7ea7">ops</a>-&gt;<a class="code" href="structbreakpoint__ops.html#a4aa8d8d1c3a346f7e7efa58474697a90">breakpoint_hit</a> (bl, aspace, bp_addr, ws);
<a name="l04925"></a>04925 }
<a name="l04926"></a>04926 
<a name="l04927"></a>04927 <span class="comment">/* Determine if the watched values have actually changed, and we</span>
<a name="l04928"></a>04928 <span class="comment">   should stop.  If not, set BS-&gt;stop to 0.  */</span>
<a name="l04929"></a>04929 
<a name="l04930"></a>04930 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l04931"></a>04931 bpstat_check_watchpoint (<a class="code" href="structbpstats.html">bpstat</a> bs)
<a name="l04932"></a>04932 {
<a name="l04933"></a>04933   <span class="keyword">const</span> <span class="keyword">struct </span>bp_location *bl;
<a name="l04934"></a>04934   <span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *b;
<a name="l04935"></a>04935 
<a name="l04936"></a>04936   <span class="comment">/* BS is built for existing struct breakpoint.  */</span>
<a name="l04937"></a>04937   bl = bs-&gt;<a class="code" href="structbpstats.html#a510428e7ce2e4852e0613b3b5579142b">bp_location_at</a>;
<a name="l04938"></a>04938   <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (bl != NULL);
<a name="l04939"></a>04939   b = (<span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *) bs-&gt;<a class="code" href="structbpstats.html#ac105ed7263dd10f9d65e92e706b04e39">breakpoint_at</a>;
<a name="l04940"></a>04940   <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (b != NULL);
<a name="l04941"></a>04941 
<a name="l04942"></a>04942     {
<a name="l04943"></a>04943       <span class="keywordtype">int</span> must_check_value = 0;
<a name="l04944"></a>04944       
<a name="l04945"></a>04945       <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structwatchpoint.html#a01b7a13518becdd7631c9d701b70cbd1">base</a>.<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa2a35cc5d65b66d6228def5615d6827ce">bp_watchpoint</a>)
<a name="l04946"></a>04946         <span class="comment">/* For a software watchpoint, we must always check the</span>
<a name="l04947"></a>04947 <span class="comment">           watched value.  */</span>
<a name="l04948"></a>04948         must_check_value = 1;
<a name="l04949"></a>04949       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structwatchpoint.html#ad73d8e3d495e46d149b23a36b225daba">watchpoint_triggered</a> == <a class="code" href="breakpoint_8h.html#aee5eff1f9c0902dcf85bf1a18c2a1bdeaaa456969ebe18c987a8159fc613d1e21">watch_triggered_yes</a>)
<a name="l04950"></a>04950         <span class="comment">/* We have a hardware watchpoint (read, write, or access)</span>
<a name="l04951"></a>04951 <span class="comment">           and the target earlier reported an address watched by</span>
<a name="l04952"></a>04952 <span class="comment">           this watchpoint.  */</span>
<a name="l04953"></a>04953         must_check_value = 1;
<a name="l04954"></a>04954       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structwatchpoint.html#ad73d8e3d495e46d149b23a36b225daba">watchpoint_triggered</a> == <a class="code" href="breakpoint_8h.html#aee5eff1f9c0902dcf85bf1a18c2a1bdea4e5cedd852c5c38b527d86e42621cdbe">watch_triggered_unknown</a>
<a name="l04955"></a>04955                &amp;&amp; b-&gt;<a class="code" href="structwatchpoint.html#a01b7a13518becdd7631c9d701b70cbd1">base</a>.<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfae38a33f5a6725fbca8b5da2d491cfbcb">bp_hardware_watchpoint</a>)
<a name="l04956"></a>04956         <span class="comment">/* We were stopped by a hardware watchpoint, but the target could</span>
<a name="l04957"></a>04957 <span class="comment">           not report the data address.  We must check the watchpoint&#39;s</span>
<a name="l04958"></a>04958 <span class="comment">           value.  Access and read watchpoints are out of luck; without</span>
<a name="l04959"></a>04959 <span class="comment">           a data address, we can&#39;t figure it out.  */</span>
<a name="l04960"></a>04960         must_check_value = 1;
<a name="l04961"></a>04961 
<a name="l04962"></a>04962       <span class="keywordflow">if</span> (must_check_value)
<a name="l04963"></a>04963         {
<a name="l04964"></a>04964           <span class="keywordtype">char</span> *message
<a name="l04965"></a>04965             = <a class="code" href="common-utils_8c.html#ab9bf7e1b4e68bdd0078e9e1e55c62cec">xstrprintf</a> (<span class="stringliteral">&quot;Error evaluating expression for watchpoint %d\n&quot;</span>,
<a name="l04966"></a>04966                           b-&gt;<a class="code" href="structwatchpoint.html#a01b7a13518becdd7631c9d701b70cbd1">base</a>.<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>);
<a name="l04967"></a>04967           <span class="keyword">struct </span>cleanup *cleanups = <a class="code" href="cleanups_8c.html#a3d418f8af424aec399898c2d48b26224">make_cleanup</a> (<a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a>, message);
<a name="l04968"></a>04968           <span class="keywordtype">int</span> e = <a class="code" href="exceptions_8c.html#ad6275ae3cd191f69dd2fe540f138cb2d">catch_errors</a> (watchpoint_check, bs, message,
<a name="l04969"></a>04969                                 <a class="code" href="exceptions_8h.html#abfa3a3b99557b11f5766baf69465fdf6ab50fde886a7de8c013bf2bd4e7c073a4">RETURN_MASK_ALL</a>);
<a name="l04970"></a>04970           <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (cleanups);
<a name="l04971"></a>04971           <span class="keywordflow">switch</span> (e)
<a name="l04972"></a>04972             {
<a name="l04973"></a>04973             <span class="keywordflow">case</span> <a class="code" href="breakpoint_8c.html#a29b7b16728e24b4495694b687f11fe5d">WP_DELETED</a>:
<a name="l04974"></a>04974               <span class="comment">/* We&#39;ve already printed what needs to be printed.  */</span>
<a name="l04975"></a>04975               bs-&gt;<a class="code" href="structbpstats.html#aa7d7990c1285ae7d002f1ab22aa5cf1c">print_it</a> = <a class="code" href="breakpoint_8h.html#a3c71b66ef0df7811590693f77ca1c643add30a20c45ddf585f9c6c15681986635">print_it_done</a>;
<a name="l04976"></a>04976               <span class="comment">/* Stop.  */</span>
<a name="l04977"></a>04977               <span class="keywordflow">break</span>;
<a name="l04978"></a>04978             <span class="keywordflow">case</span> <a class="code" href="breakpoint_8c.html#a0bc4dd62242a0560eb112bd82bac8ec5">WP_IGNORE</a>:
<a name="l04979"></a>04979               bs-&gt;<a class="code" href="structbpstats.html#aa7d7990c1285ae7d002f1ab22aa5cf1c">print_it</a> = <a class="code" href="breakpoint_8h.html#a3c71b66ef0df7811590693f77ca1c643ab105e1b64aa8f28dd69ccb8f1ed14c61">print_it_noop</a>;
<a name="l04980"></a>04980               bs-&gt;<a class="code" href="structbpstats.html#acff86901962f7bc070661b85248c4652">stop</a> = 0;
<a name="l04981"></a>04981               <span class="keywordflow">break</span>;
<a name="l04982"></a>04982             <span class="keywordflow">case</span> <a class="code" href="breakpoint_8c.html#a1d8449f786bd1bdff7c4e545cb997734">WP_VALUE_CHANGED</a>:
<a name="l04983"></a>04983               <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structwatchpoint.html#a01b7a13518becdd7631c9d701b70cbd1">base</a>.<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa7013ee22be60f470b10b2de2f9d22c21">bp_read_watchpoint</a>)
<a name="l04984"></a>04984                 {
<a name="l04985"></a>04985                   <span class="comment">/* There are two cases to consider here:</span>
<a name="l04986"></a>04986 <span class="comment"></span>
<a name="l04987"></a>04987 <span class="comment">                     1. We&#39;re watching the triggered memory for reads.</span>
<a name="l04988"></a>04988 <span class="comment">                     In that case, trust the target, and always report</span>
<a name="l04989"></a>04989 <span class="comment">                     the watchpoint hit to the user.  Even though</span>
<a name="l04990"></a>04990 <span class="comment">                     reads don&#39;t cause value changes, the value may</span>
<a name="l04991"></a>04991 <span class="comment">                     have changed since the last time it was read, and</span>
<a name="l04992"></a>04992 <span class="comment">                     since we&#39;re not trapping writes, we will not see</span>
<a name="l04993"></a>04993 <span class="comment">                     those, and as such we should ignore our notion of</span>
<a name="l04994"></a>04994 <span class="comment">                     old value.</span>
<a name="l04995"></a>04995 <span class="comment"></span>
<a name="l04996"></a>04996 <span class="comment">                     2. We&#39;re watching the triggered memory for both</span>
<a name="l04997"></a>04997 <span class="comment">                     reads and writes.  There are two ways this may</span>
<a name="l04998"></a>04998 <span class="comment">                     happen:</span>
<a name="l04999"></a>04999 <span class="comment"></span>
<a name="l05000"></a>05000 <span class="comment">                     2.1. This is a target that can&#39;t break on data</span>
<a name="l05001"></a>05001 <span class="comment">                     reads only, but can break on accesses (reads or</span>
<a name="l05002"></a>05002 <span class="comment">                     writes), such as e.g., x86.  We detect this case</span>
<a name="l05003"></a>05003 <span class="comment">                     at the time we try to insert read watchpoints.</span>
<a name="l05004"></a>05004 <span class="comment"></span>
<a name="l05005"></a>05005 <span class="comment">                     2.2. Otherwise, the target supports read</span>
<a name="l05006"></a>05006 <span class="comment">                     watchpoints, but, the user set an access or write</span>
<a name="l05007"></a>05007 <span class="comment">                     watchpoint watching the same memory as this read</span>
<a name="l05008"></a>05008 <span class="comment">                     watchpoint.</span>
<a name="l05009"></a>05009 <span class="comment"></span>
<a name="l05010"></a>05010 <span class="comment">                     If we&#39;re watching memory writes as well as reads,</span>
<a name="l05011"></a>05011 <span class="comment">                     ignore watchpoint hits when we find that the</span>
<a name="l05012"></a>05012 <span class="comment">                     value hasn&#39;t changed, as reads don&#39;t cause</span>
<a name="l05013"></a>05013 <span class="comment">                     changes.  This still gives false positives when</span>
<a name="l05014"></a>05014 <span class="comment">                     the program writes the same value to memory as</span>
<a name="l05015"></a>05015 <span class="comment">                     what there was already in memory (we will confuse</span>
<a name="l05016"></a>05016 <span class="comment">                     it for a read), but it&#39;s much better than</span>
<a name="l05017"></a>05017 <span class="comment">                     nothing.  */</span>
<a name="l05018"></a>05018 
<a name="l05019"></a>05019                   <span class="keywordtype">int</span> other_write_watchpoint = 0;
<a name="l05020"></a>05020 
<a name="l05021"></a>05021                   <span class="keywordflow">if</span> (bl-&gt;<a class="code" href="structbp__location.html#a0480880dc590f47b72d7af91ab5d5802">watchpoint_type</a> == <a class="code" href="break-common_8h.html#ae1f701210980578c2ab1bc4ae89e69f3afb52ba78eb7679d11a25bd2c44eb0606">hw_read</a>)
<a name="l05022"></a>05022                     {
<a name="l05023"></a>05023                       <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *other_b;
<a name="l05024"></a>05024 
<a name="l05025"></a>05025                       <a class="code" href="breakpoint_8c.html#a781d5d3dc50a92364edfbacac3d0c107">ALL_BREAKPOINTS</a> (other_b)
<a name="l05026"></a>05026                         if (other_b-&gt;type == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfae38a33f5a6725fbca8b5da2d491cfbcb">bp_hardware_watchpoint</a>
<a name="l05027"></a>05027                             || other_b-&gt;type == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa9148c330e0f813ed6fb421af9d7da820">bp_access_watchpoint</a>)
<a name="l05028"></a>05028                           {
<a name="l05029"></a>05029                             <span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *other_w =
<a name="l05030"></a>05030                               (<span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *) other_b;
<a name="l05031"></a>05031 
<a name="l05032"></a>05032                             <span class="keywordflow">if</span> (other_w-&gt;<a class="code" href="structwatchpoint.html#ad73d8e3d495e46d149b23a36b225daba">watchpoint_triggered</a>
<a name="l05033"></a>05033                                 == <a class="code" href="breakpoint_8h.html#aee5eff1f9c0902dcf85bf1a18c2a1bdeaaa456969ebe18c987a8159fc613d1e21">watch_triggered_yes</a>)
<a name="l05034"></a>05034                               {
<a name="l05035"></a>05035                                 other_write_watchpoint = 1;
<a name="l05036"></a>05036                                 <span class="keywordflow">break</span>;
<a name="l05037"></a>05037                               }
<a name="l05038"></a>05038                           }
<a name="l05039"></a>05039                     }
<a name="l05040"></a>05040 
<a name="l05041"></a>05041                   <span class="keywordflow">if</span> (other_write_watchpoint
<a name="l05042"></a>05042                       || bl-&gt;<a class="code" href="structbp__location.html#a0480880dc590f47b72d7af91ab5d5802">watchpoint_type</a> == <a class="code" href="break-common_8h.html#ae1f701210980578c2ab1bc4ae89e69f3a8bef3f5dcfc5f1c5b482627a8ddf5736">hw_access</a>)
<a name="l05043"></a>05043                     {
<a name="l05044"></a>05044                       <span class="comment">/* We&#39;re watching the same memory for writes,</span>
<a name="l05045"></a>05045 <span class="comment">                         and the value changed since the last time we</span>
<a name="l05046"></a>05046 <span class="comment">                         updated it, so this trap must be for a write.</span>
<a name="l05047"></a>05047 <span class="comment">                         Ignore it.  */</span>
<a name="l05048"></a>05048                       bs-&gt;<a class="code" href="structbpstats.html#aa7d7990c1285ae7d002f1ab22aa5cf1c">print_it</a> = <a class="code" href="breakpoint_8h.html#a3c71b66ef0df7811590693f77ca1c643ab105e1b64aa8f28dd69ccb8f1ed14c61">print_it_noop</a>;
<a name="l05049"></a>05049                       bs-&gt;<a class="code" href="structbpstats.html#acff86901962f7bc070661b85248c4652">stop</a> = 0;
<a name="l05050"></a>05050                     }
<a name="l05051"></a>05051                 }
<a name="l05052"></a>05052               <span class="keywordflow">break</span>;
<a name="l05053"></a>05053             <span class="keywordflow">case</span> <a class="code" href="breakpoint_8c.html#ae36c32e2b38502ff199be11f92109a57">WP_VALUE_NOT_CHANGED</a>:
<a name="l05054"></a>05054               <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structwatchpoint.html#a01b7a13518becdd7631c9d701b70cbd1">base</a>.<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfae38a33f5a6725fbca8b5da2d491cfbcb">bp_hardware_watchpoint</a>
<a name="l05055"></a>05055                   || b-&gt;<a class="code" href="structwatchpoint.html#a01b7a13518becdd7631c9d701b70cbd1">base</a>.<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa2a35cc5d65b66d6228def5615d6827ce">bp_watchpoint</a>)
<a name="l05056"></a>05056                 {
<a name="l05057"></a>05057                   <span class="comment">/* Don&#39;t stop: write watchpoints shouldn&#39;t fire if</span>
<a name="l05058"></a>05058 <span class="comment">                     the value hasn&#39;t changed.  */</span>
<a name="l05059"></a>05059                   bs-&gt;<a class="code" href="structbpstats.html#aa7d7990c1285ae7d002f1ab22aa5cf1c">print_it</a> = <a class="code" href="breakpoint_8h.html#a3c71b66ef0df7811590693f77ca1c643ab105e1b64aa8f28dd69ccb8f1ed14c61">print_it_noop</a>;
<a name="l05060"></a>05060                   bs-&gt;<a class="code" href="structbpstats.html#acff86901962f7bc070661b85248c4652">stop</a> = 0;
<a name="l05061"></a>05061                 }
<a name="l05062"></a>05062               <span class="comment">/* Stop.  */</span>
<a name="l05063"></a>05063               <span class="keywordflow">break</span>;
<a name="l05064"></a>05064             <span class="keywordflow">default</span>:
<a name="l05065"></a>05065               <span class="comment">/* Can&#39;t happen.  */</span>
<a name="l05066"></a>05066             <span class="keywordflow">case</span> 0:
<a name="l05067"></a>05067               <span class="comment">/* Error from catch_errors.  */</span>
<a name="l05068"></a>05068               <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Watchpoint %d deleted.\n&quot;</span>), b-&gt;<a class="code" href="structwatchpoint.html#a01b7a13518becdd7631c9d701b70cbd1">base</a>.<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>);
<a name="l05069"></a>05069               watchpoint_del_at_next_stop (b);
<a name="l05070"></a>05070               <span class="comment">/* We&#39;ve already printed what needs to be printed.  */</span>
<a name="l05071"></a>05071               bs-&gt;<a class="code" href="structbpstats.html#aa7d7990c1285ae7d002f1ab22aa5cf1c">print_it</a> = <a class="code" href="breakpoint_8h.html#a3c71b66ef0df7811590693f77ca1c643add30a20c45ddf585f9c6c15681986635">print_it_done</a>;
<a name="l05072"></a>05072               <span class="keywordflow">break</span>;
<a name="l05073"></a>05073             }
<a name="l05074"></a>05074         }
<a name="l05075"></a>05075       <span class="keywordflow">else</span>      <span class="comment">/* must_check_value == 0 */</span>
<a name="l05076"></a>05076         {
<a name="l05077"></a>05077           <span class="comment">/* This is a case where some watchpoint(s) triggered, but</span>
<a name="l05078"></a>05078 <span class="comment">             not at the address of this watchpoint, or else no</span>
<a name="l05079"></a>05079 <span class="comment">             watchpoint triggered after all.  So don&#39;t print</span>
<a name="l05080"></a>05080 <span class="comment">             anything for this watchpoint.  */</span>
<a name="l05081"></a>05081           bs-&gt;<a class="code" href="structbpstats.html#aa7d7990c1285ae7d002f1ab22aa5cf1c">print_it</a> = <a class="code" href="breakpoint_8h.html#a3c71b66ef0df7811590693f77ca1c643ab105e1b64aa8f28dd69ccb8f1ed14c61">print_it_noop</a>;
<a name="l05082"></a>05082           bs-&gt;<a class="code" href="structbpstats.html#acff86901962f7bc070661b85248c4652">stop</a> = 0;
<a name="l05083"></a>05083         }
<a name="l05084"></a>05084     }
<a name="l05085"></a>05085 }
<a name="l05086"></a>05086 
<a name="l05087"></a>05087 
<a name="l05088"></a>05088 <span class="comment">/* Check conditions (condition proper, frame, thread and ignore count)</span>
<a name="l05089"></a>05089 <span class="comment">   of breakpoint referred to by BS.  If we should not stop for this</span>
<a name="l05090"></a>05090 <span class="comment">   breakpoint, set BS-&gt;stop to 0.  */</span>
<a name="l05091"></a>05091 
<a name="l05092"></a>05092 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l05093"></a>05093 bpstat_check_breakpoint_conditions (<a class="code" href="structbpstats.html">bpstat</a> bs, <a class="code" href="structptid.html">ptid_t</a> <a class="code" href="structptid.html">ptid</a>)
<a name="l05094"></a>05094 {
<a name="l05095"></a>05095   <span class="keywordtype">int</span> thread_id = <a class="code" href="gdbthread_8h.html#a3dbd3518561f91d8aa7621a65d39f305">pid_to_thread_id</a> (ptid);
<a name="l05096"></a>05096   <span class="keyword">const</span> <span class="keyword">struct </span>bp_location *bl;
<a name="l05097"></a>05097   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b;
<a name="l05098"></a>05098 
<a name="l05099"></a>05099   <span class="comment">/* BS is built for existing struct breakpoint.  */</span>
<a name="l05100"></a>05100   bl = bs-&gt;<a class="code" href="structbpstats.html#a510428e7ce2e4852e0613b3b5579142b">bp_location_at</a>;
<a name="l05101"></a>05101   <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (bl != NULL);
<a name="l05102"></a>05102   b = bs-&gt;<a class="code" href="structbpstats.html#ac105ed7263dd10f9d65e92e706b04e39">breakpoint_at</a>;
<a name="l05103"></a>05103   <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (b != NULL);
<a name="l05104"></a>05104 
<a name="l05105"></a>05105   <span class="comment">/* Even if the target evaluated the condition on its end and notified GDB, we</span>
<a name="l05106"></a>05106 <span class="comment">     need to do so again since GDB does not know if we stopped due to a</span>
<a name="l05107"></a>05107 <span class="comment">     breakpoint or a single step breakpoint.  */</span>
<a name="l05108"></a>05108 
<a name="l05109"></a>05109   <span class="keywordflow">if</span> (<a class="code" href="frame_8c.html#ad6cfc1ab3a8482a76d8e2862b3fc6542">frame_id_p</a> (b-&gt;<a class="code" href="structbreakpoint.html#af65175451fdfdff660221d724c7c3cae">frame_id</a>)
<a name="l05110"></a>05110       &amp;&amp; !<a class="code" href="frame_8c.html#a1948b73cbb94aef2e2f11a48b0f4b74c">frame_id_eq</a> (b-&gt;<a class="code" href="structbreakpoint.html#af65175451fdfdff660221d724c7c3cae">frame_id</a>, <a class="code" href="frame_8c.html#a1f3e0e4934b8b0f1265a1685457966c5">get_stack_frame_id</a> (<a class="code" href="frame_8c.html#a5ab254510728049878a232ed1b889820">get_current_frame</a> ())))
<a name="l05111"></a>05111     bs-&gt;<a class="code" href="structbpstats.html#acff86901962f7bc070661b85248c4652">stop</a> = 0;
<a name="l05112"></a>05112   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bs-&gt;<a class="code" href="structbpstats.html#acff86901962f7bc070661b85248c4652">stop</a>)
<a name="l05113"></a>05113     {
<a name="l05114"></a>05114       <span class="keywordtype">int</span> value_is_zero = 0;
<a name="l05115"></a>05115       <span class="keyword">struct </span><a class="code" href="structexpression.html">expression</a> *cond;
<a name="l05116"></a>05116 
<a name="l05117"></a>05117       <span class="comment">/* Evaluate Python breakpoints that have a &quot;stop&quot;</span>
<a name="l05118"></a>05118 <span class="comment">         method implemented.  */</span>
<a name="l05119"></a>05119       <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#aa0bcabd2a66e44f812a927b9ce574a13">py_bp_object</a>)
<a name="l05120"></a>05120         bs-&gt;<a class="code" href="structbpstats.html#acff86901962f7bc070661b85248c4652">stop</a> = <a class="code" href="py-breakpoint_8c.html#a2c91fbe14a522bd4827bcffab91babe3">gdbpy_should_stop</a> (b-&gt;<a class="code" href="structbreakpoint.html#aa0bcabd2a66e44f812a927b9ce574a13">py_bp_object</a>);
<a name="l05121"></a>05121 
<a name="l05122"></a>05122       <span class="keywordflow">if</span> (<a class="code" href="breakpoint_8c.html#a49f0d5ff628dd506db5b81f660eb4610">is_watchpoint</a> (b))
<a name="l05123"></a>05123         {
<a name="l05124"></a>05124           <span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *w = (<span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *) b;
<a name="l05125"></a>05125 
<a name="l05126"></a>05126           cond = w-&gt;<a class="code" href="structwatchpoint.html#af56cdd0c2d7782c70177feb9b0d9e676">cond_exp</a>;
<a name="l05127"></a>05127         }
<a name="l05128"></a>05128       <span class="keywordflow">else</span>
<a name="l05129"></a>05129         cond = bl-&gt;<a class="code" href="structbp__location.html#a1594433a0c3734e79b98d8296984ec7a">cond</a>;
<a name="l05130"></a>05130 
<a name="l05131"></a>05131       <span class="keywordflow">if</span> (cond &amp;&amp; b-&gt;<a class="code" href="structbreakpoint.html#a75f0f9a837eac292ab6e768e8d8f1bd7">disposition</a> != <a class="code" href="breakpoint_8h.html#a15f2bbd9012f59bc09d59feef0c15732a9b0a2ed54849261d15631bb5e654843b">disp_del_at_next_stop</a>)
<a name="l05132"></a>05132         {
<a name="l05133"></a>05133           <span class="keywordtype">int</span> within_current_scope = 1;
<a name="l05134"></a>05134           <span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> * w;
<a name="l05135"></a>05135 
<a name="l05136"></a>05136           <span class="comment">/* We use value_mark and value_free_to_mark because it could</span>
<a name="l05137"></a>05137 <span class="comment">             be a long time before we return to the command level and</span>
<a name="l05138"></a>05138 <span class="comment">             call free_all_values.  We can&#39;t call free_all_values</span>
<a name="l05139"></a>05139 <span class="comment">             because we might be in the middle of evaluating a</span>
<a name="l05140"></a>05140 <span class="comment">             function call.  */</span>
<a name="l05141"></a>05141           <span class="keyword">struct </span>value *mark = <a class="code" href="value_8c.html#a427a12b0dd4d5663b103d29f07a0e1c6">value_mark</a> ();
<a name="l05142"></a>05142 
<a name="l05143"></a>05143           <span class="keywordflow">if</span> (<a class="code" href="breakpoint_8c.html#a49f0d5ff628dd506db5b81f660eb4610">is_watchpoint</a> (b))
<a name="l05144"></a>05144             w = (<span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *) b;
<a name="l05145"></a>05145           <span class="keywordflow">else</span>
<a name="l05146"></a>05146             w = NULL;
<a name="l05147"></a>05147 
<a name="l05148"></a>05148           <span class="comment">/* Need to select the frame, with all that implies so that</span>
<a name="l05149"></a>05149 <span class="comment">             the conditions will have the right context.  Because we</span>
<a name="l05150"></a>05150 <span class="comment">             use the frame, we will not see an inlined function&#39;s</span>
<a name="l05151"></a>05151 <span class="comment">             variables when we arrive at a breakpoint at the start</span>
<a name="l05152"></a>05152 <span class="comment">             of the inlined function; the current frame will be the</span>
<a name="l05153"></a>05153 <span class="comment">             call site.  */</span>
<a name="l05154"></a>05154           <span class="keywordflow">if</span> (w == NULL || w-&gt;<a class="code" href="structwatchpoint.html#a8efc24adb7be3137ae593d26cb22436f">cond_exp_valid_block</a> == NULL)
<a name="l05155"></a>05155             <a class="code" href="frame_8c.html#a400fa273ac86863322cdc65683ef2356">select_frame</a> (<a class="code" href="frame_8c.html#a5ab254510728049878a232ed1b889820">get_current_frame</a> ());
<a name="l05156"></a>05156           <span class="keywordflow">else</span>
<a name="l05157"></a>05157             {
<a name="l05158"></a>05158               <span class="keyword">struct </span>frame_info *frame;
<a name="l05159"></a>05159 
<a name="l05160"></a>05160               <span class="comment">/* For local watchpoint expressions, which particular</span>
<a name="l05161"></a>05161 <span class="comment">                 instance of a local is being watched matters, so we</span>
<a name="l05162"></a>05162 <span class="comment">                 keep track of the frame to evaluate the expression</span>
<a name="l05163"></a>05163 <span class="comment">                 in.  To evaluate the condition however, it doesn&#39;t</span>
<a name="l05164"></a>05164 <span class="comment">                 really matter which instantiation of the function</span>
<a name="l05165"></a>05165 <span class="comment">                 where the condition makes sense triggers the</span>
<a name="l05166"></a>05166 <span class="comment">                 watchpoint.  This allows an expression like &quot;watch</span>
<a name="l05167"></a>05167 <span class="comment">                 global if q &gt; 10&quot; set in `func&#39;, catch writes to</span>
<a name="l05168"></a>05168 <span class="comment">                 global on all threads that call `func&#39;, or catch</span>
<a name="l05169"></a>05169 <span class="comment">                 writes on all recursive calls of `func&#39; by a single</span>
<a name="l05170"></a>05170 <span class="comment">                 thread.  We simply always evaluate the condition in</span>
<a name="l05171"></a>05171 <span class="comment">                 the innermost frame that&#39;s executing where it makes</span>
<a name="l05172"></a>05172 <span class="comment">                 sense to evaluate the condition.  It seems</span>
<a name="l05173"></a>05173 <span class="comment">                 intuitive.  */</span>
<a name="l05174"></a>05174               frame = <a class="code" href="blockframe_8c.html#acef754b55368c6be1928b137738b927a">block_innermost_frame</a> (w-&gt;<a class="code" href="structwatchpoint.html#a8efc24adb7be3137ae593d26cb22436f">cond_exp_valid_block</a>);
<a name="l05175"></a>05175               <span class="keywordflow">if</span> (frame != NULL)
<a name="l05176"></a>05176                 <a class="code" href="frame_8c.html#a400fa273ac86863322cdc65683ef2356">select_frame</a> (frame);
<a name="l05177"></a>05177               <span class="keywordflow">else</span>
<a name="l05178"></a>05178                 within_current_scope = 0;
<a name="l05179"></a>05179             }
<a name="l05180"></a>05180           <span class="keywordflow">if</span> (within_current_scope)
<a name="l05181"></a>05181             value_is_zero
<a name="l05182"></a>05182               = <a class="code" href="exceptions_8c.html#ad6275ae3cd191f69dd2fe540f138cb2d">catch_errors</a> (breakpoint_cond_eval, cond,
<a name="l05183"></a>05183                               <span class="stringliteral">&quot;Error in testing breakpoint condition:\n&quot;</span>,
<a name="l05184"></a>05184                               <a class="code" href="exceptions_8h.html#abfa3a3b99557b11f5766baf69465fdf6ab50fde886a7de8c013bf2bd4e7c073a4">RETURN_MASK_ALL</a>);
<a name="l05185"></a>05185           <span class="keywordflow">else</span>
<a name="l05186"></a>05186             {
<a name="l05187"></a>05187               <a class="code" href="utils_8c.html#a5fc201a4181499a6b4057a6caa15b5e2">warning</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Watchpoint condition cannot be tested &quot;</span>
<a name="l05188"></a>05188                          <span class="stringliteral">&quot;in the current scope&quot;</span>));
<a name="l05189"></a>05189               <span class="comment">/* If we failed to set the right context for this</span>
<a name="l05190"></a>05190 <span class="comment">                 watchpoint, unconditionally report it.  */</span>
<a name="l05191"></a>05191               value_is_zero = 0;
<a name="l05192"></a>05192             }
<a name="l05193"></a>05193           <span class="comment">/* FIXME-someday, should give breakpoint #.  */</span>
<a name="l05194"></a>05194           <a class="code" href="value_8c.html#a10aad9b72e08c5e90e3051156fa83318">value_free_to_mark</a> (mark);
<a name="l05195"></a>05195         }
<a name="l05196"></a>05196 
<a name="l05197"></a>05197       <span class="keywordflow">if</span> (cond &amp;&amp; value_is_zero)
<a name="l05198"></a>05198         {
<a name="l05199"></a>05199           bs-&gt;<a class="code" href="structbpstats.html#acff86901962f7bc070661b85248c4652">stop</a> = 0;
<a name="l05200"></a>05200         }
<a name="l05201"></a>05201       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#ae8613b6d8cf464f30ea39597be0cc192">thread</a> != -1 &amp;&amp; b-&gt;<a class="code" href="structbreakpoint.html#ae8613b6d8cf464f30ea39597be0cc192">thread</a> != thread_id)
<a name="l05202"></a>05202         {
<a name="l05203"></a>05203           bs-&gt;<a class="code" href="structbpstats.html#acff86901962f7bc070661b85248c4652">stop</a> = 0;
<a name="l05204"></a>05204         }
<a name="l05205"></a>05205       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#a0e1286b838f13a04031a220f81c04d2d">ignore_count</a> &gt; 0)
<a name="l05206"></a>05206         {
<a name="l05207"></a>05207           b-&gt;<a class="code" href="structbreakpoint.html#a0e1286b838f13a04031a220f81c04d2d">ignore_count</a>--;
<a name="l05208"></a>05208           bs-&gt;<a class="code" href="structbpstats.html#acff86901962f7bc070661b85248c4652">stop</a> = 0;
<a name="l05209"></a>05209           <span class="comment">/* Increase the hit count even though we don&#39;t stop.  */</span>
<a name="l05210"></a>05210           ++(b-&gt;<a class="code" href="structbreakpoint.html#a4431b9e9db0a123962a90e8a82419494">hit_count</a>);
<a name="l05211"></a>05211           <a class="code" href="observer_8h.html#a3edacfe44ac49f71646caded92072cad">observer_notify_breakpoint_modified</a> (b);
<a name="l05212"></a>05212         }       
<a name="l05213"></a>05213     }
<a name="l05214"></a>05214 }
<a name="l05215"></a>05215 
<a name="l05216"></a>05216 
<a name="l05217"></a>05217 <span class="comment">/* Get a bpstat associated with having just stopped at address</span>
<a name="l05218"></a>05218 <span class="comment">   BP_ADDR in thread PTID.</span>
<a name="l05219"></a>05219 <span class="comment"></span>
<a name="l05220"></a>05220 <span class="comment">   Determine whether we stopped at a breakpoint, etc, or whether we</span>
<a name="l05221"></a>05221 <span class="comment">   don&#39;t understand this stop.  Result is a chain of bpstat&#39;s such</span>
<a name="l05222"></a>05222 <span class="comment">   that:</span>
<a name="l05223"></a>05223 <span class="comment"></span>
<a name="l05224"></a>05224 <span class="comment">   if we don&#39;t understand the stop, the result is a null pointer.</span>
<a name="l05225"></a>05225 <span class="comment"></span>
<a name="l05226"></a>05226 <span class="comment">   if we understand why we stopped, the result is not null.</span>
<a name="l05227"></a>05227 <span class="comment"></span>
<a name="l05228"></a>05228 <span class="comment">   Each element of the chain refers to a particular breakpoint or</span>
<a name="l05229"></a>05229 <span class="comment">   watchpoint at which we have stopped.  (We may have stopped for</span>
<a name="l05230"></a>05230 <span class="comment">   several reasons concurrently.)</span>
<a name="l05231"></a>05231 <span class="comment"></span>
<a name="l05232"></a>05232 <span class="comment">   Each element of the chain has valid next, breakpoint_at,</span>
<a name="l05233"></a>05233 <span class="comment">   commands, FIXME??? fields.  */</span>
<a name="l05234"></a>05234 
<a name="l05235"></a>05235 <a class="code" href="structbpstats.html">bpstat</a>
<a name="l05236"></a><a class="code" href="breakpoint_8h.html#a147331e7e43bbde1e6be1c4950a299af">05236</a> <a class="code" href="breakpoint_8c.html#ac3d482c4e35f54c8eb1de687186f01bd">bpstat_stop_status</a> (<span class="keyword">struct</span> address_space *aspace,
<a name="l05237"></a>05237                     <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> bp_addr, <a class="code" href="structptid.html">ptid_t</a> ptid,
<a name="l05238"></a>05238                     <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structtarget__waitstatus.html">target_waitstatus</a> *ws)
<a name="l05239"></a>05239 {
<a name="l05240"></a>05240   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b = NULL;
<a name="l05241"></a>05241   <span class="keyword">struct </span>bp_location *bl;
<a name="l05242"></a>05242   <span class="keyword">struct </span>bp_location *loc;
<a name="l05243"></a>05243   <span class="comment">/* First item of allocated bpstat&#39;s.  */</span>
<a name="l05244"></a>05244   <a class="code" href="structbpstats.html">bpstat</a> bs_head = NULL, *bs_link = &amp;bs_head;
<a name="l05245"></a>05245   <span class="comment">/* Pointer to the last thing in the chain currently.  */</span>
<a name="l05246"></a>05246   <a class="code" href="structbpstats.html">bpstat</a> bs;
<a name="l05247"></a>05247   <span class="keywordtype">int</span> ix;
<a name="l05248"></a>05248   <span class="keywordtype">int</span> need_remove_insert;
<a name="l05249"></a>05249   <span class="keywordtype">int</span> removed_any;
<a name="l05250"></a>05250 
<a name="l05251"></a>05251   <span class="comment">/* First, build the bpstat chain with locations that explain a</span>
<a name="l05252"></a>05252 <span class="comment">     target stop, while being careful to not set the target running,</span>
<a name="l05253"></a>05253 <span class="comment">     as that may invalidate locations (in particular watchpoint</span>
<a name="l05254"></a>05254 <span class="comment">     locations are recreated).  Resuming will happen here with</span>
<a name="l05255"></a>05255 <span class="comment">     breakpoint conditions or watchpoint expressions that include</span>
<a name="l05256"></a>05256 <span class="comment">     inferior function calls.  */</span>
<a name="l05257"></a>05257 
<a name="l05258"></a>05258   <a class="code" href="breakpoint_8c.html#a781d5d3dc50a92364edfbacac3d0c107">ALL_BREAKPOINTS</a> (b)
<a name="l05259"></a>05259     {
<a name="l05260"></a>05260       <span class="keywordflow">if</span> (!breakpoint_enabled (b) &amp;&amp; b-&gt;<a class="code" href="structbreakpoint.html#acb53352fd35aaad37054508fabc0f3bf">enable_state</a> != <a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577adbf2e9b210d33b1ac7e8a7ed87a2b46f">bp_permanent</a>)
<a name="l05261"></a>05261         <span class="keywordflow">continue</span>;
<a name="l05262"></a>05262 
<a name="l05263"></a>05263       <span class="keywordflow">for</span> (bl = b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>; bl != NULL; bl = bl-&gt;<a class="code" href="structbp__location.html#ab193cb38f87fea89105db96d94191541">next</a>)
<a name="l05264"></a>05264         {
<a name="l05265"></a>05265           <span class="comment">/* For hardware watchpoints, we look only at the first</span>
<a name="l05266"></a>05266 <span class="comment">             location.  The watchpoint_check function will work on the</span>
<a name="l05267"></a>05267 <span class="comment">             entire expression, not the individual locations.  For</span>
<a name="l05268"></a>05268 <span class="comment">             read watchpoints, the watchpoints_triggered function has</span>
<a name="l05269"></a>05269 <span class="comment">             checked all locations already.  */</span>
<a name="l05270"></a>05270           <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfae38a33f5a6725fbca8b5da2d491cfbcb">bp_hardware_watchpoint</a> &amp;&amp; bl != b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>)
<a name="l05271"></a>05271             <span class="keywordflow">break</span>;
<a name="l05272"></a>05272 
<a name="l05273"></a>05273           <span class="keywordflow">if</span> (!bl-&gt;<a class="code" href="structbp__location.html#abe93e091d18373d27bda3ad3eb6316f8">enabled</a> || bl-&gt;<a class="code" href="structbp__location.html#a3732b41958ed311106bffd202cbfe4ff">shlib_disabled</a>)
<a name="l05274"></a>05274             <span class="keywordflow">continue</span>;
<a name="l05275"></a>05275 
<a name="l05276"></a>05276           <span class="keywordflow">if</span> (!bpstat_check_location (bl, aspace, bp_addr, ws))
<a name="l05277"></a>05277             <span class="keywordflow">continue</span>;
<a name="l05278"></a>05278 
<a name="l05279"></a>05279           <span class="comment">/* Come here if it&#39;s a watchpoint, or if the break address</span>
<a name="l05280"></a>05280 <span class="comment">             matches.  */</span>
<a name="l05281"></a>05281 
<a name="l05282"></a>05282           bs = bpstat_alloc (bl, &amp;bs_link);     <span class="comment">/* Alloc a bpstat to</span>
<a name="l05283"></a>05283 <span class="comment">                                                   explain stop.  */</span>
<a name="l05284"></a>05284 
<a name="l05285"></a>05285           <span class="comment">/* Assume we stop.  Should we find a watchpoint that is not</span>
<a name="l05286"></a>05286 <span class="comment">             actually triggered, or if the condition of the breakpoint</span>
<a name="l05287"></a>05287 <span class="comment">             evaluates as false, we&#39;ll reset &#39;stop&#39; to 0.  */</span>
<a name="l05288"></a>05288           bs-&gt;<a class="code" href="structbpstats.html#acff86901962f7bc070661b85248c4652">stop</a> = 1;
<a name="l05289"></a>05289           bs-&gt;<a class="code" href="structbpstats.html#a2248119ffe4efcc99d08f4ffb562b54b">print</a> = 1;
<a name="l05290"></a>05290 
<a name="l05291"></a>05291           <span class="comment">/* If this is a scope breakpoint, mark the associated</span>
<a name="l05292"></a>05292 <span class="comment">             watchpoint as triggered so that we will handle the</span>
<a name="l05293"></a>05293 <span class="comment">             out-of-scope event.  We&#39;ll get to the watchpoint next</span>
<a name="l05294"></a>05294 <span class="comment">             iteration.  */</span>
<a name="l05295"></a>05295           <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfad6bfd2f2654949462085c78f02480366">bp_watchpoint_scope</a> &amp;&amp; b-&gt;<a class="code" href="structbreakpoint.html#a7d9882daea896de8ff1f7981e9508500">related_breakpoint</a> != b)
<a name="l05296"></a>05296             {
<a name="l05297"></a>05297               <span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *w = (<span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *) b-&gt;<a class="code" href="structbreakpoint.html#a7d9882daea896de8ff1f7981e9508500">related_breakpoint</a>;
<a name="l05298"></a>05298 
<a name="l05299"></a>05299               w-&gt;<a class="code" href="structwatchpoint.html#ad73d8e3d495e46d149b23a36b225daba">watchpoint_triggered</a> = <a class="code" href="breakpoint_8h.html#aee5eff1f9c0902dcf85bf1a18c2a1bdeaaa456969ebe18c987a8159fc613d1e21">watch_triggered_yes</a>;
<a name="l05300"></a>05300             }
<a name="l05301"></a>05301         }
<a name="l05302"></a>05302     }
<a name="l05303"></a>05303 
<a name="l05304"></a>05304   <span class="keywordflow">for</span> (ix = 0; <a class="code" href="vec_8h.html#ae7795b0c8e65f45eb49aac5ec2c0fa52">VEC_iterate</a> (<a class="code" href="structbp__location.html">bp_location_p</a>, moribund_locations, ix, loc); ++ix)
<a name="l05305"></a>05305     {
<a name="l05306"></a>05306       <span class="keywordflow">if</span> (breakpoint_location_address_match (loc, aspace, bp_addr))
<a name="l05307"></a>05307         {
<a name="l05308"></a>05308           bs = bpstat_alloc (loc, &amp;bs_link);
<a name="l05309"></a>05309           <span class="comment">/* For hits of moribund locations, we should just proceed.  */</span>
<a name="l05310"></a>05310           bs-&gt;<a class="code" href="structbpstats.html#acff86901962f7bc070661b85248c4652">stop</a> = 0;
<a name="l05311"></a>05311           bs-&gt;<a class="code" href="structbpstats.html#a2248119ffe4efcc99d08f4ffb562b54b">print</a> = 0;
<a name="l05312"></a>05312           bs-&gt;<a class="code" href="structbpstats.html#aa7d7990c1285ae7d002f1ab22aa5cf1c">print_it</a> = <a class="code" href="breakpoint_8h.html#a3c71b66ef0df7811590693f77ca1c643ab105e1b64aa8f28dd69ccb8f1ed14c61">print_it_noop</a>;
<a name="l05313"></a>05313         }
<a name="l05314"></a>05314     }
<a name="l05315"></a>05315 
<a name="l05316"></a>05316   <span class="comment">/* A bit of special processing for shlib breakpoints.  We need to</span>
<a name="l05317"></a>05317 <span class="comment">     process solib loading here, so that the lists of loaded and</span>
<a name="l05318"></a>05318 <span class="comment">     unloaded libraries are correct before we handle &quot;catch load&quot; and</span>
<a name="l05319"></a>05319 <span class="comment">     &quot;catch unload&quot;.  */</span>
<a name="l05320"></a>05320   <span class="keywordflow">for</span> (bs = bs_head; bs != NULL; bs = bs-&gt;<a class="code" href="structbpstats.html#a48ed65e040defb4d45e1cea1a8414d6c">next</a>)
<a name="l05321"></a>05321     {
<a name="l05322"></a>05322       <span class="keywordflow">if</span> (bs-&gt;<a class="code" href="structbpstats.html#ac105ed7263dd10f9d65e92e706b04e39">breakpoint_at</a> &amp;&amp; bs-&gt;<a class="code" href="structbpstats.html#ac105ed7263dd10f9d65e92e706b04e39">breakpoint_at</a>-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa7ff3ee755a0635e1c8aa45bbeba6734a">bp_shlib_event</a>)
<a name="l05323"></a>05323         {
<a name="l05324"></a>05324           <a class="code" href="solib_8c.html#ad287e541d33b61f51058be4a592f5d14">handle_solib_event</a> ();
<a name="l05325"></a>05325           <span class="keywordflow">break</span>;
<a name="l05326"></a>05326         }
<a name="l05327"></a>05327     }
<a name="l05328"></a>05328 
<a name="l05329"></a>05329   <span class="comment">/* Now go through the locations that caused the target to stop, and</span>
<a name="l05330"></a>05330 <span class="comment">     check whether we&#39;re interested in reporting this stop to higher</span>
<a name="l05331"></a>05331 <span class="comment">     layers, or whether we should resume the target transparently.  */</span>
<a name="l05332"></a>05332 
<a name="l05333"></a>05333   removed_any = 0;
<a name="l05334"></a>05334 
<a name="l05335"></a>05335   <span class="keywordflow">for</span> (bs = bs_head; bs != NULL; bs = bs-&gt;<a class="code" href="structbpstats.html#a48ed65e040defb4d45e1cea1a8414d6c">next</a>)
<a name="l05336"></a>05336     {
<a name="l05337"></a>05337       <span class="keywordflow">if</span> (!bs-&gt;<a class="code" href="structbpstats.html#acff86901962f7bc070661b85248c4652">stop</a>)
<a name="l05338"></a>05338         <span class="keywordflow">continue</span>;
<a name="l05339"></a>05339 
<a name="l05340"></a>05340       b = bs-&gt;<a class="code" href="structbpstats.html#ac105ed7263dd10f9d65e92e706b04e39">breakpoint_at</a>;
<a name="l05341"></a>05341       b-&gt;<a class="code" href="structbreakpoint.html#aba258aa23496f6434aaa1cf8c8dc7ea7">ops</a>-&gt;<a class="code" href="structbreakpoint__ops.html#afd5b5a27bf4d9d9d49b267507b0633c4">check_status</a> (bs);
<a name="l05342"></a>05342       <span class="keywordflow">if</span> (bs-&gt;<a class="code" href="structbpstats.html#acff86901962f7bc070661b85248c4652">stop</a>)
<a name="l05343"></a>05343         {
<a name="l05344"></a>05344           bpstat_check_breakpoint_conditions (bs, ptid);
<a name="l05345"></a>05345 
<a name="l05346"></a>05346           <span class="keywordflow">if</span> (bs-&gt;<a class="code" href="structbpstats.html#acff86901962f7bc070661b85248c4652">stop</a>)
<a name="l05347"></a>05347             {
<a name="l05348"></a>05348               ++(b-&gt;<a class="code" href="structbreakpoint.html#a4431b9e9db0a123962a90e8a82419494">hit_count</a>);
<a name="l05349"></a>05349               <a class="code" href="observer_8h.html#a3edacfe44ac49f71646caded92072cad">observer_notify_breakpoint_modified</a> (b);
<a name="l05350"></a>05350 
<a name="l05351"></a>05351               <span class="comment">/* We will stop here.  */</span>
<a name="l05352"></a>05352               <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#a75f0f9a837eac292ab6e768e8d8f1bd7">disposition</a> == <a class="code" href="breakpoint_8h.html#a15f2bbd9012f59bc09d59feef0c15732a5207a2e1dd4e0223ab6a853264242d7b">disp_disable</a>)
<a name="l05353"></a>05353                 {
<a name="l05354"></a>05354                   --(b-&gt;<a class="code" href="structbreakpoint.html#a1971955032b554a7b688b6b842cdc393">enable_count</a>);
<a name="l05355"></a>05355                   <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#a1971955032b554a7b688b6b842cdc393">enable_count</a> &lt;= 0
<a name="l05356"></a>05356                       &amp;&amp; b-&gt;<a class="code" href="structbreakpoint.html#acb53352fd35aaad37054508fabc0f3bf">enable_state</a> != <a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577adbf2e9b210d33b1ac7e8a7ed87a2b46f">bp_permanent</a>)
<a name="l05357"></a>05357                     b-&gt;<a class="code" href="structbreakpoint.html#acb53352fd35aaad37054508fabc0f3bf">enable_state</a> = <a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577a4605f207d0d15bd8195c9b1aa1bfee96">bp_disabled</a>;
<a name="l05358"></a>05358                   removed_any = 1;
<a name="l05359"></a>05359                 }
<a name="l05360"></a>05360               <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#a7f6e5535a40a44f8f686da006afdf7b0">silent</a>)
<a name="l05361"></a>05361                 bs-&gt;<a class="code" href="structbpstats.html#a2248119ffe4efcc99d08f4ffb562b54b">print</a> = 0;
<a name="l05362"></a>05362               bs-&gt;<a class="code" href="structbpstats.html#a2c06ba2ce8217014988be902dc5228a4">commands</a> = b-&gt;<a class="code" href="structbreakpoint.html#a054780dffadb1a4af0fc35037834fe4b">commands</a>;
<a name="l05363"></a>05363               incref_counted_command_line (bs-&gt;<a class="code" href="structbpstats.html#a2c06ba2ce8217014988be902dc5228a4">commands</a>);
<a name="l05364"></a>05364               <span class="keywordflow">if</span> (command_line_is_silent (bs-&gt;<a class="code" href="structbpstats.html#a2c06ba2ce8217014988be902dc5228a4">commands</a>
<a name="l05365"></a>05365                                           ? bs-&gt;<a class="code" href="structbpstats.html#a2c06ba2ce8217014988be902dc5228a4">commands</a>-&gt;commands : NULL))
<a name="l05366"></a>05366                 bs-&gt;<a class="code" href="structbpstats.html#a2248119ffe4efcc99d08f4ffb562b54b">print</a> = 0;
<a name="l05367"></a>05367 
<a name="l05368"></a>05368               b-&gt;<a class="code" href="structbreakpoint.html#aba258aa23496f6434aaa1cf8c8dc7ea7">ops</a>-&gt;<a class="code" href="structbreakpoint__ops.html#a350e56ca3a9a7600acc19e7e0a20eeee">after_condition_true</a> (bs);
<a name="l05369"></a>05369             }
<a name="l05370"></a>05370 
<a name="l05371"></a>05371         }
<a name="l05372"></a>05372 
<a name="l05373"></a>05373       <span class="comment">/* Print nothing for this entry if we don&#39;t stop or don&#39;t</span>
<a name="l05374"></a>05374 <span class="comment">         print.  */</span>
<a name="l05375"></a>05375       <span class="keywordflow">if</span> (!bs-&gt;<a class="code" href="structbpstats.html#acff86901962f7bc070661b85248c4652">stop</a> || !bs-&gt;<a class="code" href="structbpstats.html#a2248119ffe4efcc99d08f4ffb562b54b">print</a>)
<a name="l05376"></a>05376         bs-&gt;<a class="code" href="structbpstats.html#aa7d7990c1285ae7d002f1ab22aa5cf1c">print_it</a> = <a class="code" href="breakpoint_8h.html#a3c71b66ef0df7811590693f77ca1c643ab105e1b64aa8f28dd69ccb8f1ed14c61">print_it_noop</a>;
<a name="l05377"></a>05377     }
<a name="l05378"></a>05378 
<a name="l05379"></a>05379   <span class="comment">/* If we aren&#39;t stopping, the value of some hardware watchpoint may</span>
<a name="l05380"></a>05380 <span class="comment">     not have changed, but the intermediate memory locations we are</span>
<a name="l05381"></a>05381 <span class="comment">     watching may have.  Don&#39;t bother if we&#39;re stopping; this will get</span>
<a name="l05382"></a>05382 <span class="comment">     done later.  */</span>
<a name="l05383"></a>05383   need_remove_insert = 0;
<a name="l05384"></a>05384   <span class="keywordflow">if</span> (! <a class="code" href="breakpoint_8c.html#a1d428f3e104ee3be5b672c3aa3207a47">bpstat_causes_stop</a> (bs_head))
<a name="l05385"></a>05385     <span class="keywordflow">for</span> (bs = bs_head; bs != NULL; bs = bs-&gt;<a class="code" href="structbpstats.html#a48ed65e040defb4d45e1cea1a8414d6c">next</a>)
<a name="l05386"></a>05386       <span class="keywordflow">if</span> (!bs-&gt;<a class="code" href="structbpstats.html#acff86901962f7bc070661b85248c4652">stop</a>
<a name="l05387"></a>05387           &amp;&amp; bs-&gt;<a class="code" href="structbpstats.html#ac105ed7263dd10f9d65e92e706b04e39">breakpoint_at</a>
<a name="l05388"></a>05388           &amp;&amp; is_hardware_watchpoint (bs-&gt;<a class="code" href="structbpstats.html#ac105ed7263dd10f9d65e92e706b04e39">breakpoint_at</a>))
<a name="l05389"></a>05389         {
<a name="l05390"></a>05390           <span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *w = (<span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *) bs-&gt;<a class="code" href="structbpstats.html#ac105ed7263dd10f9d65e92e706b04e39">breakpoint_at</a>;
<a name="l05391"></a>05391 
<a name="l05392"></a>05392           update_watchpoint (w, 0 <span class="comment">/* don&#39;t reparse.  */</span>);
<a name="l05393"></a>05393           need_remove_insert = 1;
<a name="l05394"></a>05394         }
<a name="l05395"></a>05395 
<a name="l05396"></a>05396   <span class="keywordflow">if</span> (need_remove_insert)
<a name="l05397"></a>05397     update_global_location_list (1);
<a name="l05398"></a>05398   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (removed_any)
<a name="l05399"></a>05399     update_global_location_list (0);
<a name="l05400"></a>05400 
<a name="l05401"></a>05401   <span class="keywordflow">return</span> bs_head;
<a name="l05402"></a>05402 }
<a name="l05403"></a>05403 
<a name="l05404"></a>05404 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l05405"></a>05405 handle_jit_event (<span class="keywordtype">void</span>)
<a name="l05406"></a>05406 {
<a name="l05407"></a>05407   <span class="keyword">struct </span>frame_info *frame;
<a name="l05408"></a>05408   <span class="keyword">struct </span>gdbarch *gdbarch;
<a name="l05409"></a>05409 
<a name="l05410"></a>05410   <span class="comment">/* Switch terminal for any messages produced by</span>
<a name="l05411"></a>05411 <span class="comment">     breakpoint_re_set.  */</span>
<a name="l05412"></a>05412   <a class="code" href="target_8h.html#a7369fcccf2537d98bda58de2a655e1d2">target_terminal_ours_for_output</a> ();
<a name="l05413"></a>05413 
<a name="l05414"></a>05414   frame = <a class="code" href="frame_8c.html#a5ab254510728049878a232ed1b889820">get_current_frame</a> ();
<a name="l05415"></a>05415   gdbarch = <a class="code" href="frame_8c.html#ab44507b5655da44e522ed5857835ede7">get_frame_arch</a> (frame);
<a name="l05416"></a>05416 
<a name="l05417"></a>05417   <a class="code" href="jit_8c.html#af0d5063aeeb45443b1bd387d7a7229cd">jit_event_handler</a> (gdbarch);
<a name="l05418"></a>05418 
<a name="l05419"></a>05419   <a class="code" href="target_8c.html#aab397975a1893898dcd07c8ed9aca04c">target_terminal_inferior</a> ();
<a name="l05420"></a>05420 }
<a name="l05421"></a>05421 
<a name="l05422"></a>05422 <span class="comment">/* Prepare WHAT final decision for infrun.  */</span>
<a name="l05423"></a>05423 
<a name="l05424"></a>05424 <span class="comment">/* Decide what infrun needs to do with this bpstat.  */</span>
<a name="l05425"></a>05425 
<a name="l05426"></a>05426 <span class="keyword">struct </span><a class="code" href="structbpstat__what.html">bpstat_what</a>
<a name="l05427"></a><a class="code" href="breakpoint_8h.html#a20d31b4d86aa0beb625dde5c721f75c5">05427</a> <a class="code" href="structbpstat__what.html">bpstat_what</a> (<a class="code" href="structbpstats.html">bpstat</a> bs_head)
<a name="l05428"></a>05428 {
<a name="l05429"></a>05429   <span class="keyword">struct </span><a class="code" href="structbpstat__what.html">bpstat_what</a> retval;
<a name="l05430"></a>05430   <span class="keywordtype">int</span> jit_event = 0;
<a name="l05431"></a>05431   <a class="code" href="structbpstats.html">bpstat</a> bs;
<a name="l05432"></a>05432 
<a name="l05433"></a>05433   retval.<a class="code" href="structbpstat__what.html#af9f9756d2ff9c6bc5e2ba9d62fb6bb62">main_action</a> = <a class="code" href="breakpoint_8h.html#a2e9c7b10df5e9872d2c2db186b9efc25ae143d13d08883bcadf96124e472b71c8">BPSTAT_WHAT_KEEP_CHECKING</a>;
<a name="l05434"></a>05434   retval.<a class="code" href="structbpstat__what.html#a92e25121e1fe8142717dd678386864b1">call_dummy</a> = <a class="code" href="breakpoint_8h.html#ada6fea43093a8775a805ff2bc372c6fea5341abc04ab3ee4c53b9818758bb9839">STOP_NONE</a>;
<a name="l05435"></a>05435   retval.<a class="code" href="structbpstat__what.html#a65c9c9055d1a90775a7f25781a7555ab">is_longjmp</a> = 0;
<a name="l05436"></a>05436 
<a name="l05437"></a>05437   <span class="keywordflow">for</span> (bs = bs_head; bs != NULL; bs = bs-&gt;<a class="code" href="structbpstats.html#a48ed65e040defb4d45e1cea1a8414d6c">next</a>)
<a name="l05438"></a>05438     {
<a name="l05439"></a>05439       <span class="comment">/* Extract this BS&#39;s action.  After processing each BS, we check</span>
<a name="l05440"></a>05440 <span class="comment">         if its action overrides all we&#39;ve seem so far.  */</span>
<a name="l05441"></a>05441       <span class="keyword">enum</span> <a class="code" href="breakpoint_8h.html#a2e9c7b10df5e9872d2c2db186b9efc25">bpstat_what_main_action</a> this_action = <a class="code" href="breakpoint_8h.html#a2e9c7b10df5e9872d2c2db186b9efc25ae143d13d08883bcadf96124e472b71c8">BPSTAT_WHAT_KEEP_CHECKING</a>;
<a name="l05442"></a>05442       <span class="keyword">enum</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cf">bptype</a> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cf">bptype</a>;
<a name="l05443"></a>05443 
<a name="l05444"></a>05444       <span class="keywordflow">if</span> (bs-&gt;<a class="code" href="structbpstats.html#ac105ed7263dd10f9d65e92e706b04e39">breakpoint_at</a> == NULL)
<a name="l05445"></a>05445         {
<a name="l05446"></a>05446           <span class="comment">/* I suspect this can happen if it was a momentary</span>
<a name="l05447"></a>05447 <span class="comment">             breakpoint which has since been deleted.  */</span>
<a name="l05448"></a>05448           bptype = <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfac0517cbb17f625d6cf900fb3aa64636e">bp_none</a>;
<a name="l05449"></a>05449         }
<a name="l05450"></a>05450       <span class="keywordflow">else</span>
<a name="l05451"></a>05451         bptype = bs-&gt;<a class="code" href="structbpstats.html#ac105ed7263dd10f9d65e92e706b04e39">breakpoint_at</a>-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a>;
<a name="l05452"></a>05452 
<a name="l05453"></a>05453       <span class="keywordflow">switch</span> (bptype)
<a name="l05454"></a>05454         {
<a name="l05455"></a>05455         <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfac0517cbb17f625d6cf900fb3aa64636e">bp_none</a>:
<a name="l05456"></a>05456           <span class="keywordflow">break</span>;
<a name="l05457"></a>05457         <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa17768c2bd9137ec6e30c922c5c1d0ffa">bp_breakpoint</a>:
<a name="l05458"></a>05458         <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa657fad68a9d83a24532fb06715b77628">bp_hardware_breakpoint</a>:
<a name="l05459"></a>05459         <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa8e5fb22bf54672648756e2431a7827b6">bp_until</a>:
<a name="l05460"></a>05460         <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa86f9369de92fbd10422ccc3d4ea68a20">bp_finish</a>:
<a name="l05461"></a>05461         <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa7ff3ee755a0635e1c8aa45bbeba6734a">bp_shlib_event</a>:
<a name="l05462"></a>05462           <span class="keywordflow">if</span> (bs-&gt;<a class="code" href="structbpstats.html#acff86901962f7bc070661b85248c4652">stop</a>)
<a name="l05463"></a>05463             {
<a name="l05464"></a>05464               <span class="keywordflow">if</span> (bs-&gt;<a class="code" href="structbpstats.html#a2248119ffe4efcc99d08f4ffb562b54b">print</a>)
<a name="l05465"></a>05465                 this_action = <a class="code" href="breakpoint_8h.html#a2e9c7b10df5e9872d2c2db186b9efc25a070396d869adc873239a72d685c33506">BPSTAT_WHAT_STOP_NOISY</a>;
<a name="l05466"></a>05466               <span class="keywordflow">else</span>
<a name="l05467"></a>05467                 this_action = <a class="code" href="breakpoint_8h.html#a2e9c7b10df5e9872d2c2db186b9efc25a271ade756e68c009c692e059dfcd8cd6">BPSTAT_WHAT_STOP_SILENT</a>;
<a name="l05468"></a>05468             }
<a name="l05469"></a>05469           <span class="keywordflow">else</span>
<a name="l05470"></a>05470             this_action = <a class="code" href="breakpoint_8h.html#a2e9c7b10df5e9872d2c2db186b9efc25a2915c3a19cccac577cc12019404de1be">BPSTAT_WHAT_SINGLE</a>;
<a name="l05471"></a>05471           <span class="keywordflow">break</span>;
<a name="l05472"></a>05472         <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa2a35cc5d65b66d6228def5615d6827ce">bp_watchpoint</a>:
<a name="l05473"></a>05473         <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfae38a33f5a6725fbca8b5da2d491cfbcb">bp_hardware_watchpoint</a>:
<a name="l05474"></a>05474         <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa7013ee22be60f470b10b2de2f9d22c21">bp_read_watchpoint</a>:
<a name="l05475"></a>05475         <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa9148c330e0f813ed6fb421af9d7da820">bp_access_watchpoint</a>:
<a name="l05476"></a>05476           <span class="keywordflow">if</span> (bs-&gt;<a class="code" href="structbpstats.html#acff86901962f7bc070661b85248c4652">stop</a>)
<a name="l05477"></a>05477             {
<a name="l05478"></a>05478               <span class="keywordflow">if</span> (bs-&gt;<a class="code" href="structbpstats.html#a2248119ffe4efcc99d08f4ffb562b54b">print</a>)
<a name="l05479"></a>05479                 this_action = <a class="code" href="breakpoint_8h.html#a2e9c7b10df5e9872d2c2db186b9efc25a070396d869adc873239a72d685c33506">BPSTAT_WHAT_STOP_NOISY</a>;
<a name="l05480"></a>05480               <span class="keywordflow">else</span>
<a name="l05481"></a>05481                 this_action = <a class="code" href="breakpoint_8h.html#a2e9c7b10df5e9872d2c2db186b9efc25a271ade756e68c009c692e059dfcd8cd6">BPSTAT_WHAT_STOP_SILENT</a>;
<a name="l05482"></a>05482             }
<a name="l05483"></a>05483           <span class="keywordflow">else</span>
<a name="l05484"></a>05484             {
<a name="l05485"></a>05485               <span class="comment">/* There was a watchpoint, but we&#39;re not stopping.</span>
<a name="l05486"></a>05486 <span class="comment">                 This requires no further action.  */</span>
<a name="l05487"></a>05487             }
<a name="l05488"></a>05488           <span class="keywordflow">break</span>;
<a name="l05489"></a>05489         <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa4ca499075e7b45a6ff9b546b71860124">bp_longjmp</a>:
<a name="l05490"></a>05490         <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa2bc2f9a597a0b3730d45e715048f76d3">bp_longjmp_call_dummy</a>:
<a name="l05491"></a>05491         <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfae83abf56e7e24d4c7b7c63e78dc3e270">bp_exception</a>:
<a name="l05492"></a>05492           this_action = <a class="code" href="breakpoint_8h.html#a2e9c7b10df5e9872d2c2db186b9efc25a894fd275a601e24749a7872f6d460119">BPSTAT_WHAT_SET_LONGJMP_RESUME</a>;
<a name="l05493"></a>05493           retval.<a class="code" href="structbpstat__what.html#a65c9c9055d1a90775a7f25781a7555ab">is_longjmp</a> = bptype != <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfae83abf56e7e24d4c7b7c63e78dc3e270">bp_exception</a>;
<a name="l05494"></a>05494           <span class="keywordflow">break</span>;
<a name="l05495"></a>05495         <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfad27e062da5217e29ab1a859e41946669">bp_longjmp_resume</a>:
<a name="l05496"></a>05496         <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa190706cc3be7f60fa934d8aa83f533de">bp_exception_resume</a>:
<a name="l05497"></a>05497           this_action = <a class="code" href="breakpoint_8h.html#a2e9c7b10df5e9872d2c2db186b9efc25a1c8b2b31216c831f627f735227fd6f7e">BPSTAT_WHAT_CLEAR_LONGJMP_RESUME</a>;
<a name="l05498"></a>05498           retval.<a class="code" href="structbpstat__what.html#a65c9c9055d1a90775a7f25781a7555ab">is_longjmp</a> = bptype == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfad27e062da5217e29ab1a859e41946669">bp_longjmp_resume</a>;
<a name="l05499"></a>05499           <span class="keywordflow">break</span>;
<a name="l05500"></a>05500         <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa47c0a1a603215fb93c5db2cbb15e1edc">bp_step_resume</a>:
<a name="l05501"></a>05501           <span class="keywordflow">if</span> (bs-&gt;<a class="code" href="structbpstats.html#acff86901962f7bc070661b85248c4652">stop</a>)
<a name="l05502"></a>05502             this_action = <a class="code" href="breakpoint_8h.html#a2e9c7b10df5e9872d2c2db186b9efc25abf52106c0daa9ef112b283e0ab45150d">BPSTAT_WHAT_STEP_RESUME</a>;
<a name="l05503"></a>05503           <span class="keywordflow">else</span>
<a name="l05504"></a>05504             {
<a name="l05505"></a>05505               <span class="comment">/* It is for the wrong frame.  */</span>
<a name="l05506"></a>05506               this_action = <a class="code" href="breakpoint_8h.html#a2e9c7b10df5e9872d2c2db186b9efc25a2915c3a19cccac577cc12019404de1be">BPSTAT_WHAT_SINGLE</a>;
<a name="l05507"></a>05507             }
<a name="l05508"></a>05508           <span class="keywordflow">break</span>;
<a name="l05509"></a>05509         <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfacb66952952620a78cd9e0f6c84078395">bp_hp_step_resume</a>:
<a name="l05510"></a>05510           <span class="keywordflow">if</span> (bs-&gt;<a class="code" href="structbpstats.html#acff86901962f7bc070661b85248c4652">stop</a>)
<a name="l05511"></a>05511             this_action = <a class="code" href="breakpoint_8h.html#a2e9c7b10df5e9872d2c2db186b9efc25aa3da2c14459d6ab506f6494bed3dfc4e">BPSTAT_WHAT_HP_STEP_RESUME</a>;
<a name="l05512"></a>05512           <span class="keywordflow">else</span>
<a name="l05513"></a>05513             {
<a name="l05514"></a>05514               <span class="comment">/* It is for the wrong frame.  */</span>
<a name="l05515"></a>05515               this_action = <a class="code" href="breakpoint_8h.html#a2e9c7b10df5e9872d2c2db186b9efc25a2915c3a19cccac577cc12019404de1be">BPSTAT_WHAT_SINGLE</a>;
<a name="l05516"></a>05516             }
<a name="l05517"></a>05517           <span class="keywordflow">break</span>;
<a name="l05518"></a>05518         <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfad6bfd2f2654949462085c78f02480366">bp_watchpoint_scope</a>:
<a name="l05519"></a>05519         <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa363ddd674339fdbb98fc4b0525905172">bp_thread_event</a>:
<a name="l05520"></a>05520         <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa5bd9bbdb42933350595475584c48d844">bp_overlay_event</a>:
<a name="l05521"></a>05521         <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfad159b4f5b0a64a88067c3d310ebed7ce">bp_longjmp_master</a>:
<a name="l05522"></a>05522         <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa0d6052d15a11c79e0c6703aeef4148ba">bp_std_terminate_master</a>:
<a name="l05523"></a>05523         <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa6d04f06608676691bf5f211117427b48">bp_exception_master</a>:
<a name="l05524"></a>05524           this_action = <a class="code" href="breakpoint_8h.html#a2e9c7b10df5e9872d2c2db186b9efc25a2915c3a19cccac577cc12019404de1be">BPSTAT_WHAT_SINGLE</a>;
<a name="l05525"></a>05525           <span class="keywordflow">break</span>;
<a name="l05526"></a>05526         <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa8ebb961cef940b8ddef84696b7ac9694">bp_catchpoint</a>:
<a name="l05527"></a>05527           <span class="keywordflow">if</span> (bs-&gt;<a class="code" href="structbpstats.html#acff86901962f7bc070661b85248c4652">stop</a>)
<a name="l05528"></a>05528             {
<a name="l05529"></a>05529               <span class="keywordflow">if</span> (bs-&gt;<a class="code" href="structbpstats.html#a2248119ffe4efcc99d08f4ffb562b54b">print</a>)
<a name="l05530"></a>05530                 this_action = <a class="code" href="breakpoint_8h.html#a2e9c7b10df5e9872d2c2db186b9efc25a070396d869adc873239a72d685c33506">BPSTAT_WHAT_STOP_NOISY</a>;
<a name="l05531"></a>05531               <span class="keywordflow">else</span>
<a name="l05532"></a>05532                 this_action = <a class="code" href="breakpoint_8h.html#a2e9c7b10df5e9872d2c2db186b9efc25a271ade756e68c009c692e059dfcd8cd6">BPSTAT_WHAT_STOP_SILENT</a>;
<a name="l05533"></a>05533             }
<a name="l05534"></a>05534           <span class="keywordflow">else</span>
<a name="l05535"></a>05535             {
<a name="l05536"></a>05536               <span class="comment">/* There was a catchpoint, but we&#39;re not stopping.</span>
<a name="l05537"></a>05537 <span class="comment">                 This requires no further action.  */</span>
<a name="l05538"></a>05538             }
<a name="l05539"></a>05539           <span class="keywordflow">break</span>;
<a name="l05540"></a>05540         <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfaa189ad5fdf786f2921ba9635bdb926fe">bp_jit_event</a>:
<a name="l05541"></a>05541           jit_event = 1;
<a name="l05542"></a>05542           this_action = <a class="code" href="breakpoint_8h.html#a2e9c7b10df5e9872d2c2db186b9efc25a2915c3a19cccac577cc12019404de1be">BPSTAT_WHAT_SINGLE</a>;
<a name="l05543"></a>05543           <span class="keywordflow">break</span>;
<a name="l05544"></a>05544         <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa9ea01014e7cd4e2bb4ed925696cc0e8d">bp_call_dummy</a>:
<a name="l05545"></a>05545           <span class="comment">/* Make sure the action is stop (silent or noisy),</span>
<a name="l05546"></a>05546 <span class="comment">             so infrun.c pops the dummy frame.  */</span>
<a name="l05547"></a>05547           retval.<a class="code" href="structbpstat__what.html#a92e25121e1fe8142717dd678386864b1">call_dummy</a> = <a class="code" href="breakpoint_8h.html#ada6fea43093a8775a805ff2bc372c6feacc1ff49d57278c9adcaf79250f0ea2cc">STOP_STACK_DUMMY</a>;
<a name="l05548"></a>05548           this_action = <a class="code" href="breakpoint_8h.html#a2e9c7b10df5e9872d2c2db186b9efc25a271ade756e68c009c692e059dfcd8cd6">BPSTAT_WHAT_STOP_SILENT</a>;
<a name="l05549"></a>05549           <span class="keywordflow">break</span>;
<a name="l05550"></a>05550         <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa84b6ba381a94da7c15136d8dcc87c5f2">bp_std_terminate</a>:
<a name="l05551"></a>05551           <span class="comment">/* Make sure the action is stop (silent or noisy),</span>
<a name="l05552"></a>05552 <span class="comment">             so infrun.c pops the dummy frame.  */</span>
<a name="l05553"></a>05553           retval.<a class="code" href="structbpstat__what.html#a92e25121e1fe8142717dd678386864b1">call_dummy</a> = <a class="code" href="breakpoint_8h.html#ada6fea43093a8775a805ff2bc372c6fea934702a18ca431be771120779576b59d">STOP_STD_TERMINATE</a>;
<a name="l05554"></a>05554           this_action = <a class="code" href="breakpoint_8h.html#a2e9c7b10df5e9872d2c2db186b9efc25a271ade756e68c009c692e059dfcd8cd6">BPSTAT_WHAT_STOP_SILENT</a>;
<a name="l05555"></a>05555           <span class="keywordflow">break</span>;
<a name="l05556"></a>05556         <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfae87f3c5422e7ecec815f5cb7254b4b4c">bp_tracepoint</a>:
<a name="l05557"></a>05557         <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa563d27bd02a1303a86081828b40002db">bp_fast_tracepoint</a>:
<a name="l05558"></a>05558         <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfae4357544e8e764b68ef3729aa9ac2be3">bp_static_tracepoint</a>:
<a name="l05559"></a>05559           <span class="comment">/* Tracepoint hits should not be reported back to GDB, and</span>
<a name="l05560"></a>05560 <span class="comment">             if one got through somehow, it should have been filtered</span>
<a name="l05561"></a>05561 <span class="comment">             out already.  */</span>
<a name="l05562"></a>05562           <a class="code" href="common-utils_8h.html#aa14285d9d3d4171016ef9cf09447e8bb">internal_error</a> (__FILE__, __LINE__,
<a name="l05563"></a>05563                           <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;bpstat_what: tracepoint encountered&quot;</span>));
<a name="l05564"></a>05564           <span class="keywordflow">break</span>;
<a name="l05565"></a>05565         <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfaa264cea9a07a1fbe63f2047913425831">bp_gnu_ifunc_resolver</a>:
<a name="l05566"></a>05566           <span class="comment">/* Step over it (and insert bp_gnu_ifunc_resolver_return).  */</span>
<a name="l05567"></a>05567           this_action = <a class="code" href="breakpoint_8h.html#a2e9c7b10df5e9872d2c2db186b9efc25a2915c3a19cccac577cc12019404de1be">BPSTAT_WHAT_SINGLE</a>;
<a name="l05568"></a>05568           <span class="keywordflow">break</span>;
<a name="l05569"></a>05569         <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa0c1132c466edadde3a01fe7ef5334ca2">bp_gnu_ifunc_resolver_return</a>:
<a name="l05570"></a>05570           <span class="comment">/* The breakpoint will be removed, execution will restart from the</span>
<a name="l05571"></a>05571 <span class="comment">             PC of the former breakpoint.  */</span>
<a name="l05572"></a>05572           this_action = <a class="code" href="breakpoint_8h.html#a2e9c7b10df5e9872d2c2db186b9efc25ae143d13d08883bcadf96124e472b71c8">BPSTAT_WHAT_KEEP_CHECKING</a>;
<a name="l05573"></a>05573           <span class="keywordflow">break</span>;
<a name="l05574"></a>05574 
<a name="l05575"></a>05575         <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa404b00503edb7eba238aea705ea34231">bp_dprintf</a>:
<a name="l05576"></a>05576           <span class="keywordflow">if</span> (bs-&gt;<a class="code" href="structbpstats.html#acff86901962f7bc070661b85248c4652">stop</a>)
<a name="l05577"></a>05577             this_action = <a class="code" href="breakpoint_8h.html#a2e9c7b10df5e9872d2c2db186b9efc25a271ade756e68c009c692e059dfcd8cd6">BPSTAT_WHAT_STOP_SILENT</a>;
<a name="l05578"></a>05578           <span class="keywordflow">else</span>
<a name="l05579"></a>05579             this_action = <a class="code" href="breakpoint_8h.html#a2e9c7b10df5e9872d2c2db186b9efc25a2915c3a19cccac577cc12019404de1be">BPSTAT_WHAT_SINGLE</a>;
<a name="l05580"></a>05580           <span class="keywordflow">break</span>;
<a name="l05581"></a>05581 
<a name="l05582"></a>05582         <span class="keywordflow">default</span>:
<a name="l05583"></a>05583           <a class="code" href="common-utils_8h.html#aa14285d9d3d4171016ef9cf09447e8bb">internal_error</a> (__FILE__, __LINE__,
<a name="l05584"></a>05584                           <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;bpstat_what: unhandled bptype %d&quot;</span>), (<span class="keywordtype">int</span>) bptype);
<a name="l05585"></a>05585         }
<a name="l05586"></a>05586 
<a name="l05587"></a>05587       retval.<a class="code" href="structbpstat__what.html#af9f9756d2ff9c6bc5e2ba9d62fb6bb62">main_action</a> = <a class="code" href="environ_8c.html#affe776513b24d84b39af8ab0930fef7f">max</a> (retval.<a class="code" href="structbpstat__what.html#af9f9756d2ff9c6bc5e2ba9d62fb6bb62">main_action</a>, this_action);
<a name="l05588"></a>05588     }
<a name="l05589"></a>05589 
<a name="l05590"></a>05590   <span class="comment">/* These operations may affect the bs-&gt;breakpoint_at state so they are</span>
<a name="l05591"></a>05591 <span class="comment">     delayed after MAIN_ACTION is decided above.  */</span>
<a name="l05592"></a>05592 
<a name="l05593"></a>05593   <span class="keywordflow">if</span> (jit_event)
<a name="l05594"></a>05594     {
<a name="l05595"></a>05595       <span class="keywordflow">if</span> (<a class="code" href="inferior_8h.html#a80deba5f72e1e4028c5ede41a2ba2a09">debug_infrun</a>)
<a name="l05596"></a>05596         <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (<a class="code" href="main_8c.html#a097b10b28c07237b554c73fbf42a8e9e">gdb_stdlog</a>, <span class="stringliteral">&quot;bpstat_what: bp_jit_event\n&quot;</span>);
<a name="l05597"></a>05597 
<a name="l05598"></a>05598       handle_jit_event ();
<a name="l05599"></a>05599     }
<a name="l05600"></a>05600 
<a name="l05601"></a>05601   <span class="keywordflow">for</span> (bs = bs_head; bs != NULL; bs = bs-&gt;<a class="code" href="structbpstats.html#a48ed65e040defb4d45e1cea1a8414d6c">next</a>)
<a name="l05602"></a>05602     {
<a name="l05603"></a>05603       <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b = bs-&gt;<a class="code" href="structbpstats.html#ac105ed7263dd10f9d65e92e706b04e39">breakpoint_at</a>;
<a name="l05604"></a>05604 
<a name="l05605"></a>05605       <span class="keywordflow">if</span> (b == NULL)
<a name="l05606"></a>05606         <span class="keywordflow">continue</span>;
<a name="l05607"></a>05607       <span class="keywordflow">switch</span> (b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a>)
<a name="l05608"></a>05608         {
<a name="l05609"></a>05609         <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfaa264cea9a07a1fbe63f2047913425831">bp_gnu_ifunc_resolver</a>:
<a name="l05610"></a>05610           <a class="code" href="symtab_8h.html#af217e6064df28212febdc6e701e8df23">gnu_ifunc_resolver_stop</a> (b);
<a name="l05611"></a>05611           <span class="keywordflow">break</span>;
<a name="l05612"></a>05612         <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa0c1132c466edadde3a01fe7ef5334ca2">bp_gnu_ifunc_resolver_return</a>:
<a name="l05613"></a>05613           <a class="code" href="symtab_8h.html#a2654e920b9e5122e605f963873f58191">gnu_ifunc_resolver_return_stop</a> (b);
<a name="l05614"></a>05614           <span class="keywordflow">break</span>;
<a name="l05615"></a>05615         }
<a name="l05616"></a>05616     }
<a name="l05617"></a>05617 
<a name="l05618"></a>05618   <span class="keywordflow">return</span> retval;
<a name="l05619"></a>05619 }
<a name="l05620"></a>05620 
<a name="l05621"></a>05621 <span class="comment">/* Nonzero if we should step constantly (e.g. watchpoints on machines</span>
<a name="l05622"></a>05622 <span class="comment">   without hardware support).  This isn&#39;t related to a specific bpstat,</span>
<a name="l05623"></a>05623 <span class="comment">   just to things like whether watchpoints are set.  */</span>
<a name="l05624"></a>05624 
<a name="l05625"></a>05625 <span class="keywordtype">int</span>
<a name="l05626"></a><a class="code" href="breakpoint_8h.html#af4300418ce053ad42d47ebf4149080fe">05626</a> <a class="code" href="breakpoint_8c.html#af4300418ce053ad42d47ebf4149080fe">bpstat_should_step</a> (<span class="keywordtype">void</span>)
<a name="l05627"></a>05627 {
<a name="l05628"></a>05628   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b;
<a name="l05629"></a>05629 
<a name="l05630"></a>05630   <a class="code" href="breakpoint_8c.html#a781d5d3dc50a92364edfbacac3d0c107">ALL_BREAKPOINTS</a> (b)
<a name="l05631"></a>05631     <span class="keywordflow">if</span> (breakpoint_enabled (b) &amp;&amp; b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa2a35cc5d65b66d6228def5615d6827ce">bp_watchpoint</a> &amp;&amp; b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a> != NULL)
<a name="l05632"></a>05632       <span class="keywordflow">return</span> 1;
<a name="l05633"></a>05633   <span class="keywordflow">return</span> 0;
<a name="l05634"></a>05634 }
<a name="l05635"></a>05635 
<a name="l05636"></a>05636 <span class="keywordtype">int</span>
<a name="l05637"></a><a class="code" href="breakpoint_8h.html#a6d5bad5dad2900e87cc89c7408e4e3c6">05637</a> <a class="code" href="breakpoint_8c.html#a1d428f3e104ee3be5b672c3aa3207a47">bpstat_causes_stop</a> (<a class="code" href="structbpstats.html">bpstat</a> bs)
<a name="l05638"></a>05638 {
<a name="l05639"></a>05639   <span class="keywordflow">for</span> (; bs != NULL; bs = bs-&gt;<a class="code" href="structbpstats.html#a48ed65e040defb4d45e1cea1a8414d6c">next</a>)
<a name="l05640"></a>05640     <span class="keywordflow">if</span> (bs-&gt;<a class="code" href="structbpstats.html#acff86901962f7bc070661b85248c4652">stop</a>)
<a name="l05641"></a>05641       <span class="keywordflow">return</span> 1;
<a name="l05642"></a>05642 
<a name="l05643"></a>05643   <span class="keywordflow">return</span> 0;
<a name="l05644"></a>05644 }
<a name="l05645"></a>05645 
<a name="l05646"></a>05646 
<a name="l05647"></a>05647 
<a name="l05648"></a>05648 <span class="comment">/* Compute a string of spaces suitable to indent the next line</span>
<a name="l05649"></a>05649 <span class="comment">   so it starts at the position corresponding to the table column</span>
<a name="l05650"></a>05650 <span class="comment">   named COL_NAME in the currently active table of UIOUT.  */</span>
<a name="l05651"></a>05651 
<a name="l05652"></a>05652 <span class="keyword">static</span> <span class="keywordtype">char</span> *
<a name="l05653"></a>05653 wrap_indent_at_field (<span class="keyword">struct</span> ui_out *uiout, <span class="keyword">const</span> <span class="keywordtype">char</span> *col_name)
<a name="l05654"></a>05654 {
<a name="l05655"></a>05655   <span class="keyword">static</span> <span class="keywordtype">char</span> wrap_indent[80];
<a name="l05656"></a>05656   <span class="keywordtype">int</span> i, total_width, width, align;
<a name="l05657"></a>05657   <span class="keywordtype">char</span> *text;
<a name="l05658"></a>05658 
<a name="l05659"></a>05659   total_width = 0;
<a name="l05660"></a>05660   <span class="keywordflow">for</span> (i = 1; <a class="code" href="ui-out_8c.html#a2f071f12a1a222407d118b267066645d">ui_out_query_field</a> (uiout, i, &amp;width, &amp;align, &amp;text); i++)
<a name="l05661"></a>05661     {
<a name="l05662"></a>05662       <span class="keywordflow">if</span> (strcmp (text, col_name) == 0)
<a name="l05663"></a>05663         {
<a name="l05664"></a>05664           <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (total_width &lt; <span class="keyword">sizeof</span> wrap_indent);
<a name="l05665"></a>05665           <a class="code" href="gdb__string_8h.html#adb03df3679ce1445e801310614624ccb">memset</a> (wrap_indent, <span class="charliteral">&#39; &#39;</span>, total_width);
<a name="l05666"></a>05666           wrap_indent[total_width] = 0;
<a name="l05667"></a>05667 
<a name="l05668"></a>05668           <span class="keywordflow">return</span> wrap_indent;
<a name="l05669"></a>05669         }
<a name="l05670"></a>05670 
<a name="l05671"></a>05671       total_width += width + 1;
<a name="l05672"></a>05672     }
<a name="l05673"></a>05673 
<a name="l05674"></a>05674   <span class="keywordflow">return</span> NULL;
<a name="l05675"></a>05675 }
<a name="l05676"></a>05676 
<a name="l05677"></a>05677 <span class="comment">/* Determine if the locations of this breakpoint will have their conditions</span>
<a name="l05678"></a>05678 <span class="comment">   evaluated by the target, host or a mix of both.  Returns the following:</span>
<a name="l05679"></a>05679 <span class="comment"></span>
<a name="l05680"></a>05680 <span class="comment">    &quot;host&quot;: Host evals condition.</span>
<a name="l05681"></a>05681 <span class="comment">    &quot;host or target&quot;: Host or Target evals condition.</span>
<a name="l05682"></a>05682 <span class="comment">    &quot;target&quot;: Target evals condition.</span>
<a name="l05683"></a>05683 <span class="comment">*/</span>
<a name="l05684"></a>05684 
<a name="l05685"></a>05685 <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *
<a name="l05686"></a>05686 bp_condition_evaluator (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b)
<a name="l05687"></a>05687 {
<a name="l05688"></a>05688   <span class="keyword">struct </span>bp_location *bl;
<a name="l05689"></a>05689   <span class="keywordtype">char</span> host_evals = 0;
<a name="l05690"></a>05690   <span class="keywordtype">char</span> target_evals = 0;
<a name="l05691"></a>05691 
<a name="l05692"></a>05692   <span class="keywordflow">if</span> (!b)
<a name="l05693"></a>05693     <span class="keywordflow">return</span> NULL;
<a name="l05694"></a>05694 
<a name="l05695"></a>05695   <span class="keywordflow">if</span> (!<a class="code" href="breakpoint_8c.html#a5de9005cc5b36d1d327aa9127ea64f9c">is_breakpoint</a> (b))
<a name="l05696"></a>05696     <span class="keywordflow">return</span> NULL;
<a name="l05697"></a>05697 
<a name="l05698"></a>05698   <span class="keywordflow">if</span> (gdb_evaluates_breakpoint_condition_p ()
<a name="l05699"></a>05699       || !<a class="code" href="target_8h.html#a029407c9baebfcab86e0488e2d75a2a0">target_supports_evaluation_of_breakpoint_conditions</a> ())
<a name="l05700"></a>05700     <span class="keywordflow">return</span> condition_evaluation_host;
<a name="l05701"></a>05701 
<a name="l05702"></a>05702   <span class="keywordflow">for</span> (bl = b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>; bl; bl = bl-&gt;<a class="code" href="structbp__location.html#ab193cb38f87fea89105db96d94191541">next</a>)
<a name="l05703"></a>05703     {
<a name="l05704"></a>05704       <span class="keywordflow">if</span> (bl-&gt;<a class="code" href="structbp__location.html#ae8f603085b6974cd8f01aef7a833e6e9">cond_bytecode</a>)
<a name="l05705"></a>05705         target_evals++;
<a name="l05706"></a>05706       <span class="keywordflow">else</span>
<a name="l05707"></a>05707         host_evals++;
<a name="l05708"></a>05708     }
<a name="l05709"></a>05709 
<a name="l05710"></a>05710   <span class="keywordflow">if</span> (host_evals &amp;&amp; target_evals)
<a name="l05711"></a>05711     <span class="keywordflow">return</span> condition_evaluation_both;
<a name="l05712"></a>05712   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (target_evals)
<a name="l05713"></a>05713     <span class="keywordflow">return</span> condition_evaluation_target;
<a name="l05714"></a>05714   <span class="keywordflow">else</span>
<a name="l05715"></a>05715     <span class="keywordflow">return</span> condition_evaluation_host;
<a name="l05716"></a>05716 }
<a name="l05717"></a>05717 
<a name="l05718"></a>05718 <span class="comment">/* Determine the breakpoint location&#39;s condition evaluator.  This is</span>
<a name="l05719"></a>05719 <span class="comment">   similar to bp_condition_evaluator, but for locations.  */</span>
<a name="l05720"></a>05720 
<a name="l05721"></a>05721 <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *
<a name="l05722"></a>05722 bp_location_condition_evaluator (<span class="keyword">struct</span> bp_location *bl)
<a name="l05723"></a>05723 {
<a name="l05724"></a>05724   <span class="keywordflow">if</span> (bl &amp;&amp; !<a class="code" href="breakpoint_8c.html#a5de9005cc5b36d1d327aa9127ea64f9c">is_breakpoint</a> (bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>))
<a name="l05725"></a>05725     <span class="keywordflow">return</span> NULL;
<a name="l05726"></a>05726 
<a name="l05727"></a>05727   <span class="keywordflow">if</span> (gdb_evaluates_breakpoint_condition_p ()
<a name="l05728"></a>05728       || !<a class="code" href="target_8h.html#a029407c9baebfcab86e0488e2d75a2a0">target_supports_evaluation_of_breakpoint_conditions</a> ())
<a name="l05729"></a>05729     <span class="keywordflow">return</span> condition_evaluation_host;
<a name="l05730"></a>05730 
<a name="l05731"></a>05731   <span class="keywordflow">if</span> (bl &amp;&amp; bl-&gt;<a class="code" href="structbp__location.html#ae8f603085b6974cd8f01aef7a833e6e9">cond_bytecode</a>)
<a name="l05732"></a>05732     <span class="keywordflow">return</span> condition_evaluation_target;
<a name="l05733"></a>05733   <span class="keywordflow">else</span>
<a name="l05734"></a>05734     <span class="keywordflow">return</span> condition_evaluation_host;
<a name="l05735"></a>05735 }
<a name="l05736"></a>05736 
<a name="l05737"></a>05737 <span class="comment">/* Print the LOC location out of the list of B-&gt;LOC locations.  */</span>
<a name="l05738"></a>05738 
<a name="l05739"></a>05739 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l05740"></a>05740 print_breakpoint_location (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b,
<a name="l05741"></a>05741                            <span class="keyword">struct</span> bp_location *loc)
<a name="l05742"></a>05742 {
<a name="l05743"></a>05743   <span class="keyword">struct </span>ui_out *uiout = <a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>;
<a name="l05744"></a>05744   <span class="keyword">struct </span>cleanup *old_chain = <a class="code" href="progspace_8c.html#a702df4a5aa34e81fc0bb38dd8c2d68df">save_current_program_space</a> ();
<a name="l05745"></a>05745 
<a name="l05746"></a>05746   <span class="keywordflow">if</span> (loc != NULL &amp;&amp; loc-&gt;<a class="code" href="structbp__location.html#a3732b41958ed311106bffd202cbfe4ff">shlib_disabled</a>)
<a name="l05747"></a>05747     loc = NULL;
<a name="l05748"></a>05748 
<a name="l05749"></a>05749   <span class="keywordflow">if</span> (loc != NULL)
<a name="l05750"></a>05750     <a class="code" href="progspace_8c.html#a394457638b3e584a3ecd019df372209f">set_current_program_space</a> (loc-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a>);
<a name="l05751"></a>05751 
<a name="l05752"></a>05752   <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#a115ca3df7d36fa4e3b29b2549cf8c0f1">display_canonical</a>)
<a name="l05753"></a>05753     <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a> (uiout, <span class="stringliteral">&quot;what&quot;</span>, b-&gt;<a class="code" href="structbreakpoint.html#a885e704e5cdcfc314069b970c396d1a4">addr_string</a>);
<a name="l05754"></a>05754   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (loc &amp;&amp; loc-&gt;<a class="code" href="structbp__location.html#a1fbe0229a1e449ad3f855dc443869239">symtab</a>)
<a name="l05755"></a>05755     {
<a name="l05756"></a>05756       <span class="keyword">struct </span><a class="code" href="structsymbol.html">symbol</a> *sym 
<a name="l05757"></a>05757         = <a class="code" href="blockframe_8c.html#a255def7e64445af1e9b15dfaa24b07a5">find_pc_sect_function</a> (loc-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>, loc-&gt;<a class="code" href="structbp__location.html#ac6d8286e46db5c4be6dab9139c43a00d">section</a>);
<a name="l05758"></a>05758       <span class="keywordflow">if</span> (sym)
<a name="l05759"></a>05759         {
<a name="l05760"></a>05760           <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;in &quot;</span>);
<a name="l05761"></a>05761           <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a> (uiout, <span class="stringliteral">&quot;func&quot;</span>,
<a name="l05762"></a>05762                                <a class="code" href="symtab_8h.html#ac7f4cb1648125545fbd0e4f13b0c572c">SYMBOL_PRINT_NAME</a> (sym));
<a name="l05763"></a>05763           <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot; &quot;</span>);
<a name="l05764"></a>05764           <a class="code" href="ui-out_8c.html#a24e0ad942242d807edb27cd3fe6aaa39">ui_out_wrap_hint</a> (uiout, wrap_indent_at_field (uiout, <span class="stringliteral">&quot;what&quot;</span>));
<a name="l05765"></a>05765           <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;at &quot;</span>);
<a name="l05766"></a>05766         }
<a name="l05767"></a>05767       <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a> (uiout, <span class="stringliteral">&quot;file&quot;</span>,
<a name="l05768"></a>05768                            <a class="code" href="source_8c.html#ae251616cab166301d5fed95cbdd31232">symtab_to_filename_for_display</a> (loc-&gt;<a class="code" href="structbp__location.html#a1fbe0229a1e449ad3f855dc443869239">symtab</a>));
<a name="l05769"></a>05769       <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;:&quot;</span>);
<a name="l05770"></a>05770 
<a name="l05771"></a>05771       <span class="keywordflow">if</span> (<a class="code" href="ui-out_8c.html#a473db54efcfbc60feeb5a4f54f27af46">ui_out_is_mi_like_p</a> (uiout))
<a name="l05772"></a>05772         <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a> (uiout, <span class="stringliteral">&quot;fullname&quot;</span>,
<a name="l05773"></a>05773                              <a class="code" href="source_8c.html#aa78177718e9d6c01595600975e8254df">symtab_to_fullname</a> (loc-&gt;<a class="code" href="structbp__location.html#a1fbe0229a1e449ad3f855dc443869239">symtab</a>));
<a name="l05774"></a>05774       
<a name="l05775"></a>05775       <a class="code" href="ui-out_8c.html#aa6f66551d03db456fb94ca1c9038f5a0">ui_out_field_int</a> (uiout, <span class="stringliteral">&quot;line&quot;</span>, loc-&gt;<a class="code" href="structbp__location.html#a47eb96040eebcaabb5ab1e2ea7726d17">line_number</a>);
<a name="l05776"></a>05776     }
<a name="l05777"></a>05777   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (loc)
<a name="l05778"></a>05778     {
<a name="l05779"></a>05779       <span class="keyword">struct </span>ui_file *stb = <a class="code" href="ui-file_8c.html#a340771735f105582d314e191a399a45c">mem_fileopen</a> ();
<a name="l05780"></a>05780       <span class="keyword">struct </span>cleanup *stb_chain = <a class="code" href="utils_8c.html#a94dc56baeb57791e114136764f7763aa">make_cleanup_ui_file_delete</a> (stb);
<a name="l05781"></a>05781 
<a name="l05782"></a>05782       <a class="code" href="defs_8h.html#a8337015171b8b8e4f281dfcecdd510f6">print_address_symbolic</a> (loc-&gt;<a class="code" href="structbp__location.html#a55f3ff99d536775f5095f11e5f5c3f3e">gdbarch</a>, loc-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>, stb,
<a name="l05783"></a>05783                               <a class="code" href="demangle_8c.html#aa87538861e8693c9aad9b2395da84fb8">demangle</a>, <span class="stringliteral">&quot;&quot;</span>);
<a name="l05784"></a>05784       <a class="code" href="ui-out_8c.html#a40106bb0446639417c75a408194a8eee">ui_out_field_stream</a> (uiout, <span class="stringliteral">&quot;at&quot;</span>, stb);
<a name="l05785"></a>05785 
<a name="l05786"></a>05786       <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (stb_chain);
<a name="l05787"></a>05787     }
<a name="l05788"></a>05788   <span class="keywordflow">else</span>
<a name="l05789"></a>05789     <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a> (uiout, <span class="stringliteral">&quot;pending&quot;</span>, b-&gt;<a class="code" href="structbreakpoint.html#a885e704e5cdcfc314069b970c396d1a4">addr_string</a>);
<a name="l05790"></a>05790 
<a name="l05791"></a>05791   <span class="keywordflow">if</span> (loc &amp;&amp; <a class="code" href="breakpoint_8c.html#a5de9005cc5b36d1d327aa9127ea64f9c">is_breakpoint</a> (b)
<a name="l05792"></a>05792       &amp;&amp; breakpoint_condition_evaluation_mode () == condition_evaluation_target
<a name="l05793"></a>05793       &amp;&amp; bp_condition_evaluator (b) == condition_evaluation_both)
<a name="l05794"></a>05794     {
<a name="l05795"></a>05795       <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot; (&quot;</span>);
<a name="l05796"></a>05796       <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a> (uiout, <span class="stringliteral">&quot;evaluated-by&quot;</span>,
<a name="l05797"></a>05797                            bp_location_condition_evaluator (loc));
<a name="l05798"></a>05798       <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;)&quot;</span>);
<a name="l05799"></a>05799     }
<a name="l05800"></a>05800 
<a name="l05801"></a>05801   <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (old_chain);
<a name="l05802"></a>05802 }
<a name="l05803"></a>05803 
<a name="l05804"></a>05804 <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *
<a name="l05805"></a>05805 bptype_string (<span class="keyword">enum</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cf">bptype</a> type)
<a name="l05806"></a>05806 {
<a name="l05807"></a>05807   <span class="keyword">struct </span>ep_type_description
<a name="l05808"></a>05808     {
<a name="l05809"></a>05809       <span class="keyword">enum</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cf">bptype</a> type;
<a name="l05810"></a>05810       <span class="keywordtype">char</span> *description;
<a name="l05811"></a>05811     };
<a name="l05812"></a>05812   <span class="keyword">static</span> <span class="keyword">struct </span>ep_type_description <a class="code" href="gdbtk-bp_8c.html#a706b45aef0277672a32a6fa281fe0631">bptypes</a>[] =
<a name="l05813"></a>05813   {
<a name="l05814"></a>05814     {<a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfac0517cbb17f625d6cf900fb3aa64636e">bp_none</a>, <span class="stringliteral">&quot;?deleted?&quot;</span>},
<a name="l05815"></a>05815     {<a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa17768c2bd9137ec6e30c922c5c1d0ffa">bp_breakpoint</a>, <span class="stringliteral">&quot;breakpoint&quot;</span>},
<a name="l05816"></a>05816     {<a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa657fad68a9d83a24532fb06715b77628">bp_hardware_breakpoint</a>, <span class="stringliteral">&quot;hw breakpoint&quot;</span>},
<a name="l05817"></a>05817     {<a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa8e5fb22bf54672648756e2431a7827b6">bp_until</a>, <span class="stringliteral">&quot;until&quot;</span>},
<a name="l05818"></a>05818     {<a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa86f9369de92fbd10422ccc3d4ea68a20">bp_finish</a>, <span class="stringliteral">&quot;finish&quot;</span>},
<a name="l05819"></a>05819     {<a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa2a35cc5d65b66d6228def5615d6827ce">bp_watchpoint</a>, <span class="stringliteral">&quot;watchpoint&quot;</span>},
<a name="l05820"></a>05820     {<a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfae38a33f5a6725fbca8b5da2d491cfbcb">bp_hardware_watchpoint</a>, <span class="stringliteral">&quot;hw watchpoint&quot;</span>},
<a name="l05821"></a>05821     {<a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa7013ee22be60f470b10b2de2f9d22c21">bp_read_watchpoint</a>, <span class="stringliteral">&quot;read watchpoint&quot;</span>},
<a name="l05822"></a>05822     {<a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa9148c330e0f813ed6fb421af9d7da820">bp_access_watchpoint</a>, <span class="stringliteral">&quot;acc watchpoint&quot;</span>},
<a name="l05823"></a>05823     {<a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa4ca499075e7b45a6ff9b546b71860124">bp_longjmp</a>, <span class="stringliteral">&quot;longjmp&quot;</span>},
<a name="l05824"></a>05824     {<a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfad27e062da5217e29ab1a859e41946669">bp_longjmp_resume</a>, <span class="stringliteral">&quot;longjmp resume&quot;</span>},
<a name="l05825"></a>05825     {<a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa2bc2f9a597a0b3730d45e715048f76d3">bp_longjmp_call_dummy</a>, <span class="stringliteral">&quot;longjmp for call dummy&quot;</span>},
<a name="l05826"></a>05826     {<a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfae83abf56e7e24d4c7b7c63e78dc3e270">bp_exception</a>, <span class="stringliteral">&quot;exception&quot;</span>},
<a name="l05827"></a>05827     {<a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa190706cc3be7f60fa934d8aa83f533de">bp_exception_resume</a>, <span class="stringliteral">&quot;exception resume&quot;</span>},
<a name="l05828"></a>05828     {<a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa47c0a1a603215fb93c5db2cbb15e1edc">bp_step_resume</a>, <span class="stringliteral">&quot;step resume&quot;</span>},
<a name="l05829"></a>05829     {<a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfacb66952952620a78cd9e0f6c84078395">bp_hp_step_resume</a>, <span class="stringliteral">&quot;high-priority step resume&quot;</span>},
<a name="l05830"></a>05830     {<a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfad6bfd2f2654949462085c78f02480366">bp_watchpoint_scope</a>, <span class="stringliteral">&quot;watchpoint scope&quot;</span>},
<a name="l05831"></a>05831     {<a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa9ea01014e7cd4e2bb4ed925696cc0e8d">bp_call_dummy</a>, <span class="stringliteral">&quot;call dummy&quot;</span>},
<a name="l05832"></a>05832     {<a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa84b6ba381a94da7c15136d8dcc87c5f2">bp_std_terminate</a>, <span class="stringliteral">&quot;std::terminate&quot;</span>},
<a name="l05833"></a>05833     {<a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa7ff3ee755a0635e1c8aa45bbeba6734a">bp_shlib_event</a>, <span class="stringliteral">&quot;shlib events&quot;</span>},
<a name="l05834"></a>05834     {<a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa363ddd674339fdbb98fc4b0525905172">bp_thread_event</a>, <span class="stringliteral">&quot;thread events&quot;</span>},
<a name="l05835"></a>05835     {<a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa5bd9bbdb42933350595475584c48d844">bp_overlay_event</a>, <span class="stringliteral">&quot;overlay events&quot;</span>},
<a name="l05836"></a>05836     {<a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfad159b4f5b0a64a88067c3d310ebed7ce">bp_longjmp_master</a>, <span class="stringliteral">&quot;longjmp master&quot;</span>},
<a name="l05837"></a>05837     {<a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa0d6052d15a11c79e0c6703aeef4148ba">bp_std_terminate_master</a>, <span class="stringliteral">&quot;std::terminate master&quot;</span>},
<a name="l05838"></a>05838     {<a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa6d04f06608676691bf5f211117427b48">bp_exception_master</a>, <span class="stringliteral">&quot;exception master&quot;</span>},
<a name="l05839"></a>05839     {<a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa8ebb961cef940b8ddef84696b7ac9694">bp_catchpoint</a>, <span class="stringliteral">&quot;catchpoint&quot;</span>},
<a name="l05840"></a>05840     {<a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfae87f3c5422e7ecec815f5cb7254b4b4c">bp_tracepoint</a>, <span class="stringliteral">&quot;tracepoint&quot;</span>},
<a name="l05841"></a>05841     {<a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa563d27bd02a1303a86081828b40002db">bp_fast_tracepoint</a>, <span class="stringliteral">&quot;fast tracepoint&quot;</span>},
<a name="l05842"></a>05842     {<a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfae4357544e8e764b68ef3729aa9ac2be3">bp_static_tracepoint</a>, <span class="stringliteral">&quot;static tracepoint&quot;</span>},
<a name="l05843"></a>05843     {<a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa404b00503edb7eba238aea705ea34231">bp_dprintf</a>, <span class="stringliteral">&quot;dprintf&quot;</span>},
<a name="l05844"></a>05844     {<a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfaa189ad5fdf786f2921ba9635bdb926fe">bp_jit_event</a>, <span class="stringliteral">&quot;jit events&quot;</span>},
<a name="l05845"></a>05845     {<a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfaa264cea9a07a1fbe63f2047913425831">bp_gnu_ifunc_resolver</a>, <span class="stringliteral">&quot;STT_GNU_IFUNC resolver&quot;</span>},
<a name="l05846"></a>05846     {<a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa0c1132c466edadde3a01fe7ef5334ca2">bp_gnu_ifunc_resolver_return</a>, <span class="stringliteral">&quot;STT_GNU_IFUNC resolver return&quot;</span>},
<a name="l05847"></a>05847   };
<a name="l05848"></a>05848 
<a name="l05849"></a>05849   <span class="keywordflow">if</span> (((<span class="keywordtype">int</span>) type &gt;= (<span class="keyword">sizeof</span> (bptypes) / <span class="keyword">sizeof</span> (bptypes[0])))
<a name="l05850"></a>05850       || ((<span class="keywordtype">int</span>) type != bptypes[(<span class="keywordtype">int</span>) type].type))
<a name="l05851"></a>05851     <a class="code" href="common-utils_8h.html#aa14285d9d3d4171016ef9cf09447e8bb">internal_error</a> (__FILE__, __LINE__,
<a name="l05852"></a>05852                     <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;bptypes table does not describe type #%d.&quot;</span>),
<a name="l05853"></a>05853                     (<span class="keywordtype">int</span>) type);
<a name="l05854"></a>05854 
<a name="l05855"></a>05855   <span class="keywordflow">return</span> bptypes[(<a class="code" href="command_8h.html#a74f207b5aa4ba51c3a2ad59b219a423b">int</a>) type].description;
<a name="l05856"></a>05856 }
<a name="l05857"></a>05857 
<a name="l05858"></a>05858 <span class="comment">/* For MI, output a field named &#39;thread-groups&#39; with a list as the value.</span>
<a name="l05859"></a>05859 <span class="comment">   For CLI, prefix the list with the string &#39;inf&#39;. */</span>
<a name="l05860"></a>05860 
<a name="l05861"></a>05861 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l05862"></a>05862 output_thread_groups (<span class="keyword">struct</span> ui_out *uiout,
<a name="l05863"></a>05863                       <span class="keyword">const</span> <span class="keywordtype">char</span> *field_name,
<a name="l05864"></a>05864                       <a class="code" href="vec_8h.html#ab084f6f29fcf16a6b15d15feb653d414">VEC</a>(<span class="keywordtype">int</span>) *inf_num,
<a name="l05865"></a>05865                       <span class="keywordtype">int</span> mi_only)
<a name="l05866"></a>05866 {
<a name="l05867"></a>05867   <span class="keyword">struct </span>cleanup *back_to;
<a name="l05868"></a>05868   <span class="keywordtype">int</span> is_mi = <a class="code" href="ui-out_8c.html#a473db54efcfbc60feeb5a4f54f27af46">ui_out_is_mi_like_p</a> (uiout);
<a name="l05869"></a>05869   <span class="keywordtype">int</span> <a class="code" href="namespacearm-linux.html#aaf6bae53545ee96f24d7ba560ed0a205">inf</a>;
<a name="l05870"></a>05870   <span class="keywordtype">int</span> i;
<a name="l05871"></a>05871 
<a name="l05872"></a>05872   <span class="comment">/* For backward compatibility, don&#39;t display inferiors in CLI unless</span>
<a name="l05873"></a>05873 <span class="comment">     there are several.  Always display them for MI. */</span>
<a name="l05874"></a>05874   <span class="keywordflow">if</span> (!is_mi &amp;&amp; mi_only)
<a name="l05875"></a>05875     <span class="keywordflow">return</span>;
<a name="l05876"></a>05876 
<a name="l05877"></a>05877   back_to = <a class="code" href="ui-out_8c.html#aa6e8e9b18ba11e13617a6c56cbfab08f">make_cleanup_ui_out_list_begin_end</a> (uiout, field_name);
<a name="l05878"></a>05878 
<a name="l05879"></a>05879   <span class="keywordflow">for</span> (i = 0; <a class="code" href="vec_8h.html#ae7795b0c8e65f45eb49aac5ec2c0fa52">VEC_iterate</a> (<span class="keywordtype">int</span>, inf_num, i, inf); ++i)
<a name="l05880"></a>05880     {
<a name="l05881"></a>05881       <span class="keywordflow">if</span> (is_mi)
<a name="l05882"></a>05882         {
<a name="l05883"></a>05883           <span class="keywordtype">char</span> mi_group[10];
<a name="l05884"></a>05884 
<a name="l05885"></a>05885           <a class="code" href="common-utils_8c.html#ad9940337ec98983dae9951c947879fc8">xsnprintf</a> (mi_group, <span class="keyword">sizeof</span> (mi_group), <span class="stringliteral">&quot;i%d&quot;</span>, inf);
<a name="l05886"></a>05886           <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a> (uiout, NULL, mi_group);
<a name="l05887"></a>05887         }
<a name="l05888"></a>05888       <span class="keywordflow">else</span>
<a name="l05889"></a>05889         {
<a name="l05890"></a>05890           <span class="keywordflow">if</span> (i == 0)
<a name="l05891"></a>05891             <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot; inf &quot;</span>);
<a name="l05892"></a>05892           <span class="keywordflow">else</span>
<a name="l05893"></a>05893             <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;, &quot;</span>);
<a name="l05894"></a>05894         
<a name="l05895"></a>05895           <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <a class="code" href="utils_8c.html#a707b1023c85049b17b9d1ca01c58768a">plongest</a> (inf));
<a name="l05896"></a>05896         }
<a name="l05897"></a>05897     }
<a name="l05898"></a>05898 
<a name="l05899"></a>05899   <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (back_to);
<a name="l05900"></a>05900 }
<a name="l05901"></a>05901 
<a name="l05902"></a>05902 <span class="comment">/* Print B to gdb_stdout.  */</span>
<a name="l05903"></a>05903 
<a name="l05904"></a>05904 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l05905"></a>05905 print_one_breakpoint_location (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b,
<a name="l05906"></a>05906                                <span class="keyword">struct</span> bp_location *loc,
<a name="l05907"></a>05907                                <span class="keywordtype">int</span> loc_number,
<a name="l05908"></a>05908                                <span class="keyword">struct</span> bp_location **last_loc,
<a name="l05909"></a>05909                                <span class="keywordtype">int</span> allflag)
<a name="l05910"></a>05910 {
<a name="l05911"></a>05911   <span class="keyword">struct </span><a class="code" href="structcommand__line.html">command_line</a> *l;
<a name="l05912"></a>05912   <span class="keyword">static</span> <span class="keywordtype">char</span> bpenables[] = <span class="stringliteral">&quot;nynny&quot;</span>;
<a name="l05913"></a>05913 
<a name="l05914"></a>05914   <span class="keyword">struct </span>ui_out *uiout = <a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>;
<a name="l05915"></a>05915   <span class="keywordtype">int</span> header_of_multiple = 0;
<a name="l05916"></a>05916   <span class="keywordtype">int</span> part_of_multiple = (loc != NULL);
<a name="l05917"></a>05917   <span class="keyword">struct </span><a class="code" href="structvalue__print__options.html">value_print_options</a> opts;
<a name="l05918"></a>05918 
<a name="l05919"></a>05919   <a class="code" href="valprint_8c.html#aa2d4dfe4b11841ccafc4d0c0d410095d">get_user_print_options</a> (&amp;opts);
<a name="l05920"></a>05920 
<a name="l05921"></a>05921   <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (!loc || loc_number != 0);
<a name="l05922"></a>05922   <span class="comment">/* See comment in print_one_breakpoint concerning treatment of</span>
<a name="l05923"></a>05923 <span class="comment">     breakpoints with single disabled location.  */</span>
<a name="l05924"></a>05924   <span class="keywordflow">if</span> (loc == NULL 
<a name="l05925"></a>05925       &amp;&amp; (b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a> != NULL 
<a name="l05926"></a>05926           &amp;&amp; (b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>-&gt;<a class="code" href="structbp__location.html#ab193cb38f87fea89105db96d94191541">next</a> != NULL || !b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>-&gt;<a class="code" href="structbp__location.html#abe93e091d18373d27bda3ad3eb6316f8">enabled</a>)))
<a name="l05927"></a>05927     header_of_multiple = 1;
<a name="l05928"></a>05928   <span class="keywordflow">if</span> (loc == NULL)
<a name="l05929"></a>05929     loc = b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>;
<a name="l05930"></a>05930 
<a name="l05931"></a>05931   <a class="code" href="annotate_8c.html#a1dce422d47bf473071ecacb69a566419">annotate_record</a> ();
<a name="l05932"></a>05932 
<a name="l05933"></a>05933   <span class="comment">/* 1 */</span>
<a name="l05934"></a>05934   <a class="code" href="annotate_8c.html#a3b961efbc346558aade25e12945835fe">annotate_field</a> (0);
<a name="l05935"></a>05935   <span class="keywordflow">if</span> (part_of_multiple)
<a name="l05936"></a>05936     {
<a name="l05937"></a>05937       <span class="keywordtype">char</span> *formatted;
<a name="l05938"></a>05938       formatted = <a class="code" href="common-utils_8c.html#ab9bf7e1b4e68bdd0078e9e1e55c62cec">xstrprintf</a> (<span class="stringliteral">&quot;%d.%d&quot;</span>, b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>, loc_number);
<a name="l05939"></a>05939       <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a> (uiout, <span class="stringliteral">&quot;number&quot;</span>, formatted);
<a name="l05940"></a>05940       <a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a> (formatted);
<a name="l05941"></a>05941     }
<a name="l05942"></a>05942   <span class="keywordflow">else</span>
<a name="l05943"></a>05943     {
<a name="l05944"></a>05944       <a class="code" href="ui-out_8c.html#aa6f66551d03db456fb94ca1c9038f5a0">ui_out_field_int</a> (uiout, <span class="stringliteral">&quot;number&quot;</span>, b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>);
<a name="l05945"></a>05945     }
<a name="l05946"></a>05946 
<a name="l05947"></a>05947   <span class="comment">/* 2 */</span>
<a name="l05948"></a>05948   <a class="code" href="annotate_8c.html#a3b961efbc346558aade25e12945835fe">annotate_field</a> (1);
<a name="l05949"></a>05949   <span class="keywordflow">if</span> (part_of_multiple)
<a name="l05950"></a>05950     <a class="code" href="ui-out_8c.html#a5366a822858ecedafef54625bec57442">ui_out_field_skip</a> (uiout, <span class="stringliteral">&quot;type&quot;</span>);
<a name="l05951"></a>05951   <span class="keywordflow">else</span>
<a name="l05952"></a>05952     <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a> (uiout, <span class="stringliteral">&quot;type&quot;</span>, bptype_string (b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a>));
<a name="l05953"></a>05953 
<a name="l05954"></a>05954   <span class="comment">/* 3 */</span>
<a name="l05955"></a>05955   <a class="code" href="annotate_8c.html#a3b961efbc346558aade25e12945835fe">annotate_field</a> (2);
<a name="l05956"></a>05956   <span class="keywordflow">if</span> (part_of_multiple)
<a name="l05957"></a>05957     <a class="code" href="ui-out_8c.html#a5366a822858ecedafef54625bec57442">ui_out_field_skip</a> (uiout, <span class="stringliteral">&quot;disp&quot;</span>);
<a name="l05958"></a>05958   <span class="keywordflow">else</span>
<a name="l05959"></a>05959     <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a> (uiout, <span class="stringliteral">&quot;disp&quot;</span>, <a class="code" href="breakpoint_8c.html#a6f45019563f41b3ae4dc92df09f12618">bpdisp_text</a> (b-&gt;<a class="code" href="structbreakpoint.html#a75f0f9a837eac292ab6e768e8d8f1bd7">disposition</a>));
<a name="l05960"></a>05960 
<a name="l05961"></a>05961 
<a name="l05962"></a>05962   <span class="comment">/* 4 */</span>
<a name="l05963"></a>05963   <a class="code" href="annotate_8c.html#a3b961efbc346558aade25e12945835fe">annotate_field</a> (3);
<a name="l05964"></a>05964   <span class="keywordflow">if</span> (part_of_multiple)
<a name="l05965"></a>05965     <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a> (uiout, <span class="stringliteral">&quot;enabled&quot;</span>, loc-&gt;<a class="code" href="structbp__location.html#abe93e091d18373d27bda3ad3eb6316f8">enabled</a> ? <span class="stringliteral">&quot;y&quot;</span> : <span class="stringliteral">&quot;n&quot;</span>);
<a name="l05966"></a>05966   <span class="keywordflow">else</span>
<a name="l05967"></a>05967     <a class="code" href="ui-out_8c.html#ac29596ba86f387928e0d3e6b7385f998">ui_out_field_fmt</a> (uiout, <span class="stringliteral">&quot;enabled&quot;</span>, <span class="stringliteral">&quot;%c&quot;</span>, 
<a name="l05968"></a>05968                       bpenables[(<span class="keywordtype">int</span>) b-&gt;<a class="code" href="structbreakpoint.html#acb53352fd35aaad37054508fabc0f3bf">enable_state</a>]);
<a name="l05969"></a>05969   <a class="code" href="ui-out_8c.html#a2a4b4f5c17e354b68a3486e0e129907b">ui_out_spaces</a> (uiout, 2);
<a name="l05970"></a>05970 
<a name="l05971"></a>05971   
<a name="l05972"></a>05972   <span class="comment">/* 5 and 6 */</span>
<a name="l05973"></a>05973   <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#aba258aa23496f6434aaa1cf8c8dc7ea7">ops</a> != NULL &amp;&amp; b-&gt;<a class="code" href="structbreakpoint.html#aba258aa23496f6434aaa1cf8c8dc7ea7">ops</a>-&gt;<a class="code" href="structbreakpoint__ops.html#a20a11e27ae594ff232488495fd0a0476">print_one</a> != NULL)
<a name="l05974"></a>05974     {
<a name="l05975"></a>05975       <span class="comment">/* Although the print_one can possibly print all locations,</span>
<a name="l05976"></a>05976 <span class="comment">         calling it here is not likely to get any nice result.  So,</span>
<a name="l05977"></a>05977 <span class="comment">         make sure there&#39;s just one location.  */</span>
<a name="l05978"></a>05978       <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a> == NULL || b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>-&gt;<a class="code" href="structbp__location.html#ab193cb38f87fea89105db96d94191541">next</a> == NULL);
<a name="l05979"></a>05979       b-&gt;<a class="code" href="structbreakpoint.html#aba258aa23496f6434aaa1cf8c8dc7ea7">ops</a>-&gt;<a class="code" href="structbreakpoint__ops.html#a20a11e27ae594ff232488495fd0a0476">print_one</a> (b, last_loc);
<a name="l05980"></a>05980     }
<a name="l05981"></a>05981   <span class="keywordflow">else</span>
<a name="l05982"></a>05982     <span class="keywordflow">switch</span> (b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a>)
<a name="l05983"></a>05983       {
<a name="l05984"></a>05984       <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfac0517cbb17f625d6cf900fb3aa64636e">bp_none</a>:
<a name="l05985"></a>05985         <a class="code" href="common-utils_8h.html#aa14285d9d3d4171016ef9cf09447e8bb">internal_error</a> (__FILE__, __LINE__,
<a name="l05986"></a>05986                         <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;print_one_breakpoint: bp_none encountered\n&quot;</span>));
<a name="l05987"></a>05987         <span class="keywordflow">break</span>;
<a name="l05988"></a>05988 
<a name="l05989"></a>05989       <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa2a35cc5d65b66d6228def5615d6827ce">bp_watchpoint</a>:
<a name="l05990"></a>05990       <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfae38a33f5a6725fbca8b5da2d491cfbcb">bp_hardware_watchpoint</a>:
<a name="l05991"></a>05991       <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa7013ee22be60f470b10b2de2f9d22c21">bp_read_watchpoint</a>:
<a name="l05992"></a>05992       <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa9148c330e0f813ed6fb421af9d7da820">bp_access_watchpoint</a>:
<a name="l05993"></a>05993         {
<a name="l05994"></a>05994           <span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *w = (<span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *) b;
<a name="l05995"></a>05995 
<a name="l05996"></a>05996           <span class="comment">/* Field 4, the address, is omitted (which makes the columns</span>
<a name="l05997"></a>05997 <span class="comment">             not line up too nicely with the headers, but the effect</span>
<a name="l05998"></a>05998 <span class="comment">             is relatively readable).  */</span>
<a name="l05999"></a>05999           <span class="keywordflow">if</span> (opts.addressprint)
<a name="l06000"></a>06000             <a class="code" href="ui-out_8c.html#a5366a822858ecedafef54625bec57442">ui_out_field_skip</a> (uiout, <span class="stringliteral">&quot;addr&quot;</span>);
<a name="l06001"></a>06001           <a class="code" href="annotate_8c.html#a3b961efbc346558aade25e12945835fe">annotate_field</a> (5);
<a name="l06002"></a>06002           <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a> (uiout, <span class="stringliteral">&quot;what&quot;</span>, w-&gt;<a class="code" href="structwatchpoint.html#a1464eddbdf2f6d8d6dff4a61097c8dc8">exp_string</a>);
<a name="l06003"></a>06003         }
<a name="l06004"></a>06004         <span class="keywordflow">break</span>;
<a name="l06005"></a>06005 
<a name="l06006"></a>06006       <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa17768c2bd9137ec6e30c922c5c1d0ffa">bp_breakpoint</a>:
<a name="l06007"></a>06007       <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa657fad68a9d83a24532fb06715b77628">bp_hardware_breakpoint</a>:
<a name="l06008"></a>06008       <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa8e5fb22bf54672648756e2431a7827b6">bp_until</a>:
<a name="l06009"></a>06009       <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa86f9369de92fbd10422ccc3d4ea68a20">bp_finish</a>:
<a name="l06010"></a>06010       <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa4ca499075e7b45a6ff9b546b71860124">bp_longjmp</a>:
<a name="l06011"></a>06011       <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfad27e062da5217e29ab1a859e41946669">bp_longjmp_resume</a>:
<a name="l06012"></a>06012       <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa2bc2f9a597a0b3730d45e715048f76d3">bp_longjmp_call_dummy</a>:
<a name="l06013"></a>06013       <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfae83abf56e7e24d4c7b7c63e78dc3e270">bp_exception</a>:
<a name="l06014"></a>06014       <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa190706cc3be7f60fa934d8aa83f533de">bp_exception_resume</a>:
<a name="l06015"></a>06015       <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa47c0a1a603215fb93c5db2cbb15e1edc">bp_step_resume</a>:
<a name="l06016"></a>06016       <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfacb66952952620a78cd9e0f6c84078395">bp_hp_step_resume</a>:
<a name="l06017"></a>06017       <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfad6bfd2f2654949462085c78f02480366">bp_watchpoint_scope</a>:
<a name="l06018"></a>06018       <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa9ea01014e7cd4e2bb4ed925696cc0e8d">bp_call_dummy</a>:
<a name="l06019"></a>06019       <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa84b6ba381a94da7c15136d8dcc87c5f2">bp_std_terminate</a>:
<a name="l06020"></a>06020       <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa7ff3ee755a0635e1c8aa45bbeba6734a">bp_shlib_event</a>:
<a name="l06021"></a>06021       <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa363ddd674339fdbb98fc4b0525905172">bp_thread_event</a>:
<a name="l06022"></a>06022       <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa5bd9bbdb42933350595475584c48d844">bp_overlay_event</a>:
<a name="l06023"></a>06023       <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfad159b4f5b0a64a88067c3d310ebed7ce">bp_longjmp_master</a>:
<a name="l06024"></a>06024       <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa0d6052d15a11c79e0c6703aeef4148ba">bp_std_terminate_master</a>:
<a name="l06025"></a>06025       <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa6d04f06608676691bf5f211117427b48">bp_exception_master</a>:
<a name="l06026"></a>06026       <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfae87f3c5422e7ecec815f5cb7254b4b4c">bp_tracepoint</a>:
<a name="l06027"></a>06027       <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa563d27bd02a1303a86081828b40002db">bp_fast_tracepoint</a>:
<a name="l06028"></a>06028       <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfae4357544e8e764b68ef3729aa9ac2be3">bp_static_tracepoint</a>:
<a name="l06029"></a>06029       <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa404b00503edb7eba238aea705ea34231">bp_dprintf</a>:
<a name="l06030"></a>06030       <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfaa189ad5fdf786f2921ba9635bdb926fe">bp_jit_event</a>:
<a name="l06031"></a>06031       <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfaa264cea9a07a1fbe63f2047913425831">bp_gnu_ifunc_resolver</a>:
<a name="l06032"></a>06032       <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa0c1132c466edadde3a01fe7ef5334ca2">bp_gnu_ifunc_resolver_return</a>:
<a name="l06033"></a>06033         <span class="keywordflow">if</span> (opts.addressprint)
<a name="l06034"></a>06034           {
<a name="l06035"></a>06035             <a class="code" href="annotate_8c.html#a3b961efbc346558aade25e12945835fe">annotate_field</a> (4);
<a name="l06036"></a>06036             <span class="keywordflow">if</span> (header_of_multiple)
<a name="l06037"></a>06037               <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a> (uiout, <span class="stringliteral">&quot;addr&quot;</span>, <span class="stringliteral">&quot;&lt;MULTIPLE&gt;&quot;</span>);
<a name="l06038"></a>06038             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a> == NULL || loc-&gt;<a class="code" href="structbp__location.html#a3732b41958ed311106bffd202cbfe4ff">shlib_disabled</a>)
<a name="l06039"></a>06039               <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a> (uiout, <span class="stringliteral">&quot;addr&quot;</span>, <span class="stringliteral">&quot;&lt;PENDING&gt;&quot;</span>);
<a name="l06040"></a>06040             <span class="keywordflow">else</span>
<a name="l06041"></a>06041               <a class="code" href="ui-out_8c.html#ada85ed653fecf3c2a80027de6f71ef71">ui_out_field_core_addr</a> (uiout, <span class="stringliteral">&quot;addr&quot;</span>,
<a name="l06042"></a>06042                                       loc-&gt;<a class="code" href="structbp__location.html#a55f3ff99d536775f5095f11e5f5c3f3e">gdbarch</a>, loc-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>);
<a name="l06043"></a>06043           }
<a name="l06044"></a>06044         <a class="code" href="annotate_8c.html#a3b961efbc346558aade25e12945835fe">annotate_field</a> (5);
<a name="l06045"></a>06045         <span class="keywordflow">if</span> (!header_of_multiple)
<a name="l06046"></a>06046           print_breakpoint_location (b, loc);
<a name="l06047"></a>06047         <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>)
<a name="l06048"></a>06048           *last_loc = b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>;
<a name="l06049"></a>06049         <span class="keywordflow">break</span>;
<a name="l06050"></a>06050       }
<a name="l06051"></a>06051 
<a name="l06052"></a>06052 
<a name="l06053"></a>06053   <span class="keywordflow">if</span> (loc != NULL &amp;&amp; !header_of_multiple)
<a name="l06054"></a>06054     {
<a name="l06055"></a>06055       <span class="keyword">struct </span><a class="code" href="structinferior.html">inferior</a> *<a class="code" href="namespacearm-linux.html#aaf6bae53545ee96f24d7ba560ed0a205">inf</a>;
<a name="l06056"></a>06056       <a class="code" href="vec_8h.html#ab084f6f29fcf16a6b15d15feb653d414">VEC</a>(<span class="keywordtype">int</span>) *inf_num = NULL;
<a name="l06057"></a>06057       <span class="keywordtype">int</span> mi_only = 1;
<a name="l06058"></a>06058 
<a name="l06059"></a>06059       <a class="code" href="inferior_8h.html#a6dc84b797b8175f2eb2a338b3101fe57">ALL_INFERIORS</a> (inf)
<a name="l06060"></a>06060         {
<a name="l06061"></a>06061           <span class="keywordflow">if</span> (inf-&gt;<a class="code" href="structinferior.html#afc6a557206fd753b89e34bd33e038cfe">pspace</a> == loc-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a>)
<a name="l06062"></a>06062             <a class="code" href="vec_8h.html#a8d090c0524726d00931070e0c438ba3f">VEC_safe_push</a> (<span class="keywordtype">int</span>, inf_num, inf-&gt;<a class="code" href="structinferior.html#af9e2350a56bd124ce14020ccc0c93f9e">num</a>);
<a name="l06063"></a>06063         }
<a name="l06064"></a>06064 
<a name="l06065"></a>06065         <span class="comment">/* For backward compatibility, don&#39;t display inferiors in CLI unless</span>
<a name="l06066"></a>06066 <span class="comment">           there are several.  Always display for MI. */</span>
<a name="l06067"></a>06067         <span class="keywordflow">if</span> (allflag
<a name="l06068"></a>06068             || (!<a class="code" href="gdbarch_8c.html#a5e7deb9f392fcd0f807759896fe00919">gdbarch_has_global_breakpoints</a> (<a class="code" href="gdbarch_8c.html#ad648a33f69abe34e9679744a0c5a0580">target_gdbarch</a> ())
<a name="l06069"></a>06069                 &amp;&amp; (<a class="code" href="progspace_8c.html#a7cfa1b006be40ee79bbe350de3e1a373">number_of_program_spaces</a> () &gt; 1
<a name="l06070"></a>06070                     || <a class="code" href="inferior_8c.html#a60ce085242c02bb9282b958a8f20dcbc">number_of_inferiors</a> () &gt; 1)
<a name="l06071"></a>06071                 <span class="comment">/* LOC is for existing B, it cannot be in</span>
<a name="l06072"></a>06072 <span class="comment">                   moribund_locations and thus having NULL OWNER.  */</span>
<a name="l06073"></a>06073                 &amp;&amp; loc-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> != <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa8ebb961cef940b8ddef84696b7ac9694">bp_catchpoint</a>))
<a name="l06074"></a>06074         mi_only = 0;
<a name="l06075"></a>06075       output_thread_groups (uiout, <span class="stringliteral">&quot;thread-groups&quot;</span>, inf_num, mi_only);
<a name="l06076"></a>06076       <a class="code" href="vec_8h.html#af5724b2bbce65103300279f9abe7f577">VEC_free</a> (<span class="keywordtype">int</span>, inf_num);
<a name="l06077"></a>06077     }
<a name="l06078"></a>06078 
<a name="l06079"></a>06079   <span class="keywordflow">if</span> (!part_of_multiple)
<a name="l06080"></a>06080     {
<a name="l06081"></a>06081       <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#ae8613b6d8cf464f30ea39597be0cc192">thread</a> != -1)
<a name="l06082"></a>06082         {
<a name="l06083"></a>06083           <span class="comment">/* FIXME: This seems to be redundant and lost here; see the</span>
<a name="l06084"></a>06084 <span class="comment">             &quot;stop only in&quot; line a little further down.  */</span>
<a name="l06085"></a>06085           <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot; thread &quot;</span>);
<a name="l06086"></a>06086           <a class="code" href="ui-out_8c.html#aa6f66551d03db456fb94ca1c9038f5a0">ui_out_field_int</a> (uiout, <span class="stringliteral">&quot;thread&quot;</span>, b-&gt;<a class="code" href="structbreakpoint.html#ae8613b6d8cf464f30ea39597be0cc192">thread</a>);
<a name="l06087"></a>06087         }
<a name="l06088"></a>06088       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#a9dc2d2b94cb051b28f86f8780dbad907">task</a> != 0)
<a name="l06089"></a>06089         {
<a name="l06090"></a>06090           <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot; task &quot;</span>);
<a name="l06091"></a>06091           <a class="code" href="ui-out_8c.html#aa6f66551d03db456fb94ca1c9038f5a0">ui_out_field_int</a> (uiout, <span class="stringliteral">&quot;task&quot;</span>, b-&gt;<a class="code" href="structbreakpoint.html#a9dc2d2b94cb051b28f86f8780dbad907">task</a>);
<a name="l06092"></a>06092         }
<a name="l06093"></a>06093     }
<a name="l06094"></a>06094 
<a name="l06095"></a>06095   <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;\n&quot;</span>);
<a name="l06096"></a>06096 
<a name="l06097"></a>06097   <span class="keywordflow">if</span> (!part_of_multiple)
<a name="l06098"></a>06098     b-&gt;<a class="code" href="structbreakpoint.html#aba258aa23496f6434aaa1cf8c8dc7ea7">ops</a>-&gt;<a class="code" href="structbreakpoint__ops.html#ae62b41b11f54d236edaf365bd4aab8ba">print_one_detail</a> (b, uiout);
<a name="l06099"></a>06099 
<a name="l06100"></a>06100   <span class="keywordflow">if</span> (part_of_multiple &amp;&amp; <a class="code" href="frame_8c.html#ad6cfc1ab3a8482a76d8e2862b3fc6542">frame_id_p</a> (b-&gt;<a class="code" href="structbreakpoint.html#af65175451fdfdff660221d724c7c3cae">frame_id</a>))
<a name="l06101"></a>06101     {
<a name="l06102"></a>06102       <a class="code" href="annotate_8c.html#a3b961efbc346558aade25e12945835fe">annotate_field</a> (6);
<a name="l06103"></a>06103       <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;\tstop only in stack frame at &quot;</span>);
<a name="l06104"></a>06104       <span class="comment">/* FIXME: cagney/2002-12-01: Shouldn&#39;t be poking around inside</span>
<a name="l06105"></a>06105 <span class="comment">         the frame ID.  */</span>
<a name="l06106"></a>06106       <a class="code" href="ui-out_8c.html#ada85ed653fecf3c2a80027de6f71ef71">ui_out_field_core_addr</a> (uiout, <span class="stringliteral">&quot;frame&quot;</span>,
<a name="l06107"></a>06107                               b-&gt;<a class="code" href="structbreakpoint.html#aa044541ad4e4e66cf23affcd6d8b1759">gdbarch</a>, b-&gt;<a class="code" href="structbreakpoint.html#af65175451fdfdff660221d724c7c3cae">frame_id</a>.<a class="code" href="structframe__id.html#a1970ff82c21150e4655aad218e7ba582">stack_addr</a>);
<a name="l06108"></a>06108       <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;\n&quot;</span>);
<a name="l06109"></a>06109     }
<a name="l06110"></a>06110   
<a name="l06111"></a>06111   <span class="keywordflow">if</span> (!part_of_multiple &amp;&amp; b-&gt;<a class="code" href="structbreakpoint.html#a817904eee4ded1a9e18ab46709c1245b">cond_string</a>)
<a name="l06112"></a>06112     {
<a name="l06113"></a>06113       <a class="code" href="annotate_8c.html#a3b961efbc346558aade25e12945835fe">annotate_field</a> (7);
<a name="l06114"></a>06114       <span class="keywordflow">if</span> (<a class="code" href="breakpoint_8c.html#ac537492fb781218601862c78225bd118">is_tracepoint</a> (b))
<a name="l06115"></a>06115         <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;\ttrace only if &quot;</span>);
<a name="l06116"></a>06116       <span class="keywordflow">else</span>
<a name="l06117"></a>06117         <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;\tstop only if &quot;</span>);
<a name="l06118"></a>06118       <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a> (uiout, <span class="stringliteral">&quot;cond&quot;</span>, b-&gt;<a class="code" href="structbreakpoint.html#a817904eee4ded1a9e18ab46709c1245b">cond_string</a>);
<a name="l06119"></a>06119 
<a name="l06120"></a>06120       <span class="comment">/* Print whether the target is doing the breakpoint&#39;s condition</span>
<a name="l06121"></a>06121 <span class="comment">         evaluation.  If GDB is doing the evaluation, don&#39;t print anything.  */</span>
<a name="l06122"></a>06122       <span class="keywordflow">if</span> (<a class="code" href="breakpoint_8c.html#a5de9005cc5b36d1d327aa9127ea64f9c">is_breakpoint</a> (b)
<a name="l06123"></a>06123           &amp;&amp; breakpoint_condition_evaluation_mode ()
<a name="l06124"></a>06124           == condition_evaluation_target)
<a name="l06125"></a>06125         {
<a name="l06126"></a>06126           <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot; (&quot;</span>);
<a name="l06127"></a>06127           <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a> (uiout, <span class="stringliteral">&quot;evaluated-by&quot;</span>,
<a name="l06128"></a>06128                                bp_condition_evaluator (b));
<a name="l06129"></a>06129           <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot; evals)&quot;</span>);
<a name="l06130"></a>06130         }
<a name="l06131"></a>06131       <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;\n&quot;</span>);
<a name="l06132"></a>06132     }
<a name="l06133"></a>06133 
<a name="l06134"></a>06134   <span class="keywordflow">if</span> (!part_of_multiple &amp;&amp; b-&gt;<a class="code" href="structbreakpoint.html#ae8613b6d8cf464f30ea39597be0cc192">thread</a> != -1)
<a name="l06135"></a>06135     {
<a name="l06136"></a>06136       <span class="comment">/* FIXME should make an annotation for this.  */</span>
<a name="l06137"></a>06137       <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;\tstop only in thread &quot;</span>);
<a name="l06138"></a>06138       <a class="code" href="ui-out_8c.html#aa6f66551d03db456fb94ca1c9038f5a0">ui_out_field_int</a> (uiout, <span class="stringliteral">&quot;thread&quot;</span>, b-&gt;<a class="code" href="structbreakpoint.html#ae8613b6d8cf464f30ea39597be0cc192">thread</a>);
<a name="l06139"></a>06139       <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;\n&quot;</span>);
<a name="l06140"></a>06140     }
<a name="l06141"></a>06141   
<a name="l06142"></a>06142   <span class="keywordflow">if</span> (!part_of_multiple)
<a name="l06143"></a>06143     {
<a name="l06144"></a>06144       <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#a4431b9e9db0a123962a90e8a82419494">hit_count</a>)
<a name="l06145"></a>06145         {
<a name="l06146"></a>06146           <span class="comment">/* FIXME should make an annotation for this.  */</span>
<a name="l06147"></a>06147           <span class="keywordflow">if</span> (is_catchpoint (b))
<a name="l06148"></a>06148             <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;\tcatchpoint&quot;</span>);
<a name="l06149"></a>06149           <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="breakpoint_8c.html#ac537492fb781218601862c78225bd118">is_tracepoint</a> (b))
<a name="l06150"></a>06150             <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;\ttracepoint&quot;</span>);
<a name="l06151"></a>06151           <span class="keywordflow">else</span>
<a name="l06152"></a>06152             <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;\tbreakpoint&quot;</span>);
<a name="l06153"></a>06153           <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot; already hit &quot;</span>);
<a name="l06154"></a>06154           <a class="code" href="ui-out_8c.html#aa6f66551d03db456fb94ca1c9038f5a0">ui_out_field_int</a> (uiout, <span class="stringliteral">&quot;times&quot;</span>, b-&gt;<a class="code" href="structbreakpoint.html#a4431b9e9db0a123962a90e8a82419494">hit_count</a>);
<a name="l06155"></a>06155           <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#a4431b9e9db0a123962a90e8a82419494">hit_count</a> == 1)
<a name="l06156"></a>06156             <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot; time\n&quot;</span>);
<a name="l06157"></a>06157           <span class="keywordflow">else</span>
<a name="l06158"></a>06158             <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot; times\n&quot;</span>);
<a name="l06159"></a>06159         }
<a name="l06160"></a>06160       <span class="keywordflow">else</span>
<a name="l06161"></a>06161         {
<a name="l06162"></a>06162           <span class="comment">/* Output the count also if it is zero, but only if this is mi.  */</span>
<a name="l06163"></a>06163           <span class="keywordflow">if</span> (<a class="code" href="ui-out_8c.html#a473db54efcfbc60feeb5a4f54f27af46">ui_out_is_mi_like_p</a> (uiout))
<a name="l06164"></a>06164             <a class="code" href="ui-out_8c.html#aa6f66551d03db456fb94ca1c9038f5a0">ui_out_field_int</a> (uiout, <span class="stringliteral">&quot;times&quot;</span>, b-&gt;<a class="code" href="structbreakpoint.html#a4431b9e9db0a123962a90e8a82419494">hit_count</a>);
<a name="l06165"></a>06165         }
<a name="l06166"></a>06166     }
<a name="l06167"></a>06167 
<a name="l06168"></a>06168   <span class="keywordflow">if</span> (!part_of_multiple &amp;&amp; b-&gt;<a class="code" href="structbreakpoint.html#a0e1286b838f13a04031a220f81c04d2d">ignore_count</a>)
<a name="l06169"></a>06169     {
<a name="l06170"></a>06170       <a class="code" href="annotate_8c.html#a3b961efbc346558aade25e12945835fe">annotate_field</a> (8);
<a name="l06171"></a>06171       <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;\tignore next &quot;</span>);
<a name="l06172"></a>06172       <a class="code" href="ui-out_8c.html#aa6f66551d03db456fb94ca1c9038f5a0">ui_out_field_int</a> (uiout, <span class="stringliteral">&quot;ignore&quot;</span>, b-&gt;<a class="code" href="structbreakpoint.html#a0e1286b838f13a04031a220f81c04d2d">ignore_count</a>);
<a name="l06173"></a>06173       <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot; hits\n&quot;</span>);
<a name="l06174"></a>06174     }
<a name="l06175"></a>06175 
<a name="l06176"></a>06176   <span class="comment">/* Note that an enable count of 1 corresponds to &quot;enable once&quot;</span>
<a name="l06177"></a>06177 <span class="comment">     behavior, which is reported by the combination of enablement and</span>
<a name="l06178"></a>06178 <span class="comment">     disposition, so we don&#39;t need to mention it here.  */</span>
<a name="l06179"></a>06179   <span class="keywordflow">if</span> (!part_of_multiple &amp;&amp; b-&gt;<a class="code" href="structbreakpoint.html#a1971955032b554a7b688b6b842cdc393">enable_count</a> &gt; 1)
<a name="l06180"></a>06180     {
<a name="l06181"></a>06181       <a class="code" href="annotate_8c.html#a3b961efbc346558aade25e12945835fe">annotate_field</a> (8);
<a name="l06182"></a>06182       <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;\tdisable after &quot;</span>);
<a name="l06183"></a>06183       <span class="comment">/* Tweak the wording to clarify that ignore and enable counts</span>
<a name="l06184"></a>06184 <span class="comment">         are distinct, and have additive effect.  */</span>
<a name="l06185"></a>06185       <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#a0e1286b838f13a04031a220f81c04d2d">ignore_count</a>)
<a name="l06186"></a>06186         <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;additional &quot;</span>);
<a name="l06187"></a>06187       <span class="keywordflow">else</span>
<a name="l06188"></a>06188         <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;next &quot;</span>);
<a name="l06189"></a>06189       <a class="code" href="ui-out_8c.html#aa6f66551d03db456fb94ca1c9038f5a0">ui_out_field_int</a> (uiout, <span class="stringliteral">&quot;enable&quot;</span>, b-&gt;<a class="code" href="structbreakpoint.html#a1971955032b554a7b688b6b842cdc393">enable_count</a>);
<a name="l06190"></a>06190       <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot; hits\n&quot;</span>);
<a name="l06191"></a>06191     }
<a name="l06192"></a>06192 
<a name="l06193"></a>06193   <span class="keywordflow">if</span> (!part_of_multiple &amp;&amp; <a class="code" href="breakpoint_8c.html#ac537492fb781218601862c78225bd118">is_tracepoint</a> (b))
<a name="l06194"></a>06194     {
<a name="l06195"></a>06195       <span class="keyword">struct </span><a class="code" href="structtracepoint.html">tracepoint</a> *tp = (<span class="keyword">struct </span><a class="code" href="structtracepoint.html">tracepoint</a> *) b;
<a name="l06196"></a>06196 
<a name="l06197"></a>06197       <span class="keywordflow">if</span> (tp-&gt;<a class="code" href="structtracepoint.html#a37aed89a4e99207a4854199a834ca7d3">traceframe_usage</a>)
<a name="l06198"></a>06198         {
<a name="l06199"></a>06199           <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;\ttrace buffer usage &quot;</span>);
<a name="l06200"></a>06200           <a class="code" href="ui-out_8c.html#aa6f66551d03db456fb94ca1c9038f5a0">ui_out_field_int</a> (uiout, <span class="stringliteral">&quot;traceframe-usage&quot;</span>, tp-&gt;<a class="code" href="structtracepoint.html#a37aed89a4e99207a4854199a834ca7d3">traceframe_usage</a>);
<a name="l06201"></a>06201           <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot; bytes\n&quot;</span>);
<a name="l06202"></a>06202         }
<a name="l06203"></a>06203     }
<a name="l06204"></a>06204 
<a name="l06205"></a>06205   l = b-&gt;<a class="code" href="structbreakpoint.html#a054780dffadb1a4af0fc35037834fe4b">commands</a> ? b-&gt;<a class="code" href="structbreakpoint.html#a054780dffadb1a4af0fc35037834fe4b">commands</a>-&gt;commands : NULL;
<a name="l06206"></a>06206   <span class="keywordflow">if</span> (!part_of_multiple &amp;&amp; l)
<a name="l06207"></a>06207     {
<a name="l06208"></a>06208       <span class="keyword">struct </span>cleanup *script_chain;
<a name="l06209"></a>06209 
<a name="l06210"></a>06210       <a class="code" href="annotate_8c.html#a3b961efbc346558aade25e12945835fe">annotate_field</a> (9);
<a name="l06211"></a>06211       script_chain = <a class="code" href="ui-out_8c.html#aaf5a0c991d74ad2e486f420d5c2ff058">make_cleanup_ui_out_tuple_begin_end</a> (uiout, <span class="stringliteral">&quot;script&quot;</span>);
<a name="l06212"></a>06212       <a class="code" href="cli-script_8c.html#ab81cf0813b404cbb43a612bd704698ea">print_command_lines</a> (uiout, l, 4);
<a name="l06213"></a>06213       <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (script_chain);
<a name="l06214"></a>06214     }
<a name="l06215"></a>06215 
<a name="l06216"></a>06216   <span class="keywordflow">if</span> (<a class="code" href="breakpoint_8c.html#ac537492fb781218601862c78225bd118">is_tracepoint</a> (b))
<a name="l06217"></a>06217     {
<a name="l06218"></a>06218       <span class="keyword">struct </span><a class="code" href="structtracepoint.html">tracepoint</a> *t = (<span class="keyword">struct </span><a class="code" href="structtracepoint.html">tracepoint</a> *) b;
<a name="l06219"></a>06219 
<a name="l06220"></a>06220       <span class="keywordflow">if</span> (!part_of_multiple &amp;&amp; t-&gt;<a class="code" href="structtracepoint.html#adaea7cf613860650f86cd9e0ac9cd5f1">pass_count</a>)
<a name="l06221"></a>06221         {
<a name="l06222"></a>06222           <a class="code" href="annotate_8c.html#a3b961efbc346558aade25e12945835fe">annotate_field</a> (10);
<a name="l06223"></a>06223           <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;\tpass count &quot;</span>);
<a name="l06224"></a>06224           <a class="code" href="ui-out_8c.html#aa6f66551d03db456fb94ca1c9038f5a0">ui_out_field_int</a> (uiout, <span class="stringliteral">&quot;pass&quot;</span>, t-&gt;<a class="code" href="structtracepoint.html#adaea7cf613860650f86cd9e0ac9cd5f1">pass_count</a>);
<a name="l06225"></a>06225           <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot; \n&quot;</span>);
<a name="l06226"></a>06226         }
<a name="l06227"></a>06227 
<a name="l06228"></a>06228       <span class="comment">/* Don&#39;t display it when tracepoint or tracepoint location is</span>
<a name="l06229"></a>06229 <span class="comment">         pending.   */</span>
<a name="l06230"></a>06230       <span class="keywordflow">if</span> (!header_of_multiple &amp;&amp; loc != NULL &amp;&amp; !loc-&gt;<a class="code" href="structbp__location.html#a3732b41958ed311106bffd202cbfe4ff">shlib_disabled</a>)
<a name="l06231"></a>06231         {
<a name="l06232"></a>06232           <a class="code" href="annotate_8c.html#a3b961efbc346558aade25e12945835fe">annotate_field</a> (11);
<a name="l06233"></a>06233 
<a name="l06234"></a>06234           <span class="keywordflow">if</span> (<a class="code" href="ui-out_8c.html#a473db54efcfbc60feeb5a4f54f27af46">ui_out_is_mi_like_p</a> (uiout))
<a name="l06235"></a>06235             <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a> (uiout, <span class="stringliteral">&quot;installed&quot;</span>,
<a name="l06236"></a>06236                                  loc-&gt;<a class="code" href="structbp__location.html#acb0b475579bbe5dabeb8ed4504527105">inserted</a> ? <span class="stringliteral">&quot;y&quot;</span> : <span class="stringliteral">&quot;n&quot;</span>);
<a name="l06237"></a>06237           <span class="keywordflow">else</span>
<a name="l06238"></a>06238             {
<a name="l06239"></a>06239               <span class="keywordflow">if</span> (loc-&gt;<a class="code" href="structbp__location.html#acb0b475579bbe5dabeb8ed4504527105">inserted</a>)
<a name="l06240"></a>06240                 <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;\t&quot;</span>);
<a name="l06241"></a>06241               <span class="keywordflow">else</span>
<a name="l06242"></a>06242                 <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;\tnot &quot;</span>);
<a name="l06243"></a>06243               <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;installed on target\n&quot;</span>);
<a name="l06244"></a>06244             }
<a name="l06245"></a>06245         }
<a name="l06246"></a>06246     }
<a name="l06247"></a>06247 
<a name="l06248"></a>06248   <span class="keywordflow">if</span> (<a class="code" href="ui-out_8c.html#a473db54efcfbc60feeb5a4f54f27af46">ui_out_is_mi_like_p</a> (uiout) &amp;&amp; !part_of_multiple)
<a name="l06249"></a>06249     {
<a name="l06250"></a>06250       <span class="keywordflow">if</span> (<a class="code" href="breakpoint_8c.html#a49f0d5ff628dd506db5b81f660eb4610">is_watchpoint</a> (b))
<a name="l06251"></a>06251         {
<a name="l06252"></a>06252           <span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *w = (<span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *) b;
<a name="l06253"></a>06253 
<a name="l06254"></a>06254           <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a> (uiout, <span class="stringliteral">&quot;original-location&quot;</span>, w-&gt;<a class="code" href="structwatchpoint.html#a1464eddbdf2f6d8d6dff4a61097c8dc8">exp_string</a>);
<a name="l06255"></a>06255         }
<a name="l06256"></a>06256       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#a885e704e5cdcfc314069b970c396d1a4">addr_string</a>)
<a name="l06257"></a>06257         <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a> (uiout, <span class="stringliteral">&quot;original-location&quot;</span>, b-&gt;<a class="code" href="structbreakpoint.html#a885e704e5cdcfc314069b970c396d1a4">addr_string</a>);
<a name="l06258"></a>06258     }
<a name="l06259"></a>06259 }
<a name="l06260"></a>06260 
<a name="l06261"></a>06261 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l06262"></a>06262 print_one_breakpoint (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b,
<a name="l06263"></a>06263                       <span class="keyword">struct</span> bp_location **last_loc, 
<a name="l06264"></a>06264                       <span class="keywordtype">int</span> allflag)
<a name="l06265"></a>06265 {
<a name="l06266"></a>06266   <span class="keyword">struct </span>cleanup *bkpt_chain;
<a name="l06267"></a>06267   <span class="keyword">struct </span>ui_out *uiout = <a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>;
<a name="l06268"></a>06268 
<a name="l06269"></a>06269   bkpt_chain = <a class="code" href="ui-out_8c.html#aaf5a0c991d74ad2e486f420d5c2ff058">make_cleanup_ui_out_tuple_begin_end</a> (uiout, <span class="stringliteral">&quot;bkpt&quot;</span>);
<a name="l06270"></a>06270 
<a name="l06271"></a>06271   print_one_breakpoint_location (b, NULL, 0, last_loc, allflag);
<a name="l06272"></a>06272   <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (bkpt_chain);
<a name="l06273"></a>06273 
<a name="l06274"></a>06274   <span class="comment">/* If this breakpoint has custom print function,</span>
<a name="l06275"></a>06275 <span class="comment">     it&#39;s already printed.  Otherwise, print individual</span>
<a name="l06276"></a>06276 <span class="comment">     locations, if any.  */</span>
<a name="l06277"></a>06277   <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#aba258aa23496f6434aaa1cf8c8dc7ea7">ops</a> == NULL || b-&gt;<a class="code" href="structbreakpoint.html#aba258aa23496f6434aaa1cf8c8dc7ea7">ops</a>-&gt;<a class="code" href="structbreakpoint__ops.html#a20a11e27ae594ff232488495fd0a0476">print_one</a> == NULL)
<a name="l06278"></a>06278     {
<a name="l06279"></a>06279       <span class="comment">/* If breakpoint has a single location that is disabled, we</span>
<a name="l06280"></a>06280 <span class="comment">         print it as if it had several locations, since otherwise it&#39;s</span>
<a name="l06281"></a>06281 <span class="comment">         hard to represent &quot;breakpoint enabled, location disabled&quot;</span>
<a name="l06282"></a>06282 <span class="comment">         situation.</span>
<a name="l06283"></a>06283 <span class="comment"></span>
<a name="l06284"></a>06284 <span class="comment">         Note that while hardware watchpoints have several locations</span>
<a name="l06285"></a>06285 <span class="comment">         internally, that&#39;s not a property exposed to user.  */</span>
<a name="l06286"></a>06286       <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a> 
<a name="l06287"></a>06287           &amp;&amp; !is_hardware_watchpoint (b)
<a name="l06288"></a>06288           &amp;&amp; (b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>-&gt;<a class="code" href="structbp__location.html#ab193cb38f87fea89105db96d94191541">next</a> || !b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>-&gt;<a class="code" href="structbp__location.html#abe93e091d18373d27bda3ad3eb6316f8">enabled</a>))
<a name="l06289"></a>06289         {
<a name="l06290"></a>06290           <span class="keyword">struct </span>bp_location *loc;
<a name="l06291"></a>06291           <span class="keywordtype">int</span> n = 1;
<a name="l06292"></a>06292 
<a name="l06293"></a>06293           <span class="keywordflow">for</span> (loc = b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>; loc; loc = loc-&gt;<a class="code" href="structbp__location.html#ab193cb38f87fea89105db96d94191541">next</a>, ++n)
<a name="l06294"></a>06294             {
<a name="l06295"></a>06295               <span class="keyword">struct </span>cleanup *inner2 =
<a name="l06296"></a>06296                 <a class="code" href="ui-out_8c.html#aaf5a0c991d74ad2e486f420d5c2ff058">make_cleanup_ui_out_tuple_begin_end</a> (uiout, NULL);
<a name="l06297"></a>06297               print_one_breakpoint_location (b, loc, n, last_loc, allflag);
<a name="l06298"></a>06298               <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (inner2);
<a name="l06299"></a>06299             }
<a name="l06300"></a>06300         }
<a name="l06301"></a>06301     }
<a name="l06302"></a>06302 }
<a name="l06303"></a>06303 
<a name="l06304"></a>06304 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l06305"></a>06305 breakpoint_address_bits (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b)
<a name="l06306"></a>06306 {
<a name="l06307"></a>06307   <span class="keywordtype">int</span> print_address_bits = 0;
<a name="l06308"></a>06308   <span class="keyword">struct </span>bp_location *loc;
<a name="l06309"></a>06309 
<a name="l06310"></a>06310   <span class="keywordflow">for</span> (loc = b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>; loc; loc = loc-&gt;<a class="code" href="structbp__location.html#ab193cb38f87fea89105db96d94191541">next</a>)
<a name="l06311"></a>06311     {
<a name="l06312"></a>06312       <span class="keywordtype">int</span> addr_bit;
<a name="l06313"></a>06313 
<a name="l06314"></a>06314       <span class="comment">/* Software watchpoints that aren&#39;t watching memory don&#39;t have</span>
<a name="l06315"></a>06315 <span class="comment">         an address to print.  */</span>
<a name="l06316"></a>06316       <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa2a35cc5d65b66d6228def5615d6827ce">bp_watchpoint</a> &amp;&amp; loc-&gt;<a class="code" href="structbp__location.html#a0480880dc590f47b72d7af91ab5d5802">watchpoint_type</a> == -1)
<a name="l06317"></a>06317         <span class="keywordflow">continue</span>;
<a name="l06318"></a>06318 
<a name="l06319"></a>06319       addr_bit = <a class="code" href="gdbarch_8c.html#a3ee335ac98782b6633ab7fc235182cc9">gdbarch_addr_bit</a> (loc-&gt;<a class="code" href="structbp__location.html#a55f3ff99d536775f5095f11e5f5c3f3e">gdbarch</a>);
<a name="l06320"></a>06320       <span class="keywordflow">if</span> (addr_bit &gt; print_address_bits)
<a name="l06321"></a>06321         print_address_bits = addr_bit;
<a name="l06322"></a>06322     }
<a name="l06323"></a>06323 
<a name="l06324"></a>06324   <span class="keywordflow">return</span> print_address_bits;
<a name="l06325"></a>06325 }
<a name="l06326"></a>06326 
<a name="l06327"></a>06327 <span class="keyword">struct </span>captured_breakpoint_query_args
<a name="l06328"></a>06328   {
<a name="l06329"></a>06329     <span class="keywordtype">int</span> bnum;
<a name="l06330"></a>06330   };
<a name="l06331"></a>06331 
<a name="l06332"></a>06332 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l06333"></a>06333 do_captured_breakpoint_query (<span class="keyword">struct</span> ui_out *uiout, <span class="keywordtype">void</span> *data)
<a name="l06334"></a>06334 {
<a name="l06335"></a>06335   <span class="keyword">struct </span>captured_breakpoint_query_args *args = data;
<a name="l06336"></a>06336   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b;
<a name="l06337"></a>06337   <span class="keyword">struct </span>bp_location *dummy_loc = NULL;
<a name="l06338"></a>06338 
<a name="l06339"></a>06339   <a class="code" href="breakpoint_8c.html#a781d5d3dc50a92364edfbacac3d0c107">ALL_BREAKPOINTS</a> (b)
<a name="l06340"></a>06340     {
<a name="l06341"></a>06341       <span class="keywordflow">if</span> (args-&gt;bnum == b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>)
<a name="l06342"></a>06342         {
<a name="l06343"></a>06343           print_one_breakpoint (b, &amp;dummy_loc, 0);
<a name="l06344"></a>06344           <span class="keywordflow">return</span> <a class="code" href="gdb_8h.html#a99b632589c180c686ae0b53f01cc0d05a5512a5c6a0c1ee15f2fef7e6acb0edda">GDB_RC_OK</a>;
<a name="l06345"></a>06345         }
<a name="l06346"></a>06346     }
<a name="l06347"></a>06347   <span class="keywordflow">return</span> <a class="code" href="gdb_8h.html#a99b632589c180c686ae0b53f01cc0d05ab2f3b8b5a4b44dfb155da4e6738e04c6">GDB_RC_NONE</a>;
<a name="l06348"></a>06348 }
<a name="l06349"></a>06349 
<a name="l06350"></a>06350 <span class="keyword">enum</span> <a class="code" href="gdb_8h.html#a99b632589c180c686ae0b53f01cc0d05">gdb_rc</a>
<a name="l06351"></a><a class="code" href="gdb_8h.html#a52477bff2f2ecd8774a3e1000ef4ac6b">06351</a> <a class="code" href="breakpoint_8c.html#a52477bff2f2ecd8774a3e1000ef4ac6b">gdb_breakpoint_query</a> (<span class="keyword">struct</span> ui_out *uiout, <span class="keywordtype">int</span> bnum, 
<a name="l06352"></a>06352                       <span class="keywordtype">char</span> **error_message)
<a name="l06353"></a>06353 {
<a name="l06354"></a>06354   <span class="keyword">struct </span>captured_breakpoint_query_args args;
<a name="l06355"></a>06355 
<a name="l06356"></a>06356   args.bnum = bnum;
<a name="l06357"></a>06357   <span class="comment">/* For the moment we don&#39;t trust print_one_breakpoint() to not throw</span>
<a name="l06358"></a>06358 <span class="comment">     an error.  */</span>
<a name="l06359"></a>06359   <span class="keywordflow">if</span> (<a class="code" href="exceptions_8c.html#a82901e00bcf120f2637c99e95bdcae51">catch_exceptions_with_msg</a> (uiout, do_captured_breakpoint_query, &amp;args,
<a name="l06360"></a>06360                                  error_message, <a class="code" href="exceptions_8h.html#abfa3a3b99557b11f5766baf69465fdf6ab50fde886a7de8c013bf2bd4e7c073a4">RETURN_MASK_ALL</a>) &lt; 0)
<a name="l06361"></a>06361     <span class="keywordflow">return</span> <a class="code" href="gdb_8h.html#a99b632589c180c686ae0b53f01cc0d05a41261cc565cd108ae6c24fff5f96f349">GDB_RC_FAIL</a>;
<a name="l06362"></a>06362   <span class="keywordflow">else</span>
<a name="l06363"></a>06363     <span class="keywordflow">return</span> <a class="code" href="gdb_8h.html#a99b632589c180c686ae0b53f01cc0d05a5512a5c6a0c1ee15f2fef7e6acb0edda">GDB_RC_OK</a>;
<a name="l06364"></a>06364 }
<a name="l06365"></a>06365 
<a name="l06366"></a>06366 <span class="comment">/* Return true if this breakpoint was set by the user, false if it is</span>
<a name="l06367"></a>06367 <span class="comment">   internal or momentary.  */</span>
<a name="l06368"></a>06368 
<a name="l06369"></a>06369 <span class="keywordtype">int</span>
<a name="l06370"></a><a class="code" href="breakpoint_8h.html#a0a14188f5712ac729b16bcf023be7155">06370</a> <a class="code" href="breakpoint_8c.html#ac7893fb93c9f1d907b89a1655481602d">user_breakpoint_p</a> (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b)
<a name="l06371"></a>06371 {
<a name="l06372"></a>06372   <span class="keywordflow">return</span> b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a> &gt; 0;
<a name="l06373"></a>06373 }
<a name="l06374"></a>06374 
<a name="l06375"></a>06375 <span class="comment">/* Print information on user settable breakpoint (watchpoint, etc)</span>
<a name="l06376"></a>06376 <span class="comment">   number BNUM.  If BNUM is -1 print all user-settable breakpoints.</span>
<a name="l06377"></a>06377 <span class="comment">   If ALLFLAG is non-zero, include non-user-settable breakpoints.  If</span>
<a name="l06378"></a>06378 <span class="comment">   FILTER is non-NULL, call it on each breakpoint and only include the</span>
<a name="l06379"></a>06379 <span class="comment">   ones for which it returns non-zero.  Return the total number of</span>
<a name="l06380"></a>06380 <span class="comment">   breakpoints listed.  */</span>
<a name="l06381"></a>06381 
<a name="l06382"></a>06382 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l06383"></a>06383 breakpoint_1 (<span class="keywordtype">char</span> *args, <span class="keywordtype">int</span> allflag, 
<a name="l06384"></a>06384               <span class="keywordtype">int</span> (*filter) (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *))
<a name="l06385"></a>06385 {
<a name="l06386"></a>06386   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b;
<a name="l06387"></a>06387   <span class="keyword">struct </span>bp_location *last_loc = NULL;
<a name="l06388"></a>06388   <span class="keywordtype">int</span> nr_printable_breakpoints;
<a name="l06389"></a>06389   <span class="keyword">struct </span>cleanup *bkpttbl_chain;
<a name="l06390"></a>06390   <span class="keyword">struct </span><a class="code" href="structvalue__print__options.html">value_print_options</a> opts;
<a name="l06391"></a>06391   <span class="keywordtype">int</span> print_address_bits = 0;
<a name="l06392"></a>06392   <span class="keywordtype">int</span> print_type_col_width = 14;
<a name="l06393"></a>06393   <span class="keyword">struct </span>ui_out *uiout = <a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>;
<a name="l06394"></a>06394 
<a name="l06395"></a>06395   <a class="code" href="valprint_8c.html#aa2d4dfe4b11841ccafc4d0c0d410095d">get_user_print_options</a> (&amp;opts);
<a name="l06396"></a>06396 
<a name="l06397"></a>06397   <span class="comment">/* Compute the number of rows in the table, as well as the size</span>
<a name="l06398"></a>06398 <span class="comment">     required for address fields.  */</span>
<a name="l06399"></a>06399   nr_printable_breakpoints = 0;
<a name="l06400"></a>06400   <a class="code" href="breakpoint_8c.html#a781d5d3dc50a92364edfbacac3d0c107">ALL_BREAKPOINTS</a> (b)
<a name="l06401"></a>06401     {
<a name="l06402"></a>06402       <span class="comment">/* If we have a filter, only list the breakpoints it accepts.  */</span>
<a name="l06403"></a>06403       <span class="keywordflow">if</span> (filter &amp;&amp; !filter (b))
<a name="l06404"></a>06404         <span class="keywordflow">continue</span>;
<a name="l06405"></a>06405 
<a name="l06406"></a>06406       <span class="comment">/* If we have an &quot;args&quot; string, it is a list of breakpoints to </span>
<a name="l06407"></a>06407 <span class="comment">         accept.  Skip the others.  */</span>
<a name="l06408"></a>06408       <span class="keywordflow">if</span> (args != NULL &amp;&amp; *args != <span class="charliteral">&#39;\0&#39;</span>)
<a name="l06409"></a>06409         {
<a name="l06410"></a>06410           <span class="keywordflow">if</span> (allflag &amp;&amp; <a class="code" href="eval_8c.html#a8c10c34c4f91482249243e53ab7d16b7">parse_and_eval_long</a> (args) != b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>)
<a name="l06411"></a>06411             <span class="keywordflow">continue</span>;
<a name="l06412"></a>06412           <span class="keywordflow">if</span> (!allflag &amp;&amp; !<a class="code" href="cli-utils_8c.html#a1b851b4e8390a127fac2df8ae401c56a">number_is_in_list</a> (args, b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>))
<a name="l06413"></a>06413             <span class="keywordflow">continue</span>;
<a name="l06414"></a>06414         }
<a name="l06415"></a>06415 
<a name="l06416"></a>06416       <span class="keywordflow">if</span> (allflag || <a class="code" href="breakpoint_8c.html#ac7893fb93c9f1d907b89a1655481602d">user_breakpoint_p</a> (b))
<a name="l06417"></a>06417         {
<a name="l06418"></a>06418           <span class="keywordtype">int</span> addr_bit, type_len;
<a name="l06419"></a>06419 
<a name="l06420"></a>06420           addr_bit = breakpoint_address_bits (b);
<a name="l06421"></a>06421           <span class="keywordflow">if</span> (addr_bit &gt; print_address_bits)
<a name="l06422"></a>06422             print_address_bits = addr_bit;
<a name="l06423"></a>06423 
<a name="l06424"></a>06424           type_len = strlen (bptype_string (b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a>));
<a name="l06425"></a>06425           <span class="keywordflow">if</span> (type_len &gt; print_type_col_width)
<a name="l06426"></a>06426             print_type_col_width = type_len;
<a name="l06427"></a>06427 
<a name="l06428"></a>06428           nr_printable_breakpoints++;
<a name="l06429"></a>06429         }
<a name="l06430"></a>06430     }
<a name="l06431"></a>06431 
<a name="l06432"></a>06432   <span class="keywordflow">if</span> (opts.addressprint)
<a name="l06433"></a>06433     bkpttbl_chain 
<a name="l06434"></a>06434       = <a class="code" href="ui-out_8c.html#a9675e3968a06325a214ffe2fbb10bdc8">make_cleanup_ui_out_table_begin_end</a> (uiout, 6,
<a name="l06435"></a>06435                                              nr_printable_breakpoints,
<a name="l06436"></a>06436                                              <span class="stringliteral">&quot;BreakpointTable&quot;</span>);
<a name="l06437"></a>06437   <span class="keywordflow">else</span>
<a name="l06438"></a>06438     bkpttbl_chain 
<a name="l06439"></a>06439       = <a class="code" href="ui-out_8c.html#a9675e3968a06325a214ffe2fbb10bdc8">make_cleanup_ui_out_table_begin_end</a> (uiout, 5,
<a name="l06440"></a>06440                                              nr_printable_breakpoints,
<a name="l06441"></a>06441                                              <span class="stringliteral">&quot;BreakpointTable&quot;</span>);
<a name="l06442"></a>06442 
<a name="l06443"></a>06443   <span class="keywordflow">if</span> (nr_printable_breakpoints &gt; 0)
<a name="l06444"></a>06444     <a class="code" href="annotate_8c.html#aa44b5341031976a23ca5c66a90ccd0a0">annotate_breakpoints_headers</a> ();
<a name="l06445"></a>06445   <span class="keywordflow">if</span> (nr_printable_breakpoints &gt; 0)
<a name="l06446"></a>06446     <a class="code" href="annotate_8c.html#a3b961efbc346558aade25e12945835fe">annotate_field</a> (0);
<a name="l06447"></a>06447   <a class="code" href="ui-out_8c.html#a6a85ff75fa4ac345725a2fd58498173f">ui_out_table_header</a> (uiout, 7, <a class="code" href="ui-out_8h.html#ac5d0187f97768dc203458ddf644e0c7aac8a02f1b44706ba412f42aa3fc249695">ui_left</a>, <span class="stringliteral">&quot;number&quot;</span>, <span class="stringliteral">&quot;Num&quot;</span>);     <span class="comment">/* 1 */</span>
<a name="l06448"></a>06448   <span class="keywordflow">if</span> (nr_printable_breakpoints &gt; 0)
<a name="l06449"></a>06449     <a class="code" href="annotate_8c.html#a3b961efbc346558aade25e12945835fe">annotate_field</a> (1);
<a name="l06450"></a>06450   <a class="code" href="ui-out_8c.html#a6a85ff75fa4ac345725a2fd58498173f">ui_out_table_header</a> (uiout, print_type_col_width, <a class="code" href="ui-out_8h.html#ac5d0187f97768dc203458ddf644e0c7aac8a02f1b44706ba412f42aa3fc249695">ui_left</a>,
<a name="l06451"></a>06451                        <span class="stringliteral">&quot;type&quot;</span>, <span class="stringliteral">&quot;Type&quot;</span>);                         <span class="comment">/* 2 */</span>
<a name="l06452"></a>06452   <span class="keywordflow">if</span> (nr_printable_breakpoints &gt; 0)
<a name="l06453"></a>06453     <a class="code" href="annotate_8c.html#a3b961efbc346558aade25e12945835fe">annotate_field</a> (2);
<a name="l06454"></a>06454   <a class="code" href="ui-out_8c.html#a6a85ff75fa4ac345725a2fd58498173f">ui_out_table_header</a> (uiout, 4, <a class="code" href="ui-out_8h.html#ac5d0187f97768dc203458ddf644e0c7aac8a02f1b44706ba412f42aa3fc249695">ui_left</a>, <span class="stringliteral">&quot;disp&quot;</span>, <span class="stringliteral">&quot;Disp&quot;</span>);      <span class="comment">/* 3 */</span>
<a name="l06455"></a>06455   <span class="keywordflow">if</span> (nr_printable_breakpoints &gt; 0)
<a name="l06456"></a>06456     <a class="code" href="annotate_8c.html#a3b961efbc346558aade25e12945835fe">annotate_field</a> (3);
<a name="l06457"></a>06457   <a class="code" href="ui-out_8c.html#a6a85ff75fa4ac345725a2fd58498173f">ui_out_table_header</a> (uiout, 3, <a class="code" href="ui-out_8h.html#ac5d0187f97768dc203458ddf644e0c7aac8a02f1b44706ba412f42aa3fc249695">ui_left</a>, <span class="stringliteral">&quot;enabled&quot;</span>, <span class="stringliteral">&quot;Enb&quot;</span>);    <span class="comment">/* 4 */</span>
<a name="l06458"></a>06458   <span class="keywordflow">if</span> (opts.addressprint)
<a name="l06459"></a>06459     {
<a name="l06460"></a>06460       <span class="keywordflow">if</span> (nr_printable_breakpoints &gt; 0)
<a name="l06461"></a>06461         <a class="code" href="annotate_8c.html#a3b961efbc346558aade25e12945835fe">annotate_field</a> (4);
<a name="l06462"></a>06462       <span class="keywordflow">if</span> (print_address_bits &lt;= 32)
<a name="l06463"></a>06463         <a class="code" href="ui-out_8c.html#a6a85ff75fa4ac345725a2fd58498173f">ui_out_table_header</a> (uiout, 10, <a class="code" href="ui-out_8h.html#ac5d0187f97768dc203458ddf644e0c7aac8a02f1b44706ba412f42aa3fc249695">ui_left</a>, 
<a name="l06464"></a>06464                              <span class="stringliteral">&quot;addr&quot;</span>, <span class="stringliteral">&quot;Address&quot;</span>);                <span class="comment">/* 5 */</span>
<a name="l06465"></a>06465       <span class="keywordflow">else</span>
<a name="l06466"></a>06466         <a class="code" href="ui-out_8c.html#a6a85ff75fa4ac345725a2fd58498173f">ui_out_table_header</a> (uiout, 18, <a class="code" href="ui-out_8h.html#ac5d0187f97768dc203458ddf644e0c7aac8a02f1b44706ba412f42aa3fc249695">ui_left</a>, 
<a name="l06467"></a>06467                              <span class="stringliteral">&quot;addr&quot;</span>, <span class="stringliteral">&quot;Address&quot;</span>);                <span class="comment">/* 5 */</span>
<a name="l06468"></a>06468     }
<a name="l06469"></a>06469   <span class="keywordflow">if</span> (nr_printable_breakpoints &gt; 0)
<a name="l06470"></a>06470     <a class="code" href="annotate_8c.html#a3b961efbc346558aade25e12945835fe">annotate_field</a> (5);
<a name="l06471"></a>06471   <a class="code" href="ui-out_8c.html#a6a85ff75fa4ac345725a2fd58498173f">ui_out_table_header</a> (uiout, 40, <a class="code" href="ui-out_8h.html#ac5d0187f97768dc203458ddf644e0c7aa0483b30a9b89be72a51d076fcd02be30">ui_noalign</a>, <span class="stringliteral">&quot;what&quot;</span>, <span class="stringliteral">&quot;What&quot;</span>);  <span class="comment">/* 6 */</span>
<a name="l06472"></a>06472   <a class="code" href="ui-out_8c.html#a07042144a117bc974f5c41761b68975e">ui_out_table_body</a> (uiout);
<a name="l06473"></a>06473   <span class="keywordflow">if</span> (nr_printable_breakpoints &gt; 0)
<a name="l06474"></a>06474     <a class="code" href="annotate_8c.html#a4ebe5af77e30f726fa01bab9a47a4b1a">annotate_breakpoints_table</a> ();
<a name="l06475"></a>06475 
<a name="l06476"></a>06476   <a class="code" href="breakpoint_8c.html#a781d5d3dc50a92364edfbacac3d0c107">ALL_BREAKPOINTS</a> (b)
<a name="l06477"></a>06477     {
<a name="l06478"></a>06478       <a class="code" href="defs_8h.html#ad24e2b54375e12474e65ebf7175988fb">QUIT</a>;
<a name="l06479"></a>06479       <span class="comment">/* If we have a filter, only list the breakpoints it accepts.  */</span>
<a name="l06480"></a>06480       <span class="keywordflow">if</span> (filter &amp;&amp; !filter (b))
<a name="l06481"></a>06481         <span class="keywordflow">continue</span>;
<a name="l06482"></a>06482 
<a name="l06483"></a>06483       <span class="comment">/* If we have an &quot;args&quot; string, it is a list of breakpoints to </span>
<a name="l06484"></a>06484 <span class="comment">         accept.  Skip the others.  */</span>
<a name="l06485"></a>06485 
<a name="l06486"></a>06486       <span class="keywordflow">if</span> (args != NULL &amp;&amp; *args != <span class="charliteral">&#39;\0&#39;</span>)
<a name="l06487"></a>06487         {
<a name="l06488"></a>06488           <span class="keywordflow">if</span> (allflag)  <span class="comment">/* maintenance info breakpoint */</span>
<a name="l06489"></a>06489             {
<a name="l06490"></a>06490               <span class="keywordflow">if</span> (<a class="code" href="eval_8c.html#a8c10c34c4f91482249243e53ab7d16b7">parse_and_eval_long</a> (args) != b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>)
<a name="l06491"></a>06491                 <span class="keywordflow">continue</span>;
<a name="l06492"></a>06492             }
<a name="l06493"></a>06493           <span class="keywordflow">else</span>          <span class="comment">/* all others */</span>
<a name="l06494"></a>06494             {
<a name="l06495"></a>06495               <span class="keywordflow">if</span> (!<a class="code" href="cli-utils_8c.html#a1b851b4e8390a127fac2df8ae401c56a">number_is_in_list</a> (args, b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>))
<a name="l06496"></a>06496                 <span class="keywordflow">continue</span>;
<a name="l06497"></a>06497             }
<a name="l06498"></a>06498         }
<a name="l06499"></a>06499       <span class="comment">/* We only print out user settable breakpoints unless the</span>
<a name="l06500"></a>06500 <span class="comment">         allflag is set.  */</span>
<a name="l06501"></a>06501       <span class="keywordflow">if</span> (allflag || <a class="code" href="breakpoint_8c.html#ac7893fb93c9f1d907b89a1655481602d">user_breakpoint_p</a> (b))
<a name="l06502"></a>06502         print_one_breakpoint (b, &amp;last_loc, allflag);
<a name="l06503"></a>06503     }
<a name="l06504"></a>06504 
<a name="l06505"></a>06505   <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (bkpttbl_chain);
<a name="l06506"></a>06506 
<a name="l06507"></a>06507   <span class="keywordflow">if</span> (nr_printable_breakpoints == 0)
<a name="l06508"></a>06508     {
<a name="l06509"></a>06509       <span class="comment">/* If there&#39;s a filter, let the caller decide how to report</span>
<a name="l06510"></a>06510 <span class="comment">         empty list.  */</span>
<a name="l06511"></a>06511       <span class="keywordflow">if</span> (!filter)
<a name="l06512"></a>06512         {
<a name="l06513"></a>06513           <span class="keywordflow">if</span> (args == NULL || *args == <span class="charliteral">&#39;\0&#39;</span>)
<a name="l06514"></a>06514             <a class="code" href="ui-out_8c.html#a65967c27cd058d2739afdbc5a51f377e">ui_out_message</a> (uiout, 0, <span class="stringliteral">&quot;No breakpoints or watchpoints.\n&quot;</span>);
<a name="l06515"></a>06515           <span class="keywordflow">else</span>
<a name="l06516"></a>06516             <a class="code" href="ui-out_8c.html#a65967c27cd058d2739afdbc5a51f377e">ui_out_message</a> (uiout, 0, 
<a name="l06517"></a>06517                             <span class="stringliteral">&quot;No breakpoint or watchpoint matching &#39;%s&#39;.\n&quot;</span>,
<a name="l06518"></a>06518                             args);
<a name="l06519"></a>06519         }
<a name="l06520"></a>06520     }
<a name="l06521"></a>06521   <span class="keywordflow">else</span>
<a name="l06522"></a>06522     {
<a name="l06523"></a>06523       <span class="keywordflow">if</span> (last_loc &amp;&amp; !<a class="code" href="top_8c.html#a696fc2ffc263949656d0a3d0e29c78b0">server_command</a>)
<a name="l06524"></a>06524         <a class="code" href="defs_8h.html#a55e0332ed07e2318daf35ed1ee2ffba7">set_next_address</a> (last_loc-&gt;<a class="code" href="structbp__location.html#a55f3ff99d536775f5095f11e5f5c3f3e">gdbarch</a>, last_loc-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>);
<a name="l06525"></a>06525     }
<a name="l06526"></a>06526 
<a name="l06527"></a>06527   <span class="comment">/* FIXME?  Should this be moved up so that it is only called when</span>
<a name="l06528"></a>06528 <span class="comment">     there have been breakpoints? */</span>
<a name="l06529"></a>06529   <a class="code" href="annotate_8c.html#afe99b14f95504a290f3ae8f49b073485">annotate_breakpoints_table_end</a> ();
<a name="l06530"></a>06530 
<a name="l06531"></a>06531   <span class="keywordflow">return</span> nr_printable_breakpoints;
<a name="l06532"></a>06532 }
<a name="l06533"></a>06533 
<a name="l06534"></a>06534 <span class="comment">/* Display the value of default-collect in a way that is generally</span>
<a name="l06535"></a>06535 <span class="comment">   compatible with the breakpoint list.  */</span>
<a name="l06536"></a>06536 
<a name="l06537"></a>06537 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l06538"></a>06538 default_collect_info (<span class="keywordtype">void</span>)
<a name="l06539"></a>06539 {
<a name="l06540"></a>06540   <span class="keyword">struct </span>ui_out *uiout = <a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>;
<a name="l06541"></a>06541 
<a name="l06542"></a>06542   <span class="comment">/* If it has no value (which is frequently the case), say nothing; a</span>
<a name="l06543"></a>06543 <span class="comment">     message like &quot;No default-collect.&quot; gets in user&#39;s face when it&#39;s</span>
<a name="l06544"></a>06544 <span class="comment">     not wanted.  */</span>
<a name="l06545"></a>06545   <span class="keywordflow">if</span> (!*default_collect)
<a name="l06546"></a>06546     <span class="keywordflow">return</span>;
<a name="l06547"></a>06547 
<a name="l06548"></a>06548   <span class="comment">/* The following phrase lines up nicely with per-tracepoint collect</span>
<a name="l06549"></a>06549 <span class="comment">     actions.  */</span>
<a name="l06550"></a>06550   <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;default collect &quot;</span>);
<a name="l06551"></a>06551   <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a> (uiout, <span class="stringliteral">&quot;default-collect&quot;</span>, default_collect);
<a name="l06552"></a>06552   <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot; \n&quot;</span>);
<a name="l06553"></a>06553 }
<a name="l06554"></a>06554   
<a name="l06555"></a>06555 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l06556"></a>06556 breakpoints_info (<span class="keywordtype">char</span> *args, <span class="keywordtype">int</span> from_tty)
<a name="l06557"></a>06557 {
<a name="l06558"></a>06558   breakpoint_1 (args, 0, NULL);
<a name="l06559"></a>06559 
<a name="l06560"></a>06560   default_collect_info ();
<a name="l06561"></a>06561 }
<a name="l06562"></a>06562 
<a name="l06563"></a>06563 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l06564"></a>06564 watchpoints_info (<span class="keywordtype">char</span> *args, <span class="keywordtype">int</span> from_tty)
<a name="l06565"></a>06565 {
<a name="l06566"></a>06566   <span class="keywordtype">int</span> num_printed = breakpoint_1 (args, 0, <a class="code" href="breakpoint_8c.html#a49f0d5ff628dd506db5b81f660eb4610">is_watchpoint</a>);
<a name="l06567"></a>06567   <span class="keyword">struct </span>ui_out *uiout = <a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>;
<a name="l06568"></a>06568 
<a name="l06569"></a>06569   <span class="keywordflow">if</span> (num_printed == 0)
<a name="l06570"></a>06570     {
<a name="l06571"></a>06571       <span class="keywordflow">if</span> (args == NULL || *args == <span class="charliteral">&#39;\0&#39;</span>)
<a name="l06572"></a>06572         <a class="code" href="ui-out_8c.html#a65967c27cd058d2739afdbc5a51f377e">ui_out_message</a> (uiout, 0, <span class="stringliteral">&quot;No watchpoints.\n&quot;</span>);
<a name="l06573"></a>06573       <span class="keywordflow">else</span>
<a name="l06574"></a>06574         <a class="code" href="ui-out_8c.html#a65967c27cd058d2739afdbc5a51f377e">ui_out_message</a> (uiout, 0, <span class="stringliteral">&quot;No watchpoint matching &#39;%s&#39;.\n&quot;</span>, args);
<a name="l06575"></a>06575     }
<a name="l06576"></a>06576 }
<a name="l06577"></a>06577 
<a name="l06578"></a>06578 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l06579"></a>06579 maintenance_info_breakpoints (<span class="keywordtype">char</span> *args, <span class="keywordtype">int</span> from_tty)
<a name="l06580"></a>06580 {
<a name="l06581"></a>06581   breakpoint_1 (args, 1, NULL);
<a name="l06582"></a>06582 
<a name="l06583"></a>06583   default_collect_info ();
<a name="l06584"></a>06584 }
<a name="l06585"></a>06585 
<a name="l06586"></a>06586 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l06587"></a>06587 breakpoint_has_pc (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b,
<a name="l06588"></a>06588                    <span class="keyword">struct</span> <a class="code" href="structprogram__space.html">program_space</a> *pspace,
<a name="l06589"></a>06589                    <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> pc, <span class="keyword">struct</span> <a class="code" href="structobj__section.html">obj_section</a> *section)
<a name="l06590"></a>06590 {
<a name="l06591"></a>06591   <span class="keyword">struct </span>bp_location *bl = b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>;
<a name="l06592"></a>06592 
<a name="l06593"></a>06593   <span class="keywordflow">for</span> (; bl; bl = bl-&gt;<a class="code" href="structbp__location.html#ab193cb38f87fea89105db96d94191541">next</a>)
<a name="l06594"></a>06594     {
<a name="l06595"></a>06595       <span class="keywordflow">if</span> (bl-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a> == pspace
<a name="l06596"></a>06596           &amp;&amp; bl-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a> == pc
<a name="l06597"></a>06597           &amp;&amp; (!<a class="code" href="symfile_8c.html#ad96d01ef61ee2925825b3992d37408f5">overlay_debugging</a> || bl-&gt;<a class="code" href="structbp__location.html#ac6d8286e46db5c4be6dab9139c43a00d">section</a> == section))
<a name="l06598"></a>06598         <span class="keywordflow">return</span> 1;         
<a name="l06599"></a>06599     }
<a name="l06600"></a>06600   <span class="keywordflow">return</span> 0;
<a name="l06601"></a>06601 }
<a name="l06602"></a>06602 
<a name="l06603"></a>06603 <span class="comment">/* Print a message describing any user-breakpoints set at PC.  This</span>
<a name="l06604"></a>06604 <span class="comment">   concerns with logical breakpoints, so we match program spaces, not</span>
<a name="l06605"></a>06605 <span class="comment">   address spaces.  */</span>
<a name="l06606"></a>06606 
<a name="l06607"></a>06607 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l06608"></a>06608 describe_other_breakpoints (<span class="keyword">struct</span> gdbarch *gdbarch,
<a name="l06609"></a>06609                             <span class="keyword">struct</span> <a class="code" href="structprogram__space.html">program_space</a> *pspace, <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> pc,
<a name="l06610"></a>06610                             <span class="keyword">struct</span> <a class="code" href="structobj__section.html">obj_section</a> *section, <span class="keywordtype">int</span> thread)
<a name="l06611"></a>06611 {
<a name="l06612"></a>06612   <span class="keywordtype">int</span> others = 0;
<a name="l06613"></a>06613   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b;
<a name="l06614"></a>06614 
<a name="l06615"></a>06615   <a class="code" href="breakpoint_8c.html#a781d5d3dc50a92364edfbacac3d0c107">ALL_BREAKPOINTS</a> (b)
<a name="l06616"></a>06616     others += (<a class="code" href="breakpoint_8c.html#ac7893fb93c9f1d907b89a1655481602d">user_breakpoint_p</a> (b)
<a name="l06617"></a>06617                &amp;&amp; breakpoint_has_pc (b, pspace, pc, section));
<a name="l06618"></a>06618   if (others &gt; 0)
<a name="l06619"></a>06619     {
<a name="l06620"></a>06620       <span class="keywordflow">if</span> (others == 1)
<a name="l06621"></a>06621         <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Note: breakpoint &quot;</span>));
<a name="l06622"></a>06622       <span class="keywordflow">else</span> <span class="comment">/* if (others == ???) */</span>
<a name="l06623"></a>06623         <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Note: breakpoints &quot;</span>));
<a name="l06624"></a>06624       <a class="code" href="breakpoint_8c.html#a781d5d3dc50a92364edfbacac3d0c107">ALL_BREAKPOINTS</a> (b)
<a name="l06625"></a>06625         if (<a class="code" href="breakpoint_8c.html#ac7893fb93c9f1d907b89a1655481602d">user_breakpoint_p</a> (b) &amp;&amp; breakpoint_has_pc (b, pspace, pc, section))
<a name="l06626"></a>06626           {
<a name="l06627"></a>06627             others--;
<a name="l06628"></a>06628             <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;%d&quot;</span>, b-&gt;number);
<a name="l06629"></a>06629             <span class="keywordflow">if</span> (b-&gt;thread == -1 &amp;&amp; thread != -1)
<a name="l06630"></a>06630               <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot; (all threads)&quot;</span>);
<a name="l06631"></a>06631             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (b-&gt;thread != -1)
<a name="l06632"></a>06632               <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot; (thread %d)&quot;</span>, b-&gt;thread);
<a name="l06633"></a>06633             <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;%s%s &quot;</span>,
<a name="l06634"></a>06634                              ((b-&gt;enable_state == <a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577a4605f207d0d15bd8195c9b1aa1bfee96">bp_disabled</a>
<a name="l06635"></a>06635                                || b-&gt;enable_state == <a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577ab336fa5d61d3c4424c6aac80c107d1c6">bp_call_disabled</a>)
<a name="l06636"></a>06636                               ? <span class="stringliteral">&quot; (disabled)&quot;</span>
<a name="l06637"></a>06637                               : b-&gt;enable_state == <a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577adbf2e9b210d33b1ac7e8a7ed87a2b46f">bp_permanent</a> 
<a name="l06638"></a>06638                               ? <span class="stringliteral">&quot; (permanent)&quot;</span>
<a name="l06639"></a>06639                               : <span class="stringliteral">&quot;&quot;</span>),
<a name="l06640"></a>06640                              (others &gt; 1) ? <span class="stringliteral">&quot;,&quot;</span> 
<a name="l06641"></a>06641                              : ((others == 1) ? <span class="stringliteral">&quot; and&quot;</span> : <span class="stringliteral">&quot;&quot;</span>));
<a name="l06642"></a>06642           }
<a name="l06643"></a>06643       <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;also set at pc &quot;</span>));
<a name="l06644"></a>06644       <a class="code" href="utils_8c.html#a4b28488051faf9ab4a2f07633225835f">fputs_filtered</a> (<a class="code" href="utils_8c.html#ab5c76d72090f01d3848b63dda4e37d1c">paddress</a> (gdbarch, pc), <a class="code" href="main_8c.html#a41a2b997ba5454df787d61f051dd918c">gdb_stdout</a>);
<a name="l06645"></a>06645       <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;.\n&quot;</span>);
<a name="l06646"></a>06646     }
<a name="l06647"></a>06647 }
<a name="l06648"></a>06648 
<a name="l06649"></a>06649 
<a name="l06650"></a>06650 <span class="comment">/* Return true iff it is meaningful to use the address member of</span>
<a name="l06651"></a>06651 <span class="comment">   BPT.  For some breakpoint types, the address member is irrelevant</span>
<a name="l06652"></a>06652 <span class="comment">   and it makes no sense to attempt to compare it to other addresses</span>
<a name="l06653"></a>06653 <span class="comment">   (or use it for any other purpose either).</span>
<a name="l06654"></a>06654 <span class="comment"></span>
<a name="l06655"></a>06655 <span class="comment">   More specifically, each of the following breakpoint types will</span>
<a name="l06656"></a>06656 <span class="comment">   always have a zero valued address and we don&#39;t want to mark</span>
<a name="l06657"></a>06657 <span class="comment">   breakpoints of any of these types to be a duplicate of an actual</span>
<a name="l06658"></a>06658 <span class="comment">   breakpoint at address zero:</span>
<a name="l06659"></a>06659 <span class="comment"></span>
<a name="l06660"></a>06660 <span class="comment">      bp_watchpoint</span>
<a name="l06661"></a>06661 <span class="comment">      bp_catchpoint</span>
<a name="l06662"></a>06662 <span class="comment"></span>
<a name="l06663"></a>06663 <span class="comment">*/</span>
<a name="l06664"></a>06664 
<a name="l06665"></a>06665 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l06666"></a>06666 breakpoint_address_is_meaningful (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *bpt)
<a name="l06667"></a>06667 {
<a name="l06668"></a>06668   <span class="keyword">enum</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cf">bptype</a> type = bpt-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a>;
<a name="l06669"></a>06669 
<a name="l06670"></a>06670   <span class="keywordflow">return</span> (type != <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa2a35cc5d65b66d6228def5615d6827ce">bp_watchpoint</a> &amp;&amp; type != <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa8ebb961cef940b8ddef84696b7ac9694">bp_catchpoint</a>);
<a name="l06671"></a>06671 }
<a name="l06672"></a>06672 
<a name="l06673"></a>06673 <span class="comment">/* Assuming LOC1 and LOC2&#39;s owners are hardware watchpoints, returns</span>
<a name="l06674"></a>06674 <span class="comment">   true if LOC1 and LOC2 represent the same watchpoint location.  */</span>
<a name="l06675"></a>06675 
<a name="l06676"></a>06676 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l06677"></a>06677 watchpoint_locations_match (<span class="keyword">struct</span> bp_location *loc1, 
<a name="l06678"></a>06678                             <span class="keyword">struct</span> bp_location *loc2)
<a name="l06679"></a>06679 {
<a name="l06680"></a>06680   <span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *w1 = (<span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *) loc1-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>;
<a name="l06681"></a>06681   <span class="keyword">struct</span> <a class="code" href="structwatchpoint.html">watchpoint</a> *w2 = (<span class="keyword">struct</span> <a class="code" href="structwatchpoint.html">watchpoint</a> *) loc2-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>;
<a name="l06682"></a>06682 
<a name="l06683"></a>06683   <span class="comment">/* Both of them must exist.  */</span>
<a name="l06684"></a>06684   <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (w1 != NULL);
<a name="l06685"></a>06685   <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (w2 != NULL);
<a name="l06686"></a>06686 
<a name="l06687"></a>06687   <span class="comment">/* If the target can evaluate the condition expression in hardware,</span>
<a name="l06688"></a>06688 <span class="comment">     then we we need to insert both watchpoints even if they are at</span>
<a name="l06689"></a>06689 <span class="comment">     the same place.  Otherwise the watchpoint will only trigger when</span>
<a name="l06690"></a>06690 <span class="comment">     the condition of whichever watchpoint was inserted evaluates to</span>
<a name="l06691"></a>06691 <span class="comment">     true, not giving a chance for GDB to check the condition of the</span>
<a name="l06692"></a>06692 <span class="comment">     other watchpoint.  */</span>
<a name="l06693"></a>06693   <span class="keywordflow">if</span> ((w1-&gt;<a class="code" href="structwatchpoint.html#af56cdd0c2d7782c70177feb9b0d9e676">cond_exp</a>
<a name="l06694"></a>06694        &amp;&amp; <a class="code" href="target_8h.html#ac08fe91380ca72adfa3e4cdb9e7ca770">target_can_accel_watchpoint_condition</a> (loc1-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>, 
<a name="l06695"></a>06695                                                  loc1-&gt;<a class="code" href="structbp__location.html#a3d4ad6914964554ca761607f9e8fab62">length</a>,
<a name="l06696"></a>06696                                                  loc1-&gt;<a class="code" href="structbp__location.html#a0480880dc590f47b72d7af91ab5d5802">watchpoint_type</a>,
<a name="l06697"></a>06697                                                  w1-&gt;<a class="code" href="structwatchpoint.html#af56cdd0c2d7782c70177feb9b0d9e676">cond_exp</a>))
<a name="l06698"></a>06698       || (w2-&gt;cond_exp
<a name="l06699"></a>06699           &amp;&amp; <a class="code" href="target_8h.html#ac08fe91380ca72adfa3e4cdb9e7ca770">target_can_accel_watchpoint_condition</a> (loc2-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>, 
<a name="l06700"></a>06700                                                     loc2-&gt;<a class="code" href="structbp__location.html#a3d4ad6914964554ca761607f9e8fab62">length</a>,
<a name="l06701"></a>06701                                                     loc2-&gt;<a class="code" href="structbp__location.html#a0480880dc590f47b72d7af91ab5d5802">watchpoint_type</a>,
<a name="l06702"></a>06702                                                     w2-&gt;cond_exp)))
<a name="l06703"></a>06703     <span class="keywordflow">return</span> 0;
<a name="l06704"></a>06704 
<a name="l06705"></a>06705   <span class="comment">/* Note that this checks the owner&#39;s type, not the location&#39;s.  In</span>
<a name="l06706"></a>06706 <span class="comment">     case the target does not support read watchpoints, but does</span>
<a name="l06707"></a>06707 <span class="comment">     support access watchpoints, we&#39;ll have bp_read_watchpoint</span>
<a name="l06708"></a>06708 <span class="comment">     watchpoints with hw_access locations.  Those should be considered</span>
<a name="l06709"></a>06709 <span class="comment">     duplicates of hw_read locations.  The hw_read locations will</span>
<a name="l06710"></a>06710 <span class="comment">     become hw_access locations later.  */</span>
<a name="l06711"></a>06711   <span class="keywordflow">return</span> (loc1-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == loc2-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a>
<a name="l06712"></a>06712           &amp;&amp; loc1-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a>-&gt;<a class="code" href="structprogram__space.html#abf2a489f5ed3c1d5cad74d14dbb318e4">aspace</a> == loc2-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a>-&gt;<a class="code" href="structprogram__space.html#abf2a489f5ed3c1d5cad74d14dbb318e4">aspace</a>
<a name="l06713"></a>06713           &amp;&amp; loc1-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a> == loc2-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>
<a name="l06714"></a>06714           &amp;&amp; loc1-&gt;<a class="code" href="structbp__location.html#a3d4ad6914964554ca761607f9e8fab62">length</a> == loc2-&gt;<a class="code" href="structbp__location.html#a3d4ad6914964554ca761607f9e8fab62">length</a>);
<a name="l06715"></a>06715 }
<a name="l06716"></a>06716 
<a name="l06717"></a>06717 <span class="comment">/* Returns true if {ASPACE1,ADDR1} and {ASPACE2,ADDR2} represent the</span>
<a name="l06718"></a>06718 <span class="comment">   same breakpoint location.  In most targets, this can only be true</span>
<a name="l06719"></a>06719 <span class="comment">   if ASPACE1 matches ASPACE2.  On targets that have global</span>
<a name="l06720"></a>06720 <span class="comment">   breakpoints, the address space doesn&#39;t really matter.  */</span>
<a name="l06721"></a>06721 
<a name="l06722"></a>06722 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l06723"></a>06723 breakpoint_address_match (<span class="keyword">struct</span> address_space *aspace1, <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> addr1,
<a name="l06724"></a>06724                           <span class="keyword">struct</span> address_space *aspace2, <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> addr2)
<a name="l06725"></a>06725 {
<a name="l06726"></a>06726   <span class="keywordflow">return</span> ((<a class="code" href="gdbarch_8c.html#a5e7deb9f392fcd0f807759896fe00919">gdbarch_has_global_breakpoints</a> (<a class="code" href="gdbarch_8c.html#ad648a33f69abe34e9679744a0c5a0580">target_gdbarch</a> ())
<a name="l06727"></a>06727            || aspace1 == aspace2)
<a name="l06728"></a>06728           &amp;&amp; addr1 == addr2);
<a name="l06729"></a>06729 }
<a name="l06730"></a>06730 
<a name="l06731"></a>06731 <span class="comment">/* Returns true if {ASPACE2,ADDR2} falls within the range determined by</span>
<a name="l06732"></a>06732 <span class="comment">   {ASPACE1,ADDR1,LEN1}.  In most targets, this can only be true if ASPACE1</span>
<a name="l06733"></a>06733 <span class="comment">   matches ASPACE2.  On targets that have global breakpoints, the address</span>
<a name="l06734"></a>06734 <span class="comment">   space doesn&#39;t really matter.  */</span>
<a name="l06735"></a>06735 
<a name="l06736"></a>06736 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l06737"></a>06737 breakpoint_address_match_range (<span class="keyword">struct</span> address_space *aspace1, <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> addr1,
<a name="l06738"></a>06738                                 <span class="keywordtype">int</span> len1, <span class="keyword">struct</span> address_space *aspace2,
<a name="l06739"></a>06739                                 <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> addr2)
<a name="l06740"></a>06740 {
<a name="l06741"></a>06741   <span class="keywordflow">return</span> ((<a class="code" href="gdbarch_8c.html#a5e7deb9f392fcd0f807759896fe00919">gdbarch_has_global_breakpoints</a> (<a class="code" href="gdbarch_8c.html#ad648a33f69abe34e9679744a0c5a0580">target_gdbarch</a> ())
<a name="l06742"></a>06742            || aspace1 == aspace2)
<a name="l06743"></a>06743           &amp;&amp; addr2 &gt;= addr1 &amp;&amp; addr2 &lt; addr1 + len1);
<a name="l06744"></a>06744 }
<a name="l06745"></a>06745 
<a name="l06746"></a>06746 <span class="comment">/* Returns true if {ASPACE,ADDR} matches the breakpoint BL.  BL may be</span>
<a name="l06747"></a>06747 <span class="comment">   a ranged breakpoint.  In most targets, a match happens only if ASPACE</span>
<a name="l06748"></a>06748 <span class="comment">   matches the breakpoint&#39;s address space.  On targets that have global</span>
<a name="l06749"></a>06749 <span class="comment">   breakpoints, the address space doesn&#39;t really matter.  */</span>
<a name="l06750"></a>06750 
<a name="l06751"></a>06751 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l06752"></a>06752 breakpoint_location_address_match (<span class="keyword">struct</span> bp_location *bl,
<a name="l06753"></a>06753                                    <span class="keyword">struct</span> address_space *aspace,
<a name="l06754"></a>06754                                    <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> addr)
<a name="l06755"></a>06755 {
<a name="l06756"></a>06756   <span class="keywordflow">return</span> (breakpoint_address_match (bl-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a>-&gt;<a class="code" href="structprogram__space.html#abf2a489f5ed3c1d5cad74d14dbb318e4">aspace</a>, bl-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>,
<a name="l06757"></a>06757                                     aspace, addr)
<a name="l06758"></a>06758           || (bl-&gt;<a class="code" href="structbp__location.html#a3d4ad6914964554ca761607f9e8fab62">length</a>
<a name="l06759"></a>06759               &amp;&amp; breakpoint_address_match_range (bl-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a>-&gt;<a class="code" href="structprogram__space.html#abf2a489f5ed3c1d5cad74d14dbb318e4">aspace</a>,
<a name="l06760"></a>06760                                                  bl-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>, bl-&gt;<a class="code" href="structbp__location.html#a3d4ad6914964554ca761607f9e8fab62">length</a>,
<a name="l06761"></a>06761                                                  aspace, addr)));
<a name="l06762"></a>06762 }
<a name="l06763"></a>06763 
<a name="l06764"></a>06764 <span class="comment">/* If LOC1 and LOC2&#39;s owners are not tracepoints, returns false directly.</span>
<a name="l06765"></a>06765 <span class="comment">   Then, if LOC1 and LOC2 represent the same tracepoint location, returns</span>
<a name="l06766"></a>06766 <span class="comment">   true, otherwise returns false.  */</span>
<a name="l06767"></a>06767 
<a name="l06768"></a>06768 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l06769"></a>06769 tracepoint_locations_match (<span class="keyword">struct</span> bp_location *loc1,
<a name="l06770"></a>06770                             <span class="keyword">struct</span> bp_location *loc2)
<a name="l06771"></a>06771 {
<a name="l06772"></a>06772   <span class="keywordflow">if</span> (<a class="code" href="breakpoint_8c.html#ac537492fb781218601862c78225bd118">is_tracepoint</a> (loc1-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>) &amp;&amp; <a class="code" href="breakpoint_8c.html#ac537492fb781218601862c78225bd118">is_tracepoint</a> (loc2-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>))
<a name="l06773"></a>06773     <span class="comment">/* Since tracepoint locations are never duplicated with others&#39;, tracepoint</span>
<a name="l06774"></a>06774 <span class="comment">       locations at the same address of different tracepoints are regarded as</span>
<a name="l06775"></a>06775 <span class="comment">       different locations.  */</span>
<a name="l06776"></a>06776     <span class="keywordflow">return</span> (loc1-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a> == loc2-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a> &amp;&amp; loc1-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a> == loc2-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>);
<a name="l06777"></a>06777   <span class="keywordflow">else</span>
<a name="l06778"></a>06778     <span class="keywordflow">return</span> 0;
<a name="l06779"></a>06779 }
<a name="l06780"></a>06780 
<a name="l06781"></a>06781 <span class="comment">/* Assuming LOC1 and LOC2&#39;s types&#39; have meaningful target addresses</span>
<a name="l06782"></a>06782 <span class="comment">   (breakpoint_address_is_meaningful), returns true if LOC1 and LOC2</span>
<a name="l06783"></a>06783 <span class="comment">   represent the same location.  */</span>
<a name="l06784"></a>06784 
<a name="l06785"></a>06785 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l06786"></a>06786 breakpoint_locations_match (<span class="keyword">struct</span> bp_location *loc1, 
<a name="l06787"></a>06787                             <span class="keyword">struct</span> bp_location *loc2)
<a name="l06788"></a>06788 {
<a name="l06789"></a>06789   <span class="keywordtype">int</span> hw_point1, hw_point2;
<a name="l06790"></a>06790 
<a name="l06791"></a>06791   <span class="comment">/* Both of them must not be in moribund_locations.  */</span>
<a name="l06792"></a>06792   <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (loc1-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a> != NULL);
<a name="l06793"></a>06793   <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (loc2-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a> != NULL);
<a name="l06794"></a>06794 
<a name="l06795"></a>06795   hw_point1 = is_hardware_watchpoint (loc1-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>);
<a name="l06796"></a>06796   hw_point2 = is_hardware_watchpoint (loc2-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>);
<a name="l06797"></a>06797 
<a name="l06798"></a>06798   <span class="keywordflow">if</span> (hw_point1 != hw_point2)
<a name="l06799"></a>06799     <span class="keywordflow">return</span> 0;
<a name="l06800"></a>06800   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (hw_point1)
<a name="l06801"></a>06801     <span class="keywordflow">return</span> watchpoint_locations_match (loc1, loc2);
<a name="l06802"></a>06802   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="breakpoint_8c.html#ac537492fb781218601862c78225bd118">is_tracepoint</a> (loc1-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>) || <a class="code" href="breakpoint_8c.html#ac537492fb781218601862c78225bd118">is_tracepoint</a> (loc2-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>))
<a name="l06803"></a>06803     <span class="keywordflow">return</span> tracepoint_locations_match (loc1, loc2);
<a name="l06804"></a>06804   <span class="keywordflow">else</span>
<a name="l06805"></a>06805     <span class="comment">/* We compare bp_location.length in order to cover ranged breakpoints.  */</span>
<a name="l06806"></a>06806     <span class="keywordflow">return</span> (breakpoint_address_match (loc1-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a>-&gt;<a class="code" href="structprogram__space.html#abf2a489f5ed3c1d5cad74d14dbb318e4">aspace</a>, loc1-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>,
<a name="l06807"></a>06807                                      loc2-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a>-&gt;<a class="code" href="structprogram__space.html#abf2a489f5ed3c1d5cad74d14dbb318e4">aspace</a>, loc2-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>)
<a name="l06808"></a>06808             &amp;&amp; loc1-&gt;<a class="code" href="structbp__location.html#a3d4ad6914964554ca761607f9e8fab62">length</a> == loc2-&gt;<a class="code" href="structbp__location.html#a3d4ad6914964554ca761607f9e8fab62">length</a>);
<a name="l06809"></a>06809 }
<a name="l06810"></a>06810 
<a name="l06811"></a>06811 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l06812"></a>06812 breakpoint_adjustment_warning (<a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> from_addr, <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> to_addr,
<a name="l06813"></a>06813                                <span class="keywordtype">int</span> bnum, <span class="keywordtype">int</span> have_bnum)
<a name="l06814"></a>06814 {
<a name="l06815"></a>06815   <span class="comment">/* The longest string possibly returned by hex_string_custom</span>
<a name="l06816"></a>06816 <span class="comment">     is 50 chars.  These must be at least that big for safety.  */</span>
<a name="l06817"></a>06817   <span class="keywordtype">char</span> astr1[64];
<a name="l06818"></a>06818   <span class="keywordtype">char</span> astr2[64];
<a name="l06819"></a>06819 
<a name="l06820"></a>06820   strcpy (astr1, <a class="code" href="utils_8c.html#a50cfc2d5051f9377facea0f5c5fd6c8a">hex_string_custom</a> ((<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>) from_addr, 8));
<a name="l06821"></a>06821   strcpy (astr2, <a class="code" href="utils_8c.html#a50cfc2d5051f9377facea0f5c5fd6c8a">hex_string_custom</a> ((<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>) to_addr, 8));
<a name="l06822"></a>06822   <span class="keywordflow">if</span> (have_bnum)
<a name="l06823"></a>06823     <a class="code" href="utils_8c.html#a5fc201a4181499a6b4057a6caa15b5e2">warning</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Breakpoint %d address previously adjusted from %s to %s.&quot;</span>),
<a name="l06824"></a>06824              bnum, astr1, astr2);
<a name="l06825"></a>06825   <span class="keywordflow">else</span>
<a name="l06826"></a>06826     <a class="code" href="utils_8c.html#a5fc201a4181499a6b4057a6caa15b5e2">warning</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Breakpoint address adjusted from %s to %s.&quot;</span>), astr1, astr2);
<a name="l06827"></a>06827 }
<a name="l06828"></a>06828 
<a name="l06829"></a>06829 <span class="comment">/* Adjust a breakpoint&#39;s address to account for architectural</span>
<a name="l06830"></a>06830 <span class="comment">   constraints on breakpoint placement.  Return the adjusted address.</span>
<a name="l06831"></a>06831 <span class="comment">   Note: Very few targets require this kind of adjustment.  For most</span>
<a name="l06832"></a>06832 <span class="comment">   targets, this function is simply the identity function.  */</span>
<a name="l06833"></a>06833 
<a name="l06834"></a>06834 <span class="keyword">static</span> <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a>
<a name="l06835"></a>06835 adjust_breakpoint_address (<span class="keyword">struct</span> gdbarch *gdbarch,
<a name="l06836"></a>06836                            <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> bpaddr, <span class="keyword">enum</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cf">bptype</a> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cf">bptype</a>)
<a name="l06837"></a>06837 {
<a name="l06838"></a>06838   <span class="keywordflow">if</span> (!<a class="code" href="gdbarch_8c.html#acf6b850f3b582dfc0c995f9257540426">gdbarch_adjust_breakpoint_address_p</a> (gdbarch))
<a name="l06839"></a>06839     {
<a name="l06840"></a>06840       <span class="comment">/* Very few targets need any kind of breakpoint adjustment.  */</span>
<a name="l06841"></a>06841       <span class="keywordflow">return</span> bpaddr;
<a name="l06842"></a>06842     }
<a name="l06843"></a>06843   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bptype == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa2a35cc5d65b66d6228def5615d6827ce">bp_watchpoint</a>
<a name="l06844"></a>06844            || bptype == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfae38a33f5a6725fbca8b5da2d491cfbcb">bp_hardware_watchpoint</a>
<a name="l06845"></a>06845            || bptype == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa7013ee22be60f470b10b2de2f9d22c21">bp_read_watchpoint</a>
<a name="l06846"></a>06846            || bptype == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa9148c330e0f813ed6fb421af9d7da820">bp_access_watchpoint</a>
<a name="l06847"></a>06847            || bptype == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa8ebb961cef940b8ddef84696b7ac9694">bp_catchpoint</a>)
<a name="l06848"></a>06848     {
<a name="l06849"></a>06849       <span class="comment">/* Watchpoints and the various bp_catch_* eventpoints should not</span>
<a name="l06850"></a>06850 <span class="comment">         have their addresses modified.  */</span>
<a name="l06851"></a>06851       <span class="keywordflow">return</span> bpaddr;
<a name="l06852"></a>06852     }
<a name="l06853"></a>06853   <span class="keywordflow">else</span>
<a name="l06854"></a>06854     {
<a name="l06855"></a>06855       <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> adjusted_bpaddr;
<a name="l06856"></a>06856 
<a name="l06857"></a>06857       <span class="comment">/* Some targets have architectural constraints on the placement</span>
<a name="l06858"></a>06858 <span class="comment">         of breakpoint instructions.  Obtain the adjusted address.  */</span>
<a name="l06859"></a>06859       adjusted_bpaddr = <a class="code" href="gdbarch_8c.html#a0a56007a177e090249853d3edb46d8af">gdbarch_adjust_breakpoint_address</a> (gdbarch, bpaddr);
<a name="l06860"></a>06860 
<a name="l06861"></a>06861       <span class="comment">/* An adjusted breakpoint address can significantly alter</span>
<a name="l06862"></a>06862 <span class="comment">         a user&#39;s expectations.  Print a warning if an adjustment</span>
<a name="l06863"></a>06863 <span class="comment">         is required.  */</span>
<a name="l06864"></a>06864       <span class="keywordflow">if</span> (adjusted_bpaddr != bpaddr)
<a name="l06865"></a>06865         breakpoint_adjustment_warning (bpaddr, adjusted_bpaddr, 0, 0);
<a name="l06866"></a>06866 
<a name="l06867"></a>06867       <span class="keywordflow">return</span> adjusted_bpaddr;
<a name="l06868"></a>06868     }
<a name="l06869"></a>06869 }
<a name="l06870"></a>06870 
<a name="l06871"></a>06871 <span class="keywordtype">void</span>
<a name="l06872"></a><a class="code" href="breakpoint_8h.html#ae971720e6c09c471408d173beee367cd">06872</a> <a class="code" href="breakpoint_8c.html#ae971720e6c09c471408d173beee367cd">init_bp_location</a> (<span class="keyword">struct</span> bp_location *loc, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structbp__location__ops.html">bp_location_ops</a> *ops,
<a name="l06873"></a>06873                   <span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *owner)
<a name="l06874"></a>06874 {
<a name="l06875"></a>06875   <a class="code" href="gdb__string_8h.html#adb03df3679ce1445e801310614624ccb">memset</a> (loc, 0, <span class="keyword">sizeof</span> (*loc));
<a name="l06876"></a>06876 
<a name="l06877"></a>06877   <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (ops != NULL);
<a name="l06878"></a>06878 
<a name="l06879"></a>06879   loc-&gt;<a class="code" href="structbp__location.html#aade853db785628c27654d2e4f5c520b6">ops</a> = ops;
<a name="l06880"></a>06880   loc-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a> = owner;
<a name="l06881"></a>06881   loc-&gt;<a class="code" href="structbp__location.html#a1594433a0c3734e79b98d8296984ec7a">cond</a> = NULL;
<a name="l06882"></a>06882   loc-&gt;<a class="code" href="structbp__location.html#ae8f603085b6974cd8f01aef7a833e6e9">cond_bytecode</a> = NULL;
<a name="l06883"></a>06883   loc-&gt;<a class="code" href="structbp__location.html#a3732b41958ed311106bffd202cbfe4ff">shlib_disabled</a> = 0;
<a name="l06884"></a>06884   loc-&gt;<a class="code" href="structbp__location.html#abe93e091d18373d27bda3ad3eb6316f8">enabled</a> = 1;
<a name="l06885"></a>06885 
<a name="l06886"></a>06886   <span class="keywordflow">switch</span> (owner-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a>)
<a name="l06887"></a>06887     {
<a name="l06888"></a>06888     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa17768c2bd9137ec6e30c922c5c1d0ffa">bp_breakpoint</a>:
<a name="l06889"></a>06889     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa8e5fb22bf54672648756e2431a7827b6">bp_until</a>:
<a name="l06890"></a>06890     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa86f9369de92fbd10422ccc3d4ea68a20">bp_finish</a>:
<a name="l06891"></a>06891     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa4ca499075e7b45a6ff9b546b71860124">bp_longjmp</a>:
<a name="l06892"></a>06892     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfad27e062da5217e29ab1a859e41946669">bp_longjmp_resume</a>:
<a name="l06893"></a>06893     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa2bc2f9a597a0b3730d45e715048f76d3">bp_longjmp_call_dummy</a>:
<a name="l06894"></a>06894     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfae83abf56e7e24d4c7b7c63e78dc3e270">bp_exception</a>:
<a name="l06895"></a>06895     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa190706cc3be7f60fa934d8aa83f533de">bp_exception_resume</a>:
<a name="l06896"></a>06896     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa47c0a1a603215fb93c5db2cbb15e1edc">bp_step_resume</a>:
<a name="l06897"></a>06897     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfacb66952952620a78cd9e0f6c84078395">bp_hp_step_resume</a>:
<a name="l06898"></a>06898     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfad6bfd2f2654949462085c78f02480366">bp_watchpoint_scope</a>:
<a name="l06899"></a>06899     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa9ea01014e7cd4e2bb4ed925696cc0e8d">bp_call_dummy</a>:
<a name="l06900"></a>06900     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa84b6ba381a94da7c15136d8dcc87c5f2">bp_std_terminate</a>:
<a name="l06901"></a>06901     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa7ff3ee755a0635e1c8aa45bbeba6734a">bp_shlib_event</a>:
<a name="l06902"></a>06902     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa363ddd674339fdbb98fc4b0525905172">bp_thread_event</a>:
<a name="l06903"></a>06903     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa5bd9bbdb42933350595475584c48d844">bp_overlay_event</a>:
<a name="l06904"></a>06904     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfaa189ad5fdf786f2921ba9635bdb926fe">bp_jit_event</a>:
<a name="l06905"></a>06905     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfad159b4f5b0a64a88067c3d310ebed7ce">bp_longjmp_master</a>:
<a name="l06906"></a>06906     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa0d6052d15a11c79e0c6703aeef4148ba">bp_std_terminate_master</a>:
<a name="l06907"></a>06907     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa6d04f06608676691bf5f211117427b48">bp_exception_master</a>:
<a name="l06908"></a>06908     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfaa264cea9a07a1fbe63f2047913425831">bp_gnu_ifunc_resolver</a>:
<a name="l06909"></a>06909     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa0c1132c466edadde3a01fe7ef5334ca2">bp_gnu_ifunc_resolver_return</a>:
<a name="l06910"></a>06910     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa404b00503edb7eba238aea705ea34231">bp_dprintf</a>:
<a name="l06911"></a>06911       loc-&gt;<a class="code" href="structbp__location.html#aefe49818487e5876fc995f7831e2e809">loc_type</a> = <a class="code" href="breakpoint_8h.html#ad7006ab95a9d2493c6ad2c685f45f5dcaa74492f6095e7a1ae08e3eed468ba47d">bp_loc_software_breakpoint</a>;
<a name="l06912"></a>06912       mark_breakpoint_location_modified (loc);
<a name="l06913"></a>06913       <span class="keywordflow">break</span>;
<a name="l06914"></a>06914     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa657fad68a9d83a24532fb06715b77628">bp_hardware_breakpoint</a>:
<a name="l06915"></a>06915       loc-&gt;<a class="code" href="structbp__location.html#aefe49818487e5876fc995f7831e2e809">loc_type</a> = <a class="code" href="breakpoint_8h.html#ad7006ab95a9d2493c6ad2c685f45f5dca4a1949653a3b3c36db5cb269a46adb60">bp_loc_hardware_breakpoint</a>;
<a name="l06916"></a>06916       mark_breakpoint_location_modified (loc);
<a name="l06917"></a>06917       <span class="keywordflow">break</span>;
<a name="l06918"></a>06918     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfae38a33f5a6725fbca8b5da2d491cfbcb">bp_hardware_watchpoint</a>:
<a name="l06919"></a>06919     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa7013ee22be60f470b10b2de2f9d22c21">bp_read_watchpoint</a>:
<a name="l06920"></a>06920     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa9148c330e0f813ed6fb421af9d7da820">bp_access_watchpoint</a>:
<a name="l06921"></a>06921       loc-&gt;<a class="code" href="structbp__location.html#aefe49818487e5876fc995f7831e2e809">loc_type</a> = <a class="code" href="breakpoint_8h.html#ad7006ab95a9d2493c6ad2c685f45f5dcaf30d35565c228c0d80de4d7af9d9fbd2">bp_loc_hardware_watchpoint</a>;
<a name="l06922"></a>06922       <span class="keywordflow">break</span>;
<a name="l06923"></a>06923     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa2a35cc5d65b66d6228def5615d6827ce">bp_watchpoint</a>:
<a name="l06924"></a>06924     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa8ebb961cef940b8ddef84696b7ac9694">bp_catchpoint</a>:
<a name="l06925"></a>06925     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfae87f3c5422e7ecec815f5cb7254b4b4c">bp_tracepoint</a>:
<a name="l06926"></a>06926     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa563d27bd02a1303a86081828b40002db">bp_fast_tracepoint</a>:
<a name="l06927"></a>06927     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfae4357544e8e764b68ef3729aa9ac2be3">bp_static_tracepoint</a>:
<a name="l06928"></a>06928       loc-&gt;<a class="code" href="structbp__location.html#aefe49818487e5876fc995f7831e2e809">loc_type</a> = <a class="code" href="breakpoint_8h.html#ad7006ab95a9d2493c6ad2c685f45f5dca7e299c37c01da7ced4469575ef811ee2">bp_loc_other</a>;
<a name="l06929"></a>06929       <span class="keywordflow">break</span>;
<a name="l06930"></a>06930     <span class="keywordflow">default</span>:
<a name="l06931"></a>06931       <a class="code" href="common-utils_8h.html#aa14285d9d3d4171016ef9cf09447e8bb">internal_error</a> (__FILE__, __LINE__, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;unknown breakpoint type&quot;</span>));
<a name="l06932"></a>06932     }
<a name="l06933"></a>06933 
<a name="l06934"></a>06934   loc-&gt;<a class="code" href="structbp__location.html#a426e2ce4c5d41b652ce3ea269b26218a">refc</a> = 1;
<a name="l06935"></a>06935 }
<a name="l06936"></a>06936 
<a name="l06937"></a>06937 <span class="comment">/* Allocate a struct bp_location.  */</span>
<a name="l06938"></a>06938 
<a name="l06939"></a>06939 <span class="keyword">static</span> <span class="keyword">struct </span>bp_location *
<a name="l06940"></a>06940 allocate_bp_location (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *bpt)
<a name="l06941"></a>06941 {
<a name="l06942"></a>06942   <span class="keywordflow">return</span> bpt-&gt;<a class="code" href="structbreakpoint.html#aba258aa23496f6434aaa1cf8c8dc7ea7">ops</a>-&gt;<a class="code" href="structbreakpoint__ops.html#af3730c70eacc8638a63a7ce00581efdc">allocate_location</a> (bpt);
<a name="l06943"></a>06943 }
<a name="l06944"></a>06944 
<a name="l06945"></a>06945 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l06946"></a>06946 free_bp_location (<span class="keyword">struct</span> bp_location *loc)
<a name="l06947"></a>06947 {
<a name="l06948"></a>06948   loc-&gt;<a class="code" href="structbp__location.html#aade853db785628c27654d2e4f5c520b6">ops</a>-&gt;<a class="code" href="structbp__location__ops.html#afbc0a2ebfed5e7872e60b093b80a0fed">dtor</a> (loc);
<a name="l06949"></a>06949   <a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a> (loc);
<a name="l06950"></a>06950 }
<a name="l06951"></a>06951 
<a name="l06952"></a>06952 <span class="comment">/* Increment reference count.  */</span>
<a name="l06953"></a>06953 
<a name="l06954"></a>06954 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l06955"></a>06955 incref_bp_location (<span class="keyword">struct</span> bp_location *bl)
<a name="l06956"></a>06956 {
<a name="l06957"></a>06957   ++bl-&gt;<a class="code" href="structbp__location.html#a426e2ce4c5d41b652ce3ea269b26218a">refc</a>;
<a name="l06958"></a>06958 }
<a name="l06959"></a>06959 
<a name="l06960"></a>06960 <span class="comment">/* Decrement reference count.  If the reference count reaches 0,</span>
<a name="l06961"></a>06961 <span class="comment">   destroy the bp_location.  Sets *BLP to NULL.  */</span>
<a name="l06962"></a>06962 
<a name="l06963"></a>06963 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l06964"></a>06964 decref_bp_location (<span class="keyword">struct</span> bp_location **blp)
<a name="l06965"></a>06965 {
<a name="l06966"></a>06966   <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> ((*blp)-&gt;refc &gt; 0);
<a name="l06967"></a>06967 
<a name="l06968"></a>06968   <span class="keywordflow">if</span> (--(*blp)-&gt;refc == 0)
<a name="l06969"></a>06969     free_bp_location (*blp);
<a name="l06970"></a>06970   *blp = NULL;
<a name="l06971"></a>06971 }
<a name="l06972"></a>06972 
<a name="l06973"></a>06973 <span class="comment">/* Add breakpoint B at the end of the global breakpoint chain.  */</span>
<a name="l06974"></a>06974 
<a name="l06975"></a>06975 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l06976"></a>06976 add_to_breakpoint_chain (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b)
<a name="l06977"></a>06977 {
<a name="l06978"></a>06978   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b1;
<a name="l06979"></a>06979 
<a name="l06980"></a>06980   <span class="comment">/* Add this breakpoint to the end of the chain so that a list of</span>
<a name="l06981"></a>06981 <span class="comment">     breakpoints will come out in order of increasing numbers.  */</span>
<a name="l06982"></a>06982 
<a name="l06983"></a>06983   b1 = <a class="code" href="breakpoint_8c.html#a1c06bbc271c9a0aced429d597a65c28c">breakpoint_chain</a>;
<a name="l06984"></a>06984   <span class="keywordflow">if</span> (b1 == 0)
<a name="l06985"></a>06985     breakpoint_chain = b;
<a name="l06986"></a>06986   <span class="keywordflow">else</span>
<a name="l06987"></a>06987     {
<a name="l06988"></a>06988       <span class="keywordflow">while</span> (b1-&gt;<a class="code" href="structbreakpoint.html#a30f997b48b04a520ea99e35a74451933">next</a>)
<a name="l06989"></a>06989         b1 = b1-&gt;<a class="code" href="structbreakpoint.html#a30f997b48b04a520ea99e35a74451933">next</a>;
<a name="l06990"></a>06990       b1-&gt;<a class="code" href="structbreakpoint.html#a30f997b48b04a520ea99e35a74451933">next</a> = b;
<a name="l06991"></a>06991     }
<a name="l06992"></a>06992 }
<a name="l06993"></a>06993 
<a name="l06994"></a>06994 <span class="comment">/* Initializes breakpoint B with type BPTYPE and no locations yet.  */</span>
<a name="l06995"></a>06995 
<a name="l06996"></a>06996 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l06997"></a>06997 init_raw_breakpoint_without_location (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b,
<a name="l06998"></a>06998                                       <span class="keyword">struct</span> gdbarch *gdbarch,
<a name="l06999"></a>06999                                       <span class="keyword">enum</span> bptype bptype,
<a name="l07000"></a>07000                                       <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structbreakpoint__ops.html">breakpoint_ops</a> *<a class="code" href="structbreakpoint.html#aba258aa23496f6434aaa1cf8c8dc7ea7">ops</a>)
<a name="l07001"></a>07001 {
<a name="l07002"></a>07002   <a class="code" href="gdb__string_8h.html#adb03df3679ce1445e801310614624ccb">memset</a> (b, 0, <span class="keyword">sizeof</span> (*b));
<a name="l07003"></a>07003 
<a name="l07004"></a>07004   <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (ops != NULL);
<a name="l07005"></a>07005 
<a name="l07006"></a>07006   b-&gt;<a class="code" href="structbreakpoint.html#aba258aa23496f6434aaa1cf8c8dc7ea7">ops</a> = <a class="code" href="structbreakpoint.html#aba258aa23496f6434aaa1cf8c8dc7ea7">ops</a>;
<a name="l07007"></a>07007   b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> = <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cf">bptype</a>;
<a name="l07008"></a>07008   b-&gt;<a class="code" href="structbreakpoint.html#aa044541ad4e4e66cf23affcd6d8b1759">gdbarch</a> = <a class="code" href="structbreakpoint.html#aa044541ad4e4e66cf23affcd6d8b1759">gdbarch</a>;
<a name="l07009"></a>07009   b-&gt;<a class="code" href="structbreakpoint.html#adb277de5c8fe68b963cd04aefab977e7">language</a> = <a class="code" href="language_8c.html#acd2505a014a95629da9c836f8914fc79">current_language</a>-&gt;<a class="code" href="structlanguage__defn.html#a1395b7eb05a09e5798dc29257f30810a">la_language</a>;
<a name="l07010"></a>07010   b-&gt;<a class="code" href="structbreakpoint.html#acdacf7dbb73ba99f07e19f32e2d389d1">input_radix</a> = <a class="code" href="defs_8h.html#a64e476dca2e961ebe24ba32289c77c4e">input_radix</a>;
<a name="l07011"></a>07011   b-&gt;<a class="code" href="structbreakpoint.html#ae8613b6d8cf464f30ea39597be0cc192">thread</a> = -1;
<a name="l07012"></a>07012   b-&gt;<a class="code" href="structbreakpoint.html#acb53352fd35aaad37054508fabc0f3bf">enable_state</a> = <a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577a72f1fa981d13a62d05324c1de974b44b">bp_enabled</a>;
<a name="l07013"></a>07013   b-&gt;<a class="code" href="structbreakpoint.html#a30f997b48b04a520ea99e35a74451933">next</a> = 0;
<a name="l07014"></a>07014   b-&gt;<a class="code" href="structbreakpoint.html#a7f6e5535a40a44f8f686da006afdf7b0">silent</a> = 0;
<a name="l07015"></a>07015   b-&gt;<a class="code" href="structbreakpoint.html#a0e1286b838f13a04031a220f81c04d2d">ignore_count</a> = 0;
<a name="l07016"></a>07016   b-&gt;<a class="code" href="structbreakpoint.html#a054780dffadb1a4af0fc35037834fe4b">commands</a> = NULL;
<a name="l07017"></a>07017   b-&gt;<a class="code" href="structbreakpoint.html#af65175451fdfdff660221d724c7c3cae">frame_id</a> = <a class="code" href="frame_8c.html#a0e92fecdd3b01549ccdc07795de2afee">null_frame_id</a>;
<a name="l07018"></a>07018   b-&gt;<a class="code" href="structbreakpoint.html#a565b2fa013dcbed6f07157c73c978577">condition_not_parsed</a> = 0;
<a name="l07019"></a>07019   b-&gt;<a class="code" href="structbreakpoint.html#aa0bcabd2a66e44f812a927b9ce574a13">py_bp_object</a> = NULL;
<a name="l07020"></a>07020   b-&gt;<a class="code" href="structbreakpoint.html#a7d9882daea896de8ff1f7981e9508500">related_breakpoint</a> = b;
<a name="l07021"></a>07021 }
<a name="l07022"></a>07022 
<a name="l07023"></a>07023 <span class="comment">/* Helper to set_raw_breakpoint below.  Creates a breakpoint</span>
<a name="l07024"></a>07024 <span class="comment">   that has type BPTYPE and has no locations as yet.  */</span>
<a name="l07025"></a>07025 
<a name="l07026"></a>07026 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *
<a name="l07027"></a>07027 set_raw_breakpoint_without_location (<span class="keyword">struct</span> gdbarch *gdbarch,
<a name="l07028"></a>07028                                      <span class="keyword">enum</span> bptype bptype,
<a name="l07029"></a>07029                                      <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structbreakpoint__ops.html">breakpoint_ops</a> *ops)
<a name="l07030"></a>07030 {
<a name="l07031"></a>07031   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b = XNEW (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a>);
<a name="l07032"></a>07032 
<a name="l07033"></a>07033   init_raw_breakpoint_without_location (b, gdbarch, bptype, ops);
<a name="l07034"></a>07034   add_to_breakpoint_chain (b);
<a name="l07035"></a>07035   <span class="keywordflow">return</span> b;
<a name="l07036"></a>07036 }
<a name="l07037"></a>07037 
<a name="l07038"></a>07038 <span class="comment">/* Initialize loc-&gt;function_name.  EXPLICIT_LOC says no indirect function</span>
<a name="l07039"></a>07039 <span class="comment">   resolutions should be made as the user specified the location explicitly</span>
<a name="l07040"></a>07040 <span class="comment">   enough.  */</span>
<a name="l07041"></a>07041 
<a name="l07042"></a>07042 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l07043"></a>07043 set_breakpoint_location_function (<span class="keyword">struct</span> bp_location *loc, <span class="keywordtype">int</span> explicit_loc)
<a name="l07044"></a>07044 {
<a name="l07045"></a>07045   <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (loc-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a> != NULL);
<a name="l07046"></a>07046 
<a name="l07047"></a>07047   <span class="keywordflow">if</span> (loc-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa17768c2bd9137ec6e30c922c5c1d0ffa">bp_breakpoint</a>
<a name="l07048"></a>07048       || loc-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa657fad68a9d83a24532fb06715b77628">bp_hardware_breakpoint</a>
<a name="l07049"></a>07049       || <a class="code" href="breakpoint_8c.html#ac537492fb781218601862c78225bd118">is_tracepoint</a> (loc-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>))
<a name="l07050"></a>07050     {
<a name="l07051"></a>07051       <span class="keywordtype">int</span> is_gnu_ifunc;
<a name="l07052"></a>07052       <span class="keyword">const</span> <span class="keywordtype">char</span> *function_name;
<a name="l07053"></a>07053       <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> func_addr;
<a name="l07054"></a>07054 
<a name="l07055"></a>07055       <a class="code" href="blockframe_8c.html#a137ac21d60d690456edfcf1e13aaeafc">find_pc_partial_function_gnu_ifunc</a> (loc-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>, &amp;function_name,
<a name="l07056"></a>07056                                           &amp;func_addr, NULL, &amp;is_gnu_ifunc);
<a name="l07057"></a>07057 
<a name="l07058"></a>07058       <span class="keywordflow">if</span> (is_gnu_ifunc &amp;&amp; !explicit_loc)
<a name="l07059"></a>07059         {
<a name="l07060"></a>07060           <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b = loc-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>;
<a name="l07061"></a>07061 
<a name="l07062"></a>07062           <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (loc-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a> == <a class="code" href="progspace_8c.html#a07722ff15a98814c086dda44f93380c9">current_program_space</a>);
<a name="l07063"></a>07063           <span class="keywordflow">if</span> (<a class="code" href="symtab_8h.html#a14c4f7c4e484b4e9b6f0f576d279026d">gnu_ifunc_resolve_name</a> (function_name,
<a name="l07064"></a>07064                                       &amp;loc-&gt;<a class="code" href="structbp__location.html#a4e316d8cab3c014aa85b8858d6223ce2">requested_address</a>))
<a name="l07065"></a>07065             {
<a name="l07066"></a>07066               <span class="comment">/* Recalculate ADDRESS based on new REQUESTED_ADDRESS.  */</span>
<a name="l07067"></a>07067               loc-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a> = adjust_breakpoint_address (loc-&gt;<a class="code" href="structbp__location.html#a55f3ff99d536775f5095f11e5f5c3f3e">gdbarch</a>,
<a name="l07068"></a>07068                                                         loc-&gt;<a class="code" href="structbp__location.html#a4e316d8cab3c014aa85b8858d6223ce2">requested_address</a>,
<a name="l07069"></a>07069                                                         b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a>);
<a name="l07070"></a>07070             }
<a name="l07071"></a>07071           <span class="keywordflow">else</span> <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa17768c2bd9137ec6e30c922c5c1d0ffa">bp_breakpoint</a> &amp;&amp; b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a> == loc
<a name="l07072"></a>07072                    &amp;&amp; loc-&gt;<a class="code" href="structbp__location.html#ab193cb38f87fea89105db96d94191541">next</a> == NULL &amp;&amp; b-&gt;<a class="code" href="structbreakpoint.html#a7d9882daea896de8ff1f7981e9508500">related_breakpoint</a> == b)
<a name="l07073"></a>07073             {
<a name="l07074"></a>07074               <span class="comment">/* Create only the whole new breakpoint of this type but do not</span>
<a name="l07075"></a>07075 <span class="comment">                 mess more complicated breakpoints with multiple locations.  */</span>
<a name="l07076"></a>07076               b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> = <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfaa264cea9a07a1fbe63f2047913425831">bp_gnu_ifunc_resolver</a>;
<a name="l07077"></a>07077               <span class="comment">/* Remember the resolver&#39;s address for use by the return</span>
<a name="l07078"></a>07078 <span class="comment">                 breakpoint.  */</span>
<a name="l07079"></a>07079               loc-&gt;<a class="code" href="structbp__location.html#a6ba6af6a63211889fc22a1ace34a8092">related_address</a> = func_addr;
<a name="l07080"></a>07080             }
<a name="l07081"></a>07081         }
<a name="l07082"></a>07082 
<a name="l07083"></a>07083       <span class="keywordflow">if</span> (function_name)
<a name="l07084"></a>07084         loc-&gt;<a class="code" href="structbp__location.html#aaaefbb59159defe719f775ae4fd0f7a7">function_name</a> = xstrdup (function_name);
<a name="l07085"></a>07085     }
<a name="l07086"></a>07086 }
<a name="l07087"></a>07087 
<a name="l07088"></a>07088 <span class="comment">/* Attempt to determine architecture of location identified by SAL.  */</span>
<a name="l07089"></a>07089 <span class="keyword">struct </span>gdbarch *
<a name="l07090"></a><a class="code" href="breakpoint_8h.html#ab44e7bca7511390e3baade6daeecf6cd">07090</a> <a class="code" href="breakpoint_8c.html#ab44e7bca7511390e3baade6daeecf6cd">get_sal_arch</a> (<span class="keyword">struct</span> <a class="code" href="structsymtab__and__line.html">symtab_and_line</a> sal)
<a name="l07091"></a>07091 {
<a name="l07092"></a>07092   <span class="keywordflow">if</span> (sal.<a class="code" href="structsymtab__and__line.html#a2e86134f04ab0e4d0834da476b7d020e">section</a>)
<a name="l07093"></a>07093     <span class="keywordflow">return</span> <a class="code" href="objfiles_8c.html#a1c7101234ac2edc601fa465e48bc3463">get_objfile_arch</a> (sal.<a class="code" href="structsymtab__and__line.html#a2e86134f04ab0e4d0834da476b7d020e">section</a>-&gt;<a class="code" href="structobj__section.html#a3dba4273f49b43a5e8c64bd29ac39ef1">objfile</a>);
<a name="l07094"></a>07094   <span class="keywordflow">if</span> (sal.<a class="code" href="structsymtab__and__line.html#a74216e171a96d8bcaab43fe69b49c599">symtab</a>)
<a name="l07095"></a>07095     <span class="keywordflow">return</span> <a class="code" href="objfiles_8c.html#a1c7101234ac2edc601fa465e48bc3463">get_objfile_arch</a> (sal.<a class="code" href="structsymtab__and__line.html#a74216e171a96d8bcaab43fe69b49c599">symtab</a>-&gt;<a class="code" href="structsymtab.html#a5fbe801333fb00c20190a6193b708be0">objfile</a>);
<a name="l07096"></a>07096 
<a name="l07097"></a>07097   <span class="keywordflow">return</span> NULL;
<a name="l07098"></a>07098 }
<a name="l07099"></a>07099 
<a name="l07100"></a>07100 <span class="comment">/* Low level routine for partially initializing a breakpoint of type</span>
<a name="l07101"></a>07101 <span class="comment">   BPTYPE.  The newly created breakpoint&#39;s address, section, source</span>
<a name="l07102"></a>07102 <span class="comment">   file name, and line number are provided by SAL.</span>
<a name="l07103"></a>07103 <span class="comment"></span>
<a name="l07104"></a>07104 <span class="comment">   It is expected that the caller will complete the initialization of</span>
<a name="l07105"></a>07105 <span class="comment">   the newly created breakpoint struct as well as output any status</span>
<a name="l07106"></a>07106 <span class="comment">   information regarding the creation of a new breakpoint.  */</span>
<a name="l07107"></a>07107 
<a name="l07108"></a>07108 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l07109"></a>07109 init_raw_breakpoint (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b, <span class="keyword">struct</span> gdbarch *gdbarch,
<a name="l07110"></a>07110                      <span class="keyword">struct</span> <a class="code" href="structsymtab__and__line.html">symtab_and_line</a> sal, <span class="keyword">enum</span> bptype bptype,
<a name="l07111"></a>07111                      <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structbreakpoint__ops.html">breakpoint_ops</a> *ops)
<a name="l07112"></a>07112 {
<a name="l07113"></a>07113   init_raw_breakpoint_without_location (b, gdbarch, bptype, ops);
<a name="l07114"></a>07114 
<a name="l07115"></a>07115   add_location_to_breakpoint (b, &amp;sal);
<a name="l07116"></a>07116 
<a name="l07117"></a>07117   <span class="keywordflow">if</span> (bptype != <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa8ebb961cef940b8ddef84696b7ac9694">bp_catchpoint</a>)
<a name="l07118"></a>07118     <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (sal.<a class="code" href="structsymtab__and__line.html#acc91f0276f4648cb5a970f17ddcbaf09">pspace</a> != NULL);
<a name="l07119"></a>07119 
<a name="l07120"></a>07120   <span class="comment">/* Store the program space that was used to set the breakpoint,</span>
<a name="l07121"></a>07121 <span class="comment">     except for ordinary breakpoints, which are independent of the</span>
<a name="l07122"></a>07122 <span class="comment">     program space.  */</span>
<a name="l07123"></a>07123   <span class="keywordflow">if</span> (bptype != <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa17768c2bd9137ec6e30c922c5c1d0ffa">bp_breakpoint</a> &amp;&amp; bptype != <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa657fad68a9d83a24532fb06715b77628">bp_hardware_breakpoint</a>)
<a name="l07124"></a>07124     b-&gt;<a class="code" href="structbreakpoint.html#a82f4fd8ee6ddee61f3529fbd747c78b2">pspace</a> = sal.<a class="code" href="structsymtab__and__line.html#acc91f0276f4648cb5a970f17ddcbaf09">pspace</a>;
<a name="l07125"></a>07125 }
<a name="l07126"></a>07126 
<a name="l07127"></a>07127 <span class="comment">/* set_raw_breakpoint is a low level routine for allocating and</span>
<a name="l07128"></a>07128 <span class="comment">   partially initializing a breakpoint of type BPTYPE.  The newly</span>
<a name="l07129"></a>07129 <span class="comment">   created breakpoint&#39;s address, section, source file name, and line</span>
<a name="l07130"></a>07130 <span class="comment">   number are provided by SAL.  The newly created and partially</span>
<a name="l07131"></a>07131 <span class="comment">   initialized breakpoint is added to the breakpoint chain and</span>
<a name="l07132"></a>07132 <span class="comment">   is also returned as the value of this function.</span>
<a name="l07133"></a>07133 <span class="comment"></span>
<a name="l07134"></a>07134 <span class="comment">   It is expected that the caller will complete the initialization of</span>
<a name="l07135"></a>07135 <span class="comment">   the newly created breakpoint struct as well as output any status</span>
<a name="l07136"></a>07136 <span class="comment">   information regarding the creation of a new breakpoint.  In</span>
<a name="l07137"></a>07137 <span class="comment">   particular, set_raw_breakpoint does NOT set the breakpoint</span>
<a name="l07138"></a>07138 <span class="comment">   number!  Care should be taken to not allow an error to occur</span>
<a name="l07139"></a>07139 <span class="comment">   prior to completing the initialization of the breakpoint.  If this</span>
<a name="l07140"></a>07140 <span class="comment">   should happen, a bogus breakpoint will be left on the chain.  */</span>
<a name="l07141"></a>07141 
<a name="l07142"></a>07142 <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *
<a name="l07143"></a>07143 <a class="code" href="breakpoint_8c.html#a99e75dcf89d9291dc55db2453cb16a0a">set_raw_breakpoint</a> (<span class="keyword">struct</span> gdbarch *gdbarch,
<a name="l07144"></a>07144                     <span class="keyword">struct</span> <a class="code" href="structsymtab__and__line.html">symtab_and_line</a> sal, <span class="keyword">enum</span> bptype bptype,
<a name="l07145"></a>07145                     <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structbreakpoint__ops.html">breakpoint_ops</a> *ops)
<a name="l07146"></a>07146 {
<a name="l07147"></a>07147   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b = XNEW (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a>);
<a name="l07148"></a>07148 
<a name="l07149"></a>07149   init_raw_breakpoint (b, gdbarch, sal, bptype, ops);
<a name="l07150"></a>07150   add_to_breakpoint_chain (b);
<a name="l07151"></a>07151   <span class="keywordflow">return</span> b;
<a name="l07152"></a>07152 }
<a name="l07153"></a>07153 
<a name="l07154"></a>07154 
<a name="l07155"></a>07155 <span class="comment">/* Note that the breakpoint object B describes a permanent breakpoint</span>
<a name="l07156"></a>07156 <span class="comment">   instruction, hard-wired into the inferior&#39;s code.  */</span>
<a name="l07157"></a>07157 <span class="keywordtype">void</span>
<a name="l07158"></a><a class="code" href="breakpoint_8h.html#a5aadf8c8fbd2d73d7e3ecff2a19baa34">07158</a> <a class="code" href="breakpoint_8c.html#a23d7b67630cc8572e7c3dc83c7dd9fe2">make_breakpoint_permanent</a> (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b)
<a name="l07159"></a>07159 {
<a name="l07160"></a>07160   <span class="keyword">struct </span>bp_location *bl;
<a name="l07161"></a>07161 
<a name="l07162"></a>07162   b-&gt;<a class="code" href="structbreakpoint.html#acb53352fd35aaad37054508fabc0f3bf">enable_state</a> = <a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577adbf2e9b210d33b1ac7e8a7ed87a2b46f">bp_permanent</a>;
<a name="l07163"></a>07163 
<a name="l07164"></a>07164   <span class="comment">/* By definition, permanent breakpoints are already present in the</span>
<a name="l07165"></a>07165 <span class="comment">     code.  Mark all locations as inserted.  For now,</span>
<a name="l07166"></a>07166 <span class="comment">     make_breakpoint_permanent is called in just one place, so it&#39;s</span>
<a name="l07167"></a>07167 <span class="comment">     hard to say if it&#39;s reasonable to have permanent breakpoint with</span>
<a name="l07168"></a>07168 <span class="comment">     multiple locations or not, but it&#39;s easy to implement.  */</span>
<a name="l07169"></a>07169   <span class="keywordflow">for</span> (bl = b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>; bl; bl = bl-&gt;<a class="code" href="structbp__location.html#ab193cb38f87fea89105db96d94191541">next</a>)
<a name="l07170"></a>07170     bl-&gt;<a class="code" href="structbp__location.html#acb0b475579bbe5dabeb8ed4504527105">inserted</a> = 1;
<a name="l07171"></a>07171 }
<a name="l07172"></a>07172 
<a name="l07173"></a>07173 <span class="comment">/* Call this routine when stepping and nexting to enable a breakpoint</span>
<a name="l07174"></a>07174 <span class="comment">   if we do a longjmp() or &#39;throw&#39; in TP.  FRAME is the frame which</span>
<a name="l07175"></a>07175 <span class="comment">   initiated the operation.  */</span>
<a name="l07176"></a>07176 
<a name="l07177"></a>07177 <span class="keywordtype">void</span>
<a name="l07178"></a><a class="code" href="breakpoint_8h.html#adf1ba914f17564f9ea1f92cea3619b20">07178</a> <a class="code" href="breakpoint_8c.html#adf1ba914f17564f9ea1f92cea3619b20">set_longjmp_breakpoint</a> (<span class="keyword">struct</span> <a class="code" href="structthread__info.html">thread_info</a> *tp, <span class="keyword">struct</span> <a class="code" href="structframe__id.html">frame_id</a> frame)
<a name="l07179"></a>07179 {
<a name="l07180"></a>07180   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b, *b_tmp;
<a name="l07181"></a>07181   <span class="keywordtype">int</span> thread = tp-&gt;<a class="code" href="structthread__info.html#a64accc7e3d39da1d926c23877f9f9d0d">num</a>;
<a name="l07182"></a>07182 
<a name="l07183"></a>07183   <span class="comment">/* To avoid having to rescan all objfile symbols at every step,</span>
<a name="l07184"></a>07184 <span class="comment">     we maintain a list of continually-inserted but always disabled</span>
<a name="l07185"></a>07185 <span class="comment">     longjmp &quot;master&quot; breakpoints.  Here, we simply create momentary</span>
<a name="l07186"></a>07186 <span class="comment">     clones of those and enable them for the requested thread.  */</span>
<a name="l07187"></a>07187   <a class="code" href="breakpoint_8c.html#ace15af58ae54149fbef6d72ecb61e12d">ALL_BREAKPOINTS_SAFE</a> (b, b_tmp)
<a name="l07188"></a>07188     <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#a82f4fd8ee6ddee61f3529fbd747c78b2">pspace</a> == <a class="code" href="progspace_8c.html#a07722ff15a98814c086dda44f93380c9">current_program_space</a>
<a name="l07189"></a>07189         &amp;&amp; (b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfad159b4f5b0a64a88067c3d310ebed7ce">bp_longjmp_master</a>
<a name="l07190"></a>07190             || b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa6d04f06608676691bf5f211117427b48">bp_exception_master</a>))
<a name="l07191"></a>07191       {
<a name="l07192"></a>07192         <span class="keyword">enum</span> bptype type = b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfad159b4f5b0a64a88067c3d310ebed7ce">bp_longjmp_master</a> ? <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa4ca499075e7b45a6ff9b546b71860124">bp_longjmp</a> : <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfae83abf56e7e24d4c7b7c63e78dc3e270">bp_exception</a>;
<a name="l07193"></a>07193         <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *clone;
<a name="l07194"></a>07194 
<a name="l07195"></a>07195         <span class="comment">/* longjmp_breakpoint_ops ensures INITIATING_FRAME is cleared again</span>
<a name="l07196"></a>07196 <span class="comment">           after their removal.  */</span>
<a name="l07197"></a>07197         clone = momentary_breakpoint_from_master (b, type,
<a name="l07198"></a>07198                                                   &amp;longjmp_breakpoint_ops);
<a name="l07199"></a>07199         clone-&gt;<a class="code" href="structbreakpoint.html#ae8613b6d8cf464f30ea39597be0cc192">thread</a> = <a class="code" href="structbreakpoint.html#ae8613b6d8cf464f30ea39597be0cc192">thread</a>;
<a name="l07200"></a>07200       }
<a name="l07201"></a>07201 
<a name="l07202"></a>07202   tp-&gt;<a class="code" href="structthread__info.html#a97f89589e47e0e6459e9ff0f92c3e2df">initiating_frame</a> = frame;
<a name="l07203"></a>07203 }
<a name="l07204"></a>07204 
<a name="l07205"></a>07205 <span class="comment">/* Delete all longjmp breakpoints from THREAD.  */</span>
<a name="l07206"></a>07206 <span class="keywordtype">void</span>
<a name="l07207"></a><a class="code" href="breakpoint_8h.html#adacf9780df5e8940a135544ff3ef96d6">07207</a> <a class="code" href="breakpoint_8c.html#adacf9780df5e8940a135544ff3ef96d6">delete_longjmp_breakpoint</a> (<span class="keywordtype">int</span> thread)
<a name="l07208"></a>07208 {
<a name="l07209"></a>07209   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b, *b_tmp;
<a name="l07210"></a>07210 
<a name="l07211"></a>07211   <a class="code" href="breakpoint_8c.html#ace15af58ae54149fbef6d72ecb61e12d">ALL_BREAKPOINTS_SAFE</a> (b, b_tmp)
<a name="l07212"></a>07212     <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa4ca499075e7b45a6ff9b546b71860124">bp_longjmp</a> || b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfae83abf56e7e24d4c7b7c63e78dc3e270">bp_exception</a>)
<a name="l07213"></a>07213       {
<a name="l07214"></a>07214         <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#ae8613b6d8cf464f30ea39597be0cc192">thread</a> == thread)
<a name="l07215"></a>07215           <a class="code" href="breakpoint_8c.html#a0701191361b1ed0d40d76661e88de3f4">delete_breakpoint</a> (b);
<a name="l07216"></a>07216       }
<a name="l07217"></a>07217 }
<a name="l07218"></a>07218 
<a name="l07219"></a>07219 <span class="keywordtype">void</span>
<a name="l07220"></a><a class="code" href="breakpoint_8h.html#ad1c8ec99b86af71c19aeea15683b5d5d">07220</a> <a class="code" href="breakpoint_8c.html#ad1c8ec99b86af71c19aeea15683b5d5d">delete_longjmp_breakpoint_at_next_stop</a> (<span class="keywordtype">int</span> thread)
<a name="l07221"></a>07221 {
<a name="l07222"></a>07222   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b, *b_tmp;
<a name="l07223"></a>07223 
<a name="l07224"></a>07224   <a class="code" href="breakpoint_8c.html#ace15af58ae54149fbef6d72ecb61e12d">ALL_BREAKPOINTS_SAFE</a> (b, b_tmp)
<a name="l07225"></a>07225     <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa4ca499075e7b45a6ff9b546b71860124">bp_longjmp</a> || b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfae83abf56e7e24d4c7b7c63e78dc3e270">bp_exception</a>)
<a name="l07226"></a>07226       {
<a name="l07227"></a>07227         <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#ae8613b6d8cf464f30ea39597be0cc192">thread</a> == thread)
<a name="l07228"></a>07228           b-&gt;<a class="code" href="structbreakpoint.html#a75f0f9a837eac292ab6e768e8d8f1bd7">disposition</a> = <a class="code" href="breakpoint_8h.html#a15f2bbd9012f59bc09d59feef0c15732a9b0a2ed54849261d15631bb5e654843b">disp_del_at_next_stop</a>;
<a name="l07229"></a>07229       }
<a name="l07230"></a>07230 }
<a name="l07231"></a>07231 
<a name="l07232"></a>07232 <span class="comment">/* Place breakpoints of type bp_longjmp_call_dummy to catch longjmp for</span>
<a name="l07233"></a>07233 <span class="comment">   INFERIOR_PTID thread.  Chain them all by RELATED_BREAKPOINT and return</span>
<a name="l07234"></a>07234 <span class="comment">   pointer to any of them.  Return NULL if this system cannot place longjmp</span>
<a name="l07235"></a>07235 <span class="comment">   breakpoints.  */</span>
<a name="l07236"></a>07236 
<a name="l07237"></a>07237 <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *
<a name="l07238"></a><a class="code" href="breakpoint_8h.html#ab0f9a051b40a25d072bb1b3446a0f371">07238</a> <a class="code" href="breakpoint_8c.html#ab0f9a051b40a25d072bb1b3446a0f371">set_longjmp_breakpoint_for_call_dummy</a> (<span class="keywordtype">void</span>)
<a name="l07239"></a>07239 {
<a name="l07240"></a>07240   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b, *retval = NULL;
<a name="l07241"></a>07241 
<a name="l07242"></a>07242   <a class="code" href="breakpoint_8c.html#a781d5d3dc50a92364edfbacac3d0c107">ALL_BREAKPOINTS</a> (b)
<a name="l07243"></a>07243     <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#a82f4fd8ee6ddee61f3529fbd747c78b2">pspace</a> == <a class="code" href="progspace_8c.html#a07722ff15a98814c086dda44f93380c9">current_program_space</a> &amp;&amp; b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfad159b4f5b0a64a88067c3d310ebed7ce">bp_longjmp_master</a>)
<a name="l07244"></a>07244       {
<a name="l07245"></a>07245         <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *new_b;
<a name="l07246"></a>07246 
<a name="l07247"></a>07247         new_b = momentary_breakpoint_from_master (b, <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa2bc2f9a597a0b3730d45e715048f76d3">bp_longjmp_call_dummy</a>,
<a name="l07248"></a>07248                                                   &amp;momentary_breakpoint_ops);
<a name="l07249"></a>07249         new_b-&gt;<a class="code" href="structbreakpoint.html#ae8613b6d8cf464f30ea39597be0cc192">thread</a> = <a class="code" href="gdbthread_8h.html#a3dbd3518561f91d8aa7621a65d39f305">pid_to_thread_id</a> (<a class="code" href="infcmd_8c.html#a428c5be9ce5e70bd03760e828e19c6b7">inferior_ptid</a>);
<a name="l07250"></a>07250 
<a name="l07251"></a>07251         <span class="comment">/* Link NEW_B into the chain of RETVAL breakpoints.  */</span>
<a name="l07252"></a>07252 
<a name="l07253"></a>07253         <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (new_b-&gt;<a class="code" href="structbreakpoint.html#a7d9882daea896de8ff1f7981e9508500">related_breakpoint</a> == new_b);
<a name="l07254"></a>07254         <span class="keywordflow">if</span> (retval == NULL)
<a name="l07255"></a>07255           retval = new_b;
<a name="l07256"></a>07256         new_b-&gt;<a class="code" href="structbreakpoint.html#a7d9882daea896de8ff1f7981e9508500">related_breakpoint</a> = retval;
<a name="l07257"></a>07257         <span class="keywordflow">while</span> (retval-&gt;<a class="code" href="structbreakpoint.html#a7d9882daea896de8ff1f7981e9508500">related_breakpoint</a> != new_b-&gt;<a class="code" href="structbreakpoint.html#a7d9882daea896de8ff1f7981e9508500">related_breakpoint</a>)
<a name="l07258"></a>07258           retval = retval-&gt;<a class="code" href="structbreakpoint.html#a7d9882daea896de8ff1f7981e9508500">related_breakpoint</a>;
<a name="l07259"></a>07259         retval-&gt;<a class="code" href="structbreakpoint.html#a7d9882daea896de8ff1f7981e9508500">related_breakpoint</a> = new_b;
<a name="l07260"></a>07260       }
<a name="l07261"></a>07261 
<a name="l07262"></a>07262   <span class="keywordflow">return</span> retval;
<a name="l07263"></a>07263 }
<a name="l07264"></a>07264 
<a name="l07265"></a>07265 <span class="comment">/* Verify all existing dummy frames and their associated breakpoints for</span>
<a name="l07266"></a>07266 <span class="comment">   THREAD.  Remove those which can no longer be found in the current frame</span>
<a name="l07267"></a>07267 <span class="comment">   stack.</span>
<a name="l07268"></a>07268 <span class="comment"></span>
<a name="l07269"></a>07269 <span class="comment">   You should call this function only at places where it is safe to currently</span>
<a name="l07270"></a>07270 <span class="comment">   unwind the whole stack.  Failed stack unwind would discard live dummy</span>
<a name="l07271"></a>07271 <span class="comment">   frames.  */</span>
<a name="l07272"></a>07272 
<a name="l07273"></a>07273 <span class="keywordtype">void</span>
<a name="l07274"></a><a class="code" href="breakpoint_8h.html#a73e787ad2373df444ece629f60a91e3d">07274</a> <a class="code" href="breakpoint_8c.html#a73e787ad2373df444ece629f60a91e3d">check_longjmp_breakpoint_for_call_dummy</a> (<span class="keywordtype">int</span> thread)
<a name="l07275"></a>07275 {
<a name="l07276"></a>07276   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b, *b_tmp;
<a name="l07277"></a>07277 
<a name="l07278"></a>07278   <a class="code" href="breakpoint_8c.html#ace15af58ae54149fbef6d72ecb61e12d">ALL_BREAKPOINTS_SAFE</a> (b, b_tmp)
<a name="l07279"></a>07279     <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa2bc2f9a597a0b3730d45e715048f76d3">bp_longjmp_call_dummy</a> &amp;&amp; b-&gt;<a class="code" href="structbreakpoint.html#ae8613b6d8cf464f30ea39597be0cc192">thread</a> == thread)
<a name="l07280"></a>07280       {
<a name="l07281"></a>07281         <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *dummy_b = b-&gt;<a class="code" href="structbreakpoint.html#a7d9882daea896de8ff1f7981e9508500">related_breakpoint</a>;
<a name="l07282"></a>07282 
<a name="l07283"></a>07283         <span class="keywordflow">while</span> (dummy_b != b &amp;&amp; dummy_b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> != <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa9ea01014e7cd4e2bb4ed925696cc0e8d">bp_call_dummy</a>)
<a name="l07284"></a>07284           dummy_b = dummy_b-&gt;<a class="code" href="structbreakpoint.html#a7d9882daea896de8ff1f7981e9508500">related_breakpoint</a>;
<a name="l07285"></a>07285         <span class="keywordflow">if</span> (dummy_b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> != <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa9ea01014e7cd4e2bb4ed925696cc0e8d">bp_call_dummy</a>
<a name="l07286"></a>07286             || <a class="code" href="frame_8c.html#a09616280d1811c8f06c46e26a8e07960">frame_find_by_id</a> (dummy_b-&gt;<a class="code" href="structbreakpoint.html#af65175451fdfdff660221d724c7c3cae">frame_id</a>) != NULL)
<a name="l07287"></a>07287           <span class="keywordflow">continue</span>;
<a name="l07288"></a>07288         
<a name="l07289"></a>07289         <a class="code" href="dummy-frame_8c.html#a6ab3ef6501120360dcede0996b9860c2">dummy_frame_discard</a> (dummy_b-&gt;<a class="code" href="structbreakpoint.html#af65175451fdfdff660221d724c7c3cae">frame_id</a>);
<a name="l07290"></a>07290 
<a name="l07291"></a>07291         <span class="keywordflow">while</span> (b-&gt;<a class="code" href="structbreakpoint.html#a7d9882daea896de8ff1f7981e9508500">related_breakpoint</a> != b)
<a name="l07292"></a>07292           {
<a name="l07293"></a>07293             <span class="keywordflow">if</span> (b_tmp == b-&gt;<a class="code" href="structbreakpoint.html#a7d9882daea896de8ff1f7981e9508500">related_breakpoint</a>)
<a name="l07294"></a>07294               b_tmp = b-&gt;<a class="code" href="structbreakpoint.html#a7d9882daea896de8ff1f7981e9508500">related_breakpoint</a>-&gt;<a class="code" href="structbreakpoint.html#a30f997b48b04a520ea99e35a74451933">next</a>;
<a name="l07295"></a>07295             <a class="code" href="breakpoint_8c.html#a0701191361b1ed0d40d76661e88de3f4">delete_breakpoint</a> (b-&gt;<a class="code" href="structbreakpoint.html#a7d9882daea896de8ff1f7981e9508500">related_breakpoint</a>);
<a name="l07296"></a>07296           }
<a name="l07297"></a>07297         <a class="code" href="breakpoint_8c.html#a0701191361b1ed0d40d76661e88de3f4">delete_breakpoint</a> (b);
<a name="l07298"></a>07298       }
<a name="l07299"></a>07299 }
<a name="l07300"></a>07300 
<a name="l07301"></a>07301 <span class="keywordtype">void</span>
<a name="l07302"></a><a class="code" href="breakpoint_8h.html#af95e67a1de38cabea42e6000503dbfe8">07302</a> <a class="code" href="breakpoint_8c.html#af95e67a1de38cabea42e6000503dbfe8">enable_overlay_breakpoints</a> (<span class="keywordtype">void</span>)
<a name="l07303"></a>07303 {
<a name="l07304"></a>07304   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b;
<a name="l07305"></a>07305 
<a name="l07306"></a>07306   <a class="code" href="breakpoint_8c.html#a781d5d3dc50a92364edfbacac3d0c107">ALL_BREAKPOINTS</a> (b)
<a name="l07307"></a>07307     <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa5bd9bbdb42933350595475584c48d844">bp_overlay_event</a>)
<a name="l07308"></a>07308     {
<a name="l07309"></a>07309       b-&gt;<a class="code" href="structbreakpoint.html#acb53352fd35aaad37054508fabc0f3bf">enable_state</a> = <a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577a72f1fa981d13a62d05324c1de974b44b">bp_enabled</a>;
<a name="l07310"></a>07310       update_global_location_list (1);
<a name="l07311"></a>07311       overlay_events_enabled = 1;
<a name="l07312"></a>07312     }
<a name="l07313"></a>07313 }
<a name="l07314"></a>07314 
<a name="l07315"></a>07315 <span class="keywordtype">void</span>
<a name="l07316"></a><a class="code" href="breakpoint_8h.html#ae67b79199ff53e5496a7179dfd3fbab1">07316</a> <a class="code" href="breakpoint_8c.html#ae67b79199ff53e5496a7179dfd3fbab1">disable_overlay_breakpoints</a> (<span class="keywordtype">void</span>)
<a name="l07317"></a>07317 {
<a name="l07318"></a>07318   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b;
<a name="l07319"></a>07319 
<a name="l07320"></a>07320   <a class="code" href="breakpoint_8c.html#a781d5d3dc50a92364edfbacac3d0c107">ALL_BREAKPOINTS</a> (b)
<a name="l07321"></a>07321     <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa5bd9bbdb42933350595475584c48d844">bp_overlay_event</a>)
<a name="l07322"></a>07322     {
<a name="l07323"></a>07323       b-&gt;<a class="code" href="structbreakpoint.html#acb53352fd35aaad37054508fabc0f3bf">enable_state</a> = <a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577a4605f207d0d15bd8195c9b1aa1bfee96">bp_disabled</a>;
<a name="l07324"></a>07324       update_global_location_list (0);
<a name="l07325"></a>07325       overlay_events_enabled = 0;
<a name="l07326"></a>07326     }
<a name="l07327"></a>07327 }
<a name="l07328"></a>07328 
<a name="l07329"></a>07329 <span class="comment">/* Set an active std::terminate breakpoint for each std::terminate</span>
<a name="l07330"></a>07330 <span class="comment">   master breakpoint.  */</span>
<a name="l07331"></a>07331 <span class="keywordtype">void</span>
<a name="l07332"></a><a class="code" href="breakpoint_8h.html#a3930259cbd6b8072cea76886a5d67212">07332</a> <a class="code" href="breakpoint_8c.html#a3930259cbd6b8072cea76886a5d67212">set_std_terminate_breakpoint</a> (<span class="keywordtype">void</span>)
<a name="l07333"></a>07333 {
<a name="l07334"></a>07334   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b, *b_tmp;
<a name="l07335"></a>07335 
<a name="l07336"></a>07336   <a class="code" href="breakpoint_8c.html#ace15af58ae54149fbef6d72ecb61e12d">ALL_BREAKPOINTS_SAFE</a> (b, b_tmp)
<a name="l07337"></a>07337     <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#a82f4fd8ee6ddee61f3529fbd747c78b2">pspace</a> == <a class="code" href="progspace_8c.html#a07722ff15a98814c086dda44f93380c9">current_program_space</a>
<a name="l07338"></a>07338         &amp;&amp; b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa0d6052d15a11c79e0c6703aeef4148ba">bp_std_terminate_master</a>)
<a name="l07339"></a>07339       {
<a name="l07340"></a>07340         momentary_breakpoint_from_master (b, <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa84b6ba381a94da7c15136d8dcc87c5f2">bp_std_terminate</a>,
<a name="l07341"></a>07341                                           &amp;momentary_breakpoint_ops);
<a name="l07342"></a>07342       }
<a name="l07343"></a>07343 }
<a name="l07344"></a>07344 
<a name="l07345"></a>07345 <span class="comment">/* Delete all the std::terminate breakpoints.  */</span>
<a name="l07346"></a>07346 <span class="keywordtype">void</span>
<a name="l07347"></a><a class="code" href="breakpoint_8h.html#a66d2a5ea650e6cf711df905b30e8e935">07347</a> <a class="code" href="breakpoint_8c.html#a66d2a5ea650e6cf711df905b30e8e935">delete_std_terminate_breakpoint</a> (<span class="keywordtype">void</span>)
<a name="l07348"></a>07348 {
<a name="l07349"></a>07349   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b, *b_tmp;
<a name="l07350"></a>07350 
<a name="l07351"></a>07351   <a class="code" href="breakpoint_8c.html#ace15af58ae54149fbef6d72ecb61e12d">ALL_BREAKPOINTS_SAFE</a> (b, b_tmp)
<a name="l07352"></a>07352     <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa84b6ba381a94da7c15136d8dcc87c5f2">bp_std_terminate</a>)
<a name="l07353"></a>07353       <a class="code" href="breakpoint_8c.html#a0701191361b1ed0d40d76661e88de3f4">delete_breakpoint</a> (b);
<a name="l07354"></a>07354 }
<a name="l07355"></a>07355 
<a name="l07356"></a>07356 <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *
<a name="l07357"></a><a class="code" href="breakpoint_8h.html#a4329ded33347278ac97e54cec81d7c92">07357</a> <a class="code" href="breakpoint_8c.html#a298430eac23f181437bab34903720b61">create_thread_event_breakpoint</a> (<span class="keyword">struct</span> gdbarch *gdbarch, <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> address)
<a name="l07358"></a>07358 {
<a name="l07359"></a>07359   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b;
<a name="l07360"></a>07360 
<a name="l07361"></a>07361   b = create_internal_breakpoint (gdbarch, address, <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa363ddd674339fdbb98fc4b0525905172">bp_thread_event</a>,
<a name="l07362"></a>07362                                   &amp;internal_breakpoint_ops);
<a name="l07363"></a>07363 
<a name="l07364"></a>07364   b-&gt;<a class="code" href="structbreakpoint.html#acb53352fd35aaad37054508fabc0f3bf">enable_state</a> = <a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577a72f1fa981d13a62d05324c1de974b44b">bp_enabled</a>;
<a name="l07365"></a>07365   <span class="comment">/* addr_string has to be used or breakpoint_re_set will delete me.  */</span>
<a name="l07366"></a>07366   b-&gt;<a class="code" href="structbreakpoint.html#a885e704e5cdcfc314069b970c396d1a4">addr_string</a>
<a name="l07367"></a>07367     = <a class="code" href="common-utils_8c.html#ab9bf7e1b4e68bdd0078e9e1e55c62cec">xstrprintf</a> (<span class="stringliteral">&quot;*%s&quot;</span>, <a class="code" href="utils_8c.html#ab5c76d72090f01d3848b63dda4e37d1c">paddress</a> (b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>-&gt;<a class="code" href="structbp__location.html#a55f3ff99d536775f5095f11e5f5c3f3e">gdbarch</a>, b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>));
<a name="l07368"></a>07368 
<a name="l07369"></a>07369   update_global_location_list_nothrow (1);
<a name="l07370"></a>07370 
<a name="l07371"></a>07371   <span class="keywordflow">return</span> b;
<a name="l07372"></a>07372 }
<a name="l07373"></a>07373 
<a name="l07374"></a>07374 <span class="keywordtype">void</span>
<a name="l07375"></a><a class="code" href="breakpoint_8h.html#a5b5cd7b781ac9e4895f8bac9d7023ad0">07375</a> <a class="code" href="breakpoint_8c.html#a5b5cd7b781ac9e4895f8bac9d7023ad0">remove_thread_event_breakpoints</a> (<span class="keywordtype">void</span>)
<a name="l07376"></a>07376 {
<a name="l07377"></a>07377   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b, *b_tmp;
<a name="l07378"></a>07378 
<a name="l07379"></a>07379   <a class="code" href="breakpoint_8c.html#ace15af58ae54149fbef6d72ecb61e12d">ALL_BREAKPOINTS_SAFE</a> (b, b_tmp)
<a name="l07380"></a>07380     <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa363ddd674339fdbb98fc4b0525905172">bp_thread_event</a>
<a name="l07381"></a>07381         &amp;&amp; b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a> == <a class="code" href="progspace_8c.html#a07722ff15a98814c086dda44f93380c9">current_program_space</a>)
<a name="l07382"></a>07382       <a class="code" href="breakpoint_8c.html#a0701191361b1ed0d40d76661e88de3f4">delete_breakpoint</a> (b);
<a name="l07383"></a>07383 }
<a name="l07384"></a>07384 
<a name="l07385"></a>07385 <span class="keyword">struct </span>lang_and_radix
<a name="l07386"></a>07386   {
<a name="l07387"></a>07387     <span class="keyword">enum</span> <a class="code" href="defs_8h.html#aa37aa8979934d47ac32fd96ecff32202">language</a> lang;
<a name="l07388"></a>07388     <span class="keywordtype">int</span> radix;
<a name="l07389"></a>07389   };
<a name="l07390"></a>07390 
<a name="l07391"></a>07391 <span class="comment">/* Create a breakpoint for JIT code registration and unregistration.  */</span>
<a name="l07392"></a>07392 
<a name="l07393"></a>07393 <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *
<a name="l07394"></a><a class="code" href="breakpoint_8h.html#a6767820cf6d59132d09890dc1c1a656f">07394</a> <a class="code" href="breakpoint_8c.html#a99095e21096063a3abde99edc149accf">create_jit_event_breakpoint</a> (<span class="keyword">struct</span> gdbarch *gdbarch, <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> address)
<a name="l07395"></a>07395 {
<a name="l07396"></a>07396   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b;
<a name="l07397"></a>07397 
<a name="l07398"></a>07398   b = create_internal_breakpoint (gdbarch, address, <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfaa189ad5fdf786f2921ba9635bdb926fe">bp_jit_event</a>,
<a name="l07399"></a>07399                                   &amp;internal_breakpoint_ops);
<a name="l07400"></a>07400   update_global_location_list_nothrow (1);
<a name="l07401"></a>07401   <span class="keywordflow">return</span> b;
<a name="l07402"></a>07402 }
<a name="l07403"></a>07403 
<a name="l07404"></a>07404 <span class="comment">/* Remove JIT code registration and unregistration breakpoint(s).  */</span>
<a name="l07405"></a>07405 
<a name="l07406"></a>07406 <span class="keywordtype">void</span>
<a name="l07407"></a><a class="code" href="breakpoint_8h.html#a20147fa88bc2b7ba2f2ad8898c7a2a61">07407</a> <a class="code" href="breakpoint_8c.html#a20147fa88bc2b7ba2f2ad8898c7a2a61">remove_jit_event_breakpoints</a> (<span class="keywordtype">void</span>)
<a name="l07408"></a>07408 {
<a name="l07409"></a>07409   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b, *b_tmp;
<a name="l07410"></a>07410 
<a name="l07411"></a>07411   <a class="code" href="breakpoint_8c.html#ace15af58ae54149fbef6d72ecb61e12d">ALL_BREAKPOINTS_SAFE</a> (b, b_tmp)
<a name="l07412"></a>07412     <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfaa189ad5fdf786f2921ba9635bdb926fe">bp_jit_event</a>
<a name="l07413"></a>07413         &amp;&amp; b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a> == <a class="code" href="progspace_8c.html#a07722ff15a98814c086dda44f93380c9">current_program_space</a>)
<a name="l07414"></a>07414       <a class="code" href="breakpoint_8c.html#a0701191361b1ed0d40d76661e88de3f4">delete_breakpoint</a> (b);
<a name="l07415"></a>07415 }
<a name="l07416"></a>07416 
<a name="l07417"></a>07417 <span class="keywordtype">void</span>
<a name="l07418"></a><a class="code" href="breakpoint_8h.html#a840c1cf382a3ee5129b261e8cd09f186">07418</a> <a class="code" href="breakpoint_8c.html#a840c1cf382a3ee5129b261e8cd09f186">remove_solib_event_breakpoints</a> (<span class="keywordtype">void</span>)
<a name="l07419"></a>07419 {
<a name="l07420"></a>07420   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b, *b_tmp;
<a name="l07421"></a>07421 
<a name="l07422"></a>07422   <a class="code" href="breakpoint_8c.html#ace15af58ae54149fbef6d72ecb61e12d">ALL_BREAKPOINTS_SAFE</a> (b, b_tmp)
<a name="l07423"></a>07423     <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa7ff3ee755a0635e1c8aa45bbeba6734a">bp_shlib_event</a>
<a name="l07424"></a>07424         &amp;&amp; b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a> == <a class="code" href="progspace_8c.html#a07722ff15a98814c086dda44f93380c9">current_program_space</a>)
<a name="l07425"></a>07425       <a class="code" href="breakpoint_8c.html#a0701191361b1ed0d40d76661e88de3f4">delete_breakpoint</a> (b);
<a name="l07426"></a>07426 }
<a name="l07427"></a>07427 
<a name="l07428"></a>07428 <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *
<a name="l07429"></a><a class="code" href="breakpoint_8h.html#ac9a040d57b6e1a7b83d99ffc697a1ed9">07429</a> <a class="code" href="breakpoint_8c.html#a77e5eba285ff0706303f27d268e9b997">create_solib_event_breakpoint</a> (<span class="keyword">struct</span> gdbarch *gdbarch, <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> address)
<a name="l07430"></a>07430 {
<a name="l07431"></a>07431   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b;
<a name="l07432"></a>07432 
<a name="l07433"></a>07433   b = create_internal_breakpoint (gdbarch, address, <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa7ff3ee755a0635e1c8aa45bbeba6734a">bp_shlib_event</a>,
<a name="l07434"></a>07434                                   &amp;internal_breakpoint_ops);
<a name="l07435"></a>07435   update_global_location_list_nothrow (1);
<a name="l07436"></a>07436   <span class="keywordflow">return</span> b;
<a name="l07437"></a>07437 }
<a name="l07438"></a>07438 
<a name="l07439"></a>07439 <span class="comment">/* Disable any breakpoints that are on code in shared libraries.  Only</span>
<a name="l07440"></a>07440 <span class="comment">   apply to enabled breakpoints, disabled ones can just stay disabled.  */</span>
<a name="l07441"></a>07441 
<a name="l07442"></a>07442 <span class="keywordtype">void</span>
<a name="l07443"></a><a class="code" href="breakpoint_8h.html#aced0980dfe19a7123cfbc26a8540b754">07443</a> <a class="code" href="breakpoint_8c.html#aced0980dfe19a7123cfbc26a8540b754">disable_breakpoints_in_shlibs</a> (<span class="keywordtype">void</span>)
<a name="l07444"></a>07444 {
<a name="l07445"></a>07445   <span class="keyword">struct </span>bp_location *loc, **locp_tmp;
<a name="l07446"></a>07446 
<a name="l07447"></a>07447   <a class="code" href="breakpoint_8c.html#a6f97c7962df1d91150e0e8de40ff7fe4">ALL_BP_LOCATIONS</a> (loc, locp_tmp)
<a name="l07448"></a>07448   {
<a name="l07449"></a>07449     <span class="comment">/* ALL_BP_LOCATIONS bp_location has LOC-&gt;OWNER always non-NULL.  */</span>
<a name="l07450"></a>07450     <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b = loc-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>;
<a name="l07451"></a>07451 
<a name="l07452"></a>07452     <span class="comment">/* We apply the check to all breakpoints, including disabled for</span>
<a name="l07453"></a>07453 <span class="comment">       those with loc-&gt;duplicate set.  This is so that when breakpoint</span>
<a name="l07454"></a>07454 <span class="comment">       becomes enabled, or the duplicate is removed, gdb will try to</span>
<a name="l07455"></a>07455 <span class="comment">       insert all breakpoints.  If we don&#39;t set shlib_disabled here,</span>
<a name="l07456"></a>07456 <span class="comment">       we&#39;ll try to insert those breakpoints and fail.  */</span>
<a name="l07457"></a>07457     <span class="keywordflow">if</span> (((b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa17768c2bd9137ec6e30c922c5c1d0ffa">bp_breakpoint</a>)
<a name="l07458"></a>07458          || (b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfaa189ad5fdf786f2921ba9635bdb926fe">bp_jit_event</a>)
<a name="l07459"></a>07459          || (b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa657fad68a9d83a24532fb06715b77628">bp_hardware_breakpoint</a>)
<a name="l07460"></a>07460          || (<a class="code" href="breakpoint_8c.html#ac537492fb781218601862c78225bd118">is_tracepoint</a> (b)))
<a name="l07461"></a>07461         &amp;&amp; loc-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a> == <a class="code" href="progspace_8c.html#a07722ff15a98814c086dda44f93380c9">current_program_space</a>
<a name="l07462"></a>07462         &amp;&amp; !loc-&gt;<a class="code" href="structbp__location.html#a3732b41958ed311106bffd202cbfe4ff">shlib_disabled</a>
<a name="l07463"></a>07463         &amp;&amp; <a class="code" href="solib_8c.html#aeb7eeab1d9375e787425078df3a08b9d">solib_name_from_address</a> (loc-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a>, loc-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>)
<a name="l07464"></a>07464         )
<a name="l07465"></a>07465       {
<a name="l07466"></a>07466         loc-&gt;<a class="code" href="structbp__location.html#a3732b41958ed311106bffd202cbfe4ff">shlib_disabled</a> = 1;
<a name="l07467"></a>07467       }
<a name="l07468"></a>07468   }
<a name="l07469"></a>07469 }
<a name="l07470"></a>07470 
<a name="l07471"></a>07471 <span class="comment">/* Disable any breakpoints and tracepoints that are in an unloaded shared</span>
<a name="l07472"></a>07472 <span class="comment">   library.  Only apply to enabled breakpoints, disabled ones can just stay</span>
<a name="l07473"></a>07473 <span class="comment">   disabled.  */</span>
<a name="l07474"></a>07474 
<a name="l07475"></a>07475 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l07476"></a>07476 disable_breakpoints_in_unloaded_shlib (<span class="keyword">struct</span> <a class="code" href="structso__list.html">so_list</a> *solib)
<a name="l07477"></a>07477 {
<a name="l07478"></a>07478   <span class="keyword">struct </span>bp_location *loc, **locp_tmp;
<a name="l07479"></a>07479   <span class="keywordtype">int</span> disabled_shlib_breaks = 0;
<a name="l07480"></a>07480 
<a name="l07481"></a>07481   <span class="comment">/* SunOS a.out shared libraries are always mapped, so do not</span>
<a name="l07482"></a>07482 <span class="comment">     disable breakpoints; they will only be reported as unloaded</span>
<a name="l07483"></a>07483 <span class="comment">     through clear_solib when GDB discards its shared library</span>
<a name="l07484"></a>07484 <span class="comment">     list.  See clear_solib for more information.  */</span>
<a name="l07485"></a>07485   <span class="keywordflow">if</span> (<a class="code" href="exec_8h.html#ac2e2e739fca42163e235e8521b9fbbab">exec_bfd</a> != NULL
<a name="l07486"></a>07486       &amp;&amp; bfd_get_flavour (<a class="code" href="exec_8h.html#ac2e2e739fca42163e235e8521b9fbbab">exec_bfd</a>) == bfd_target_aout_flavour)
<a name="l07487"></a>07487     <span class="keywordflow">return</span>;
<a name="l07488"></a>07488 
<a name="l07489"></a>07489   <a class="code" href="breakpoint_8c.html#a6f97c7962df1d91150e0e8de40ff7fe4">ALL_BP_LOCATIONS</a> (loc, locp_tmp)
<a name="l07490"></a>07490   {
<a name="l07491"></a>07491     <span class="comment">/* ALL_BP_LOCATIONS bp_location has LOC-&gt;OWNER always non-NULL.  */</span>
<a name="l07492"></a>07492     <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b = loc-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>;
<a name="l07493"></a>07493 
<a name="l07494"></a>07494     <span class="keywordflow">if</span> (solib-&gt;<a class="code" href="structso__list.html#a6d29f4fcfead22ec0a7a184a0e31a455">pspace</a> == loc-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a>
<a name="l07495"></a>07495         &amp;&amp; !loc-&gt;<a class="code" href="structbp__location.html#a3732b41958ed311106bffd202cbfe4ff">shlib_disabled</a>
<a name="l07496"></a>07496         &amp;&amp; (((b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa17768c2bd9137ec6e30c922c5c1d0ffa">bp_breakpoint</a>
<a name="l07497"></a>07497               || b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfaa189ad5fdf786f2921ba9635bdb926fe">bp_jit_event</a>
<a name="l07498"></a>07498               || b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa657fad68a9d83a24532fb06715b77628">bp_hardware_breakpoint</a>)
<a name="l07499"></a>07499              &amp;&amp; (loc-&gt;<a class="code" href="structbp__location.html#aefe49818487e5876fc995f7831e2e809">loc_type</a> == <a class="code" href="breakpoint_8h.html#ad7006ab95a9d2493c6ad2c685f45f5dca4a1949653a3b3c36db5cb269a46adb60">bp_loc_hardware_breakpoint</a>
<a name="l07500"></a>07500                  || loc-&gt;<a class="code" href="structbp__location.html#aefe49818487e5876fc995f7831e2e809">loc_type</a> == <a class="code" href="breakpoint_8h.html#ad7006ab95a9d2493c6ad2c685f45f5dcaa74492f6095e7a1ae08e3eed468ba47d">bp_loc_software_breakpoint</a>))
<a name="l07501"></a>07501             || <a class="code" href="breakpoint_8c.html#ac537492fb781218601862c78225bd118">is_tracepoint</a> (b))
<a name="l07502"></a>07502         &amp;&amp; <a class="code" href="solib_8c.html#adf1869b9204c01a98a37df618376e588">solib_contains_address_p</a> (solib, loc-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>))
<a name="l07503"></a>07503       {
<a name="l07504"></a>07504         loc-&gt;<a class="code" href="structbp__location.html#a3732b41958ed311106bffd202cbfe4ff">shlib_disabled</a> = 1;
<a name="l07505"></a>07505         <span class="comment">/* At this point, we cannot rely on remove_breakpoint</span>
<a name="l07506"></a>07506 <span class="comment">           succeeding so we must mark the breakpoint as not inserted</span>
<a name="l07507"></a>07507 <span class="comment">           to prevent future errors occurring in remove_breakpoints.  */</span>
<a name="l07508"></a>07508         loc-&gt;<a class="code" href="structbp__location.html#acb0b475579bbe5dabeb8ed4504527105">inserted</a> = 0;
<a name="l07509"></a>07509 
<a name="l07510"></a>07510         <span class="comment">/* This may cause duplicate notifications for the same breakpoint.  */</span>
<a name="l07511"></a>07511         <a class="code" href="observer_8h.html#a3edacfe44ac49f71646caded92072cad">observer_notify_breakpoint_modified</a> (b);
<a name="l07512"></a>07512 
<a name="l07513"></a>07513         <span class="keywordflow">if</span> (!disabled_shlib_breaks)
<a name="l07514"></a>07514           {
<a name="l07515"></a>07515             <a class="code" href="target_8h.html#a7369fcccf2537d98bda58de2a655e1d2">target_terminal_ours_for_output</a> ();
<a name="l07516"></a>07516             <a class="code" href="utils_8c.html#a5fc201a4181499a6b4057a6caa15b5e2">warning</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Temporarily disabling breakpoints &quot;</span>
<a name="l07517"></a>07517                        <span class="stringliteral">&quot;for unloaded shared library \&quot;%s\&quot;&quot;</span>),
<a name="l07518"></a>07518                      solib-&gt;<a class="code" href="structso__list.html#a140beac8c60259f8debd88cd693b8fb4">so_name</a>);
<a name="l07519"></a>07519           }
<a name="l07520"></a>07520         disabled_shlib_breaks = 1;
<a name="l07521"></a>07521       }
<a name="l07522"></a>07522   }
<a name="l07523"></a>07523 }
<a name="l07524"></a>07524 
<a name="l07525"></a>07525 <span class="comment">/* FORK &amp; VFORK catchpoints.  */</span>
<a name="l07526"></a>07526 
<a name="l07527"></a>07527 <span class="comment">/* An instance of this type is used to represent a fork or vfork</span>
<a name="l07528"></a>07528 <span class="comment">   catchpoint.  It includes a &quot;struct breakpoint&quot; as a kind of base</span>
<a name="l07529"></a>07529 <span class="comment">   class; users downcast to &quot;struct breakpoint *&quot; when needed.  A</span>
<a name="l07530"></a>07530 <span class="comment">   breakpoint is really of this type iff its ops pointer points to</span>
<a name="l07531"></a>07531 <span class="comment">   CATCH_FORK_BREAKPOINT_OPS.  */</span>
<a name="l07532"></a>07532 
<a name="l07533"></a>07533 <span class="keyword">struct </span>fork_catchpoint
<a name="l07534"></a>07534 {
<a name="l07535"></a>07535   <span class="comment">/* The base class.  */</span>
<a name="l07536"></a>07536   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> base;
<a name="l07537"></a>07537 
<a name="l07538"></a>07538   <span class="comment">/* Process id of a child process whose forking triggered this</span>
<a name="l07539"></a>07539 <span class="comment">     catchpoint.  This field is only valid immediately after this</span>
<a name="l07540"></a>07540 <span class="comment">     catchpoint has triggered.  */</span>
<a name="l07541"></a>07541   <a class="code" href="structptid.html">ptid_t</a> forked_inferior_pid;
<a name="l07542"></a>07542 };
<a name="l07543"></a>07543 
<a name="l07544"></a>07544 <span class="comment">/* Implement the &quot;insert&quot; breakpoint_ops method for fork</span>
<a name="l07545"></a>07545 <span class="comment">   catchpoints.  */</span>
<a name="l07546"></a>07546 
<a name="l07547"></a>07547 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l07548"></a>07548 insert_catch_fork (<span class="keyword">struct</span> bp_location *bl)
<a name="l07549"></a>07549 {
<a name="l07550"></a>07550   <span class="keywordflow">return</span> <a class="code" href="target_8h.html#a9782e351c10752c82ce8b3722be2e320">target_insert_fork_catchpoint</a> (<a class="code" href="ptid_8c.html#a264ba40fc2a0cf3d4fb24a55fe32aede">ptid_get_pid</a> (<a class="code" href="infcmd_8c.html#a428c5be9ce5e70bd03760e828e19c6b7">inferior_ptid</a>));
<a name="l07551"></a>07551 }
<a name="l07552"></a>07552 
<a name="l07553"></a>07553 <span class="comment">/* Implement the &quot;remove&quot; breakpoint_ops method for fork</span>
<a name="l07554"></a>07554 <span class="comment">   catchpoints.  */</span>
<a name="l07555"></a>07555 
<a name="l07556"></a>07556 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l07557"></a>07557 remove_catch_fork (<span class="keyword">struct</span> bp_location *bl)
<a name="l07558"></a>07558 {
<a name="l07559"></a>07559   <span class="keywordflow">return</span> <a class="code" href="target_8h.html#a9d60f2a2f608581ce9389d3965153e66">target_remove_fork_catchpoint</a> (<a class="code" href="ptid_8c.html#a264ba40fc2a0cf3d4fb24a55fe32aede">ptid_get_pid</a> (<a class="code" href="infcmd_8c.html#a428c5be9ce5e70bd03760e828e19c6b7">inferior_ptid</a>));
<a name="l07560"></a>07560 }
<a name="l07561"></a>07561 
<a name="l07562"></a>07562 <span class="comment">/* Implement the &quot;breakpoint_hit&quot; breakpoint_ops method for fork</span>
<a name="l07563"></a>07563 <span class="comment">   catchpoints.  */</span>
<a name="l07564"></a>07564 
<a name="l07565"></a>07565 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l07566"></a>07566 breakpoint_hit_catch_fork (<span class="keyword">const</span> <span class="keyword">struct</span> bp_location *bl,
<a name="l07567"></a>07567                            <span class="keyword">struct</span> address_space *aspace, <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> bp_addr,
<a name="l07568"></a>07568                            <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structtarget__waitstatus.html">target_waitstatus</a> *ws)
<a name="l07569"></a>07569 {
<a name="l07570"></a>07570   <span class="keyword">struct </span>fork_catchpoint *c = (<span class="keyword">struct </span>fork_catchpoint *) bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>;
<a name="l07571"></a>07571 
<a name="l07572"></a>07572   if (ws-&gt;<a class="code" href="structtarget__waitstatus.html#a17ed1783e9146f443fa51ace8da76198">kind</a> != <a class="code" href="waitstatus_8h.html#aa3229b489ec985f04f7e9f652138b7c3af4a49173c0431d0946bc1e4728e25496">TARGET_WAITKIND_FORKED</a>)
<a name="l07573"></a>07573     <span class="keywordflow">return</span> 0;
<a name="l07574"></a>07574 
<a name="l07575"></a>07575   c-&gt;forked_inferior_pid = ws-&gt;<a class="code" href="structtarget__waitstatus.html#af33b8f5721dc36f6b5b829286d38f825">value</a>.<a class="code" href="structtarget__waitstatus.html#af87b66a049f9b70e4da96f5fbe6d684c">related_pid</a>;
<a name="l07576"></a>07576   <span class="keywordflow">return</span> 1;
<a name="l07577"></a>07577 }
<a name="l07578"></a>07578 
<a name="l07579"></a>07579 <span class="comment">/* Implement the &quot;print_it&quot; breakpoint_ops method for fork</span>
<a name="l07580"></a>07580 <span class="comment">   catchpoints.  */</span>
<a name="l07581"></a>07581 
<a name="l07582"></a>07582 <span class="keyword">static</span> <span class="keyword">enum</span> <a class="code" href="breakpoint_8h.html#ab6ab1d6a867561653e32a901b41be66b">print_stop_action</a>
<a name="l07583"></a>07583 print_it_catch_fork (<a class="code" href="structbpstats.html">bpstat</a> bs)
<a name="l07584"></a>07584 {
<a name="l07585"></a>07585   <span class="keyword">struct </span>ui_out *uiout = <a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>;
<a name="l07586"></a>07586   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b = bs-&gt;<a class="code" href="structbpstats.html#ac105ed7263dd10f9d65e92e706b04e39">breakpoint_at</a>;
<a name="l07587"></a>07587   <span class="keyword">struct </span>fork_catchpoint *c = (<span class="keyword">struct </span>fork_catchpoint *) bs-&gt;<a class="code" href="structbpstats.html#ac105ed7263dd10f9d65e92e706b04e39">breakpoint_at</a>;
<a name="l07588"></a>07588 
<a name="l07589"></a>07589   <a class="code" href="annotate_8c.html#acb9815704180dd28dd5d5c6af7612a71">annotate_catchpoint</a> (b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>);
<a name="l07590"></a>07590   <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#a75f0f9a837eac292ab6e768e8d8f1bd7">disposition</a> == <a class="code" href="breakpoint_8h.html#a15f2bbd9012f59bc09d59feef0c15732a16da7fb4204cb3f58c753fafa80bfab7">disp_del</a>)
<a name="l07591"></a>07591     <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;\nTemporary catchpoint &quot;</span>);
<a name="l07592"></a>07592   <span class="keywordflow">else</span>
<a name="l07593"></a>07593     <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;\nCatchpoint &quot;</span>);
<a name="l07594"></a>07594   <span class="keywordflow">if</span> (<a class="code" href="ui-out_8c.html#a473db54efcfbc60feeb5a4f54f27af46">ui_out_is_mi_like_p</a> (uiout))
<a name="l07595"></a>07595     {
<a name="l07596"></a>07596       <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a> (uiout, <span class="stringliteral">&quot;reason&quot;</span>,
<a name="l07597"></a>07597                            <a class="code" href="mi-common_8c.html#a619e7d180d78af6e6d63a611c6680e90">async_reason_lookup</a> (<a class="code" href="mi-common_8h.html#a06d7bf56f98dcc556d686f49ea570daeacf00e270234e63c6a70ed39126712497">EXEC_ASYNC_FORK</a>));
<a name="l07598"></a>07598       <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a> (uiout, <span class="stringliteral">&quot;disp&quot;</span>, <a class="code" href="breakpoint_8c.html#a6f45019563f41b3ae4dc92df09f12618">bpdisp_text</a> (b-&gt;<a class="code" href="structbreakpoint.html#a75f0f9a837eac292ab6e768e8d8f1bd7">disposition</a>));
<a name="l07599"></a>07599     }
<a name="l07600"></a>07600   <a class="code" href="ui-out_8c.html#aa6f66551d03db456fb94ca1c9038f5a0">ui_out_field_int</a> (uiout, <span class="stringliteral">&quot;bkptno&quot;</span>, b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>);
<a name="l07601"></a>07601   <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot; (forked process &quot;</span>);
<a name="l07602"></a>07602   <a class="code" href="ui-out_8c.html#aa6f66551d03db456fb94ca1c9038f5a0">ui_out_field_int</a> (uiout, <span class="stringliteral">&quot;newpid&quot;</span>, <a class="code" href="ptid_8c.html#a264ba40fc2a0cf3d4fb24a55fe32aede">ptid_get_pid</a> (c-&gt;forked_inferior_pid));
<a name="l07603"></a>07603   <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;), &quot;</span>);
<a name="l07604"></a>07604   <span class="keywordflow">return</span> <a class="code" href="breakpoint_8h.html#ab6ab1d6a867561653e32a901b41be66ba322bad7b3370a43f44f33ae73a196231">PRINT_SRC_AND_LOC</a>;
<a name="l07605"></a>07605 }
<a name="l07606"></a>07606 
<a name="l07607"></a>07607 <span class="comment">/* Implement the &quot;print_one&quot; breakpoint_ops method for fork</span>
<a name="l07608"></a>07608 <span class="comment">   catchpoints.  */</span>
<a name="l07609"></a>07609 
<a name="l07610"></a>07610 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l07611"></a>07611 print_one_catch_fork (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b, <span class="keyword">struct</span> bp_location **last_loc)
<a name="l07612"></a>07612 {
<a name="l07613"></a>07613   <span class="keyword">struct </span>fork_catchpoint *c = (<span class="keyword">struct </span>fork_catchpoint *) b;
<a name="l07614"></a>07614   <span class="keyword">struct </span><a class="code" href="structvalue__print__options.html">value_print_options</a> opts;
<a name="l07615"></a>07615   <span class="keyword">struct </span>ui_out *uiout = <a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>;
<a name="l07616"></a>07616 
<a name="l07617"></a>07617   <a class="code" href="valprint_8c.html#aa2d4dfe4b11841ccafc4d0c0d410095d">get_user_print_options</a> (&amp;opts);
<a name="l07618"></a>07618 
<a name="l07619"></a>07619   <span class="comment">/* Field 4, the address, is omitted (which makes the columns not</span>
<a name="l07620"></a>07620 <span class="comment">     line up too nicely with the headers, but the effect is relatively</span>
<a name="l07621"></a>07621 <span class="comment">     readable).  */</span>
<a name="l07622"></a>07622   <span class="keywordflow">if</span> (opts.addressprint)
<a name="l07623"></a>07623     <a class="code" href="ui-out_8c.html#a5366a822858ecedafef54625bec57442">ui_out_field_skip</a> (uiout, <span class="stringliteral">&quot;addr&quot;</span>);
<a name="l07624"></a>07624   <a class="code" href="annotate_8c.html#a3b961efbc346558aade25e12945835fe">annotate_field</a> (5);
<a name="l07625"></a>07625   <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;fork&quot;</span>);
<a name="l07626"></a>07626   <span class="keywordflow">if</span> (!<a class="code" href="ptid_8c.html#a0df58c8db2620a2cec647934b4f77266">ptid_equal</a> (c-&gt;forked_inferior_pid, <a class="code" href="ptid_8c.html#acba69c857786546b204883bbcc90a64e">null_ptid</a>))
<a name="l07627"></a>07627     {
<a name="l07628"></a>07628       <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;, process &quot;</span>);
<a name="l07629"></a>07629       <a class="code" href="ui-out_8c.html#aa6f66551d03db456fb94ca1c9038f5a0">ui_out_field_int</a> (uiout, <span class="stringliteral">&quot;what&quot;</span>,
<a name="l07630"></a>07630                         <a class="code" href="ptid_8c.html#a264ba40fc2a0cf3d4fb24a55fe32aede">ptid_get_pid</a> (c-&gt;forked_inferior_pid));
<a name="l07631"></a>07631       <a class="code" href="ui-out_8c.html#a2a4b4f5c17e354b68a3486e0e129907b">ui_out_spaces</a> (uiout, 1);
<a name="l07632"></a>07632     }
<a name="l07633"></a>07633 
<a name="l07634"></a>07634   <span class="keywordflow">if</span> (<a class="code" href="ui-out_8c.html#a473db54efcfbc60feeb5a4f54f27af46">ui_out_is_mi_like_p</a> (uiout))
<a name="l07635"></a>07635     <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a> (uiout, <span class="stringliteral">&quot;catch-type&quot;</span>, <span class="stringliteral">&quot;fork&quot;</span>);
<a name="l07636"></a>07636 }
<a name="l07637"></a>07637 
<a name="l07638"></a>07638 <span class="comment">/* Implement the &quot;print_mention&quot; breakpoint_ops method for fork</span>
<a name="l07639"></a>07639 <span class="comment">   catchpoints.  */</span>
<a name="l07640"></a>07640 
<a name="l07641"></a>07641 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l07642"></a>07642 print_mention_catch_fork (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b)
<a name="l07643"></a>07643 {
<a name="l07644"></a>07644   <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Catchpoint %d (fork)&quot;</span>), b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>);
<a name="l07645"></a>07645 }
<a name="l07646"></a>07646 
<a name="l07647"></a>07647 <span class="comment">/* Implement the &quot;print_recreate&quot; breakpoint_ops method for fork</span>
<a name="l07648"></a>07648 <span class="comment">   catchpoints.  */</span>
<a name="l07649"></a>07649 
<a name="l07650"></a>07650 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l07651"></a>07651 print_recreate_catch_fork (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b, <span class="keyword">struct</span> ui_file *fp)
<a name="l07652"></a>07652 {
<a name="l07653"></a>07653   <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (fp, <span class="stringliteral">&quot;catch fork&quot;</span>);
<a name="l07654"></a>07654   <a class="code" href="breakpoint_8c.html#aae7cd38b01782db6011bcd0150059625">print_recreate_thread</a> (b, fp);
<a name="l07655"></a>07655 }
<a name="l07656"></a>07656 
<a name="l07657"></a>07657 <span class="comment">/* The breakpoint_ops structure to be used in fork catchpoints.  */</span>
<a name="l07658"></a>07658 
<a name="l07659"></a>07659 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structbreakpoint__ops.html">breakpoint_ops</a> catch_fork_breakpoint_ops;
<a name="l07660"></a>07660 
<a name="l07661"></a>07661 <span class="comment">/* Implement the &quot;insert&quot; breakpoint_ops method for vfork</span>
<a name="l07662"></a>07662 <span class="comment">   catchpoints.  */</span>
<a name="l07663"></a>07663 
<a name="l07664"></a>07664 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l07665"></a>07665 insert_catch_vfork (<span class="keyword">struct</span> bp_location *bl)
<a name="l07666"></a>07666 {
<a name="l07667"></a>07667   <span class="keywordflow">return</span> <a class="code" href="target_8h.html#ad70644ac4dd1c9aa3966af86488a2b77">target_insert_vfork_catchpoint</a> (<a class="code" href="ptid_8c.html#a264ba40fc2a0cf3d4fb24a55fe32aede">ptid_get_pid</a> (<a class="code" href="infcmd_8c.html#a428c5be9ce5e70bd03760e828e19c6b7">inferior_ptid</a>));
<a name="l07668"></a>07668 }
<a name="l07669"></a>07669 
<a name="l07670"></a>07670 <span class="comment">/* Implement the &quot;remove&quot; breakpoint_ops method for vfork</span>
<a name="l07671"></a>07671 <span class="comment">   catchpoints.  */</span>
<a name="l07672"></a>07672 
<a name="l07673"></a>07673 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l07674"></a>07674 remove_catch_vfork (<span class="keyword">struct</span> bp_location *bl)
<a name="l07675"></a>07675 {
<a name="l07676"></a>07676   <span class="keywordflow">return</span> <a class="code" href="target_8h.html#a0097bd16d085097d4a564e51e2a5954e">target_remove_vfork_catchpoint</a> (<a class="code" href="ptid_8c.html#a264ba40fc2a0cf3d4fb24a55fe32aede">ptid_get_pid</a> (<a class="code" href="infcmd_8c.html#a428c5be9ce5e70bd03760e828e19c6b7">inferior_ptid</a>));
<a name="l07677"></a>07677 }
<a name="l07678"></a>07678 
<a name="l07679"></a>07679 <span class="comment">/* Implement the &quot;breakpoint_hit&quot; breakpoint_ops method for vfork</span>
<a name="l07680"></a>07680 <span class="comment">   catchpoints.  */</span>
<a name="l07681"></a>07681 
<a name="l07682"></a>07682 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l07683"></a>07683 breakpoint_hit_catch_vfork (<span class="keyword">const</span> <span class="keyword">struct</span> bp_location *bl,
<a name="l07684"></a>07684                             <span class="keyword">struct</span> address_space *aspace, <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> bp_addr,
<a name="l07685"></a>07685                             <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structtarget__waitstatus.html">target_waitstatus</a> *ws)
<a name="l07686"></a>07686 {
<a name="l07687"></a>07687   <span class="keyword">struct </span>fork_catchpoint *c = (<span class="keyword">struct </span>fork_catchpoint *) bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>;
<a name="l07688"></a>07688 
<a name="l07689"></a>07689   if (ws-&gt;<a class="code" href="structtarget__waitstatus.html#a17ed1783e9146f443fa51ace8da76198">kind</a> != <a class="code" href="waitstatus_8h.html#aa3229b489ec985f04f7e9f652138b7c3af506741254a0233f7233445fdfe37a02">TARGET_WAITKIND_VFORKED</a>)
<a name="l07690"></a>07690     <span class="keywordflow">return</span> 0;
<a name="l07691"></a>07691 
<a name="l07692"></a>07692   c-&gt;forked_inferior_pid = ws-&gt;<a class="code" href="structtarget__waitstatus.html#af33b8f5721dc36f6b5b829286d38f825">value</a>.<a class="code" href="structtarget__waitstatus.html#af87b66a049f9b70e4da96f5fbe6d684c">related_pid</a>;
<a name="l07693"></a>07693   <span class="keywordflow">return</span> 1;
<a name="l07694"></a>07694 }
<a name="l07695"></a>07695 
<a name="l07696"></a>07696 <span class="comment">/* Implement the &quot;print_it&quot; breakpoint_ops method for vfork</span>
<a name="l07697"></a>07697 <span class="comment">   catchpoints.  */</span>
<a name="l07698"></a>07698 
<a name="l07699"></a>07699 <span class="keyword">static</span> <span class="keyword">enum</span> <a class="code" href="breakpoint_8h.html#ab6ab1d6a867561653e32a901b41be66b">print_stop_action</a>
<a name="l07700"></a>07700 print_it_catch_vfork (<a class="code" href="structbpstats.html">bpstat</a> bs)
<a name="l07701"></a>07701 {
<a name="l07702"></a>07702   <span class="keyword">struct </span>ui_out *uiout = <a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>;
<a name="l07703"></a>07703   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b = bs-&gt;<a class="code" href="structbpstats.html#ac105ed7263dd10f9d65e92e706b04e39">breakpoint_at</a>;
<a name="l07704"></a>07704   <span class="keyword">struct </span>fork_catchpoint *c = (<span class="keyword">struct </span>fork_catchpoint *) b;
<a name="l07705"></a>07705 
<a name="l07706"></a>07706   <a class="code" href="annotate_8c.html#acb9815704180dd28dd5d5c6af7612a71">annotate_catchpoint</a> (b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>);
<a name="l07707"></a>07707   <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#a75f0f9a837eac292ab6e768e8d8f1bd7">disposition</a> == <a class="code" href="breakpoint_8h.html#a15f2bbd9012f59bc09d59feef0c15732a16da7fb4204cb3f58c753fafa80bfab7">disp_del</a>)
<a name="l07708"></a>07708     <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;\nTemporary catchpoint &quot;</span>);
<a name="l07709"></a>07709   <span class="keywordflow">else</span>
<a name="l07710"></a>07710     <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;\nCatchpoint &quot;</span>);
<a name="l07711"></a>07711   <span class="keywordflow">if</span> (<a class="code" href="ui-out_8c.html#a473db54efcfbc60feeb5a4f54f27af46">ui_out_is_mi_like_p</a> (uiout))
<a name="l07712"></a>07712     {
<a name="l07713"></a>07713       <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a> (uiout, <span class="stringliteral">&quot;reason&quot;</span>,
<a name="l07714"></a>07714                            <a class="code" href="mi-common_8c.html#a619e7d180d78af6e6d63a611c6680e90">async_reason_lookup</a> (<a class="code" href="mi-common_8h.html#a06d7bf56f98dcc556d686f49ea570daeaf138f369111eb6e8e28ec137114afa91">EXEC_ASYNC_VFORK</a>));
<a name="l07715"></a>07715       <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a> (uiout, <span class="stringliteral">&quot;disp&quot;</span>, <a class="code" href="breakpoint_8c.html#a6f45019563f41b3ae4dc92df09f12618">bpdisp_text</a> (b-&gt;<a class="code" href="structbreakpoint.html#a75f0f9a837eac292ab6e768e8d8f1bd7">disposition</a>));
<a name="l07716"></a>07716     }
<a name="l07717"></a>07717   <a class="code" href="ui-out_8c.html#aa6f66551d03db456fb94ca1c9038f5a0">ui_out_field_int</a> (uiout, <span class="stringliteral">&quot;bkptno&quot;</span>, b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>);
<a name="l07718"></a>07718   <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot; (vforked process &quot;</span>);
<a name="l07719"></a>07719   <a class="code" href="ui-out_8c.html#aa6f66551d03db456fb94ca1c9038f5a0">ui_out_field_int</a> (uiout, <span class="stringliteral">&quot;newpid&quot;</span>, <a class="code" href="ptid_8c.html#a264ba40fc2a0cf3d4fb24a55fe32aede">ptid_get_pid</a> (c-&gt;forked_inferior_pid));
<a name="l07720"></a>07720   <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;), &quot;</span>);
<a name="l07721"></a>07721   <span class="keywordflow">return</span> <a class="code" href="breakpoint_8h.html#ab6ab1d6a867561653e32a901b41be66ba322bad7b3370a43f44f33ae73a196231">PRINT_SRC_AND_LOC</a>;
<a name="l07722"></a>07722 }
<a name="l07723"></a>07723 
<a name="l07724"></a>07724 <span class="comment">/* Implement the &quot;print_one&quot; breakpoint_ops method for vfork</span>
<a name="l07725"></a>07725 <span class="comment">   catchpoints.  */</span>
<a name="l07726"></a>07726 
<a name="l07727"></a>07727 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l07728"></a>07728 print_one_catch_vfork (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b, <span class="keyword">struct</span> bp_location **last_loc)
<a name="l07729"></a>07729 {
<a name="l07730"></a>07730   <span class="keyword">struct </span>fork_catchpoint *c = (<span class="keyword">struct </span>fork_catchpoint *) b;
<a name="l07731"></a>07731   <span class="keyword">struct </span><a class="code" href="structvalue__print__options.html">value_print_options</a> opts;
<a name="l07732"></a>07732   <span class="keyword">struct </span>ui_out *uiout = <a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>;
<a name="l07733"></a>07733 
<a name="l07734"></a>07734   <a class="code" href="valprint_8c.html#aa2d4dfe4b11841ccafc4d0c0d410095d">get_user_print_options</a> (&amp;opts);
<a name="l07735"></a>07735   <span class="comment">/* Field 4, the address, is omitted (which makes the columns not</span>
<a name="l07736"></a>07736 <span class="comment">     line up too nicely with the headers, but the effect is relatively</span>
<a name="l07737"></a>07737 <span class="comment">     readable).  */</span>
<a name="l07738"></a>07738   <span class="keywordflow">if</span> (opts.addressprint)
<a name="l07739"></a>07739     <a class="code" href="ui-out_8c.html#a5366a822858ecedafef54625bec57442">ui_out_field_skip</a> (uiout, <span class="stringliteral">&quot;addr&quot;</span>);
<a name="l07740"></a>07740   <a class="code" href="annotate_8c.html#a3b961efbc346558aade25e12945835fe">annotate_field</a> (5);
<a name="l07741"></a>07741   <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;vfork&quot;</span>);
<a name="l07742"></a>07742   <span class="keywordflow">if</span> (!<a class="code" href="ptid_8c.html#a0df58c8db2620a2cec647934b4f77266">ptid_equal</a> (c-&gt;forked_inferior_pid, <a class="code" href="ptid_8c.html#acba69c857786546b204883bbcc90a64e">null_ptid</a>))
<a name="l07743"></a>07743     {
<a name="l07744"></a>07744       <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;, process &quot;</span>);
<a name="l07745"></a>07745       <a class="code" href="ui-out_8c.html#aa6f66551d03db456fb94ca1c9038f5a0">ui_out_field_int</a> (uiout, <span class="stringliteral">&quot;what&quot;</span>,
<a name="l07746"></a>07746                         <a class="code" href="ptid_8c.html#a264ba40fc2a0cf3d4fb24a55fe32aede">ptid_get_pid</a> (c-&gt;forked_inferior_pid));
<a name="l07747"></a>07747       <a class="code" href="ui-out_8c.html#a2a4b4f5c17e354b68a3486e0e129907b">ui_out_spaces</a> (uiout, 1);
<a name="l07748"></a>07748     }
<a name="l07749"></a>07749 
<a name="l07750"></a>07750   <span class="keywordflow">if</span> (<a class="code" href="ui-out_8c.html#a473db54efcfbc60feeb5a4f54f27af46">ui_out_is_mi_like_p</a> (uiout))
<a name="l07751"></a>07751     <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a> (uiout, <span class="stringliteral">&quot;catch-type&quot;</span>, <span class="stringliteral">&quot;vfork&quot;</span>);
<a name="l07752"></a>07752 }
<a name="l07753"></a>07753 
<a name="l07754"></a>07754 <span class="comment">/* Implement the &quot;print_mention&quot; breakpoint_ops method for vfork</span>
<a name="l07755"></a>07755 <span class="comment">   catchpoints.  */</span>
<a name="l07756"></a>07756 
<a name="l07757"></a>07757 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l07758"></a>07758 print_mention_catch_vfork (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b)
<a name="l07759"></a>07759 {
<a name="l07760"></a>07760   <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Catchpoint %d (vfork)&quot;</span>), b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>);
<a name="l07761"></a>07761 }
<a name="l07762"></a>07762 
<a name="l07763"></a>07763 <span class="comment">/* Implement the &quot;print_recreate&quot; breakpoint_ops method for vfork</span>
<a name="l07764"></a>07764 <span class="comment">   catchpoints.  */</span>
<a name="l07765"></a>07765 
<a name="l07766"></a>07766 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l07767"></a>07767 print_recreate_catch_vfork (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b, <span class="keyword">struct</span> ui_file *fp)
<a name="l07768"></a>07768 {
<a name="l07769"></a>07769   <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (fp, <span class="stringliteral">&quot;catch vfork&quot;</span>);
<a name="l07770"></a>07770   <a class="code" href="breakpoint_8c.html#aae7cd38b01782db6011bcd0150059625">print_recreate_thread</a> (b, fp);
<a name="l07771"></a>07771 }
<a name="l07772"></a>07772 
<a name="l07773"></a>07773 <span class="comment">/* The breakpoint_ops structure to be used in vfork catchpoints.  */</span>
<a name="l07774"></a>07774 
<a name="l07775"></a>07775 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structbreakpoint__ops.html">breakpoint_ops</a> catch_vfork_breakpoint_ops;
<a name="l07776"></a>07776 
<a name="l07777"></a>07777 <span class="comment">/* An instance of this type is used to represent an solib catchpoint.</span>
<a name="l07778"></a>07778 <span class="comment">   It includes a &quot;struct breakpoint&quot; as a kind of base class; users</span>
<a name="l07779"></a>07779 <span class="comment">   downcast to &quot;struct breakpoint *&quot; when needed.  A breakpoint is</span>
<a name="l07780"></a>07780 <span class="comment">   really of this type iff its ops pointer points to</span>
<a name="l07781"></a>07781 <span class="comment">   CATCH_SOLIB_BREAKPOINT_OPS.  */</span>
<a name="l07782"></a>07782 
<a name="l07783"></a>07783 <span class="keyword">struct </span>solib_catchpoint
<a name="l07784"></a>07784 {
<a name="l07785"></a>07785   <span class="comment">/* The base class.  */</span>
<a name="l07786"></a>07786   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> base;
<a name="l07787"></a>07787 
<a name="l07788"></a>07788   <span class="comment">/* True for &quot;catch load&quot;, false for &quot;catch unload&quot;.  */</span>
<a name="l07789"></a>07789   <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> is_load;
<a name="l07790"></a>07790 
<a name="l07791"></a>07791   <span class="comment">/* Regular expression to match, if any.  COMPILED is only valid when</span>
<a name="l07792"></a>07792 <span class="comment">     REGEX is non-NULL.  */</span>
<a name="l07793"></a>07793   <span class="keywordtype">char</span> *regex;
<a name="l07794"></a>07794   regex_t compiled;
<a name="l07795"></a>07795 };
<a name="l07796"></a>07796 
<a name="l07797"></a>07797 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l07798"></a>07798 dtor_catch_solib (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b)
<a name="l07799"></a>07799 {
<a name="l07800"></a>07800   <span class="keyword">struct </span>solib_catchpoint *<span class="keyword">self</span> = (<span class="keyword">struct </span>solib_catchpoint *) b;
<a name="l07801"></a>07801 
<a name="l07802"></a>07802   <span class="keywordflow">if</span> (self-&gt;regex)
<a name="l07803"></a>07803     regfree (&amp;self-&gt;compiled);
<a name="l07804"></a>07804   <a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a> (self-&gt;regex);
<a name="l07805"></a>07805 
<a name="l07806"></a>07806   <a class="code" href="breakpoint_8c.html#aefe1d12780f2d7ae5fb89ac113e204e0">base_breakpoint_ops</a>.<a class="code" href="structbreakpoint__ops.html#a110b2df7b285e5f83bf40b9a0e5435c1">dtor</a> (b);
<a name="l07807"></a>07807 }
<a name="l07808"></a>07808 
<a name="l07809"></a>07809 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l07810"></a>07810 insert_catch_solib (<span class="keyword">struct</span> bp_location *ignore)
<a name="l07811"></a>07811 {
<a name="l07812"></a>07812   <span class="keywordflow">return</span> 0;
<a name="l07813"></a>07813 }
<a name="l07814"></a>07814 
<a name="l07815"></a>07815 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l07816"></a>07816 remove_catch_solib (<span class="keyword">struct</span> bp_location *ignore)
<a name="l07817"></a>07817 {
<a name="l07818"></a>07818   <span class="keywordflow">return</span> 0;
<a name="l07819"></a>07819 }
<a name="l07820"></a>07820 
<a name="l07821"></a>07821 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l07822"></a>07822 breakpoint_hit_catch_solib (<span class="keyword">const</span> <span class="keyword">struct</span> bp_location *bl,
<a name="l07823"></a>07823                             <span class="keyword">struct</span> address_space *aspace,
<a name="l07824"></a>07824                             <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> bp_addr,
<a name="l07825"></a>07825                             <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structtarget__waitstatus.html">target_waitstatus</a> *ws)
<a name="l07826"></a>07826 {
<a name="l07827"></a>07827   <span class="keyword">struct </span>solib_catchpoint *<span class="keyword">self</span> = (<span class="keyword">struct </span>solib_catchpoint *) bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>;
<a name="l07828"></a>07828   <span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *other;
<a name="l07829"></a>07829 
<a name="l07830"></a>07830   if (ws-&gt;<a class="code" href="structtarget__waitstatus.html#a17ed1783e9146f443fa51ace8da76198">kind</a> == <a class="code" href="waitstatus_8h.html#aa3229b489ec985f04f7e9f652138b7c3a6628f2c3117782406e2eeb38c4067002">TARGET_WAITKIND_LOADED</a>)
<a name="l07831"></a>07831     <span class="keywordflow">return</span> 1;
<a name="l07832"></a>07832 
<a name="l07833"></a>07833   <a class="code" href="breakpoint_8c.html#a781d5d3dc50a92364edfbacac3d0c107">ALL_BREAKPOINTS</a> (other)
<a name="l07834"></a>07834   {
<a name="l07835"></a>07835     <span class="keyword">struct </span>bp_location *other_bl;
<a name="l07836"></a>07836 
<a name="l07837"></a>07837     <span class="keywordflow">if</span> (other == bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>)
<a name="l07838"></a>07838       <span class="keywordflow">continue</span>;
<a name="l07839"></a>07839 
<a name="l07840"></a>07840     <span class="keywordflow">if</span> (other-&gt;type != <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa7ff3ee755a0635e1c8aa45bbeba6734a">bp_shlib_event</a>)
<a name="l07841"></a>07841       <span class="keywordflow">continue</span>;
<a name="l07842"></a>07842 
<a name="l07843"></a>07843     <span class="keywordflow">if</span> (self-&gt;base.pspace != NULL &amp;&amp; other-&gt;pspace != self-&gt;base.pspace)
<a name="l07844"></a>07844       <span class="keywordflow">continue</span>;
<a name="l07845"></a>07845 
<a name="l07846"></a>07846     <span class="keywordflow">for</span> (other_bl = other-&gt;loc; other_bl != NULL; other_bl = other_bl-&gt;<a class="code" href="structbp__location.html#ab193cb38f87fea89105db96d94191541">next</a>)
<a name="l07847"></a>07847       {
<a name="l07848"></a>07848         <span class="keywordflow">if</span> (other-&gt;ops-&gt;breakpoint_hit (other_bl, aspace, bp_addr, ws))
<a name="l07849"></a>07849           <span class="keywordflow">return</span> 1;
<a name="l07850"></a>07850       }
<a name="l07851"></a>07851   }
<a name="l07852"></a>07852 
<a name="l07853"></a>07853   <span class="keywordflow">return</span> 0;
<a name="l07854"></a>07854 }
<a name="l07855"></a>07855 
<a name="l07856"></a>07856 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l07857"></a>07857 check_status_catch_solib (<span class="keyword">struct</span> <a class="code" href="structbpstats.html">bpstats</a> *bs)
<a name="l07858"></a>07858 {
<a name="l07859"></a>07859   <span class="keyword">struct </span>solib_catchpoint *<span class="keyword">self</span>
<a name="l07860"></a>07860     = (<span class="keyword">struct </span>solib_catchpoint *) bs-&gt;<a class="code" href="structbpstats.html#ac105ed7263dd10f9d65e92e706b04e39">breakpoint_at</a>;
<a name="l07861"></a>07861   <span class="keywordtype">int</span> ix;
<a name="l07862"></a>07862 
<a name="l07863"></a>07863   if (self-&gt;is_load)
<a name="l07864"></a>07864     {
<a name="l07865"></a>07865       <span class="keyword">struct </span><a class="code" href="structso__list.html">so_list</a> *iter;
<a name="l07866"></a>07866 
<a name="l07867"></a>07867       <span class="keywordflow">for</span> (ix = 0;
<a name="l07868"></a>07868            <a class="code" href="vec_8h.html#ae7795b0c8e65f45eb49aac5ec2c0fa52">VEC_iterate</a> (<a class="code" href="structso__list.html">so_list_ptr</a>, <a class="code" href="progspace_8c.html#a07722ff15a98814c086dda44f93380c9">current_program_space</a>-&gt;added_solibs,
<a name="l07869"></a>07869                         ix, iter);
<a name="l07870"></a>07870            ++ix)
<a name="l07871"></a>07871         {
<a name="l07872"></a>07872           <span class="keywordflow">if</span> (!self-&gt;regex
<a name="l07873"></a>07873               || regexec (&amp;self-&gt;compiled, iter-&gt;<a class="code" href="structso__list.html#a140beac8c60259f8debd88cd693b8fb4">so_name</a>, 0, NULL, 0) == 0)
<a name="l07874"></a>07874             <span class="keywordflow">return</span>;
<a name="l07875"></a>07875         }
<a name="l07876"></a>07876     }
<a name="l07877"></a>07877   <span class="keywordflow">else</span>
<a name="l07878"></a>07878     {
<a name="l07879"></a>07879       <span class="keywordtype">char</span> *iter;
<a name="l07880"></a>07880 
<a name="l07881"></a>07881       <span class="keywordflow">for</span> (ix = 0;
<a name="l07882"></a>07882            <a class="code" href="vec_8h.html#ae7795b0c8e65f45eb49aac5ec2c0fa52">VEC_iterate</a> (<a class="code" href="gdb__vecs_8h.html#a5ea7d3fefa2144d9bddaf2053c9691a1">char_ptr</a>, <a class="code" href="progspace_8c.html#a07722ff15a98814c086dda44f93380c9">current_program_space</a>-&gt;deleted_solibs,
<a name="l07883"></a>07883                         ix, iter);
<a name="l07884"></a>07884            ++ix)
<a name="l07885"></a>07885         {
<a name="l07886"></a>07886           <span class="keywordflow">if</span> (!self-&gt;regex
<a name="l07887"></a>07887               || regexec (&amp;self-&gt;compiled, iter, 0, NULL, 0) == 0)
<a name="l07888"></a>07888             <span class="keywordflow">return</span>;
<a name="l07889"></a>07889         }
<a name="l07890"></a>07890     }
<a name="l07891"></a>07891 
<a name="l07892"></a>07892   bs-&gt;<a class="code" href="structbpstats.html#acff86901962f7bc070661b85248c4652">stop</a> = 0;
<a name="l07893"></a>07893   bs-&gt;<a class="code" href="structbpstats.html#aa7d7990c1285ae7d002f1ab22aa5cf1c">print_it</a> = <a class="code" href="breakpoint_8h.html#a3c71b66ef0df7811590693f77ca1c643ab105e1b64aa8f28dd69ccb8f1ed14c61">print_it_noop</a>;
<a name="l07894"></a>07894 }
<a name="l07895"></a>07895 
<a name="l07896"></a>07896 <span class="keyword">static</span> <span class="keyword">enum</span> <a class="code" href="breakpoint_8h.html#ab6ab1d6a867561653e32a901b41be66b">print_stop_action</a>
<a name="l07897"></a>07897 print_it_catch_solib (<a class="code" href="structbpstats.html">bpstat</a> bs)
<a name="l07898"></a>07898 {
<a name="l07899"></a>07899   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b = bs-&gt;<a class="code" href="structbpstats.html#ac105ed7263dd10f9d65e92e706b04e39">breakpoint_at</a>;
<a name="l07900"></a>07900   <span class="keyword">struct </span>ui_out *uiout = <a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>;
<a name="l07901"></a>07901 
<a name="l07902"></a>07902   <a class="code" href="annotate_8c.html#acb9815704180dd28dd5d5c6af7612a71">annotate_catchpoint</a> (b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>);
<a name="l07903"></a>07903   <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#a75f0f9a837eac292ab6e768e8d8f1bd7">disposition</a> == <a class="code" href="breakpoint_8h.html#a15f2bbd9012f59bc09d59feef0c15732a16da7fb4204cb3f58c753fafa80bfab7">disp_del</a>)
<a name="l07904"></a>07904     <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;\nTemporary catchpoint &quot;</span>);
<a name="l07905"></a>07905   <span class="keywordflow">else</span>
<a name="l07906"></a>07906     <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;\nCatchpoint &quot;</span>);
<a name="l07907"></a>07907   <a class="code" href="ui-out_8c.html#aa6f66551d03db456fb94ca1c9038f5a0">ui_out_field_int</a> (uiout, <span class="stringliteral">&quot;bkptno&quot;</span>, b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>);
<a name="l07908"></a>07908   <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;\n&quot;</span>);
<a name="l07909"></a>07909   <span class="keywordflow">if</span> (<a class="code" href="ui-out_8c.html#a473db54efcfbc60feeb5a4f54f27af46">ui_out_is_mi_like_p</a> (uiout))
<a name="l07910"></a>07910     <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a> (uiout, <span class="stringliteral">&quot;disp&quot;</span>, <a class="code" href="breakpoint_8c.html#a6f45019563f41b3ae4dc92df09f12618">bpdisp_text</a> (b-&gt;<a class="code" href="structbreakpoint.html#a75f0f9a837eac292ab6e768e8d8f1bd7">disposition</a>));
<a name="l07911"></a>07911   print_solib_event (1);
<a name="l07912"></a>07912   <span class="keywordflow">return</span> <a class="code" href="breakpoint_8h.html#ab6ab1d6a867561653e32a901b41be66ba322bad7b3370a43f44f33ae73a196231">PRINT_SRC_AND_LOC</a>;
<a name="l07913"></a>07913 }
<a name="l07914"></a>07914 
<a name="l07915"></a>07915 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l07916"></a>07916 print_one_catch_solib (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b, <span class="keyword">struct</span> bp_location **locs)
<a name="l07917"></a>07917 {
<a name="l07918"></a>07918   <span class="keyword">struct </span>solib_catchpoint *<span class="keyword">self</span> = (<span class="keyword">struct </span>solib_catchpoint *) b;
<a name="l07919"></a>07919   <span class="keyword">struct </span><a class="code" href="structvalue__print__options.html">value_print_options</a> opts;
<a name="l07920"></a>07920   <span class="keyword">struct </span>ui_out *uiout = <a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>;
<a name="l07921"></a>07921   <span class="keywordtype">char</span> *msg;
<a name="l07922"></a>07922 
<a name="l07923"></a>07923   <a class="code" href="valprint_8c.html#aa2d4dfe4b11841ccafc4d0c0d410095d">get_user_print_options</a> (&amp;opts);
<a name="l07924"></a>07924   <span class="comment">/* Field 4, the address, is omitted (which makes the columns not</span>
<a name="l07925"></a>07925 <span class="comment">     line up too nicely with the headers, but the effect is relatively</span>
<a name="l07926"></a>07926 <span class="comment">     readable).  */</span>
<a name="l07927"></a>07927   <span class="keywordflow">if</span> (opts.addressprint)
<a name="l07928"></a>07928     {
<a name="l07929"></a>07929       <a class="code" href="annotate_8c.html#a3b961efbc346558aade25e12945835fe">annotate_field</a> (4);
<a name="l07930"></a>07930       <a class="code" href="ui-out_8c.html#a5366a822858ecedafef54625bec57442">ui_out_field_skip</a> (uiout, <span class="stringliteral">&quot;addr&quot;</span>);
<a name="l07931"></a>07931     }
<a name="l07932"></a>07932 
<a name="l07933"></a>07933   <a class="code" href="annotate_8c.html#a3b961efbc346558aade25e12945835fe">annotate_field</a> (5);
<a name="l07934"></a>07934   <span class="keywordflow">if</span> (self-&gt;is_load)
<a name="l07935"></a>07935     {
<a name="l07936"></a>07936       <span class="keywordflow">if</span> (self-&gt;regex)
<a name="l07937"></a>07937         msg = <a class="code" href="common-utils_8c.html#ab9bf7e1b4e68bdd0078e9e1e55c62cec">xstrprintf</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;load of library matching %s&quot;</span>), self-&gt;regex);
<a name="l07938"></a>07938       <span class="keywordflow">else</span>
<a name="l07939"></a>07939         msg = xstrdup (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;load of library&quot;</span>));
<a name="l07940"></a>07940     }
<a name="l07941"></a>07941   <span class="keywordflow">else</span>
<a name="l07942"></a>07942     {
<a name="l07943"></a>07943       <span class="keywordflow">if</span> (self-&gt;regex)
<a name="l07944"></a>07944         msg = <a class="code" href="common-utils_8c.html#ab9bf7e1b4e68bdd0078e9e1e55c62cec">xstrprintf</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;unload of library matching %s&quot;</span>), self-&gt;regex);
<a name="l07945"></a>07945       <span class="keywordflow">else</span>
<a name="l07946"></a>07946         msg = xstrdup (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;unload of library&quot;</span>));
<a name="l07947"></a>07947     }
<a name="l07948"></a>07948   <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a> (uiout, <span class="stringliteral">&quot;what&quot;</span>, msg);
<a name="l07949"></a>07949   <a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a> (msg);
<a name="l07950"></a>07950 
<a name="l07951"></a>07951   <span class="keywordflow">if</span> (<a class="code" href="ui-out_8c.html#a473db54efcfbc60feeb5a4f54f27af46">ui_out_is_mi_like_p</a> (uiout))
<a name="l07952"></a>07952     <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a> (uiout, <span class="stringliteral">&quot;catch-type&quot;</span>,
<a name="l07953"></a>07953                          self-&gt;is_load ? <span class="stringliteral">&quot;load&quot;</span> : <span class="stringliteral">&quot;unload&quot;</span>);
<a name="l07954"></a>07954 }
<a name="l07955"></a>07955 
<a name="l07956"></a>07956 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l07957"></a>07957 print_mention_catch_solib (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b)
<a name="l07958"></a>07958 {
<a name="l07959"></a>07959   <span class="keyword">struct </span>solib_catchpoint *<span class="keyword">self</span> = (<span class="keyword">struct </span>solib_catchpoint *) b;
<a name="l07960"></a>07960 
<a name="l07961"></a>07961   <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Catchpoint %d (%s)&quot;</span>), b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>,
<a name="l07962"></a>07962                    self-&gt;is_load ? <span class="stringliteral">&quot;load&quot;</span> : <span class="stringliteral">&quot;unload&quot;</span>);
<a name="l07963"></a>07963 }
<a name="l07964"></a>07964 
<a name="l07965"></a>07965 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l07966"></a>07966 print_recreate_catch_solib (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b, <span class="keyword">struct</span> ui_file *fp)
<a name="l07967"></a>07967 {
<a name="l07968"></a>07968   <span class="keyword">struct </span>solib_catchpoint *<span class="keyword">self</span> = (<span class="keyword">struct </span>solib_catchpoint *) b;
<a name="l07969"></a>07969 
<a name="l07970"></a>07970   <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (fp, <span class="stringliteral">&quot;%s %s&quot;</span>,
<a name="l07971"></a>07971                       b-&gt;<a class="code" href="structbreakpoint.html#a75f0f9a837eac292ab6e768e8d8f1bd7">disposition</a> == <a class="code" href="breakpoint_8h.html#a15f2bbd9012f59bc09d59feef0c15732a16da7fb4204cb3f58c753fafa80bfab7">disp_del</a> ? <span class="stringliteral">&quot;tcatch&quot;</span> : <span class="stringliteral">&quot;catch&quot;</span>,
<a name="l07972"></a>07972                       self-&gt;is_load ? <span class="stringliteral">&quot;load&quot;</span> : <span class="stringliteral">&quot;unload&quot;</span>);
<a name="l07973"></a>07973   <span class="keywordflow">if</span> (self-&gt;regex)
<a name="l07974"></a>07974     <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (fp, <span class="stringliteral">&quot; %s&quot;</span>, self-&gt;regex);
<a name="l07975"></a>07975   <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (fp, <span class="stringliteral">&quot;\n&quot;</span>);
<a name="l07976"></a>07976 }
<a name="l07977"></a>07977 
<a name="l07978"></a>07978 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structbreakpoint__ops.html">breakpoint_ops</a> catch_solib_breakpoint_ops;
<a name="l07979"></a>07979 
<a name="l07980"></a>07980 <span class="comment">/* Shared helper function (MI and CLI) for creating and installing</span>
<a name="l07981"></a>07981 <span class="comment">   a shared object event catchpoint.  If IS_LOAD is non-zero then</span>
<a name="l07982"></a>07982 <span class="comment">   the events to be caught are load events, otherwise they are</span>
<a name="l07983"></a>07983 <span class="comment">   unload events.  If IS_TEMP is non-zero the catchpoint is a</span>
<a name="l07984"></a>07984 <span class="comment">   temporary one.  If ENABLED is non-zero the catchpoint is</span>
<a name="l07985"></a>07985 <span class="comment">   created in an enabled state.  */</span>
<a name="l07986"></a>07986 
<a name="l07987"></a>07987 <span class="keywordtype">void</span>
<a name="l07988"></a><a class="code" href="breakpoint_8h.html#ae40181f8cae673bc01333b591c3be90b">07988</a> <a class="code" href="breakpoint_8c.html#ae40181f8cae673bc01333b591c3be90b">add_solib_catchpoint</a> (<span class="keywordtype">char</span> *arg, <span class="keywordtype">int</span> is_load, <span class="keywordtype">int</span> is_temp, <span class="keywordtype">int</span> enabled)
<a name="l07989"></a>07989 {
<a name="l07990"></a>07990   <span class="keyword">struct </span>solib_catchpoint *c;
<a name="l07991"></a>07991   <span class="keyword">struct </span>gdbarch *gdbarch = <a class="code" href="arch-utils_8c.html#a0fe1e68475f442e5d6dda589e0c62454">get_current_arch</a> ();
<a name="l07992"></a>07992   <span class="keyword">struct </span>cleanup *cleanup;
<a name="l07993"></a>07993 
<a name="l07994"></a>07994   <span class="keywordflow">if</span> (!arg)
<a name="l07995"></a>07995     arg = <span class="stringliteral">&quot;&quot;</span>;
<a name="l07996"></a>07996   arg = <a class="code" href="cli-utils_8c.html#afa70bcaee54d487b4412d2a7a5a0c8fa">skip_spaces</a> (arg);
<a name="l07997"></a>07997 
<a name="l07998"></a>07998   c = XCNEW (<span class="keyword">struct</span> solib_catchpoint);
<a name="l07999"></a>07999   cleanup = <a class="code" href="cleanups_8c.html#a3d418f8af424aec399898c2d48b26224">make_cleanup</a> (<a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a>, c);
<a name="l08000"></a>08000 
<a name="l08001"></a>08001   <span class="keywordflow">if</span> (*arg != <span class="charliteral">&#39;\0&#39;</span>)
<a name="l08002"></a>08002     {
<a name="l08003"></a>08003       <span class="keywordtype">int</span> errcode;
<a name="l08004"></a>08004 
<a name="l08005"></a>08005       errcode = regcomp (&amp;c-&gt;compiled, arg, REG_NOSUB);
<a name="l08006"></a>08006       <span class="keywordflow">if</span> (errcode != 0)
<a name="l08007"></a>08007         {
<a name="l08008"></a>08008           <span class="keywordtype">char</span> *err = <a class="code" href="gdb__regex_8h.html#aebb2300eb21dd6727c71c46abb0f3f2a">get_regcomp_error</a> (errcode, &amp;c-&gt;compiled);
<a name="l08009"></a>08009 
<a name="l08010"></a>08010           <a class="code" href="cleanups_8c.html#a3d418f8af424aec399898c2d48b26224">make_cleanup</a> (<a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a>, err);
<a name="l08011"></a>08011           <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Invalid regexp (%s): %s&quot;</span>), err, arg);
<a name="l08012"></a>08012         }
<a name="l08013"></a>08013       c-&gt;regex = xstrdup (arg);
<a name="l08014"></a>08014     }
<a name="l08015"></a>08015 
<a name="l08016"></a>08016   c-&gt;is_load = is_load;
<a name="l08017"></a>08017   <a class="code" href="breakpoint_8c.html#abf44b8421146622741d99fe9ba43b544">init_catchpoint</a> (&amp;c-&gt;base, gdbarch, is_temp, NULL,
<a name="l08018"></a>08018                    &amp;catch_solib_breakpoint_ops);
<a name="l08019"></a>08019 
<a name="l08020"></a>08020   c-&gt;base.enable_state = enabled ? <a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577a72f1fa981d13a62d05324c1de974b44b">bp_enabled</a> : <a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577a4605f207d0d15bd8195c9b1aa1bfee96">bp_disabled</a>;
<a name="l08021"></a>08021 
<a name="l08022"></a>08022   <a class="code" href="cleanups_8c.html#a5ec3987bf995edcc44def9e17ada6eba">discard_cleanups</a> (cleanup);
<a name="l08023"></a>08023   <a class="code" href="breakpoint_8c.html#a74ff6d8191c3b444efd5631143d21635">install_breakpoint</a> (0, &amp;c-&gt;base, 1);
<a name="l08024"></a>08024 }
<a name="l08025"></a>08025 
<a name="l08026"></a>08026 <span class="comment">/* A helper function that does all the work for &quot;catch load&quot; and</span>
<a name="l08027"></a>08027 <span class="comment">   &quot;catch unload&quot;.  */</span>
<a name="l08028"></a>08028 
<a name="l08029"></a>08029 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l08030"></a>08030 catch_load_or_unload (<span class="keywordtype">char</span> *arg, <span class="keywordtype">int</span> from_tty, <span class="keywordtype">int</span> is_load,
<a name="l08031"></a>08031                       <span class="keyword">struct</span> <a class="code" href="structcmd__list__element.html">cmd_list_element</a> *command)
<a name="l08032"></a>08032 {
<a name="l08033"></a>08033   <span class="keywordtype">int</span> tempflag;
<a name="l08034"></a>08034   <span class="keyword">const</span> <span class="keywordtype">int</span> enabled = 1;
<a name="l08035"></a>08035 
<a name="l08036"></a>08036   tempflag = <a class="code" href="cli-decode_8c.html#a32e42936fca3a5158162ca425eb2c4b9">get_cmd_context</a> (command) == <a class="code" href="breakpoint_8h.html#a9f80fa035808be1497fc37fd6595587e">CATCH_TEMPORARY</a>;
<a name="l08037"></a>08037 
<a name="l08038"></a>08038   <a class="code" href="breakpoint_8c.html#ae40181f8cae673bc01333b591c3be90b">add_solib_catchpoint</a> (arg, is_load, tempflag, enabled);
<a name="l08039"></a>08039 }
<a name="l08040"></a>08040 
<a name="l08041"></a>08041 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l08042"></a>08042 catch_load_command_1 (<span class="keywordtype">char</span> *arg, <span class="keywordtype">int</span> from_tty,
<a name="l08043"></a>08043                       <span class="keyword">struct</span> <a class="code" href="structcmd__list__element.html">cmd_list_element</a> *command)
<a name="l08044"></a>08044 {
<a name="l08045"></a>08045   catch_load_or_unload (arg, from_tty, 1, command);
<a name="l08046"></a>08046 }
<a name="l08047"></a>08047 
<a name="l08048"></a>08048 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l08049"></a>08049 catch_unload_command_1 (<span class="keywordtype">char</span> *arg, <span class="keywordtype">int</span> from_tty,
<a name="l08050"></a>08050                         <span class="keyword">struct</span> <a class="code" href="structcmd__list__element.html">cmd_list_element</a> *command)
<a name="l08051"></a>08051 {
<a name="l08052"></a>08052   catch_load_or_unload (arg, from_tty, 0, command);
<a name="l08053"></a>08053 }
<a name="l08054"></a>08054 
<a name="l08055"></a>08055 <span class="comment">/* An instance of this type is used to represent a syscall catchpoint.</span>
<a name="l08056"></a>08056 <span class="comment">   It includes a &quot;struct breakpoint&quot; as a kind of base class; users</span>
<a name="l08057"></a>08057 <span class="comment">   downcast to &quot;struct breakpoint *&quot; when needed.  A breakpoint is</span>
<a name="l08058"></a>08058 <span class="comment">   really of this type iff its ops pointer points to</span>
<a name="l08059"></a>08059 <span class="comment">   CATCH_SYSCALL_BREAKPOINT_OPS.  */</span>
<a name="l08060"></a>08060 
<a name="l08061"></a>08061 <span class="keyword">struct </span>syscall_catchpoint
<a name="l08062"></a>08062 {
<a name="l08063"></a>08063   <span class="comment">/* The base class.  */</span>
<a name="l08064"></a>08064   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> base;
<a name="l08065"></a>08065 
<a name="l08066"></a>08066   <span class="comment">/* Syscall numbers used for the &#39;catch syscall&#39; feature.  If no</span>
<a name="l08067"></a>08067 <span class="comment">     syscall has been specified for filtering, its value is NULL.</span>
<a name="l08068"></a>08068 <span class="comment">     Otherwise, it holds a list of all syscalls to be caught.  The</span>
<a name="l08069"></a>08069 <span class="comment">     list elements are allocated with xmalloc.  */</span>
<a name="l08070"></a>08070   <a class="code" href="vec_8h.html#ab084f6f29fcf16a6b15d15feb653d414">VEC</a>(<span class="keywordtype">int</span>) *syscalls_to_be_caught;
<a name="l08071"></a>08071 };
<a name="l08072"></a>08072 
<a name="l08073"></a>08073 <span class="comment">/* Implement the &quot;dtor&quot; breakpoint_ops method for syscall</span>
<a name="l08074"></a>08074 <span class="comment">   catchpoints.  */</span>
<a name="l08075"></a>08075 
<a name="l08076"></a>08076 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l08077"></a>08077 dtor_catch_syscall (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b)
<a name="l08078"></a>08078 {
<a name="l08079"></a>08079   <span class="keyword">struct </span>syscall_catchpoint *c = (<span class="keyword">struct </span>syscall_catchpoint *) b;
<a name="l08080"></a>08080 
<a name="l08081"></a>08081   <a class="code" href="vec_8h.html#af5724b2bbce65103300279f9abe7f577">VEC_free</a> (<span class="keywordtype">int</span>, c-&gt;syscalls_to_be_caught);
<a name="l08082"></a>08082 
<a name="l08083"></a>08083   <a class="code" href="breakpoint_8c.html#aefe1d12780f2d7ae5fb89ac113e204e0">base_breakpoint_ops</a>.<a class="code" href="structbreakpoint__ops.html#a110b2df7b285e5f83bf40b9a0e5435c1">dtor</a> (b);
<a name="l08084"></a>08084 }
<a name="l08085"></a>08085 
<a name="l08086"></a>08086 <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span>inferior_data *catch_syscall_inferior_data = NULL;
<a name="l08087"></a>08087 
<a name="l08088"></a>08088 <span class="keyword">struct </span>catch_syscall_inferior_data
<a name="l08089"></a>08089 {
<a name="l08090"></a>08090   <span class="comment">/* We keep a count of the number of times the user has requested a</span>
<a name="l08091"></a>08091 <span class="comment">     particular syscall to be tracked, and pass this information to the</span>
<a name="l08092"></a>08092 <span class="comment">     target.  This lets capable targets implement filtering directly.  */</span>
<a name="l08093"></a>08093 
<a name="l08094"></a>08094   <span class="comment">/* Number of times that &quot;any&quot; syscall is requested.  */</span>
<a name="l08095"></a>08095   <span class="keywordtype">int</span> any_syscall_count;
<a name="l08096"></a>08096 
<a name="l08097"></a>08097   <span class="comment">/* Count of each system call.  */</span>
<a name="l08098"></a>08098   <a class="code" href="vec_8h.html#ab084f6f29fcf16a6b15d15feb653d414">VEC</a>(<span class="keywordtype">int</span>) *syscalls_counts;
<a name="l08099"></a>08099 
<a name="l08100"></a>08100   <span class="comment">/* This counts all syscall catch requests, so we can readily determine</span>
<a name="l08101"></a>08101 <span class="comment">     if any catching is necessary.  */</span>
<a name="l08102"></a>08102   <span class="keywordtype">int</span> total_syscalls_count;
<a name="l08103"></a>08103 };
<a name="l08104"></a>08104 
<a name="l08105"></a>08105 <span class="keyword">static</span> <span class="keyword">struct </span>catch_syscall_inferior_data*
<a name="l08106"></a>08106 get_catch_syscall_inferior_data (<span class="keyword">struct</span> <a class="code" href="structinferior.html">inferior</a> *inf)
<a name="l08107"></a>08107 {
<a name="l08108"></a>08108   <span class="keyword">struct </span>catch_syscall_inferior_data *inf_data;
<a name="l08109"></a>08109 
<a name="l08110"></a>08110   inf_data = inferior_data (inf, catch_syscall_inferior_data);
<a name="l08111"></a>08111   <span class="keywordflow">if</span> (inf_data == NULL)
<a name="l08112"></a>08112     {
<a name="l08113"></a>08113       inf_data = <a class="code" href="defs_8h.html#ab004b072c2eba9eb35ffb7b86a72b8c0">XZALLOC</a> (<span class="keyword">struct</span> catch_syscall_inferior_data);
<a name="l08114"></a>08114       set_inferior_data (inf, catch_syscall_inferior_data, inf_data);
<a name="l08115"></a>08115     }
<a name="l08116"></a>08116 
<a name="l08117"></a>08117   <span class="keywordflow">return</span> inf_data;
<a name="l08118"></a>08118 }
<a name="l08119"></a>08119 
<a name="l08120"></a>08120 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l08121"></a>08121 catch_syscall_inferior_data_cleanup (<span class="keyword">struct</span> <a class="code" href="structinferior.html">inferior</a> *inf, <span class="keywordtype">void</span> *arg)
<a name="l08122"></a>08122 {
<a name="l08123"></a>08123   <a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a> (arg);
<a name="l08124"></a>08124 }
<a name="l08125"></a>08125 
<a name="l08126"></a>08126 
<a name="l08127"></a>08127 <span class="comment">/* Implement the &quot;insert&quot; breakpoint_ops method for syscall</span>
<a name="l08128"></a>08128 <span class="comment">   catchpoints.  */</span>
<a name="l08129"></a>08129 
<a name="l08130"></a>08130 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l08131"></a>08131 insert_catch_syscall (<span class="keyword">struct</span> bp_location *bl)
<a name="l08132"></a>08132 {
<a name="l08133"></a>08133   <span class="keyword">struct </span>syscall_catchpoint *c = (<span class="keyword">struct </span>syscall_catchpoint *) bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>;
<a name="l08134"></a>08134   <span class="keyword">struct</span> <a class="code" href="structinferior.html">inferior</a> *inf = <a class="code" href="inferior_8c.html#a9e592c83e7c0c1f89f1a4a392bd1a277">current_inferior</a> ();
<a name="l08135"></a>08135   <span class="keyword">struct </span>catch_syscall_inferior_data *inf_data
<a name="l08136"></a>08136     = get_catch_syscall_inferior_data (inf);
<a name="l08137"></a>08137 
<a name="l08138"></a>08138   ++inf_data-&gt;total_syscalls_count;
<a name="l08139"></a>08139   <span class="keywordflow">if</span> (!c-&gt;syscalls_to_be_caught)
<a name="l08140"></a>08140     ++inf_data-&gt;any_syscall_count;
<a name="l08141"></a>08141   <span class="keywordflow">else</span>
<a name="l08142"></a>08142     {
<a name="l08143"></a>08143       <span class="keywordtype">int</span> i, iter;
<a name="l08144"></a>08144 
<a name="l08145"></a>08145       <span class="keywordflow">for</span> (i = 0;
<a name="l08146"></a>08146            <a class="code" href="vec_8h.html#ae7795b0c8e65f45eb49aac5ec2c0fa52">VEC_iterate</a> (<span class="keywordtype">int</span>, c-&gt;syscalls_to_be_caught, i, iter);
<a name="l08147"></a>08147            i++)
<a name="l08148"></a>08148         {
<a name="l08149"></a>08149           <span class="keywordtype">int</span> elem;
<a name="l08150"></a>08150 
<a name="l08151"></a>08151           <span class="keywordflow">if</span> (iter &gt;= <a class="code" href="vec_8h.html#a844523bba6d0565ef73a0f4a63e48d19">VEC_length</a> (<span class="keywordtype">int</span>, inf_data-&gt;syscalls_counts))
<a name="l08152"></a>08152             {
<a name="l08153"></a>08153               <span class="keywordtype">int</span> old_size = <a class="code" href="vec_8h.html#a844523bba6d0565ef73a0f4a63e48d19">VEC_length</a> (<span class="keywordtype">int</span>, inf_data-&gt;syscalls_counts);
<a name="l08154"></a>08154               uintptr_t vec_addr_offset
<a name="l08155"></a>08155                 = old_size * ((uintptr_t) <span class="keyword">sizeof</span> (<span class="keywordtype">int</span>));
<a name="l08156"></a>08156               uintptr_t vec_addr;
<a name="l08157"></a>08157               <a class="code" href="vec_8h.html#a673e8c6554fe36ebb1c06202ac22819b">VEC_safe_grow</a> (<span class="keywordtype">int</span>, inf_data-&gt;syscalls_counts, iter + 1);
<a name="l08158"></a>08158               vec_addr = ((uintptr_t) <a class="code" href="vec_8h.html#a99adc2006a668acc675e3758d9375ad5">VEC_address</a> (<span class="keywordtype">int</span>,
<a name="l08159"></a>08159                                                   inf_data-&gt;syscalls_counts)
<a name="l08160"></a>08160                           + vec_addr_offset);
<a name="l08161"></a>08161               <a class="code" href="gdb__string_8h.html#adb03df3679ce1445e801310614624ccb">memset</a> ((<span class="keywordtype">void</span> *) vec_addr, 0,
<a name="l08162"></a>08162                       (iter + 1 - old_size) * <span class="keyword">sizeof</span> (<span class="keywordtype">int</span>));
<a name="l08163"></a>08163             }
<a name="l08164"></a>08164           elem = <a class="code" href="vec_8h.html#a49c128c353995ea8fca27be70829ca52">VEC_index</a> (<span class="keywordtype">int</span>, inf_data-&gt;syscalls_counts, iter);
<a name="l08165"></a>08165           <a class="code" href="vec_8h.html#ae898349bda7814bcf92db36c0550a10f">VEC_replace</a> (<span class="keywordtype">int</span>, inf_data-&gt;syscalls_counts, iter, ++elem);
<a name="l08166"></a>08166         }
<a name="l08167"></a>08167     }
<a name="l08168"></a>08168 
<a name="l08169"></a>08169   <span class="keywordflow">return</span> <a class="code" href="target_8h.html#a1cf997cc6a54628fd3d4e3e9a5174268">target_set_syscall_catchpoint</a> (<a class="code" href="ptid_8c.html#a264ba40fc2a0cf3d4fb24a55fe32aede">ptid_get_pid</a> (<a class="code" href="infcmd_8c.html#a428c5be9ce5e70bd03760e828e19c6b7">inferior_ptid</a>),
<a name="l08170"></a>08170                                         inf_data-&gt;total_syscalls_count != 0,
<a name="l08171"></a>08171                                         inf_data-&gt;any_syscall_count,
<a name="l08172"></a>08172                                         <a class="code" href="vec_8h.html#a844523bba6d0565ef73a0f4a63e48d19">VEC_length</a> (<span class="keywordtype">int</span>,
<a name="l08173"></a>08173                                                     inf_data-&gt;syscalls_counts),
<a name="l08174"></a>08174                                         <a class="code" href="vec_8h.html#a99adc2006a668acc675e3758d9375ad5">VEC_address</a> (<span class="keywordtype">int</span>,
<a name="l08175"></a>08175                                                      inf_data-&gt;syscalls_counts));
<a name="l08176"></a>08176 }
<a name="l08177"></a>08177 
<a name="l08178"></a>08178 <span class="comment">/* Implement the &quot;remove&quot; breakpoint_ops method for syscall</span>
<a name="l08179"></a>08179 <span class="comment">   catchpoints.  */</span>
<a name="l08180"></a>08180 
<a name="l08181"></a>08181 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l08182"></a>08182 remove_catch_syscall (<span class="keyword">struct</span> bp_location *bl)
<a name="l08183"></a>08183 {
<a name="l08184"></a>08184   <span class="keyword">struct </span>syscall_catchpoint *c = (<span class="keyword">struct </span>syscall_catchpoint *) bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>;
<a name="l08185"></a>08185   <span class="keyword">struct</span> <a class="code" href="structinferior.html">inferior</a> *inf = <a class="code" href="inferior_8c.html#a9e592c83e7c0c1f89f1a4a392bd1a277">current_inferior</a> ();
<a name="l08186"></a>08186   <span class="keyword">struct </span>catch_syscall_inferior_data *inf_data
<a name="l08187"></a>08187     = get_catch_syscall_inferior_data (inf);
<a name="l08188"></a>08188 
<a name="l08189"></a>08189   --inf_data-&gt;total_syscalls_count;
<a name="l08190"></a>08190   <span class="keywordflow">if</span> (!c-&gt;syscalls_to_be_caught)
<a name="l08191"></a>08191     --inf_data-&gt;any_syscall_count;
<a name="l08192"></a>08192   <span class="keywordflow">else</span>
<a name="l08193"></a>08193     {
<a name="l08194"></a>08194       <span class="keywordtype">int</span> i, iter;
<a name="l08195"></a>08195 
<a name="l08196"></a>08196       <span class="keywordflow">for</span> (i = 0;
<a name="l08197"></a>08197            <a class="code" href="vec_8h.html#ae7795b0c8e65f45eb49aac5ec2c0fa52">VEC_iterate</a> (<span class="keywordtype">int</span>, c-&gt;syscalls_to_be_caught, i, iter);
<a name="l08198"></a>08198            i++)
<a name="l08199"></a>08199         {
<a name="l08200"></a>08200           <span class="keywordtype">int</span> elem;
<a name="l08201"></a>08201           <span class="keywordflow">if</span> (iter &gt;= <a class="code" href="vec_8h.html#a844523bba6d0565ef73a0f4a63e48d19">VEC_length</a> (<span class="keywordtype">int</span>, inf_data-&gt;syscalls_counts))
<a name="l08202"></a>08202             <span class="comment">/* Shouldn&#39;t happen.  */</span>
<a name="l08203"></a>08203             <span class="keywordflow">continue</span>;
<a name="l08204"></a>08204           elem = <a class="code" href="vec_8h.html#a49c128c353995ea8fca27be70829ca52">VEC_index</a> (<span class="keywordtype">int</span>, inf_data-&gt;syscalls_counts, iter);
<a name="l08205"></a>08205           <a class="code" href="vec_8h.html#ae898349bda7814bcf92db36c0550a10f">VEC_replace</a> (<span class="keywordtype">int</span>, inf_data-&gt;syscalls_counts, iter, --elem);
<a name="l08206"></a>08206         }
<a name="l08207"></a>08207     }
<a name="l08208"></a>08208 
<a name="l08209"></a>08209   <span class="keywordflow">return</span> <a class="code" href="target_8h.html#a1cf997cc6a54628fd3d4e3e9a5174268">target_set_syscall_catchpoint</a> (<a class="code" href="ptid_8c.html#a264ba40fc2a0cf3d4fb24a55fe32aede">ptid_get_pid</a> (<a class="code" href="infcmd_8c.html#a428c5be9ce5e70bd03760e828e19c6b7">inferior_ptid</a>),
<a name="l08210"></a>08210                                         inf_data-&gt;total_syscalls_count != 0,
<a name="l08211"></a>08211                                         inf_data-&gt;any_syscall_count,
<a name="l08212"></a>08212                                         <a class="code" href="vec_8h.html#a844523bba6d0565ef73a0f4a63e48d19">VEC_length</a> (<span class="keywordtype">int</span>,
<a name="l08213"></a>08213                                                     inf_data-&gt;syscalls_counts),
<a name="l08214"></a>08214                                         <a class="code" href="vec_8h.html#a99adc2006a668acc675e3758d9375ad5">VEC_address</a> (<span class="keywordtype">int</span>,
<a name="l08215"></a>08215                                                      inf_data-&gt;syscalls_counts));
<a name="l08216"></a>08216 }
<a name="l08217"></a>08217 
<a name="l08218"></a>08218 <span class="comment">/* Implement the &quot;breakpoint_hit&quot; breakpoint_ops method for syscall</span>
<a name="l08219"></a>08219 <span class="comment">   catchpoints.  */</span>
<a name="l08220"></a>08220 
<a name="l08221"></a>08221 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l08222"></a>08222 breakpoint_hit_catch_syscall (<span class="keyword">const</span> <span class="keyword">struct</span> bp_location *bl,
<a name="l08223"></a>08223                               <span class="keyword">struct</span> address_space *aspace, <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> bp_addr,
<a name="l08224"></a>08224                               <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structtarget__waitstatus.html">target_waitstatus</a> *ws)
<a name="l08225"></a>08225 {
<a name="l08226"></a>08226   <span class="comment">/* We must check if we are catching specific syscalls in this</span>
<a name="l08227"></a>08227 <span class="comment">     breakpoint.  If we are, then we must guarantee that the called</span>
<a name="l08228"></a>08228 <span class="comment">     syscall is the same syscall we are catching.  */</span>
<a name="l08229"></a>08229   <span class="keywordtype">int</span> syscall_number = 0;
<a name="l08230"></a>08230   <span class="keyword">const</span> <span class="keyword">struct </span>syscall_catchpoint *c
<a name="l08231"></a>08231     = (<span class="keyword">const</span> <span class="keyword">struct </span>syscall_catchpoint *) bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>;
<a name="l08232"></a>08232 
<a name="l08233"></a>08233   if (ws-&gt;<a class="code" href="structtarget__waitstatus.html#a17ed1783e9146f443fa51ace8da76198">kind</a> != <a class="code" href="waitstatus_8h.html#aa3229b489ec985f04f7e9f652138b7c3adc7870183b2e27d4c08dc811ee00ebf3">TARGET_WAITKIND_SYSCALL_ENTRY</a>
<a name="l08234"></a>08234       &amp;&amp; ws-&gt;<a class="code" href="structtarget__waitstatus.html#a17ed1783e9146f443fa51ace8da76198">kind</a> != <a class="code" href="waitstatus_8h.html#aa3229b489ec985f04f7e9f652138b7c3ac5ef049c1f4bc2cc3f5fe99d161d4ffa">TARGET_WAITKIND_SYSCALL_RETURN</a>)
<a name="l08235"></a>08235     <span class="keywordflow">return</span> 0;
<a name="l08236"></a>08236 
<a name="l08237"></a>08237   syscall_number = ws-&gt;<a class="code" href="structtarget__waitstatus.html#af33b8f5721dc36f6b5b829286d38f825">value</a>.<a class="code" href="structtarget__waitstatus.html#ab631bd5cf65d3ea0af8ed2fa744ae071">syscall_number</a>;
<a name="l08238"></a>08238 
<a name="l08239"></a>08239   <span class="comment">/* Now, checking if the syscall is the same.  */</span>
<a name="l08240"></a>08240   <span class="keywordflow">if</span> (c-&gt;syscalls_to_be_caught)
<a name="l08241"></a>08241     {
<a name="l08242"></a>08242       <span class="keywordtype">int</span> i, iter;
<a name="l08243"></a>08243 
<a name="l08244"></a>08244       <span class="keywordflow">for</span> (i = 0;
<a name="l08245"></a>08245            <a class="code" href="vec_8h.html#ae7795b0c8e65f45eb49aac5ec2c0fa52">VEC_iterate</a> (<span class="keywordtype">int</span>, c-&gt;syscalls_to_be_caught, i, iter);
<a name="l08246"></a>08246            i++)
<a name="l08247"></a>08247         <span class="keywordflow">if</span> (syscall_number == iter)
<a name="l08248"></a>08248           <span class="keywordflow">break</span>;
<a name="l08249"></a>08249       <span class="comment">/* Not the same.  */</span>
<a name="l08250"></a>08250       <span class="keywordflow">if</span> (!iter)
<a name="l08251"></a>08251         <span class="keywordflow">return</span> 0;
<a name="l08252"></a>08252     }
<a name="l08253"></a>08253 
<a name="l08254"></a>08254   <span class="keywordflow">return</span> 1;
<a name="l08255"></a>08255 }
<a name="l08256"></a>08256 
<a name="l08257"></a>08257 <span class="comment">/* Implement the &quot;print_it&quot; breakpoint_ops method for syscall</span>
<a name="l08258"></a>08258 <span class="comment">   catchpoints.  */</span>
<a name="l08259"></a>08259 
<a name="l08260"></a>08260 <span class="keyword">static</span> <span class="keyword">enum</span> <a class="code" href="breakpoint_8h.html#ab6ab1d6a867561653e32a901b41be66b">print_stop_action</a>
<a name="l08261"></a>08261 print_it_catch_syscall (<a class="code" href="structbpstats.html">bpstat</a> bs)
<a name="l08262"></a>08262 {
<a name="l08263"></a>08263   <span class="keyword">struct </span>ui_out *uiout = <a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>;
<a name="l08264"></a>08264   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b = bs-&gt;<a class="code" href="structbpstats.html#ac105ed7263dd10f9d65e92e706b04e39">breakpoint_at</a>;
<a name="l08265"></a>08265   <span class="comment">/* These are needed because we want to know in which state a</span>
<a name="l08266"></a>08266 <span class="comment">     syscall is.  It can be in the TARGET_WAITKIND_SYSCALL_ENTRY</span>
<a name="l08267"></a>08267 <span class="comment">     or TARGET_WAITKIND_SYSCALL_RETURN, and depending on it we</span>
<a name="l08268"></a>08268 <span class="comment">     must print &quot;called syscall&quot; or &quot;returned from syscall&quot;.  */</span>
<a name="l08269"></a>08269   <a class="code" href="structptid.html">ptid_t</a> ptid;
<a name="l08270"></a>08270   <span class="keyword">struct </span><a class="code" href="structtarget__waitstatus.html">target_waitstatus</a> last;
<a name="l08271"></a>08271   <span class="keyword">struct </span><a class="code" href="structsyscall.html">syscall</a> s;
<a name="l08272"></a>08272 
<a name="l08273"></a>08273   <a class="code" href="inferior_8h.html#a4a47a81bc60d7b0fd147f0d4ce8de8bc">get_last_target_status</a> (&amp;ptid, &amp;last);
<a name="l08274"></a>08274 
<a name="l08275"></a>08275   <a class="code" href="xml-syscall_8c.html#ac3d1940c50500cae8cc9bf7634416d83">get_syscall_by_number</a> (last.value.syscall_number, &amp;s);
<a name="l08276"></a>08276 
<a name="l08277"></a>08277   <a class="code" href="annotate_8c.html#acb9815704180dd28dd5d5c6af7612a71">annotate_catchpoint</a> (b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>);
<a name="l08278"></a>08278 
<a name="l08279"></a>08279   <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#a75f0f9a837eac292ab6e768e8d8f1bd7">disposition</a> == <a class="code" href="breakpoint_8h.html#a15f2bbd9012f59bc09d59feef0c15732a16da7fb4204cb3f58c753fafa80bfab7">disp_del</a>)
<a name="l08280"></a>08280     <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;\nTemporary catchpoint &quot;</span>);
<a name="l08281"></a>08281   <span class="keywordflow">else</span>
<a name="l08282"></a>08282     <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;\nCatchpoint &quot;</span>);
<a name="l08283"></a>08283   <span class="keywordflow">if</span> (<a class="code" href="ui-out_8c.html#a473db54efcfbc60feeb5a4f54f27af46">ui_out_is_mi_like_p</a> (uiout))
<a name="l08284"></a>08284     {
<a name="l08285"></a>08285       <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a> (uiout, <span class="stringliteral">&quot;reason&quot;</span>,
<a name="l08286"></a>08286                            <a class="code" href="mi-common_8c.html#a619e7d180d78af6e6d63a611c6680e90">async_reason_lookup</a> (last.kind == <a class="code" href="waitstatus_8h.html#aa3229b489ec985f04f7e9f652138b7c3adc7870183b2e27d4c08dc811ee00ebf3">TARGET_WAITKIND_SYSCALL_ENTRY</a>
<a name="l08287"></a>08287                                                 ? <a class="code" href="mi-common_8h.html#a06d7bf56f98dcc556d686f49ea570daea6bbe2e00406808dac780032d4b257493">EXEC_ASYNC_SYSCALL_ENTRY</a>
<a name="l08288"></a>08288                                                 : <a class="code" href="mi-common_8h.html#a06d7bf56f98dcc556d686f49ea570daea946cb752c751ab21a68a25ec78c7bd0e">EXEC_ASYNC_SYSCALL_RETURN</a>));
<a name="l08289"></a>08289       <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a> (uiout, <span class="stringliteral">&quot;disp&quot;</span>, <a class="code" href="breakpoint_8c.html#a6f45019563f41b3ae4dc92df09f12618">bpdisp_text</a> (b-&gt;<a class="code" href="structbreakpoint.html#a75f0f9a837eac292ab6e768e8d8f1bd7">disposition</a>));
<a name="l08290"></a>08290     }
<a name="l08291"></a>08291   <a class="code" href="ui-out_8c.html#aa6f66551d03db456fb94ca1c9038f5a0">ui_out_field_int</a> (uiout, <span class="stringliteral">&quot;bkptno&quot;</span>, b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>);
<a name="l08292"></a>08292 
<a name="l08293"></a>08293   <span class="keywordflow">if</span> (last.kind == <a class="code" href="waitstatus_8h.html#aa3229b489ec985f04f7e9f652138b7c3adc7870183b2e27d4c08dc811ee00ebf3">TARGET_WAITKIND_SYSCALL_ENTRY</a>)
<a name="l08294"></a>08294     <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot; (call to syscall &quot;</span>);
<a name="l08295"></a>08295   <span class="keywordflow">else</span>
<a name="l08296"></a>08296     <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot; (returned from syscall &quot;</span>);
<a name="l08297"></a>08297 
<a name="l08298"></a>08298   <span class="keywordflow">if</span> (s.name == NULL || <a class="code" href="ui-out_8c.html#a473db54efcfbc60feeb5a4f54f27af46">ui_out_is_mi_like_p</a> (uiout))
<a name="l08299"></a>08299     <a class="code" href="ui-out_8c.html#aa6f66551d03db456fb94ca1c9038f5a0">ui_out_field_int</a> (uiout, <span class="stringliteral">&quot;syscall-number&quot;</span>, last.value.syscall_number);
<a name="l08300"></a>08300   <span class="keywordflow">if</span> (s.name != NULL)
<a name="l08301"></a>08301     <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a> (uiout, <span class="stringliteral">&quot;syscall-name&quot;</span>, s.name);
<a name="l08302"></a>08302 
<a name="l08303"></a>08303   <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;), &quot;</span>);
<a name="l08304"></a>08304 
<a name="l08305"></a>08305   <span class="keywordflow">return</span> <a class="code" href="breakpoint_8h.html#ab6ab1d6a867561653e32a901b41be66ba322bad7b3370a43f44f33ae73a196231">PRINT_SRC_AND_LOC</a>;
<a name="l08306"></a>08306 }
<a name="l08307"></a>08307 
<a name="l08308"></a>08308 <span class="comment">/* Implement the &quot;print_one&quot; breakpoint_ops method for syscall</span>
<a name="l08309"></a>08309 <span class="comment">   catchpoints.  */</span>
<a name="l08310"></a>08310 
<a name="l08311"></a>08311 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l08312"></a>08312 print_one_catch_syscall (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b,
<a name="l08313"></a>08313                          <span class="keyword">struct</span> bp_location **last_loc)
<a name="l08314"></a>08314 {
<a name="l08315"></a>08315   <span class="keyword">struct </span>syscall_catchpoint *c = (<span class="keyword">struct </span>syscall_catchpoint *) b;
<a name="l08316"></a>08316   <span class="keyword">struct </span><a class="code" href="structvalue__print__options.html">value_print_options</a> opts;
<a name="l08317"></a>08317   <span class="keyword">struct </span>ui_out *uiout = <a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>;
<a name="l08318"></a>08318 
<a name="l08319"></a>08319   <a class="code" href="valprint_8c.html#aa2d4dfe4b11841ccafc4d0c0d410095d">get_user_print_options</a> (&amp;opts);
<a name="l08320"></a>08320   <span class="comment">/* Field 4, the address, is omitted (which makes the columns not</span>
<a name="l08321"></a>08321 <span class="comment">     line up too nicely with the headers, but the effect is relatively</span>
<a name="l08322"></a>08322 <span class="comment">     readable).  */</span>
<a name="l08323"></a>08323   <span class="keywordflow">if</span> (opts.addressprint)
<a name="l08324"></a>08324     <a class="code" href="ui-out_8c.html#a5366a822858ecedafef54625bec57442">ui_out_field_skip</a> (uiout, <span class="stringliteral">&quot;addr&quot;</span>);
<a name="l08325"></a>08325   <a class="code" href="annotate_8c.html#a3b961efbc346558aade25e12945835fe">annotate_field</a> (5);
<a name="l08326"></a>08326 
<a name="l08327"></a>08327   <span class="keywordflow">if</span> (c-&gt;syscalls_to_be_caught
<a name="l08328"></a>08328       &amp;&amp; <a class="code" href="vec_8h.html#a844523bba6d0565ef73a0f4a63e48d19">VEC_length</a> (<span class="keywordtype">int</span>, c-&gt;syscalls_to_be_caught) &gt; 1)
<a name="l08329"></a>08329     <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;syscalls \&quot;&quot;</span>);
<a name="l08330"></a>08330   <span class="keywordflow">else</span>
<a name="l08331"></a>08331     <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;syscall \&quot;&quot;</span>);
<a name="l08332"></a>08332 
<a name="l08333"></a>08333   <span class="keywordflow">if</span> (c-&gt;syscalls_to_be_caught)
<a name="l08334"></a>08334     {
<a name="l08335"></a>08335       <span class="keywordtype">int</span> i, iter;
<a name="l08336"></a>08336       <span class="keywordtype">char</span> *text = <a class="code" href="common-utils_8c.html#ab9bf7e1b4e68bdd0078e9e1e55c62cec">xstrprintf</a> (<span class="stringliteral">&quot;%s&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);
<a name="l08337"></a>08337 
<a name="l08338"></a>08338       <span class="keywordflow">for</span> (i = 0;
<a name="l08339"></a>08339            <a class="code" href="vec_8h.html#ae7795b0c8e65f45eb49aac5ec2c0fa52">VEC_iterate</a> (<span class="keywordtype">int</span>, c-&gt;syscalls_to_be_caught, i, iter);
<a name="l08340"></a>08340            i++)
<a name="l08341"></a>08341         {
<a name="l08342"></a>08342           <span class="keywordtype">char</span> *x = text;
<a name="l08343"></a>08343           <span class="keyword">struct </span><a class="code" href="structsyscall.html">syscall</a> s;
<a name="l08344"></a>08344           <a class="code" href="xml-syscall_8c.html#ac3d1940c50500cae8cc9bf7634416d83">get_syscall_by_number</a> (iter, &amp;s);
<a name="l08345"></a>08345 
<a name="l08346"></a>08346           <span class="keywordflow">if</span> (s.name != NULL)
<a name="l08347"></a>08347             text = <a class="code" href="common-utils_8c.html#ab9bf7e1b4e68bdd0078e9e1e55c62cec">xstrprintf</a> (<span class="stringliteral">&quot;%s%s, &quot;</span>, text, s.name);
<a name="l08348"></a>08348           <span class="keywordflow">else</span>
<a name="l08349"></a>08349             text = <a class="code" href="common-utils_8c.html#ab9bf7e1b4e68bdd0078e9e1e55c62cec">xstrprintf</a> (<span class="stringliteral">&quot;%s%d, &quot;</span>, text, iter);
<a name="l08350"></a>08350 
<a name="l08351"></a>08351           <span class="comment">/* We have to xfree the last &#39;text&#39; (now stored at &#39;x&#39;)</span>
<a name="l08352"></a>08352 <span class="comment">             because xstrprintf dynamically allocates new space for it</span>
<a name="l08353"></a>08353 <span class="comment">             on every call.  */</span>
<a name="l08354"></a>08354           <a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a> (x);
<a name="l08355"></a>08355         }
<a name="l08356"></a>08356       <span class="comment">/* Remove the last comma.  */</span>
<a name="l08357"></a>08357       text[strlen (text) - 2] = <span class="charliteral">&#39;\0&#39;</span>;
<a name="l08358"></a>08358       <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a> (uiout, <span class="stringliteral">&quot;what&quot;</span>, text);
<a name="l08359"></a>08359     }
<a name="l08360"></a>08360   <span class="keywordflow">else</span>
<a name="l08361"></a>08361     <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a> (uiout, <span class="stringliteral">&quot;what&quot;</span>, <span class="stringliteral">&quot;&lt;any syscall&gt;&quot;</span>);
<a name="l08362"></a>08362   <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;\&quot; &quot;</span>);
<a name="l08363"></a>08363 
<a name="l08364"></a>08364   <span class="keywordflow">if</span> (<a class="code" href="ui-out_8c.html#a473db54efcfbc60feeb5a4f54f27af46">ui_out_is_mi_like_p</a> (uiout))
<a name="l08365"></a>08365     <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a> (uiout, <span class="stringliteral">&quot;catch-type&quot;</span>, <span class="stringliteral">&quot;syscall&quot;</span>);
<a name="l08366"></a>08366 }
<a name="l08367"></a>08367 
<a name="l08368"></a>08368 <span class="comment">/* Implement the &quot;print_mention&quot; breakpoint_ops method for syscall</span>
<a name="l08369"></a>08369 <span class="comment">   catchpoints.  */</span>
<a name="l08370"></a>08370 
<a name="l08371"></a>08371 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l08372"></a>08372 print_mention_catch_syscall (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b)
<a name="l08373"></a>08373 {
<a name="l08374"></a>08374   <span class="keyword">struct </span>syscall_catchpoint *c = (<span class="keyword">struct </span>syscall_catchpoint *) b;
<a name="l08375"></a>08375 
<a name="l08376"></a>08376   <span class="keywordflow">if</span> (c-&gt;syscalls_to_be_caught)
<a name="l08377"></a>08377     {
<a name="l08378"></a>08378       <span class="keywordtype">int</span> i, iter;
<a name="l08379"></a>08379 
<a name="l08380"></a>08380       <span class="keywordflow">if</span> (<a class="code" href="vec_8h.html#a844523bba6d0565ef73a0f4a63e48d19">VEC_length</a> (<span class="keywordtype">int</span>, c-&gt;syscalls_to_be_caught) &gt; 1)
<a name="l08381"></a>08381         <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Catchpoint %d (syscalls&quot;</span>), b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>);
<a name="l08382"></a>08382       <span class="keywordflow">else</span>
<a name="l08383"></a>08383         <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Catchpoint %d (syscall&quot;</span>), b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>);
<a name="l08384"></a>08384 
<a name="l08385"></a>08385       <span class="keywordflow">for</span> (i = 0;
<a name="l08386"></a>08386            <a class="code" href="vec_8h.html#ae7795b0c8e65f45eb49aac5ec2c0fa52">VEC_iterate</a> (<span class="keywordtype">int</span>, c-&gt;syscalls_to_be_caught, i, iter);
<a name="l08387"></a>08387            i++)
<a name="l08388"></a>08388         {
<a name="l08389"></a>08389           <span class="keyword">struct </span><a class="code" href="structsyscall.html">syscall</a> s;
<a name="l08390"></a>08390           <a class="code" href="xml-syscall_8c.html#ac3d1940c50500cae8cc9bf7634416d83">get_syscall_by_number</a> (iter, &amp;s);
<a name="l08391"></a>08391 
<a name="l08392"></a>08392           <span class="keywordflow">if</span> (s.name)
<a name="l08393"></a>08393             <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot; &#39;%s&#39; [%d]&quot;</span>, s.name, s.number);
<a name="l08394"></a>08394           <span class="keywordflow">else</span>
<a name="l08395"></a>08395             <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot; %d&quot;</span>, s.number);
<a name="l08396"></a>08396         }
<a name="l08397"></a>08397       <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;)&quot;</span>);
<a name="l08398"></a>08398     }
<a name="l08399"></a>08399   <span class="keywordflow">else</span>
<a name="l08400"></a>08400     <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Catchpoint %d (any syscall)&quot;</span>),
<a name="l08401"></a>08401                      b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>);
<a name="l08402"></a>08402 }
<a name="l08403"></a>08403 
<a name="l08404"></a>08404 <span class="comment">/* Implement the &quot;print_recreate&quot; breakpoint_ops method for syscall</span>
<a name="l08405"></a>08405 <span class="comment">   catchpoints.  */</span>
<a name="l08406"></a>08406 
<a name="l08407"></a>08407 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l08408"></a>08408 print_recreate_catch_syscall (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b, <span class="keyword">struct</span> ui_file *fp)
<a name="l08409"></a>08409 {
<a name="l08410"></a>08410   <span class="keyword">struct </span>syscall_catchpoint *c = (<span class="keyword">struct </span>syscall_catchpoint *) b;
<a name="l08411"></a>08411 
<a name="l08412"></a>08412   <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (fp, <span class="stringliteral">&quot;catch syscall&quot;</span>);
<a name="l08413"></a>08413 
<a name="l08414"></a>08414   <span class="keywordflow">if</span> (c-&gt;syscalls_to_be_caught)
<a name="l08415"></a>08415     {
<a name="l08416"></a>08416       <span class="keywordtype">int</span> i, iter;
<a name="l08417"></a>08417 
<a name="l08418"></a>08418       <span class="keywordflow">for</span> (i = 0;
<a name="l08419"></a>08419            <a class="code" href="vec_8h.html#ae7795b0c8e65f45eb49aac5ec2c0fa52">VEC_iterate</a> (<span class="keywordtype">int</span>, c-&gt;syscalls_to_be_caught, i, iter);
<a name="l08420"></a>08420            i++)
<a name="l08421"></a>08421         {
<a name="l08422"></a>08422           <span class="keyword">struct </span><a class="code" href="structsyscall.html">syscall</a> s;
<a name="l08423"></a>08423 
<a name="l08424"></a>08424           <a class="code" href="xml-syscall_8c.html#ac3d1940c50500cae8cc9bf7634416d83">get_syscall_by_number</a> (iter, &amp;s);
<a name="l08425"></a>08425           <span class="keywordflow">if</span> (s.name)
<a name="l08426"></a>08426             <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (fp, <span class="stringliteral">&quot; %s&quot;</span>, s.name);
<a name="l08427"></a>08427           <span class="keywordflow">else</span>
<a name="l08428"></a>08428             <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (fp, <span class="stringliteral">&quot; %d&quot;</span>, s.number);
<a name="l08429"></a>08429         }
<a name="l08430"></a>08430     }
<a name="l08431"></a>08431   <a class="code" href="breakpoint_8c.html#aae7cd38b01782db6011bcd0150059625">print_recreate_thread</a> (b, fp);
<a name="l08432"></a>08432 }
<a name="l08433"></a>08433 
<a name="l08434"></a>08434 <span class="comment">/* The breakpoint_ops structure to be used in syscall catchpoints.  */</span>
<a name="l08435"></a>08435 
<a name="l08436"></a>08436 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structbreakpoint__ops.html">breakpoint_ops</a> catch_syscall_breakpoint_ops;
<a name="l08437"></a>08437 
<a name="l08438"></a>08438 <span class="comment">/* Returns non-zero if &#39;b&#39; is a syscall catchpoint.  */</span>
<a name="l08439"></a>08439 
<a name="l08440"></a>08440 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l08441"></a>08441 syscall_catchpoint_p (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b)
<a name="l08442"></a>08442 {
<a name="l08443"></a>08443   <span class="keywordflow">return</span> (b-&gt;<a class="code" href="structbreakpoint.html#aba258aa23496f6434aaa1cf8c8dc7ea7">ops</a> == &amp;catch_syscall_breakpoint_ops);
<a name="l08444"></a>08444 }
<a name="l08445"></a>08445 
<a name="l08446"></a>08446 <span class="comment">/* Initialize a new breakpoint of the bp_catchpoint kind.  If TEMPFLAG</span>
<a name="l08447"></a>08447 <span class="comment">   is non-zero, then make the breakpoint temporary.  If COND_STRING is</span>
<a name="l08448"></a>08448 <span class="comment">   not NULL, then store it in the breakpoint.  OPS, if not NULL, is</span>
<a name="l08449"></a>08449 <span class="comment">   the breakpoint_ops structure associated to the catchpoint.  */</span>
<a name="l08450"></a>08450 
<a name="l08451"></a>08451 <span class="keywordtype">void</span>
<a name="l08452"></a><a class="code" href="breakpoint_8h.html#abf44b8421146622741d99fe9ba43b544">08452</a> <a class="code" href="breakpoint_8c.html#abf44b8421146622741d99fe9ba43b544">init_catchpoint</a> (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b,
<a name="l08453"></a>08453                  <span class="keyword">struct</span> gdbarch *gdbarch, <span class="keywordtype">int</span> tempflag,
<a name="l08454"></a>08454                  <span class="keywordtype">char</span> *cond_string,
<a name="l08455"></a>08455                  <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structbreakpoint__ops.html">breakpoint_ops</a> *ops)
<a name="l08456"></a>08456 {
<a name="l08457"></a>08457   <span class="keyword">struct </span><a class="code" href="structsymtab__and__line.html">symtab_and_line</a> sal;
<a name="l08458"></a>08458 
<a name="l08459"></a>08459   <a class="code" href="symtab_8c.html#aca3a01a4f0e1a09f99e8308faecc9028">init_sal</a> (&amp;sal);
<a name="l08460"></a>08460   sal.<a class="code" href="structsymtab__and__line.html#acc91f0276f4648cb5a970f17ddcbaf09">pspace</a> = <a class="code" href="progspace_8c.html#a07722ff15a98814c086dda44f93380c9">current_program_space</a>;
<a name="l08461"></a>08461 
<a name="l08462"></a>08462   init_raw_breakpoint (b, gdbarch, sal, <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa8ebb961cef940b8ddef84696b7ac9694">bp_catchpoint</a>, ops);
<a name="l08463"></a>08463 
<a name="l08464"></a>08464   b-&gt;<a class="code" href="structbreakpoint.html#a817904eee4ded1a9e18ab46709c1245b">cond_string</a> = (cond_string == NULL) ? NULL : xstrdup (cond_string);
<a name="l08465"></a>08465   b-&gt;<a class="code" href="structbreakpoint.html#a75f0f9a837eac292ab6e768e8d8f1bd7">disposition</a> = tempflag ? <a class="code" href="breakpoint_8h.html#a15f2bbd9012f59bc09d59feef0c15732a16da7fb4204cb3f58c753fafa80bfab7">disp_del</a> : <a class="code" href="breakpoint_8h.html#a15f2bbd9012f59bc09d59feef0c15732a01c974d9083d524653d3a437364958be">disp_donttouch</a>;
<a name="l08466"></a>08466 }
<a name="l08467"></a>08467 
<a name="l08468"></a>08468 <span class="keywordtype">void</span>
<a name="l08469"></a><a class="code" href="breakpoint_8h.html#a74ff6d8191c3b444efd5631143d21635">08469</a> <a class="code" href="breakpoint_8c.html#a74ff6d8191c3b444efd5631143d21635">install_breakpoint</a> (<span class="keywordtype">int</span> <span class="keyword">internal</span>, <span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b, <span class="keywordtype">int</span> update_gll)
<a name="l08470"></a>08470 {
<a name="l08471"></a>08471   add_to_breakpoint_chain (b);
<a name="l08472"></a>08472   set_breakpoint_number (<span class="keyword">internal</span>, b);
<a name="l08473"></a>08473   <span class="keywordflow">if</span> (<a class="code" href="breakpoint_8c.html#ac537492fb781218601862c78225bd118">is_tracepoint</a> (b))
<a name="l08474"></a>08474     set_tracepoint_count (breakpoint_count);
<a name="l08475"></a>08475   <span class="keywordflow">if</span> (!<span class="keyword">internal</span>)
<a name="l08476"></a>08476     mention (b);
<a name="l08477"></a>08477   <a class="code" href="observer_8h.html#a85896e801e62bc45ccf32da4117d5d9c">observer_notify_breakpoint_created</a> (b);
<a name="l08478"></a>08478 
<a name="l08479"></a>08479   <span class="keywordflow">if</span> (update_gll)
<a name="l08480"></a>08480     update_global_location_list (1);
<a name="l08481"></a>08481 }
<a name="l08482"></a>08482 
<a name="l08483"></a>08483 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l08484"></a>08484 create_fork_vfork_event_catchpoint (<span class="keyword">struct</span> gdbarch *gdbarch,
<a name="l08485"></a>08485                                     <span class="keywordtype">int</span> tempflag, <span class="keywordtype">char</span> *cond_string,
<a name="l08486"></a>08486                                     <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structbreakpoint__ops.html">breakpoint_ops</a> *ops)
<a name="l08487"></a>08487 {
<a name="l08488"></a>08488   <span class="keyword">struct </span>fork_catchpoint *c = XNEW (<span class="keyword">struct</span> fork_catchpoint);
<a name="l08489"></a>08489 
<a name="l08490"></a>08490   <a class="code" href="breakpoint_8c.html#abf44b8421146622741d99fe9ba43b544">init_catchpoint</a> (&amp;c-&gt;base, gdbarch, tempflag, cond_string, ops);
<a name="l08491"></a>08491 
<a name="l08492"></a>08492   c-&gt;forked_inferior_pid = <a class="code" href="ptid_8c.html#acba69c857786546b204883bbcc90a64e">null_ptid</a>;
<a name="l08493"></a>08493 
<a name="l08494"></a>08494   <a class="code" href="breakpoint_8c.html#a74ff6d8191c3b444efd5631143d21635">install_breakpoint</a> (0, &amp;c-&gt;base, 1);
<a name="l08495"></a>08495 }
<a name="l08496"></a>08496 
<a name="l08497"></a>08497 <span class="comment">/* Exec catchpoints.  */</span>
<a name="l08498"></a>08498 
<a name="l08499"></a>08499 <span class="comment">/* An instance of this type is used to represent an exec catchpoint.</span>
<a name="l08500"></a>08500 <span class="comment">   It includes a &quot;struct breakpoint&quot; as a kind of base class; users</span>
<a name="l08501"></a>08501 <span class="comment">   downcast to &quot;struct breakpoint *&quot; when needed.  A breakpoint is</span>
<a name="l08502"></a>08502 <span class="comment">   really of this type iff its ops pointer points to</span>
<a name="l08503"></a>08503 <span class="comment">   CATCH_EXEC_BREAKPOINT_OPS.  */</span>
<a name="l08504"></a>08504 
<a name="l08505"></a>08505 <span class="keyword">struct </span>exec_catchpoint
<a name="l08506"></a>08506 {
<a name="l08507"></a>08507   <span class="comment">/* The base class.  */</span>
<a name="l08508"></a>08508   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> base;
<a name="l08509"></a>08509 
<a name="l08510"></a>08510   <span class="comment">/* Filename of a program whose exec triggered this catchpoint.</span>
<a name="l08511"></a>08511 <span class="comment">     This field is only valid immediately after this catchpoint has</span>
<a name="l08512"></a>08512 <span class="comment">     triggered.  */</span>
<a name="l08513"></a>08513   <span class="keywordtype">char</span> *exec_pathname;
<a name="l08514"></a>08514 };
<a name="l08515"></a>08515 
<a name="l08516"></a>08516 <span class="comment">/* Implement the &quot;dtor&quot; breakpoint_ops method for exec</span>
<a name="l08517"></a>08517 <span class="comment">   catchpoints.  */</span>
<a name="l08518"></a>08518 
<a name="l08519"></a>08519 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l08520"></a>08520 dtor_catch_exec (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b)
<a name="l08521"></a>08521 {
<a name="l08522"></a>08522   <span class="keyword">struct </span>exec_catchpoint *c = (<span class="keyword">struct </span>exec_catchpoint *) b;
<a name="l08523"></a>08523 
<a name="l08524"></a>08524   <a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a> (c-&gt;exec_pathname);
<a name="l08525"></a>08525 
<a name="l08526"></a>08526   <a class="code" href="breakpoint_8c.html#aefe1d12780f2d7ae5fb89ac113e204e0">base_breakpoint_ops</a>.<a class="code" href="structbreakpoint__ops.html#a110b2df7b285e5f83bf40b9a0e5435c1">dtor</a> (b);
<a name="l08527"></a>08527 }
<a name="l08528"></a>08528 
<a name="l08529"></a>08529 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l08530"></a>08530 insert_catch_exec (<span class="keyword">struct</span> bp_location *bl)
<a name="l08531"></a>08531 {
<a name="l08532"></a>08532   <span class="keywordflow">return</span> <a class="code" href="target_8h.html#a39ad77523ddc4bcbebd04595a594e7b8">target_insert_exec_catchpoint</a> (<a class="code" href="ptid_8c.html#a264ba40fc2a0cf3d4fb24a55fe32aede">ptid_get_pid</a> (<a class="code" href="infcmd_8c.html#a428c5be9ce5e70bd03760e828e19c6b7">inferior_ptid</a>));
<a name="l08533"></a>08533 }
<a name="l08534"></a>08534 
<a name="l08535"></a>08535 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l08536"></a>08536 remove_catch_exec (<span class="keyword">struct</span> bp_location *bl)
<a name="l08537"></a>08537 {
<a name="l08538"></a>08538   <span class="keywordflow">return</span> <a class="code" href="target_8h.html#ab49f8066cb9e08271f3af036cdf06ea5">target_remove_exec_catchpoint</a> (<a class="code" href="ptid_8c.html#a264ba40fc2a0cf3d4fb24a55fe32aede">ptid_get_pid</a> (<a class="code" href="infcmd_8c.html#a428c5be9ce5e70bd03760e828e19c6b7">inferior_ptid</a>));
<a name="l08539"></a>08539 }
<a name="l08540"></a>08540 
<a name="l08541"></a>08541 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l08542"></a>08542 breakpoint_hit_catch_exec (<span class="keyword">const</span> <span class="keyword">struct</span> bp_location *bl,
<a name="l08543"></a>08543                            <span class="keyword">struct</span> address_space *aspace, <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> bp_addr,
<a name="l08544"></a>08544                            <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structtarget__waitstatus.html">target_waitstatus</a> *ws)
<a name="l08545"></a>08545 {
<a name="l08546"></a>08546   <span class="keyword">struct </span>exec_catchpoint *c = (<span class="keyword">struct </span>exec_catchpoint *) bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>;
<a name="l08547"></a>08547 
<a name="l08548"></a>08548   if (ws-&gt;<a class="code" href="structtarget__waitstatus.html#a17ed1783e9146f443fa51ace8da76198">kind</a> != <a class="code" href="waitstatus_8h.html#aa3229b489ec985f04f7e9f652138b7c3af733ff83444ff8f174ea7cd1240fe85c">TARGET_WAITKIND_EXECD</a>)
<a name="l08549"></a>08549     <span class="keywordflow">return</span> 0;
<a name="l08550"></a>08550 
<a name="l08551"></a>08551   c-&gt;exec_pathname = xstrdup (ws-&gt;<a class="code" href="structtarget__waitstatus.html#af33b8f5721dc36f6b5b829286d38f825">value</a>.<a class="code" href="structtarget__waitstatus.html#ad42df4fd5216a739fe27dab2aa370c45">execd_pathname</a>);
<a name="l08552"></a>08552   <span class="keywordflow">return</span> 1;
<a name="l08553"></a>08553 }
<a name="l08554"></a>08554 
<a name="l08555"></a>08555 <span class="keyword">static</span> <span class="keyword">enum</span> <a class="code" href="breakpoint_8h.html#ab6ab1d6a867561653e32a901b41be66b">print_stop_action</a>
<a name="l08556"></a>08556 print_it_catch_exec (<a class="code" href="structbpstats.html">bpstat</a> bs)
<a name="l08557"></a>08557 {
<a name="l08558"></a>08558   <span class="keyword">struct </span>ui_out *uiout = <a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>;
<a name="l08559"></a>08559   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b = bs-&gt;<a class="code" href="structbpstats.html#ac105ed7263dd10f9d65e92e706b04e39">breakpoint_at</a>;
<a name="l08560"></a>08560   <span class="keyword">struct </span>exec_catchpoint *c = (<span class="keyword">struct </span>exec_catchpoint *) b;
<a name="l08561"></a>08561 
<a name="l08562"></a>08562   <a class="code" href="annotate_8c.html#acb9815704180dd28dd5d5c6af7612a71">annotate_catchpoint</a> (b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>);
<a name="l08563"></a>08563   <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#a75f0f9a837eac292ab6e768e8d8f1bd7">disposition</a> == <a class="code" href="breakpoint_8h.html#a15f2bbd9012f59bc09d59feef0c15732a16da7fb4204cb3f58c753fafa80bfab7">disp_del</a>)
<a name="l08564"></a>08564     <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;\nTemporary catchpoint &quot;</span>);
<a name="l08565"></a>08565   <span class="keywordflow">else</span>
<a name="l08566"></a>08566     <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;\nCatchpoint &quot;</span>);
<a name="l08567"></a>08567   <span class="keywordflow">if</span> (<a class="code" href="ui-out_8c.html#a473db54efcfbc60feeb5a4f54f27af46">ui_out_is_mi_like_p</a> (uiout))
<a name="l08568"></a>08568     {
<a name="l08569"></a>08569       <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a> (uiout, <span class="stringliteral">&quot;reason&quot;</span>,
<a name="l08570"></a>08570                            <a class="code" href="mi-common_8c.html#a619e7d180d78af6e6d63a611c6680e90">async_reason_lookup</a> (<a class="code" href="mi-common_8h.html#a06d7bf56f98dcc556d686f49ea570daea479f0695e5ced848d23c58a686e6e774">EXEC_ASYNC_EXEC</a>));
<a name="l08571"></a>08571       <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a> (uiout, <span class="stringliteral">&quot;disp&quot;</span>, <a class="code" href="breakpoint_8c.html#a6f45019563f41b3ae4dc92df09f12618">bpdisp_text</a> (b-&gt;<a class="code" href="structbreakpoint.html#a75f0f9a837eac292ab6e768e8d8f1bd7">disposition</a>));
<a name="l08572"></a>08572     }
<a name="l08573"></a>08573   <a class="code" href="ui-out_8c.html#aa6f66551d03db456fb94ca1c9038f5a0">ui_out_field_int</a> (uiout, <span class="stringliteral">&quot;bkptno&quot;</span>, b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>);
<a name="l08574"></a>08574   <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot; (exec&#39;d &quot;</span>);
<a name="l08575"></a>08575   <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a> (uiout, <span class="stringliteral">&quot;new-exec&quot;</span>, c-&gt;exec_pathname);
<a name="l08576"></a>08576   <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;), &quot;</span>);
<a name="l08577"></a>08577 
<a name="l08578"></a>08578   <span class="keywordflow">return</span> <a class="code" href="breakpoint_8h.html#ab6ab1d6a867561653e32a901b41be66ba322bad7b3370a43f44f33ae73a196231">PRINT_SRC_AND_LOC</a>;
<a name="l08579"></a>08579 }
<a name="l08580"></a>08580 
<a name="l08581"></a>08581 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l08582"></a>08582 print_one_catch_exec (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b, <span class="keyword">struct</span> bp_location **last_loc)
<a name="l08583"></a>08583 {
<a name="l08584"></a>08584   <span class="keyword">struct </span>exec_catchpoint *c = (<span class="keyword">struct </span>exec_catchpoint *) b;
<a name="l08585"></a>08585   <span class="keyword">struct </span><a class="code" href="structvalue__print__options.html">value_print_options</a> opts;
<a name="l08586"></a>08586   <span class="keyword">struct </span>ui_out *uiout = <a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>;
<a name="l08587"></a>08587 
<a name="l08588"></a>08588   <a class="code" href="valprint_8c.html#aa2d4dfe4b11841ccafc4d0c0d410095d">get_user_print_options</a> (&amp;opts);
<a name="l08589"></a>08589 
<a name="l08590"></a>08590   <span class="comment">/* Field 4, the address, is omitted (which makes the columns</span>
<a name="l08591"></a>08591 <span class="comment">     not line up too nicely with the headers, but the effect</span>
<a name="l08592"></a>08592 <span class="comment">     is relatively readable).  */</span>
<a name="l08593"></a>08593   <span class="keywordflow">if</span> (opts.addressprint)
<a name="l08594"></a>08594     <a class="code" href="ui-out_8c.html#a5366a822858ecedafef54625bec57442">ui_out_field_skip</a> (uiout, <span class="stringliteral">&quot;addr&quot;</span>);
<a name="l08595"></a>08595   <a class="code" href="annotate_8c.html#a3b961efbc346558aade25e12945835fe">annotate_field</a> (5);
<a name="l08596"></a>08596   <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;exec&quot;</span>);
<a name="l08597"></a>08597   <span class="keywordflow">if</span> (c-&gt;exec_pathname != NULL)
<a name="l08598"></a>08598     {
<a name="l08599"></a>08599       <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;, program \&quot;&quot;</span>);
<a name="l08600"></a>08600       <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a> (uiout, <span class="stringliteral">&quot;what&quot;</span>, c-&gt;exec_pathname);
<a name="l08601"></a>08601       <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;\&quot; &quot;</span>);
<a name="l08602"></a>08602     }
<a name="l08603"></a>08603 
<a name="l08604"></a>08604   <span class="keywordflow">if</span> (<a class="code" href="ui-out_8c.html#a473db54efcfbc60feeb5a4f54f27af46">ui_out_is_mi_like_p</a> (uiout))
<a name="l08605"></a>08605     <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a> (uiout, <span class="stringliteral">&quot;catch-type&quot;</span>, <span class="stringliteral">&quot;exec&quot;</span>);
<a name="l08606"></a>08606 }
<a name="l08607"></a>08607 
<a name="l08608"></a>08608 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l08609"></a>08609 print_mention_catch_exec (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b)
<a name="l08610"></a>08610 {
<a name="l08611"></a>08611   <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Catchpoint %d (exec)&quot;</span>), b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>);
<a name="l08612"></a>08612 }
<a name="l08613"></a>08613 
<a name="l08614"></a>08614 <span class="comment">/* Implement the &quot;print_recreate&quot; breakpoint_ops method for exec</span>
<a name="l08615"></a>08615 <span class="comment">   catchpoints.  */</span>
<a name="l08616"></a>08616 
<a name="l08617"></a>08617 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l08618"></a>08618 print_recreate_catch_exec (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b, <span class="keyword">struct</span> ui_file *fp)
<a name="l08619"></a>08619 {
<a name="l08620"></a>08620   <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (fp, <span class="stringliteral">&quot;catch exec&quot;</span>);
<a name="l08621"></a>08621   <a class="code" href="breakpoint_8c.html#aae7cd38b01782db6011bcd0150059625">print_recreate_thread</a> (b, fp);
<a name="l08622"></a>08622 }
<a name="l08623"></a>08623 
<a name="l08624"></a>08624 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structbreakpoint__ops.html">breakpoint_ops</a> catch_exec_breakpoint_ops;
<a name="l08625"></a>08625 
<a name="l08626"></a>08626 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l08627"></a>08627 create_syscall_event_catchpoint (<span class="keywordtype">int</span> tempflag, <a class="code" href="vec_8h.html#ab084f6f29fcf16a6b15d15feb653d414">VEC</a>(<span class="keywordtype">int</span>) *filter,
<a name="l08628"></a>08628                                  <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structbreakpoint__ops.html">breakpoint_ops</a> *ops)
<a name="l08629"></a>08629 {
<a name="l08630"></a>08630   <span class="keyword">struct </span>syscall_catchpoint *c;
<a name="l08631"></a>08631   <span class="keyword">struct </span>gdbarch *gdbarch = <a class="code" href="arch-utils_8c.html#a0fe1e68475f442e5d6dda589e0c62454">get_current_arch</a> ();
<a name="l08632"></a>08632 
<a name="l08633"></a>08633   c = XNEW (<span class="keyword">struct</span> syscall_catchpoint);
<a name="l08634"></a>08634   <a class="code" href="breakpoint_8c.html#abf44b8421146622741d99fe9ba43b544">init_catchpoint</a> (&amp;c-&gt;base, gdbarch, tempflag, NULL, ops);
<a name="l08635"></a>08635   c-&gt;syscalls_to_be_caught = filter;
<a name="l08636"></a>08636 
<a name="l08637"></a>08637   <a class="code" href="breakpoint_8c.html#a74ff6d8191c3b444efd5631143d21635">install_breakpoint</a> (0, &amp;c-&gt;base, 1);
<a name="l08638"></a>08638 }
<a name="l08639"></a>08639 
<a name="l08640"></a>08640 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l08641"></a>08641 hw_breakpoint_used_count (<span class="keywordtype">void</span>)
<a name="l08642"></a>08642 {
<a name="l08643"></a>08643   <span class="keywordtype">int</span> i = 0;
<a name="l08644"></a>08644   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b;
<a name="l08645"></a>08645   <span class="keyword">struct </span>bp_location *bl;
<a name="l08646"></a>08646 
<a name="l08647"></a>08647   <a class="code" href="breakpoint_8c.html#a781d5d3dc50a92364edfbacac3d0c107">ALL_BREAKPOINTS</a> (b)
<a name="l08648"></a>08648   {
<a name="l08649"></a>08649     <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa657fad68a9d83a24532fb06715b77628">bp_hardware_breakpoint</a> &amp;&amp; breakpoint_enabled (b))
<a name="l08650"></a>08650       <span class="keywordflow">for</span> (bl = b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>; bl; bl = bl-&gt;<a class="code" href="structbp__location.html#ab193cb38f87fea89105db96d94191541">next</a>)
<a name="l08651"></a>08651         {
<a name="l08652"></a>08652           <span class="comment">/* Special types of hardware breakpoints may use more than</span>
<a name="l08653"></a>08653 <span class="comment">             one register.  */</span>
<a name="l08654"></a>08654           i += b-&gt;<a class="code" href="structbreakpoint.html#aba258aa23496f6434aaa1cf8c8dc7ea7">ops</a>-&gt;<a class="code" href="structbreakpoint__ops.html#a372a323c3f122204085f7faf52bd2adb">resources_needed</a> (bl);
<a name="l08655"></a>08655         }
<a name="l08656"></a>08656   }
<a name="l08657"></a>08657 
<a name="l08658"></a>08658   <span class="keywordflow">return</span> i;
<a name="l08659"></a>08659 }
<a name="l08660"></a>08660 
<a name="l08661"></a>08661 <span class="comment">/* Returns the resources B would use if it were a hardware</span>
<a name="l08662"></a>08662 <span class="comment">   watchpoint.  */</span>
<a name="l08663"></a>08663 
<a name="l08664"></a>08664 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l08665"></a>08665 hw_watchpoint_use_count (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b)
<a name="l08666"></a>08666 {
<a name="l08667"></a>08667   <span class="keywordtype">int</span> i = 0;
<a name="l08668"></a>08668   <span class="keyword">struct </span>bp_location *bl;
<a name="l08669"></a>08669 
<a name="l08670"></a>08670   <span class="keywordflow">if</span> (!breakpoint_enabled (b))
<a name="l08671"></a>08671     <span class="keywordflow">return</span> 0;
<a name="l08672"></a>08672 
<a name="l08673"></a>08673   <span class="keywordflow">for</span> (bl = b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>; bl; bl = bl-&gt;<a class="code" href="structbp__location.html#ab193cb38f87fea89105db96d94191541">next</a>)
<a name="l08674"></a>08674     {
<a name="l08675"></a>08675       <span class="comment">/* Special types of hardware watchpoints may use more than</span>
<a name="l08676"></a>08676 <span class="comment">         one register.  */</span>
<a name="l08677"></a>08677       i += b-&gt;<a class="code" href="structbreakpoint.html#aba258aa23496f6434aaa1cf8c8dc7ea7">ops</a>-&gt;<a class="code" href="structbreakpoint__ops.html#a372a323c3f122204085f7faf52bd2adb">resources_needed</a> (bl);
<a name="l08678"></a>08678     }
<a name="l08679"></a>08679 
<a name="l08680"></a>08680   <span class="keywordflow">return</span> i;
<a name="l08681"></a>08681 }
<a name="l08682"></a>08682 
<a name="l08683"></a>08683 <span class="comment">/* Returns the sum the used resources of all hardware watchpoints of</span>
<a name="l08684"></a>08684 <span class="comment">   type TYPE in the breakpoints list.  Also returns in OTHER_TYPE_USED</span>
<a name="l08685"></a>08685 <span class="comment">   the sum of the used resources of all hardware watchpoints of other</span>
<a name="l08686"></a>08686 <span class="comment">   types _not_ TYPE.  */</span>
<a name="l08687"></a>08687 
<a name="l08688"></a>08688 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l08689"></a>08689 hw_watchpoint_used_count_others (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *except,
<a name="l08690"></a>08690                                  <span class="keyword">enum</span> bptype type, <span class="keywordtype">int</span> *other_type_used)
<a name="l08691"></a>08691 {
<a name="l08692"></a>08692   <span class="keywordtype">int</span> i = 0;
<a name="l08693"></a>08693   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b;
<a name="l08694"></a>08694 
<a name="l08695"></a>08695   *other_type_used = 0;
<a name="l08696"></a>08696   <a class="code" href="breakpoint_8c.html#a781d5d3dc50a92364edfbacac3d0c107">ALL_BREAKPOINTS</a> (b)
<a name="l08697"></a>08697     {
<a name="l08698"></a>08698       <span class="keywordflow">if</span> (b == except)
<a name="l08699"></a>08699         <span class="keywordflow">continue</span>;
<a name="l08700"></a>08700       <span class="keywordflow">if</span> (!breakpoint_enabled (b))
<a name="l08701"></a>08701         <span class="keywordflow">continue</span>;
<a name="l08702"></a>08702 
<a name="l08703"></a>08703       <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == type)
<a name="l08704"></a>08704         i += hw_watchpoint_use_count (b);
<a name="l08705"></a>08705       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (is_hardware_watchpoint (b))
<a name="l08706"></a>08706         *other_type_used = 1;
<a name="l08707"></a>08707     }
<a name="l08708"></a>08708 
<a name="l08709"></a>08709   <span class="keywordflow">return</span> i;
<a name="l08710"></a>08710 }
<a name="l08711"></a>08711 
<a name="l08712"></a>08712 <span class="keywordtype">void</span>
<a name="l08713"></a><a class="code" href="breakpoint_8h.html#ac5f472accf20740dc89c7cdad9be727b">08713</a> <a class="code" href="breakpoint_8c.html#ac5f472accf20740dc89c7cdad9be727b">disable_watchpoints_before_interactive_call_start</a> (<span class="keywordtype">void</span>)
<a name="l08714"></a>08714 {
<a name="l08715"></a>08715   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b;
<a name="l08716"></a>08716 
<a name="l08717"></a>08717   <a class="code" href="breakpoint_8c.html#a781d5d3dc50a92364edfbacac3d0c107">ALL_BREAKPOINTS</a> (b)
<a name="l08718"></a>08718   {
<a name="l08719"></a>08719     <span class="keywordflow">if</span> (<a class="code" href="breakpoint_8c.html#a49f0d5ff628dd506db5b81f660eb4610">is_watchpoint</a> (b) &amp;&amp; breakpoint_enabled (b))
<a name="l08720"></a>08720       {
<a name="l08721"></a>08721         b-&gt;<a class="code" href="structbreakpoint.html#acb53352fd35aaad37054508fabc0f3bf">enable_state</a> = <a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577ab336fa5d61d3c4424c6aac80c107d1c6">bp_call_disabled</a>;
<a name="l08722"></a>08722         update_global_location_list (0);
<a name="l08723"></a>08723       }
<a name="l08724"></a>08724   }
<a name="l08725"></a>08725 }
<a name="l08726"></a>08726 
<a name="l08727"></a>08727 <span class="keywordtype">void</span>
<a name="l08728"></a><a class="code" href="breakpoint_8h.html#a9e3234db337b3e7f7f124c95063ba884">08728</a> <a class="code" href="breakpoint_8c.html#a9e3234db337b3e7f7f124c95063ba884">enable_watchpoints_after_interactive_call_stop</a> (<span class="keywordtype">void</span>)
<a name="l08729"></a>08729 {
<a name="l08730"></a>08730   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b;
<a name="l08731"></a>08731 
<a name="l08732"></a>08732   <a class="code" href="breakpoint_8c.html#a781d5d3dc50a92364edfbacac3d0c107">ALL_BREAKPOINTS</a> (b)
<a name="l08733"></a>08733   {
<a name="l08734"></a>08734     <span class="keywordflow">if</span> (<a class="code" href="breakpoint_8c.html#a49f0d5ff628dd506db5b81f660eb4610">is_watchpoint</a> (b) &amp;&amp; b-&gt;<a class="code" href="structbreakpoint.html#acb53352fd35aaad37054508fabc0f3bf">enable_state</a> == <a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577ab336fa5d61d3c4424c6aac80c107d1c6">bp_call_disabled</a>)
<a name="l08735"></a>08735       {
<a name="l08736"></a>08736         b-&gt;<a class="code" href="structbreakpoint.html#acb53352fd35aaad37054508fabc0f3bf">enable_state</a> = <a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577a72f1fa981d13a62d05324c1de974b44b">bp_enabled</a>;
<a name="l08737"></a>08737         update_global_location_list (1);
<a name="l08738"></a>08738       }
<a name="l08739"></a>08739   }
<a name="l08740"></a>08740 }
<a name="l08741"></a>08741 
<a name="l08742"></a>08742 <span class="keywordtype">void</span>
<a name="l08743"></a><a class="code" href="breakpoint_8h.html#a9cdbf98f4d3af10d31df95d5ddbe494d">08743</a> <a class="code" href="breakpoint_8c.html#a9cdbf98f4d3af10d31df95d5ddbe494d">disable_breakpoints_before_startup</a> (<span class="keywordtype">void</span>)
<a name="l08744"></a>08744 {
<a name="l08745"></a>08745   <a class="code" href="progspace_8c.html#a07722ff15a98814c086dda44f93380c9">current_program_space</a>-&gt;<a class="code" href="structprogram__space.html#a66c8a669a715e0f3c717bf0fd8951724">executing_startup</a> = 1;
<a name="l08746"></a>08746   update_global_location_list (0);
<a name="l08747"></a>08747 }
<a name="l08748"></a>08748 
<a name="l08749"></a>08749 <span class="keywordtype">void</span>
<a name="l08750"></a><a class="code" href="breakpoint_8h.html#a56e8c9fd394ef7b7c7bb3c800c9a13e6">08750</a> <a class="code" href="breakpoint_8c.html#a56e8c9fd394ef7b7c7bb3c800c9a13e6">enable_breakpoints_after_startup</a> (<span class="keywordtype">void</span>)
<a name="l08751"></a>08751 {
<a name="l08752"></a>08752   <a class="code" href="progspace_8c.html#a07722ff15a98814c086dda44f93380c9">current_program_space</a>-&gt;<a class="code" href="structprogram__space.html#a66c8a669a715e0f3c717bf0fd8951724">executing_startup</a> = 0;
<a name="l08753"></a>08753   <a class="code" href="breakpoint_8c.html#a04a0dfc2bda60f172d9e76df4fe6187f">breakpoint_re_set</a> ();
<a name="l08754"></a>08754 }
<a name="l08755"></a>08755 
<a name="l08756"></a>08756 
<a name="l08757"></a>08757 <span class="comment">/* Set a breakpoint that will evaporate an end of command</span>
<a name="l08758"></a>08758 <span class="comment">   at address specified by SAL.</span>
<a name="l08759"></a>08759 <span class="comment">   Restrict it to frame FRAME if FRAME is nonzero.  */</span>
<a name="l08760"></a>08760 
<a name="l08761"></a>08761 <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *
<a name="l08762"></a><a class="code" href="breakpoint_8c.html#acd9e4d103f6dc73ba3dc2ef1d0e01293">08762</a> <a class="code" href="breakpoint_8c.html#acd9e4d103f6dc73ba3dc2ef1d0e01293">set_momentary_breakpoint</a> (<span class="keyword">struct</span> gdbarch *gdbarch, <span class="keyword">struct</span> <a class="code" href="structsymtab__and__line.html">symtab_and_line</a> sal,
<a name="l08763"></a>08763                           <span class="keyword">struct</span> <a class="code" href="structframe__id.html">frame_id</a> <a class="code" href="structframe__id.html">frame_id</a>, <span class="keyword">enum</span> bptype type)
<a name="l08764"></a>08764 {
<a name="l08765"></a>08765   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b;
<a name="l08766"></a>08766 
<a name="l08767"></a>08767   <span class="comment">/* If FRAME_ID is valid, it should be a real frame, not an inlined or</span>
<a name="l08768"></a>08768 <span class="comment">     tail-called one.  */</span>
<a name="l08769"></a>08769   <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (!<a class="code" href="frame_8c.html#ad5725cc3a42f2acd67ba25921998bc86">frame_id_artificial_p</a> (frame_id));
<a name="l08770"></a>08770 
<a name="l08771"></a>08771   b = <a class="code" href="breakpoint_8c.html#a99e75dcf89d9291dc55db2453cb16a0a">set_raw_breakpoint</a> (gdbarch, sal, type, &amp;momentary_breakpoint_ops);
<a name="l08772"></a>08772   b-&gt;<a class="code" href="structbreakpoint.html#acb53352fd35aaad37054508fabc0f3bf">enable_state</a> = <a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577a72f1fa981d13a62d05324c1de974b44b">bp_enabled</a>;
<a name="l08773"></a>08773   b-&gt;<a class="code" href="structbreakpoint.html#a75f0f9a837eac292ab6e768e8d8f1bd7">disposition</a> = <a class="code" href="breakpoint_8h.html#a15f2bbd9012f59bc09d59feef0c15732a01c974d9083d524653d3a437364958be">disp_donttouch</a>;
<a name="l08774"></a>08774   b-&gt;<a class="code" href="structbreakpoint.html#af65175451fdfdff660221d724c7c3cae">frame_id</a> = <a class="code" href="structbreakpoint.html#af65175451fdfdff660221d724c7c3cae">frame_id</a>;
<a name="l08775"></a>08775 
<a name="l08776"></a>08776   <span class="comment">/* If we&#39;re debugging a multi-threaded program, then we want</span>
<a name="l08777"></a>08777 <span class="comment">     momentary breakpoints to be active in only a single thread of</span>
<a name="l08778"></a>08778 <span class="comment">     control.  */</span>
<a name="l08779"></a>08779   <span class="keywordflow">if</span> (<a class="code" href="gdbthread_8h.html#a75cff5779f03e4119723fd41a5583fa7">in_thread_list</a> (<a class="code" href="infcmd_8c.html#a428c5be9ce5e70bd03760e828e19c6b7">inferior_ptid</a>))
<a name="l08780"></a>08780     b-&gt;<a class="code" href="structbreakpoint.html#ae8613b6d8cf464f30ea39597be0cc192">thread</a> = <a class="code" href="gdbthread_8h.html#a3dbd3518561f91d8aa7621a65d39f305">pid_to_thread_id</a> (<a class="code" href="infcmd_8c.html#a428c5be9ce5e70bd03760e828e19c6b7">inferior_ptid</a>);
<a name="l08781"></a>08781 
<a name="l08782"></a>08782   update_global_location_list_nothrow (1);
<a name="l08783"></a>08783 
<a name="l08784"></a>08784   <span class="keywordflow">return</span> b;
<a name="l08785"></a>08785 }
<a name="l08786"></a>08786 
<a name="l08787"></a>08787 <span class="comment">/* Make a momentary breakpoint based on the master breakpoint ORIG.</span>
<a name="l08788"></a>08788 <span class="comment">   The new breakpoint will have type TYPE, and use OPS as it</span>
<a name="l08789"></a>08789 <span class="comment">   breakpoint_ops.  */</span>
<a name="l08790"></a>08790 
<a name="l08791"></a>08791 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *
<a name="l08792"></a>08792 momentary_breakpoint_from_master (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *orig,
<a name="l08793"></a>08793                                   <span class="keyword">enum</span> bptype type,
<a name="l08794"></a>08794                                   <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structbreakpoint__ops.html">breakpoint_ops</a> *ops)
<a name="l08795"></a>08795 {
<a name="l08796"></a>08796   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *copy;
<a name="l08797"></a>08797 
<a name="l08798"></a>08798   copy = set_raw_breakpoint_without_location (orig-&gt;<a class="code" href="structbreakpoint.html#aa044541ad4e4e66cf23affcd6d8b1759">gdbarch</a>, type, ops);
<a name="l08799"></a>08799   copy-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a> = allocate_bp_location (copy);
<a name="l08800"></a>08800   set_breakpoint_location_function (copy-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>, 1);
<a name="l08801"></a>08801 
<a name="l08802"></a>08802   copy-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>-&gt;<a class="code" href="structbp__location.html#a55f3ff99d536775f5095f11e5f5c3f3e">gdbarch</a> = orig-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>-&gt;<a class="code" href="structbp__location.html#a55f3ff99d536775f5095f11e5f5c3f3e">gdbarch</a>;
<a name="l08803"></a>08803   copy-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>-&gt;<a class="code" href="structbp__location.html#a4e316d8cab3c014aa85b8858d6223ce2">requested_address</a> = orig-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>-&gt;<a class="code" href="structbp__location.html#a4e316d8cab3c014aa85b8858d6223ce2">requested_address</a>;
<a name="l08804"></a>08804   copy-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a> = orig-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>;
<a name="l08805"></a>08805   copy-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>-&gt;<a class="code" href="structbp__location.html#ac6d8286e46db5c4be6dab9139c43a00d">section</a> = orig-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>-&gt;<a class="code" href="structbp__location.html#ac6d8286e46db5c4be6dab9139c43a00d">section</a>;
<a name="l08806"></a>08806   copy-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a> = orig-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a>;
<a name="l08807"></a>08807   copy-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>-&gt;<a class="code" href="structbp__location.html#a848151cbedd05ac5a77d211aea60a013">probe</a> = orig-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>-&gt;<a class="code" href="structbp__location.html#a848151cbedd05ac5a77d211aea60a013">probe</a>;
<a name="l08808"></a>08808   copy-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>-&gt;<a class="code" href="structbp__location.html#a47eb96040eebcaabb5ab1e2ea7726d17">line_number</a> = orig-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>-&gt;<a class="code" href="structbp__location.html#a47eb96040eebcaabb5ab1e2ea7726d17">line_number</a>;
<a name="l08809"></a>08809   copy-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>-&gt;<a class="code" href="structbp__location.html#a1fbe0229a1e449ad3f855dc443869239">symtab</a> = orig-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>-&gt;<a class="code" href="structbp__location.html#a1fbe0229a1e449ad3f855dc443869239">symtab</a>;
<a name="l08810"></a>08810   copy-&gt;<a class="code" href="structbreakpoint.html#af65175451fdfdff660221d724c7c3cae">frame_id</a> = orig-&gt;<a class="code" href="structbreakpoint.html#af65175451fdfdff660221d724c7c3cae">frame_id</a>;
<a name="l08811"></a>08811   copy-&gt;<a class="code" href="structbreakpoint.html#ae8613b6d8cf464f30ea39597be0cc192">thread</a> = orig-&gt;<a class="code" href="structbreakpoint.html#ae8613b6d8cf464f30ea39597be0cc192">thread</a>;
<a name="l08812"></a>08812   copy-&gt;<a class="code" href="structbreakpoint.html#a82f4fd8ee6ddee61f3529fbd747c78b2">pspace</a> = orig-&gt;<a class="code" href="structbreakpoint.html#a82f4fd8ee6ddee61f3529fbd747c78b2">pspace</a>;
<a name="l08813"></a>08813 
<a name="l08814"></a>08814   copy-&gt;<a class="code" href="structbreakpoint.html#acb53352fd35aaad37054508fabc0f3bf">enable_state</a> = <a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577a72f1fa981d13a62d05324c1de974b44b">bp_enabled</a>;
<a name="l08815"></a>08815   copy-&gt;<a class="code" href="structbreakpoint.html#a75f0f9a837eac292ab6e768e8d8f1bd7">disposition</a> = <a class="code" href="breakpoint_8h.html#a15f2bbd9012f59bc09d59feef0c15732a01c974d9083d524653d3a437364958be">disp_donttouch</a>;
<a name="l08816"></a>08816   copy-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a> = internal_breakpoint_number--;
<a name="l08817"></a>08817 
<a name="l08818"></a>08818   update_global_location_list_nothrow (0);
<a name="l08819"></a>08819   <span class="keywordflow">return</span> copy;
<a name="l08820"></a>08820 }
<a name="l08821"></a>08821 
<a name="l08822"></a>08822 <span class="comment">/* Make a deep copy of momentary breakpoint ORIG.  Returns NULL if</span>
<a name="l08823"></a>08823 <span class="comment">   ORIG is NULL.  */</span>
<a name="l08824"></a>08824 
<a name="l08825"></a>08825 <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *
<a name="l08826"></a><a class="code" href="breakpoint_8h.html#abe6097421ab72aea1fe2024c3cd21917">08826</a> <a class="code" href="breakpoint_8c.html#a15484ba829de84e6acccc4366f90c9e6">clone_momentary_breakpoint</a> (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *orig)
<a name="l08827"></a>08827 {
<a name="l08828"></a>08828   <span class="comment">/* If there&#39;s nothing to clone, then return nothing.  */</span>
<a name="l08829"></a>08829   <span class="keywordflow">if</span> (orig == NULL)
<a name="l08830"></a>08830     <span class="keywordflow">return</span> NULL;
<a name="l08831"></a>08831 
<a name="l08832"></a>08832   <span class="keywordflow">return</span> momentary_breakpoint_from_master (orig, orig-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a>, orig-&gt;<a class="code" href="structbreakpoint.html#aba258aa23496f6434aaa1cf8c8dc7ea7">ops</a>);
<a name="l08833"></a>08833 }
<a name="l08834"></a>08834 
<a name="l08835"></a>08835 <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *
<a name="l08836"></a><a class="code" href="breakpoint_8h.html#aec67e07a865ee5fbe0646639bc39d099">08836</a> <a class="code" href="breakpoint_8c.html#a6cf2da0d6ea13614460f372584fba3a3">set_momentary_breakpoint_at_pc</a> (<span class="keyword">struct</span> gdbarch *gdbarch, <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> pc,
<a name="l08837"></a>08837                                 <span class="keyword">enum</span> bptype type)
<a name="l08838"></a>08838 {
<a name="l08839"></a>08839   <span class="keyword">struct </span><a class="code" href="structsymtab__and__line.html">symtab_and_line</a> sal;
<a name="l08840"></a>08840 
<a name="l08841"></a>08841   sal = <a class="code" href="symtab_8c.html#ad9bbd85700e3d7fa50e7ba0e32f37846">find_pc_line</a> (pc, 0);
<a name="l08842"></a>08842   sal.pc = <a class="code" href="structsymtab__and__line.html#a77665fa461ad187cb755efa256ba44d7">pc</a>;
<a name="l08843"></a>08843   sal.section = <a class="code" href="symfile_8c.html#ae3387e3fa4dfcec140196f91111883c1">find_pc_overlay</a> (pc);
<a name="l08844"></a>08844   sal.explicit_pc = 1;
<a name="l08845"></a>08845 
<a name="l08846"></a>08846   <span class="keywordflow">return</span> <a class="code" href="breakpoint_8c.html#acd9e4d103f6dc73ba3dc2ef1d0e01293">set_momentary_breakpoint</a> (gdbarch, sal, <a class="code" href="frame_8c.html#a0e92fecdd3b01549ccdc07795de2afee">null_frame_id</a>, type);
<a name="l08847"></a>08847 }
<a name="l08848"></a>08848 
<a name="l08849"></a>08849 
<a name="l08850"></a>08850 <span class="comment">/* Tell the user we have just set a breakpoint B.  */</span>
<a name="l08851"></a>08851 
<a name="l08852"></a>08852 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l08853"></a>08853 mention (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b)
<a name="l08854"></a>08854 {
<a name="l08855"></a>08855   b-&gt;<a class="code" href="structbreakpoint.html#aba258aa23496f6434aaa1cf8c8dc7ea7">ops</a>-&gt;<a class="code" href="structbreakpoint__ops.html#a56e47601d6d5230479033e7b7b2d910e">print_mention</a> (b);
<a name="l08856"></a>08856   <span class="keywordflow">if</span> (<a class="code" href="ui-out_8c.html#a473db54efcfbc60feeb5a4f54f27af46">ui_out_is_mi_like_p</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>))
<a name="l08857"></a>08857     <span class="keywordflow">return</span>;
<a name="l08858"></a>08858   <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l08859"></a>08859 }
<a name="l08860"></a>08860 
<a name="l08861"></a>08861 
<a name="l08862"></a>08862 <span class="keyword">static</span> <span class="keyword">struct </span>bp_location *
<a name="l08863"></a>08863 add_location_to_breakpoint (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b,
<a name="l08864"></a>08864                             <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structsymtab__and__line.html">symtab_and_line</a> *sal)
<a name="l08865"></a>08865 {
<a name="l08866"></a>08866   <span class="keyword">struct </span>bp_location *loc, **tmp;
<a name="l08867"></a>08867   <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> adjusted_address;
<a name="l08868"></a>08868   <span class="keyword">struct </span>gdbarch *loc_gdbarch = <a class="code" href="breakpoint_8c.html#ab44e7bca7511390e3baade6daeecf6cd">get_sal_arch</a> (*sal);
<a name="l08869"></a>08869 
<a name="l08870"></a>08870   <span class="keywordflow">if</span> (loc_gdbarch == NULL)
<a name="l08871"></a>08871     loc_gdbarch = b-&gt;<a class="code" href="structbreakpoint.html#aa044541ad4e4e66cf23affcd6d8b1759">gdbarch</a>;
<a name="l08872"></a>08872 
<a name="l08873"></a>08873   <span class="comment">/* Adjust the breakpoint&#39;s address prior to allocating a location.</span>
<a name="l08874"></a>08874 <span class="comment">     Once we call allocate_bp_location(), that mostly uninitialized</span>
<a name="l08875"></a>08875 <span class="comment">     location will be placed on the location chain.  Adjustment of the</span>
<a name="l08876"></a>08876 <span class="comment">     breakpoint may cause target_read_memory() to be called and we do</span>
<a name="l08877"></a>08877 <span class="comment">     not want its scan of the location chain to find a breakpoint and</span>
<a name="l08878"></a>08878 <span class="comment">     location that&#39;s only been partially initialized.  */</span>
<a name="l08879"></a>08879   adjusted_address = adjust_breakpoint_address (loc_gdbarch,
<a name="l08880"></a>08880                                                 sal-&gt;<a class="code" href="structsymtab__and__line.html#a77665fa461ad187cb755efa256ba44d7">pc</a>, b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a>);
<a name="l08881"></a>08881 
<a name="l08882"></a>08882   <span class="comment">/* Sort the locations by their ADDRESS.  */</span>
<a name="l08883"></a>08883   loc = allocate_bp_location (b);
<a name="l08884"></a>08884   <span class="keywordflow">for</span> (tmp = &amp;(b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>); *tmp != NULL &amp;&amp; (*tmp)-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a> &lt;= adjusted_address;
<a name="l08885"></a>08885        tmp = &amp;((*tmp)-&gt;next))
<a name="l08886"></a>08886     ;
<a name="l08887"></a>08887   loc-&gt;<a class="code" href="structbp__location.html#ab193cb38f87fea89105db96d94191541">next</a> = *tmp;
<a name="l08888"></a>08888   *tmp = loc;
<a name="l08889"></a>08889 
<a name="l08890"></a>08890   loc-&gt;<a class="code" href="structbp__location.html#a4e316d8cab3c014aa85b8858d6223ce2">requested_address</a> = sal-&gt;<a class="code" href="structsymtab__and__line.html#a77665fa461ad187cb755efa256ba44d7">pc</a>;
<a name="l08891"></a>08891   loc-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a> = adjusted_address;
<a name="l08892"></a>08892   loc-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a> = sal-&gt;<a class="code" href="structsymtab__and__line.html#acc91f0276f4648cb5a970f17ddcbaf09">pspace</a>;
<a name="l08893"></a>08893   loc-&gt;<a class="code" href="structbp__location.html#a848151cbedd05ac5a77d211aea60a013">probe</a> = sal-&gt;<a class="code" href="structsymtab__and__line.html#ab82a3cb1b1a18123fbad52dcd8992228">probe</a>;
<a name="l08894"></a>08894   <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (loc-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a> != NULL);
<a name="l08895"></a>08895   loc-&gt;<a class="code" href="structbp__location.html#ac6d8286e46db5c4be6dab9139c43a00d">section</a> = sal-&gt;<a class="code" href="structsymtab__and__line.html#a2e86134f04ab0e4d0834da476b7d020e">section</a>;
<a name="l08896"></a>08896   loc-&gt;<a class="code" href="structbp__location.html#a55f3ff99d536775f5095f11e5f5c3f3e">gdbarch</a> = loc_gdbarch;
<a name="l08897"></a>08897   loc-&gt;<a class="code" href="structbp__location.html#a47eb96040eebcaabb5ab1e2ea7726d17">line_number</a> = sal-&gt;<a class="code" href="structsymtab__and__line.html#a6a0468be675b9ac19a5b3ef26f471eaf">line</a>;
<a name="l08898"></a>08898   loc-&gt;<a class="code" href="structbp__location.html#a1fbe0229a1e449ad3f855dc443869239">symtab</a> = sal-&gt;<a class="code" href="structsymtab__and__line.html#a74216e171a96d8bcaab43fe69b49c599">symtab</a>;
<a name="l08899"></a>08899 
<a name="l08900"></a>08900   set_breakpoint_location_function (loc,
<a name="l08901"></a>08901                                     sal-&gt;<a class="code" href="structsymtab__and__line.html#aa1cadecc3ac47f587f6725c2851a73ac">explicit_pc</a> || sal-&gt;<a class="code" href="structsymtab__and__line.html#a410b4ee060f0de75397dd244fcad54da">explicit_line</a>);
<a name="l08902"></a>08902   <span class="keywordflow">return</span> loc;
<a name="l08903"></a>08903 }
<a name="l08904"></a>08904 
<a name="l08905"></a>08905 
<a name="l08906"></a>08906 <span class="comment">/* Return 1 if LOC is pointing to a permanent breakpoint, </span>
<a name="l08907"></a>08907 <span class="comment">   return 0 otherwise.  */</span>
<a name="l08908"></a>08908 
<a name="l08909"></a>08909 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l08910"></a>08910 bp_loc_is_permanent (<span class="keyword">struct</span> bp_location *loc)
<a name="l08911"></a>08911 {
<a name="l08912"></a>08912   <span class="keywordtype">int</span> <a class="code" href="exec_8h.html#a00f945351279d3c8935f13d2b9f9b808">len</a>;
<a name="l08913"></a>08913   <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> addr;
<a name="l08914"></a>08914   <span class="keyword">const</span> <a class="code" href="defs_8h.html#a336b399b3b83dbcc61f176c33f26b607">gdb_byte</a> *bpoint;
<a name="l08915"></a>08915   <a class="code" href="defs_8h.html#a336b399b3b83dbcc61f176c33f26b607">gdb_byte</a> *target_mem;
<a name="l08916"></a>08916   <span class="keyword">struct </span>cleanup *cleanup;
<a name="l08917"></a>08917   <span class="keywordtype">int</span> retval = 0;
<a name="l08918"></a>08918 
<a name="l08919"></a>08919   <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (loc != NULL);
<a name="l08920"></a>08920 
<a name="l08921"></a>08921   addr = loc-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>;
<a name="l08922"></a>08922   bpoint = <a class="code" href="gdbarch_8c.html#a097194ad55d5379bab42ce9bf8029a69">gdbarch_breakpoint_from_pc</a> (loc-&gt;<a class="code" href="structbp__location.html#a55f3ff99d536775f5095f11e5f5c3f3e">gdbarch</a>, &amp;addr, &amp;len);
<a name="l08923"></a>08923 
<a name="l08924"></a>08924   <span class="comment">/* Software breakpoints unsupported?  */</span>
<a name="l08925"></a>08925   <span class="keywordflow">if</span> (bpoint == NULL)
<a name="l08926"></a>08926     <span class="keywordflow">return</span> 0;
<a name="l08927"></a>08927 
<a name="l08928"></a>08928   target_mem = alloca (len);
<a name="l08929"></a>08929 
<a name="l08930"></a>08930   <span class="comment">/* Enable the automatic memory restoration from breakpoints while</span>
<a name="l08931"></a>08931 <span class="comment">     we read the memory.  Otherwise we could say about our temporary</span>
<a name="l08932"></a>08932 <span class="comment">     breakpoints they are permanent.  */</span>
<a name="l08933"></a>08933   cleanup = <a class="code" href="progspace_8c.html#a6326460454db4e192e2bc221cb322977">save_current_space_and_thread</a> ();
<a name="l08934"></a>08934 
<a name="l08935"></a>08935   <a class="code" href="progspace_8c.html#a58d979e46585ad85280e488204e0147e">switch_to_program_space_and_thread</a> (loc-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a>);
<a name="l08936"></a>08936   <a class="code" href="target_8c.html#afd34ddac7a36904417e6526601cf516a">make_show_memory_breakpoints_cleanup</a> (0);
<a name="l08937"></a>08937 
<a name="l08938"></a>08938   <span class="keywordflow">if</span> (<a class="code" href="target_8c.html#ac579515fbccfb9e6b1a45766a71c1d4f">target_read_memory</a> (loc-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>, target_mem, len) == 0
<a name="l08939"></a>08939       &amp;&amp; <a class="code" href="gdb__string_8h.html#a65c3e6b23d6855c86acaf147853c82cc">memcmp</a> (target_mem, bpoint, len) == 0)
<a name="l08940"></a>08940     retval = 1;
<a name="l08941"></a>08941 
<a name="l08942"></a>08942   <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (cleanup);
<a name="l08943"></a>08943 
<a name="l08944"></a>08944   <span class="keywordflow">return</span> retval;
<a name="l08945"></a>08945 }
<a name="l08946"></a>08946 
<a name="l08947"></a>08947 <span class="comment">/* Build a command list for the dprintf corresponding to the current</span>
<a name="l08948"></a>08948 <span class="comment">   settings of the dprintf style options.  */</span>
<a name="l08949"></a>08949 
<a name="l08950"></a>08950 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l08951"></a>08951 update_dprintf_command_list (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b)
<a name="l08952"></a>08952 {
<a name="l08953"></a>08953   <span class="keywordtype">char</span> *dprintf_args = b-&gt;<a class="code" href="structbreakpoint.html#a814299ce6585ae3945072a6df05ecb83">extra_string</a>;
<a name="l08954"></a>08954   <span class="keywordtype">char</span> *printf_line = NULL;
<a name="l08955"></a>08955 
<a name="l08956"></a>08956   <span class="keywordflow">if</span> (!dprintf_args)
<a name="l08957"></a>08957     <span class="keywordflow">return</span>;
<a name="l08958"></a>08958 
<a name="l08959"></a>08959   dprintf_args = <a class="code" href="cli-utils_8c.html#afa70bcaee54d487b4412d2a7a5a0c8fa">skip_spaces</a> (dprintf_args);
<a name="l08960"></a>08960 
<a name="l08961"></a>08961   <span class="comment">/* Allow a comma, as it may have terminated a location, but don&#39;t</span>
<a name="l08962"></a>08962 <span class="comment">     insist on it.  */</span>
<a name="l08963"></a>08963   <span class="keywordflow">if</span> (*dprintf_args == <span class="charliteral">&#39;,&#39;</span>)
<a name="l08964"></a>08964     ++dprintf_args;
<a name="l08965"></a>08965   dprintf_args = <a class="code" href="cli-utils_8c.html#afa70bcaee54d487b4412d2a7a5a0c8fa">skip_spaces</a> (dprintf_args);
<a name="l08966"></a>08966 
<a name="l08967"></a>08967   <span class="keywordflow">if</span> (*dprintf_args != <span class="charliteral">&#39;&quot;&#39;</span>)
<a name="l08968"></a>08968     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Bad format string, missing &#39;\&quot;&#39;.&quot;</span>));
<a name="l08969"></a>08969 
<a name="l08970"></a>08970   <span class="keywordflow">if</span> (strcmp (dprintf_style, dprintf_style_gdb) == 0)
<a name="l08971"></a>08971     printf_line = <a class="code" href="common-utils_8c.html#ab9bf7e1b4e68bdd0078e9e1e55c62cec">xstrprintf</a> (<span class="stringliteral">&quot;printf %s&quot;</span>, dprintf_args);
<a name="l08972"></a>08972   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp (dprintf_style, dprintf_style_call) == 0)
<a name="l08973"></a>08973     {
<a name="l08974"></a>08974       <span class="keywordflow">if</span> (!dprintf_function)
<a name="l08975"></a>08975         <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;No function supplied for dprintf call&quot;</span>));
<a name="l08976"></a>08976 
<a name="l08977"></a>08977       <span class="keywordflow">if</span> (dprintf_channel &amp;&amp; strlen (dprintf_channel) &gt; 0)
<a name="l08978"></a>08978         printf_line = <a class="code" href="common-utils_8c.html#ab9bf7e1b4e68bdd0078e9e1e55c62cec">xstrprintf</a> (<span class="stringliteral">&quot;call (void) %s (%s,%s)&quot;</span>,
<a name="l08979"></a>08979                                   dprintf_function,
<a name="l08980"></a>08980                                   dprintf_channel,
<a name="l08981"></a>08981                                   dprintf_args);
<a name="l08982"></a>08982       <span class="keywordflow">else</span>
<a name="l08983"></a>08983         printf_line = <a class="code" href="common-utils_8c.html#ab9bf7e1b4e68bdd0078e9e1e55c62cec">xstrprintf</a> (<span class="stringliteral">&quot;call (void) %s (%s)&quot;</span>,
<a name="l08984"></a>08984                                   dprintf_function,
<a name="l08985"></a>08985                                   dprintf_args);
<a name="l08986"></a>08986     }
<a name="l08987"></a>08987   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp (dprintf_style, dprintf_style_agent) == 0)
<a name="l08988"></a>08988     {
<a name="l08989"></a>08989       <span class="keywordflow">if</span> (<a class="code" href="target_8h.html#a0f238e36b27ab62c468bef80dd432273">target_can_run_breakpoint_commands</a> ())
<a name="l08990"></a>08990         printf_line = <a class="code" href="common-utils_8c.html#ab9bf7e1b4e68bdd0078e9e1e55c62cec">xstrprintf</a> (<span class="stringliteral">&quot;agent-printf %s&quot;</span>, dprintf_args);
<a name="l08991"></a>08991       <span class="keywordflow">else</span>
<a name="l08992"></a>08992         {
<a name="l08993"></a>08993           <a class="code" href="utils_8c.html#a5fc201a4181499a6b4057a6caa15b5e2">warning</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Target cannot run dprintf commands, falling back to GDB printf&quot;</span>));
<a name="l08994"></a>08994           printf_line = <a class="code" href="common-utils_8c.html#ab9bf7e1b4e68bdd0078e9e1e55c62cec">xstrprintf</a> (<span class="stringliteral">&quot;printf %s&quot;</span>, dprintf_args);
<a name="l08995"></a>08995         }
<a name="l08996"></a>08996     }
<a name="l08997"></a>08997   <span class="keywordflow">else</span>
<a name="l08998"></a>08998     <a class="code" href="common-utils_8h.html#aa14285d9d3d4171016ef9cf09447e8bb">internal_error</a> (__FILE__, __LINE__,
<a name="l08999"></a>08999                     <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Invalid dprintf style.&quot;</span>));
<a name="l09000"></a>09000 
<a name="l09001"></a>09001   <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (printf_line != NULL);
<a name="l09002"></a>09002   <span class="comment">/* Manufacture a printf sequence.  */</span>
<a name="l09003"></a>09003   {
<a name="l09004"></a>09004     <span class="keyword">struct </span><a class="code" href="structcommand__line.html">command_line</a> *printf_cmd_line
<a name="l09005"></a>09005       = <a class="code" href="common-utils_8c.html#a634d6cd850bb831afebc499579303b3b">xmalloc</a> (<span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structcommand__line.html">command_line</a>));
<a name="l09006"></a>09006 
<a name="l09007"></a>09007     printf_cmd_line = <a class="code" href="common-utils_8c.html#a634d6cd850bb831afebc499579303b3b">xmalloc</a> (<span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structcommand__line.html">command_line</a>));
<a name="l09008"></a>09008     printf_cmd_line-&gt;<a class="code" href="structcommand__line.html#ab4945ad7bd82e7ece55e463c3a52155f">control_type</a> = <a class="code" href="defs_8h.html#acd2d66ca4b77ba7ac2fbfc6149bf1cddad85c97f8ce050d876f3bc5bccba65c40">simple_control</a>;
<a name="l09009"></a>09009     printf_cmd_line-&gt;<a class="code" href="structcommand__line.html#aeb5463cf08c771552fb0a9b579edd592">body_count</a> = 0;
<a name="l09010"></a>09010     printf_cmd_line-&gt;<a class="code" href="structcommand__line.html#ab44cb6b34417ec8a326a4ed5b3316e20">body_list</a> = NULL;
<a name="l09011"></a>09011     printf_cmd_line-&gt;<a class="code" href="structcommand__line.html#aa3aea4183824359fc95edf1bf4e5291c">next</a> = NULL;
<a name="l09012"></a>09012     printf_cmd_line-&gt;<a class="code" href="structcommand__line.html#ac3bdd932f280976d7751ee96783a2c71">line</a> = printf_line;
<a name="l09013"></a>09013 
<a name="l09014"></a>09014     <a class="code" href="breakpoint_8c.html#af44da744b723fb36892418db535ed855">breakpoint_set_commands</a> (b, printf_cmd_line);
<a name="l09015"></a>09015   }
<a name="l09016"></a>09016 }
<a name="l09017"></a>09017 
<a name="l09018"></a>09018 <span class="comment">/* Update all dprintf commands, making their command lists reflect</span>
<a name="l09019"></a>09019 <span class="comment">   current style settings.  */</span>
<a name="l09020"></a>09020 
<a name="l09021"></a>09021 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l09022"></a>09022 update_dprintf_commands (<span class="keywordtype">char</span> *args, <span class="keywordtype">int</span> from_tty,
<a name="l09023"></a>09023                          <span class="keyword">struct</span> <a class="code" href="structcmd__list__element.html">cmd_list_element</a> *c)
<a name="l09024"></a>09024 {
<a name="l09025"></a>09025   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b;
<a name="l09026"></a>09026 
<a name="l09027"></a>09027   <a class="code" href="breakpoint_8c.html#a781d5d3dc50a92364edfbacac3d0c107">ALL_BREAKPOINTS</a> (b)
<a name="l09028"></a>09028     {
<a name="l09029"></a>09029       <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa404b00503edb7eba238aea705ea34231">bp_dprintf</a>)
<a name="l09030"></a>09030         update_dprintf_command_list (b);
<a name="l09031"></a>09031     }
<a name="l09032"></a>09032 }
<a name="l09033"></a>09033 
<a name="l09034"></a>09034 <span class="comment">/* Create a breakpoint with SAL as location.  Use ADDR_STRING</span>
<a name="l09035"></a>09035 <span class="comment">   as textual description of the location, and COND_STRING</span>
<a name="l09036"></a>09036 <span class="comment">   as condition expression.  */</span>
<a name="l09037"></a>09037 
<a name="l09038"></a>09038 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l09039"></a>09039 init_breakpoint_sal (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b, <span class="keyword">struct</span> gdbarch *gdbarch,
<a name="l09040"></a>09040                      <span class="keyword">struct</span> <a class="code" href="structsymtabs__and__lines.html">symtabs_and_lines</a> sals, <span class="keywordtype">char</span> *<a class="code" href="structbreakpoint.html#a885e704e5cdcfc314069b970c396d1a4">addr_string</a>,
<a name="l09041"></a>09041                      <span class="keywordtype">char</span> *<a class="code" href="structbreakpoint.html#a2b1a690827488a6b2385d72d9dc857a0">filter</a>, <span class="keywordtype">char</span> *<a class="code" href="structbreakpoint.html#a817904eee4ded1a9e18ab46709c1245b">cond_string</a>,
<a name="l09042"></a>09042                      <span class="keywordtype">char</span> *<a class="code" href="structbreakpoint.html#a814299ce6585ae3945072a6df05ecb83">extra_string</a>,
<a name="l09043"></a>09043                      <span class="keyword">enum</span> bptype type, <span class="keyword">enum</span> <a class="code" href="breakpoint_8h.html#a15f2bbd9012f59bc09d59feef0c15732">bpdisp</a> <a class="code" href="structbreakpoint.html#a75f0f9a837eac292ab6e768e8d8f1bd7">disposition</a>,
<a name="l09044"></a>09044                      <span class="keywordtype">int</span> thread, <span class="keywordtype">int</span> <a class="code" href="structbreakpoint.html#a9dc2d2b94cb051b28f86f8780dbad907">task</a>, <span class="keywordtype">int</span> <a class="code" href="structbreakpoint.html#a0e1286b838f13a04031a220f81c04d2d">ignore_count</a>,
<a name="l09045"></a>09045                      <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structbreakpoint__ops.html">breakpoint_ops</a> *ops, <span class="keywordtype">int</span> from_tty,
<a name="l09046"></a>09046                      <span class="keywordtype">int</span> enabled, <span class="keywordtype">int</span> <span class="keyword">internal</span>, <span class="keywordtype">unsigned</span> <a class="code" href="solib-som_8c.html#a555096840020c318e34b205419e98cca">flags</a>,
<a name="l09047"></a>09047                      <span class="keywordtype">int</span> <a class="code" href="structbreakpoint.html#a115ca3df7d36fa4e3b29b2549cf8c0f1">display_canonical</a>)
<a name="l09048"></a>09048 {
<a name="l09049"></a>09049   <span class="keywordtype">int</span> i;
<a name="l09050"></a>09050 
<a name="l09051"></a>09051   <span class="keywordflow">if</span> (type == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa657fad68a9d83a24532fb06715b77628">bp_hardware_breakpoint</a>)
<a name="l09052"></a>09052     {
<a name="l09053"></a>09053       <span class="keywordtype">int</span> target_resources_ok;
<a name="l09054"></a>09054 
<a name="l09055"></a>09055       i = hw_breakpoint_used_count ();
<a name="l09056"></a>09056       target_resources_ok =
<a name="l09057"></a>09057         <a class="code" href="target_8h.html#a426728386dc9c2a6d50a7a20e90fe13b">target_can_use_hardware_watchpoint</a> (<a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa657fad68a9d83a24532fb06715b77628">bp_hardware_breakpoint</a>,
<a name="l09058"></a>09058                                             i + 1, 0);
<a name="l09059"></a>09059       <span class="keywordflow">if</span> (target_resources_ok == 0)
<a name="l09060"></a>09060         <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;No hardware breakpoint support in the target.&quot;</span>));
<a name="l09061"></a>09061       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (target_resources_ok &lt; 0)
<a name="l09062"></a>09062         <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Hardware breakpoints used exceeds limit.&quot;</span>));
<a name="l09063"></a>09063     }
<a name="l09064"></a>09064 
<a name="l09065"></a>09065   <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (sals.<a class="code" href="structsymtabs__and__lines.html#a1c8b832fc2f8c096c95144a2acedd36a">nelts</a> &gt; 0);
<a name="l09066"></a>09066 
<a name="l09067"></a>09067   <span class="keywordflow">for</span> (i = 0; i &lt; sals.<a class="code" href="structsymtabs__and__lines.html#a1c8b832fc2f8c096c95144a2acedd36a">nelts</a>; ++i)
<a name="l09068"></a>09068     {
<a name="l09069"></a>09069       <span class="keyword">struct </span><a class="code" href="structsymtab__and__line.html">symtab_and_line</a> sal = sals.<a class="code" href="structsymtabs__and__lines.html#ab601f48fdf29c3b190ba068f57983df4">sals</a>[i];
<a name="l09070"></a>09070       <span class="keyword">struct </span>bp_location *loc;
<a name="l09071"></a>09071 
<a name="l09072"></a>09072       <span class="keywordflow">if</span> (from_tty)
<a name="l09073"></a>09073         {
<a name="l09074"></a>09074           <span class="keyword">struct </span>gdbarch *loc_gdbarch = <a class="code" href="breakpoint_8c.html#ab44e7bca7511390e3baade6daeecf6cd">get_sal_arch</a> (sal);
<a name="l09075"></a>09075           <span class="keywordflow">if</span> (!loc_gdbarch)
<a name="l09076"></a>09076             loc_gdbarch = gdbarch;
<a name="l09077"></a>09077 
<a name="l09078"></a>09078           describe_other_breakpoints (loc_gdbarch,
<a name="l09079"></a>09079                                       sal.<a class="code" href="structsymtab__and__line.html#acc91f0276f4648cb5a970f17ddcbaf09">pspace</a>, sal.<a class="code" href="structsymtab__and__line.html#a77665fa461ad187cb755efa256ba44d7">pc</a>, sal.<a class="code" href="structsymtab__and__line.html#a2e86134f04ab0e4d0834da476b7d020e">section</a>, thread);
<a name="l09080"></a>09080         }
<a name="l09081"></a>09081 
<a name="l09082"></a>09082       <span class="keywordflow">if</span> (i == 0)
<a name="l09083"></a>09083         {
<a name="l09084"></a>09084           init_raw_breakpoint (b, gdbarch, sal, type, ops);
<a name="l09085"></a>09085           b-&gt;<a class="code" href="structbreakpoint.html#ae8613b6d8cf464f30ea39597be0cc192">thread</a> = thread;
<a name="l09086"></a>09086           b-&gt;<a class="code" href="structbreakpoint.html#a9dc2d2b94cb051b28f86f8780dbad907">task</a> = task;
<a name="l09087"></a>09087 
<a name="l09088"></a>09088           b-&gt;<a class="code" href="structbreakpoint.html#a817904eee4ded1a9e18ab46709c1245b">cond_string</a> = cond_string;
<a name="l09089"></a>09089           b-&gt;<a class="code" href="structbreakpoint.html#a814299ce6585ae3945072a6df05ecb83">extra_string</a> = extra_string;
<a name="l09090"></a>09090           b-&gt;<a class="code" href="structbreakpoint.html#a0e1286b838f13a04031a220f81c04d2d">ignore_count</a> = ignore_count;
<a name="l09091"></a>09091           b-&gt;<a class="code" href="structbreakpoint.html#acb53352fd35aaad37054508fabc0f3bf">enable_state</a> = enabled ? <a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577a72f1fa981d13a62d05324c1de974b44b">bp_enabled</a> : <a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577a4605f207d0d15bd8195c9b1aa1bfee96">bp_disabled</a>;
<a name="l09092"></a>09092           b-&gt;<a class="code" href="structbreakpoint.html#a75f0f9a837eac292ab6e768e8d8f1bd7">disposition</a> = disposition;
<a name="l09093"></a>09093 
<a name="l09094"></a>09094           <span class="keywordflow">if</span> ((flags &amp; <a class="code" href="breakpoint_8h.html#a6b7a6276cddd7fa799172e0ebebb07d4ab60fd142c600aead72613fe63df4d0c1">CREATE_BREAKPOINT_FLAGS_INSERTED</a>) != 0)
<a name="l09095"></a>09095             b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>-&gt;<a class="code" href="structbp__location.html#acb0b475579bbe5dabeb8ed4504527105">inserted</a> = 1;
<a name="l09096"></a>09096 
<a name="l09097"></a>09097           <span class="keywordflow">if</span> (type == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfae4357544e8e764b68ef3729aa9ac2be3">bp_static_tracepoint</a>)
<a name="l09098"></a>09098             {
<a name="l09099"></a>09099               <span class="keyword">struct </span><a class="code" href="structtracepoint.html">tracepoint</a> *t = (<span class="keyword">struct </span><a class="code" href="structtracepoint.html">tracepoint</a> *) b;
<a name="l09100"></a>09100               <span class="keyword">struct </span><a class="code" href="structstatic__tracepoint__marker.html">static_tracepoint_marker</a> marker;
<a name="l09101"></a>09101 
<a name="l09102"></a>09102               <span class="keywordflow">if</span> (strace_marker_p (b))
<a name="l09103"></a>09103                 {
<a name="l09104"></a>09104                   <span class="comment">/* We already know the marker exists, otherwise, we</span>
<a name="l09105"></a>09105 <span class="comment">                     wouldn&#39;t see a sal for it.  */</span>
<a name="l09106"></a>09106                   <span class="keywordtype">char</span> *p = &amp;addr_string[3];
<a name="l09107"></a>09107                   <span class="keywordtype">char</span> *endp;
<a name="l09108"></a>09108                   <span class="keywordtype">char</span> *marker_str;
<a name="l09109"></a>09109 
<a name="l09110"></a>09110                   p = <a class="code" href="cli-utils_8c.html#afa70bcaee54d487b4412d2a7a5a0c8fa">skip_spaces</a> (p);
<a name="l09111"></a>09111 
<a name="l09112"></a>09112                   endp = <a class="code" href="cli-utils_8h.html#a72436dcbbbe357dbd26e02588a6d3808">skip_to_space</a> (p);
<a name="l09113"></a>09113 
<a name="l09114"></a>09114                   marker_str = <a class="code" href="common-utils_8c.html#a5f388f89054b57d850779d7d71bc4d1c">savestring</a> (p, endp - p);
<a name="l09115"></a>09115                   t-&gt;<a class="code" href="structtracepoint.html#adeab8a95f18310c90340e7468151db92">static_trace_marker_id</a> = marker_str;
<a name="l09116"></a>09116 
<a name="l09117"></a>09117                   <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Probed static tracepoint &quot;</span>
<a name="l09118"></a>09118                                      <span class="stringliteral">&quot;marker \&quot;%s\&quot;\n&quot;</span>),
<a name="l09119"></a>09119                                    t-&gt;<a class="code" href="structtracepoint.html#adeab8a95f18310c90340e7468151db92">static_trace_marker_id</a>);
<a name="l09120"></a>09120                 }
<a name="l09121"></a>09121               <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="target_8h.html#ae08c5fc84179c507e7eb68640f32a5f4">target_static_tracepoint_marker_at</a> (sal.<a class="code" href="structsymtab__and__line.html#a77665fa461ad187cb755efa256ba44d7">pc</a>, &amp;marker))
<a name="l09122"></a>09122                 {
<a name="l09123"></a>09123                   t-&gt;<a class="code" href="structtracepoint.html#adeab8a95f18310c90340e7468151db92">static_trace_marker_id</a> = xstrdup (marker.str_id);
<a name="l09124"></a>09124                   <a class="code" href="tracepoint_8c.html#a6eb95e5022deae349e0523ceb87e6252">release_static_tracepoint_marker</a> (&amp;marker);
<a name="l09125"></a>09125 
<a name="l09126"></a>09126                   <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Probed static tracepoint &quot;</span>
<a name="l09127"></a>09127                                      <span class="stringliteral">&quot;marker \&quot;%s\&quot;\n&quot;</span>),
<a name="l09128"></a>09128                                    t-&gt;<a class="code" href="structtracepoint.html#adeab8a95f18310c90340e7468151db92">static_trace_marker_id</a>);
<a name="l09129"></a>09129                 }
<a name="l09130"></a>09130               <span class="keywordflow">else</span>
<a name="l09131"></a>09131                 <a class="code" href="utils_8c.html#a5fc201a4181499a6b4057a6caa15b5e2">warning</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Couldn&#39;t determine the static &quot;</span>
<a name="l09132"></a>09132                            <span class="stringliteral">&quot;tracepoint marker to probe&quot;</span>));
<a name="l09133"></a>09133             }
<a name="l09134"></a>09134 
<a name="l09135"></a>09135           loc = b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>;
<a name="l09136"></a>09136         }
<a name="l09137"></a>09137       <span class="keywordflow">else</span>
<a name="l09138"></a>09138         {
<a name="l09139"></a>09139           loc = add_location_to_breakpoint (b, &amp;sal);
<a name="l09140"></a>09140           <span class="keywordflow">if</span> ((flags &amp; CREATE_BREAKPOINT_FLAGS_INSERTED) != 0)
<a name="l09141"></a>09141             loc-&gt;<a class="code" href="structbp__location.html#acb0b475579bbe5dabeb8ed4504527105">inserted</a> = 1;
<a name="l09142"></a>09142         }
<a name="l09143"></a>09143 
<a name="l09144"></a>09144       <span class="keywordflow">if</span> (bp_loc_is_permanent (loc))
<a name="l09145"></a>09145         <a class="code" href="breakpoint_8c.html#a23d7b67630cc8572e7c3dc83c7dd9fe2">make_breakpoint_permanent</a> (b);
<a name="l09146"></a>09146 
<a name="l09147"></a>09147       <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#a817904eee4ded1a9e18ab46709c1245b">cond_string</a>)
<a name="l09148"></a>09148         {
<a name="l09149"></a>09149           <span class="keyword">const</span> <span class="keywordtype">char</span> *arg = b-&gt;<a class="code" href="structbreakpoint.html#a817904eee4ded1a9e18ab46709c1245b">cond_string</a>;
<a name="l09150"></a>09150 
<a name="l09151"></a>09151           loc-&gt;<a class="code" href="structbp__location.html#a1594433a0c3734e79b98d8296984ec7a">cond</a> = <a class="code" href="expression_8h.html#abdad295cc4b5351f6e6ec024ab665475">parse_exp_1</a> (&amp;arg, loc-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>,
<a name="l09152"></a>09152                                    <a class="code" href="block_8c.html#a35aadf82f92cb4a47ec068dba0e1b36c">block_for_pc</a> (loc-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>), 0);
<a name="l09153"></a>09153           <span class="keywordflow">if</span> (*arg)
<a name="l09154"></a>09154               <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Garbage &#39;%s&#39; follows condition&quot;</span>), arg);
<a name="l09155"></a>09155         }
<a name="l09156"></a>09156 
<a name="l09157"></a>09157       <span class="comment">/* Dynamic printf requires and uses additional arguments on the</span>
<a name="l09158"></a>09158 <span class="comment">         command line, otherwise it&#39;s an error.  */</span>
<a name="l09159"></a>09159       <span class="keywordflow">if</span> (type == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa404b00503edb7eba238aea705ea34231">bp_dprintf</a>)
<a name="l09160"></a>09160         {
<a name="l09161"></a>09161           <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#a814299ce6585ae3945072a6df05ecb83">extra_string</a>)
<a name="l09162"></a>09162             update_dprintf_command_list (b);
<a name="l09163"></a>09163           <span class="keywordflow">else</span>
<a name="l09164"></a>09164             <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Format string required&quot;</span>));
<a name="l09165"></a>09165         }
<a name="l09166"></a>09166       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#a814299ce6585ae3945072a6df05ecb83">extra_string</a>)
<a name="l09167"></a>09167         <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Garbage &#39;%s&#39; at end of command&quot;</span>), b-&gt;<a class="code" href="structbreakpoint.html#a814299ce6585ae3945072a6df05ecb83">extra_string</a>);
<a name="l09168"></a>09168     }
<a name="l09169"></a>09169 
<a name="l09170"></a>09170   b-&gt;<a class="code" href="structbreakpoint.html#a115ca3df7d36fa4e3b29b2549cf8c0f1">display_canonical</a> = display_canonical;
<a name="l09171"></a>09171   <span class="keywordflow">if</span> (addr_string)
<a name="l09172"></a>09172     b-&gt;<a class="code" href="structbreakpoint.html#a885e704e5cdcfc314069b970c396d1a4">addr_string</a> = addr_string;
<a name="l09173"></a>09173   <span class="keywordflow">else</span>
<a name="l09174"></a>09174     <span class="comment">/* addr_string has to be used or breakpoint_re_set will delete</span>
<a name="l09175"></a>09175 <span class="comment">       me.  */</span>
<a name="l09176"></a>09176     b-&gt;<a class="code" href="structbreakpoint.html#a885e704e5cdcfc314069b970c396d1a4">addr_string</a>
<a name="l09177"></a>09177       = <a class="code" href="common-utils_8c.html#ab9bf7e1b4e68bdd0078e9e1e55c62cec">xstrprintf</a> (<span class="stringliteral">&quot;*%s&quot;</span>, <a class="code" href="utils_8c.html#ab5c76d72090f01d3848b63dda4e37d1c">paddress</a> (b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>-&gt;<a class="code" href="structbp__location.html#a55f3ff99d536775f5095f11e5f5c3f3e">gdbarch</a>, b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>));
<a name="l09178"></a>09178   b-&gt;<a class="code" href="structbreakpoint.html#a2b1a690827488a6b2385d72d9dc857a0">filter</a> = filter;
<a name="l09179"></a>09179 }
<a name="l09180"></a>09180 
<a name="l09181"></a>09181 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l09182"></a>09182 create_breakpoint_sal (<span class="keyword">struct</span> gdbarch *gdbarch,
<a name="l09183"></a>09183                        <span class="keyword">struct</span> <a class="code" href="structsymtabs__and__lines.html">symtabs_and_lines</a> sals, <span class="keywordtype">char</span> *addr_string,
<a name="l09184"></a>09184                        <span class="keywordtype">char</span> *filter, <span class="keywordtype">char</span> *cond_string,
<a name="l09185"></a>09185                        <span class="keywordtype">char</span> *extra_string,
<a name="l09186"></a>09186                        <span class="keyword">enum</span> bptype type, <span class="keyword">enum</span> <a class="code" href="breakpoint_8h.html#a15f2bbd9012f59bc09d59feef0c15732">bpdisp</a> disposition,
<a name="l09187"></a>09187                        <span class="keywordtype">int</span> thread, <span class="keywordtype">int</span> task, <span class="keywordtype">int</span> ignore_count,
<a name="l09188"></a>09188                        <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structbreakpoint__ops.html">breakpoint_ops</a> *ops, <span class="keywordtype">int</span> from_tty,
<a name="l09189"></a>09189                        <span class="keywordtype">int</span> enabled, <span class="keywordtype">int</span> <span class="keyword">internal</span>, <span class="keywordtype">unsigned</span> flags,
<a name="l09190"></a>09190                        <span class="keywordtype">int</span> display_canonical)
<a name="l09191"></a>09191 {
<a name="l09192"></a>09192   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b;
<a name="l09193"></a>09193   <span class="keyword">struct </span>cleanup *old_chain;
<a name="l09194"></a>09194 
<a name="l09195"></a>09195   <span class="keywordflow">if</span> (is_tracepoint_type (type))
<a name="l09196"></a>09196     {
<a name="l09197"></a>09197       <span class="keyword">struct </span><a class="code" href="structtracepoint.html">tracepoint</a> *t;
<a name="l09198"></a>09198 
<a name="l09199"></a>09199       t = XCNEW (<span class="keyword">struct</span> <a class="code" href="structtracepoint.html">tracepoint</a>);
<a name="l09200"></a>09200       b = &amp;t-&gt;<a class="code" href="structtracepoint.html#a881af30b18b555e6ff11113da6b01a02">base</a>;
<a name="l09201"></a>09201     }
<a name="l09202"></a>09202   <span class="keywordflow">else</span>
<a name="l09203"></a>09203     b = XNEW (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a>);
<a name="l09204"></a>09204 
<a name="l09205"></a>09205   old_chain = <a class="code" href="cleanups_8c.html#a3d418f8af424aec399898c2d48b26224">make_cleanup</a> (<a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a>, b);
<a name="l09206"></a>09206 
<a name="l09207"></a>09207   init_breakpoint_sal (b, gdbarch,
<a name="l09208"></a>09208                        sals, addr_string,
<a name="l09209"></a>09209                        filter, cond_string, extra_string,
<a name="l09210"></a>09210                        type, disposition,
<a name="l09211"></a>09211                        thread, task, ignore_count,
<a name="l09212"></a>09212                        ops, from_tty,
<a name="l09213"></a>09213                        enabled, <span class="keyword">internal</span>, flags,
<a name="l09214"></a>09214                        display_canonical);
<a name="l09215"></a>09215   <a class="code" href="cleanups_8c.html#a5ec3987bf995edcc44def9e17ada6eba">discard_cleanups</a> (old_chain);
<a name="l09216"></a>09216 
<a name="l09217"></a>09217   <a class="code" href="breakpoint_8c.html#a74ff6d8191c3b444efd5631143d21635">install_breakpoint</a> (<span class="keyword">internal</span>, b, 0);
<a name="l09218"></a>09218 }
<a name="l09219"></a>09219 
<a name="l09220"></a>09220 <span class="comment">/* Add SALS.nelts breakpoints to the breakpoint table.  For each</span>
<a name="l09221"></a>09221 <span class="comment">   SALS.sal[i] breakpoint, include the corresponding ADDR_STRING[i]</span>
<a name="l09222"></a>09222 <span class="comment">   value.  COND_STRING, if not NULL, specified the condition to be</span>
<a name="l09223"></a>09223 <span class="comment">   used for all breakpoints.  Essentially the only case where</span>
<a name="l09224"></a>09224 <span class="comment">   SALS.nelts is not 1 is when we set a breakpoint on an overloaded</span>
<a name="l09225"></a>09225 <span class="comment">   function.  In that case, it&#39;s still not possible to specify</span>
<a name="l09226"></a>09226 <span class="comment">   separate conditions for different overloaded functions, so</span>
<a name="l09227"></a>09227 <span class="comment">   we take just a single condition string.</span>
<a name="l09228"></a>09228 <span class="comment">   </span>
<a name="l09229"></a>09229 <span class="comment">   NOTE: If the function succeeds, the caller is expected to cleanup</span>
<a name="l09230"></a>09230 <span class="comment">   the arrays ADDR_STRING, COND_STRING, and SALS (but not the</span>
<a name="l09231"></a>09231 <span class="comment">   array contents).  If the function fails (error() is called), the</span>
<a name="l09232"></a>09232 <span class="comment">   caller is expected to cleanups both the ADDR_STRING, COND_STRING,</span>
<a name="l09233"></a>09233 <span class="comment">   COND and SALS arrays and each of those arrays contents.  */</span>
<a name="l09234"></a>09234 
<a name="l09235"></a>09235 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l09236"></a>09236 create_breakpoints_sal (<span class="keyword">struct</span> gdbarch *gdbarch,
<a name="l09237"></a>09237                         <span class="keyword">struct</span> <a class="code" href="structlinespec__result.html">linespec_result</a> *canonical,
<a name="l09238"></a>09238                         <span class="keywordtype">char</span> *cond_string, <span class="keywordtype">char</span> *extra_string,
<a name="l09239"></a>09239                         <span class="keyword">enum</span> bptype type, <span class="keyword">enum</span> <a class="code" href="breakpoint_8h.html#a15f2bbd9012f59bc09d59feef0c15732">bpdisp</a> disposition,
<a name="l09240"></a>09240                         <span class="keywordtype">int</span> thread, <span class="keywordtype">int</span> task, <span class="keywordtype">int</span> ignore_count,
<a name="l09241"></a>09241                         <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structbreakpoint__ops.html">breakpoint_ops</a> *ops, <span class="keywordtype">int</span> from_tty,
<a name="l09242"></a>09242                         <span class="keywordtype">int</span> enabled, <span class="keywordtype">int</span> <span class="keyword">internal</span>, <span class="keywordtype">unsigned</span> flags)
<a name="l09243"></a>09243 {
<a name="l09244"></a>09244   <span class="keywordtype">int</span> i;
<a name="l09245"></a>09245   <span class="keyword">struct </span><a class="code" href="structlinespec__sals.html">linespec_sals</a> *lsal;
<a name="l09246"></a>09246 
<a name="l09247"></a>09247   <span class="keywordflow">if</span> (canonical-&gt;<a class="code" href="structlinespec__result.html#aba3bd9d4d9bc5d3b63ad16e64169b765">pre_expanded</a>)
<a name="l09248"></a>09248     <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (<a class="code" href="vec_8h.html#a844523bba6d0565ef73a0f4a63e48d19">VEC_length</a> (<a class="code" href="structlinespec__sals.html">linespec_sals</a>, canonical-&gt;sals) == 1);
<a name="l09249"></a>09249 
<a name="l09250"></a>09250   <span class="keywordflow">for</span> (i = 0; <a class="code" href="vec_8h.html#ae7795b0c8e65f45eb49aac5ec2c0fa52">VEC_iterate</a> (<a class="code" href="structlinespec__sals.html">linespec_sals</a>, canonical-&gt;sals, i, lsal); ++i)
<a name="l09251"></a>09251     {
<a name="l09252"></a>09252       <span class="comment">/* Note that &#39;addr_string&#39; can be NULL in the case of a plain</span>
<a name="l09253"></a>09253 <span class="comment">         &#39;break&#39;, without arguments.  */</span>
<a name="l09254"></a>09254       <span class="keywordtype">char</span> *addr_string = (canonical-&gt;<a class="code" href="structlinespec__result.html#abfccf5d367c072077ac366af4d3f23f9">addr_string</a>
<a name="l09255"></a>09255                            ? xstrdup (canonical-&gt;<a class="code" href="structlinespec__result.html#abfccf5d367c072077ac366af4d3f23f9">addr_string</a>)
<a name="l09256"></a>09256                            : NULL);
<a name="l09257"></a>09257       <span class="keywordtype">char</span> *filter_string = lsal-&gt;<a class="code" href="structlinespec__sals.html#a5a6b2c7bb2c9b91d8077fb7186a6c466">canonical</a> ? xstrdup (lsal-&gt;<a class="code" href="structlinespec__sals.html#a5a6b2c7bb2c9b91d8077fb7186a6c466">canonical</a>) : NULL;
<a name="l09258"></a>09258       <span class="keyword">struct </span>cleanup *inner = <a class="code" href="cleanups_8c.html#a3d418f8af424aec399898c2d48b26224">make_cleanup</a> (<a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a>, addr_string);
<a name="l09259"></a>09259 
<a name="l09260"></a>09260       <a class="code" href="cleanups_8c.html#a3d418f8af424aec399898c2d48b26224">make_cleanup</a> (<a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a>, filter_string);
<a name="l09261"></a>09261       create_breakpoint_sal (gdbarch, lsal-&gt;<a class="code" href="structlinespec__sals.html#a34ac2e438b2835722c998f409c85dcee">sals</a>,
<a name="l09262"></a>09262                              addr_string,
<a name="l09263"></a>09263                              filter_string,
<a name="l09264"></a>09264                              cond_string, extra_string,
<a name="l09265"></a>09265                              type, disposition,
<a name="l09266"></a>09266                              thread, task, ignore_count, ops,
<a name="l09267"></a>09267                              from_tty, enabled, <span class="keyword">internal</span>, flags,
<a name="l09268"></a>09268                              canonical-&gt;<a class="code" href="structlinespec__result.html#ae890c0bedee5c8dec0bf977bb4c3b1bc">special_display</a>);
<a name="l09269"></a>09269       <a class="code" href="cleanups_8c.html#a5ec3987bf995edcc44def9e17ada6eba">discard_cleanups</a> (inner);
<a name="l09270"></a>09270     }
<a name="l09271"></a>09271 }
<a name="l09272"></a>09272 
<a name="l09273"></a>09273 <span class="comment">/* Parse ADDRESS which is assumed to be a SAL specification possibly</span>
<a name="l09274"></a>09274 <span class="comment">   followed by conditionals.  On return, SALS contains an array of SAL</span>
<a name="l09275"></a>09275 <span class="comment">   addresses found.  ADDR_STRING contains a vector of (canonical)</span>
<a name="l09276"></a>09276 <span class="comment">   address strings.  ADDRESS points to the end of the SAL.</span>
<a name="l09277"></a>09277 <span class="comment"></span>
<a name="l09278"></a>09278 <span class="comment">   The array and the line spec strings are allocated on the heap, it is</span>
<a name="l09279"></a>09279 <span class="comment">   the caller&#39;s responsibility to free them.  */</span>
<a name="l09280"></a>09280 
<a name="l09281"></a>09281 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l09282"></a>09282 parse_breakpoint_sals (<span class="keywordtype">char</span> **address,
<a name="l09283"></a>09283                        <span class="keyword">struct</span> <a class="code" href="structlinespec__result.html">linespec_result</a> *canonical)
<a name="l09284"></a>09284 {
<a name="l09285"></a>09285   <span class="comment">/* If no arg given, or if first arg is &#39;if &#39;, use the default</span>
<a name="l09286"></a>09286 <span class="comment">     breakpoint.  */</span>
<a name="l09287"></a>09287   <span class="keywordflow">if</span> ((*address) == NULL
<a name="l09288"></a>09288       || (strncmp ((*address), <span class="stringliteral">&quot;if&quot;</span>, 2) == 0 &amp;&amp; isspace ((*address)[2])))
<a name="l09289"></a>09289     {
<a name="l09290"></a>09290       <span class="comment">/* The last displayed codepoint, if it&#39;s valid, is our default breakpoint</span>
<a name="l09291"></a>09291 <span class="comment">         address.  */</span>
<a name="l09292"></a>09292       <span class="keywordflow">if</span> (<a class="code" href="stack_8c.html#a47beab727091bf3c0ed6747aa51e88a4">last_displayed_sal_is_valid</a> ())
<a name="l09293"></a>09293         {
<a name="l09294"></a>09294           <span class="keyword">struct </span><a class="code" href="structlinespec__sals.html">linespec_sals</a> lsal;
<a name="l09295"></a>09295           <span class="keyword">struct </span><a class="code" href="structsymtab__and__line.html">symtab_and_line</a> sal;
<a name="l09296"></a>09296           <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> <a class="code" href="structsymtab__and__line.html#a77665fa461ad187cb755efa256ba44d7">pc</a>;
<a name="l09297"></a>09297 
<a name="l09298"></a>09298           <a class="code" href="symtab_8c.html#aca3a01a4f0e1a09f99e8308faecc9028">init_sal</a> (&amp;sal);              <span class="comment">/* Initialize to zeroes.  */</span>
<a name="l09299"></a>09299           lsal.<a class="code" href="structlinespec__sals.html#a34ac2e438b2835722c998f409c85dcee">sals</a>.<a class="code" href="structsymtabs__and__lines.html#ab601f48fdf29c3b190ba068f57983df4">sals</a> = (<span class="keyword">struct </span><a class="code" href="structsymtab__and__line.html">symtab_and_line</a> *)
<a name="l09300"></a>09300             <a class="code" href="common-utils_8c.html#a634d6cd850bb831afebc499579303b3b">xmalloc</a> (<span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structsymtab__and__line.html">symtab_and_line</a>));
<a name="l09301"></a>09301 
<a name="l09302"></a>09302           <span class="comment">/* Set sal&#39;s pspace, pc, symtab, and line to the values</span>
<a name="l09303"></a>09303 <span class="comment">             corresponding to the last call to print_frame_info.</span>
<a name="l09304"></a>09304 <span class="comment">             Be sure to reinitialize LINE with NOTCURRENT == 0</span>
<a name="l09305"></a>09305 <span class="comment">             as the breakpoint line number is inappropriate otherwise.</span>
<a name="l09306"></a>09306 <span class="comment">             find_pc_line would adjust PC, re-set it back.  */</span>
<a name="l09307"></a>09307           <a class="code" href="stack_8c.html#a1dd36b19717f12efb7b06cc658ce085f">get_last_displayed_sal</a> (&amp;sal);
<a name="l09308"></a>09308           pc = sal.<a class="code" href="structsymtab__and__line.html#a77665fa461ad187cb755efa256ba44d7">pc</a>;
<a name="l09309"></a>09309           sal = <a class="code" href="symtab_8c.html#ad9bbd85700e3d7fa50e7ba0e32f37846">find_pc_line</a> (pc, 0);
<a name="l09310"></a>09310 
<a name="l09311"></a>09311           <span class="comment">/* &quot;break&quot; without arguments is equivalent to &quot;break *PC&quot;</span>
<a name="l09312"></a>09312 <span class="comment">             where PC is the last displayed codepoint&#39;s address.  So</span>
<a name="l09313"></a>09313 <span class="comment">             make sure to set sal.explicit_pc to prevent GDB from</span>
<a name="l09314"></a>09314 <span class="comment">             trying to expand the list of sals to include all other</span>
<a name="l09315"></a>09315 <span class="comment">             instances with the same symtab and line.  */</span>
<a name="l09316"></a>09316           sal.<a class="code" href="structsymtab__and__line.html#a77665fa461ad187cb755efa256ba44d7">pc</a> = <a class="code" href="structsymtab__and__line.html#a77665fa461ad187cb755efa256ba44d7">pc</a>;
<a name="l09317"></a>09317           sal.<a class="code" href="structsymtab__and__line.html#aa1cadecc3ac47f587f6725c2851a73ac">explicit_pc</a> = 1;
<a name="l09318"></a>09318 
<a name="l09319"></a>09319           lsal.<a class="code" href="structlinespec__sals.html#a34ac2e438b2835722c998f409c85dcee">sals</a>.<a class="code" href="structsymtabs__and__lines.html#ab601f48fdf29c3b190ba068f57983df4">sals</a>[0] = sal;
<a name="l09320"></a>09320           lsal.<a class="code" href="structlinespec__sals.html#a34ac2e438b2835722c998f409c85dcee">sals</a>.<a class="code" href="structsymtabs__and__lines.html#a1c8b832fc2f8c096c95144a2acedd36a">nelts</a> = 1;
<a name="l09321"></a>09321           lsal.<a class="code" href="structlinespec__sals.html#a5a6b2c7bb2c9b91d8077fb7186a6c466">canonical</a> = NULL;
<a name="l09322"></a>09322 
<a name="l09323"></a>09323           <a class="code" href="vec_8h.html#a8d090c0524726d00931070e0c438ba3f">VEC_safe_push</a> (<a class="code" href="structlinespec__sals.html">linespec_sals</a>, canonical-&gt;sals, &amp;lsal);
<a name="l09324"></a>09324         }
<a name="l09325"></a>09325       <span class="keywordflow">else</span>
<a name="l09326"></a>09326         <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;No default breakpoint address now.&quot;</span>));
<a name="l09327"></a>09327     }
<a name="l09328"></a>09328   <span class="keywordflow">else</span>
<a name="l09329"></a>09329     {
<a name="l09330"></a>09330       <span class="keyword">struct </span><a class="code" href="structsymtab__and__line.html">symtab_and_line</a> cursal = <a class="code" href="source_8c.html#a387b0906b103c4b3dec9d7cfdd41a9ad">get_current_source_symtab_and_line</a> ();
<a name="l09331"></a>09331 
<a name="l09332"></a>09332       <span class="comment">/* Force almost all breakpoints to be in terms of the</span>
<a name="l09333"></a>09333 <span class="comment">         current_source_symtab (which is decode_line_1&#39;s default).</span>
<a name="l09334"></a>09334 <span class="comment">         This should produce the results we want almost all of the</span>
<a name="l09335"></a>09335 <span class="comment">         time while leaving default_breakpoint_* alone.</span>
<a name="l09336"></a>09336 <span class="comment"></span>
<a name="l09337"></a>09337 <span class="comment">         ObjC: However, don&#39;t match an Objective-C method name which</span>
<a name="l09338"></a>09338 <span class="comment">         may have a &#39;+&#39; or &#39;-&#39; succeeded by a &#39;[&#39;.  */</span>
<a name="l09339"></a>09339       <span class="keywordflow">if</span> (<a class="code" href="stack_8c.html#a47beab727091bf3c0ed6747aa51e88a4">last_displayed_sal_is_valid</a> ()
<a name="l09340"></a>09340           &amp;&amp; (!cursal.<a class="code" href="structsymtab__and__line.html#a74216e171a96d8bcaab43fe69b49c599">symtab</a>
<a name="l09341"></a>09341               || ((<a class="code" href="gdb__string_8h.html#adf46aa8f2e08cfb505868bbfc88b5fd4">strchr</a> (<span class="stringliteral">&quot;+-&quot;</span>, (*address)[0]) != NULL)
<a name="l09342"></a>09342                   &amp;&amp; ((*address)[1] != <span class="charliteral">&#39;[&#39;</span>))))
<a name="l09343"></a>09343         <a class="code" href="linespec_8c.html#af57ff2f3f7a08d8b7f1d8c1fb3f24e12">decode_line_full</a> (address, <a class="code" href="linespec_8h.html#a66db0c56cdf6b7d07a996c374a0572caadb5b3965c89f02bfa79f8871fde72588">DECODE_LINE_FUNFIRSTLINE</a>,
<a name="l09344"></a>09344                           <a class="code" href="stack_8c.html#afdef12055c64d642f37c595fc63be5f2">get_last_displayed_symtab</a> (),
<a name="l09345"></a>09345                           <a class="code" href="stack_8c.html#a94a7a8437ec860efe5c514ed72cae337">get_last_displayed_line</a> (),
<a name="l09346"></a>09346                           canonical, NULL, NULL);
<a name="l09347"></a>09347       <span class="keywordflow">else</span>
<a name="l09348"></a>09348         <a class="code" href="linespec_8c.html#af57ff2f3f7a08d8b7f1d8c1fb3f24e12">decode_line_full</a> (address, <a class="code" href="linespec_8h.html#a66db0c56cdf6b7d07a996c374a0572caadb5b3965c89f02bfa79f8871fde72588">DECODE_LINE_FUNFIRSTLINE</a>,
<a name="l09349"></a>09349                           cursal.<a class="code" href="structsymtab__and__line.html#a74216e171a96d8bcaab43fe69b49c599">symtab</a>, cursal.<a class="code" href="structsymtab__and__line.html#a6a0468be675b9ac19a5b3ef26f471eaf">line</a>, canonical, NULL, NULL);
<a name="l09350"></a>09350     }
<a name="l09351"></a>09351 }
<a name="l09352"></a>09352 
<a name="l09353"></a>09353 
<a name="l09354"></a>09354 <span class="comment">/* Convert each SAL into a real PC.  Verify that the PC can be</span>
<a name="l09355"></a>09355 <span class="comment">   inserted as a breakpoint.  If it can&#39;t throw an error.  */</span>
<a name="l09356"></a>09356 
<a name="l09357"></a>09357 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l09358"></a>09358 breakpoint_sals_to_pc (<span class="keyword">struct</span> <a class="code" href="structsymtabs__and__lines.html">symtabs_and_lines</a> *sals)
<a name="l09359"></a>09359 {    
<a name="l09360"></a>09360   <span class="keywordtype">int</span> i;
<a name="l09361"></a>09361 
<a name="l09362"></a>09362   <span class="keywordflow">for</span> (i = 0; i &lt; sals-&gt;<a class="code" href="structsymtabs__and__lines.html#a1c8b832fc2f8c096c95144a2acedd36a">nelts</a>; i++)
<a name="l09363"></a>09363     <a class="code" href="breakpoint_8c.html#a4ca5af087eb50f4017f1eac8be554088">resolve_sal_pc</a> (&amp;sals-&gt;<a class="code" href="structsymtabs__and__lines.html#ab601f48fdf29c3b190ba068f57983df4">sals</a>[i]);
<a name="l09364"></a>09364 }
<a name="l09365"></a>09365 
<a name="l09366"></a>09366 <span class="comment">/* Fast tracepoints may have restrictions on valid locations.  For</span>
<a name="l09367"></a>09367 <span class="comment">   instance, a fast tracepoint using a jump instead of a trap will</span>
<a name="l09368"></a>09368 <span class="comment">   likely have to overwrite more bytes than a trap would, and so can</span>
<a name="l09369"></a>09369 <span class="comment">   only be placed where the instruction is longer than the jump, or a</span>
<a name="l09370"></a>09370 <span class="comment">   multi-instruction sequence does not have a jump into the middle of</span>
<a name="l09371"></a>09371 <span class="comment">   it, etc.  */</span>
<a name="l09372"></a>09372 
<a name="l09373"></a>09373 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l09374"></a>09374 check_fast_tracepoint_sals (<span class="keyword">struct</span> gdbarch *gdbarch,
<a name="l09375"></a>09375                             <span class="keyword">struct</span> <a class="code" href="structsymtabs__and__lines.html">symtabs_and_lines</a> *sals)
<a name="l09376"></a>09376 {
<a name="l09377"></a>09377   <span class="keywordtype">int</span> i, rslt;
<a name="l09378"></a>09378   <span class="keyword">struct </span><a class="code" href="structsymtab__and__line.html">symtab_and_line</a> *sal;
<a name="l09379"></a>09379   <span class="keywordtype">char</span> *msg;
<a name="l09380"></a>09380   <span class="keyword">struct </span>cleanup *old_chain;
<a name="l09381"></a>09381 
<a name="l09382"></a>09382   <span class="keywordflow">for</span> (i = 0; i &lt; sals-&gt;<a class="code" href="structsymtabs__and__lines.html#a1c8b832fc2f8c096c95144a2acedd36a">nelts</a>; i++)
<a name="l09383"></a>09383     {
<a name="l09384"></a>09384       <span class="keyword">struct </span>gdbarch *sarch;
<a name="l09385"></a>09385 
<a name="l09386"></a>09386       sal = &amp;sals-&gt;<a class="code" href="structsymtabs__and__lines.html#ab601f48fdf29c3b190ba068f57983df4">sals</a>[i];
<a name="l09387"></a>09387 
<a name="l09388"></a>09388       sarch = <a class="code" href="breakpoint_8c.html#ab44e7bca7511390e3baade6daeecf6cd">get_sal_arch</a> (*sal);
<a name="l09389"></a>09389       <span class="comment">/* We fall back to GDBARCH if there is no architecture</span>
<a name="l09390"></a>09390 <span class="comment">         associated with SAL.  */</span>
<a name="l09391"></a>09391       <span class="keywordflow">if</span> (sarch == NULL)
<a name="l09392"></a>09392         sarch = gdbarch;
<a name="l09393"></a>09393       rslt = <a class="code" href="gdbarch_8c.html#aa9ed877d65ac9d37d0f47f8a47ad7d39">gdbarch_fast_tracepoint_valid_at</a> (sarch, sal-&gt;<a class="code" href="structsymtab__and__line.html#a77665fa461ad187cb755efa256ba44d7">pc</a>,
<a name="l09394"></a>09394                                                NULL, &amp;msg);
<a name="l09395"></a>09395       old_chain = <a class="code" href="cleanups_8c.html#a3d418f8af424aec399898c2d48b26224">make_cleanup</a> (<a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a>, msg);
<a name="l09396"></a>09396 
<a name="l09397"></a>09397       <span class="keywordflow">if</span> (!rslt)
<a name="l09398"></a>09398         <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;May not have a fast tracepoint at 0x%s%s&quot;</span>),
<a name="l09399"></a>09399                <a class="code" href="utils_8c.html#ab5c76d72090f01d3848b63dda4e37d1c">paddress</a> (sarch, sal-&gt;<a class="code" href="structsymtab__and__line.html#a77665fa461ad187cb755efa256ba44d7">pc</a>), (msg ? msg : <span class="stringliteral">&quot;&quot;</span>));
<a name="l09400"></a>09400 
<a name="l09401"></a>09401       <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (old_chain);
<a name="l09402"></a>09402     }
<a name="l09403"></a>09403 }
<a name="l09404"></a>09404 
<a name="l09405"></a>09405 <span class="comment">/* Issue an invalid thread ID error.  */</span>
<a name="l09406"></a>09406 
<a name="l09407"></a>09407 <span class="keyword">static</span> <span class="keywordtype">void</span> ATTRIBUTE_NORETURN
<a name="l09408"></a>09408 invalid_thread_id_error (<span class="keywordtype">int</span> <span class="keywordtype">id</span>)
<a name="l09409"></a>09409 {
<a name="l09410"></a>09410   <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Unknown thread %d.&quot;</span>), <span class="keywordtype">id</span>);
<a name="l09411"></a>09411 }
<a name="l09412"></a>09412 
<a name="l09413"></a>09413 <span class="comment">/* Given TOK, a string specification of condition and thread, as</span>
<a name="l09414"></a>09414 <span class="comment">   accepted by the &#39;break&#39; command, extract the condition</span>
<a name="l09415"></a>09415 <span class="comment">   string and thread number and set *COND_STRING and *THREAD.</span>
<a name="l09416"></a>09416 <span class="comment">   PC identifies the context at which the condition should be parsed.</span>
<a name="l09417"></a>09417 <span class="comment">   If no condition is found, *COND_STRING is set to NULL.</span>
<a name="l09418"></a>09418 <span class="comment">   If no thread is found, *THREAD is set to -1.  */</span>
<a name="l09419"></a>09419 
<a name="l09420"></a>09420 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l09421"></a>09421 find_condition_and_thread (<span class="keyword">const</span> <span class="keywordtype">char</span> *tok, <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> pc,
<a name="l09422"></a>09422                            <span class="keywordtype">char</span> **cond_string, <span class="keywordtype">int</span> *thread, <span class="keywordtype">int</span> *task,
<a name="l09423"></a>09423                            <span class="keywordtype">char</span> **rest)
<a name="l09424"></a>09424 {
<a name="l09425"></a>09425   *cond_string = NULL;
<a name="l09426"></a>09426   *thread = -1;
<a name="l09427"></a>09427   *task = 0;
<a name="l09428"></a>09428   *rest = NULL;
<a name="l09429"></a>09429 
<a name="l09430"></a>09430   <span class="keywordflow">while</span> (tok &amp;&amp; *tok)
<a name="l09431"></a>09431     {
<a name="l09432"></a>09432       <span class="keyword">const</span> <span class="keywordtype">char</span> *end_tok;
<a name="l09433"></a>09433       <span class="keywordtype">int</span> toklen;
<a name="l09434"></a>09434       <span class="keyword">const</span> <span class="keywordtype">char</span> *cond_start = NULL;
<a name="l09435"></a>09435       <span class="keyword">const</span> <span class="keywordtype">char</span> *cond_end = NULL;
<a name="l09436"></a>09436 
<a name="l09437"></a>09437       tok = <a class="code" href="cli-utils_8c.html#aad7df612354d99c740a7ea12eccd3848">skip_spaces_const</a> (tok);
<a name="l09438"></a>09438 
<a name="l09439"></a>09439       <span class="keywordflow">if</span> ((*tok == <span class="charliteral">&#39;&quot;&#39;</span> || *tok == <span class="charliteral">&#39;,&#39;</span>) &amp;&amp; rest)
<a name="l09440"></a>09440         {
<a name="l09441"></a>09441           *rest = <a class="code" href="common-utils_8c.html#a5f388f89054b57d850779d7d71bc4d1c">savestring</a> (tok, strlen (tok));
<a name="l09442"></a>09442           <span class="keywordflow">return</span>;
<a name="l09443"></a>09443         }
<a name="l09444"></a>09444 
<a name="l09445"></a>09445       end_tok = <a class="code" href="cli-utils_8c.html#a698bb5c8505ebecdcca9a193c18b7c8a">skip_to_space_const</a> (tok);
<a name="l09446"></a>09446 
<a name="l09447"></a>09447       toklen = end_tok - tok;
<a name="l09448"></a>09448 
<a name="l09449"></a>09449       <span class="keywordflow">if</span> (toklen &gt;= 1 &amp;&amp; strncmp (tok, <span class="stringliteral">&quot;if&quot;</span>, toklen) == 0)
<a name="l09450"></a>09450         {
<a name="l09451"></a>09451           <span class="keyword">struct </span><a class="code" href="structexpression.html">expression</a> *expr;
<a name="l09452"></a>09452 
<a name="l09453"></a>09453           tok = cond_start = end_tok + 1;
<a name="l09454"></a>09454           expr = <a class="code" href="expression_8h.html#abdad295cc4b5351f6e6ec024ab665475">parse_exp_1</a> (&amp;tok, pc, <a class="code" href="block_8c.html#a35aadf82f92cb4a47ec068dba0e1b36c">block_for_pc</a> (pc), 0);
<a name="l09455"></a>09455           <a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a> (expr);
<a name="l09456"></a>09456           cond_end = tok;
<a name="l09457"></a>09457           *cond_string = <a class="code" href="common-utils_8c.html#a5f388f89054b57d850779d7d71bc4d1c">savestring</a> (cond_start, cond_end - cond_start);
<a name="l09458"></a>09458         }
<a name="l09459"></a>09459       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (toklen &gt;= 1 &amp;&amp; strncmp (tok, <span class="stringliteral">&quot;thread&quot;</span>, toklen) == 0)
<a name="l09460"></a>09460         {
<a name="l09461"></a>09461           <span class="keywordtype">char</span> *tmptok;
<a name="l09462"></a>09462 
<a name="l09463"></a>09463           tok = end_tok + 1;
<a name="l09464"></a>09464           *thread = strtol (tok, &amp;tmptok, 0);
<a name="l09465"></a>09465           <span class="keywordflow">if</span> (tok == tmptok)
<a name="l09466"></a>09466             <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Junk after thread keyword.&quot;</span>));
<a name="l09467"></a>09467           <span class="keywordflow">if</span> (!<a class="code" href="gdbthread_8h.html#aeadadfd9ed468cfe8d004dcb4b31f471">valid_thread_id</a> (*thread))
<a name="l09468"></a>09468             invalid_thread_id_error (*thread);
<a name="l09469"></a>09469           tok = tmptok;
<a name="l09470"></a>09470         }
<a name="l09471"></a>09471       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (toklen &gt;= 1 &amp;&amp; strncmp (tok, <span class="stringliteral">&quot;task&quot;</span>, toklen) == 0)
<a name="l09472"></a>09472         {
<a name="l09473"></a>09473           <span class="keywordtype">char</span> *tmptok;
<a name="l09474"></a>09474 
<a name="l09475"></a>09475           tok = end_tok + 1;
<a name="l09476"></a>09476           *task = strtol (tok, &amp;tmptok, 0);
<a name="l09477"></a>09477           <span class="keywordflow">if</span> (tok == tmptok)
<a name="l09478"></a>09478             <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Junk after task keyword.&quot;</span>));
<a name="l09479"></a>09479           <span class="keywordflow">if</span> (!<a class="code" href="ada-lang_8h.html#ace31426c7019a8c931fc9479a9e22441">valid_task_id</a> (*task))
<a name="l09480"></a>09480             <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Unknown task %d.&quot;</span>), *task);
<a name="l09481"></a>09481           tok = tmptok;
<a name="l09482"></a>09482         }
<a name="l09483"></a>09483       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rest)
<a name="l09484"></a>09484         {
<a name="l09485"></a>09485           *rest = <a class="code" href="common-utils_8c.html#a5f388f89054b57d850779d7d71bc4d1c">savestring</a> (tok, strlen (tok));
<a name="l09486"></a>09486           <span class="keywordflow">return</span>;
<a name="l09487"></a>09487         }
<a name="l09488"></a>09488       <span class="keywordflow">else</span>
<a name="l09489"></a>09489         <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Junk at end of arguments.&quot;</span>));
<a name="l09490"></a>09490     }
<a name="l09491"></a>09491 }
<a name="l09492"></a>09492 
<a name="l09493"></a>09493 <span class="comment">/* Decode a static tracepoint marker spec.  */</span>
<a name="l09494"></a>09494 
<a name="l09495"></a>09495 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structsymtabs__and__lines.html">symtabs_and_lines</a>
<a name="l09496"></a>09496 decode_static_tracepoint_spec (char **arg_p)
<a name="l09497"></a>09497 {
<a name="l09498"></a>09498   <a class="code" href="vec_8h.html#ab084f6f29fcf16a6b15d15feb653d414">VEC</a>(<a class="code" href="structstatic__tracepoint__marker.html">static_tracepoint_marker_p</a>) *markers = NULL;
<a name="l09499"></a>09499   <span class="keyword">struct </span><a class="code" href="structsymtabs__and__lines.html">symtabs_and_lines</a> sals;
<a name="l09500"></a>09500   <span class="keyword">struct </span>cleanup *old_chain;
<a name="l09501"></a>09501   <span class="keywordtype">char</span> *p = &amp;(*arg_p)[3];
<a name="l09502"></a>09502   <span class="keywordtype">char</span> *endp;
<a name="l09503"></a>09503   <span class="keywordtype">char</span> *marker_str;
<a name="l09504"></a>09504   <span class="keywordtype">int</span> i;
<a name="l09505"></a>09505 
<a name="l09506"></a>09506   p = <a class="code" href="cli-utils_8c.html#afa70bcaee54d487b4412d2a7a5a0c8fa">skip_spaces</a> (p);
<a name="l09507"></a>09507 
<a name="l09508"></a>09508   endp = <a class="code" href="cli-utils_8h.html#a72436dcbbbe357dbd26e02588a6d3808">skip_to_space</a> (p);
<a name="l09509"></a>09509 
<a name="l09510"></a>09510   marker_str = <a class="code" href="common-utils_8c.html#a5f388f89054b57d850779d7d71bc4d1c">savestring</a> (p, endp - p);
<a name="l09511"></a>09511   old_chain = <a class="code" href="cleanups_8c.html#a3d418f8af424aec399898c2d48b26224">make_cleanup</a> (<a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a>, marker_str);
<a name="l09512"></a>09512 
<a name="l09513"></a>09513   markers = <a class="code" href="target_8h.html#a0a86c51b45e40100c97b3dd4540455e8">target_static_tracepoint_markers_by_strid</a> (marker_str);
<a name="l09514"></a>09514   <span class="keywordflow">if</span> (<a class="code" href="vec_8h.html#ac9981d313a5e114db0e05b7b9cd16319">VEC_empty</a>(<a class="code" href="structstatic__tracepoint__marker.html">static_tracepoint_marker_p</a>, markers))
<a name="l09515"></a>09515     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;No known static tracepoint marker named %s&quot;</span>), marker_str);
<a name="l09516"></a>09516 
<a name="l09517"></a>09517   sals.<a class="code" href="structsymtabs__and__lines.html#a1c8b832fc2f8c096c95144a2acedd36a">nelts</a> = <a class="code" href="vec_8h.html#a844523bba6d0565ef73a0f4a63e48d19">VEC_length</a>(<a class="code" href="structstatic__tracepoint__marker.html">static_tracepoint_marker_p</a>, markers);
<a name="l09518"></a>09518   sals.<a class="code" href="structsymtabs__and__lines.html#ab601f48fdf29c3b190ba068f57983df4">sals</a> = <a class="code" href="common-utils_8c.html#a634d6cd850bb831afebc499579303b3b">xmalloc</a> (<span class="keyword">sizeof</span> *sals.<a class="code" href="structsymtabs__and__lines.html#ab601f48fdf29c3b190ba068f57983df4">sals</a> * sals.<a class="code" href="structsymtabs__and__lines.html#a1c8b832fc2f8c096c95144a2acedd36a">nelts</a>);
<a name="l09519"></a>09519 
<a name="l09520"></a>09520   <span class="keywordflow">for</span> (i = 0; i &lt; sals.<a class="code" href="structsymtabs__and__lines.html#a1c8b832fc2f8c096c95144a2acedd36a">nelts</a>; i++)
<a name="l09521"></a>09521     {
<a name="l09522"></a>09522       <span class="keyword">struct </span><a class="code" href="structstatic__tracepoint__marker.html">static_tracepoint_marker</a> *marker;
<a name="l09523"></a>09523 
<a name="l09524"></a>09524       marker = <a class="code" href="vec_8h.html#a49c128c353995ea8fca27be70829ca52">VEC_index</a> (<a class="code" href="structstatic__tracepoint__marker.html">static_tracepoint_marker_p</a>, markers, i);
<a name="l09525"></a>09525 
<a name="l09526"></a>09526       <a class="code" href="symtab_8c.html#aca3a01a4f0e1a09f99e8308faecc9028">init_sal</a> (&amp;sals.<a class="code" href="structsymtabs__and__lines.html#ab601f48fdf29c3b190ba068f57983df4">sals</a>[i]);
<a name="l09527"></a>09527 
<a name="l09528"></a>09528       sals.<a class="code" href="structsymtabs__and__lines.html#ab601f48fdf29c3b190ba068f57983df4">sals</a>[i] = <a class="code" href="symtab_8c.html#ad9bbd85700e3d7fa50e7ba0e32f37846">find_pc_line</a> (marker-&gt;<a class="code" href="structstatic__tracepoint__marker.html#aa5ab18cb7b106119a67b22528f98f89d">address</a>, 0);
<a name="l09529"></a>09529       sals.<a class="code" href="structsymtabs__and__lines.html#ab601f48fdf29c3b190ba068f57983df4">sals</a>[i].<a class="code" href="structsymtab__and__line.html#a77665fa461ad187cb755efa256ba44d7">pc</a> = marker-&gt;<a class="code" href="structstatic__tracepoint__marker.html#aa5ab18cb7b106119a67b22528f98f89d">address</a>;
<a name="l09530"></a>09530 
<a name="l09531"></a>09531       <a class="code" href="tracepoint_8c.html#a6eb95e5022deae349e0523ceb87e6252">release_static_tracepoint_marker</a> (marker);
<a name="l09532"></a>09532     }
<a name="l09533"></a>09533 
<a name="l09534"></a>09534   <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (old_chain);
<a name="l09535"></a>09535 
<a name="l09536"></a>09536   *arg_p = endp;
<a name="l09537"></a>09537   <span class="keywordflow">return</span> sals;
<a name="l09538"></a>09538 }
<a name="l09539"></a>09539 
<a name="l09540"></a>09540 <span class="comment">/* Set a breakpoint.  This function is shared between CLI and MI</span>
<a name="l09541"></a>09541 <span class="comment">   functions for setting a breakpoint.  This function has two major</span>
<a name="l09542"></a>09542 <span class="comment">   modes of operations, selected by the PARSE_ARG parameter.  If</span>
<a name="l09543"></a>09543 <span class="comment">   non-zero, the function will parse ARG, extracting location,</span>
<a name="l09544"></a>09544 <span class="comment">   condition, thread and extra string.  Otherwise, ARG is just the</span>
<a name="l09545"></a>09545 <span class="comment">   breakpoint&#39;s location, with condition, thread, and extra string</span>
<a name="l09546"></a>09546 <span class="comment">   specified by the COND_STRING, THREAD and EXTRA_STRING parameters.</span>
<a name="l09547"></a>09547 <span class="comment">   If INTERNAL is non-zero, the breakpoint number will be allocated</span>
<a name="l09548"></a>09548 <span class="comment">   from the internal breakpoint count.  Returns true if any breakpoint</span>
<a name="l09549"></a>09549 <span class="comment">   was created; false otherwise.  */</span>
<a name="l09550"></a>09550 
<a name="l09551"></a>09551 <span class="keywordtype">int</span>
<a name="l09552"></a><a class="code" href="breakpoint_8h.html#a43a433e5d660881f5748b816678de093">09552</a> <a class="code" href="breakpoint_8c.html#a9f0540734ee04440fbb9f6c3c1558d0f">create_breakpoint</a> (<span class="keyword">struct</span> gdbarch *gdbarch,
<a name="l09553"></a>09553                    <span class="keywordtype">char</span> *arg, <span class="keywordtype">char</span> *cond_string,
<a name="l09554"></a>09554                    <span class="keywordtype">int</span> thread, <span class="keywordtype">char</span> *extra_string,
<a name="l09555"></a>09555                    <span class="keywordtype">int</span> parse_arg,
<a name="l09556"></a>09556                    <span class="keywordtype">int</span> tempflag, <span class="keyword">enum</span> bptype type_wanted,
<a name="l09557"></a>09557                    <span class="keywordtype">int</span> ignore_count,
<a name="l09558"></a>09558                    <span class="keyword">enum</span> <a class="code" href="defs_8h.html#a7e28c5d9363062b4fd5eec5fed14448f">auto_boolean</a> pending_break_support,
<a name="l09559"></a>09559                    <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structbreakpoint__ops.html">breakpoint_ops</a> *ops,
<a name="l09560"></a>09560                    <span class="keywordtype">int</span> from_tty, <span class="keywordtype">int</span> enabled, <span class="keywordtype">int</span> <span class="keyword">internal</span>,
<a name="l09561"></a>09561                    <span class="keywordtype">unsigned</span> flags)
<a name="l09562"></a>09562 {
<a name="l09563"></a>09563   <span class="keyword">volatile</span> <span class="keyword">struct </span><a class="code" href="structgdb__exception.html">gdb_exception</a> e;
<a name="l09564"></a>09564   <span class="keywordtype">char</span> *copy_arg = NULL;
<a name="l09565"></a>09565   <span class="keywordtype">char</span> *addr_start = arg;
<a name="l09566"></a>09566   <span class="keyword">struct </span><a class="code" href="structlinespec__result.html">linespec_result</a> canonical;
<a name="l09567"></a>09567   <span class="keyword">struct </span>cleanup *old_chain;
<a name="l09568"></a>09568   <span class="keyword">struct </span>cleanup *bkpt_chain = NULL;
<a name="l09569"></a>09569   <span class="keywordtype">int</span> <a class="code" href="structpending.html">pending</a> = 0;
<a name="l09570"></a>09570   <span class="keywordtype">int</span> task = 0;
<a name="l09571"></a>09571   <span class="keywordtype">int</span> prev_bkpt_count = breakpoint_count;
<a name="l09572"></a>09572 
<a name="l09573"></a>09573   <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (ops != NULL);
<a name="l09574"></a>09574 
<a name="l09575"></a>09575   <a class="code" href="linespec_8c.html#a7264361d0a42e631634188c78dd8a96e">init_linespec_result</a> (&amp;canonical);
<a name="l09576"></a>09576 
<a name="l09577"></a>09577   <a class="code" href="exceptions_8h.html#aef4514ee39b9305fddee27f49c7c34eb">TRY_CATCH</a> (e, <a class="code" href="exceptions_8h.html#abfa3a3b99557b11f5766baf69465fdf6ab50fde886a7de8c013bf2bd4e7c073a4">RETURN_MASK_ALL</a>)
<a name="l09578"></a>09578     {
<a name="l09579"></a>09579       ops-&gt;<a class="code" href="structbreakpoint__ops.html#a5d8cd9819fd3e8131e0a2627a1e3b81d">create_sals_from_address</a> (&amp;arg, &amp;canonical, type_wanted,
<a name="l09580"></a>09580                                      addr_start, &amp;copy_arg);
<a name="l09581"></a>09581     }
<a name="l09582"></a>09582 
<a name="l09583"></a>09583   <span class="comment">/* If caller is interested in rc value from parse, set value.  */</span>
<a name="l09584"></a>09584   <span class="keywordflow">switch</span> (e.<a class="code" href="structgdb__exception.html#ae0e14189c63f830024865d557c1122cc">reason</a>)
<a name="l09585"></a>09585     {
<a name="l09586"></a>09586     <span class="keywordflow">case</span> <a class="code" href="exceptions_8h.html#acc42076253600be964e110149b458971aa680a8f84a2a0a0b668ad9c008750f75">GDB_NO_ERROR</a>:
<a name="l09587"></a>09587       <span class="keywordflow">if</span> (<a class="code" href="vec_8h.html#ac9981d313a5e114db0e05b7b9cd16319">VEC_empty</a> (<a class="code" href="structlinespec__sals.html">linespec_sals</a>, canonical.sals))
<a name="l09588"></a>09588         <span class="keywordflow">return</span> 0;
<a name="l09589"></a>09589       <span class="keywordflow">break</span>;
<a name="l09590"></a>09590     <span class="keywordflow">case</span> <a class="code" href="exceptions_8h.html#a8de7b184dfb46cffcd6408b0a5dac921a0d69fbc6071c40de52479590e5ac5121">RETURN_ERROR</a>:
<a name="l09591"></a>09591       <span class="keywordflow">switch</span> (e.<a class="code" href="structgdb__exception.html#ab5a701a197af7b5c953242d029c18e75">error</a>)
<a name="l09592"></a>09592         {
<a name="l09593"></a>09593         <span class="keywordflow">case</span> <a class="code" href="exceptions_8h.html#acc42076253600be964e110149b458971a513a53522eb4741e8910f010e0ff9530">NOT_FOUND_ERROR</a>:
<a name="l09594"></a>09594 
<a name="l09595"></a>09595           <span class="comment">/* If pending breakpoint support is turned off, throw</span>
<a name="l09596"></a>09596 <span class="comment">             error.  */</span>
<a name="l09597"></a>09597 
<a name="l09598"></a>09598           <span class="keywordflow">if</span> (pending_break_support == <a class="code" href="defs_8h.html#a7e28c5d9363062b4fd5eec5fed14448fad5edac705ebbe17f475a693d6b00141c">AUTO_BOOLEAN_FALSE</a>)
<a name="l09599"></a>09599             <a class="code" href="exceptions_8c.html#a541d1b545da68efe4f8b729a945f83e7">throw_exception</a> (e);
<a name="l09600"></a>09600 
<a name="l09601"></a>09601           <a class="code" href="exceptions_8c.html#ac90532089cc9e4b0e3c57798a13887d3">exception_print</a> (<a class="code" href="main_8c.html#a2a1dea1e551cadb9541353a004193a47">gdb_stderr</a>, e);
<a name="l09602"></a>09602 
<a name="l09603"></a>09603           <span class="comment">/* If pending breakpoint support is auto query and the user</span>
<a name="l09604"></a>09604 <span class="comment">             selects no, then simply return the error code.  */</span>
<a name="l09605"></a>09605           <span class="keywordflow">if</span> (pending_break_support == <a class="code" href="defs_8h.html#a7e28c5d9363062b4fd5eec5fed14448fa48f3bffd79907d65a7ee3aee7aabc163">AUTO_BOOLEAN_AUTO</a>
<a name="l09606"></a>09606               &amp;&amp; !<a class="code" href="utils_8c.html#a26355dbee7d8a1217b9a14471bde63ec">nquery</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Make %s pending on future shared library load? &quot;</span>),
<a name="l09607"></a>09607                           bptype_string (type_wanted)))
<a name="l09608"></a>09608             <span class="keywordflow">return</span> 0;
<a name="l09609"></a>09609 
<a name="l09610"></a>09610           <span class="comment">/* At this point, either the user was queried about setting</span>
<a name="l09611"></a>09611 <span class="comment">             a pending breakpoint and selected yes, or pending</span>
<a name="l09612"></a>09612 <span class="comment">             breakpoint behavior is on and thus a pending breakpoint</span>
<a name="l09613"></a>09613 <span class="comment">             is defaulted on behalf of the user.  */</span>
<a name="l09614"></a>09614           {
<a name="l09615"></a>09615             <span class="keyword">struct </span><a class="code" href="structlinespec__sals.html">linespec_sals</a> lsal;
<a name="l09616"></a>09616 
<a name="l09617"></a>09617             copy_arg = xstrdup (addr_start);
<a name="l09618"></a>09618             lsal.<a class="code" href="structlinespec__sals.html#a5a6b2c7bb2c9b91d8077fb7186a6c466">canonical</a> = xstrdup (copy_arg);
<a name="l09619"></a>09619             lsal.<a class="code" href="structlinespec__sals.html#a34ac2e438b2835722c998f409c85dcee">sals</a>.<a class="code" href="structsymtabs__and__lines.html#a1c8b832fc2f8c096c95144a2acedd36a">nelts</a> = 1;
<a name="l09620"></a>09620             lsal.<a class="code" href="structlinespec__sals.html#a34ac2e438b2835722c998f409c85dcee">sals</a>.<a class="code" href="structsymtabs__and__lines.html#ab601f48fdf29c3b190ba068f57983df4">sals</a> = XNEW (<span class="keyword">struct</span> <a class="code" href="structsymtab__and__line.html">symtab_and_line</a>);
<a name="l09621"></a>09621             <a class="code" href="symtab_8c.html#aca3a01a4f0e1a09f99e8308faecc9028">init_sal</a> (&amp;lsal.<a class="code" href="structlinespec__sals.html#a34ac2e438b2835722c998f409c85dcee">sals</a>.<a class="code" href="structsymtabs__and__lines.html#ab601f48fdf29c3b190ba068f57983df4">sals</a>[0]);
<a name="l09622"></a>09622             pending = 1;
<a name="l09623"></a>09623             <a class="code" href="vec_8h.html#a8d090c0524726d00931070e0c438ba3f">VEC_safe_push</a> (<a class="code" href="structlinespec__sals.html">linespec_sals</a>, canonical.sals, &amp;lsal);
<a name="l09624"></a>09624           }
<a name="l09625"></a>09625           <span class="keywordflow">break</span>;
<a name="l09626"></a>09626         <span class="keywordflow">default</span>:
<a name="l09627"></a>09627           <a class="code" href="exceptions_8c.html#a541d1b545da68efe4f8b729a945f83e7">throw_exception</a> (e);
<a name="l09628"></a>09628         }
<a name="l09629"></a>09629       <span class="keywordflow">break</span>;
<a name="l09630"></a>09630     <span class="keywordflow">default</span>:
<a name="l09631"></a>09631       <a class="code" href="exceptions_8c.html#a541d1b545da68efe4f8b729a945f83e7">throw_exception</a> (e);
<a name="l09632"></a>09632     }
<a name="l09633"></a>09633 
<a name="l09634"></a>09634   <span class="comment">/* Create a chain of things that always need to be cleaned up.  */</span>
<a name="l09635"></a>09635   old_chain = <a class="code" href="linespec_8c.html#ac681b7d9043443fa8be585a1fcf735bf">make_cleanup_destroy_linespec_result</a> (&amp;canonical);
<a name="l09636"></a>09636 
<a name="l09637"></a>09637   <span class="comment">/* ----------------------------- SNIP -----------------------------</span>
<a name="l09638"></a>09638 <span class="comment">     Anything added to the cleanup chain beyond this point is assumed</span>
<a name="l09639"></a>09639 <span class="comment">     to be part of a breakpoint.  If the breakpoint create succeeds</span>
<a name="l09640"></a>09640 <span class="comment">     then the memory is not reclaimed.  */</span>
<a name="l09641"></a>09641   bkpt_chain = <a class="code" href="cleanups_8c.html#a3d418f8af424aec399898c2d48b26224">make_cleanup</a> (<a class="code" href="cleanups_8c.html#a1ec2a3980c2be1f31f2142103d1f7abf">null_cleanup</a>, 0);
<a name="l09642"></a>09642 
<a name="l09643"></a>09643   <span class="comment">/* Resolve all line numbers to PC&#39;s and verify that the addresses</span>
<a name="l09644"></a>09644 <span class="comment">     are ok for the target.  */</span>
<a name="l09645"></a>09645   <span class="keywordflow">if</span> (!pending)
<a name="l09646"></a>09646     {
<a name="l09647"></a>09647       <span class="keywordtype">int</span> ix;
<a name="l09648"></a>09648       <span class="keyword">struct </span><a class="code" href="structlinespec__sals.html">linespec_sals</a> *iter;
<a name="l09649"></a>09649 
<a name="l09650"></a>09650       <span class="keywordflow">for</span> (ix = 0; <a class="code" href="vec_8h.html#ae7795b0c8e65f45eb49aac5ec2c0fa52">VEC_iterate</a> (<a class="code" href="structlinespec__sals.html">linespec_sals</a>, canonical.sals, ix, iter); ++ix)
<a name="l09651"></a>09651         breakpoint_sals_to_pc (&amp;iter-&gt;<a class="code" href="structlinespec__sals.html#a34ac2e438b2835722c998f409c85dcee">sals</a>);
<a name="l09652"></a>09652     }
<a name="l09653"></a>09653 
<a name="l09654"></a>09654   <span class="comment">/* Fast tracepoints may have additional restrictions on location.  */</span>
<a name="l09655"></a>09655   <span class="keywordflow">if</span> (!pending &amp;&amp; type_wanted == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa563d27bd02a1303a86081828b40002db">bp_fast_tracepoint</a>)
<a name="l09656"></a>09656     {
<a name="l09657"></a>09657       <span class="keywordtype">int</span> ix;
<a name="l09658"></a>09658       <span class="keyword">struct </span><a class="code" href="structlinespec__sals.html">linespec_sals</a> *iter;
<a name="l09659"></a>09659 
<a name="l09660"></a>09660       <span class="keywordflow">for</span> (ix = 0; <a class="code" href="vec_8h.html#ae7795b0c8e65f45eb49aac5ec2c0fa52">VEC_iterate</a> (<a class="code" href="structlinespec__sals.html">linespec_sals</a>, canonical.sals, ix, iter); ++ix)
<a name="l09661"></a>09661         check_fast_tracepoint_sals (gdbarch, &amp;iter-&gt;<a class="code" href="structlinespec__sals.html#a34ac2e438b2835722c998f409c85dcee">sals</a>);
<a name="l09662"></a>09662     }
<a name="l09663"></a>09663 
<a name="l09664"></a>09664   <span class="comment">/* Verify that condition can be parsed, before setting any</span>
<a name="l09665"></a>09665 <span class="comment">     breakpoints.  Allocate a separate condition expression for each</span>
<a name="l09666"></a>09666 <span class="comment">     breakpoint.  */</span>
<a name="l09667"></a>09667   <span class="keywordflow">if</span> (!pending)
<a name="l09668"></a>09668     {
<a name="l09669"></a>09669       <span class="keywordflow">if</span> (parse_arg)
<a name="l09670"></a>09670         {
<a name="l09671"></a>09671           <span class="keywordtype">char</span> *rest;
<a name="l09672"></a>09672           <span class="keyword">struct </span><a class="code" href="structlinespec__sals.html">linespec_sals</a> *lsal;
<a name="l09673"></a>09673 
<a name="l09674"></a>09674           lsal = <a class="code" href="vec_8h.html#a49c128c353995ea8fca27be70829ca52">VEC_index</a> (<a class="code" href="structlinespec__sals.html">linespec_sals</a>, canonical.sals, 0);
<a name="l09675"></a>09675 
<a name="l09676"></a>09676           <span class="comment">/* Here we only parse &#39;arg&#39; to separate condition</span>
<a name="l09677"></a>09677 <span class="comment">             from thread number, so parsing in context of first</span>
<a name="l09678"></a>09678 <span class="comment">             sal is OK.  When setting the breakpoint we&#39;ll</span>
<a name="l09679"></a>09679 <span class="comment">             re-parse it in context of each sal.  */</span>
<a name="l09680"></a>09680 
<a name="l09681"></a>09681           find_condition_and_thread (arg, lsal-&gt;<a class="code" href="structlinespec__sals.html#a34ac2e438b2835722c998f409c85dcee">sals</a>.<a class="code" href="structsymtabs__and__lines.html#ab601f48fdf29c3b190ba068f57983df4">sals</a>[0].<a class="code" href="structsymtab__and__line.html#a77665fa461ad187cb755efa256ba44d7">pc</a>, &amp;cond_string,
<a name="l09682"></a>09682                                      &amp;thread, &amp;task, &amp;rest);
<a name="l09683"></a>09683           <span class="keywordflow">if</span> (cond_string)
<a name="l09684"></a>09684             <a class="code" href="cleanups_8c.html#a3d418f8af424aec399898c2d48b26224">make_cleanup</a> (<a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a>, cond_string);
<a name="l09685"></a>09685           <span class="keywordflow">if</span> (rest)
<a name="l09686"></a>09686             <a class="code" href="cleanups_8c.html#a3d418f8af424aec399898c2d48b26224">make_cleanup</a> (<a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a>, rest);
<a name="l09687"></a>09687           <span class="keywordflow">if</span> (rest)
<a name="l09688"></a>09688             extra_string = rest;
<a name="l09689"></a>09689         }
<a name="l09690"></a>09690       <span class="keywordflow">else</span>
<a name="l09691"></a>09691         {
<a name="l09692"></a>09692           <span class="keywordflow">if</span> (*arg != <span class="charliteral">&#39;\0&#39;</span>)
<a name="l09693"></a>09693             <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Garbage &#39;%s&#39; at end of location&quot;</span>), arg);
<a name="l09694"></a>09694 
<a name="l09695"></a>09695           <span class="comment">/* Create a private copy of condition string.  */</span>
<a name="l09696"></a>09696           <span class="keywordflow">if</span> (cond_string)
<a name="l09697"></a>09697             {
<a name="l09698"></a>09698               cond_string = xstrdup (cond_string);
<a name="l09699"></a>09699               <a class="code" href="cleanups_8c.html#a3d418f8af424aec399898c2d48b26224">make_cleanup</a> (<a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a>, cond_string);
<a name="l09700"></a>09700             }
<a name="l09701"></a>09701           <span class="comment">/* Create a private copy of any extra string.  */</span>
<a name="l09702"></a>09702           <span class="keywordflow">if</span> (extra_string)
<a name="l09703"></a>09703             {
<a name="l09704"></a>09704               extra_string = xstrdup (extra_string);
<a name="l09705"></a>09705               <a class="code" href="cleanups_8c.html#a3d418f8af424aec399898c2d48b26224">make_cleanup</a> (<a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a>, extra_string);
<a name="l09706"></a>09706             }
<a name="l09707"></a>09707         }
<a name="l09708"></a>09708 
<a name="l09709"></a>09709       ops-&gt;<a class="code" href="structbreakpoint__ops.html#aa79150c4ebd418f67e92eba37abded26">create_breakpoints_sal</a> (gdbarch, &amp;canonical,
<a name="l09710"></a>09710                                    cond_string, extra_string, type_wanted,
<a name="l09711"></a>09711                                    tempflag ? <a class="code" href="breakpoint_8h.html#a15f2bbd9012f59bc09d59feef0c15732a16da7fb4204cb3f58c753fafa80bfab7">disp_del</a> : <a class="code" href="breakpoint_8h.html#a15f2bbd9012f59bc09d59feef0c15732a01c974d9083d524653d3a437364958be">disp_donttouch</a>,
<a name="l09712"></a>09712                                    thread, task, ignore_count, ops,
<a name="l09713"></a>09713                                    from_tty, enabled, <span class="keyword">internal</span>, flags);
<a name="l09714"></a>09714     }
<a name="l09715"></a>09715   <span class="keywordflow">else</span>
<a name="l09716"></a>09716     {
<a name="l09717"></a>09717       <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b;
<a name="l09718"></a>09718 
<a name="l09719"></a>09719       <a class="code" href="cleanups_8c.html#a3d418f8af424aec399898c2d48b26224">make_cleanup</a> (<a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a>, copy_arg);
<a name="l09720"></a>09720 
<a name="l09721"></a>09721       <span class="keywordflow">if</span> (is_tracepoint_type (type_wanted))
<a name="l09722"></a>09722         {
<a name="l09723"></a>09723           <span class="keyword">struct </span><a class="code" href="structtracepoint.html">tracepoint</a> *t;
<a name="l09724"></a>09724 
<a name="l09725"></a>09725           t = XCNEW (<span class="keyword">struct</span> <a class="code" href="structtracepoint.html">tracepoint</a>);
<a name="l09726"></a>09726           b = &amp;t-&gt;<a class="code" href="structtracepoint.html#a881af30b18b555e6ff11113da6b01a02">base</a>;
<a name="l09727"></a>09727         }
<a name="l09728"></a>09728       <span class="keywordflow">else</span>
<a name="l09729"></a>09729         b = XNEW (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a>);
<a name="l09730"></a>09730 
<a name="l09731"></a>09731       init_raw_breakpoint_without_location (b, gdbarch, type_wanted, ops);
<a name="l09732"></a>09732 
<a name="l09733"></a>09733       b-&gt;<a class="code" href="structbreakpoint.html#a885e704e5cdcfc314069b970c396d1a4">addr_string</a> = copy_arg;
<a name="l09734"></a>09734       <span class="keywordflow">if</span> (parse_arg)
<a name="l09735"></a>09735         b-&gt;<a class="code" href="structbreakpoint.html#a817904eee4ded1a9e18ab46709c1245b">cond_string</a> = NULL;
<a name="l09736"></a>09736       <span class="keywordflow">else</span>
<a name="l09737"></a>09737         {
<a name="l09738"></a>09738           <span class="comment">/* Create a private copy of condition string.  */</span>
<a name="l09739"></a>09739           <span class="keywordflow">if</span> (cond_string)
<a name="l09740"></a>09740             {
<a name="l09741"></a>09741               cond_string = xstrdup (cond_string);
<a name="l09742"></a>09742               <a class="code" href="cleanups_8c.html#a3d418f8af424aec399898c2d48b26224">make_cleanup</a> (<a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a>, cond_string);
<a name="l09743"></a>09743             }
<a name="l09744"></a>09744           b-&gt;<a class="code" href="structbreakpoint.html#a817904eee4ded1a9e18ab46709c1245b">cond_string</a> = cond_string;
<a name="l09745"></a>09745         }
<a name="l09746"></a>09746       b-&gt;<a class="code" href="structbreakpoint.html#a814299ce6585ae3945072a6df05ecb83">extra_string</a> = NULL;
<a name="l09747"></a>09747       b-&gt;<a class="code" href="structbreakpoint.html#a0e1286b838f13a04031a220f81c04d2d">ignore_count</a> = ignore_count;
<a name="l09748"></a>09748       b-&gt;<a class="code" href="structbreakpoint.html#a75f0f9a837eac292ab6e768e8d8f1bd7">disposition</a> = tempflag ? <a class="code" href="breakpoint_8h.html#a15f2bbd9012f59bc09d59feef0c15732a16da7fb4204cb3f58c753fafa80bfab7">disp_del</a> : <a class="code" href="breakpoint_8h.html#a15f2bbd9012f59bc09d59feef0c15732a01c974d9083d524653d3a437364958be">disp_donttouch</a>;
<a name="l09749"></a>09749       b-&gt;<a class="code" href="structbreakpoint.html#a565b2fa013dcbed6f07157c73c978577">condition_not_parsed</a> = 1;
<a name="l09750"></a>09750       b-&gt;<a class="code" href="structbreakpoint.html#acb53352fd35aaad37054508fabc0f3bf">enable_state</a> = enabled ? <a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577a72f1fa981d13a62d05324c1de974b44b">bp_enabled</a> : <a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577a4605f207d0d15bd8195c9b1aa1bfee96">bp_disabled</a>;
<a name="l09751"></a>09751       <span class="keywordflow">if</span> ((type_wanted != <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa17768c2bd9137ec6e30c922c5c1d0ffa">bp_breakpoint</a>
<a name="l09752"></a>09752            &amp;&amp; type_wanted != <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa657fad68a9d83a24532fb06715b77628">bp_hardware_breakpoint</a>) || thread != -1)
<a name="l09753"></a>09753         b-&gt;<a class="code" href="structbreakpoint.html#a82f4fd8ee6ddee61f3529fbd747c78b2">pspace</a> = <a class="code" href="progspace_8c.html#a07722ff15a98814c086dda44f93380c9">current_program_space</a>;
<a name="l09754"></a>09754 
<a name="l09755"></a>09755       <a class="code" href="breakpoint_8c.html#a74ff6d8191c3b444efd5631143d21635">install_breakpoint</a> (<span class="keyword">internal</span>, b, 0);
<a name="l09756"></a>09756     }
<a name="l09757"></a>09757   
<a name="l09758"></a>09758   <span class="keywordflow">if</span> (<a class="code" href="vec_8h.html#a844523bba6d0565ef73a0f4a63e48d19">VEC_length</a> (<a class="code" href="structlinespec__sals.html">linespec_sals</a>, canonical.sals) &gt; 1)
<a name="l09759"></a>09759     {
<a name="l09760"></a>09760       <a class="code" href="utils_8c.html#a5fc201a4181499a6b4057a6caa15b5e2">warning</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Multiple breakpoints were set.\nUse the &quot;</span>
<a name="l09761"></a>09761                  <span class="stringliteral">&quot;\&quot;delete\&quot; command to delete unwanted breakpoints.&quot;</span>));
<a name="l09762"></a>09762       prev_breakpoint_count = prev_bkpt_count;
<a name="l09763"></a>09763     }
<a name="l09764"></a>09764 
<a name="l09765"></a>09765   <span class="comment">/* That&#39;s it.  Discard the cleanups for data inserted into the</span>
<a name="l09766"></a>09766 <span class="comment">     breakpoint.  */</span>
<a name="l09767"></a>09767   <a class="code" href="cleanups_8c.html#a5ec3987bf995edcc44def9e17ada6eba">discard_cleanups</a> (bkpt_chain);
<a name="l09768"></a>09768   <span class="comment">/* But cleanup everything else.  */</span>
<a name="l09769"></a>09769   <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (old_chain);
<a name="l09770"></a>09770 
<a name="l09771"></a>09771   <span class="comment">/* error call may happen here - have BKPT_CHAIN already discarded.  */</span>
<a name="l09772"></a>09772   update_global_location_list (1);
<a name="l09773"></a>09773 
<a name="l09774"></a>09774   <span class="keywordflow">return</span> 1;
<a name="l09775"></a>09775 }
<a name="l09776"></a>09776 
<a name="l09777"></a>09777 <span class="comment">/* Set a breakpoint.</span>
<a name="l09778"></a>09778 <span class="comment">   ARG is a string describing breakpoint address,</span>
<a name="l09779"></a>09779 <span class="comment">   condition, and thread.</span>
<a name="l09780"></a>09780 <span class="comment">   FLAG specifies if a breakpoint is hardware on,</span>
<a name="l09781"></a>09781 <span class="comment">   and if breakpoint is temporary, using BP_HARDWARE_FLAG</span>
<a name="l09782"></a>09782 <span class="comment">   and BP_TEMPFLAG.  */</span>
<a name="l09783"></a>09783 
<a name="l09784"></a>09784 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l09785"></a>09785 break_command_1 (<span class="keywordtype">char</span> *arg, <span class="keywordtype">int</span> flag, <span class="keywordtype">int</span> from_tty)
<a name="l09786"></a>09786 {
<a name="l09787"></a>09787   <span class="keywordtype">int</span> tempflag = flag &amp; <a class="code" href="breakpoint_8c.html#a05d955ad3bcf2b3f6206038725b58057">BP_TEMPFLAG</a>;
<a name="l09788"></a>09788   <span class="keyword">enum</span> bptype type_wanted = (flag &amp; <a class="code" href="breakpoint_8c.html#a2f40dc2b6e0bcf2bfbd0ce7553849889">BP_HARDWAREFLAG</a>
<a name="l09789"></a>09789                              ? <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa657fad68a9d83a24532fb06715b77628">bp_hardware_breakpoint</a>
<a name="l09790"></a>09790                              : <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa17768c2bd9137ec6e30c922c5c1d0ffa">bp_breakpoint</a>);
<a name="l09791"></a>09791   <span class="keyword">struct </span><a class="code" href="structbreakpoint__ops.html">breakpoint_ops</a> *ops;
<a name="l09792"></a>09792   <span class="keyword">const</span> <span class="keywordtype">char</span> *arg_cp = arg;
<a name="l09793"></a>09793 
<a name="l09794"></a>09794   <span class="comment">/* Matching breakpoints on probes.  */</span>
<a name="l09795"></a>09795   <span class="keywordflow">if</span> (arg &amp;&amp; <a class="code" href="probe_8c.html#ad1f3404178e403b595c76b312a647726">probe_linespec_to_ops</a> (&amp;arg_cp) != NULL)
<a name="l09796"></a>09796     ops = &amp;bkpt_probe_breakpoint_ops;
<a name="l09797"></a>09797   <span class="keywordflow">else</span>
<a name="l09798"></a>09798     ops = &amp;<a class="code" href="breakpoint_8c.html#a9b47dd7cd982ec63ffd303246d93cf7a">bkpt_breakpoint_ops</a>;
<a name="l09799"></a>09799 
<a name="l09800"></a>09800   <a class="code" href="breakpoint_8c.html#a9f0540734ee04440fbb9f6c3c1558d0f">create_breakpoint</a> (<a class="code" href="arch-utils_8c.html#a0fe1e68475f442e5d6dda589e0c62454">get_current_arch</a> (),
<a name="l09801"></a>09801                      arg,
<a name="l09802"></a>09802                      NULL, 0, NULL, 1 <span class="comment">/* parse arg */</span>,
<a name="l09803"></a>09803                      tempflag, type_wanted,
<a name="l09804"></a>09804                      0 <span class="comment">/* Ignore count */</span>,
<a name="l09805"></a>09805                      pending_break_support,
<a name="l09806"></a>09806                      ops,
<a name="l09807"></a>09807                      from_tty,
<a name="l09808"></a>09808                      1 <span class="comment">/* enabled */</span>,
<a name="l09809"></a>09809                      0 <span class="comment">/* internal */</span>,
<a name="l09810"></a>09810                      0);
<a name="l09811"></a>09811 }
<a name="l09812"></a>09812 
<a name="l09813"></a>09813 <span class="comment">/* Helper function for break_command_1 and disassemble_command.  */</span>
<a name="l09814"></a>09814 
<a name="l09815"></a>09815 <span class="keywordtype">void</span>
<a name="l09816"></a><a class="code" href="symtab_8h.html#ad85e64952864f463ae64b803a6cf690c">09816</a> <a class="code" href="breakpoint_8c.html#a4ca5af087eb50f4017f1eac8be554088">resolve_sal_pc</a> (<span class="keyword">struct</span> <a class="code" href="structsymtab__and__line.html">symtab_and_line</a> *sal)
<a name="l09817"></a>09817 {
<a name="l09818"></a>09818   <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> pc;
<a name="l09819"></a>09819 
<a name="l09820"></a>09820   <span class="keywordflow">if</span> (sal-&gt;<a class="code" href="structsymtab__and__line.html#a77665fa461ad187cb755efa256ba44d7">pc</a> == 0 &amp;&amp; sal-&gt;<a class="code" href="structsymtab__and__line.html#a74216e171a96d8bcaab43fe69b49c599">symtab</a> != NULL)
<a name="l09821"></a>09821     {
<a name="l09822"></a>09822       <span class="keywordflow">if</span> (!<a class="code" href="symtab_8c.html#a3efe9f4dc1edb5d91fceb5d8dfa5c427">find_line_pc</a> (sal-&gt;<a class="code" href="structsymtab__and__line.html#a74216e171a96d8bcaab43fe69b49c599">symtab</a>, sal-&gt;<a class="code" href="structsymtab__and__line.html#a6a0468be675b9ac19a5b3ef26f471eaf">line</a>, &amp;pc))
<a name="l09823"></a>09823         <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;No line %d in file \&quot;%s\&quot;.&quot;</span>),
<a name="l09824"></a>09824                sal-&gt;<a class="code" href="structsymtab__and__line.html#a6a0468be675b9ac19a5b3ef26f471eaf">line</a>, <a class="code" href="source_8c.html#ae251616cab166301d5fed95cbdd31232">symtab_to_filename_for_display</a> (sal-&gt;<a class="code" href="structsymtab__and__line.html#a74216e171a96d8bcaab43fe69b49c599">symtab</a>));
<a name="l09825"></a>09825       sal-&gt;<a class="code" href="structsymtab__and__line.html#a77665fa461ad187cb755efa256ba44d7">pc</a> = pc;
<a name="l09826"></a>09826 
<a name="l09827"></a>09827       <span class="comment">/* If this SAL corresponds to a breakpoint inserted using a line</span>
<a name="l09828"></a>09828 <span class="comment">         number, then skip the function prologue if necessary.  */</span>
<a name="l09829"></a>09829       <span class="keywordflow">if</span> (sal-&gt;<a class="code" href="structsymtab__and__line.html#a410b4ee060f0de75397dd244fcad54da">explicit_line</a>)
<a name="l09830"></a>09830         <a class="code" href="symtab_8c.html#a735ed7fdbb5870bad2b89eb8908f79b2">skip_prologue_sal</a> (sal);
<a name="l09831"></a>09831     }
<a name="l09832"></a>09832 
<a name="l09833"></a>09833   <span class="keywordflow">if</span> (sal-&gt;<a class="code" href="structsymtab__and__line.html#a2e86134f04ab0e4d0834da476b7d020e">section</a> == 0 &amp;&amp; sal-&gt;<a class="code" href="structsymtab__and__line.html#a74216e171a96d8bcaab43fe69b49c599">symtab</a> != NULL)
<a name="l09834"></a>09834     {
<a name="l09835"></a>09835       <span class="keyword">struct </span><a class="code" href="structblockvector.html">blockvector</a> *bv;
<a name="l09836"></a>09836       <span class="keyword">struct </span><a class="code" href="structblock.html">block</a> *b;
<a name="l09837"></a>09837       <span class="keyword">struct </span><a class="code" href="structsymbol.html">symbol</a> *sym;
<a name="l09838"></a>09838 
<a name="l09839"></a>09839       bv = <a class="code" href="block_8c.html#ae4f91f76a32f85fccf924135aa7742ac">blockvector_for_pc_sect</a> (sal-&gt;<a class="code" href="structsymtab__and__line.html#a77665fa461ad187cb755efa256ba44d7">pc</a>, 0, &amp;b, sal-&gt;<a class="code" href="structsymtab__and__line.html#a74216e171a96d8bcaab43fe69b49c599">symtab</a>);
<a name="l09840"></a>09840       <span class="keywordflow">if</span> (bv != NULL)
<a name="l09841"></a>09841         {
<a name="l09842"></a>09842           sym = <a class="code" href="block_8c.html#a79d1eee3f8ad664338ecfcccf6e5d2a0">block_linkage_function</a> (b);
<a name="l09843"></a>09843           <span class="keywordflow">if</span> (sym != NULL)
<a name="l09844"></a>09844             {
<a name="l09845"></a>09845               <a class="code" href="symtab_8c.html#a569809b8edfbd2e0a6d9bb40295840f0">fixup_symbol_section</a> (sym, sal-&gt;<a class="code" href="structsymtab__and__line.html#a74216e171a96d8bcaab43fe69b49c599">symtab</a>-&gt;<a class="code" href="structsymtab.html#a5fbe801333fb00c20190a6193b708be0">objfile</a>);
<a name="l09846"></a>09846               sal-&gt;<a class="code" href="structsymtab__and__line.html#a2e86134f04ab0e4d0834da476b7d020e">section</a> = <a class="code" href="symtab_8h.html#a68f0685d666b6934c762f89d9b996c63">SYMBOL_OBJ_SECTION</a> (sal-&gt;<a class="code" href="structsymtab__and__line.html#a74216e171a96d8bcaab43fe69b49c599">symtab</a>-&gt;<a class="code" href="structsymtab.html#a5fbe801333fb00c20190a6193b708be0">objfile</a>, sym);
<a name="l09847"></a>09847             }
<a name="l09848"></a>09848           <span class="keywordflow">else</span>
<a name="l09849"></a>09849             {
<a name="l09850"></a>09850               <span class="comment">/* It really is worthwhile to have the section, so we&#39;ll</span>
<a name="l09851"></a>09851 <span class="comment">                 just have to look harder. This case can be executed</span>
<a name="l09852"></a>09852 <span class="comment">                 if we have line numbers but no functions (as can</span>
<a name="l09853"></a>09853 <span class="comment">                 happen in assembly source).  */</span>
<a name="l09854"></a>09854 
<a name="l09855"></a>09855               <span class="keyword">struct </span><a class="code" href="structbound__minimal__symbol.html">bound_minimal_symbol</a> msym;
<a name="l09856"></a>09856               <span class="keyword">struct </span>cleanup *old_chain = <a class="code" href="progspace_8c.html#a6326460454db4e192e2bc221cb322977">save_current_space_and_thread</a> ();
<a name="l09857"></a>09857 
<a name="l09858"></a>09858               <a class="code" href="progspace_8c.html#a58d979e46585ad85280e488204e0147e">switch_to_program_space_and_thread</a> (sal-&gt;<a class="code" href="structsymtab__and__line.html#acc91f0276f4648cb5a970f17ddcbaf09">pspace</a>);
<a name="l09859"></a>09859 
<a name="l09860"></a>09860               msym = <a class="code" href="minsyms_8c.html#ad4b48b6ef6c913138a8ac33f8c3cfeb2">lookup_minimal_symbol_by_pc</a> (sal-&gt;<a class="code" href="structsymtab__and__line.html#a77665fa461ad187cb755efa256ba44d7">pc</a>);
<a name="l09861"></a>09861               <span class="keywordflow">if</span> (msym.<a class="code" href="structbound__minimal__symbol.html#aabff08898c1d96d6c68a95f35b635214">minsym</a>)
<a name="l09862"></a>09862                 sal-&gt;<a class="code" href="structsymtab__and__line.html#a2e86134f04ab0e4d0834da476b7d020e">section</a> = <a class="code" href="symtab_8h.html#a68f0685d666b6934c762f89d9b996c63">SYMBOL_OBJ_SECTION</a> (msym.<a class="code" href="structbound__minimal__symbol.html#a070e0e47d191675f0f4892e0b321d663">objfile</a>, msym.<a class="code" href="structbound__minimal__symbol.html#aabff08898c1d96d6c68a95f35b635214">minsym</a>);
<a name="l09863"></a>09863 
<a name="l09864"></a>09864               <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (old_chain);
<a name="l09865"></a>09865             }
<a name="l09866"></a>09866         }
<a name="l09867"></a>09867     }
<a name="l09868"></a>09868 }
<a name="l09869"></a>09869 
<a name="l09870"></a>09870 <span class="keywordtype">void</span>
<a name="l09871"></a><a class="code" href="breakpoint_8h.html#a87f6f42394c5ae777976a7b99411c2e3">09871</a> <a class="code" href="breakpoint_8c.html#a969c96b44566691286776d06748a69c3">break_command</a> (<span class="keywordtype">char</span> *arg, <span class="keywordtype">int</span> from_tty)
<a name="l09872"></a>09872 {
<a name="l09873"></a>09873   break_command_1 (arg, 0, from_tty);
<a name="l09874"></a>09874 }
<a name="l09875"></a>09875 
<a name="l09876"></a>09876 <span class="keywordtype">void</span>
<a name="l09877"></a><a class="code" href="breakpoint_8h.html#a16c0f8ddba200106ee5c6651d5191c13">09877</a> <a class="code" href="breakpoint_8c.html#a81f8125287168f705e6e9b1eef1ba79c">tbreak_command</a> (<span class="keywordtype">char</span> *arg, <span class="keywordtype">int</span> from_tty)
<a name="l09878"></a>09878 {
<a name="l09879"></a>09879   break_command_1 (arg, BP_TEMPFLAG, from_tty);
<a name="l09880"></a>09880 }
<a name="l09881"></a>09881 
<a name="l09882"></a>09882 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l09883"></a>09883 hbreak_command (<span class="keywordtype">char</span> *arg, <span class="keywordtype">int</span> from_tty)
<a name="l09884"></a>09884 {
<a name="l09885"></a>09885   break_command_1 (arg, <a class="code" href="breakpoint_8c.html#a2f40dc2b6e0bcf2bfbd0ce7553849889">BP_HARDWAREFLAG</a>, from_tty);
<a name="l09886"></a>09886 }
<a name="l09887"></a>09887 
<a name="l09888"></a>09888 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l09889"></a>09889 thbreak_command (<span class="keywordtype">char</span> *arg, <span class="keywordtype">int</span> from_tty)
<a name="l09890"></a>09890 {
<a name="l09891"></a>09891   break_command_1 (arg, (BP_TEMPFLAG | <a class="code" href="breakpoint_8c.html#a2f40dc2b6e0bcf2bfbd0ce7553849889">BP_HARDWAREFLAG</a>), from_tty);
<a name="l09892"></a>09892 }
<a name="l09893"></a>09893 
<a name="l09894"></a>09894 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l09895"></a>09895 stop_command (<span class="keywordtype">char</span> *arg, <span class="keywordtype">int</span> from_tty)
<a name="l09896"></a>09896 {
<a name="l09897"></a>09897   <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Specify the type of breakpoint to set.\n\</span>
<a name="l09898"></a>09898 <span class="stringliteral">Usage: stop in &lt;function | address&gt;\n\</span>
<a name="l09899"></a>09899 <span class="stringliteral">       stop at &lt;line&gt;\n&quot;</span>));
<a name="l09900"></a>09900 }
<a name="l09901"></a>09901 
<a name="l09902"></a>09902 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l09903"></a>09903 stopin_command (<span class="keywordtype">char</span> *arg, <span class="keywordtype">int</span> from_tty)
<a name="l09904"></a>09904 {
<a name="l09905"></a>09905   <span class="keywordtype">int</span> badInput = 0;
<a name="l09906"></a>09906 
<a name="l09907"></a>09907   <span class="keywordflow">if</span> (arg == (<span class="keywordtype">char</span> *) NULL)
<a name="l09908"></a>09908     badInput = 1;
<a name="l09909"></a>09909   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*arg != <span class="charliteral">&#39;*&#39;</span>)
<a name="l09910"></a>09910     {
<a name="l09911"></a>09911       <span class="keywordtype">char</span> *argptr = arg;
<a name="l09912"></a>09912       <span class="keywordtype">int</span> hasColon = 0;
<a name="l09913"></a>09913 
<a name="l09914"></a>09914       <span class="comment">/* Look for a &#39;:&#39;.  If this is a line number specification, then</span>
<a name="l09915"></a>09915 <span class="comment">         say it is bad, otherwise, it should be an address or</span>
<a name="l09916"></a>09916 <span class="comment">         function/method name.  */</span>
<a name="l09917"></a>09917       <span class="keywordflow">while</span> (*argptr &amp;&amp; !hasColon)
<a name="l09918"></a>09918         {
<a name="l09919"></a>09919           hasColon = (*argptr == <span class="charliteral">&#39;:&#39;</span>);
<a name="l09920"></a>09920           argptr++;
<a name="l09921"></a>09921         }
<a name="l09922"></a>09922 
<a name="l09923"></a>09923       <span class="keywordflow">if</span> (hasColon)
<a name="l09924"></a>09924         badInput = (*argptr != <span class="charliteral">&#39;:&#39;</span>);    <span class="comment">/* Not a class::method */</span>
<a name="l09925"></a>09925       <span class="keywordflow">else</span>
<a name="l09926"></a>09926         badInput = isdigit (*arg);      <span class="comment">/* a simple line number */</span>
<a name="l09927"></a>09927     }
<a name="l09928"></a>09928 
<a name="l09929"></a>09929   <span class="keywordflow">if</span> (badInput)
<a name="l09930"></a>09930     <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Usage: stop in &lt;function | address&gt;\n&quot;</span>));
<a name="l09931"></a>09931   <span class="keywordflow">else</span>
<a name="l09932"></a>09932     break_command_1 (arg, 0, from_tty);
<a name="l09933"></a>09933 }
<a name="l09934"></a>09934 
<a name="l09935"></a>09935 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l09936"></a>09936 stopat_command (<span class="keywordtype">char</span> *arg, <span class="keywordtype">int</span> from_tty)
<a name="l09937"></a>09937 {
<a name="l09938"></a>09938   <span class="keywordtype">int</span> badInput = 0;
<a name="l09939"></a>09939 
<a name="l09940"></a>09940   <span class="keywordflow">if</span> (arg == (<span class="keywordtype">char</span> *) NULL || *arg == <span class="charliteral">&#39;*&#39;</span>)      <span class="comment">/* no line number */</span>
<a name="l09941"></a>09941     badInput = 1;
<a name="l09942"></a>09942   <span class="keywordflow">else</span>
<a name="l09943"></a>09943     {
<a name="l09944"></a>09944       <span class="keywordtype">char</span> *argptr = arg;
<a name="l09945"></a>09945       <span class="keywordtype">int</span> hasColon = 0;
<a name="l09946"></a>09946 
<a name="l09947"></a>09947       <span class="comment">/* Look for a &#39;:&#39;.  If there is a &#39;::&#39; then get out, otherwise</span>
<a name="l09948"></a>09948 <span class="comment">         it is probably a line number.  */</span>
<a name="l09949"></a>09949       <span class="keywordflow">while</span> (*argptr &amp;&amp; !hasColon)
<a name="l09950"></a>09950         {
<a name="l09951"></a>09951           hasColon = (*argptr == <span class="charliteral">&#39;:&#39;</span>);
<a name="l09952"></a>09952           argptr++;
<a name="l09953"></a>09953         }
<a name="l09954"></a>09954 
<a name="l09955"></a>09955       <span class="keywordflow">if</span> (hasColon)
<a name="l09956"></a>09956         badInput = (*argptr == <span class="charliteral">&#39;:&#39;</span>);    <span class="comment">/* we have class::method */</span>
<a name="l09957"></a>09957       <span class="keywordflow">else</span>
<a name="l09958"></a>09958         badInput = !isdigit (*arg);     <span class="comment">/* not a line number */</span>
<a name="l09959"></a>09959     }
<a name="l09960"></a>09960 
<a name="l09961"></a>09961   <span class="keywordflow">if</span> (badInput)
<a name="l09962"></a>09962     <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Usage: stop at &lt;line&gt;\n&quot;</span>));
<a name="l09963"></a>09963   <span class="keywordflow">else</span>
<a name="l09964"></a>09964     break_command_1 (arg, 0, from_tty);
<a name="l09965"></a>09965 }
<a name="l09966"></a>09966 
<a name="l09967"></a>09967 <span class="comment">/* The dynamic printf command is mostly like a regular breakpoint, but</span>
<a name="l09968"></a>09968 <span class="comment">   with a prewired command list consisting of a single output command,</span>
<a name="l09969"></a>09969 <span class="comment">   built from extra arguments supplied on the dprintf command</span>
<a name="l09970"></a>09970 <span class="comment">   line.  */</span>
<a name="l09971"></a>09971 
<a name="l09972"></a>09972 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l09973"></a>09973 dprintf_command (<span class="keywordtype">char</span> *arg, <span class="keywordtype">int</span> from_tty)
<a name="l09974"></a>09974 {
<a name="l09975"></a>09975   <a class="code" href="breakpoint_8c.html#a9f0540734ee04440fbb9f6c3c1558d0f">create_breakpoint</a> (<a class="code" href="arch-utils_8c.html#a0fe1e68475f442e5d6dda589e0c62454">get_current_arch</a> (),
<a name="l09976"></a>09976                      arg,
<a name="l09977"></a>09977                      NULL, 0, NULL, 1 <span class="comment">/* parse arg */</span>,
<a name="l09978"></a>09978                      0, <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa404b00503edb7eba238aea705ea34231">bp_dprintf</a>,
<a name="l09979"></a>09979                      0 <span class="comment">/* Ignore count */</span>,
<a name="l09980"></a>09980                      pending_break_support,
<a name="l09981"></a>09981                      &amp;<a class="code" href="breakpoint_8c.html#a21625ec72da41a93186216198d3bceae">dprintf_breakpoint_ops</a>,
<a name="l09982"></a>09982                      from_tty,
<a name="l09983"></a>09983                      1 <span class="comment">/* enabled */</span>,
<a name="l09984"></a>09984                      0 <span class="comment">/* internal */</span>,
<a name="l09985"></a>09985                      0);
<a name="l09986"></a>09986 }
<a name="l09987"></a>09987 
<a name="l09988"></a>09988 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l09989"></a>09989 agent_printf_command (<span class="keywordtype">char</span> *arg, <span class="keywordtype">int</span> from_tty)
<a name="l09990"></a>09990 {
<a name="l09991"></a>09991   <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;May only run agent-printf on the target&quot;</span>));
<a name="l09992"></a>09992 }
<a name="l09993"></a>09993 
<a name="l09994"></a>09994 <span class="comment">/* Implement the &quot;breakpoint_hit&quot; breakpoint_ops method for</span>
<a name="l09995"></a>09995 <span class="comment">   ranged breakpoints.  */</span>
<a name="l09996"></a>09996 
<a name="l09997"></a>09997 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l09998"></a>09998 breakpoint_hit_ranged_breakpoint (<span class="keyword">const</span> <span class="keyword">struct</span> bp_location *bl,
<a name="l09999"></a>09999                                   <span class="keyword">struct</span> address_space *aspace,
<a name="l10000"></a>10000                                   <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> bp_addr,
<a name="l10001"></a>10001                                   <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structtarget__waitstatus.html">target_waitstatus</a> *ws)
<a name="l10002"></a>10002 {
<a name="l10003"></a>10003   <span class="keywordflow">if</span> (ws-&gt;<a class="code" href="structtarget__waitstatus.html#a17ed1783e9146f443fa51ace8da76198">kind</a> != <a class="code" href="waitstatus_8h.html#aa3229b489ec985f04f7e9f652138b7c3a8e1dc525cf3131501a541b4412bcd493">TARGET_WAITKIND_STOPPED</a>
<a name="l10004"></a>10004       || ws-&gt;<a class="code" href="structtarget__waitstatus.html#af33b8f5721dc36f6b5b829286d38f825">value</a>.<a class="code" href="structtarget__waitstatus.html#a7cc711572c26d1f095a87105f4afd1e1">sig</a> != GDB_SIGNAL_TRAP)
<a name="l10005"></a>10005     <span class="keywordflow">return</span> 0;
<a name="l10006"></a>10006 
<a name="l10007"></a>10007   <span class="keywordflow">return</span> breakpoint_address_match_range (bl-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a>-&gt;<a class="code" href="structprogram__space.html#abf2a489f5ed3c1d5cad74d14dbb318e4">aspace</a>, bl-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>,
<a name="l10008"></a>10008                                          bl-&gt;<a class="code" href="structbp__location.html#a3d4ad6914964554ca761607f9e8fab62">length</a>, aspace, bp_addr);
<a name="l10009"></a>10009 }
<a name="l10010"></a>10010 
<a name="l10011"></a>10011 <span class="comment">/* Implement the &quot;resources_needed&quot; breakpoint_ops method for</span>
<a name="l10012"></a>10012 <span class="comment">   ranged breakpoints.  */</span>
<a name="l10013"></a>10013 
<a name="l10014"></a>10014 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l10015"></a>10015 resources_needed_ranged_breakpoint (<span class="keyword">const</span> <span class="keyword">struct</span> bp_location *bl)
<a name="l10016"></a>10016 {
<a name="l10017"></a>10017   <span class="keywordflow">return</span> <a class="code" href="target_8c.html#ac5e3b4226d66a0cfdc0f039077e36178">target_ranged_break_num_registers</a> ();
<a name="l10018"></a>10018 }
<a name="l10019"></a>10019 
<a name="l10020"></a>10020 <span class="comment">/* Implement the &quot;print_it&quot; breakpoint_ops method for</span>
<a name="l10021"></a>10021 <span class="comment">   ranged breakpoints.  */</span>
<a name="l10022"></a>10022 
<a name="l10023"></a>10023 <span class="keyword">static</span> <span class="keyword">enum</span> <a class="code" href="breakpoint_8h.html#ab6ab1d6a867561653e32a901b41be66b">print_stop_action</a>
<a name="l10024"></a>10024 print_it_ranged_breakpoint (<a class="code" href="structbpstats.html">bpstat</a> bs)
<a name="l10025"></a>10025 {
<a name="l10026"></a>10026   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b = bs-&gt;<a class="code" href="structbpstats.html#ac105ed7263dd10f9d65e92e706b04e39">breakpoint_at</a>;
<a name="l10027"></a>10027   <span class="keyword">struct </span>bp_location *bl = b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>;
<a name="l10028"></a>10028   <span class="keyword">struct </span>ui_out *uiout = <a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>;
<a name="l10029"></a>10029 
<a name="l10030"></a>10030   <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa657fad68a9d83a24532fb06715b77628">bp_hardware_breakpoint</a>);
<a name="l10031"></a>10031 
<a name="l10032"></a>10032   <span class="comment">/* Ranged breakpoints have only one location.  */</span>
<a name="l10033"></a>10033   <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (bl &amp;&amp; bl-&gt;<a class="code" href="structbp__location.html#ab193cb38f87fea89105db96d94191541">next</a> == NULL);
<a name="l10034"></a>10034 
<a name="l10035"></a>10035   <a class="code" href="annotate_8c.html#a0121251245d45abcacd78c0a61ef721a">annotate_breakpoint</a> (b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>);
<a name="l10036"></a>10036   <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#a75f0f9a837eac292ab6e768e8d8f1bd7">disposition</a> == <a class="code" href="breakpoint_8h.html#a15f2bbd9012f59bc09d59feef0c15732a16da7fb4204cb3f58c753fafa80bfab7">disp_del</a>)
<a name="l10037"></a>10037     <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;\nTemporary ranged breakpoint &quot;</span>);
<a name="l10038"></a>10038   <span class="keywordflow">else</span>
<a name="l10039"></a>10039     <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;\nRanged breakpoint &quot;</span>);
<a name="l10040"></a>10040   <span class="keywordflow">if</span> (<a class="code" href="ui-out_8c.html#a473db54efcfbc60feeb5a4f54f27af46">ui_out_is_mi_like_p</a> (uiout))
<a name="l10041"></a>10041     {
<a name="l10042"></a>10042       <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a> (uiout, <span class="stringliteral">&quot;reason&quot;</span>,
<a name="l10043"></a>10043                       <a class="code" href="mi-common_8c.html#a619e7d180d78af6e6d63a611c6680e90">async_reason_lookup</a> (<a class="code" href="mi-common_8h.html#a06d7bf56f98dcc556d686f49ea570daea20df3a258e30b94df1705d51dff3a180">EXEC_ASYNC_BREAKPOINT_HIT</a>));
<a name="l10044"></a>10044       <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a> (uiout, <span class="stringliteral">&quot;disp&quot;</span>, <a class="code" href="breakpoint_8c.html#a6f45019563f41b3ae4dc92df09f12618">bpdisp_text</a> (b-&gt;<a class="code" href="structbreakpoint.html#a75f0f9a837eac292ab6e768e8d8f1bd7">disposition</a>));
<a name="l10045"></a>10045     }
<a name="l10046"></a>10046   <a class="code" href="ui-out_8c.html#aa6f66551d03db456fb94ca1c9038f5a0">ui_out_field_int</a> (uiout, <span class="stringliteral">&quot;bkptno&quot;</span>, b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>);
<a name="l10047"></a>10047   <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;, &quot;</span>);
<a name="l10048"></a>10048 
<a name="l10049"></a>10049   <span class="keywordflow">return</span> <a class="code" href="breakpoint_8h.html#ab6ab1d6a867561653e32a901b41be66ba322bad7b3370a43f44f33ae73a196231">PRINT_SRC_AND_LOC</a>;
<a name="l10050"></a>10050 }
<a name="l10051"></a>10051 
<a name="l10052"></a>10052 <span class="comment">/* Implement the &quot;print_one&quot; breakpoint_ops method for</span>
<a name="l10053"></a>10053 <span class="comment">   ranged breakpoints.  */</span>
<a name="l10054"></a>10054 
<a name="l10055"></a>10055 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l10056"></a>10056 print_one_ranged_breakpoint (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b,
<a name="l10057"></a>10057                              <span class="keyword">struct</span> bp_location **last_loc)
<a name="l10058"></a>10058 {
<a name="l10059"></a>10059   <span class="keyword">struct </span>bp_location *bl = b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>;
<a name="l10060"></a>10060   <span class="keyword">struct </span><a class="code" href="structvalue__print__options.html">value_print_options</a> opts;
<a name="l10061"></a>10061   <span class="keyword">struct </span>ui_out *uiout = <a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>;
<a name="l10062"></a>10062 
<a name="l10063"></a>10063   <span class="comment">/* Ranged breakpoints have only one location.  */</span>
<a name="l10064"></a>10064   <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (bl &amp;&amp; bl-&gt;<a class="code" href="structbp__location.html#ab193cb38f87fea89105db96d94191541">next</a> == NULL);
<a name="l10065"></a>10065 
<a name="l10066"></a>10066   <a class="code" href="valprint_8c.html#aa2d4dfe4b11841ccafc4d0c0d410095d">get_user_print_options</a> (&amp;opts);
<a name="l10067"></a>10067 
<a name="l10068"></a>10068   <span class="keywordflow">if</span> (opts.addressprint)
<a name="l10069"></a>10069     <span class="comment">/* We don&#39;t print the address range here, it will be printed later</span>
<a name="l10070"></a>10070 <span class="comment">       by print_one_detail_ranged_breakpoint.  */</span>
<a name="l10071"></a>10071     <a class="code" href="ui-out_8c.html#a5366a822858ecedafef54625bec57442">ui_out_field_skip</a> (uiout, <span class="stringliteral">&quot;addr&quot;</span>);
<a name="l10072"></a>10072   <a class="code" href="annotate_8c.html#a3b961efbc346558aade25e12945835fe">annotate_field</a> (5);
<a name="l10073"></a>10073   print_breakpoint_location (b, bl);
<a name="l10074"></a>10074   *last_loc = bl;
<a name="l10075"></a>10075 }
<a name="l10076"></a>10076 
<a name="l10077"></a>10077 <span class="comment">/* Implement the &quot;print_one_detail&quot; breakpoint_ops method for</span>
<a name="l10078"></a>10078 <span class="comment">   ranged breakpoints.  */</span>
<a name="l10079"></a>10079 
<a name="l10080"></a>10080 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l10081"></a>10081 print_one_detail_ranged_breakpoint (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b,
<a name="l10082"></a>10082                                     <span class="keyword">struct</span> ui_out *uiout)
<a name="l10083"></a>10083 {
<a name="l10084"></a>10084   <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> address_start, address_end;
<a name="l10085"></a>10085   <span class="keyword">struct </span>bp_location *bl = b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>;
<a name="l10086"></a>10086   <span class="keyword">struct </span>ui_file *stb = <a class="code" href="ui-file_8c.html#a340771735f105582d314e191a399a45c">mem_fileopen</a> ();
<a name="l10087"></a>10087   <span class="keyword">struct </span>cleanup *cleanup = <a class="code" href="utils_8c.html#a94dc56baeb57791e114136764f7763aa">make_cleanup_ui_file_delete</a> (stb);
<a name="l10088"></a>10088 
<a name="l10089"></a>10089   <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (bl);
<a name="l10090"></a>10090 
<a name="l10091"></a>10091   address_start = bl-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>;
<a name="l10092"></a>10092   address_end = address_start + bl-&gt;<a class="code" href="structbp__location.html#a3d4ad6914964554ca761607f9e8fab62">length</a> - 1;
<a name="l10093"></a>10093 
<a name="l10094"></a>10094   <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;\taddress range: &quot;</span>);
<a name="l10095"></a>10095   <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (stb, <span class="stringliteral">&quot;[%s, %s]&quot;</span>,
<a name="l10096"></a>10096                       <a class="code" href="utils_8c.html#a3e0a9c870c64344554a34e0e5f623d8b">print_core_address</a> (bl-&gt;<a class="code" href="structbp__location.html#a55f3ff99d536775f5095f11e5f5c3f3e">gdbarch</a>, address_start),
<a name="l10097"></a>10097                       <a class="code" href="utils_8c.html#a3e0a9c870c64344554a34e0e5f623d8b">print_core_address</a> (bl-&gt;<a class="code" href="structbp__location.html#a55f3ff99d536775f5095f11e5f5c3f3e">gdbarch</a>, address_end));
<a name="l10098"></a>10098   <a class="code" href="ui-out_8c.html#a40106bb0446639417c75a408194a8eee">ui_out_field_stream</a> (uiout, <span class="stringliteral">&quot;addr&quot;</span>, stb);
<a name="l10099"></a>10099   <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;\n&quot;</span>);
<a name="l10100"></a>10100 
<a name="l10101"></a>10101   <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (cleanup);
<a name="l10102"></a>10102 }
<a name="l10103"></a>10103 
<a name="l10104"></a>10104 <span class="comment">/* Implement the &quot;print_mention&quot; breakpoint_ops method for</span>
<a name="l10105"></a>10105 <span class="comment">   ranged breakpoints.  */</span>
<a name="l10106"></a>10106 
<a name="l10107"></a>10107 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l10108"></a>10108 print_mention_ranged_breakpoint (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b)
<a name="l10109"></a>10109 {
<a name="l10110"></a>10110   <span class="keyword">struct </span>bp_location *bl = b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>;
<a name="l10111"></a>10111   <span class="keyword">struct </span>ui_out *uiout = <a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>;
<a name="l10112"></a>10112 
<a name="l10113"></a>10113   <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (bl);
<a name="l10114"></a>10114   <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa657fad68a9d83a24532fb06715b77628">bp_hardware_breakpoint</a>);
<a name="l10115"></a>10115 
<a name="l10116"></a>10116   <span class="keywordflow">if</span> (<a class="code" href="ui-out_8c.html#a473db54efcfbc60feeb5a4f54f27af46">ui_out_is_mi_like_p</a> (uiout))
<a name="l10117"></a>10117     <span class="keywordflow">return</span>;
<a name="l10118"></a>10118 
<a name="l10119"></a>10119   <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Hardware assisted ranged breakpoint %d from %s to %s.&quot;</span>),
<a name="l10120"></a>10120                    b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>, <a class="code" href="utils_8c.html#ab5c76d72090f01d3848b63dda4e37d1c">paddress</a> (bl-&gt;<a class="code" href="structbp__location.html#a55f3ff99d536775f5095f11e5f5c3f3e">gdbarch</a>, bl-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>),
<a name="l10121"></a>10121                    <a class="code" href="utils_8c.html#ab5c76d72090f01d3848b63dda4e37d1c">paddress</a> (bl-&gt;<a class="code" href="structbp__location.html#a55f3ff99d536775f5095f11e5f5c3f3e">gdbarch</a>, bl-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a> + bl-&gt;<a class="code" href="structbp__location.html#a3d4ad6914964554ca761607f9e8fab62">length</a> - 1));
<a name="l10122"></a>10122 }
<a name="l10123"></a>10123 
<a name="l10124"></a>10124 <span class="comment">/* Implement the &quot;print_recreate&quot; breakpoint_ops method for</span>
<a name="l10125"></a>10125 <span class="comment">   ranged breakpoints.  */</span>
<a name="l10126"></a>10126 
<a name="l10127"></a>10127 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l10128"></a>10128 print_recreate_ranged_breakpoint (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b, <span class="keyword">struct</span> ui_file *fp)
<a name="l10129"></a>10129 {
<a name="l10130"></a>10130   <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (fp, <span class="stringliteral">&quot;break-range %s, %s&quot;</span>, b-&gt;<a class="code" href="structbreakpoint.html#a885e704e5cdcfc314069b970c396d1a4">addr_string</a>,
<a name="l10131"></a>10131                       b-&gt;<a class="code" href="structbreakpoint.html#a0bad27f6d3009411fec7525ff7e309d5">addr_string_range_end</a>);
<a name="l10132"></a>10132   <a class="code" href="breakpoint_8c.html#aae7cd38b01782db6011bcd0150059625">print_recreate_thread</a> (b, fp);
<a name="l10133"></a>10133 }
<a name="l10134"></a>10134 
<a name="l10135"></a>10135 <span class="comment">/* The breakpoint_ops structure to be used in ranged breakpoints.  */</span>
<a name="l10136"></a>10136 
<a name="l10137"></a>10137 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structbreakpoint__ops.html">breakpoint_ops</a> ranged_breakpoint_ops;
<a name="l10138"></a>10138 
<a name="l10139"></a>10139 <span class="comment">/* Find the address where the end of the breakpoint range should be</span>
<a name="l10140"></a>10140 <span class="comment">   placed, given the SAL of the end of the range.  This is so that if</span>
<a name="l10141"></a>10141 <span class="comment">   the user provides a line number, the end of the range is set to the</span>
<a name="l10142"></a>10142 <span class="comment">   last instruction of the given line.  */</span>
<a name="l10143"></a>10143 
<a name="l10144"></a>10144 <span class="keyword">static</span> <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a>
<a name="l10145"></a>10145 find_breakpoint_range_end (<span class="keyword">struct</span> <a class="code" href="structsymtab__and__line.html">symtab_and_line</a> sal)
<a name="l10146"></a>10146 {
<a name="l10147"></a>10147   <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> end;
<a name="l10148"></a>10148 
<a name="l10149"></a>10149   <span class="comment">/* If the user provided a PC value, use it.  Otherwise,</span>
<a name="l10150"></a>10150 <span class="comment">     find the address of the end of the given location.  */</span>
<a name="l10151"></a>10151   <span class="keywordflow">if</span> (sal.<a class="code" href="structsymtab__and__line.html#aa1cadecc3ac47f587f6725c2851a73ac">explicit_pc</a>)
<a name="l10152"></a>10152     end = sal.<a class="code" href="structsymtab__and__line.html#a77665fa461ad187cb755efa256ba44d7">pc</a>;
<a name="l10153"></a>10153   <span class="keywordflow">else</span>
<a name="l10154"></a>10154     {
<a name="l10155"></a>10155       <span class="keywordtype">int</span> ret;
<a name="l10156"></a>10156       <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> start;
<a name="l10157"></a>10157 
<a name="l10158"></a>10158       ret = <a class="code" href="symtab_8c.html#ad7abbdf5f7a0d49ce1b12200beda7d96">find_line_pc_range</a> (sal, &amp;start, &amp;end);
<a name="l10159"></a>10159       <span class="keywordflow">if</span> (!ret)
<a name="l10160"></a>10160         <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Could not find location of the end of the range.&quot;</span>));
<a name="l10161"></a>10161 
<a name="l10162"></a>10162       <span class="comment">/* find_line_pc_range returns the start of the next line.  */</span>
<a name="l10163"></a>10163       end--;
<a name="l10164"></a>10164     }
<a name="l10165"></a>10165 
<a name="l10166"></a>10166   <span class="keywordflow">return</span> end;
<a name="l10167"></a>10167 }
<a name="l10168"></a>10168 
<a name="l10169"></a>10169 <span class="comment">/* Implement the &quot;break-range&quot; CLI command.  */</span>
<a name="l10170"></a>10170 
<a name="l10171"></a>10171 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l10172"></a>10172 break_range_command (<span class="keywordtype">char</span> *arg, <span class="keywordtype">int</span> from_tty)
<a name="l10173"></a>10173 {
<a name="l10174"></a>10174   <span class="keywordtype">char</span> *arg_start, *addr_string_start, *addr_string_end;
<a name="l10175"></a>10175   <span class="keyword">struct </span><a class="code" href="structlinespec__result.html">linespec_result</a> canonical_start, canonical_end;
<a name="l10176"></a>10176   <span class="keywordtype">int</span> bp_count, can_use_bp, length;
<a name="l10177"></a>10177   <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> end;
<a name="l10178"></a>10178   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b;
<a name="l10179"></a>10179   <span class="keyword">struct </span><a class="code" href="structsymtab__and__line.html">symtab_and_line</a> sal_start, sal_end;
<a name="l10180"></a>10180   <span class="keyword">struct </span>cleanup *cleanup_bkpt;
<a name="l10181"></a>10181   <span class="keyword">struct </span><a class="code" href="structlinespec__sals.html">linespec_sals</a> *lsal_start, *lsal_end;
<a name="l10182"></a>10182 
<a name="l10183"></a>10183   <span class="comment">/* We don&#39;t support software ranged breakpoints.  */</span>
<a name="l10184"></a>10184   <span class="keywordflow">if</span> (<a class="code" href="target_8c.html#ac5e3b4226d66a0cfdc0f039077e36178">target_ranged_break_num_registers</a> () &lt; 0)
<a name="l10185"></a>10185     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;This target does not support hardware ranged breakpoints.&quot;</span>));
<a name="l10186"></a>10186 
<a name="l10187"></a>10187   bp_count = hw_breakpoint_used_count ();
<a name="l10188"></a>10188   bp_count += <a class="code" href="target_8c.html#ac5e3b4226d66a0cfdc0f039077e36178">target_ranged_break_num_registers</a> ();
<a name="l10189"></a>10189   can_use_bp = <a class="code" href="target_8h.html#a426728386dc9c2a6d50a7a20e90fe13b">target_can_use_hardware_watchpoint</a> (<a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa657fad68a9d83a24532fb06715b77628">bp_hardware_breakpoint</a>,
<a name="l10190"></a>10190                                                    bp_count, 0);
<a name="l10191"></a>10191   <span class="keywordflow">if</span> (can_use_bp &lt; 0)
<a name="l10192"></a>10192     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Hardware breakpoints used exceeds limit.&quot;</span>));
<a name="l10193"></a>10193 
<a name="l10194"></a>10194   arg = <a class="code" href="cli-utils_8c.html#afa70bcaee54d487b4412d2a7a5a0c8fa">skip_spaces</a> (arg);
<a name="l10195"></a>10195   <span class="keywordflow">if</span> (arg == NULL || arg[0] == <span class="charliteral">&#39;\0&#39;</span>)
<a name="l10196"></a>10196     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a>(<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;No address range specified.&quot;</span>));
<a name="l10197"></a>10197 
<a name="l10198"></a>10198   <a class="code" href="linespec_8c.html#a7264361d0a42e631634188c78dd8a96e">init_linespec_result</a> (&amp;canonical_start);
<a name="l10199"></a>10199 
<a name="l10200"></a>10200   arg_start = arg;
<a name="l10201"></a>10201   parse_breakpoint_sals (&amp;arg, &amp;canonical_start);
<a name="l10202"></a>10202 
<a name="l10203"></a>10203   cleanup_bkpt = <a class="code" href="linespec_8c.html#ac681b7d9043443fa8be585a1fcf735bf">make_cleanup_destroy_linespec_result</a> (&amp;canonical_start);
<a name="l10204"></a>10204 
<a name="l10205"></a>10205   <span class="keywordflow">if</span> (arg[0] != <span class="charliteral">&#39;,&#39;</span>)
<a name="l10206"></a>10206     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Too few arguments.&quot;</span>));
<a name="l10207"></a>10207   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="vec_8h.html#ac9981d313a5e114db0e05b7b9cd16319">VEC_empty</a> (<a class="code" href="structlinespec__sals.html">linespec_sals</a>, canonical_start.<a class="code" href="structlinespec__sals.html#a34ac2e438b2835722c998f409c85dcee">sals</a>))
<a name="l10208"></a>10208     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Could not find location of the beginning of the range.&quot;</span>));
<a name="l10209"></a>10209 
<a name="l10210"></a>10210   lsal_start = <a class="code" href="vec_8h.html#a49c128c353995ea8fca27be70829ca52">VEC_index</a> (<a class="code" href="structlinespec__sals.html">linespec_sals</a>, canonical_start.<a class="code" href="structlinespec__sals.html#a34ac2e438b2835722c998f409c85dcee">sals</a>, 0);
<a name="l10211"></a>10211 
<a name="l10212"></a>10212   <span class="keywordflow">if</span> (<a class="code" href="vec_8h.html#a844523bba6d0565ef73a0f4a63e48d19">VEC_length</a> (<a class="code" href="structlinespec__sals.html">linespec_sals</a>, canonical_start.<a class="code" href="structlinespec__sals.html#a34ac2e438b2835722c998f409c85dcee">sals</a>) &gt; 1
<a name="l10213"></a>10213       || lsal_start-&gt;<a class="code" href="structlinespec__sals.html#a34ac2e438b2835722c998f409c85dcee">sals</a>.<a class="code" href="structsymtabs__and__lines.html#a1c8b832fc2f8c096c95144a2acedd36a">nelts</a> != 1)
<a name="l10214"></a>10214     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Cannot create a ranged breakpoint with multiple locations.&quot;</span>));
<a name="l10215"></a>10215 
<a name="l10216"></a>10216   sal_start = lsal_start-&gt;<a class="code" href="structlinespec__sals.html#a34ac2e438b2835722c998f409c85dcee">sals</a>.<a class="code" href="structsymtabs__and__lines.html#ab601f48fdf29c3b190ba068f57983df4">sals</a>[0];
<a name="l10217"></a>10217   addr_string_start = <a class="code" href="common-utils_8c.html#a5f388f89054b57d850779d7d71bc4d1c">savestring</a> (arg_start, arg - arg_start);
<a name="l10218"></a>10218   <a class="code" href="cleanups_8c.html#a3d418f8af424aec399898c2d48b26224">make_cleanup</a> (<a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a>, addr_string_start);
<a name="l10219"></a>10219 
<a name="l10220"></a>10220   arg++;        <span class="comment">/* Skip the comma.  */</span>
<a name="l10221"></a>10221   arg = <a class="code" href="cli-utils_8c.html#afa70bcaee54d487b4412d2a7a5a0c8fa">skip_spaces</a> (arg);
<a name="l10222"></a>10222 
<a name="l10223"></a>10223   <span class="comment">/* Parse the end location.  */</span>
<a name="l10224"></a>10224 
<a name="l10225"></a>10225   <a class="code" href="linespec_8c.html#a7264361d0a42e631634188c78dd8a96e">init_linespec_result</a> (&amp;canonical_end);
<a name="l10226"></a>10226   arg_start = arg;
<a name="l10227"></a>10227 
<a name="l10228"></a>10228   <span class="comment">/* We call decode_line_full directly here instead of using</span>
<a name="l10229"></a>10229 <span class="comment">     parse_breakpoint_sals because we need to specify the start location&#39;s</span>
<a name="l10230"></a>10230 <span class="comment">     symtab and line as the default symtab and line for the end of the</span>
<a name="l10231"></a>10231 <span class="comment">     range.  This makes it possible to have ranges like &quot;foo.c:27, +14&quot;,</span>
<a name="l10232"></a>10232 <span class="comment">     where +14 means 14 lines from the start location.  */</span>
<a name="l10233"></a>10233   <a class="code" href="linespec_8c.html#af57ff2f3f7a08d8b7f1d8c1fb3f24e12">decode_line_full</a> (&amp;arg, <a class="code" href="linespec_8h.html#a66db0c56cdf6b7d07a996c374a0572caadb5b3965c89f02bfa79f8871fde72588">DECODE_LINE_FUNFIRSTLINE</a>,
<a name="l10234"></a>10234                     sal_start.symtab, sal_start.line,
<a name="l10235"></a>10235                     &amp;canonical_end, NULL, NULL);
<a name="l10236"></a>10236 
<a name="l10237"></a>10237   <a class="code" href="linespec_8c.html#ac681b7d9043443fa8be585a1fcf735bf">make_cleanup_destroy_linespec_result</a> (&amp;canonical_end);
<a name="l10238"></a>10238 
<a name="l10239"></a>10239   <span class="keywordflow">if</span> (<a class="code" href="vec_8h.html#ac9981d313a5e114db0e05b7b9cd16319">VEC_empty</a> (<a class="code" href="structlinespec__sals.html">linespec_sals</a>, canonical_end.<a class="code" href="structlinespec__sals.html#a34ac2e438b2835722c998f409c85dcee">sals</a>))
<a name="l10240"></a>10240     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Could not find location of the end of the range.&quot;</span>));
<a name="l10241"></a>10241 
<a name="l10242"></a>10242   lsal_end = <a class="code" href="vec_8h.html#a49c128c353995ea8fca27be70829ca52">VEC_index</a> (<a class="code" href="structlinespec__sals.html">linespec_sals</a>, canonical_end.<a class="code" href="structlinespec__sals.html#a34ac2e438b2835722c998f409c85dcee">sals</a>, 0);
<a name="l10243"></a>10243   <span class="keywordflow">if</span> (<a class="code" href="vec_8h.html#a844523bba6d0565ef73a0f4a63e48d19">VEC_length</a> (<a class="code" href="structlinespec__sals.html">linespec_sals</a>, canonical_end.<a class="code" href="structlinespec__sals.html#a34ac2e438b2835722c998f409c85dcee">sals</a>) &gt; 1
<a name="l10244"></a>10244       || lsal_end-&gt;<a class="code" href="structlinespec__sals.html#a34ac2e438b2835722c998f409c85dcee">sals</a>.<a class="code" href="structsymtabs__and__lines.html#a1c8b832fc2f8c096c95144a2acedd36a">nelts</a> != 1)
<a name="l10245"></a>10245     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Cannot create a ranged breakpoint with multiple locations.&quot;</span>));
<a name="l10246"></a>10246 
<a name="l10247"></a>10247   sal_end = lsal_end-&gt;<a class="code" href="structlinespec__sals.html#a34ac2e438b2835722c998f409c85dcee">sals</a>.<a class="code" href="structsymtabs__and__lines.html#ab601f48fdf29c3b190ba068f57983df4">sals</a>[0];
<a name="l10248"></a>10248   addr_string_end = <a class="code" href="common-utils_8c.html#a5f388f89054b57d850779d7d71bc4d1c">savestring</a> (arg_start, arg - arg_start);
<a name="l10249"></a>10249   <a class="code" href="cleanups_8c.html#a3d418f8af424aec399898c2d48b26224">make_cleanup</a> (<a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a>, addr_string_end);
<a name="l10250"></a>10250 
<a name="l10251"></a>10251   end = find_breakpoint_range_end (sal_end);
<a name="l10252"></a>10252   <span class="keywordflow">if</span> (sal_start.pc &gt; end)
<a name="l10253"></a>10253     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Invalid address range, end precedes start.&quot;</span>));
<a name="l10254"></a>10254 
<a name="l10255"></a>10255   length = end - sal_start.pc + 1;
<a name="l10256"></a>10256   <span class="keywordflow">if</span> (length &lt; 0)
<a name="l10257"></a>10257     <span class="comment">/* Length overflowed.  */</span>
<a name="l10258"></a>10258     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Address range too large.&quot;</span>));
<a name="l10259"></a>10259   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (length == 1)
<a name="l10260"></a>10260     {
<a name="l10261"></a>10261       <span class="comment">/* This range is simple enough to be handled by</span>
<a name="l10262"></a>10262 <span class="comment">         the `hbreak&#39; command.  */</span>
<a name="l10263"></a>10263       hbreak_command (addr_string_start, 1);
<a name="l10264"></a>10264 
<a name="l10265"></a>10265       <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (cleanup_bkpt);
<a name="l10266"></a>10266 
<a name="l10267"></a>10267       <span class="keywordflow">return</span>;
<a name="l10268"></a>10268     }
<a name="l10269"></a>10269 
<a name="l10270"></a>10270   <span class="comment">/* Now set up the breakpoint.  */</span>
<a name="l10271"></a>10271   b = <a class="code" href="breakpoint_8c.html#a99e75dcf89d9291dc55db2453cb16a0a">set_raw_breakpoint</a> (<a class="code" href="arch-utils_8c.html#a0fe1e68475f442e5d6dda589e0c62454">get_current_arch</a> (), sal_start,
<a name="l10272"></a>10272                           <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa657fad68a9d83a24532fb06715b77628">bp_hardware_breakpoint</a>, &amp;ranged_breakpoint_ops);
<a name="l10273"></a>10273   set_breakpoint_count (breakpoint_count + 1);
<a name="l10274"></a>10274   b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a> = breakpoint_count;
<a name="l10275"></a>10275   b-&gt;<a class="code" href="structbreakpoint.html#a75f0f9a837eac292ab6e768e8d8f1bd7">disposition</a> = <a class="code" href="breakpoint_8h.html#a15f2bbd9012f59bc09d59feef0c15732a01c974d9083d524653d3a437364958be">disp_donttouch</a>;
<a name="l10276"></a>10276   b-&gt;<a class="code" href="structbreakpoint.html#a885e704e5cdcfc314069b970c396d1a4">addr_string</a> = xstrdup (addr_string_start);
<a name="l10277"></a>10277   b-&gt;<a class="code" href="structbreakpoint.html#a0bad27f6d3009411fec7525ff7e309d5">addr_string_range_end</a> = xstrdup (addr_string_end);
<a name="l10278"></a>10278   b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>-&gt;<a class="code" href="structbp__location.html#a3d4ad6914964554ca761607f9e8fab62">length</a> = length;
<a name="l10279"></a>10279 
<a name="l10280"></a>10280   <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (cleanup_bkpt);
<a name="l10281"></a>10281 
<a name="l10282"></a>10282   mention (b);
<a name="l10283"></a>10283   <a class="code" href="observer_8h.html#a85896e801e62bc45ccf32da4117d5d9c">observer_notify_breakpoint_created</a> (b);
<a name="l10284"></a>10284   update_global_location_list (1);
<a name="l10285"></a>10285 }
<a name="l10286"></a>10286 
<a name="l10287"></a>10287 <span class="comment">/*  Return non-zero if EXP is verified as constant.  Returned zero</span>
<a name="l10288"></a>10288 <span class="comment">    means EXP is variable.  Also the constant detection may fail for</span>
<a name="l10289"></a>10289 <span class="comment">    some constant expressions and in such case still falsely return</span>
<a name="l10290"></a>10290 <span class="comment">    zero.  */</span>
<a name="l10291"></a>10291 
<a name="l10292"></a>10292 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l10293"></a>10293 watchpoint_exp_is_const (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structexpression.html">expression</a> *exp)
<a name="l10294"></a>10294 {
<a name="l10295"></a>10295   <span class="keywordtype">int</span> i = exp-&gt;<a class="code" href="structexpression.html#ad5e1dbc7e3732d94d29b8c3d61696123">nelts</a>;
<a name="l10296"></a>10296 
<a name="l10297"></a>10297   <span class="keywordflow">while</span> (i &gt; 0)
<a name="l10298"></a>10298     {
<a name="l10299"></a>10299       <span class="keywordtype">int</span> oplenp, argsp;
<a name="l10300"></a>10300 
<a name="l10301"></a>10301       <span class="comment">/* We are only interested in the descriptor of each element.  */</span>
<a name="l10302"></a>10302       <a class="code" href="parse_8c.html#a0c5c1cb429e3f2236be9a18e3629913c">operator_length </a>(exp, i, &amp;oplenp, &amp;argsp);
<a name="l10303"></a>10303       i -= oplenp;
<a name="l10304"></a>10304 
<a name="l10305"></a>10305       <span class="keywordflow">switch</span> (exp-&gt;<a class="code" href="structexpression.html#a121cbb7647db0430c9e217dbcd27021f">elts</a>[i].<a class="code" href="unionexp__element.html#a732546b7148c98393e390e52d954bc83">opcode</a>)
<a name="l10306"></a>10306         {
<a name="l10307"></a>10307         <span class="keywordflow">case</span> BINOP_ADD:
<a name="l10308"></a>10308         <span class="keywordflow">case</span> BINOP_SUB:
<a name="l10309"></a>10309         <span class="keywordflow">case</span> BINOP_MUL:
<a name="l10310"></a>10310         <span class="keywordflow">case</span> BINOP_DIV:
<a name="l10311"></a>10311         <span class="keywordflow">case</span> BINOP_REM:
<a name="l10312"></a>10312         <span class="keywordflow">case</span> BINOP_MOD:
<a name="l10313"></a>10313         <span class="keywordflow">case</span> BINOP_LSH:
<a name="l10314"></a>10314         <span class="keywordflow">case</span> BINOP_RSH:
<a name="l10315"></a>10315         <span class="keywordflow">case</span> BINOP_LOGICAL_AND:
<a name="l10316"></a>10316         <span class="keywordflow">case</span> BINOP_LOGICAL_OR:
<a name="l10317"></a>10317         <span class="keywordflow">case</span> BINOP_BITWISE_AND:
<a name="l10318"></a>10318         <span class="keywordflow">case</span> BINOP_BITWISE_IOR:
<a name="l10319"></a>10319         <span class="keywordflow">case</span> BINOP_BITWISE_XOR:
<a name="l10320"></a>10320         <span class="keywordflow">case</span> BINOP_EQUAL:
<a name="l10321"></a>10321         <span class="keywordflow">case</span> BINOP_NOTEQUAL:
<a name="l10322"></a>10322         <span class="keywordflow">case</span> BINOP_LESS:
<a name="l10323"></a>10323         <span class="keywordflow">case</span> BINOP_GTR:
<a name="l10324"></a>10324         <span class="keywordflow">case</span> BINOP_LEQ:
<a name="l10325"></a>10325         <span class="keywordflow">case</span> BINOP_GEQ:
<a name="l10326"></a>10326         <span class="keywordflow">case</span> BINOP_REPEAT:
<a name="l10327"></a>10327         <span class="keywordflow">case</span> BINOP_COMMA:
<a name="l10328"></a>10328         <span class="keywordflow">case</span> BINOP_EXP:
<a name="l10329"></a>10329         <span class="keywordflow">case</span> BINOP_MIN:
<a name="l10330"></a>10330         <span class="keywordflow">case</span> BINOP_MAX:
<a name="l10331"></a>10331         <span class="keywordflow">case</span> BINOP_INTDIV:
<a name="l10332"></a>10332         <span class="keywordflow">case</span> BINOP_CONCAT:
<a name="l10333"></a>10333         <span class="keywordflow">case</span> BINOP_IN:
<a name="l10334"></a>10334         <span class="keywordflow">case</span> BINOP_RANGE:
<a name="l10335"></a>10335         <span class="keywordflow">case</span> TERNOP_COND:
<a name="l10336"></a>10336         <span class="keywordflow">case</span> TERNOP_SLICE:
<a name="l10337"></a>10337 
<a name="l10338"></a>10338         <span class="keywordflow">case</span> OP_LONG:
<a name="l10339"></a>10339         <span class="keywordflow">case</span> OP_DOUBLE:
<a name="l10340"></a>10340         <span class="keywordflow">case</span> OP_DECFLOAT:
<a name="l10341"></a>10341         <span class="keywordflow">case</span> OP_LAST:
<a name="l10342"></a>10342         <span class="keywordflow">case</span> OP_COMPLEX:
<a name="l10343"></a>10343         <span class="keywordflow">case</span> OP_STRING:
<a name="l10344"></a>10344         <span class="keywordflow">case</span> OP_ARRAY:
<a name="l10345"></a>10345         <span class="keywordflow">case</span> OP_TYPE:
<a name="l10346"></a>10346         <span class="keywordflow">case</span> OP_TYPEOF:
<a name="l10347"></a>10347         <span class="keywordflow">case</span> OP_DECLTYPE:
<a name="l10348"></a>10348         <span class="keywordflow">case</span> OP_TYPEID:
<a name="l10349"></a>10349         <span class="keywordflow">case</span> OP_NAME:
<a name="l10350"></a>10350         <span class="keywordflow">case</span> OP_OBJC_NSSTRING:
<a name="l10351"></a>10351 
<a name="l10352"></a>10352         <span class="keywordflow">case</span> UNOP_NEG:
<a name="l10353"></a>10353         <span class="keywordflow">case</span> UNOP_LOGICAL_NOT:
<a name="l10354"></a>10354         <span class="keywordflow">case</span> UNOP_COMPLEMENT:
<a name="l10355"></a>10355         <span class="keywordflow">case</span> UNOP_ADDR:
<a name="l10356"></a>10356         <span class="keywordflow">case</span> UNOP_HIGH:
<a name="l10357"></a>10357         <span class="keywordflow">case</span> UNOP_CAST:
<a name="l10358"></a>10358 
<a name="l10359"></a>10359         <span class="keywordflow">case</span> UNOP_CAST_TYPE:
<a name="l10360"></a>10360         <span class="keywordflow">case</span> UNOP_REINTERPRET_CAST:
<a name="l10361"></a>10361         <span class="keywordflow">case</span> UNOP_DYNAMIC_CAST:
<a name="l10362"></a>10362           <span class="comment">/* Unary, binary and ternary operators: We have to check</span>
<a name="l10363"></a>10363 <span class="comment">             their operands.  If they are constant, then so is the</span>
<a name="l10364"></a>10364 <span class="comment">             result of that operation.  For instance, if A and B are</span>
<a name="l10365"></a>10365 <span class="comment">             determined to be constants, then so is &quot;A + B&quot;.</span>
<a name="l10366"></a>10366 <span class="comment"></span>
<a name="l10367"></a>10367 <span class="comment">             UNOP_IND is one exception to the rule above, because the</span>
<a name="l10368"></a>10368 <span class="comment">             value of *ADDR is not necessarily a constant, even when</span>
<a name="l10369"></a>10369 <span class="comment">             ADDR is.  */</span>
<a name="l10370"></a>10370           <span class="keywordflow">break</span>;
<a name="l10371"></a>10371 
<a name="l10372"></a>10372         <span class="keywordflow">case</span> OP_VAR_VALUE:
<a name="l10373"></a>10373           <span class="comment">/* Check whether the associated symbol is a constant.</span>
<a name="l10374"></a>10374 <span class="comment"></span>
<a name="l10375"></a>10375 <span class="comment">             We use SYMBOL_CLASS rather than TYPE_CONST because it&#39;s</span>
<a name="l10376"></a>10376 <span class="comment">             possible that a buggy compiler could mark a variable as</span>
<a name="l10377"></a>10377 <span class="comment">             constant even when it is not, and TYPE_CONST would return</span>
<a name="l10378"></a>10378 <span class="comment">             true in this case, while SYMBOL_CLASS wouldn&#39;t.</span>
<a name="l10379"></a>10379 <span class="comment"></span>
<a name="l10380"></a>10380 <span class="comment">             We also have to check for function symbols because they</span>
<a name="l10381"></a>10381 <span class="comment">             are always constant.  */</span>
<a name="l10382"></a>10382           {
<a name="l10383"></a>10383             <span class="keyword">struct </span><a class="code" href="structsymbol.html">symbol</a> *s = exp-&gt;<a class="code" href="structexpression.html#a121cbb7647db0430c9e217dbcd27021f">elts</a>[i + 2].<a class="code" href="unionexp__element.html#aaa2c043e08e05f37c03379ca80dcc124">symbol</a>;
<a name="l10384"></a>10384 
<a name="l10385"></a>10385             <span class="keywordflow">if</span> (<a class="code" href="symtab_8h.html#a8394f2ba6c27e8026b2783db7cc0eb40">SYMBOL_CLASS</a> (s) != <a class="code" href="symtab_8h.html#a40bca6cf3ed5cfa15b1275e6750cdda3a1f1e8d54397f35889104cd7766fcec2b">LOC_BLOCK</a>
<a name="l10386"></a>10386                 &amp;&amp; <a class="code" href="symtab_8h.html#a8394f2ba6c27e8026b2783db7cc0eb40">SYMBOL_CLASS</a> (s) != <a class="code" href="symtab_8h.html#a40bca6cf3ed5cfa15b1275e6750cdda3a5268309778a6727d08106ff9f2966e54">LOC_CONST</a>
<a name="l10387"></a>10387                 &amp;&amp; <a class="code" href="symtab_8h.html#a8394f2ba6c27e8026b2783db7cc0eb40">SYMBOL_CLASS</a> (s) != <a class="code" href="symtab_8h.html#a40bca6cf3ed5cfa15b1275e6750cdda3a74c269ff88b13d3497422a9ebfd98b2d">LOC_CONST_BYTES</a>)
<a name="l10388"></a>10388               <span class="keywordflow">return</span> 0;
<a name="l10389"></a>10389             <span class="keywordflow">break</span>;
<a name="l10390"></a>10390           }
<a name="l10391"></a>10391 
<a name="l10392"></a>10392         <span class="comment">/* The default action is to return 0 because we are using</span>
<a name="l10393"></a>10393 <span class="comment">           the optimistic approach here: If we don&#39;t know something,</span>
<a name="l10394"></a>10394 <span class="comment">           then it is not a constant.  */</span>
<a name="l10395"></a>10395         <span class="keywordflow">default</span>:
<a name="l10396"></a>10396           <span class="keywordflow">return</span> 0;
<a name="l10397"></a>10397         }
<a name="l10398"></a>10398     }
<a name="l10399"></a>10399 
<a name="l10400"></a>10400   <span class="keywordflow">return</span> 1;
<a name="l10401"></a>10401 }
<a name="l10402"></a>10402 
<a name="l10403"></a>10403 <span class="comment">/* Implement the &quot;dtor&quot; breakpoint_ops method for watchpoints.  */</span>
<a name="l10404"></a>10404 
<a name="l10405"></a>10405 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l10406"></a>10406 dtor_watchpoint (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *<span class="keyword">self</span>)
<a name="l10407"></a>10407 {
<a name="l10408"></a>10408   <span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *w = (<span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *) <span class="keyword">self</span>;
<a name="l10409"></a>10409 
<a name="l10410"></a>10410   <a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a> (w-&gt;<a class="code" href="structwatchpoint.html#af56cdd0c2d7782c70177feb9b0d9e676">cond_exp</a>);
<a name="l10411"></a>10411   <a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a> (w-&gt;<a class="code" href="structwatchpoint.html#a10a51823c12ea43c95d767fb3a65d982">exp</a>);
<a name="l10412"></a>10412   <a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a> (w-&gt;<a class="code" href="structwatchpoint.html#a1464eddbdf2f6d8d6dff4a61097c8dc8">exp_string</a>);
<a name="l10413"></a>10413   <a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a> (w-&gt;<a class="code" href="structwatchpoint.html#a7e2fef584a035e0ea43d84b579946ed3">exp_string_reparse</a>);
<a name="l10414"></a>10414   <a class="code" href="value_8c.html#a1f9b3ee232ece65ddc75c2407b97a50d">value_free</a> (w-&gt;<a class="code" href="structwatchpoint.html#afafe9b6d8ed19e6c10764499cb35a7d1">val</a>);
<a name="l10415"></a>10415 
<a name="l10416"></a>10416   <a class="code" href="breakpoint_8c.html#aefe1d12780f2d7ae5fb89ac113e204e0">base_breakpoint_ops</a>.<a class="code" href="structbreakpoint__ops.html#a110b2df7b285e5f83bf40b9a0e5435c1">dtor</a> (<span class="keyword">self</span>);
<a name="l10417"></a>10417 }
<a name="l10418"></a>10418 
<a name="l10419"></a>10419 <span class="comment">/* Implement the &quot;re_set&quot; breakpoint_ops method for watchpoints.  */</span>
<a name="l10420"></a>10420 
<a name="l10421"></a>10421 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l10422"></a>10422 re_set_watchpoint (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b)
<a name="l10423"></a>10423 {
<a name="l10424"></a>10424   <span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *w = (<span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *) b;
<a name="l10425"></a>10425 
<a name="l10426"></a>10426   <span class="comment">/* Watchpoint can be either on expression using entirely global</span>
<a name="l10427"></a>10427 <span class="comment">     variables, or it can be on local variables.</span>
<a name="l10428"></a>10428 <span class="comment"></span>
<a name="l10429"></a>10429 <span class="comment">     Watchpoints of the first kind are never auto-deleted, and even</span>
<a name="l10430"></a>10430 <span class="comment">     persist across program restarts.  Since they can use variables</span>
<a name="l10431"></a>10431 <span class="comment">     from shared libraries, we need to reparse expression as libraries</span>
<a name="l10432"></a>10432 <span class="comment">     are loaded and unloaded.</span>
<a name="l10433"></a>10433 <span class="comment"></span>
<a name="l10434"></a>10434 <span class="comment">     Watchpoints on local variables can also change meaning as result</span>
<a name="l10435"></a>10435 <span class="comment">     of solib event.  For example, if a watchpoint uses both a local</span>
<a name="l10436"></a>10436 <span class="comment">     and a global variables in expression, it&#39;s a local watchpoint,</span>
<a name="l10437"></a>10437 <span class="comment">     but unloading of a shared library will make the expression</span>
<a name="l10438"></a>10438 <span class="comment">     invalid.  This is not a very common use case, but we still</span>
<a name="l10439"></a>10439 <span class="comment">     re-evaluate expression, to avoid surprises to the user.</span>
<a name="l10440"></a>10440 <span class="comment"></span>
<a name="l10441"></a>10441 <span class="comment">     Note that for local watchpoints, we re-evaluate it only if</span>
<a name="l10442"></a>10442 <span class="comment">     watchpoints frame id is still valid.  If it&#39;s not, it means the</span>
<a name="l10443"></a>10443 <span class="comment">     watchpoint is out of scope and will be deleted soon.  In fact,</span>
<a name="l10444"></a>10444 <span class="comment">     I&#39;m not sure we&#39;ll ever be called in this case.</span>
<a name="l10445"></a>10445 <span class="comment"></span>
<a name="l10446"></a>10446 <span class="comment">     If a local watchpoint&#39;s frame id is still valid, then</span>
<a name="l10447"></a>10447 <span class="comment">     w-&gt;exp_valid_block is likewise valid, and we can safely use it.</span>
<a name="l10448"></a>10448 <span class="comment"></span>
<a name="l10449"></a>10449 <span class="comment">     Don&#39;t do anything about disabled watchpoints, since they will be</span>
<a name="l10450"></a>10450 <span class="comment">     reevaluated again when enabled.  */</span>
<a name="l10451"></a>10451   update_watchpoint (w, 1 <span class="comment">/* reparse */</span>);
<a name="l10452"></a>10452 }
<a name="l10453"></a>10453 
<a name="l10454"></a>10454 <span class="comment">/* Implement the &quot;insert&quot; breakpoint_ops method for hardware watchpoints.  */</span>
<a name="l10455"></a>10455 
<a name="l10456"></a>10456 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l10457"></a>10457 insert_watchpoint (<span class="keyword">struct</span> bp_location *bl)
<a name="l10458"></a>10458 {
<a name="l10459"></a>10459   <span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *w = (<span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *) bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>;
<a name="l10460"></a>10460   <span class="keywordtype">int</span> length = w-&gt;<a class="code" href="structwatchpoint.html#a2fc9d822f077ae06bdfd6fa2aca9a255">exact</a> ? 1 : bl-&gt;<a class="code" href="structbp__location.html#a3d4ad6914964554ca761607f9e8fab62">length</a>;
<a name="l10461"></a>10461 
<a name="l10462"></a>10462   <span class="keywordflow">return</span> <a class="code" href="target_8h.html#a1152278135f165459d5d9cbbd96ee789">target_insert_watchpoint</a> (bl-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>, length, bl-&gt;<a class="code" href="structbp__location.html#a0480880dc590f47b72d7af91ab5d5802">watchpoint_type</a>,
<a name="l10463"></a>10463                                    w-&gt;<a class="code" href="structwatchpoint.html#af56cdd0c2d7782c70177feb9b0d9e676">cond_exp</a>);
<a name="l10464"></a>10464 }
<a name="l10465"></a>10465 
<a name="l10466"></a>10466 <span class="comment">/* Implement the &quot;remove&quot; breakpoint_ops method for hardware watchpoints.  */</span>
<a name="l10467"></a>10467 
<a name="l10468"></a>10468 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l10469"></a>10469 remove_watchpoint (<span class="keyword">struct</span> bp_location *bl)
<a name="l10470"></a>10470 {
<a name="l10471"></a>10471   <span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *w = (<span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *) bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>;
<a name="l10472"></a>10472   <span class="keywordtype">int</span> length = w-&gt;<a class="code" href="structwatchpoint.html#a2fc9d822f077ae06bdfd6fa2aca9a255">exact</a> ? 1 : bl-&gt;<a class="code" href="structbp__location.html#a3d4ad6914964554ca761607f9e8fab62">length</a>;
<a name="l10473"></a>10473 
<a name="l10474"></a>10474   <span class="keywordflow">return</span> <a class="code" href="target_8h.html#acf13215db3791a1060edbccedf812fbc">target_remove_watchpoint</a> (bl-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>, length, bl-&gt;<a class="code" href="structbp__location.html#a0480880dc590f47b72d7af91ab5d5802">watchpoint_type</a>,
<a name="l10475"></a>10475                                    w-&gt;<a class="code" href="structwatchpoint.html#af56cdd0c2d7782c70177feb9b0d9e676">cond_exp</a>);
<a name="l10476"></a>10476 }
<a name="l10477"></a>10477 
<a name="l10478"></a>10478 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l10479"></a>10479 breakpoint_hit_watchpoint (<span class="keyword">const</span> <span class="keyword">struct</span> bp_location *bl,
<a name="l10480"></a>10480                            <span class="keyword">struct</span> address_space *aspace, <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> bp_addr,
<a name="l10481"></a>10481                            <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structtarget__waitstatus.html">target_waitstatus</a> *ws)
<a name="l10482"></a>10482 {
<a name="l10483"></a>10483   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b = bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>;
<a name="l10484"></a>10484   <span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *w = (<span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *) b;
<a name="l10485"></a>10485 
<a name="l10486"></a>10486   <span class="comment">/* Continuable hardware watchpoints are treated as non-existent if the</span>
<a name="l10487"></a>10487 <span class="comment">     reason we stopped wasn&#39;t a hardware watchpoint (we didn&#39;t stop on</span>
<a name="l10488"></a>10488 <span class="comment">     some data address).  Otherwise gdb won&#39;t stop on a break instruction</span>
<a name="l10489"></a>10489 <span class="comment">     in the code (not from a breakpoint) when a hardware watchpoint has</span>
<a name="l10490"></a>10490 <span class="comment">     been defined.  Also skip watchpoints which we know did not trigger</span>
<a name="l10491"></a>10491 <span class="comment">     (did not match the data address).  */</span>
<a name="l10492"></a>10492   <span class="keywordflow">if</span> (is_hardware_watchpoint (b)
<a name="l10493"></a>10493       &amp;&amp; w-&gt;<a class="code" href="structwatchpoint.html#ad73d8e3d495e46d149b23a36b225daba">watchpoint_triggered</a> == <a class="code" href="breakpoint_8h.html#aee5eff1f9c0902dcf85bf1a18c2a1bdea0fd19712ffeb3d885b686c77b7d49b7f">watch_triggered_no</a>)
<a name="l10494"></a>10494     <span class="keywordflow">return</span> 0;
<a name="l10495"></a>10495 
<a name="l10496"></a>10496   <span class="keywordflow">return</span> 1;
<a name="l10497"></a>10497 }
<a name="l10498"></a>10498 
<a name="l10499"></a>10499 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l10500"></a>10500 check_status_watchpoint (<a class="code" href="structbpstats.html">bpstat</a> bs)
<a name="l10501"></a>10501 {
<a name="l10502"></a>10502   <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (<a class="code" href="breakpoint_8c.html#a49f0d5ff628dd506db5b81f660eb4610">is_watchpoint</a> (bs-&gt;<a class="code" href="structbpstats.html#ac105ed7263dd10f9d65e92e706b04e39">breakpoint_at</a>));
<a name="l10503"></a>10503 
<a name="l10504"></a>10504   bpstat_check_watchpoint (bs);
<a name="l10505"></a>10505 }
<a name="l10506"></a>10506 
<a name="l10507"></a>10507 <span class="comment">/* Implement the &quot;resources_needed&quot; breakpoint_ops method for</span>
<a name="l10508"></a>10508 <span class="comment">   hardware watchpoints.  */</span>
<a name="l10509"></a>10509 
<a name="l10510"></a>10510 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l10511"></a>10511 resources_needed_watchpoint (<span class="keyword">const</span> <span class="keyword">struct</span> bp_location *bl)
<a name="l10512"></a>10512 {
<a name="l10513"></a>10513   <span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *w = (<span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *) bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>;
<a name="l10514"></a>10514   <span class="keywordtype">int</span> length = w-&gt;<a class="code" href="structwatchpoint.html#a2fc9d822f077ae06bdfd6fa2aca9a255">exact</a>? 1 : bl-&gt;<a class="code" href="structbp__location.html#a3d4ad6914964554ca761607f9e8fab62">length</a>;
<a name="l10515"></a>10515 
<a name="l10516"></a>10516   <span class="keywordflow">return</span> <a class="code" href="target_8h.html#a3c3f8624352b0e6674a4eb1ddeae1a2f">target_region_ok_for_hw_watchpoint</a> (bl-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>, length);
<a name="l10517"></a>10517 }
<a name="l10518"></a>10518 
<a name="l10519"></a>10519 <span class="comment">/* Implement the &quot;works_in_software_mode&quot; breakpoint_ops method for</span>
<a name="l10520"></a>10520 <span class="comment">   hardware watchpoints.  */</span>
<a name="l10521"></a>10521 
<a name="l10522"></a>10522 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l10523"></a>10523 works_in_software_mode_watchpoint (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b)
<a name="l10524"></a>10524 {
<a name="l10525"></a>10525   <span class="comment">/* Read and access watchpoints only work with hardware support.  */</span>
<a name="l10526"></a>10526   <span class="keywordflow">return</span> b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa2a35cc5d65b66d6228def5615d6827ce">bp_watchpoint</a> || b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfae38a33f5a6725fbca8b5da2d491cfbcb">bp_hardware_watchpoint</a>;
<a name="l10527"></a>10527 }
<a name="l10528"></a>10528 
<a name="l10529"></a>10529 <span class="keyword">static</span> <span class="keyword">enum</span> <a class="code" href="breakpoint_8h.html#ab6ab1d6a867561653e32a901b41be66b">print_stop_action</a>
<a name="l10530"></a>10530 print_it_watchpoint (<a class="code" href="structbpstats.html">bpstat</a> bs)
<a name="l10531"></a>10531 {
<a name="l10532"></a>10532   <span class="keyword">struct </span>cleanup *old_chain;
<a name="l10533"></a>10533   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b;
<a name="l10534"></a>10534   <span class="keyword">struct </span>ui_file *stb;
<a name="l10535"></a>10535   <span class="keyword">enum</span> <a class="code" href="breakpoint_8h.html#ab6ab1d6a867561653e32a901b41be66b">print_stop_action</a> result;
<a name="l10536"></a>10536   <span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *w;
<a name="l10537"></a>10537   <span class="keyword">struct </span>ui_out *uiout = <a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>;
<a name="l10538"></a>10538 
<a name="l10539"></a>10539   <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (bs-&gt;<a class="code" href="structbpstats.html#a510428e7ce2e4852e0613b3b5579142b">bp_location_at</a> != NULL);
<a name="l10540"></a>10540 
<a name="l10541"></a>10541   b = bs-&gt;<a class="code" href="structbpstats.html#ac105ed7263dd10f9d65e92e706b04e39">breakpoint_at</a>;
<a name="l10542"></a>10542   w = (<span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *) b;
<a name="l10543"></a>10543 
<a name="l10544"></a>10544   stb = <a class="code" href="ui-file_8c.html#a340771735f105582d314e191a399a45c">mem_fileopen</a> ();
<a name="l10545"></a>10545   old_chain = <a class="code" href="utils_8c.html#a94dc56baeb57791e114136764f7763aa">make_cleanup_ui_file_delete</a> (stb);
<a name="l10546"></a>10546 
<a name="l10547"></a>10547   <span class="keywordflow">switch</span> (b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a>)
<a name="l10548"></a>10548     {
<a name="l10549"></a>10549     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa2a35cc5d65b66d6228def5615d6827ce">bp_watchpoint</a>:
<a name="l10550"></a>10550     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfae38a33f5a6725fbca8b5da2d491cfbcb">bp_hardware_watchpoint</a>:
<a name="l10551"></a>10551       <a class="code" href="annotate_8c.html#a38c8a56127baab4f19b461aafbb674a3">annotate_watchpoint</a> (b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>);
<a name="l10552"></a>10552       <span class="keywordflow">if</span> (<a class="code" href="ui-out_8c.html#a473db54efcfbc60feeb5a4f54f27af46">ui_out_is_mi_like_p</a> (uiout))
<a name="l10553"></a>10553         <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a>
<a name="l10554"></a>10554           (uiout, <span class="stringliteral">&quot;reason&quot;</span>,
<a name="l10555"></a>10555            <a class="code" href="mi-common_8c.html#a619e7d180d78af6e6d63a611c6680e90">async_reason_lookup</a> (<a class="code" href="mi-common_8h.html#a06d7bf56f98dcc556d686f49ea570daea659322566d803f0a7fa909a031714925">EXEC_ASYNC_WATCHPOINT_TRIGGER</a>));
<a name="l10556"></a>10556       mention (b);
<a name="l10557"></a>10557       <a class="code" href="ui-out_8c.html#aaf5a0c991d74ad2e486f420d5c2ff058">make_cleanup_ui_out_tuple_begin_end</a> (uiout, <span class="stringliteral">&quot;value&quot;</span>);
<a name="l10558"></a>10558       <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;\nOld value = &quot;</span>);
<a name="l10559"></a>10559       watchpoint_value_print (bs-&gt;<a class="code" href="structbpstats.html#aa68c6ad7e88a1d21640560008a44c287">old_val</a>, stb);
<a name="l10560"></a>10560       <a class="code" href="ui-out_8c.html#a40106bb0446639417c75a408194a8eee">ui_out_field_stream</a> (uiout, <span class="stringliteral">&quot;old&quot;</span>, stb);
<a name="l10561"></a>10561       <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;\nNew value = &quot;</span>);
<a name="l10562"></a>10562       watchpoint_value_print (w-&gt;<a class="code" href="structwatchpoint.html#afafe9b6d8ed19e6c10764499cb35a7d1">val</a>, stb);
<a name="l10563"></a>10563       <a class="code" href="ui-out_8c.html#a40106bb0446639417c75a408194a8eee">ui_out_field_stream</a> (uiout, <span class="stringliteral">&quot;new&quot;</span>, stb);
<a name="l10564"></a>10564       <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;\n&quot;</span>);
<a name="l10565"></a>10565       <span class="comment">/* More than one watchpoint may have been triggered.  */</span>
<a name="l10566"></a>10566       result = <a class="code" href="breakpoint_8h.html#ab6ab1d6a867561653e32a901b41be66ba84f0c3d5c073b6e26479e7b2ae2c7df0">PRINT_UNKNOWN</a>;
<a name="l10567"></a>10567       <span class="keywordflow">break</span>;
<a name="l10568"></a>10568 
<a name="l10569"></a>10569     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa7013ee22be60f470b10b2de2f9d22c21">bp_read_watchpoint</a>:
<a name="l10570"></a>10570       <span class="keywordflow">if</span> (<a class="code" href="ui-out_8c.html#a473db54efcfbc60feeb5a4f54f27af46">ui_out_is_mi_like_p</a> (uiout))
<a name="l10571"></a>10571         <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a>
<a name="l10572"></a>10572           (uiout, <span class="stringliteral">&quot;reason&quot;</span>,
<a name="l10573"></a>10573            <a class="code" href="mi-common_8c.html#a619e7d180d78af6e6d63a611c6680e90">async_reason_lookup</a> (<a class="code" href="mi-common_8h.html#a06d7bf56f98dcc556d686f49ea570daeab86707c6330273aa385d7df9c9341fd4">EXEC_ASYNC_READ_WATCHPOINT_TRIGGER</a>));
<a name="l10574"></a>10574       mention (b);
<a name="l10575"></a>10575       <a class="code" href="ui-out_8c.html#aaf5a0c991d74ad2e486f420d5c2ff058">make_cleanup_ui_out_tuple_begin_end</a> (uiout, <span class="stringliteral">&quot;value&quot;</span>);
<a name="l10576"></a>10576       <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;\nValue = &quot;</span>);
<a name="l10577"></a>10577       watchpoint_value_print (w-&gt;<a class="code" href="structwatchpoint.html#afafe9b6d8ed19e6c10764499cb35a7d1">val</a>, stb);
<a name="l10578"></a>10578       <a class="code" href="ui-out_8c.html#a40106bb0446639417c75a408194a8eee">ui_out_field_stream</a> (uiout, <span class="stringliteral">&quot;value&quot;</span>, stb);
<a name="l10579"></a>10579       <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;\n&quot;</span>);
<a name="l10580"></a>10580       result = <a class="code" href="breakpoint_8h.html#ab6ab1d6a867561653e32a901b41be66ba84f0c3d5c073b6e26479e7b2ae2c7df0">PRINT_UNKNOWN</a>;
<a name="l10581"></a>10581       <span class="keywordflow">break</span>;
<a name="l10582"></a>10582 
<a name="l10583"></a>10583     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa9148c330e0f813ed6fb421af9d7da820">bp_access_watchpoint</a>:
<a name="l10584"></a>10584       <span class="keywordflow">if</span> (bs-&gt;<a class="code" href="structbpstats.html#aa68c6ad7e88a1d21640560008a44c287">old_val</a> != NULL)
<a name="l10585"></a>10585         {
<a name="l10586"></a>10586           <a class="code" href="annotate_8c.html#a38c8a56127baab4f19b461aafbb674a3">annotate_watchpoint</a> (b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>);
<a name="l10587"></a>10587           <span class="keywordflow">if</span> (<a class="code" href="ui-out_8c.html#a473db54efcfbc60feeb5a4f54f27af46">ui_out_is_mi_like_p</a> (uiout))
<a name="l10588"></a>10588             <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a>
<a name="l10589"></a>10589               (uiout, <span class="stringliteral">&quot;reason&quot;</span>,
<a name="l10590"></a>10590                <a class="code" href="mi-common_8c.html#a619e7d180d78af6e6d63a611c6680e90">async_reason_lookup</a> (<a class="code" href="mi-common_8h.html#a06d7bf56f98dcc556d686f49ea570daea4ed35b6cf18cff80b982e35767a67df3">EXEC_ASYNC_ACCESS_WATCHPOINT_TRIGGER</a>));
<a name="l10591"></a>10591           mention (b);
<a name="l10592"></a>10592           <a class="code" href="ui-out_8c.html#aaf5a0c991d74ad2e486f420d5c2ff058">make_cleanup_ui_out_tuple_begin_end</a> (uiout, <span class="stringliteral">&quot;value&quot;</span>);
<a name="l10593"></a>10593           <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;\nOld value = &quot;</span>);
<a name="l10594"></a>10594           watchpoint_value_print (bs-&gt;<a class="code" href="structbpstats.html#aa68c6ad7e88a1d21640560008a44c287">old_val</a>, stb);
<a name="l10595"></a>10595           <a class="code" href="ui-out_8c.html#a40106bb0446639417c75a408194a8eee">ui_out_field_stream</a> (uiout, <span class="stringliteral">&quot;old&quot;</span>, stb);
<a name="l10596"></a>10596           <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;\nNew value = &quot;</span>);
<a name="l10597"></a>10597         }
<a name="l10598"></a>10598       <span class="keywordflow">else</span>
<a name="l10599"></a>10599         {
<a name="l10600"></a>10600           mention (b);
<a name="l10601"></a>10601           <span class="keywordflow">if</span> (<a class="code" href="ui-out_8c.html#a473db54efcfbc60feeb5a4f54f27af46">ui_out_is_mi_like_p</a> (uiout))
<a name="l10602"></a>10602             <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a>
<a name="l10603"></a>10603               (uiout, <span class="stringliteral">&quot;reason&quot;</span>,
<a name="l10604"></a>10604                <a class="code" href="mi-common_8c.html#a619e7d180d78af6e6d63a611c6680e90">async_reason_lookup</a> (<a class="code" href="mi-common_8h.html#a06d7bf56f98dcc556d686f49ea570daea4ed35b6cf18cff80b982e35767a67df3">EXEC_ASYNC_ACCESS_WATCHPOINT_TRIGGER</a>));
<a name="l10605"></a>10605           <a class="code" href="ui-out_8c.html#aaf5a0c991d74ad2e486f420d5c2ff058">make_cleanup_ui_out_tuple_begin_end</a> (uiout, <span class="stringliteral">&quot;value&quot;</span>);
<a name="l10606"></a>10606           <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;\nValue = &quot;</span>);
<a name="l10607"></a>10607         }
<a name="l10608"></a>10608       watchpoint_value_print (w-&gt;<a class="code" href="structwatchpoint.html#afafe9b6d8ed19e6c10764499cb35a7d1">val</a>, stb);
<a name="l10609"></a>10609       <a class="code" href="ui-out_8c.html#a40106bb0446639417c75a408194a8eee">ui_out_field_stream</a> (uiout, <span class="stringliteral">&quot;new&quot;</span>, stb);
<a name="l10610"></a>10610       <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;\n&quot;</span>);
<a name="l10611"></a>10611       result = <a class="code" href="breakpoint_8h.html#ab6ab1d6a867561653e32a901b41be66ba84f0c3d5c073b6e26479e7b2ae2c7df0">PRINT_UNKNOWN</a>;
<a name="l10612"></a>10612       <span class="keywordflow">break</span>;
<a name="l10613"></a>10613     <span class="keywordflow">default</span>:
<a name="l10614"></a>10614       result = <a class="code" href="breakpoint_8h.html#ab6ab1d6a867561653e32a901b41be66ba84f0c3d5c073b6e26479e7b2ae2c7df0">PRINT_UNKNOWN</a>;
<a name="l10615"></a>10615     }
<a name="l10616"></a>10616 
<a name="l10617"></a>10617   <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (old_chain);
<a name="l10618"></a>10618   <span class="keywordflow">return</span> result;
<a name="l10619"></a>10619 }
<a name="l10620"></a>10620 
<a name="l10621"></a>10621 <span class="comment">/* Implement the &quot;print_mention&quot; breakpoint_ops method for hardware</span>
<a name="l10622"></a>10622 <span class="comment">   watchpoints.  */</span>
<a name="l10623"></a>10623 
<a name="l10624"></a>10624 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l10625"></a>10625 print_mention_watchpoint (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b)
<a name="l10626"></a>10626 {
<a name="l10627"></a>10627   <span class="keyword">struct </span>cleanup *ui_out_chain;
<a name="l10628"></a>10628   <span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *w = (<span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *) b;
<a name="l10629"></a>10629   <span class="keyword">struct </span>ui_out *uiout = <a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>;
<a name="l10630"></a>10630 
<a name="l10631"></a>10631   <span class="keywordflow">switch</span> (b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a>)
<a name="l10632"></a>10632     {
<a name="l10633"></a>10633     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa2a35cc5d65b66d6228def5615d6827ce">bp_watchpoint</a>:
<a name="l10634"></a>10634       <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;Watchpoint &quot;</span>);
<a name="l10635"></a>10635       ui_out_chain = <a class="code" href="ui-out_8c.html#aaf5a0c991d74ad2e486f420d5c2ff058">make_cleanup_ui_out_tuple_begin_end</a> (uiout, <span class="stringliteral">&quot;wpt&quot;</span>);
<a name="l10636"></a>10636       <span class="keywordflow">break</span>;
<a name="l10637"></a>10637     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfae38a33f5a6725fbca8b5da2d491cfbcb">bp_hardware_watchpoint</a>:
<a name="l10638"></a>10638       <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;Hardware watchpoint &quot;</span>);
<a name="l10639"></a>10639       ui_out_chain = <a class="code" href="ui-out_8c.html#aaf5a0c991d74ad2e486f420d5c2ff058">make_cleanup_ui_out_tuple_begin_end</a> (uiout, <span class="stringliteral">&quot;wpt&quot;</span>);
<a name="l10640"></a>10640       <span class="keywordflow">break</span>;
<a name="l10641"></a>10641     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa7013ee22be60f470b10b2de2f9d22c21">bp_read_watchpoint</a>:
<a name="l10642"></a>10642       <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;Hardware read watchpoint &quot;</span>);
<a name="l10643"></a>10643       ui_out_chain = <a class="code" href="ui-out_8c.html#aaf5a0c991d74ad2e486f420d5c2ff058">make_cleanup_ui_out_tuple_begin_end</a> (uiout, <span class="stringliteral">&quot;hw-rwpt&quot;</span>);
<a name="l10644"></a>10644       <span class="keywordflow">break</span>;
<a name="l10645"></a>10645     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa9148c330e0f813ed6fb421af9d7da820">bp_access_watchpoint</a>:
<a name="l10646"></a>10646       <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;Hardware access (read/write) watchpoint &quot;</span>);
<a name="l10647"></a>10647       ui_out_chain = <a class="code" href="ui-out_8c.html#aaf5a0c991d74ad2e486f420d5c2ff058">make_cleanup_ui_out_tuple_begin_end</a> (uiout, <span class="stringliteral">&quot;hw-awpt&quot;</span>);
<a name="l10648"></a>10648       <span class="keywordflow">break</span>;
<a name="l10649"></a>10649     <span class="keywordflow">default</span>:
<a name="l10650"></a>10650       <a class="code" href="common-utils_8h.html#aa14285d9d3d4171016ef9cf09447e8bb">internal_error</a> (__FILE__, __LINE__,
<a name="l10651"></a>10651                       <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Invalid hardware watchpoint type.&quot;</span>));
<a name="l10652"></a>10652     }
<a name="l10653"></a>10653 
<a name="l10654"></a>10654   <a class="code" href="ui-out_8c.html#aa6f66551d03db456fb94ca1c9038f5a0">ui_out_field_int</a> (uiout, <span class="stringliteral">&quot;number&quot;</span>, b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>);
<a name="l10655"></a>10655   <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;: &quot;</span>);
<a name="l10656"></a>10656   <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a> (uiout, <span class="stringliteral">&quot;exp&quot;</span>, w-&gt;<a class="code" href="structwatchpoint.html#a1464eddbdf2f6d8d6dff4a61097c8dc8">exp_string</a>);
<a name="l10657"></a>10657   <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (ui_out_chain);
<a name="l10658"></a>10658 }
<a name="l10659"></a>10659 
<a name="l10660"></a>10660 <span class="comment">/* Implement the &quot;print_recreate&quot; breakpoint_ops method for</span>
<a name="l10661"></a>10661 <span class="comment">   watchpoints.  */</span>
<a name="l10662"></a>10662 
<a name="l10663"></a>10663 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l10664"></a>10664 print_recreate_watchpoint (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b, <span class="keyword">struct</span> ui_file *fp)
<a name="l10665"></a>10665 {
<a name="l10666"></a>10666   <span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *w = (<span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *) b;
<a name="l10667"></a>10667 
<a name="l10668"></a>10668   <span class="keywordflow">switch</span> (b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a>)
<a name="l10669"></a>10669     {
<a name="l10670"></a>10670     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa2a35cc5d65b66d6228def5615d6827ce">bp_watchpoint</a>:
<a name="l10671"></a>10671     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfae38a33f5a6725fbca8b5da2d491cfbcb">bp_hardware_watchpoint</a>:
<a name="l10672"></a>10672       <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (fp, <span class="stringliteral">&quot;watch&quot;</span>);
<a name="l10673"></a>10673       <span class="keywordflow">break</span>;
<a name="l10674"></a>10674     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa7013ee22be60f470b10b2de2f9d22c21">bp_read_watchpoint</a>:
<a name="l10675"></a>10675       <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (fp, <span class="stringliteral">&quot;rwatch&quot;</span>);
<a name="l10676"></a>10676       <span class="keywordflow">break</span>;
<a name="l10677"></a>10677     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa9148c330e0f813ed6fb421af9d7da820">bp_access_watchpoint</a>:
<a name="l10678"></a>10678       <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (fp, <span class="stringliteral">&quot;awatch&quot;</span>);
<a name="l10679"></a>10679       <span class="keywordflow">break</span>;
<a name="l10680"></a>10680     <span class="keywordflow">default</span>:
<a name="l10681"></a>10681       <a class="code" href="common-utils_8h.html#aa14285d9d3d4171016ef9cf09447e8bb">internal_error</a> (__FILE__, __LINE__,
<a name="l10682"></a>10682                       <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Invalid watchpoint type.&quot;</span>));
<a name="l10683"></a>10683     }
<a name="l10684"></a>10684 
<a name="l10685"></a>10685   <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (fp, <span class="stringliteral">&quot; %s&quot;</span>, w-&gt;<a class="code" href="structwatchpoint.html#a1464eddbdf2f6d8d6dff4a61097c8dc8">exp_string</a>);
<a name="l10686"></a>10686   <a class="code" href="breakpoint_8c.html#aae7cd38b01782db6011bcd0150059625">print_recreate_thread</a> (b, fp);
<a name="l10687"></a>10687 }
<a name="l10688"></a>10688 
<a name="l10689"></a>10689 <span class="comment">/* Implement the &quot;explains_signal&quot; breakpoint_ops method for</span>
<a name="l10690"></a>10690 <span class="comment">   watchpoints.  */</span>
<a name="l10691"></a>10691 
<a name="l10692"></a>10692 <span class="keyword">static</span> <span class="keyword">enum</span> <a class="code" href="breakpoint_8h.html#a5ac39ee414da54677fa916b1d5579d6f">bpstat_signal_value</a>
<a name="l10693"></a>10693 explains_signal_watchpoint (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b, <span class="keyword">enum</span> <a class="code" href="signals_8h.html#a1169a44d7b94bdcf747c3f69138dafe7">gdb_signal</a> sig)
<a name="l10694"></a>10694 {
<a name="l10695"></a>10695   <span class="comment">/* A software watchpoint cannot cause a signal other than</span>
<a name="l10696"></a>10696 <span class="comment">     GDB_SIGNAL_TRAP.  */</span>
<a name="l10697"></a>10697   <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa2a35cc5d65b66d6228def5615d6827ce">bp_watchpoint</a> &amp;&amp; sig != GDB_SIGNAL_TRAP)
<a name="l10698"></a>10698     <span class="keywordflow">return</span> <a class="code" href="breakpoint_8h.html#a5ac39ee414da54677fa916b1d5579d6fa334caf0845d82433a64ddb70eeef7b46">BPSTAT_SIGNAL_NO</a>;
<a name="l10699"></a>10699 
<a name="l10700"></a>10700   <span class="keywordflow">return</span> <a class="code" href="breakpoint_8h.html#a5ac39ee414da54677fa916b1d5579d6fa7c293d7c0de70c6e2549b8fc0e84cbfe">BPSTAT_SIGNAL_HIDE</a>;
<a name="l10701"></a>10701 }
<a name="l10702"></a>10702 
<a name="l10703"></a>10703 <span class="comment">/* The breakpoint_ops structure to be used in hardware watchpoints.  */</span>
<a name="l10704"></a>10704 
<a name="l10705"></a>10705 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structbreakpoint__ops.html">breakpoint_ops</a> watchpoint_breakpoint_ops;
<a name="l10706"></a>10706 
<a name="l10707"></a>10707 <span class="comment">/* Implement the &quot;insert&quot; breakpoint_ops method for</span>
<a name="l10708"></a>10708 <span class="comment">   masked hardware watchpoints.  */</span>
<a name="l10709"></a>10709 
<a name="l10710"></a>10710 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l10711"></a>10711 insert_masked_watchpoint (<span class="keyword">struct</span> bp_location *bl)
<a name="l10712"></a>10712 {
<a name="l10713"></a>10713   <span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *w = (<span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *) bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>;
<a name="l10714"></a>10714 
<a name="l10715"></a>10715   <span class="keywordflow">return</span> <a class="code" href="target_8c.html#a9d5ee306e205fd68ad1b0c07d298fbe7">target_insert_mask_watchpoint</a> (bl-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>, w-&gt;<a class="code" href="structwatchpoint.html#a8d9efbe7ba574b6af52dec3d99ab28a3">hw_wp_mask</a>,
<a name="l10716"></a>10716                                         bl-&gt;<a class="code" href="structbp__location.html#a0480880dc590f47b72d7af91ab5d5802">watchpoint_type</a>);
<a name="l10717"></a>10717 }
<a name="l10718"></a>10718 
<a name="l10719"></a>10719 <span class="comment">/* Implement the &quot;remove&quot; breakpoint_ops method for</span>
<a name="l10720"></a>10720 <span class="comment">   masked hardware watchpoints.  */</span>
<a name="l10721"></a>10721 
<a name="l10722"></a>10722 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l10723"></a>10723 remove_masked_watchpoint (<span class="keyword">struct</span> bp_location *bl)
<a name="l10724"></a>10724 {
<a name="l10725"></a>10725   <span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *w = (<span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *) bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>;
<a name="l10726"></a>10726 
<a name="l10727"></a>10727   <span class="keywordflow">return</span> <a class="code" href="target_8c.html#a2921ea1fbdea7900197763eb813d3225">target_remove_mask_watchpoint</a> (bl-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>, w-&gt;<a class="code" href="structwatchpoint.html#a8d9efbe7ba574b6af52dec3d99ab28a3">hw_wp_mask</a>,
<a name="l10728"></a>10728                                         bl-&gt;<a class="code" href="structbp__location.html#a0480880dc590f47b72d7af91ab5d5802">watchpoint_type</a>);
<a name="l10729"></a>10729 }
<a name="l10730"></a>10730 
<a name="l10731"></a>10731 <span class="comment">/* Implement the &quot;resources_needed&quot; breakpoint_ops method for</span>
<a name="l10732"></a>10732 <span class="comment">   masked hardware watchpoints.  */</span>
<a name="l10733"></a>10733 
<a name="l10734"></a>10734 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l10735"></a>10735 resources_needed_masked_watchpoint (<span class="keyword">const</span> <span class="keyword">struct</span> bp_location *bl)
<a name="l10736"></a>10736 {
<a name="l10737"></a>10737   <span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *w = (<span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *) bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>;
<a name="l10738"></a>10738 
<a name="l10739"></a>10739   <span class="keywordflow">return</span> <a class="code" href="target_8c.html#a944308b624c22754954470cf8c974e0d">target_masked_watch_num_registers</a> (bl-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>, w-&gt;<a class="code" href="structwatchpoint.html#a8d9efbe7ba574b6af52dec3d99ab28a3">hw_wp_mask</a>);
<a name="l10740"></a>10740 }
<a name="l10741"></a>10741 
<a name="l10742"></a>10742 <span class="comment">/* Implement the &quot;works_in_software_mode&quot; breakpoint_ops method for</span>
<a name="l10743"></a>10743 <span class="comment">   masked hardware watchpoints.  */</span>
<a name="l10744"></a>10744 
<a name="l10745"></a>10745 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l10746"></a>10746 works_in_software_mode_masked_watchpoint (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b)
<a name="l10747"></a>10747 {
<a name="l10748"></a>10748   <span class="keywordflow">return</span> 0;
<a name="l10749"></a>10749 }
<a name="l10750"></a>10750 
<a name="l10751"></a>10751 <span class="comment">/* Implement the &quot;print_it&quot; breakpoint_ops method for</span>
<a name="l10752"></a>10752 <span class="comment">   masked hardware watchpoints.  */</span>
<a name="l10753"></a>10753 
<a name="l10754"></a>10754 <span class="keyword">static</span> <span class="keyword">enum</span> <a class="code" href="breakpoint_8h.html#ab6ab1d6a867561653e32a901b41be66b">print_stop_action</a>
<a name="l10755"></a>10755 print_it_masked_watchpoint (<a class="code" href="structbpstats.html">bpstat</a> bs)
<a name="l10756"></a>10756 {
<a name="l10757"></a>10757   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b = bs-&gt;<a class="code" href="structbpstats.html#ac105ed7263dd10f9d65e92e706b04e39">breakpoint_at</a>;
<a name="l10758"></a>10758   <span class="keyword">struct </span>ui_out *uiout = <a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>;
<a name="l10759"></a>10759 
<a name="l10760"></a>10760   <span class="comment">/* Masked watchpoints have only one location.  */</span>
<a name="l10761"></a>10761   <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a> &amp;&amp; b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>-&gt;<a class="code" href="structbp__location.html#ab193cb38f87fea89105db96d94191541">next</a> == NULL);
<a name="l10762"></a>10762 
<a name="l10763"></a>10763   <span class="keywordflow">switch</span> (b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a>)
<a name="l10764"></a>10764     {
<a name="l10765"></a>10765     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfae38a33f5a6725fbca8b5da2d491cfbcb">bp_hardware_watchpoint</a>:
<a name="l10766"></a>10766       <a class="code" href="annotate_8c.html#a38c8a56127baab4f19b461aafbb674a3">annotate_watchpoint</a> (b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>);
<a name="l10767"></a>10767       <span class="keywordflow">if</span> (<a class="code" href="ui-out_8c.html#a473db54efcfbc60feeb5a4f54f27af46">ui_out_is_mi_like_p</a> (uiout))
<a name="l10768"></a>10768         <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a>
<a name="l10769"></a>10769           (uiout, <span class="stringliteral">&quot;reason&quot;</span>,
<a name="l10770"></a>10770            <a class="code" href="mi-common_8c.html#a619e7d180d78af6e6d63a611c6680e90">async_reason_lookup</a> (<a class="code" href="mi-common_8h.html#a06d7bf56f98dcc556d686f49ea570daea659322566d803f0a7fa909a031714925">EXEC_ASYNC_WATCHPOINT_TRIGGER</a>));
<a name="l10771"></a>10771       <span class="keywordflow">break</span>;
<a name="l10772"></a>10772 
<a name="l10773"></a>10773     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa7013ee22be60f470b10b2de2f9d22c21">bp_read_watchpoint</a>:
<a name="l10774"></a>10774       <span class="keywordflow">if</span> (<a class="code" href="ui-out_8c.html#a473db54efcfbc60feeb5a4f54f27af46">ui_out_is_mi_like_p</a> (uiout))
<a name="l10775"></a>10775         <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a>
<a name="l10776"></a>10776           (uiout, <span class="stringliteral">&quot;reason&quot;</span>,
<a name="l10777"></a>10777            <a class="code" href="mi-common_8c.html#a619e7d180d78af6e6d63a611c6680e90">async_reason_lookup</a> (<a class="code" href="mi-common_8h.html#a06d7bf56f98dcc556d686f49ea570daeab86707c6330273aa385d7df9c9341fd4">EXEC_ASYNC_READ_WATCHPOINT_TRIGGER</a>));
<a name="l10778"></a>10778       <span class="keywordflow">break</span>;
<a name="l10779"></a>10779 
<a name="l10780"></a>10780     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa9148c330e0f813ed6fb421af9d7da820">bp_access_watchpoint</a>:
<a name="l10781"></a>10781       <span class="keywordflow">if</span> (<a class="code" href="ui-out_8c.html#a473db54efcfbc60feeb5a4f54f27af46">ui_out_is_mi_like_p</a> (uiout))
<a name="l10782"></a>10782         <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a>
<a name="l10783"></a>10783           (uiout, <span class="stringliteral">&quot;reason&quot;</span>,
<a name="l10784"></a>10784            <a class="code" href="mi-common_8c.html#a619e7d180d78af6e6d63a611c6680e90">async_reason_lookup</a> (<a class="code" href="mi-common_8h.html#a06d7bf56f98dcc556d686f49ea570daea4ed35b6cf18cff80b982e35767a67df3">EXEC_ASYNC_ACCESS_WATCHPOINT_TRIGGER</a>));
<a name="l10785"></a>10785       <span class="keywordflow">break</span>;
<a name="l10786"></a>10786     <span class="keywordflow">default</span>:
<a name="l10787"></a>10787       <a class="code" href="common-utils_8h.html#aa14285d9d3d4171016ef9cf09447e8bb">internal_error</a> (__FILE__, __LINE__,
<a name="l10788"></a>10788                       <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Invalid hardware watchpoint type.&quot;</span>));
<a name="l10789"></a>10789     }
<a name="l10790"></a>10790 
<a name="l10791"></a>10791   mention (b);
<a name="l10792"></a>10792   <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\n\</span>
<a name="l10793"></a>10793 <span class="stringliteral">Check the underlying instruction at PC for the memory\n\</span>
<a name="l10794"></a>10794 <span class="stringliteral">address and value which triggered this watchpoint.\n&quot;</span>));
<a name="l10795"></a>10795   <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;\n&quot;</span>);
<a name="l10796"></a>10796 
<a name="l10797"></a>10797   <span class="comment">/* More than one watchpoint may have been triggered.  */</span>
<a name="l10798"></a>10798   <span class="keywordflow">return</span> <a class="code" href="breakpoint_8h.html#ab6ab1d6a867561653e32a901b41be66ba84f0c3d5c073b6e26479e7b2ae2c7df0">PRINT_UNKNOWN</a>;
<a name="l10799"></a>10799 }
<a name="l10800"></a>10800 
<a name="l10801"></a>10801 <span class="comment">/* Implement the &quot;print_one_detail&quot; breakpoint_ops method for</span>
<a name="l10802"></a>10802 <span class="comment">   masked hardware watchpoints.  */</span>
<a name="l10803"></a>10803 
<a name="l10804"></a>10804 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l10805"></a>10805 print_one_detail_masked_watchpoint (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b,
<a name="l10806"></a>10806                                     <span class="keyword">struct</span> ui_out *uiout)
<a name="l10807"></a>10807 {
<a name="l10808"></a>10808   <span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *w = (<span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *) b;
<a name="l10809"></a>10809 
<a name="l10810"></a>10810   <span class="comment">/* Masked watchpoints have only one location.  */</span>
<a name="l10811"></a>10811   <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a> &amp;&amp; b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>-&gt;<a class="code" href="structbp__location.html#ab193cb38f87fea89105db96d94191541">next</a> == NULL);
<a name="l10812"></a>10812 
<a name="l10813"></a>10813   <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;\tmask &quot;</span>);
<a name="l10814"></a>10814   <a class="code" href="ui-out_8c.html#ada85ed653fecf3c2a80027de6f71ef71">ui_out_field_core_addr</a> (uiout, <span class="stringliteral">&quot;mask&quot;</span>, b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>-&gt;<a class="code" href="structbp__location.html#a55f3ff99d536775f5095f11e5f5c3f3e">gdbarch</a>, w-&gt;<a class="code" href="structwatchpoint.html#a8d9efbe7ba574b6af52dec3d99ab28a3">hw_wp_mask</a>);
<a name="l10815"></a>10815   <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;\n&quot;</span>);
<a name="l10816"></a>10816 }
<a name="l10817"></a>10817 
<a name="l10818"></a>10818 <span class="comment">/* Implement the &quot;print_mention&quot; breakpoint_ops method for</span>
<a name="l10819"></a>10819 <span class="comment">   masked hardware watchpoints.  */</span>
<a name="l10820"></a>10820 
<a name="l10821"></a>10821 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l10822"></a>10822 print_mention_masked_watchpoint (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b)
<a name="l10823"></a>10823 {
<a name="l10824"></a>10824   <span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *w = (<span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *) b;
<a name="l10825"></a>10825   <span class="keyword">struct </span>ui_out *uiout = <a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>;
<a name="l10826"></a>10826   <span class="keyword">struct </span>cleanup *ui_out_chain;
<a name="l10827"></a>10827 
<a name="l10828"></a>10828   <span class="keywordflow">switch</span> (b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a>)
<a name="l10829"></a>10829     {
<a name="l10830"></a>10830     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfae38a33f5a6725fbca8b5da2d491cfbcb">bp_hardware_watchpoint</a>:
<a name="l10831"></a>10831       <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;Masked hardware watchpoint &quot;</span>);
<a name="l10832"></a>10832       ui_out_chain = <a class="code" href="ui-out_8c.html#aaf5a0c991d74ad2e486f420d5c2ff058">make_cleanup_ui_out_tuple_begin_end</a> (uiout, <span class="stringliteral">&quot;wpt&quot;</span>);
<a name="l10833"></a>10833       <span class="keywordflow">break</span>;
<a name="l10834"></a>10834     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa7013ee22be60f470b10b2de2f9d22c21">bp_read_watchpoint</a>:
<a name="l10835"></a>10835       <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;Masked hardware read watchpoint &quot;</span>);
<a name="l10836"></a>10836       ui_out_chain = <a class="code" href="ui-out_8c.html#aaf5a0c991d74ad2e486f420d5c2ff058">make_cleanup_ui_out_tuple_begin_end</a> (uiout, <span class="stringliteral">&quot;hw-rwpt&quot;</span>);
<a name="l10837"></a>10837       <span class="keywordflow">break</span>;
<a name="l10838"></a>10838     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa9148c330e0f813ed6fb421af9d7da820">bp_access_watchpoint</a>:
<a name="l10839"></a>10839       <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;Masked hardware access (read/write) watchpoint &quot;</span>);
<a name="l10840"></a>10840       ui_out_chain = <a class="code" href="ui-out_8c.html#aaf5a0c991d74ad2e486f420d5c2ff058">make_cleanup_ui_out_tuple_begin_end</a> (uiout, <span class="stringliteral">&quot;hw-awpt&quot;</span>);
<a name="l10841"></a>10841       <span class="keywordflow">break</span>;
<a name="l10842"></a>10842     <span class="keywordflow">default</span>:
<a name="l10843"></a>10843       <a class="code" href="common-utils_8h.html#aa14285d9d3d4171016ef9cf09447e8bb">internal_error</a> (__FILE__, __LINE__,
<a name="l10844"></a>10844                       <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Invalid hardware watchpoint type.&quot;</span>));
<a name="l10845"></a>10845     }
<a name="l10846"></a>10846 
<a name="l10847"></a>10847   <a class="code" href="ui-out_8c.html#aa6f66551d03db456fb94ca1c9038f5a0">ui_out_field_int</a> (uiout, <span class="stringliteral">&quot;number&quot;</span>, b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>);
<a name="l10848"></a>10848   <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;: &quot;</span>);
<a name="l10849"></a>10849   <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a> (uiout, <span class="stringliteral">&quot;exp&quot;</span>, w-&gt;<a class="code" href="structwatchpoint.html#a1464eddbdf2f6d8d6dff4a61097c8dc8">exp_string</a>);
<a name="l10850"></a>10850   <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (ui_out_chain);
<a name="l10851"></a>10851 }
<a name="l10852"></a>10852 
<a name="l10853"></a>10853 <span class="comment">/* Implement the &quot;print_recreate&quot; breakpoint_ops method for</span>
<a name="l10854"></a>10854 <span class="comment">   masked hardware watchpoints.  */</span>
<a name="l10855"></a>10855 
<a name="l10856"></a>10856 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l10857"></a>10857 print_recreate_masked_watchpoint (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b, <span class="keyword">struct</span> ui_file *fp)
<a name="l10858"></a>10858 {
<a name="l10859"></a>10859   <span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *w = (<span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *) b;
<a name="l10860"></a>10860   <span class="keywordtype">char</span> tmp[40];
<a name="l10861"></a>10861 
<a name="l10862"></a>10862   <span class="keywordflow">switch</span> (b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a>)
<a name="l10863"></a>10863     {
<a name="l10864"></a>10864     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfae38a33f5a6725fbca8b5da2d491cfbcb">bp_hardware_watchpoint</a>:
<a name="l10865"></a>10865       <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (fp, <span class="stringliteral">&quot;watch&quot;</span>);
<a name="l10866"></a>10866       <span class="keywordflow">break</span>;
<a name="l10867"></a>10867     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa7013ee22be60f470b10b2de2f9d22c21">bp_read_watchpoint</a>:
<a name="l10868"></a>10868       <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (fp, <span class="stringliteral">&quot;rwatch&quot;</span>);
<a name="l10869"></a>10869       <span class="keywordflow">break</span>;
<a name="l10870"></a>10870     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa9148c330e0f813ed6fb421af9d7da820">bp_access_watchpoint</a>:
<a name="l10871"></a>10871       <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (fp, <span class="stringliteral">&quot;awatch&quot;</span>);
<a name="l10872"></a>10872       <span class="keywordflow">break</span>;
<a name="l10873"></a>10873     <span class="keywordflow">default</span>:
<a name="l10874"></a>10874       <a class="code" href="common-utils_8h.html#aa14285d9d3d4171016ef9cf09447e8bb">internal_error</a> (__FILE__, __LINE__,
<a name="l10875"></a>10875                       <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Invalid hardware watchpoint type.&quot;</span>));
<a name="l10876"></a>10876     }
<a name="l10877"></a>10877 
<a name="l10878"></a>10878   sprintf_vma (tmp, w-&gt;<a class="code" href="structwatchpoint.html#a8d9efbe7ba574b6af52dec3d99ab28a3">hw_wp_mask</a>);
<a name="l10879"></a>10879   <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (fp, <span class="stringliteral">&quot; %s mask 0x%s&quot;</span>, w-&gt;<a class="code" href="structwatchpoint.html#a1464eddbdf2f6d8d6dff4a61097c8dc8">exp_string</a>, tmp);
<a name="l10880"></a>10880   <a class="code" href="breakpoint_8c.html#aae7cd38b01782db6011bcd0150059625">print_recreate_thread</a> (b, fp);
<a name="l10881"></a>10881 }
<a name="l10882"></a>10882 
<a name="l10883"></a>10883 <span class="comment">/* The breakpoint_ops structure to be used in masked hardware watchpoints.  */</span>
<a name="l10884"></a>10884 
<a name="l10885"></a>10885 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structbreakpoint__ops.html">breakpoint_ops</a> masked_watchpoint_breakpoint_ops;
<a name="l10886"></a>10886 
<a name="l10887"></a>10887 <span class="comment">/* Tell whether the given watchpoint is a masked hardware watchpoint.  */</span>
<a name="l10888"></a>10888 
<a name="l10889"></a>10889 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l10890"></a>10890 is_masked_watchpoint (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b)
<a name="l10891"></a>10891 {
<a name="l10892"></a>10892   <span class="keywordflow">return</span> b-&gt;<a class="code" href="structbreakpoint.html#aba258aa23496f6434aaa1cf8c8dc7ea7">ops</a> == &amp;masked_watchpoint_breakpoint_ops;
<a name="l10893"></a>10893 }
<a name="l10894"></a>10894 
<a name="l10895"></a>10895 <span class="comment">/* accessflag:  hw_write:  watch write, </span>
<a name="l10896"></a>10896 <span class="comment">                hw_read:   watch read, </span>
<a name="l10897"></a>10897 <span class="comment">                hw_access: watch access (read or write) */</span>
<a name="l10898"></a>10898 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l10899"></a>10899 watch_command_1 (<span class="keyword">const</span> <span class="keywordtype">char</span> *arg, <span class="keywordtype">int</span> accessflag, <span class="keywordtype">int</span> from_tty,
<a name="l10900"></a>10900                  <span class="keywordtype">int</span> just_location, <span class="keywordtype">int</span> <span class="keyword">internal</span>)
<a name="l10901"></a>10901 {
<a name="l10902"></a>10902   <span class="keyword">volatile</span> <span class="keyword">struct </span><a class="code" href="structgdb__exception.html">gdb_exception</a> e;
<a name="l10903"></a>10903   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b, *scope_breakpoint = NULL;
<a name="l10904"></a>10904   <span class="keyword">struct </span><a class="code" href="structexpression.html">expression</a> *exp;
<a name="l10905"></a>10905   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structblock.html">block</a> *exp_valid_block = NULL, *cond_exp_valid_block = NULL;
<a name="l10906"></a>10906   <span class="keyword">struct </span>value *val, *mark, *result;
<a name="l10907"></a>10907   <span class="keyword">struct </span>frame_info *frame;
<a name="l10908"></a>10908   <span class="keyword">const</span> <span class="keywordtype">char</span> *exp_start = NULL;
<a name="l10909"></a>10909   <span class="keyword">const</span> <span class="keywordtype">char</span> *exp_end = NULL;
<a name="l10910"></a>10910   <span class="keyword">const</span> <span class="keywordtype">char</span> *tok, *end_tok;
<a name="l10911"></a>10911   <span class="keywordtype">int</span> toklen = -1;
<a name="l10912"></a>10912   <span class="keyword">const</span> <span class="keywordtype">char</span> *cond_start = NULL;
<a name="l10913"></a>10913   <span class="keyword">const</span> <span class="keywordtype">char</span> *cond_end = NULL;
<a name="l10914"></a>10914   <span class="keyword">enum</span> bptype <a class="code" href="mi-cmd-break_8c.html#a5f01db415022467f3bf1cb2051a27edd">bp_type</a>;
<a name="l10915"></a>10915   <span class="keywordtype">int</span> thread = -1;
<a name="l10916"></a>10916   <span class="keywordtype">int</span> pc = 0;
<a name="l10917"></a>10917   <span class="comment">/* Flag to indicate whether we are going to use masks for</span>
<a name="l10918"></a>10918 <span class="comment">     the hardware watchpoint.  */</span>
<a name="l10919"></a>10919   <span class="keywordtype">int</span> use_mask = 0;
<a name="l10920"></a>10920   <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> mask = 0;
<a name="l10921"></a>10921   <span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *w;
<a name="l10922"></a>10922   <span class="keywordtype">char</span> *<a class="code" href="structexpression.html">expression</a>;
<a name="l10923"></a>10923   <span class="keyword">struct </span>cleanup *back_to;
<a name="l10924"></a>10924 
<a name="l10925"></a>10925   <span class="comment">/* Make sure that we actually have parameters to parse.  */</span>
<a name="l10926"></a>10926   <span class="keywordflow">if</span> (arg != NULL &amp;&amp; arg[0] != <span class="charliteral">&#39;\0&#39;</span>)
<a name="l10927"></a>10927     {
<a name="l10928"></a>10928       <span class="keyword">const</span> <span class="keywordtype">char</span> *value_start;
<a name="l10929"></a>10929 
<a name="l10930"></a>10930       exp_end = arg + strlen (arg);
<a name="l10931"></a>10931 
<a name="l10932"></a>10932       <span class="comment">/* Look for &quot;parameter value&quot; pairs at the end</span>
<a name="l10933"></a>10933 <span class="comment">         of the arguments string.  */</span>
<a name="l10934"></a>10934       <span class="keywordflow">for</span> (tok = exp_end - 1; tok &gt; arg; tok--)
<a name="l10935"></a>10935         {
<a name="l10936"></a>10936           <span class="comment">/* Skip whitespace at the end of the argument list.  */</span>
<a name="l10937"></a>10937           <span class="keywordflow">while</span> (tok &gt; arg &amp;&amp; (*tok == <span class="charliteral">&#39; &#39;</span> || *tok == <span class="charliteral">&#39;\t&#39;</span>))
<a name="l10938"></a>10938             tok--;
<a name="l10939"></a>10939 
<a name="l10940"></a>10940           <span class="comment">/* Find the beginning of the last token.</span>
<a name="l10941"></a>10941 <span class="comment">             This is the value of the parameter.  */</span>
<a name="l10942"></a>10942           <span class="keywordflow">while</span> (tok &gt; arg &amp;&amp; (*tok != <span class="charliteral">&#39; &#39;</span> &amp;&amp; *tok != <span class="charliteral">&#39;\t&#39;</span>))
<a name="l10943"></a>10943             tok--;
<a name="l10944"></a>10944           value_start = tok + 1;
<a name="l10945"></a>10945 
<a name="l10946"></a>10946           <span class="comment">/* Skip whitespace.  */</span>
<a name="l10947"></a>10947           <span class="keywordflow">while</span> (tok &gt; arg &amp;&amp; (*tok == <span class="charliteral">&#39; &#39;</span> || *tok == <span class="charliteral">&#39;\t&#39;</span>))
<a name="l10948"></a>10948             tok--;
<a name="l10949"></a>10949 
<a name="l10950"></a>10950           end_tok = tok;
<a name="l10951"></a>10951 
<a name="l10952"></a>10952           <span class="comment">/* Find the beginning of the second to last token.</span>
<a name="l10953"></a>10953 <span class="comment">             This is the parameter itself.  */</span>
<a name="l10954"></a>10954           <span class="keywordflow">while</span> (tok &gt; arg &amp;&amp; (*tok != <span class="charliteral">&#39; &#39;</span> &amp;&amp; *tok != <span class="charliteral">&#39;\t&#39;</span>))
<a name="l10955"></a>10955             tok--;
<a name="l10956"></a>10956           tok++;
<a name="l10957"></a>10957           toklen = end_tok - tok + 1;
<a name="l10958"></a>10958 
<a name="l10959"></a>10959           <span class="keywordflow">if</span> (toklen == 6 &amp;&amp; !strncmp (tok, <span class="stringliteral">&quot;thread&quot;</span>, 6))
<a name="l10960"></a>10960             {
<a name="l10961"></a>10961               <span class="comment">/* At this point we&#39;ve found a &quot;thread&quot; token, which means</span>
<a name="l10962"></a>10962 <span class="comment">                 the user is trying to set a watchpoint that triggers</span>
<a name="l10963"></a>10963 <span class="comment">                 only in a specific thread.  */</span>
<a name="l10964"></a>10964               <span class="keywordtype">char</span> *endp;
<a name="l10965"></a>10965 
<a name="l10966"></a>10966               <span class="keywordflow">if</span> (thread != -1)
<a name="l10967"></a>10967                 <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a>(<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;You can specify only one thread.&quot;</span>));
<a name="l10968"></a>10968 
<a name="l10969"></a>10969               <span class="comment">/* Extract the thread ID from the next token.  */</span>
<a name="l10970"></a>10970               thread = strtol (value_start, &amp;endp, 0);
<a name="l10971"></a>10971 
<a name="l10972"></a>10972               <span class="comment">/* Check if the user provided a valid numeric value for the</span>
<a name="l10973"></a>10973 <span class="comment">                 thread ID.  */</span>
<a name="l10974"></a>10974               <span class="keywordflow">if</span> (*endp != <span class="charliteral">&#39; &#39;</span> &amp;&amp; *endp != <span class="charliteral">&#39;\t&#39;</span> &amp;&amp; *endp != <span class="charliteral">&#39;\0&#39;</span>)
<a name="l10975"></a>10975                 <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Invalid thread ID specification %s.&quot;</span>), value_start);
<a name="l10976"></a>10976 
<a name="l10977"></a>10977               <span class="comment">/* Check if the thread actually exists.  */</span>
<a name="l10978"></a>10978               <span class="keywordflow">if</span> (!<a class="code" href="gdbthread_8h.html#aeadadfd9ed468cfe8d004dcb4b31f471">valid_thread_id</a> (thread))
<a name="l10979"></a>10979                 invalid_thread_id_error (thread);
<a name="l10980"></a>10980             }
<a name="l10981"></a>10981           <span class="keywordflow">else</span> <span class="keywordflow">if</span> (toklen == 4 &amp;&amp; !strncmp (tok, <span class="stringliteral">&quot;mask&quot;</span>, 4))
<a name="l10982"></a>10982             {
<a name="l10983"></a>10983               <span class="comment">/* We&#39;ve found a &quot;mask&quot; token, which means the user wants to</span>
<a name="l10984"></a>10984 <span class="comment">                 create a hardware watchpoint that is going to have the mask</span>
<a name="l10985"></a>10985 <span class="comment">                 facility.  */</span>
<a name="l10986"></a>10986               <span class="keyword">struct </span>value *mask_value, *mark;
<a name="l10987"></a>10987 
<a name="l10988"></a>10988               <span class="keywordflow">if</span> (use_mask)
<a name="l10989"></a>10989                 <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a>(<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;You can specify only one mask.&quot;</span>));
<a name="l10990"></a>10990 
<a name="l10991"></a>10991               use_mask = just_location = 1;
<a name="l10992"></a>10992 
<a name="l10993"></a>10993               mark = <a class="code" href="value_8c.html#a427a12b0dd4d5663b103d29f07a0e1c6">value_mark</a> ();
<a name="l10994"></a>10994               mask_value = <a class="code" href="eval_8c.html#a5327f4a6f2481c9f8d6c13bb9b621688">parse_to_comma_and_eval</a> (&amp;value_start);
<a name="l10995"></a>10995               mask = <a class="code" href="value_8c.html#a2e64d8ca2ab5480e05097c6b2df1aa02">value_as_address</a> (mask_value);
<a name="l10996"></a>10996               <a class="code" href="value_8c.html#a10aad9b72e08c5e90e3051156fa83318">value_free_to_mark</a> (mark);
<a name="l10997"></a>10997             }
<a name="l10998"></a>10998           <span class="keywordflow">else</span>
<a name="l10999"></a>10999             <span class="comment">/* We didn&#39;t recognize what we found.  We should stop here.  */</span>
<a name="l11000"></a>11000             <span class="keywordflow">break</span>;
<a name="l11001"></a>11001 
<a name="l11002"></a>11002           <span class="comment">/* Truncate the string and get rid of the &quot;parameter value&quot; pair before</span>
<a name="l11003"></a>11003 <span class="comment">             the arguments string is parsed by the parse_exp_1 function.  */</span>
<a name="l11004"></a>11004           exp_end = tok;
<a name="l11005"></a>11005         }
<a name="l11006"></a>11006     }
<a name="l11007"></a>11007   <span class="keywordflow">else</span>
<a name="l11008"></a>11008     exp_end = arg;
<a name="l11009"></a>11009 
<a name="l11010"></a>11010   <span class="comment">/* Parse the rest of the arguments.  From here on out, everything</span>
<a name="l11011"></a>11011 <span class="comment">     is in terms of a newly allocated string instead of the original</span>
<a name="l11012"></a>11012 <span class="comment">     ARG.  */</span>
<a name="l11013"></a>11013   <a class="code" href="expression_8h.html#a6b2028f35010cd9648aa5d5e8f7d653d">innermost_block</a> = NULL;
<a name="l11014"></a>11014   expression = <a class="code" href="common-utils_8c.html#a5f388f89054b57d850779d7d71bc4d1c">savestring</a> (arg, exp_end - arg);
<a name="l11015"></a>11015   back_to = <a class="code" href="cleanups_8c.html#a3d418f8af424aec399898c2d48b26224">make_cleanup</a> (<a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a>, expression);
<a name="l11016"></a>11016   exp_start = arg = expression;
<a name="l11017"></a>11017   exp = <a class="code" href="expression_8h.html#abdad295cc4b5351f6e6ec024ab665475">parse_exp_1</a> (&amp;arg, 0, 0, 0);
<a name="l11018"></a>11018   exp_end = arg;
<a name="l11019"></a>11019   <span class="comment">/* Remove trailing whitespace from the expression before saving it.</span>
<a name="l11020"></a>11020 <span class="comment">     This makes the eventual display of the expression string a bit</span>
<a name="l11021"></a>11021 <span class="comment">     prettier.  */</span>
<a name="l11022"></a>11022   <span class="keywordflow">while</span> (exp_end &gt; exp_start &amp;&amp; (exp_end[-1] == <span class="charliteral">&#39; &#39;</span> || exp_end[-1] == <span class="charliteral">&#39;\t&#39;</span>))
<a name="l11023"></a>11023     --exp_end;
<a name="l11024"></a>11024 
<a name="l11025"></a>11025   <span class="comment">/* Checking if the expression is not constant.  */</span>
<a name="l11026"></a>11026   <span class="keywordflow">if</span> (watchpoint_exp_is_const (exp))
<a name="l11027"></a>11027     {
<a name="l11028"></a>11028       <span class="keywordtype">int</span> <a class="code" href="exec_8h.html#a00f945351279d3c8935f13d2b9f9b808">len</a>;
<a name="l11029"></a>11029 
<a name="l11030"></a>11030       len = exp_end - exp_start;
<a name="l11031"></a>11031       <span class="keywordflow">while</span> (len &gt; 0 &amp;&amp; isspace (exp_start[len - 1]))
<a name="l11032"></a>11032         len--;
<a name="l11033"></a>11033       <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Cannot watch constant value `%.*s&#39;.&quot;</span>), len, exp_start);
<a name="l11034"></a>11034     }
<a name="l11035"></a>11035 
<a name="l11036"></a>11036   exp_valid_block = <a class="code" href="expression_8h.html#a6b2028f35010cd9648aa5d5e8f7d653d">innermost_block</a>;
<a name="l11037"></a>11037   mark = <a class="code" href="value_8c.html#a427a12b0dd4d5663b103d29f07a0e1c6">value_mark</a> ();
<a name="l11038"></a>11038   <a class="code" href="eval_8c.html#a0f904e0082858aca1865f842481e67b3">fetch_subexp_value</a> (exp, &amp;pc, &amp;val, &amp;result, NULL, just_location);
<a name="l11039"></a>11039 
<a name="l11040"></a>11040   <span class="keywordflow">if</span> (just_location)
<a name="l11041"></a>11041     {
<a name="l11042"></a>11042       <span class="keywordtype">int</span> ret;
<a name="l11043"></a>11043 
<a name="l11044"></a>11044       exp_valid_block = NULL;
<a name="l11045"></a>11045       val = <a class="code" href="valops_8c.html#a29bc320305726a3cbf324189df2ca772">value_addr</a> (result);
<a name="l11046"></a>11046       <a class="code" href="value_8c.html#a5a9662fcdbefec2edef0b912ba593914">release_value</a> (val);
<a name="l11047"></a>11047       <a class="code" href="value_8c.html#a10aad9b72e08c5e90e3051156fa83318">value_free_to_mark</a> (mark);
<a name="l11048"></a>11048 
<a name="l11049"></a>11049       <span class="keywordflow">if</span> (use_mask)
<a name="l11050"></a>11050         {
<a name="l11051"></a>11051           ret = <a class="code" href="target_8c.html#a944308b624c22754954470cf8c974e0d">target_masked_watch_num_registers</a> (<a class="code" href="value_8c.html#a2e64d8ca2ab5480e05097c6b2df1aa02">value_as_address</a> (val),
<a name="l11052"></a>11052                                                    mask);
<a name="l11053"></a>11053           <span class="keywordflow">if</span> (ret == -1)
<a name="l11054"></a>11054             <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;This target does not support masked watchpoints.&quot;</span>));
<a name="l11055"></a>11055           <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ret == -2)
<a name="l11056"></a>11056             <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Invalid mask or memory region.&quot;</span>));
<a name="l11057"></a>11057         }
<a name="l11058"></a>11058     }
<a name="l11059"></a>11059   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (val != NULL)
<a name="l11060"></a>11060     <a class="code" href="value_8c.html#a5a9662fcdbefec2edef0b912ba593914">release_value</a> (val);
<a name="l11061"></a>11061 
<a name="l11062"></a>11062   tok = <a class="code" href="cli-utils_8c.html#aad7df612354d99c740a7ea12eccd3848">skip_spaces_const</a> (arg);
<a name="l11063"></a>11063   end_tok = <a class="code" href="cli-utils_8c.html#a698bb5c8505ebecdcca9a193c18b7c8a">skip_to_space_const</a> (tok);
<a name="l11064"></a>11064 
<a name="l11065"></a>11065   toklen = end_tok - tok;
<a name="l11066"></a>11066   <span class="keywordflow">if</span> (toklen &gt;= 1 &amp;&amp; strncmp (tok, <span class="stringliteral">&quot;if&quot;</span>, toklen) == 0)
<a name="l11067"></a>11067     {
<a name="l11068"></a>11068       <span class="keyword">struct </span>expression *cond;
<a name="l11069"></a>11069 
<a name="l11070"></a>11070       <a class="code" href="expression_8h.html#a6b2028f35010cd9648aa5d5e8f7d653d">innermost_block</a> = NULL;
<a name="l11071"></a>11071       tok = cond_start = end_tok + 1;
<a name="l11072"></a>11072       cond = <a class="code" href="expression_8h.html#abdad295cc4b5351f6e6ec024ab665475">parse_exp_1</a> (&amp;tok, 0, 0, 0);
<a name="l11073"></a>11073 
<a name="l11074"></a>11074       <span class="comment">/* The watchpoint expression may not be local, but the condition</span>
<a name="l11075"></a>11075 <span class="comment">         may still be.  E.g.: `watch global if local &gt; 0&#39;.  */</span>
<a name="l11076"></a>11076       cond_exp_valid_block = <a class="code" href="expression_8h.html#a6b2028f35010cd9648aa5d5e8f7d653d">innermost_block</a>;
<a name="l11077"></a>11077 
<a name="l11078"></a>11078       <a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a> (cond);
<a name="l11079"></a>11079       cond_end = tok;
<a name="l11080"></a>11080     }
<a name="l11081"></a>11081   <span class="keywordflow">if</span> (*tok)
<a name="l11082"></a>11082     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Junk at end of command.&quot;</span>));
<a name="l11083"></a>11083 
<a name="l11084"></a>11084   <span class="keywordflow">if</span> (accessflag == <a class="code" href="break-common_8h.html#ae1f701210980578c2ab1bc4ae89e69f3afb52ba78eb7679d11a25bd2c44eb0606">hw_read</a>)
<a name="l11085"></a>11085     bp_type = <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa7013ee22be60f470b10b2de2f9d22c21">bp_read_watchpoint</a>;
<a name="l11086"></a>11086   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (accessflag == <a class="code" href="break-common_8h.html#ae1f701210980578c2ab1bc4ae89e69f3a8bef3f5dcfc5f1c5b482627a8ddf5736">hw_access</a>)
<a name="l11087"></a>11087     bp_type = <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa9148c330e0f813ed6fb421af9d7da820">bp_access_watchpoint</a>;
<a name="l11088"></a>11088   <span class="keywordflow">else</span>
<a name="l11089"></a>11089     bp_type = <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfae38a33f5a6725fbca8b5da2d491cfbcb">bp_hardware_watchpoint</a>;
<a name="l11090"></a>11090 
<a name="l11091"></a>11091   frame = <a class="code" href="blockframe_8c.html#acef754b55368c6be1928b137738b927a">block_innermost_frame</a> (exp_valid_block);
<a name="l11092"></a>11092 
<a name="l11093"></a>11093   <span class="comment">/* If the expression is &quot;local&quot;, then set up a &quot;watchpoint scope&quot;</span>
<a name="l11094"></a>11094 <span class="comment">     breakpoint at the point where we&#39;ve left the scope of the watchpoint</span>
<a name="l11095"></a>11095 <span class="comment">     expression.  Create the scope breakpoint before the watchpoint, so</span>
<a name="l11096"></a>11096 <span class="comment">     that we will encounter it first in bpstat_stop_status.  */</span>
<a name="l11097"></a>11097   <span class="keywordflow">if</span> (exp_valid_block &amp;&amp; frame)
<a name="l11098"></a>11098     {
<a name="l11099"></a>11099       <span class="keywordflow">if</span> (<a class="code" href="frame_8c.html#ad6cfc1ab3a8482a76d8e2862b3fc6542">frame_id_p</a> (<a class="code" href="frame_8c.html#a3d22c3305d25d79c59d2c67b5c0c62d8">frame_unwind_caller_id</a> (frame)))
<a name="l11100"></a>11100         {
<a name="l11101"></a>11101           scope_breakpoint
<a name="l11102"></a>11102             = create_internal_breakpoint (<a class="code" href="frame_8c.html#ae79a0d95d5b2e5dda66bbd1f2ce0b381">frame_unwind_caller_arch</a> (frame),
<a name="l11103"></a>11103                                           <a class="code" href="frame_8c.html#a674f48736f1324c31ee825c8294f6101">frame_unwind_caller_pc</a> (frame),
<a name="l11104"></a>11104                                           <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfad6bfd2f2654949462085c78f02480366">bp_watchpoint_scope</a>,
<a name="l11105"></a>11105                                           &amp;momentary_breakpoint_ops);
<a name="l11106"></a>11106 
<a name="l11107"></a>11107           scope_breakpoint-&gt;<a class="code" href="structbreakpoint.html#acb53352fd35aaad37054508fabc0f3bf">enable_state</a> = <a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577a72f1fa981d13a62d05324c1de974b44b">bp_enabled</a>;
<a name="l11108"></a>11108 
<a name="l11109"></a>11109           <span class="comment">/* Automatically delete the breakpoint when it hits.  */</span>
<a name="l11110"></a>11110           scope_breakpoint-&gt;<a class="code" href="structbreakpoint.html#a75f0f9a837eac292ab6e768e8d8f1bd7">disposition</a> = <a class="code" href="breakpoint_8h.html#a15f2bbd9012f59bc09d59feef0c15732a16da7fb4204cb3f58c753fafa80bfab7">disp_del</a>;
<a name="l11111"></a>11111 
<a name="l11112"></a>11112           <span class="comment">/* Only break in the proper frame (help with recursion).  */</span>
<a name="l11113"></a>11113           scope_breakpoint-&gt;<a class="code" href="structbreakpoint.html#af65175451fdfdff660221d724c7c3cae">frame_id</a> = <a class="code" href="frame_8c.html#a3d22c3305d25d79c59d2c67b5c0c62d8">frame_unwind_caller_id</a> (frame);
<a name="l11114"></a>11114 
<a name="l11115"></a>11115           <span class="comment">/* Set the address at which we will stop.  */</span>
<a name="l11116"></a>11116           scope_breakpoint-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>-&gt;<a class="code" href="structbp__location.html#a55f3ff99d536775f5095f11e5f5c3f3e">gdbarch</a>
<a name="l11117"></a>11117             = <a class="code" href="frame_8c.html#ae79a0d95d5b2e5dda66bbd1f2ce0b381">frame_unwind_caller_arch</a> (frame);
<a name="l11118"></a>11118           scope_breakpoint-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>-&gt;<a class="code" href="structbp__location.html#a4e316d8cab3c014aa85b8858d6223ce2">requested_address</a>
<a name="l11119"></a>11119             = <a class="code" href="frame_8c.html#a674f48736f1324c31ee825c8294f6101">frame_unwind_caller_pc</a> (frame);
<a name="l11120"></a>11120           scope_breakpoint-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>
<a name="l11121"></a>11121             = adjust_breakpoint_address (scope_breakpoint-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>-&gt;<a class="code" href="structbp__location.html#a55f3ff99d536775f5095f11e5f5c3f3e">gdbarch</a>,
<a name="l11122"></a>11122                                          scope_breakpoint-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>-&gt;<a class="code" href="structbp__location.html#a4e316d8cab3c014aa85b8858d6223ce2">requested_address</a>,
<a name="l11123"></a>11123                                          scope_breakpoint-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a>);
<a name="l11124"></a>11124         }
<a name="l11125"></a>11125     }
<a name="l11126"></a>11126 
<a name="l11127"></a>11127   <span class="comment">/* Now set up the breakpoint.  */</span>
<a name="l11128"></a>11128 
<a name="l11129"></a>11129   w = XCNEW (<span class="keyword">struct</span> <a class="code" href="structwatchpoint.html">watchpoint</a>);
<a name="l11130"></a>11130   b = &amp;w-&gt;<a class="code" href="structwatchpoint.html#a01b7a13518becdd7631c9d701b70cbd1">base</a>;
<a name="l11131"></a>11131   <span class="keywordflow">if</span> (use_mask)
<a name="l11132"></a>11132     init_raw_breakpoint_without_location (b, NULL, bp_type,
<a name="l11133"></a>11133                                           &amp;masked_watchpoint_breakpoint_ops);
<a name="l11134"></a>11134   <span class="keywordflow">else</span>
<a name="l11135"></a>11135     init_raw_breakpoint_without_location (b, NULL, bp_type,
<a name="l11136"></a>11136                                           &amp;watchpoint_breakpoint_ops);
<a name="l11137"></a>11137   b-&gt;<a class="code" href="structbreakpoint.html#ae8613b6d8cf464f30ea39597be0cc192">thread</a> = thread;
<a name="l11138"></a>11138   b-&gt;<a class="code" href="structbreakpoint.html#a75f0f9a837eac292ab6e768e8d8f1bd7">disposition</a> = <a class="code" href="breakpoint_8h.html#a15f2bbd9012f59bc09d59feef0c15732a01c974d9083d524653d3a437364958be">disp_donttouch</a>;
<a name="l11139"></a>11139   b-&gt;<a class="code" href="structbreakpoint.html#a82f4fd8ee6ddee61f3529fbd747c78b2">pspace</a> = <a class="code" href="progspace_8c.html#a07722ff15a98814c086dda44f93380c9">current_program_space</a>;
<a name="l11140"></a>11140   w-&gt;<a class="code" href="structwatchpoint.html#a10a51823c12ea43c95d767fb3a65d982">exp</a> = exp;
<a name="l11141"></a>11141   w-&gt;<a class="code" href="structwatchpoint.html#ab553c881e6ca32b9ae05bf9baee18c63">exp_valid_block</a> = exp_valid_block;
<a name="l11142"></a>11142   w-&gt;<a class="code" href="structwatchpoint.html#a8efc24adb7be3137ae593d26cb22436f">cond_exp_valid_block</a> = cond_exp_valid_block;
<a name="l11143"></a>11143   <span class="keywordflow">if</span> (just_location)
<a name="l11144"></a>11144     {
<a name="l11145"></a>11145       <span class="keyword">struct </span>type *t = <a class="code" href="value_8c.html#a263a4c0bee0b0df41074b952d3c121d0">value_type</a> (val);
<a name="l11146"></a>11146       <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> addr = <a class="code" href="value_8c.html#a2e64d8ca2ab5480e05097c6b2df1aa02">value_as_address</a> (val);
<a name="l11147"></a>11147       <span class="keywordtype">char</span> *<a class="code" href="aarch64-tdep_8c.html#acc128f98d9ceca227038c771308eff39">name</a>;
<a name="l11148"></a>11148 
<a name="l11149"></a>11149       t = <a class="code" href="gdbtypes_8c.html#a0bf29d7521d8a8b8735b9a259e380386">check_typedef</a> (<a class="code" href="gdbtypes_8h.html#a87a33d723acd28a033e63c4297c6c916">TYPE_TARGET_TYPE</a> (<a class="code" href="gdbtypes_8c.html#a0bf29d7521d8a8b8735b9a259e380386">check_typedef</a> (t)));
<a name="l11150"></a>11150       name = <a class="code" href="typeprint_8c.html#ac7fc7b5499b2197aaa69091c39b64d53">type_to_string</a> (t);
<a name="l11151"></a>11151 
<a name="l11152"></a>11152       w-&gt;<a class="code" href="structwatchpoint.html#a7e2fef584a035e0ea43d84b579946ed3">exp_string_reparse</a> = <a class="code" href="common-utils_8c.html#ab9bf7e1b4e68bdd0078e9e1e55c62cec">xstrprintf</a> (<span class="stringliteral">&quot;* (%s *) %s&quot;</span>, name,
<a name="l11153"></a>11153                                           <a class="code" href="utils_8c.html#acb2b4bf07dba43a005da21904906c533">core_addr_to_string</a> (addr));
<a name="l11154"></a>11154       <a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a> (name);
<a name="l11155"></a>11155 
<a name="l11156"></a>11156       w-&gt;<a class="code" href="structwatchpoint.html#a1464eddbdf2f6d8d6dff4a61097c8dc8">exp_string</a> = <a class="code" href="common-utils_8c.html#ab9bf7e1b4e68bdd0078e9e1e55c62cec">xstrprintf</a> (<span class="stringliteral">&quot;-location %.*s&quot;</span>,
<a name="l11157"></a>11157                                   (<span class="keywordtype">int</span>) (exp_end - exp_start), exp_start);
<a name="l11158"></a>11158 
<a name="l11159"></a>11159       <span class="comment">/* The above expression is in C.  */</span>
<a name="l11160"></a>11160       b-&gt;<a class="code" href="structbreakpoint.html#adb277de5c8fe68b963cd04aefab977e7">language</a> = <a class="code" href="defs_8h.html#aa37aa8979934d47ac32fd96ecff32202ad300f80a4c96edb04defba2280620a49">language_c</a>;
<a name="l11161"></a>11161     }
<a name="l11162"></a>11162   <span class="keywordflow">else</span>
<a name="l11163"></a>11163     w-&gt;<a class="code" href="structwatchpoint.html#a1464eddbdf2f6d8d6dff4a61097c8dc8">exp_string</a> = <a class="code" href="common-utils_8c.html#a5f388f89054b57d850779d7d71bc4d1c">savestring</a> (exp_start, exp_end - exp_start);
<a name="l11164"></a>11164 
<a name="l11165"></a>11165   <span class="keywordflow">if</span> (use_mask)
<a name="l11166"></a>11166     {
<a name="l11167"></a>11167       w-&gt;<a class="code" href="structwatchpoint.html#a8d9efbe7ba574b6af52dec3d99ab28a3">hw_wp_mask</a> = mask;
<a name="l11168"></a>11168     }
<a name="l11169"></a>11169   <span class="keywordflow">else</span>
<a name="l11170"></a>11170     {
<a name="l11171"></a>11171       w-&gt;<a class="code" href="structwatchpoint.html#afafe9b6d8ed19e6c10764499cb35a7d1">val</a> = val;
<a name="l11172"></a>11172       w-&gt;<a class="code" href="structwatchpoint.html#ab2e6ea6495c9663c86652b00af5bea1d">val_valid</a> = 1;
<a name="l11173"></a>11173     }
<a name="l11174"></a>11174 
<a name="l11175"></a>11175   <span class="keywordflow">if</span> (cond_start)
<a name="l11176"></a>11176     b-&gt;<a class="code" href="structbreakpoint.html#a817904eee4ded1a9e18ab46709c1245b">cond_string</a> = <a class="code" href="common-utils_8c.html#a5f388f89054b57d850779d7d71bc4d1c">savestring</a> (cond_start, cond_end - cond_start);
<a name="l11177"></a>11177   <span class="keywordflow">else</span>
<a name="l11178"></a>11178     b-&gt;<a class="code" href="structbreakpoint.html#a817904eee4ded1a9e18ab46709c1245b">cond_string</a> = 0;
<a name="l11179"></a>11179 
<a name="l11180"></a>11180   <span class="keywordflow">if</span> (frame)
<a name="l11181"></a>11181     {
<a name="l11182"></a>11182       w-&gt;<a class="code" href="structwatchpoint.html#a4be20e56c1fa9de45dece05f164c1060">watchpoint_frame</a> = <a class="code" href="frame_8c.html#a4d69effe10c03fa7c702d490081012bf">get_frame_id</a> (frame);
<a name="l11183"></a>11183       w-&gt;<a class="code" href="structwatchpoint.html#a0bd62e44295bf4a0cdce4ecfdefaaee7">watchpoint_thread</a> = <a class="code" href="infcmd_8c.html#a428c5be9ce5e70bd03760e828e19c6b7">inferior_ptid</a>;
<a name="l11184"></a>11184     }
<a name="l11185"></a>11185   <span class="keywordflow">else</span>
<a name="l11186"></a>11186     {
<a name="l11187"></a>11187       w-&gt;<a class="code" href="structwatchpoint.html#a4be20e56c1fa9de45dece05f164c1060">watchpoint_frame</a> = <a class="code" href="frame_8c.html#a0e92fecdd3b01549ccdc07795de2afee">null_frame_id</a>;
<a name="l11188"></a>11188       w-&gt;<a class="code" href="structwatchpoint.html#a0bd62e44295bf4a0cdce4ecfdefaaee7">watchpoint_thread</a> = <a class="code" href="ptid_8c.html#acba69c857786546b204883bbcc90a64e">null_ptid</a>;
<a name="l11189"></a>11189     }
<a name="l11190"></a>11190 
<a name="l11191"></a>11191   <span class="keywordflow">if</span> (scope_breakpoint != NULL)
<a name="l11192"></a>11192     {
<a name="l11193"></a>11193       <span class="comment">/* The scope breakpoint is related to the watchpoint.  We will</span>
<a name="l11194"></a>11194 <span class="comment">         need to act on them together.  */</span>
<a name="l11195"></a>11195       b-&gt;<a class="code" href="structbreakpoint.html#a7d9882daea896de8ff1f7981e9508500">related_breakpoint</a> = scope_breakpoint;
<a name="l11196"></a>11196       scope_breakpoint-&gt;<a class="code" href="structbreakpoint.html#a7d9882daea896de8ff1f7981e9508500">related_breakpoint</a> = b;
<a name="l11197"></a>11197     }
<a name="l11198"></a>11198 
<a name="l11199"></a>11199   <span class="keywordflow">if</span> (!just_location)
<a name="l11200"></a>11200     <a class="code" href="value_8c.html#a10aad9b72e08c5e90e3051156fa83318">value_free_to_mark</a> (mark);
<a name="l11201"></a>11201 
<a name="l11202"></a>11202   <a class="code" href="exceptions_8h.html#aef4514ee39b9305fddee27f49c7c34eb">TRY_CATCH</a> (e, <a class="code" href="exceptions_8h.html#abfa3a3b99557b11f5766baf69465fdf6ab50fde886a7de8c013bf2bd4e7c073a4">RETURN_MASK_ALL</a>)
<a name="l11203"></a>11203     {
<a name="l11204"></a>11204       <span class="comment">/* Finally update the new watchpoint.  This creates the locations</span>
<a name="l11205"></a>11205 <span class="comment">         that should be inserted.  */</span>
<a name="l11206"></a>11206       update_watchpoint (w, 1);
<a name="l11207"></a>11207     }
<a name="l11208"></a>11208   <span class="keywordflow">if</span> (e.reason &lt; 0)
<a name="l11209"></a>11209     {
<a name="l11210"></a>11210       <a class="code" href="breakpoint_8c.html#a0701191361b1ed0d40d76661e88de3f4">delete_breakpoint</a> (b);
<a name="l11211"></a>11211       <a class="code" href="exceptions_8c.html#a541d1b545da68efe4f8b729a945f83e7">throw_exception</a> (e);
<a name="l11212"></a>11212     }
<a name="l11213"></a>11213 
<a name="l11214"></a>11214   <a class="code" href="breakpoint_8c.html#a74ff6d8191c3b444efd5631143d21635">install_breakpoint</a> (<span class="keyword">internal</span>, b, 1);
<a name="l11215"></a>11215   <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (back_to);
<a name="l11216"></a>11216 }
<a name="l11217"></a>11217 
<a name="l11218"></a>11218 <span class="comment">/* Return count of debug registers needed to watch the given expression.</span>
<a name="l11219"></a>11219 <span class="comment">   If the watchpoint cannot be handled in hardware return zero.  */</span>
<a name="l11220"></a>11220 
<a name="l11221"></a>11221 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l11222"></a>11222 can_use_hardware_watchpoint (<span class="keyword">struct</span> value *v)
<a name="l11223"></a>11223 {
<a name="l11224"></a>11224   <span class="keywordtype">int</span> found_memory_cnt = 0;
<a name="l11225"></a>11225   <span class="keyword">struct </span>value *head = v;
<a name="l11226"></a>11226 
<a name="l11227"></a>11227   <span class="comment">/* Did the user specifically forbid us to use hardware watchpoints? */</span>
<a name="l11228"></a>11228   <span class="keywordflow">if</span> (!can_use_hw_watchpoints)
<a name="l11229"></a>11229     <span class="keywordflow">return</span> 0;
<a name="l11230"></a>11230 
<a name="l11231"></a>11231   <span class="comment">/* Make sure that the value of the expression depends only upon</span>
<a name="l11232"></a>11232 <span class="comment">     memory contents, and values computed from them within GDB.  If we</span>
<a name="l11233"></a>11233 <span class="comment">     find any register references or function calls, we can&#39;t use a</span>
<a name="l11234"></a>11234 <span class="comment">     hardware watchpoint.</span>
<a name="l11235"></a>11235 <span class="comment"></span>
<a name="l11236"></a>11236 <span class="comment">     The idea here is that evaluating an expression generates a series</span>
<a name="l11237"></a>11237 <span class="comment">     of values, one holding the value of every subexpression.  (The</span>
<a name="l11238"></a>11238 <span class="comment">     expression a*b+c has five subexpressions: a, b, a*b, c, and</span>
<a name="l11239"></a>11239 <span class="comment">     a*b+c.)  GDB&#39;s values hold almost enough information to establish</span>
<a name="l11240"></a>11240 <span class="comment">     the criteria given above --- they identify memory lvalues,</span>
<a name="l11241"></a>11241 <span class="comment">     register lvalues, computed values, etcetera.  So we can evaluate</span>
<a name="l11242"></a>11242 <span class="comment">     the expression, and then scan the chain of values that leaves</span>
<a name="l11243"></a>11243 <span class="comment">     behind to decide whether we can detect any possible change to the</span>
<a name="l11244"></a>11244 <span class="comment">     expression&#39;s final value using only hardware watchpoints.</span>
<a name="l11245"></a>11245 <span class="comment"></span>
<a name="l11246"></a>11246 <span class="comment">     However, I don&#39;t think that the values returned by inferior</span>
<a name="l11247"></a>11247 <span class="comment">     function calls are special in any way.  So this function may not</span>
<a name="l11248"></a>11248 <span class="comment">     notice that an expression involving an inferior function call</span>
<a name="l11249"></a>11249 <span class="comment">     can&#39;t be watched with hardware watchpoints.  FIXME.  */</span>
<a name="l11250"></a>11250   <span class="keywordflow">for</span> (; v; v = <a class="code" href="value_8c.html#aeeff72ffd5db1d14bf0d7534da4ed624">value_next</a> (v))
<a name="l11251"></a>11251     {
<a name="l11252"></a>11252       <span class="keywordflow">if</span> (<a class="code" href="value_8h.html#a39f15e604dd7037545ce2774310b0cd5">VALUE_LVAL</a> (v) == <a class="code" href="defs_8h.html#aae40e9877f56980bf8fac75923a098aba04e4ffc3d93e9a0cdec974596a72c17e">lval_memory</a>)
<a name="l11253"></a>11253         {
<a name="l11254"></a>11254           <span class="keywordflow">if</span> (v != head &amp;&amp; <a class="code" href="value_8c.html#aa60bc8ecf77867a2d16bec57a4ccf983">value_lazy</a> (v))
<a name="l11255"></a>11255             <span class="comment">/* A lazy memory lvalue in the chain is one that GDB never</span>
<a name="l11256"></a>11256 <span class="comment">               needed to fetch; we either just used its address (e.g.,</span>
<a name="l11257"></a>11257 <span class="comment">               `a&#39; in `a.b&#39;) or we never needed it at all (e.g., `a&#39;</span>
<a name="l11258"></a>11258 <span class="comment">               in `a,b&#39;).  This doesn&#39;t apply to HEAD; if that is</span>
<a name="l11259"></a>11259 <span class="comment">               lazy then it was not readable, but watch it anyway.  */</span>
<a name="l11260"></a>11260             ;
<a name="l11261"></a>11261           <span class="keywordflow">else</span>
<a name="l11262"></a>11262             {
<a name="l11263"></a>11263               <span class="comment">/* Ahh, memory we actually used!  Check if we can cover</span>
<a name="l11264"></a>11264 <span class="comment">                 it with hardware watchpoints.  */</span>
<a name="l11265"></a>11265               <span class="keyword">struct </span>type *vtype = <a class="code" href="gdbtypes_8c.html#a0bf29d7521d8a8b8735b9a259e380386">check_typedef</a> (<a class="code" href="value_8c.html#a263a4c0bee0b0df41074b952d3c121d0">value_type</a> (v));
<a name="l11266"></a>11266 
<a name="l11267"></a>11267               <span class="comment">/* We only watch structs and arrays if user asked for it</span>
<a name="l11268"></a>11268 <span class="comment">                 explicitly, never if they just happen to appear in a</span>
<a name="l11269"></a>11269 <span class="comment">                 middle of some value chain.  */</span>
<a name="l11270"></a>11270               <span class="keywordflow">if</span> (v == head
<a name="l11271"></a>11271                   || (<a class="code" href="gdbtypes_8h.html#a9505f41c7012665947c6b4065ce190e1">TYPE_CODE</a> (vtype) != <a class="code" href="gdbtypes_8h.html#a90e2a0fddaa6afff6a0a489ff4da3462af3b3fc76f66c95e12946c0ef84409365">TYPE_CODE_STRUCT</a>
<a name="l11272"></a>11272                       &amp;&amp; <a class="code" href="gdbtypes_8h.html#a9505f41c7012665947c6b4065ce190e1">TYPE_CODE</a> (vtype) != <a class="code" href="gdbtypes_8h.html#a90e2a0fddaa6afff6a0a489ff4da3462a00c795b43d1a39f57d3e222385f14fc0">TYPE_CODE_ARRAY</a>))
<a name="l11273"></a>11273                 {
<a name="l11274"></a>11274                   <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> vaddr = <a class="code" href="value_8c.html#a64c795fa1a8854682b3b727025d0d31d">value_address</a> (v);
<a name="l11275"></a>11275                   <span class="keywordtype">int</span> <a class="code" href="exec_8h.html#a00f945351279d3c8935f13d2b9f9b808">len</a>;
<a name="l11276"></a>11276                   <span class="keywordtype">int</span> num_regs;
<a name="l11277"></a>11277 
<a name="l11278"></a>11278                   len = (target_exact_watchpoints
<a name="l11279"></a>11279                          &amp;&amp; <a class="code" href="gdbtypes_8c.html#a0f2f17623338e84ad1bff7fba7f32daa">is_scalar_type_recursive</a> (vtype))?
<a name="l11280"></a>11280                     1 : <a class="code" href="gdbtypes_8h.html#aeac33f868e763780094aec8a2dcb9a1a">TYPE_LENGTH</a> (<a class="code" href="value_8c.html#a263a4c0bee0b0df41074b952d3c121d0">value_type</a> (v));
<a name="l11281"></a>11281 
<a name="l11282"></a>11282                   num_regs = <a class="code" href="target_8h.html#a3c3f8624352b0e6674a4eb1ddeae1a2f">target_region_ok_for_hw_watchpoint</a> (vaddr, len);
<a name="l11283"></a>11283                   <span class="keywordflow">if</span> (!num_regs)
<a name="l11284"></a>11284                     <span class="keywordflow">return</span> 0;
<a name="l11285"></a>11285                   <span class="keywordflow">else</span>
<a name="l11286"></a>11286                     found_memory_cnt += num_regs;
<a name="l11287"></a>11287                 }
<a name="l11288"></a>11288             }
<a name="l11289"></a>11289         }
<a name="l11290"></a>11290       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="value_8h.html#a39f15e604dd7037545ce2774310b0cd5">VALUE_LVAL</a> (v) != <a class="code" href="defs_8h.html#aae40e9877f56980bf8fac75923a098aba4c7a515c0bfd34444a3b1edfbd282619">not_lval</a>
<a name="l11291"></a>11291                &amp;&amp; <a class="code" href="value_8c.html#af38ad07ecbd1d8ae5a31ad793399d0ba">deprecated_value_modifiable</a> (v) == 0)
<a name="l11292"></a>11292         <span class="keywordflow">return</span> 0;       <span class="comment">/* These are values from the history (e.g., $1).  */</span>
<a name="l11293"></a>11293       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="value_8h.html#a39f15e604dd7037545ce2774310b0cd5">VALUE_LVAL</a> (v) == <a class="code" href="defs_8h.html#aae40e9877f56980bf8fac75923a098abad63b16226e0a89af48f2750b1259377c">lval_register</a>)
<a name="l11294"></a>11294         <span class="keywordflow">return</span> 0;       <span class="comment">/* Cannot watch a register with a HW watchpoint.  */</span>
<a name="l11295"></a>11295     }
<a name="l11296"></a>11296 
<a name="l11297"></a>11297   <span class="comment">/* The expression itself looks suitable for using a hardware</span>
<a name="l11298"></a>11298 <span class="comment">     watchpoint, but give the target machine a chance to reject it.  */</span>
<a name="l11299"></a>11299   <span class="keywordflow">return</span> found_memory_cnt;
<a name="l11300"></a>11300 }
<a name="l11301"></a>11301 
<a name="l11302"></a>11302 <span class="keywordtype">void</span>
<a name="l11303"></a><a class="code" href="breakpoint_8h.html#a7af8ea3826045c6b6a24c678450b7a36">11303</a> <a class="code" href="breakpoint_8c.html#a1371a85a573b2d728cca6127685f5ba4">watch_command_wrapper</a> (<span class="keywordtype">char</span> *arg, <span class="keywordtype">int</span> from_tty, <span class="keywordtype">int</span> <span class="keyword">internal</span>)
<a name="l11304"></a>11304 {
<a name="l11305"></a>11305   watch_command_1 (arg, <a class="code" href="break-common_8h.html#ae1f701210980578c2ab1bc4ae89e69f3a7948cdb19d0afe80f18ac82ef466e07e">hw_write</a>, from_tty, 0, <span class="keyword">internal</span>);
<a name="l11306"></a>11306 }
<a name="l11307"></a>11307 
<a name="l11308"></a>11308 <span class="comment">/* A helper function that looks for the &quot;-location&quot; argument and then</span>
<a name="l11309"></a>11309 <span class="comment">   calls watch_command_1.  */</span>
<a name="l11310"></a>11310 
<a name="l11311"></a>11311 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l11312"></a>11312 watch_maybe_just_location (<span class="keywordtype">char</span> *arg, <span class="keywordtype">int</span> accessflag, <span class="keywordtype">int</span> from_tty)
<a name="l11313"></a>11313 {
<a name="l11314"></a>11314   <span class="keywordtype">int</span> just_location = 0;
<a name="l11315"></a>11315 
<a name="l11316"></a>11316   <span class="keywordflow">if</span> (arg
<a name="l11317"></a>11317       &amp;&amp; (<a class="code" href="cli-utils_8c.html#a8219a48f4f7370425b432c6bf693f346">check_for_argument</a> (&amp;arg, <span class="stringliteral">&quot;-location&quot;</span>, <span class="keyword">sizeof</span> (<span class="stringliteral">&quot;-location&quot;</span>) - 1)
<a name="l11318"></a>11318           || <a class="code" href="cli-utils_8c.html#a8219a48f4f7370425b432c6bf693f346">check_for_argument</a> (&amp;arg, <span class="stringliteral">&quot;-l&quot;</span>, <span class="keyword">sizeof</span> (<span class="stringliteral">&quot;-l&quot;</span>) - 1)))
<a name="l11319"></a>11319     {
<a name="l11320"></a>11320       arg = <a class="code" href="cli-utils_8c.html#afa70bcaee54d487b4412d2a7a5a0c8fa">skip_spaces</a> (arg);
<a name="l11321"></a>11321       just_location = 1;
<a name="l11322"></a>11322     }
<a name="l11323"></a>11323 
<a name="l11324"></a>11324   watch_command_1 (arg, accessflag, from_tty, just_location, 0);
<a name="l11325"></a>11325 }
<a name="l11326"></a>11326 
<a name="l11327"></a>11327 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l11328"></a>11328 watch_command (<span class="keywordtype">char</span> *arg, <span class="keywordtype">int</span> from_tty)
<a name="l11329"></a>11329 {
<a name="l11330"></a>11330   watch_maybe_just_location (arg, <a class="code" href="break-common_8h.html#ae1f701210980578c2ab1bc4ae89e69f3a7948cdb19d0afe80f18ac82ef466e07e">hw_write</a>, from_tty);
<a name="l11331"></a>11331 }
<a name="l11332"></a>11332 
<a name="l11333"></a>11333 <span class="keywordtype">void</span>
<a name="l11334"></a><a class="code" href="breakpoint_8h.html#aff82482e832e77a8a3809686b5efcd1a">11334</a> <a class="code" href="breakpoint_8c.html#af8794f45730b2f4546d7c866bf9bf2d2">rwatch_command_wrapper</a> (<span class="keywordtype">char</span> *arg, <span class="keywordtype">int</span> from_tty, <span class="keywordtype">int</span> <span class="keyword">internal</span>)
<a name="l11335"></a>11335 {
<a name="l11336"></a>11336   watch_command_1 (arg, <a class="code" href="break-common_8h.html#ae1f701210980578c2ab1bc4ae89e69f3afb52ba78eb7679d11a25bd2c44eb0606">hw_read</a>, from_tty, 0, <span class="keyword">internal</span>);
<a name="l11337"></a>11337 }
<a name="l11338"></a>11338 
<a name="l11339"></a>11339 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l11340"></a>11340 rwatch_command (<span class="keywordtype">char</span> *arg, <span class="keywordtype">int</span> from_tty)
<a name="l11341"></a>11341 {
<a name="l11342"></a>11342   watch_maybe_just_location (arg, <a class="code" href="break-common_8h.html#ae1f701210980578c2ab1bc4ae89e69f3afb52ba78eb7679d11a25bd2c44eb0606">hw_read</a>, from_tty);
<a name="l11343"></a>11343 }
<a name="l11344"></a>11344 
<a name="l11345"></a>11345 <span class="keywordtype">void</span>
<a name="l11346"></a><a class="code" href="breakpoint_8h.html#a6371268e3a8af5e91267c1954c7bc5f5">11346</a> <a class="code" href="breakpoint_8c.html#a8fa50fe3df391a4b15a0bc3feb9eaef5">awatch_command_wrapper</a> (<span class="keywordtype">char</span> *arg, <span class="keywordtype">int</span> from_tty, <span class="keywordtype">int</span> <span class="keyword">internal</span>)
<a name="l11347"></a>11347 {
<a name="l11348"></a>11348   watch_command_1 (arg, <a class="code" href="break-common_8h.html#ae1f701210980578c2ab1bc4ae89e69f3a8bef3f5dcfc5f1c5b482627a8ddf5736">hw_access</a>, from_tty, 0, <span class="keyword">internal</span>);
<a name="l11349"></a>11349 }
<a name="l11350"></a>11350 
<a name="l11351"></a>11351 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l11352"></a>11352 awatch_command (<span class="keywordtype">char</span> *arg, <span class="keywordtype">int</span> from_tty)
<a name="l11353"></a>11353 {
<a name="l11354"></a>11354   watch_maybe_just_location (arg, <a class="code" href="break-common_8h.html#ae1f701210980578c2ab1bc4ae89e69f3a8bef3f5dcfc5f1c5b482627a8ddf5736">hw_access</a>, from_tty);
<a name="l11355"></a>11355 }
<a name="l11356"></a>11356 
<a name="l11357"></a>11357 
<a name="l11358"></a>11358 <span class="comment">/* Helper routines for the until_command routine in infcmd.c.  Here</span>
<a name="l11359"></a>11359 <span class="comment">   because it uses the mechanisms of breakpoints.  */</span>
<a name="l11360"></a>11360 
<a name="l11361"></a>11361 <span class="keyword">struct </span>until_break_command_continuation_args
<a name="l11362"></a>11362 {
<a name="l11363"></a>11363   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *<a class="code" href="structbreakpoint.html">breakpoint</a>;
<a name="l11364"></a>11364   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *breakpoint2;
<a name="l11365"></a>11365   <span class="keywordtype">int</span> thread_num;
<a name="l11366"></a>11366 };
<a name="l11367"></a>11367 
<a name="l11368"></a>11368 <span class="comment">/* This function is called by fetch_inferior_event via the</span>
<a name="l11369"></a>11369 <span class="comment">   cmd_continuation pointer, to complete the until command.  It takes</span>
<a name="l11370"></a>11370 <span class="comment">   care of cleaning up the temporary breakpoints set up by the until</span>
<a name="l11371"></a>11371 <span class="comment">   command.  */</span>
<a name="l11372"></a>11372 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l11373"></a>11373 until_break_command_continuation (<span class="keywordtype">void</span> *arg, <span class="keywordtype">int</span> err)
<a name="l11374"></a>11374 {
<a name="l11375"></a>11375   <span class="keyword">struct </span>until_break_command_continuation_args *a = arg;
<a name="l11376"></a>11376 
<a name="l11377"></a>11377   <a class="code" href="breakpoint_8c.html#a0701191361b1ed0d40d76661e88de3f4">delete_breakpoint</a> (a-&gt;breakpoint);
<a name="l11378"></a>11378   <span class="keywordflow">if</span> (a-&gt;breakpoint2)
<a name="l11379"></a>11379     <a class="code" href="breakpoint_8c.html#a0701191361b1ed0d40d76661e88de3f4">delete_breakpoint</a> (a-&gt;breakpoint2);
<a name="l11380"></a>11380   <a class="code" href="breakpoint_8c.html#adacf9780df5e8940a135544ff3ef96d6">delete_longjmp_breakpoint</a> (a-&gt;thread_num);
<a name="l11381"></a>11381 }
<a name="l11382"></a>11382 
<a name="l11383"></a>11383 <span class="keywordtype">void</span>
<a name="l11384"></a><a class="code" href="breakpoint_8h.html#acb9fb0483e90c91c912020694a1a7bbe">11384</a> <a class="code" href="breakpoint_8c.html#ad8cb20e9a34529359c497948da5fd0ee">until_break_command</a> (<span class="keywordtype">char</span> *arg, <span class="keywordtype">int</span> from_tty, <span class="keywordtype">int</span> anywhere)
<a name="l11385"></a>11385 {
<a name="l11386"></a>11386   <span class="keyword">struct </span><a class="code" href="structsymtabs__and__lines.html">symtabs_and_lines</a> sals;
<a name="l11387"></a>11387   <span class="keyword">struct </span><a class="code" href="structsymtab__and__line.html">symtab_and_line</a> sal;
<a name="l11388"></a>11388   <span class="keyword">struct </span>frame_info *frame;
<a name="l11389"></a>11389   <span class="keyword">struct </span>gdbarch *frame_gdbarch;
<a name="l11390"></a>11390   <span class="keyword">struct </span><a class="code" href="structframe__id.html">frame_id</a> stack_frame_id;
<a name="l11391"></a>11391   <span class="keyword">struct </span><a class="code" href="structframe__id.html">frame_id</a> caller_frame_id;
<a name="l11392"></a>11392   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *<a class="code" href="structbreakpoint.html">breakpoint</a>;
<a name="l11393"></a>11393   <span class="keyword">struct </span>breakpoint *breakpoint2 = NULL;
<a name="l11394"></a>11394   <span class="keyword">struct </span>cleanup *old_chain;
<a name="l11395"></a>11395   <span class="keywordtype">int</span> thread;
<a name="l11396"></a>11396   <span class="keyword">struct </span><a class="code" href="structthread__info.html">thread_info</a> *tp;
<a name="l11397"></a>11397 
<a name="l11398"></a>11398   <a class="code" href="inferior_8h.html#a8c032d638c8cc6a62945a19c70a64f71">clear_proceed_status</a> ();
<a name="l11399"></a>11399 
<a name="l11400"></a>11400   <span class="comment">/* Set a breakpoint where the user wants it and at return from</span>
<a name="l11401"></a>11401 <span class="comment">     this function.  */</span>
<a name="l11402"></a>11402 
<a name="l11403"></a>11403   <span class="keywordflow">if</span> (<a class="code" href="stack_8c.html#a47beab727091bf3c0ed6747aa51e88a4">last_displayed_sal_is_valid</a> ())
<a name="l11404"></a>11404     sals = <a class="code" href="linespec_8c.html#ad8b0e76089f41873cf0fb2c14cd2d569">decode_line_1</a> (&amp;arg, <a class="code" href="linespec_8h.html#a66db0c56cdf6b7d07a996c374a0572caadb5b3965c89f02bfa79f8871fde72588">DECODE_LINE_FUNFIRSTLINE</a>,
<a name="l11405"></a>11405                           <a class="code" href="stack_8c.html#afdef12055c64d642f37c595fc63be5f2">get_last_displayed_symtab</a> (),
<a name="l11406"></a>11406                           <a class="code" href="stack_8c.html#a94a7a8437ec860efe5c514ed72cae337">get_last_displayed_line</a> ());
<a name="l11407"></a>11407   <span class="keywordflow">else</span>
<a name="l11408"></a>11408     sals = <a class="code" href="linespec_8c.html#ad8b0e76089f41873cf0fb2c14cd2d569">decode_line_1</a> (&amp;arg, <a class="code" href="linespec_8h.html#a66db0c56cdf6b7d07a996c374a0572caadb5b3965c89f02bfa79f8871fde72588">DECODE_LINE_FUNFIRSTLINE</a>,
<a name="l11409"></a>11409                           (<span class="keyword">struct</span> <a class="code" href="structsymtab.html">symtab</a> *) NULL, 0);
<a name="l11410"></a>11410 
<a name="l11411"></a>11411   <span class="keywordflow">if</span> (sals.<a class="code" href="structsymtabs__and__lines.html#a1c8b832fc2f8c096c95144a2acedd36a">nelts</a> != 1)
<a name="l11412"></a>11412     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Couldn&#39;t get information on specified line.&quot;</span>));
<a name="l11413"></a>11413 
<a name="l11414"></a>11414   sal = sals.<a class="code" href="structsymtabs__and__lines.html#ab601f48fdf29c3b190ba068f57983df4">sals</a>[0];
<a name="l11415"></a>11415   <a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a> (sals.<a class="code" href="structsymtabs__and__lines.html#ab601f48fdf29c3b190ba068f57983df4">sals</a>);    <span class="comment">/* malloc&#39;d, so freed.  */</span>
<a name="l11416"></a>11416 
<a name="l11417"></a>11417   <span class="keywordflow">if</span> (*arg)
<a name="l11418"></a>11418     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Junk at end of arguments.&quot;</span>));
<a name="l11419"></a>11419 
<a name="l11420"></a>11420   <a class="code" href="breakpoint_8c.html#a4ca5af087eb50f4017f1eac8be554088">resolve_sal_pc</a> (&amp;sal);
<a name="l11421"></a>11421 
<a name="l11422"></a>11422   tp = <a class="code" href="gdbthread_8h.html#a668af1dd99cac24599dc0f3ef6458924">inferior_thread</a> ();
<a name="l11423"></a>11423   thread = tp-&gt;<a class="code" href="structthread__info.html#a64accc7e3d39da1d926c23877f9f9d0d">num</a>;
<a name="l11424"></a>11424 
<a name="l11425"></a>11425   old_chain = <a class="code" href="cleanups_8c.html#a3d418f8af424aec399898c2d48b26224">make_cleanup</a> (<a class="code" href="cleanups_8c.html#a1ec2a3980c2be1f31f2142103d1f7abf">null_cleanup</a>, NULL);
<a name="l11426"></a>11426 
<a name="l11427"></a>11427   <span class="comment">/* Note linespec handling above invalidates the frame chain.</span>
<a name="l11428"></a>11428 <span class="comment">     Installing a breakpoint also invalidates the frame chain (as it</span>
<a name="l11429"></a>11429 <span class="comment">     may need to switch threads), so do any frame handling before</span>
<a name="l11430"></a>11430 <span class="comment">     that.  */</span>
<a name="l11431"></a>11431 
<a name="l11432"></a>11432   frame = <a class="code" href="frame_8c.html#a8b714a78478670e14a297eba8d1a9915">get_selected_frame</a> (NULL);
<a name="l11433"></a>11433   frame_gdbarch = <a class="code" href="frame_8c.html#ab44507b5655da44e522ed5857835ede7">get_frame_arch</a> (frame);
<a name="l11434"></a>11434   stack_frame_id = <a class="code" href="frame_8c.html#a1f3e0e4934b8b0f1265a1685457966c5">get_stack_frame_id</a> (frame);
<a name="l11435"></a>11435   caller_frame_id = <a class="code" href="frame_8c.html#a3d22c3305d25d79c59d2c67b5c0c62d8">frame_unwind_caller_id</a> (frame);
<a name="l11436"></a>11436 
<a name="l11437"></a>11437   <span class="comment">/* Keep within the current frame, or in frames called by the current</span>
<a name="l11438"></a>11438 <span class="comment">     one.  */</span>
<a name="l11439"></a>11439 
<a name="l11440"></a>11440   <span class="keywordflow">if</span> (<a class="code" href="frame_8c.html#ad6cfc1ab3a8482a76d8e2862b3fc6542">frame_id_p</a> (caller_frame_id))
<a name="l11441"></a>11441     {
<a name="l11442"></a>11442       <span class="keyword">struct </span><a class="code" href="structsymtab__and__line.html">symtab_and_line</a> sal2;
<a name="l11443"></a>11443 
<a name="l11444"></a>11444       sal2 = <a class="code" href="symtab_8c.html#ad9bbd85700e3d7fa50e7ba0e32f37846">find_pc_line</a> (<a class="code" href="frame_8c.html#a674f48736f1324c31ee825c8294f6101">frame_unwind_caller_pc</a> (frame), 0);
<a name="l11445"></a>11445       sal2.pc = <a class="code" href="frame_8c.html#a674f48736f1324c31ee825c8294f6101">frame_unwind_caller_pc</a> (frame);
<a name="l11446"></a>11446       breakpoint2 = <a class="code" href="breakpoint_8c.html#acd9e4d103f6dc73ba3dc2ef1d0e01293">set_momentary_breakpoint</a> (<a class="code" href="frame_8c.html#ae79a0d95d5b2e5dda66bbd1f2ce0b381">frame_unwind_caller_arch</a> (frame),
<a name="l11447"></a>11447                                               sal2,
<a name="l11448"></a>11448                                               caller_frame_id,
<a name="l11449"></a>11449                                               <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa8e5fb22bf54672648756e2431a7827b6">bp_until</a>);
<a name="l11450"></a>11450       <a class="code" href="breakpoint_8c.html#a9a2dfa07301bdbe8c3b5e7d3f0a6f346">make_cleanup_delete_breakpoint</a> (breakpoint2);
<a name="l11451"></a>11451 
<a name="l11452"></a>11452       <a class="code" href="breakpoint_8c.html#adf1ba914f17564f9ea1f92cea3619b20">set_longjmp_breakpoint</a> (tp, caller_frame_id);
<a name="l11453"></a>11453       <a class="code" href="cleanups_8c.html#a3d418f8af424aec399898c2d48b26224">make_cleanup</a> (<a class="code" href="infcmd_8c.html#af332d1fe8d07899f510b4b8cb5576430">delete_longjmp_breakpoint_cleanup</a>, &amp;thread);
<a name="l11454"></a>11454     }
<a name="l11455"></a>11455 
<a name="l11456"></a>11456   <span class="comment">/* set_momentary_breakpoint could invalidate FRAME.  */</span>
<a name="l11457"></a>11457   frame = NULL;
<a name="l11458"></a>11458 
<a name="l11459"></a>11459   <span class="keywordflow">if</span> (anywhere)
<a name="l11460"></a>11460     <span class="comment">/* If the user told us to continue until a specified location,</span>
<a name="l11461"></a>11461 <span class="comment">       we don&#39;t specify a frame at which we need to stop.  */</span>
<a name="l11462"></a>11462     breakpoint = <a class="code" href="breakpoint_8c.html#acd9e4d103f6dc73ba3dc2ef1d0e01293">set_momentary_breakpoint</a> (frame_gdbarch, sal,
<a name="l11463"></a>11463                                            <a class="code" href="frame_8c.html#a0e92fecdd3b01549ccdc07795de2afee">null_frame_id</a>, <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa8e5fb22bf54672648756e2431a7827b6">bp_until</a>);
<a name="l11464"></a>11464   <span class="keywordflow">else</span>
<a name="l11465"></a>11465     <span class="comment">/* Otherwise, specify the selected frame, because we want to stop</span>
<a name="l11466"></a>11466 <span class="comment">       only at the very same frame.  */</span>
<a name="l11467"></a>11467     breakpoint = <a class="code" href="breakpoint_8c.html#acd9e4d103f6dc73ba3dc2ef1d0e01293">set_momentary_breakpoint</a> (frame_gdbarch, sal,
<a name="l11468"></a>11468                                            stack_frame_id, <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa8e5fb22bf54672648756e2431a7827b6">bp_until</a>);
<a name="l11469"></a>11469   <a class="code" href="breakpoint_8c.html#a9a2dfa07301bdbe8c3b5e7d3f0a6f346">make_cleanup_delete_breakpoint</a> (breakpoint);
<a name="l11470"></a>11470 
<a name="l11471"></a>11471   <a class="code" href="inferior_8h.html#ad878811546bb02b06fc111d939a1ab9a">proceed</a> (-1, GDB_SIGNAL_DEFAULT, 0);
<a name="l11472"></a>11472 
<a name="l11473"></a>11473   <span class="comment">/* If we are running asynchronously, and proceed call above has</span>
<a name="l11474"></a>11474 <span class="comment">     actually managed to start the target, arrange for breakpoints to</span>
<a name="l11475"></a>11475 <span class="comment">     be deleted when the target stops.  Otherwise, we&#39;re already</span>
<a name="l11476"></a>11476 <span class="comment">     stopped and delete breakpoints via cleanup chain.  */</span>
<a name="l11477"></a>11477 
<a name="l11478"></a>11478   <span class="keywordflow">if</span> (<a class="code" href="target_8h.html#a2b6015c90130096b2e9757013e49c1e9">target_can_async_p</a> () &amp;&amp; <a class="code" href="gdbthread_8h.html#aa728736310c4867f1b7477f4ebec62c6">is_running</a> (<a class="code" href="infcmd_8c.html#a428c5be9ce5e70bd03760e828e19c6b7">inferior_ptid</a>))
<a name="l11479"></a>11479     {
<a name="l11480"></a>11480       <span class="keyword">struct </span>until_break_command_continuation_args *args;
<a name="l11481"></a>11481       args = <a class="code" href="common-utils_8c.html#a634d6cd850bb831afebc499579303b3b">xmalloc</a> (<span class="keyword">sizeof</span> (*args));
<a name="l11482"></a>11482 
<a name="l11483"></a>11483       args-&gt;breakpoint = breakpoint;
<a name="l11484"></a>11484       args-&gt;breakpoint2 = breakpoint2;
<a name="l11485"></a>11485       args-&gt;thread_num = thread;
<a name="l11486"></a>11486 
<a name="l11487"></a>11487       <a class="code" href="cleanups_8c.html#a5ec3987bf995edcc44def9e17ada6eba">discard_cleanups</a> (old_chain);
<a name="l11488"></a>11488       <a class="code" href="continuations_8c.html#a082f2d8f63a43f266728e36927b322bf">add_continuation</a> (<a class="code" href="gdbthread_8h.html#a668af1dd99cac24599dc0f3ef6458924">inferior_thread</a> (),
<a name="l11489"></a>11489                         until_break_command_continuation, args,
<a name="l11490"></a>11490                         <a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a>);
<a name="l11491"></a>11491     }
<a name="l11492"></a>11492   <span class="keywordflow">else</span>
<a name="l11493"></a>11493     <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (old_chain);
<a name="l11494"></a>11494 }
<a name="l11495"></a>11495 
<a name="l11496"></a>11496 <span class="comment">/* This function attempts to parse an optional &quot;if &lt;cond&gt;&quot; clause</span>
<a name="l11497"></a>11497 <span class="comment">   from the arg string.  If one is not found, it returns NULL.</span>
<a name="l11498"></a>11498 <span class="comment"></span>
<a name="l11499"></a>11499 <span class="comment">   Else, it returns a pointer to the condition string.  (It does not</span>
<a name="l11500"></a>11500 <span class="comment">   attempt to evaluate the string against a particular block.)  And,</span>
<a name="l11501"></a>11501 <span class="comment">   it updates arg to point to the first character following the parsed</span>
<a name="l11502"></a>11502 <span class="comment">   if clause in the arg string.  */</span>
<a name="l11503"></a>11503 
<a name="l11504"></a>11504 <span class="keywordtype">char</span> *
<a name="l11505"></a><a class="code" href="breakpoint_8h.html#aa11bde242288dea04cb94d33a53ebe81">11505</a> <a class="code" href="breakpoint_8c.html#aa11bde242288dea04cb94d33a53ebe81">ep_parse_optional_if_clause</a> (<span class="keywordtype">char</span> **arg)
<a name="l11506"></a>11506 {
<a name="l11507"></a>11507   <span class="keywordtype">char</span> *cond_string;
<a name="l11508"></a>11508 
<a name="l11509"></a>11509   <span class="keywordflow">if</span> (((*arg)[0] != <span class="charliteral">&#39;i&#39;</span>) || ((*arg)[1] != <span class="charliteral">&#39;f&#39;</span>) || !isspace ((*arg)[2]))
<a name="l11510"></a>11510     <span class="keywordflow">return</span> NULL;
<a name="l11511"></a>11511 
<a name="l11512"></a>11512   <span class="comment">/* Skip the &quot;if&quot; keyword.  */</span>
<a name="l11513"></a>11513   (*arg) += 2;
<a name="l11514"></a>11514 
<a name="l11515"></a>11515   <span class="comment">/* Skip any extra leading whitespace, and record the start of the</span>
<a name="l11516"></a>11516 <span class="comment">     condition string.  */</span>
<a name="l11517"></a>11517   *arg = <a class="code" href="cli-utils_8c.html#afa70bcaee54d487b4412d2a7a5a0c8fa">skip_spaces</a> (*arg);
<a name="l11518"></a>11518   cond_string = *arg;
<a name="l11519"></a>11519 
<a name="l11520"></a>11520   <span class="comment">/* Assume that the condition occupies the remainder of the arg</span>
<a name="l11521"></a>11521 <span class="comment">     string.  */</span>
<a name="l11522"></a>11522   (*arg) += strlen (cond_string);
<a name="l11523"></a>11523 
<a name="l11524"></a>11524   <span class="keywordflow">return</span> cond_string;
<a name="l11525"></a>11525 }
<a name="l11526"></a>11526 
<a name="l11527"></a>11527 <span class="comment">/* Commands to deal with catching events, such as signals, exceptions,</span>
<a name="l11528"></a>11528 <span class="comment">   process start/exit, etc.  */</span>
<a name="l11529"></a>11529 
<a name="l11530"></a><a class="code" href="breakpoint_8c.html#add88a84f24c403251c4b4a497d9ebffe">11530</a> <span class="keyword">typedef</span> <span class="keyword">enum</span>
<a name="l11531"></a>11531 {
<a name="l11532"></a><a class="code" href="breakpoint_8c.html#add88a84f24c403251c4b4a497d9ebffea2797e961ccbe698d6691c8400d6d2bab">11532</a>   <a class="code" href="breakpoint_8c.html#add88a84f24c403251c4b4a497d9ebffea3901caf5cfa8e80890450503d5b20ce2">catch_fork_temporary</a>, <a class="code" href="breakpoint_8c.html#add88a84f24c403251c4b4a497d9ebffea2797e961ccbe698d6691c8400d6d2bab">catch_vfork_temporary</a>,
<a name="l11533"></a><a class="code" href="breakpoint_8c.html#add88a84f24c403251c4b4a497d9ebffea16e523011bdfac6f801602631e429edb">11533</a>   <a class="code" href="breakpoint_8c.html#add88a84f24c403251c4b4a497d9ebffea82ac2c073e10deb5cf47cf04fe6a0f54">catch_fork_permanent</a>, <a class="code" href="breakpoint_8c.html#add88a84f24c403251c4b4a497d9ebffea16e523011bdfac6f801602631e429edb">catch_vfork_permanent</a>
<a name="l11534"></a>11534 }
<a name="l11535"></a>11535 <a class="code" href="breakpoint_8c.html#add88a84f24c403251c4b4a497d9ebffe">catch_fork_kind</a>;
<a name="l11536"></a>11536 
<a name="l11537"></a>11537 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l11538"></a>11538 catch_fork_command_1 (<span class="keywordtype">char</span> *arg, <span class="keywordtype">int</span> from_tty, 
<a name="l11539"></a>11539                       <span class="keyword">struct</span> <a class="code" href="structcmd__list__element.html">cmd_list_element</a> *command)
<a name="l11540"></a>11540 {
<a name="l11541"></a>11541   <span class="keyword">struct </span>gdbarch *gdbarch = <a class="code" href="arch-utils_8c.html#a0fe1e68475f442e5d6dda589e0c62454">get_current_arch</a> ();
<a name="l11542"></a>11542   <span class="keywordtype">char</span> *cond_string = NULL;
<a name="l11543"></a>11543   <a class="code" href="breakpoint_8c.html#add88a84f24c403251c4b4a497d9ebffe">catch_fork_kind</a> fork_kind;
<a name="l11544"></a>11544   <span class="keywordtype">int</span> tempflag;
<a name="l11545"></a>11545 
<a name="l11546"></a>11546   fork_kind = (<a class="code" href="breakpoint_8c.html#add88a84f24c403251c4b4a497d9ebffe">catch_fork_kind</a>) (uintptr_t) <a class="code" href="cli-decode_8c.html#a32e42936fca3a5158162ca425eb2c4b9">get_cmd_context</a> (command);
<a name="l11547"></a>11547   tempflag = (fork_kind == <a class="code" href="breakpoint_8c.html#add88a84f24c403251c4b4a497d9ebffea3901caf5cfa8e80890450503d5b20ce2">catch_fork_temporary</a>
<a name="l11548"></a>11548               || fork_kind == <a class="code" href="breakpoint_8c.html#add88a84f24c403251c4b4a497d9ebffea2797e961ccbe698d6691c8400d6d2bab">catch_vfork_temporary</a>);
<a name="l11549"></a>11549 
<a name="l11550"></a>11550   <span class="keywordflow">if</span> (!arg)
<a name="l11551"></a>11551     arg = <span class="stringliteral">&quot;&quot;</span>;
<a name="l11552"></a>11552   arg = <a class="code" href="cli-utils_8c.html#afa70bcaee54d487b4412d2a7a5a0c8fa">skip_spaces</a> (arg);
<a name="l11553"></a>11553 
<a name="l11554"></a>11554   <span class="comment">/* The allowed syntax is:</span>
<a name="l11555"></a>11555 <span class="comment">     catch [v]fork</span>
<a name="l11556"></a>11556 <span class="comment">     catch [v]fork if &lt;cond&gt;</span>
<a name="l11557"></a>11557 <span class="comment"></span>
<a name="l11558"></a>11558 <span class="comment">     First, check if there&#39;s an if clause.  */</span>
<a name="l11559"></a>11559   cond_string = <a class="code" href="breakpoint_8c.html#aa11bde242288dea04cb94d33a53ebe81">ep_parse_optional_if_clause</a> (&amp;arg);
<a name="l11560"></a>11560 
<a name="l11561"></a>11561   <span class="keywordflow">if</span> ((*arg != <span class="charliteral">&#39;\0&#39;</span>) &amp;&amp; !isspace (*arg))
<a name="l11562"></a>11562     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Junk at end of arguments.&quot;</span>));
<a name="l11563"></a>11563 
<a name="l11564"></a>11564   <span class="comment">/* If this target supports it, create a fork or vfork catchpoint</span>
<a name="l11565"></a>11565 <span class="comment">     and enable reporting of such events.  */</span>
<a name="l11566"></a>11566   <span class="keywordflow">switch</span> (fork_kind)
<a name="l11567"></a>11567     {
<a name="l11568"></a>11568     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8c.html#add88a84f24c403251c4b4a497d9ebffea3901caf5cfa8e80890450503d5b20ce2">catch_fork_temporary</a>:
<a name="l11569"></a>11569     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8c.html#add88a84f24c403251c4b4a497d9ebffea82ac2c073e10deb5cf47cf04fe6a0f54">catch_fork_permanent</a>:
<a name="l11570"></a>11570       create_fork_vfork_event_catchpoint (gdbarch, tempflag, cond_string,
<a name="l11571"></a>11571                                           &amp;catch_fork_breakpoint_ops);
<a name="l11572"></a>11572       <span class="keywordflow">break</span>;
<a name="l11573"></a>11573     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8c.html#add88a84f24c403251c4b4a497d9ebffea2797e961ccbe698d6691c8400d6d2bab">catch_vfork_temporary</a>:
<a name="l11574"></a>11574     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8c.html#add88a84f24c403251c4b4a497d9ebffea16e523011bdfac6f801602631e429edb">catch_vfork_permanent</a>:
<a name="l11575"></a>11575       create_fork_vfork_event_catchpoint (gdbarch, tempflag, cond_string,
<a name="l11576"></a>11576                                           &amp;catch_vfork_breakpoint_ops);
<a name="l11577"></a>11577       <span class="keywordflow">break</span>;
<a name="l11578"></a>11578     <span class="keywordflow">default</span>:
<a name="l11579"></a>11579       <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;unsupported or unknown fork kind; cannot catch it&quot;</span>));
<a name="l11580"></a>11580       <span class="keywordflow">break</span>;
<a name="l11581"></a>11581     }
<a name="l11582"></a>11582 }
<a name="l11583"></a>11583 
<a name="l11584"></a>11584 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l11585"></a>11585 catch_exec_command_1 (<span class="keywordtype">char</span> *arg, <span class="keywordtype">int</span> from_tty, 
<a name="l11586"></a>11586                       <span class="keyword">struct</span> <a class="code" href="structcmd__list__element.html">cmd_list_element</a> *command)
<a name="l11587"></a>11587 {
<a name="l11588"></a>11588   <span class="keyword">struct </span>exec_catchpoint *c;
<a name="l11589"></a>11589   <span class="keyword">struct </span>gdbarch *gdbarch = <a class="code" href="arch-utils_8c.html#a0fe1e68475f442e5d6dda589e0c62454">get_current_arch</a> ();
<a name="l11590"></a>11590   <span class="keywordtype">int</span> tempflag;
<a name="l11591"></a>11591   <span class="keywordtype">char</span> *cond_string = NULL;
<a name="l11592"></a>11592 
<a name="l11593"></a>11593   tempflag = <a class="code" href="cli-decode_8c.html#a32e42936fca3a5158162ca425eb2c4b9">get_cmd_context</a> (command) == <a class="code" href="breakpoint_8h.html#a9f80fa035808be1497fc37fd6595587e">CATCH_TEMPORARY</a>;
<a name="l11594"></a>11594 
<a name="l11595"></a>11595   <span class="keywordflow">if</span> (!arg)
<a name="l11596"></a>11596     arg = <span class="stringliteral">&quot;&quot;</span>;
<a name="l11597"></a>11597   arg = <a class="code" href="cli-utils_8c.html#afa70bcaee54d487b4412d2a7a5a0c8fa">skip_spaces</a> (arg);
<a name="l11598"></a>11598 
<a name="l11599"></a>11599   <span class="comment">/* The allowed syntax is:</span>
<a name="l11600"></a>11600 <span class="comment">     catch exec</span>
<a name="l11601"></a>11601 <span class="comment">     catch exec if &lt;cond&gt;</span>
<a name="l11602"></a>11602 <span class="comment"></span>
<a name="l11603"></a>11603 <span class="comment">     First, check if there&#39;s an if clause.  */</span>
<a name="l11604"></a>11604   cond_string = <a class="code" href="breakpoint_8c.html#aa11bde242288dea04cb94d33a53ebe81">ep_parse_optional_if_clause</a> (&amp;arg);
<a name="l11605"></a>11605 
<a name="l11606"></a>11606   <span class="keywordflow">if</span> ((*arg != <span class="charliteral">&#39;\0&#39;</span>) &amp;&amp; !isspace (*arg))
<a name="l11607"></a>11607     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Junk at end of arguments.&quot;</span>));
<a name="l11608"></a>11608 
<a name="l11609"></a>11609   c = XNEW (<span class="keyword">struct</span> exec_catchpoint);
<a name="l11610"></a>11610   <a class="code" href="breakpoint_8c.html#abf44b8421146622741d99fe9ba43b544">init_catchpoint</a> (&amp;c-&gt;base, gdbarch, tempflag, cond_string,
<a name="l11611"></a>11611                    &amp;catch_exec_breakpoint_ops);
<a name="l11612"></a>11612   c-&gt;exec_pathname = NULL;
<a name="l11613"></a>11613 
<a name="l11614"></a>11614   <a class="code" href="breakpoint_8c.html#a74ff6d8191c3b444efd5631143d21635">install_breakpoint</a> (0, &amp;c-&gt;base, 1);
<a name="l11615"></a>11615 }
<a name="l11616"></a>11616 
<a name="l11617"></a>11617 <span class="keywordtype">void</span>
<a name="l11618"></a><a class="code" href="breakpoint_8h.html#afd6cc798fa29005c7bd6ae73dc7397dd">11618</a> <a class="code" href="breakpoint_8c.html#afd6cc798fa29005c7bd6ae73dc7397dd">init_ada_exception_breakpoint</a> (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b,
<a name="l11619"></a>11619                                <span class="keyword">struct</span> gdbarch *gdbarch,
<a name="l11620"></a>11620                                <span class="keyword">struct</span> <a class="code" href="structsymtab__and__line.html">symtab_and_line</a> sal,
<a name="l11621"></a>11621                                <span class="keywordtype">char</span> *addr_string,
<a name="l11622"></a>11622                                <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structbreakpoint__ops.html">breakpoint_ops</a> *ops,
<a name="l11623"></a>11623                                <span class="keywordtype">int</span> tempflag,
<a name="l11624"></a>11624                                <span class="keywordtype">int</span> enabled,
<a name="l11625"></a>11625                                <span class="keywordtype">int</span> from_tty)
<a name="l11626"></a>11626 {
<a name="l11627"></a>11627   <span class="keywordflow">if</span> (from_tty)
<a name="l11628"></a>11628     {
<a name="l11629"></a>11629       <span class="keyword">struct </span>gdbarch *loc_gdbarch = <a class="code" href="breakpoint_8c.html#ab44e7bca7511390e3baade6daeecf6cd">get_sal_arch</a> (sal);
<a name="l11630"></a>11630       <span class="keywordflow">if</span> (!loc_gdbarch)
<a name="l11631"></a>11631         loc_gdbarch = gdbarch;
<a name="l11632"></a>11632 
<a name="l11633"></a>11633       describe_other_breakpoints (loc_gdbarch,
<a name="l11634"></a>11634                                   sal.<a class="code" href="structsymtab__and__line.html#acc91f0276f4648cb5a970f17ddcbaf09">pspace</a>, sal.<a class="code" href="structsymtab__and__line.html#a77665fa461ad187cb755efa256ba44d7">pc</a>, sal.<a class="code" href="structsymtab__and__line.html#a2e86134f04ab0e4d0834da476b7d020e">section</a>, -1);
<a name="l11635"></a>11635       <span class="comment">/* FIXME: brobecker/2006-12-28: Actually, re-implement a special</span>
<a name="l11636"></a>11636 <span class="comment">         version for exception catchpoints, because two catchpoints</span>
<a name="l11637"></a>11637 <span class="comment">         used for different exception names will use the same address.</span>
<a name="l11638"></a>11638 <span class="comment">         In this case, a &quot;breakpoint ... also set at...&quot; warning is</span>
<a name="l11639"></a>11639 <span class="comment">         unproductive.  Besides, the warning phrasing is also a bit</span>
<a name="l11640"></a>11640 <span class="comment">         inappropriate, we should use the word catchpoint, and tell</span>
<a name="l11641"></a>11641 <span class="comment">         the user what type of catchpoint it is.  The above is good</span>
<a name="l11642"></a>11642 <span class="comment">         enough for now, though.  */</span>
<a name="l11643"></a>11643     }
<a name="l11644"></a>11644 
<a name="l11645"></a>11645   init_raw_breakpoint (b, gdbarch, sal, <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa17768c2bd9137ec6e30c922c5c1d0ffa">bp_breakpoint</a>, ops);
<a name="l11646"></a>11646 
<a name="l11647"></a>11647   b-&gt;<a class="code" href="structbreakpoint.html#acb53352fd35aaad37054508fabc0f3bf">enable_state</a> = enabled ? <a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577a72f1fa981d13a62d05324c1de974b44b">bp_enabled</a> : <a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577a4605f207d0d15bd8195c9b1aa1bfee96">bp_disabled</a>;
<a name="l11648"></a>11648   b-&gt;<a class="code" href="structbreakpoint.html#a75f0f9a837eac292ab6e768e8d8f1bd7">disposition</a> = tempflag ? <a class="code" href="breakpoint_8h.html#a15f2bbd9012f59bc09d59feef0c15732a16da7fb4204cb3f58c753fafa80bfab7">disp_del</a> : <a class="code" href="breakpoint_8h.html#a15f2bbd9012f59bc09d59feef0c15732a01c974d9083d524653d3a437364958be">disp_donttouch</a>;
<a name="l11649"></a>11649   b-&gt;<a class="code" href="structbreakpoint.html#a885e704e5cdcfc314069b970c396d1a4">addr_string</a> = addr_string;
<a name="l11650"></a>11650   b-&gt;<a class="code" href="structbreakpoint.html#adb277de5c8fe68b963cd04aefab977e7">language</a> = <a class="code" href="defs_8h.html#aa37aa8979934d47ac32fd96ecff32202a1ecb230e4f06c0f2f30b97470a2ef621">language_ada</a>;
<a name="l11651"></a>11651 }
<a name="l11652"></a>11652 
<a name="l11653"></a>11653 <span class="comment">/* Splits the argument using space as delimiter.  Returns an xmalloc&#39;d</span>
<a name="l11654"></a>11654 <span class="comment">   filter list, or NULL if no filtering is required.  */</span>
<a name="l11655"></a>11655 <span class="keyword">static</span> <a class="code" href="vec_8h.html#ab084f6f29fcf16a6b15d15feb653d414">VEC</a>(<span class="keywordtype">int</span>) *
<a name="l11656"></a>11656 catch_syscall_split_args (<span class="keywordtype">char</span> *arg)
<a name="l11657"></a>11657 {
<a name="l11658"></a>11658   <a class="code" href="vec_8h.html#ab084f6f29fcf16a6b15d15feb653d414">VEC</a>(<span class="keywordtype">int</span>) *result = NULL;
<a name="l11659"></a>11659   <span class="keyword">struct </span>cleanup *cleanup = <a class="code" href="cleanups_8c.html#a3d418f8af424aec399898c2d48b26224">make_cleanup</a> (<a class="code" href="vec_8h.html#a92a6114eb727b9274e1523d0e9dd2e61">VEC_cleanup</a> (<span class="keywordtype">int</span>), &amp;result);
<a name="l11660"></a>11660 
<a name="l11661"></a>11661   <span class="keywordflow">while</span> (*arg != <span class="charliteral">&#39;\0&#39;</span>)
<a name="l11662"></a>11662     {
<a name="l11663"></a>11663       <span class="keywordtype">int</span> i, syscall_number;
<a name="l11664"></a>11664       <span class="keywordtype">char</span> *endptr;
<a name="l11665"></a>11665       <span class="keywordtype">char</span> cur_name[128];
<a name="l11666"></a>11666       <span class="keyword">struct </span><a class="code" href="structsyscall.html">syscall</a> s;
<a name="l11667"></a>11667 
<a name="l11668"></a>11668       <span class="comment">/* Skip whitespace.  */</span>
<a name="l11669"></a>11669       arg = <a class="code" href="cli-utils_8c.html#afa70bcaee54d487b4412d2a7a5a0c8fa">skip_spaces</a> (arg);
<a name="l11670"></a>11670 
<a name="l11671"></a>11671       <span class="keywordflow">for</span> (i = 0; i &lt; 127 &amp;&amp; arg[i] &amp;&amp; !isspace (arg[i]); ++i)
<a name="l11672"></a>11672         cur_name[i] = arg[i];
<a name="l11673"></a>11673       cur_name[i] = <span class="charliteral">&#39;\0&#39;</span>;
<a name="l11674"></a>11674       arg += i;
<a name="l11675"></a>11675 
<a name="l11676"></a>11676       <span class="comment">/* Check if the user provided a syscall name or a number.  */</span>
<a name="l11677"></a>11677       syscall_number = (<a class="code" href="command_8h.html#a74f207b5aa4ba51c3a2ad59b219a423b">int</a>) strtol (cur_name, &amp;endptr, 0);
<a name="l11678"></a>11678       <span class="keywordflow">if</span> (*endptr == <span class="charliteral">&#39;\0&#39;</span>)
<a name="l11679"></a>11679         <a class="code" href="xml-syscall_8c.html#ac3d1940c50500cae8cc9bf7634416d83">get_syscall_by_number</a> (syscall_number, &amp;s);
<a name="l11680"></a>11680       <span class="keywordflow">else</span>
<a name="l11681"></a>11681         {
<a name="l11682"></a>11682           <span class="comment">/* We have a name.  Let&#39;s check if it&#39;s valid and convert it</span>
<a name="l11683"></a>11683 <span class="comment">             to a number.  */</span>
<a name="l11684"></a>11684           <a class="code" href="xml-syscall_8c.html#a91e685a767b48768081960fbfeee58a6">get_syscall_by_name</a> (cur_name, &amp;s);
<a name="l11685"></a>11685 
<a name="l11686"></a>11686           <span class="keywordflow">if</span> (s.number == <a class="code" href="gdbarch_8h.html#aee97a5b578545a764a45e18dd3a20f91">UNKNOWN_SYSCALL</a>)
<a name="l11687"></a>11687             <span class="comment">/* Here we have to issue an error instead of a warning,</span>
<a name="l11688"></a>11688 <span class="comment">               because GDB cannot do anything useful if there&#39;s no</span>
<a name="l11689"></a>11689 <span class="comment">               syscall number to be caught.  */</span>
<a name="l11690"></a>11690             <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Unknown syscall name &#39;%s&#39;.&quot;</span>), cur_name);
<a name="l11691"></a>11691         }
<a name="l11692"></a>11692 
<a name="l11693"></a>11693       <span class="comment">/* Ok, it&#39;s valid.  */</span>
<a name="l11694"></a>11694       <a class="code" href="vec_8h.html#a8d090c0524726d00931070e0c438ba3f">VEC_safe_push</a> (<span class="keywordtype">int</span>, result, s.number);
<a name="l11695"></a>11695     }
<a name="l11696"></a>11696 
<a name="l11697"></a>11697   <a class="code" href="cleanups_8c.html#a5ec3987bf995edcc44def9e17ada6eba">discard_cleanups</a> (cleanup);
<a name="l11698"></a>11698   <span class="keywordflow">return</span> result;
<a name="l11699"></a>11699 }
<a name="l11700"></a>11700 
<a name="l11701"></a>11701 <span class="comment">/* Implement the &quot;catch syscall&quot; command.  */</span>
<a name="l11702"></a>11702 
<a name="l11703"></a>11703 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l11704"></a>11704 catch_syscall_command_1 (<span class="keywordtype">char</span> *arg, <span class="keywordtype">int</span> from_tty, 
<a name="l11705"></a>11705                          <span class="keyword">struct</span> <a class="code" href="structcmd__list__element.html">cmd_list_element</a> *command)
<a name="l11706"></a>11706 {
<a name="l11707"></a>11707   <span class="keywordtype">int</span> tempflag;
<a name="l11708"></a>11708   <a class="code" href="vec_8h.html#ab084f6f29fcf16a6b15d15feb653d414">VEC</a>(<span class="keywordtype">int</span>) *filter;
<a name="l11709"></a>11709   <span class="keyword">struct </span><a class="code" href="structsyscall.html">syscall</a> s;
<a name="l11710"></a>11710   <span class="keyword">struct </span>gdbarch *gdbarch = <a class="code" href="arch-utils_8c.html#a0fe1e68475f442e5d6dda589e0c62454">get_current_arch</a> ();
<a name="l11711"></a>11711 
<a name="l11712"></a>11712   <span class="comment">/* Checking if the feature if supported.  */</span>
<a name="l11713"></a>11713   <span class="keywordflow">if</span> (<a class="code" href="gdbarch_8c.html#a83628aaf88fcd896ded7a52089bb4a6b">gdbarch_get_syscall_number_p</a> (gdbarch) == 0)
<a name="l11714"></a>11714     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;The feature &#39;catch syscall&#39; is not supported on \</span>
<a name="l11715"></a>11715 <span class="stringliteral">this architecture yet.&quot;</span>));
<a name="l11716"></a>11716 
<a name="l11717"></a>11717   tempflag = <a class="code" href="cli-decode_8c.html#a32e42936fca3a5158162ca425eb2c4b9">get_cmd_context</a> (command) == <a class="code" href="breakpoint_8h.html#a9f80fa035808be1497fc37fd6595587e">CATCH_TEMPORARY</a>;
<a name="l11718"></a>11718 
<a name="l11719"></a>11719   arg = <a class="code" href="cli-utils_8c.html#afa70bcaee54d487b4412d2a7a5a0c8fa">skip_spaces</a> (arg);
<a name="l11720"></a>11720 
<a name="l11721"></a>11721   <span class="comment">/* We need to do this first &quot;dummy&quot; translation in order</span>
<a name="l11722"></a>11722 <span class="comment">     to get the syscall XML file loaded or, most important,</span>
<a name="l11723"></a>11723 <span class="comment">     to display a warning to the user if there&#39;s no XML file</span>
<a name="l11724"></a>11724 <span class="comment">     for his/her architecture.  */</span>
<a name="l11725"></a>11725   <a class="code" href="xml-syscall_8c.html#ac3d1940c50500cae8cc9bf7634416d83">get_syscall_by_number</a> (0, &amp;s);
<a name="l11726"></a>11726 
<a name="l11727"></a>11727   <span class="comment">/* The allowed syntax is:</span>
<a name="l11728"></a>11728 <span class="comment">     catch syscall</span>
<a name="l11729"></a>11729 <span class="comment">     catch syscall &lt;name | number&gt; [&lt;name | number&gt; ... &lt;name | number&gt;]</span>
<a name="l11730"></a>11730 <span class="comment"></span>
<a name="l11731"></a>11731 <span class="comment">     Let&#39;s check if there&#39;s a syscall name.  */</span>
<a name="l11732"></a>11732 
<a name="l11733"></a>11733   <span class="keywordflow">if</span> (arg != NULL)
<a name="l11734"></a>11734     filter = catch_syscall_split_args (arg);
<a name="l11735"></a>11735   <span class="keywordflow">else</span>
<a name="l11736"></a>11736     filter = NULL;
<a name="l11737"></a>11737 
<a name="l11738"></a>11738   create_syscall_event_catchpoint (tempflag, filter,
<a name="l11739"></a>11739                                    &amp;catch_syscall_breakpoint_ops);
<a name="l11740"></a>11740 }
<a name="l11741"></a>11741 
<a name="l11742"></a>11742 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l11743"></a>11743 catch_command (<span class="keywordtype">char</span> *arg, <span class="keywordtype">int</span> from_tty)
<a name="l11744"></a>11744 {
<a name="l11745"></a>11745   <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Catch requires an event name.&quot;</span>));
<a name="l11746"></a>11746 }
<a name="l11747"></a>11747 
<a name="l11748"></a>11748 
<a name="l11749"></a>11749 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l11750"></a>11750 tcatch_command (<span class="keywordtype">char</span> *arg, <span class="keywordtype">int</span> from_tty)
<a name="l11751"></a>11751 {
<a name="l11752"></a>11752   <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Catch requires an event name.&quot;</span>));
<a name="l11753"></a>11753 }
<a name="l11754"></a>11754 
<a name="l11755"></a>11755 <span class="comment">/* A qsort comparison function that sorts breakpoints in order.  */</span>
<a name="l11756"></a>11756 
<a name="l11757"></a>11757 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l11758"></a>11758 compare_breakpoints (<span class="keyword">const</span> <span class="keywordtype">void</span> *a, <span class="keyword">const</span> <span class="keywordtype">void</span> *b)
<a name="l11759"></a>11759 {
<a name="l11760"></a>11760   <span class="keyword">const</span> <a class="code" href="structbreakpoint.html">breakpoint_p</a> *ba = a;
<a name="l11761"></a>11761   uintptr_t ua = (uintptr_t) *ba;
<a name="l11762"></a>11762   <span class="keyword">const</span> <a class="code" href="structbreakpoint.html">breakpoint_p</a> *bb = b;
<a name="l11763"></a>11763   uintptr_t ub = (uintptr_t) *bb;
<a name="l11764"></a>11764 
<a name="l11765"></a>11765   <span class="keywordflow">if</span> ((*ba)-&gt;number &lt; (*bb)-&gt;number)
<a name="l11766"></a>11766     <span class="keywordflow">return</span> -1;
<a name="l11767"></a>11767   <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((*ba)-&gt;number &gt; (*bb)-&gt;number)
<a name="l11768"></a>11768     <span class="keywordflow">return</span> 1;
<a name="l11769"></a>11769 
<a name="l11770"></a>11770   <span class="comment">/* Now sort by address, in case we see, e..g, two breakpoints with</span>
<a name="l11771"></a>11771 <span class="comment">     the number 0.  */</span>
<a name="l11772"></a>11772   <span class="keywordflow">if</span> (ua &lt; ub)
<a name="l11773"></a>11773     <span class="keywordflow">return</span> -1;
<a name="l11774"></a>11774   <span class="keywordflow">return</span> ua &gt; ub ? 1 : 0;
<a name="l11775"></a>11775 }
<a name="l11776"></a>11776 
<a name="l11777"></a>11777 <span class="comment">/* Delete breakpoints by address or line.  */</span>
<a name="l11778"></a>11778 
<a name="l11779"></a>11779 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l11780"></a>11780 clear_command (<span class="keywordtype">char</span> *arg, <span class="keywordtype">int</span> from_tty)
<a name="l11781"></a>11781 {
<a name="l11782"></a>11782   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b, *prev;
<a name="l11783"></a>11783   <a class="code" href="vec_8h.html#ab084f6f29fcf16a6b15d15feb653d414">VEC</a>(<a class="code" href="structbreakpoint.html">breakpoint_p</a>) *found = 0;
<a name="l11784"></a>11784   <span class="keywordtype">int</span> ix;
<a name="l11785"></a>11785   <span class="keywordtype">int</span> default_match;
<a name="l11786"></a>11786   <span class="keyword">struct </span><a class="code" href="structsymtabs__and__lines.html">symtabs_and_lines</a> sals;
<a name="l11787"></a>11787   <span class="keyword">struct </span><a class="code" href="structsymtab__and__line.html">symtab_and_line</a> sal;
<a name="l11788"></a>11788   <span class="keywordtype">int</span> i;
<a name="l11789"></a>11789   <span class="keyword">struct </span>cleanup *cleanups = <a class="code" href="cleanups_8c.html#a3d418f8af424aec399898c2d48b26224">make_cleanup</a> (<a class="code" href="cleanups_8c.html#a1ec2a3980c2be1f31f2142103d1f7abf">null_cleanup</a>, NULL);
<a name="l11790"></a>11790 
<a name="l11791"></a>11791   <span class="keywordflow">if</span> (arg)
<a name="l11792"></a>11792     {
<a name="l11793"></a>11793       sals = <a class="code" href="linespec_8c.html#a99c1ec5e07db5d8ffc64de454d190650">decode_line_with_current_source</a> (arg,
<a name="l11794"></a>11794                                               (<a class="code" href="linespec_8h.html#a66db0c56cdf6b7d07a996c374a0572caadb5b3965c89f02bfa79f8871fde72588">DECODE_LINE_FUNFIRSTLINE</a>
<a name="l11795"></a>11795                                                | <a class="code" href="linespec_8h.html#a66db0c56cdf6b7d07a996c374a0572caae008953599e1c9328463cbbdad314799">DECODE_LINE_LIST_MODE</a>));
<a name="l11796"></a>11796       <a class="code" href="cleanups_8c.html#a3d418f8af424aec399898c2d48b26224">make_cleanup</a> (<a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a>, sals.<a class="code" href="structsymtabs__and__lines.html#ab601f48fdf29c3b190ba068f57983df4">sals</a>);
<a name="l11797"></a>11797       default_match = 0;
<a name="l11798"></a>11798     }
<a name="l11799"></a>11799   <span class="keywordflow">else</span>
<a name="l11800"></a>11800     {
<a name="l11801"></a>11801       sals.<a class="code" href="structsymtabs__and__lines.html#ab601f48fdf29c3b190ba068f57983df4">sals</a> = (<span class="keyword">struct </span><a class="code" href="structsymtab__and__line.html">symtab_and_line</a> *)
<a name="l11802"></a>11802         <a class="code" href="common-utils_8c.html#a634d6cd850bb831afebc499579303b3b">xmalloc</a> (<span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structsymtab__and__line.html">symtab_and_line</a>));
<a name="l11803"></a>11803       <a class="code" href="cleanups_8c.html#a3d418f8af424aec399898c2d48b26224">make_cleanup</a> (<a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a>, sals.<a class="code" href="structsymtabs__and__lines.html#ab601f48fdf29c3b190ba068f57983df4">sals</a>);
<a name="l11804"></a>11804       <a class="code" href="symtab_8c.html#aca3a01a4f0e1a09f99e8308faecc9028">init_sal</a> (&amp;sal);          <span class="comment">/* Initialize to zeroes.  */</span>
<a name="l11805"></a>11805 
<a name="l11806"></a>11806       <span class="comment">/* Set sal&#39;s line, symtab, pc, and pspace to the values</span>
<a name="l11807"></a>11807 <span class="comment">         corresponding to the last call to print_frame_info.  If the</span>
<a name="l11808"></a>11808 <span class="comment">         codepoint is not valid, this will set all the fields to 0.  */</span>
<a name="l11809"></a>11809       <a class="code" href="stack_8c.html#a1dd36b19717f12efb7b06cc658ce085f">get_last_displayed_sal</a> (&amp;sal);
<a name="l11810"></a>11810       <span class="keywordflow">if</span> (sal.<a class="code" href="structsymtab__and__line.html#a74216e171a96d8bcaab43fe69b49c599">symtab</a> == 0)
<a name="l11811"></a>11811         <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;No source file specified.&quot;</span>));
<a name="l11812"></a>11812 
<a name="l11813"></a>11813       sals.<a class="code" href="structsymtabs__and__lines.html#ab601f48fdf29c3b190ba068f57983df4">sals</a>[0] = sal;
<a name="l11814"></a>11814       sals.<a class="code" href="structsymtabs__and__lines.html#a1c8b832fc2f8c096c95144a2acedd36a">nelts</a> = 1;
<a name="l11815"></a>11815 
<a name="l11816"></a>11816       default_match = 1;
<a name="l11817"></a>11817     }
<a name="l11818"></a>11818 
<a name="l11819"></a>11819   <span class="comment">/* We don&#39;t call resolve_sal_pc here.  That&#39;s not as bad as it</span>
<a name="l11820"></a>11820 <span class="comment">     seems, because all existing breakpoints typically have both</span>
<a name="l11821"></a>11821 <span class="comment">     file/line and pc set.  So, if clear is given file/line, we can</span>
<a name="l11822"></a>11822 <span class="comment">     match this to existing breakpoint without obtaining pc at all.</span>
<a name="l11823"></a>11823 <span class="comment"></span>
<a name="l11824"></a>11824 <span class="comment">     We only support clearing given the address explicitly </span>
<a name="l11825"></a>11825 <span class="comment">     present in breakpoint table.  Say, we&#39;ve set breakpoint </span>
<a name="l11826"></a>11826 <span class="comment">     at file:line.  There were several PC values for that file:line,</span>
<a name="l11827"></a>11827 <span class="comment">     due to optimization, all in one block.</span>
<a name="l11828"></a>11828 <span class="comment"></span>
<a name="l11829"></a>11829 <span class="comment">     We&#39;ve picked one PC value.  If &quot;clear&quot; is issued with another</span>
<a name="l11830"></a>11830 <span class="comment">     PC corresponding to the same file:line, the breakpoint won&#39;t</span>
<a name="l11831"></a>11831 <span class="comment">     be cleared.  We probably can still clear the breakpoint, but </span>
<a name="l11832"></a>11832 <span class="comment">     since the other PC value is never presented to user, user</span>
<a name="l11833"></a>11833 <span class="comment">     can only find it by guessing, and it does not seem important</span>
<a name="l11834"></a>11834 <span class="comment">     to support that.  */</span>
<a name="l11835"></a>11835 
<a name="l11836"></a>11836   <span class="comment">/* For each line spec given, delete bps which correspond to it.  Do</span>
<a name="l11837"></a>11837 <span class="comment">     it in two passes, solely to preserve the current behavior that</span>
<a name="l11838"></a>11838 <span class="comment">     from_tty is forced true if we delete more than one</span>
<a name="l11839"></a>11839 <span class="comment">     breakpoint.  */</span>
<a name="l11840"></a>11840 
<a name="l11841"></a>11841   found = NULL;
<a name="l11842"></a>11842   <a class="code" href="cleanups_8c.html#a3d418f8af424aec399898c2d48b26224">make_cleanup</a> (<a class="code" href="vec_8h.html#a92a6114eb727b9274e1523d0e9dd2e61">VEC_cleanup</a> (<a class="code" href="structbreakpoint.html">breakpoint_p</a>), &amp;found);
<a name="l11843"></a>11843   <span class="keywordflow">for</span> (i = 0; i &lt; sals.<a class="code" href="structsymtabs__and__lines.html#a1c8b832fc2f8c096c95144a2acedd36a">nelts</a>; i++)
<a name="l11844"></a>11844     {
<a name="l11845"></a>11845       <span class="keyword">const</span> <span class="keywordtype">char</span> *sal_fullname;
<a name="l11846"></a>11846 
<a name="l11847"></a>11847       <span class="comment">/* If exact pc given, clear bpts at that pc.</span>
<a name="l11848"></a>11848 <span class="comment">         If line given (pc == 0), clear all bpts on specified line.</span>
<a name="l11849"></a>11849 <span class="comment">         If defaulting, clear all bpts on default line</span>
<a name="l11850"></a>11850 <span class="comment">         or at default pc.</span>
<a name="l11851"></a>11851 <span class="comment"></span>
<a name="l11852"></a>11852 <span class="comment">         defaulting    sal.pc != 0    tests to do</span>
<a name="l11853"></a>11853 <span class="comment"></span>
<a name="l11854"></a>11854 <span class="comment">         0              1             pc</span>
<a name="l11855"></a>11855 <span class="comment">         1              1             pc _and_ line</span>
<a name="l11856"></a>11856 <span class="comment">         0              0             line</span>
<a name="l11857"></a>11857 <span class="comment">         1              0             &lt;can&#39;t happen&gt; */</span>
<a name="l11858"></a>11858 
<a name="l11859"></a>11859       sal = sals.<a class="code" href="structsymtabs__and__lines.html#ab601f48fdf29c3b190ba068f57983df4">sals</a>[i];
<a name="l11860"></a>11860       sal_fullname = (sal.<a class="code" href="structsymtab__and__line.html#a74216e171a96d8bcaab43fe69b49c599">symtab</a> == NULL
<a name="l11861"></a>11861                       ? NULL : <a class="code" href="source_8c.html#aa78177718e9d6c01595600975e8254df">symtab_to_fullname</a> (sal.<a class="code" href="structsymtab__and__line.html#a74216e171a96d8bcaab43fe69b49c599">symtab</a>));
<a name="l11862"></a>11862 
<a name="l11863"></a>11863       <span class="comment">/* Find all matching breakpoints and add them to &#39;found&#39;.  */</span>
<a name="l11864"></a>11864       <a class="code" href="breakpoint_8c.html#a781d5d3dc50a92364edfbacac3d0c107">ALL_BREAKPOINTS</a> (b)
<a name="l11865"></a>11865         {
<a name="l11866"></a>11866           <span class="keywordtype">int</span> match = 0;
<a name="l11867"></a>11867           <span class="comment">/* Are we going to delete b?  */</span>
<a name="l11868"></a>11868           <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> != <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfac0517cbb17f625d6cf900fb3aa64636e">bp_none</a> &amp;&amp; !<a class="code" href="breakpoint_8c.html#a49f0d5ff628dd506db5b81f660eb4610">is_watchpoint</a> (b))
<a name="l11869"></a>11869             {
<a name="l11870"></a>11870               <span class="keyword">struct </span>bp_location *loc = b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>;
<a name="l11871"></a>11871               <span class="keywordflow">for</span> (; loc; loc = loc-&gt;<a class="code" href="structbp__location.html#ab193cb38f87fea89105db96d94191541">next</a>)
<a name="l11872"></a>11872                 {
<a name="l11873"></a>11873                   <span class="comment">/* If the user specified file:line, don&#39;t allow a PC</span>
<a name="l11874"></a>11874 <span class="comment">                     match.  This matches historical gdb behavior.  */</span>
<a name="l11875"></a>11875                   <span class="keywordtype">int</span> pc_match = (!sal.<a class="code" href="structsymtab__and__line.html#a410b4ee060f0de75397dd244fcad54da">explicit_line</a>
<a name="l11876"></a>11876                                   &amp;&amp; sal.<a class="code" href="structsymtab__and__line.html#a77665fa461ad187cb755efa256ba44d7">pc</a>
<a name="l11877"></a>11877                                   &amp;&amp; (loc-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a> == sal.<a class="code" href="structsymtab__and__line.html#acc91f0276f4648cb5a970f17ddcbaf09">pspace</a>)
<a name="l11878"></a>11878                                   &amp;&amp; (loc-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a> == sal.<a class="code" href="structsymtab__and__line.html#a77665fa461ad187cb755efa256ba44d7">pc</a>)
<a name="l11879"></a>11879                                   &amp;&amp; (!<a class="code" href="symfile_8c.html#ad63f10fe5266cd2e98883d6f4c054c3a">section_is_overlay</a> (loc-&gt;<a class="code" href="structbp__location.html#ac6d8286e46db5c4be6dab9139c43a00d">section</a>)
<a name="l11880"></a>11880                                       || loc-&gt;<a class="code" href="structbp__location.html#ac6d8286e46db5c4be6dab9139c43a00d">section</a> == sal.<a class="code" href="structsymtab__and__line.html#a2e86134f04ab0e4d0834da476b7d020e">section</a>));
<a name="l11881"></a>11881                   <span class="keywordtype">int</span> line_match = 0;
<a name="l11882"></a>11882 
<a name="l11883"></a>11883                   <span class="keywordflow">if</span> ((default_match || sal.<a class="code" href="structsymtab__and__line.html#a410b4ee060f0de75397dd244fcad54da">explicit_line</a>)
<a name="l11884"></a>11884                       &amp;&amp; loc-&gt;<a class="code" href="structbp__location.html#a1fbe0229a1e449ad3f855dc443869239">symtab</a> != NULL
<a name="l11885"></a>11885                       &amp;&amp; sal_fullname != NULL
<a name="l11886"></a>11886                       &amp;&amp; sal.<a class="code" href="structsymtab__and__line.html#acc91f0276f4648cb5a970f17ddcbaf09">pspace</a> == loc-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a>
<a name="l11887"></a>11887                       &amp;&amp; loc-&gt;<a class="code" href="structbp__location.html#a47eb96040eebcaabb5ab1e2ea7726d17">line_number</a> == sal.<a class="code" href="structsymtab__and__line.html#a6a0468be675b9ac19a5b3ef26f471eaf">line</a>
<a name="l11888"></a>11888                       &amp;&amp; filename_cmp (<a class="code" href="source_8c.html#aa78177718e9d6c01595600975e8254df">symtab_to_fullname</a> (loc-&gt;<a class="code" href="structbp__location.html#a1fbe0229a1e449ad3f855dc443869239">symtab</a>),
<a name="l11889"></a>11889                                        sal_fullname) == 0)
<a name="l11890"></a>11890                     line_match = 1;
<a name="l11891"></a>11891 
<a name="l11892"></a>11892                   <span class="keywordflow">if</span> (pc_match || line_match)
<a name="l11893"></a>11893                     {
<a name="l11894"></a>11894                       match = 1;
<a name="l11895"></a>11895                       <span class="keywordflow">break</span>;
<a name="l11896"></a>11896                     }
<a name="l11897"></a>11897                 }
<a name="l11898"></a>11898             }
<a name="l11899"></a>11899 
<a name="l11900"></a>11900           <span class="keywordflow">if</span> (match)
<a name="l11901"></a>11901             <a class="code" href="vec_8h.html#a8d090c0524726d00931070e0c438ba3f">VEC_safe_push</a>(<a class="code" href="structbreakpoint.html">breakpoint_p</a>, found, b);
<a name="l11902"></a>11902         }
<a name="l11903"></a>11903     }
<a name="l11904"></a>11904 
<a name="l11905"></a>11905   <span class="comment">/* Now go thru the &#39;found&#39; chain and delete them.  */</span>
<a name="l11906"></a>11906   <span class="keywordflow">if</span> (<a class="code" href="vec_8h.html#ac9981d313a5e114db0e05b7b9cd16319">VEC_empty</a>(<a class="code" href="structbreakpoint.html">breakpoint_p</a>, found))
<a name="l11907"></a>11907     {
<a name="l11908"></a>11908       <span class="keywordflow">if</span> (arg)
<a name="l11909"></a>11909         <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;No breakpoint at %s.&quot;</span>), arg);
<a name="l11910"></a>11910       <span class="keywordflow">else</span>
<a name="l11911"></a>11911         <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;No breakpoint at this line.&quot;</span>));
<a name="l11912"></a>11912     }
<a name="l11913"></a>11913 
<a name="l11914"></a>11914   <span class="comment">/* Remove duplicates from the vec.  */</span>
<a name="l11915"></a>11915   <a class="code" href="ada-exp_8c.html#a849e2297facde4d3c80dc4f45f8abbdb">qsort</a> (<a class="code" href="vec_8h.html#a99adc2006a668acc675e3758d9375ad5">VEC_address</a> (<a class="code" href="structbreakpoint.html">breakpoint_p</a>, found),
<a name="l11916"></a>11916          <a class="code" href="vec_8h.html#a844523bba6d0565ef73a0f4a63e48d19">VEC_length</a> (<a class="code" href="structbreakpoint.html">breakpoint_p</a>, found),
<a name="l11917"></a>11917          <span class="keyword">sizeof</span> (<a class="code" href="structbreakpoint.html">breakpoint_p</a>),
<a name="l11918"></a>11918          compare_breakpoints);
<a name="l11919"></a>11919   prev = <a class="code" href="vec_8h.html#a49c128c353995ea8fca27be70829ca52">VEC_index</a> (<a class="code" href="structbreakpoint.html">breakpoint_p</a>, found, 0);
<a name="l11920"></a>11920   <span class="keywordflow">for</span> (ix = 1; <a class="code" href="vec_8h.html#ae7795b0c8e65f45eb49aac5ec2c0fa52">VEC_iterate</a> (<a class="code" href="structbreakpoint.html">breakpoint_p</a>, found, ix, b); ++ix)
<a name="l11921"></a>11921     {
<a name="l11922"></a>11922       <span class="keywordflow">if</span> (b == prev)
<a name="l11923"></a>11923         {
<a name="l11924"></a>11924           <a class="code" href="vec_8h.html#acaaf77b01c775ab677daadb3e339d3d7">VEC_ordered_remove</a> (<a class="code" href="structbreakpoint.html">breakpoint_p</a>, found, ix);
<a name="l11925"></a>11925           --ix;
<a name="l11926"></a>11926         }
<a name="l11927"></a>11927     }
<a name="l11928"></a>11928 
<a name="l11929"></a>11929   <span class="keywordflow">if</span> (<a class="code" href="vec_8h.html#a844523bba6d0565ef73a0f4a63e48d19">VEC_length</a>(<a class="code" href="structbreakpoint.html">breakpoint_p</a>, found) &gt; 1)
<a name="l11930"></a>11930     from_tty = 1;       <span class="comment">/* Always report if deleted more than one.  */</span>
<a name="l11931"></a>11931   <span class="keywordflow">if</span> (from_tty)
<a name="l11932"></a>11932     {
<a name="l11933"></a>11933       <span class="keywordflow">if</span> (<a class="code" href="vec_8h.html#a844523bba6d0565ef73a0f4a63e48d19">VEC_length</a>(<a class="code" href="structbreakpoint.html">breakpoint_p</a>, found) == 1)
<a name="l11934"></a>11934         <a class="code" href="utils_8c.html#ad57145632bbcb0361dc1dfa134b1efd0">printf_unfiltered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Deleted breakpoint &quot;</span>));
<a name="l11935"></a>11935       <span class="keywordflow">else</span>
<a name="l11936"></a>11936         <a class="code" href="utils_8c.html#ad57145632bbcb0361dc1dfa134b1efd0">printf_unfiltered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Deleted breakpoints &quot;</span>));
<a name="l11937"></a>11937     }
<a name="l11938"></a>11938 
<a name="l11939"></a>11939   <span class="keywordflow">for</span> (ix = 0; <a class="code" href="vec_8h.html#ae7795b0c8e65f45eb49aac5ec2c0fa52">VEC_iterate</a>(<a class="code" href="structbreakpoint.html">breakpoint_p</a>, found, ix, b); ix++)
<a name="l11940"></a>11940     {
<a name="l11941"></a>11941       <span class="keywordflow">if</span> (from_tty)
<a name="l11942"></a>11942         <a class="code" href="utils_8c.html#ad57145632bbcb0361dc1dfa134b1efd0">printf_unfiltered</a> (<span class="stringliteral">&quot;%d &quot;</span>, b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>);
<a name="l11943"></a>11943       <a class="code" href="breakpoint_8c.html#a0701191361b1ed0d40d76661e88de3f4">delete_breakpoint</a> (b);
<a name="l11944"></a>11944     }
<a name="l11945"></a>11945   <span class="keywordflow">if</span> (from_tty)
<a name="l11946"></a>11946     <a class="code" href="utils_8c.html#a9540b9a8aa25273516091cb2ae4d21f9">putchar_unfiltered</a> (<span class="charliteral">&#39;\n&#39;</span>);
<a name="l11947"></a>11947 
<a name="l11948"></a>11948   <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (cleanups);
<a name="l11949"></a>11949 }
<a name="l11950"></a>11950 
<a name="l11951"></a>11951 <span class="comment">/* Delete breakpoint in BS if they are `delete&#39; breakpoints and</span>
<a name="l11952"></a>11952 <span class="comment">   all breakpoints that are marked for deletion, whether hit or not.</span>
<a name="l11953"></a>11953 <span class="comment">   This is called after any breakpoint is hit, or after errors.  */</span>
<a name="l11954"></a>11954 
<a name="l11955"></a>11955 <span class="keywordtype">void</span>
<a name="l11956"></a><a class="code" href="breakpoint_8h.html#a7285e483f3fd8c95cc85b0033364653c">11956</a> <a class="code" href="breakpoint_8c.html#a347372c072df1b313a4918d6175b09f6">breakpoint_auto_delete</a> (<a class="code" href="structbpstats.html">bpstat</a> bs)
<a name="l11957"></a>11957 {
<a name="l11958"></a>11958   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b, *b_tmp;
<a name="l11959"></a>11959 
<a name="l11960"></a>11960   <span class="keywordflow">for</span> (; bs; bs = bs-&gt;<a class="code" href="structbpstats.html#a48ed65e040defb4d45e1cea1a8414d6c">next</a>)
<a name="l11961"></a>11961     <span class="keywordflow">if</span> (bs-&gt;<a class="code" href="structbpstats.html#ac105ed7263dd10f9d65e92e706b04e39">breakpoint_at</a>
<a name="l11962"></a>11962         &amp;&amp; bs-&gt;<a class="code" href="structbpstats.html#ac105ed7263dd10f9d65e92e706b04e39">breakpoint_at</a>-&gt;<a class="code" href="structbreakpoint.html#a75f0f9a837eac292ab6e768e8d8f1bd7">disposition</a> == <a class="code" href="breakpoint_8h.html#a15f2bbd9012f59bc09d59feef0c15732a16da7fb4204cb3f58c753fafa80bfab7">disp_del</a>
<a name="l11963"></a>11963         &amp;&amp; bs-&gt;<a class="code" href="structbpstats.html#acff86901962f7bc070661b85248c4652">stop</a>)
<a name="l11964"></a>11964       <a class="code" href="breakpoint_8c.html#a0701191361b1ed0d40d76661e88de3f4">delete_breakpoint</a> (bs-&gt;<a class="code" href="structbpstats.html#ac105ed7263dd10f9d65e92e706b04e39">breakpoint_at</a>);
<a name="l11965"></a>11965 
<a name="l11966"></a>11966   <a class="code" href="breakpoint_8c.html#ace15af58ae54149fbef6d72ecb61e12d">ALL_BREAKPOINTS_SAFE</a> (b, b_tmp)
<a name="l11967"></a>11967   {
<a name="l11968"></a>11968     <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#a75f0f9a837eac292ab6e768e8d8f1bd7">disposition</a> == <a class="code" href="breakpoint_8h.html#a15f2bbd9012f59bc09d59feef0c15732a9b0a2ed54849261d15631bb5e654843b">disp_del_at_next_stop</a>)
<a name="l11969"></a>11969       <a class="code" href="breakpoint_8c.html#a0701191361b1ed0d40d76661e88de3f4">delete_breakpoint</a> (b);
<a name="l11970"></a>11970   }
<a name="l11971"></a>11971 }
<a name="l11972"></a>11972 
<a name="l11973"></a>11973 <span class="comment">/* A comparison function for bp_location AP and BP being interfaced to</span>
<a name="l11974"></a>11974 <span class="comment">   qsort.  Sort elements primarily by their ADDRESS (no matter what</span>
<a name="l11975"></a>11975 <span class="comment">   does breakpoint_address_is_meaningful say for its OWNER),</span>
<a name="l11976"></a>11976 <span class="comment">   secondarily by ordering first bp_permanent OWNERed elements and</span>
<a name="l11977"></a>11977 <span class="comment">   terciarily just ensuring the array is sorted stable way despite</span>
<a name="l11978"></a>11978 <span class="comment">   qsort being an unstable algorithm.  */</span>
<a name="l11979"></a>11979 
<a name="l11980"></a>11980 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l11981"></a>11981 bp_location_compare (<span class="keyword">const</span> <span class="keywordtype">void</span> *ap, <span class="keyword">const</span> <span class="keywordtype">void</span> *bp)
<a name="l11982"></a>11982 {
<a name="l11983"></a>11983   <span class="keyword">struct </span>bp_location *a = *(<span class="keywordtype">void</span> **) ap;
<a name="l11984"></a>11984   <span class="keyword">struct </span>bp_location *b = *(<span class="keywordtype">void</span> **) bp;
<a name="l11985"></a>11985   <span class="comment">/* A and B come from existing breakpoints having non-NULL OWNER.  */</span>
<a name="l11986"></a>11986   <span class="keywordtype">int</span> a_perm = a-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#acb53352fd35aaad37054508fabc0f3bf">enable_state</a> == <a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577adbf2e9b210d33b1ac7e8a7ed87a2b46f">bp_permanent</a>;
<a name="l11987"></a>11987   <span class="keywordtype">int</span> b_perm = b-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#acb53352fd35aaad37054508fabc0f3bf">enable_state</a> == <a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577adbf2e9b210d33b1ac7e8a7ed87a2b46f">bp_permanent</a>;
<a name="l11988"></a>11988 
<a name="l11989"></a>11989   <span class="keywordflow">if</span> (a-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a> != b-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>)
<a name="l11990"></a>11990     <span class="keywordflow">return</span> (a-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a> &gt; b-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>) - (a-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a> &lt; b-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>);
<a name="l11991"></a>11991 
<a name="l11992"></a>11992   <span class="comment">/* Sort locations at the same address by their pspace number, keeping</span>
<a name="l11993"></a>11993 <span class="comment">     locations of the same inferior (in a multi-inferior environment)</span>
<a name="l11994"></a>11994 <span class="comment">     grouped.  */</span>
<a name="l11995"></a>11995 
<a name="l11996"></a>11996   <span class="keywordflow">if</span> (a-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a>-&gt;<a class="code" href="structprogram__space.html#af030e0b6155dde239ce3c3379f8eac96">num</a> != b-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a>-&gt;<a class="code" href="structprogram__space.html#af030e0b6155dde239ce3c3379f8eac96">num</a>)
<a name="l11997"></a>11997     <span class="keywordflow">return</span> ((a-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a>-&gt;<a class="code" href="structprogram__space.html#af030e0b6155dde239ce3c3379f8eac96">num</a> &gt; b-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a>-&gt;<a class="code" href="structprogram__space.html#af030e0b6155dde239ce3c3379f8eac96">num</a>)
<a name="l11998"></a>11998             - (a-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a>-&gt;<a class="code" href="structprogram__space.html#af030e0b6155dde239ce3c3379f8eac96">num</a> &lt; b-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a>-&gt;<a class="code" href="structprogram__space.html#af030e0b6155dde239ce3c3379f8eac96">num</a>));
<a name="l11999"></a>11999 
<a name="l12000"></a>12000   <span class="comment">/* Sort permanent breakpoints first.  */</span>
<a name="l12001"></a>12001   <span class="keywordflow">if</span> (a_perm != b_perm)
<a name="l12002"></a>12002     <span class="keywordflow">return</span> (a_perm &lt; b_perm) - (a_perm &gt; b_perm);
<a name="l12003"></a>12003 
<a name="l12004"></a>12004   <span class="comment">/* Make the internal GDB representation stable across GDB runs</span>
<a name="l12005"></a>12005 <span class="comment">     where A and B memory inside GDB can differ.  Breakpoint locations of</span>
<a name="l12006"></a>12006 <span class="comment">     the same type at the same address can be sorted in arbitrary order.  */</span>
<a name="l12007"></a>12007 
<a name="l12008"></a>12008   <span class="keywordflow">if</span> (a-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a> != b-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>)
<a name="l12009"></a>12009     <span class="keywordflow">return</span> ((a-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a> &gt; b-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>)
<a name="l12010"></a>12010             - (a-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a> &lt; b-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>));
<a name="l12011"></a>12011 
<a name="l12012"></a>12012   <span class="keywordflow">return</span> (a &gt; b) - (a &lt; b);
<a name="l12013"></a>12013 }
<a name="l12014"></a>12014 
<a name="l12015"></a>12015 <span class="comment">/* Set bp_location_placed_address_before_address_max and</span>
<a name="l12016"></a>12016 <span class="comment">   bp_location_shadow_len_after_address_max according to the current</span>
<a name="l12017"></a>12017 <span class="comment">   content of the bp_location array.  */</span>
<a name="l12018"></a>12018 
<a name="l12019"></a>12019 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l12020"></a>12020 bp_location_target_extensions_update (<span class="keywordtype">void</span>)
<a name="l12021"></a>12021 {
<a name="l12022"></a>12022   <span class="keyword">struct </span>bp_location *bl, **blp_tmp;
<a name="l12023"></a>12023 
<a name="l12024"></a>12024   bp_location_placed_address_before_address_max = 0;
<a name="l12025"></a>12025   bp_location_shadow_len_after_address_max = 0;
<a name="l12026"></a>12026 
<a name="l12027"></a>12027   <a class="code" href="breakpoint_8c.html#a6f97c7962df1d91150e0e8de40ff7fe4">ALL_BP_LOCATIONS</a> (bl, blp_tmp)
<a name="l12028"></a>12028     {
<a name="l12029"></a>12029       <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> start, end, addr;
<a name="l12030"></a>12030 
<a name="l12031"></a>12031       <span class="keywordflow">if</span> (!bp_location_has_shadow (bl))
<a name="l12032"></a>12032         <span class="keywordflow">continue</span>;
<a name="l12033"></a>12033 
<a name="l12034"></a>12034       start = bl-&gt;<a class="code" href="structbp__location.html#a72be6a63cd025a9a040df0325fa507af">target_info</a>.<a class="code" href="structbp__target__info.html#a8e3d47e670e13db11873c3ff52934fbb">placed_address</a>;
<a name="l12035"></a>12035       end = start + bl-&gt;<a class="code" href="structbp__location.html#a72be6a63cd025a9a040df0325fa507af">target_info</a>.<a class="code" href="structbp__target__info.html#acb1afc503e5b60c3f351ef664fc74931">shadow_len</a>;
<a name="l12036"></a>12036 
<a name="l12037"></a>12037       <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (bl-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a> &gt;= start);
<a name="l12038"></a>12038       addr = bl-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a> - start;
<a name="l12039"></a>12039       <span class="keywordflow">if</span> (addr &gt; bp_location_placed_address_before_address_max)
<a name="l12040"></a>12040         bp_location_placed_address_before_address_max = addr;
<a name="l12041"></a>12041 
<a name="l12042"></a>12042       <span class="comment">/* Zero SHADOW_LEN would not pass bp_location_has_shadow.  */</span>
<a name="l12043"></a>12043 
<a name="l12044"></a>12044       <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (bl-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a> &lt; end);
<a name="l12045"></a>12045       addr = end - bl-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>;
<a name="l12046"></a>12046       <span class="keywordflow">if</span> (addr &gt; bp_location_shadow_len_after_address_max)
<a name="l12047"></a>12047         bp_location_shadow_len_after_address_max = addr;
<a name="l12048"></a>12048     }
<a name="l12049"></a>12049 }
<a name="l12050"></a>12050 
<a name="l12051"></a>12051 <span class="comment">/* Download tracepoint locations if they haven&#39;t been.  */</span>
<a name="l12052"></a>12052 
<a name="l12053"></a>12053 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l12054"></a>12054 download_tracepoint_locations (<span class="keywordtype">void</span>)
<a name="l12055"></a>12055 {
<a name="l12056"></a>12056   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b;
<a name="l12057"></a>12057   <span class="keyword">struct </span>cleanup *old_chain;
<a name="l12058"></a>12058 
<a name="l12059"></a>12059   <span class="keywordflow">if</span> (!<a class="code" href="target_8h.html#a307fbed0d495eff4ce917dc3555a15d7">target_can_download_tracepoint</a> ())
<a name="l12060"></a>12060     <span class="keywordflow">return</span>;
<a name="l12061"></a>12061 
<a name="l12062"></a>12062   old_chain = <a class="code" href="progspace_8c.html#a6326460454db4e192e2bc221cb322977">save_current_space_and_thread</a> ();
<a name="l12063"></a>12063 
<a name="l12064"></a>12064   <a class="code" href="breakpoint_8c.html#ab5d28883ea0eb745187fab7613ec67d6">ALL_TRACEPOINTS</a> (b)
<a name="l12065"></a>12065     {
<a name="l12066"></a>12066       <span class="keyword">struct </span>bp_location *bl;
<a name="l12067"></a>12067       <span class="keyword">struct </span><a class="code" href="structtracepoint.html">tracepoint</a> *t;
<a name="l12068"></a>12068       <span class="keywordtype">int</span> bp_location_downloaded = 0;
<a name="l12069"></a>12069 
<a name="l12070"></a>12070       <span class="keywordflow">if</span> ((b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa563d27bd02a1303a86081828b40002db">bp_fast_tracepoint</a>
<a name="l12071"></a>12071            ? !may_insert_fast_tracepoints
<a name="l12072"></a>12072            : !may_insert_tracepoints))
<a name="l12073"></a>12073         <span class="keywordflow">continue</span>;
<a name="l12074"></a>12074 
<a name="l12075"></a>12075       <span class="keywordflow">for</span> (bl = b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>; bl; bl = bl-&gt;<a class="code" href="structbp__location.html#ab193cb38f87fea89105db96d94191541">next</a>)
<a name="l12076"></a>12076         {
<a name="l12077"></a>12077           <span class="comment">/* In tracepoint, locations are _never_ duplicated, so</span>
<a name="l12078"></a>12078 <span class="comment">             should_be_inserted is equivalent to</span>
<a name="l12079"></a>12079 <span class="comment">             unduplicated_should_be_inserted.  */</span>
<a name="l12080"></a>12080           <span class="keywordflow">if</span> (!should_be_inserted (bl) || bl-&gt;<a class="code" href="structbp__location.html#acb0b475579bbe5dabeb8ed4504527105">inserted</a>)
<a name="l12081"></a>12081             <span class="keywordflow">continue</span>;
<a name="l12082"></a>12082 
<a name="l12083"></a>12083           <a class="code" href="progspace_8c.html#a58d979e46585ad85280e488204e0147e">switch_to_program_space_and_thread</a> (bl-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a>);
<a name="l12084"></a>12084 
<a name="l12085"></a>12085           <a class="code" href="target_8h.html#a7fd80fa7dbdf49fbf15e93f98e9480ef">target_download_tracepoint</a> (bl);
<a name="l12086"></a>12086 
<a name="l12087"></a>12087           bl-&gt;<a class="code" href="structbp__location.html#acb0b475579bbe5dabeb8ed4504527105">inserted</a> = 1;
<a name="l12088"></a>12088           bp_location_downloaded = 1;
<a name="l12089"></a>12089         }
<a name="l12090"></a>12090       t = (<span class="keyword">struct </span><a class="code" href="structtracepoint.html">tracepoint</a> *) b;
<a name="l12091"></a>12091       t-&gt;<a class="code" href="structtracepoint.html#a32f485dd859434fab98013e1738187d7">number_on_target</a> = b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>;
<a name="l12092"></a>12092       <span class="keywordflow">if</span> (bp_location_downloaded)
<a name="l12093"></a>12093         <a class="code" href="observer_8h.html#a3edacfe44ac49f71646caded92072cad">observer_notify_breakpoint_modified</a> (b);
<a name="l12094"></a>12094     }
<a name="l12095"></a>12095 
<a name="l12096"></a>12096   <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (old_chain);
<a name="l12097"></a>12097 }
<a name="l12098"></a>12098 
<a name="l12099"></a>12099 <span class="comment">/* Swap the insertion/duplication state between two locations.  */</span>
<a name="l12100"></a>12100 
<a name="l12101"></a>12101 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l12102"></a>12102 swap_insertion (<span class="keyword">struct</span> bp_location *left, <span class="keyword">struct</span> bp_location *right)
<a name="l12103"></a>12103 {
<a name="l12104"></a>12104   <span class="keyword">const</span> <span class="keywordtype">int</span> left_inserted = left-&gt;<a class="code" href="structbp__location.html#acb0b475579bbe5dabeb8ed4504527105">inserted</a>;
<a name="l12105"></a>12105   <span class="keyword">const</span> <span class="keywordtype">int</span> left_duplicate = left-&gt;<a class="code" href="structbp__location.html#a1d15bb8313f27fdcdd035bedcfd89199">duplicate</a>;
<a name="l12106"></a>12106   <span class="keyword">const</span> <span class="keywordtype">int</span> left_needs_update = left-&gt;<a class="code" href="structbp__location.html#a5bd9bf988af6d6e3d330fca3361a6a6b">needs_update</a>;
<a name="l12107"></a>12107   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structbp__target__info.html">bp_target_info</a> left_target_info = left-&gt;<a class="code" href="structbp__location.html#a72be6a63cd025a9a040df0325fa507af">target_info</a>;
<a name="l12108"></a>12108 
<a name="l12109"></a>12109   <span class="comment">/* Locations of tracepoints can never be duplicated.  */</span>
<a name="l12110"></a>12110   <span class="keywordflow">if</span> (<a class="code" href="breakpoint_8c.html#ac537492fb781218601862c78225bd118">is_tracepoint</a> (left-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>))
<a name="l12111"></a>12111     <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (!left-&gt;<a class="code" href="structbp__location.html#a1d15bb8313f27fdcdd035bedcfd89199">duplicate</a>);
<a name="l12112"></a>12112   <span class="keywordflow">if</span> (<a class="code" href="breakpoint_8c.html#ac537492fb781218601862c78225bd118">is_tracepoint</a> (right-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>))
<a name="l12113"></a>12113     <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (!right-&gt;<a class="code" href="structbp__location.html#a1d15bb8313f27fdcdd035bedcfd89199">duplicate</a>);
<a name="l12114"></a>12114 
<a name="l12115"></a>12115   left-&gt;<a class="code" href="structbp__location.html#acb0b475579bbe5dabeb8ed4504527105">inserted</a> = right-&gt;<a class="code" href="structbp__location.html#acb0b475579bbe5dabeb8ed4504527105">inserted</a>;
<a name="l12116"></a>12116   left-&gt;<a class="code" href="structbp__location.html#a1d15bb8313f27fdcdd035bedcfd89199">duplicate</a> = right-&gt;<a class="code" href="structbp__location.html#a1d15bb8313f27fdcdd035bedcfd89199">duplicate</a>;
<a name="l12117"></a>12117   left-&gt;<a class="code" href="structbp__location.html#a5bd9bf988af6d6e3d330fca3361a6a6b">needs_update</a> = right-&gt;<a class="code" href="structbp__location.html#a5bd9bf988af6d6e3d330fca3361a6a6b">needs_update</a>;
<a name="l12118"></a>12118   left-&gt;<a class="code" href="structbp__location.html#a72be6a63cd025a9a040df0325fa507af">target_info</a> = right-&gt;<a class="code" href="structbp__location.html#a72be6a63cd025a9a040df0325fa507af">target_info</a>;
<a name="l12119"></a>12119   right-&gt;<a class="code" href="structbp__location.html#acb0b475579bbe5dabeb8ed4504527105">inserted</a> = left_inserted;
<a name="l12120"></a>12120   right-&gt;<a class="code" href="structbp__location.html#a1d15bb8313f27fdcdd035bedcfd89199">duplicate</a> = left_duplicate;
<a name="l12121"></a>12121   right-&gt;<a class="code" href="structbp__location.html#a5bd9bf988af6d6e3d330fca3361a6a6b">needs_update</a> = left_needs_update;
<a name="l12122"></a>12122   right-&gt;<a class="code" href="structbp__location.html#a72be6a63cd025a9a040df0325fa507af">target_info</a> = left_target_info;
<a name="l12123"></a>12123 }
<a name="l12124"></a>12124 
<a name="l12125"></a>12125 <span class="comment">/* Force the re-insertion of the locations at ADDRESS.  This is called</span>
<a name="l12126"></a>12126 <span class="comment">   once a new/deleted/modified duplicate location is found and we are evaluating</span>
<a name="l12127"></a>12127 <span class="comment">   conditions on the target&#39;s side.  Such conditions need to be updated on</span>
<a name="l12128"></a>12128 <span class="comment">   the target.  */</span>
<a name="l12129"></a>12129 
<a name="l12130"></a>12130 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l12131"></a>12131 force_breakpoint_reinsertion (<span class="keyword">struct</span> bp_location *bl)
<a name="l12132"></a>12132 {
<a name="l12133"></a>12133   <span class="keyword">struct </span>bp_location **locp = NULL, **loc2p;
<a name="l12134"></a>12134   <span class="keyword">struct </span>bp_location *loc;
<a name="l12135"></a>12135   <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> address = 0;
<a name="l12136"></a>12136   <span class="keywordtype">int</span> pspace_num;
<a name="l12137"></a>12137 
<a name="l12138"></a>12138   address = bl-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>;
<a name="l12139"></a>12139   pspace_num = bl-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a>-&gt;<a class="code" href="structprogram__space.html#af030e0b6155dde239ce3c3379f8eac96">num</a>;
<a name="l12140"></a>12140 
<a name="l12141"></a>12141   <span class="comment">/* This is only meaningful if the target is</span>
<a name="l12142"></a>12142 <span class="comment">     evaluating conditions and if the user has</span>
<a name="l12143"></a>12143 <span class="comment">     opted for condition evaluation on the target&#39;s</span>
<a name="l12144"></a>12144 <span class="comment">     side.  */</span>
<a name="l12145"></a>12145   <span class="keywordflow">if</span> (gdb_evaluates_breakpoint_condition_p ()
<a name="l12146"></a>12146       || !<a class="code" href="target_8h.html#a029407c9baebfcab86e0488e2d75a2a0">target_supports_evaluation_of_breakpoint_conditions</a> ())
<a name="l12147"></a>12147     <span class="keywordflow">return</span>;
<a name="l12148"></a>12148 
<a name="l12149"></a>12149   <span class="comment">/* Flag all breakpoint locations with this address and</span>
<a name="l12150"></a>12150 <span class="comment">     the same program space as the location</span>
<a name="l12151"></a>12151 <span class="comment">     as &quot;its condition has changed&quot;.  We need to</span>
<a name="l12152"></a>12152 <span class="comment">     update the conditions on the target&#39;s side.  */</span>
<a name="l12153"></a>12153   <a class="code" href="breakpoint_8c.html#af132e38cf4dda2bca037851da14a80bd">ALL_BP_LOCATIONS_AT_ADDR</a> (loc2p, locp, address)
<a name="l12154"></a>12154     {
<a name="l12155"></a>12155       loc = *loc2p;
<a name="l12156"></a>12156 
<a name="l12157"></a>12157       <span class="keywordflow">if</span> (!<a class="code" href="breakpoint_8c.html#a5de9005cc5b36d1d327aa9127ea64f9c">is_breakpoint</a> (loc-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>)
<a name="l12158"></a>12158           || pspace_num != loc-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a>-&gt;<a class="code" href="structprogram__space.html#af030e0b6155dde239ce3c3379f8eac96">num</a>)
<a name="l12159"></a>12159         <span class="keywordflow">continue</span>;
<a name="l12160"></a>12160 
<a name="l12161"></a>12161       <span class="comment">/* Flag the location appropriately.  We use a different state to</span>
<a name="l12162"></a>12162 <span class="comment">         let everyone know that we already updated the set of locations</span>
<a name="l12163"></a>12163 <span class="comment">         with addr bl-&gt;address and program space bl-&gt;pspace.  This is so</span>
<a name="l12164"></a>12164 <span class="comment">         we don&#39;t have to keep calling these functions just to mark locations</span>
<a name="l12165"></a>12165 <span class="comment">         that have already been marked.  */</span>
<a name="l12166"></a>12166       loc-&gt;<a class="code" href="structbp__location.html#a98650d2e2ec957abcf79ce803484e918">condition_changed</a> = <a class="code" href="breakpoint_8h.html#aa20936ce427010a0e9ecaea42e6c3ac3aab613f17baa4653aaaa341ec1c3fd9fc">condition_updated</a>;
<a name="l12167"></a>12167 
<a name="l12168"></a>12168       <span class="comment">/* Free the agent expression bytecode as well.  We will compute</span>
<a name="l12169"></a>12169 <span class="comment">         it later on.  */</span>
<a name="l12170"></a>12170       <span class="keywordflow">if</span> (loc-&gt;<a class="code" href="structbp__location.html#ae8f603085b6974cd8f01aef7a833e6e9">cond_bytecode</a>)
<a name="l12171"></a>12171         {
<a name="l12172"></a>12172           <a class="code" href="ax-general_8c.html#a212888d48dd043f9a37823fb799cd8e4">free_agent_expr</a> (loc-&gt;<a class="code" href="structbp__location.html#ae8f603085b6974cd8f01aef7a833e6e9">cond_bytecode</a>);
<a name="l12173"></a>12173           loc-&gt;<a class="code" href="structbp__location.html#ae8f603085b6974cd8f01aef7a833e6e9">cond_bytecode</a> = NULL;
<a name="l12174"></a>12174         }
<a name="l12175"></a>12175     }
<a name="l12176"></a>12176 }
<a name="l12177"></a>12177 
<a name="l12178"></a>12178 <span class="comment">/* If SHOULD_INSERT is false, do not insert any breakpoint locations</span>
<a name="l12179"></a>12179 <span class="comment">   into the inferior, only remove already-inserted locations that no</span>
<a name="l12180"></a>12180 <span class="comment">   longer should be inserted.  Functions that delete a breakpoint or</span>
<a name="l12181"></a>12181 <span class="comment">   breakpoints should pass false, so that deleting a breakpoint</span>
<a name="l12182"></a>12182 <span class="comment">   doesn&#39;t have the side effect of inserting the locations of other</span>
<a name="l12183"></a>12183 <span class="comment">   breakpoints that are marked not-inserted, but should_be_inserted</span>
<a name="l12184"></a>12184 <span class="comment">   returns true on them.</span>
<a name="l12185"></a>12185 <span class="comment"></span>
<a name="l12186"></a>12186 <span class="comment">   This behaviour is useful is situations close to tear-down -- e.g.,</span>
<a name="l12187"></a>12187 <span class="comment">   after an exec, while the target still has execution, but breakpoint</span>
<a name="l12188"></a>12188 <span class="comment">   shadows of the previous executable image should *NOT* be restored</span>
<a name="l12189"></a>12189 <span class="comment">   to the new image; or before detaching, where the target still has</span>
<a name="l12190"></a>12190 <span class="comment">   execution and wants to delete breakpoints from GDB&#39;s lists, and all</span>
<a name="l12191"></a>12191 <span class="comment">   breakpoints had already been removed from the inferior.  */</span>
<a name="l12192"></a>12192 
<a name="l12193"></a>12193 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l12194"></a>12194 update_global_location_list (<span class="keywordtype">int</span> should_insert)
<a name="l12195"></a>12195 {
<a name="l12196"></a>12196   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b;
<a name="l12197"></a>12197   <span class="keyword">struct </span>bp_location **locp, *loc;
<a name="l12198"></a>12198   <span class="keyword">struct </span>cleanup *cleanups;
<a name="l12199"></a>12199   <span class="comment">/* Last breakpoint location address that was marked for update.  */</span>
<a name="l12200"></a>12200   <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> last_addr = 0;
<a name="l12201"></a>12201   <span class="comment">/* Last breakpoint location program space that was marked for update.  */</span>
<a name="l12202"></a>12202   <span class="keywordtype">int</span> last_pspace_num = -1;
<a name="l12203"></a>12203 
<a name="l12204"></a>12204   <span class="comment">/* Used in the duplicates detection below.  When iterating over all</span>
<a name="l12205"></a>12205 <span class="comment">     bp_locations, points to the first bp_location of a given address.</span>
<a name="l12206"></a>12206 <span class="comment">     Breakpoints and watchpoints of different types are never</span>
<a name="l12207"></a>12207 <span class="comment">     duplicates of each other.  Keep one pointer for each type of</span>
<a name="l12208"></a>12208 <span class="comment">     breakpoint/watchpoint, so we only need to loop over all locations</span>
<a name="l12209"></a>12209 <span class="comment">     once.  */</span>
<a name="l12210"></a>12210   <span class="keyword">struct </span>bp_location *bp_loc_first;  <span class="comment">/* breakpoint */</span>
<a name="l12211"></a>12211   <span class="keyword">struct </span>bp_location *wp_loc_first;  <span class="comment">/* hardware watchpoint */</span>
<a name="l12212"></a>12212   <span class="keyword">struct </span>bp_location *awp_loc_first; <span class="comment">/* access watchpoint */</span>
<a name="l12213"></a>12213   <span class="keyword">struct </span>bp_location *rwp_loc_first; <span class="comment">/* read watchpoint */</span>
<a name="l12214"></a>12214 
<a name="l12215"></a>12215   <span class="comment">/* Saved former bp_location array which we compare against the newly</span>
<a name="l12216"></a>12216 <span class="comment">     built bp_location from the current state of ALL_BREAKPOINTS.  */</span>
<a name="l12217"></a>12217   <span class="keyword">struct </span>bp_location **old_location, **old_locp;
<a name="l12218"></a>12218   <span class="keywordtype">unsigned</span> old_location_count;
<a name="l12219"></a>12219 
<a name="l12220"></a>12220   old_location = bp_location;
<a name="l12221"></a>12221   old_location_count = bp_location_count;
<a name="l12222"></a>12222   bp_location = NULL;
<a name="l12223"></a>12223   bp_location_count = 0;
<a name="l12224"></a>12224   cleanups = <a class="code" href="cleanups_8c.html#a3d418f8af424aec399898c2d48b26224">make_cleanup</a> (<a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a>, old_location);
<a name="l12225"></a>12225 
<a name="l12226"></a>12226   <a class="code" href="breakpoint_8c.html#a781d5d3dc50a92364edfbacac3d0c107">ALL_BREAKPOINTS</a> (b)
<a name="l12227"></a>12227     for (loc = b-&gt;loc; loc; loc = loc-&gt;next)
<a name="l12228"></a>12228       bp_location_count++;
<a name="l12229"></a>12229 
<a name="l12230"></a>12230   bp_location = <a class="code" href="common-utils_8c.html#a634d6cd850bb831afebc499579303b3b">xmalloc</a> (sizeof (*bp_location) * bp_location_count);
<a name="l12231"></a>12231   locp = bp_location;
<a name="l12232"></a>12232   <a class="code" href="breakpoint_8c.html#a781d5d3dc50a92364edfbacac3d0c107">ALL_BREAKPOINTS</a> (b)
<a name="l12233"></a>12233     for (loc = b-&gt;loc; loc; loc = loc-&gt;next)
<a name="l12234"></a>12234       *locp++ = loc;
<a name="l12235"></a>12235   <a class="code" href="ada-exp_8c.html#a849e2297facde4d3c80dc4f45f8abbdb">qsort</a> (bp_location, bp_location_count, sizeof (*bp_location),
<a name="l12236"></a>12236          bp_location_compare);
<a name="l12237"></a>12237 
<a name="l12238"></a>12238   bp_location_target_extensions_update ();
<a name="l12239"></a>12239 
<a name="l12240"></a>12240   <span class="comment">/* Identify bp_location instances that are no longer present in the</span>
<a name="l12241"></a>12241 <span class="comment">     new list, and therefore should be freed.  Note that it&#39;s not</span>
<a name="l12242"></a>12242 <span class="comment">     necessary that those locations should be removed from inferior --</span>
<a name="l12243"></a>12243 <span class="comment">     if there&#39;s another location at the same address (previously</span>
<a name="l12244"></a>12244 <span class="comment">     marked as duplicate), we don&#39;t need to remove/insert the</span>
<a name="l12245"></a>12245 <span class="comment">     location.</span>
<a name="l12246"></a>12246 <span class="comment">     </span>
<a name="l12247"></a>12247 <span class="comment">     LOCP is kept in sync with OLD_LOCP, each pointing to the current</span>
<a name="l12248"></a>12248 <span class="comment">     and former bp_location array state respectively.  */</span>
<a name="l12249"></a>12249 
<a name="l12250"></a>12250   locp = bp_location;
<a name="l12251"></a>12251   for (old_locp = old_location; old_locp &lt; old_location + old_location_count;
<a name="l12252"></a>12252        old_locp++)
<a name="l12253"></a>12253     {
<a name="l12254"></a>12254       <span class="keyword">struct </span>bp_location *old_loc = *old_locp;
<a name="l12255"></a>12255       <span class="keyword">struct </span>bp_location **loc2p;
<a name="l12256"></a>12256 
<a name="l12257"></a>12257       <span class="comment">/* Tells if &#39;old_loc&#39; is found among the new locations.  If</span>
<a name="l12258"></a>12258 <span class="comment">         not, we have to free it.  */</span>
<a name="l12259"></a>12259       <span class="keywordtype">int</span> found_object = 0;
<a name="l12260"></a>12260       <span class="comment">/* Tells if the location should remain inserted in the target.  */</span>
<a name="l12261"></a>12261       <span class="keywordtype">int</span> keep_in_target = 0;
<a name="l12262"></a>12262       <span class="keywordtype">int</span> removed = 0;
<a name="l12263"></a>12263 
<a name="l12264"></a>12264       <span class="comment">/* Skip LOCP entries which will definitely never be needed.</span>
<a name="l12265"></a>12265 <span class="comment">         Stop either at or being the one matching OLD_LOC.  */</span>
<a name="l12266"></a>12266       <span class="keywordflow">while</span> (locp &lt; bp_location + bp_location_count
<a name="l12267"></a>12267              &amp;&amp; (*locp)-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a> &lt; old_loc-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>)
<a name="l12268"></a>12268         locp++;
<a name="l12269"></a>12269 
<a name="l12270"></a>12270       <span class="keywordflow">for</span> (loc2p = locp;
<a name="l12271"></a>12271            (loc2p &lt; bp_location + bp_location_count
<a name="l12272"></a>12272             &amp;&amp; (*loc2p)-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a> == old_loc-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>);
<a name="l12273"></a>12273            loc2p++)
<a name="l12274"></a>12274         {
<a name="l12275"></a>12275           <span class="comment">/* Check if this is a new/duplicated location or a duplicated</span>
<a name="l12276"></a>12276 <span class="comment">             location that had its condition modified.  If so, we want to send</span>
<a name="l12277"></a>12277 <span class="comment">             its condition to the target if evaluation of conditions is taking</span>
<a name="l12278"></a>12278 <span class="comment">             place there.  */</span>
<a name="l12279"></a>12279           <span class="keywordflow">if</span> ((*loc2p)-&gt;condition_changed == <a class="code" href="breakpoint_8h.html#aa20936ce427010a0e9ecaea42e6c3ac3ac369e1dd04e8f50ff2d6825b42a65185">condition_modified</a>
<a name="l12280"></a>12280               &amp;&amp; (last_addr != old_loc-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>
<a name="l12281"></a>12281                   || last_pspace_num != old_loc-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a>-&gt;<a class="code" href="structprogram__space.html#af030e0b6155dde239ce3c3379f8eac96">num</a>))
<a name="l12282"></a>12282             {
<a name="l12283"></a>12283               force_breakpoint_reinsertion (*loc2p);
<a name="l12284"></a>12284               last_pspace_num = old_loc-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a>-&gt;<a class="code" href="structprogram__space.html#af030e0b6155dde239ce3c3379f8eac96">num</a>;
<a name="l12285"></a>12285             }
<a name="l12286"></a>12286 
<a name="l12287"></a>12287           <span class="keywordflow">if</span> (*loc2p == old_loc)
<a name="l12288"></a>12288             found_object = 1;
<a name="l12289"></a>12289         }
<a name="l12290"></a>12290 
<a name="l12291"></a>12291       <span class="comment">/* We have already handled this address, update it so that we don&#39;t</span>
<a name="l12292"></a>12292 <span class="comment">         have to go through updates again.  */</span>
<a name="l12293"></a>12293       last_addr = old_loc-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>;
<a name="l12294"></a>12294 
<a name="l12295"></a>12295       <span class="comment">/* Target-side condition evaluation: Handle deleted locations.  */</span>
<a name="l12296"></a>12296       <span class="keywordflow">if</span> (!found_object)
<a name="l12297"></a>12297         force_breakpoint_reinsertion (old_loc);
<a name="l12298"></a>12298 
<a name="l12299"></a>12299       <span class="comment">/* If this location is no longer present, and inserted, look if</span>
<a name="l12300"></a>12300 <span class="comment">         there&#39;s maybe a new location at the same address.  If so,</span>
<a name="l12301"></a>12301 <span class="comment">         mark that one inserted, and don&#39;t remove this one.  This is</span>
<a name="l12302"></a>12302 <span class="comment">         needed so that we don&#39;t have a time window where a breakpoint</span>
<a name="l12303"></a>12303 <span class="comment">         at certain location is not inserted.  */</span>
<a name="l12304"></a>12304 
<a name="l12305"></a>12305       <span class="keywordflow">if</span> (old_loc-&gt;<a class="code" href="structbp__location.html#acb0b475579bbe5dabeb8ed4504527105">inserted</a>)
<a name="l12306"></a>12306         {
<a name="l12307"></a>12307           <span class="comment">/* If the location is inserted now, we might have to remove</span>
<a name="l12308"></a>12308 <span class="comment">             it.  */</span>
<a name="l12309"></a>12309 
<a name="l12310"></a>12310           <span class="keywordflow">if</span> (found_object &amp;&amp; should_be_inserted (old_loc))
<a name="l12311"></a>12311             {
<a name="l12312"></a>12312               <span class="comment">/* The location is still present in the location list,</span>
<a name="l12313"></a>12313 <span class="comment">                 and still should be inserted.  Don&#39;t do anything.  */</span>
<a name="l12314"></a>12314               keep_in_target = 1;
<a name="l12315"></a>12315             }
<a name="l12316"></a>12316           <span class="keywordflow">else</span>
<a name="l12317"></a>12317             {
<a name="l12318"></a>12318               <span class="comment">/* This location still exists, but it won&#39;t be kept in the</span>
<a name="l12319"></a>12319 <span class="comment">                 target since it may have been disabled.  We proceed to</span>
<a name="l12320"></a>12320 <span class="comment">                 remove its target-side condition.  */</span>
<a name="l12321"></a>12321 
<a name="l12322"></a>12322               <span class="comment">/* The location is either no longer present, or got</span>
<a name="l12323"></a>12323 <span class="comment">                 disabled.  See if there&#39;s another location at the</span>
<a name="l12324"></a>12324 <span class="comment">                 same address, in which case we don&#39;t need to remove</span>
<a name="l12325"></a>12325 <span class="comment">                 this one from the target.  */</span>
<a name="l12326"></a>12326 
<a name="l12327"></a>12327               <span class="comment">/* OLD_LOC comes from existing struct breakpoint.  */</span>
<a name="l12328"></a>12328               <span class="keywordflow">if</span> (breakpoint_address_is_meaningful (old_loc-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>))
<a name="l12329"></a>12329                 {
<a name="l12330"></a>12330                   <span class="keywordflow">for</span> (loc2p = locp;
<a name="l12331"></a>12331                        (loc2p &lt; bp_location + bp_location_count
<a name="l12332"></a>12332                         &amp;&amp; (*loc2p)-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a> == old_loc-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>);
<a name="l12333"></a>12333                        loc2p++)
<a name="l12334"></a>12334                     {
<a name="l12335"></a>12335                       <span class="keyword">struct </span>bp_location *loc2 = *loc2p;
<a name="l12336"></a>12336 
<a name="l12337"></a>12337                       <span class="keywordflow">if</span> (breakpoint_locations_match (loc2, old_loc))
<a name="l12338"></a>12338                         {
<a name="l12339"></a>12339                           <span class="comment">/* Read watchpoint locations are switched to</span>
<a name="l12340"></a>12340 <span class="comment">                             access watchpoints, if the former are not</span>
<a name="l12341"></a>12341 <span class="comment">                             supported, but the latter are.  */</span>
<a name="l12342"></a>12342                           <span class="keywordflow">if</span> (is_hardware_watchpoint (old_loc-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>))
<a name="l12343"></a>12343                             {
<a name="l12344"></a>12344                               <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (is_hardware_watchpoint (loc2-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>));
<a name="l12345"></a>12345                               loc2-&gt;<a class="code" href="structbp__location.html#a0480880dc590f47b72d7af91ab5d5802">watchpoint_type</a> = old_loc-&gt;<a class="code" href="structbp__location.html#a0480880dc590f47b72d7af91ab5d5802">watchpoint_type</a>;
<a name="l12346"></a>12346                             }
<a name="l12347"></a>12347 
<a name="l12348"></a>12348                           <span class="comment">/* loc2 is a duplicated location. We need to check</span>
<a name="l12349"></a>12349 <span class="comment">                             if it should be inserted in case it will be</span>
<a name="l12350"></a>12350 <span class="comment">                             unduplicated.  */</span>
<a name="l12351"></a>12351                           <span class="keywordflow">if</span> (loc2 != old_loc
<a name="l12352"></a>12352                               &amp;&amp; unduplicated_should_be_inserted (loc2))
<a name="l12353"></a>12353                             {
<a name="l12354"></a>12354                               swap_insertion (old_loc, loc2);
<a name="l12355"></a>12355                               keep_in_target = 1;
<a name="l12356"></a>12356                               <span class="keywordflow">break</span>;
<a name="l12357"></a>12357                             }
<a name="l12358"></a>12358                         }
<a name="l12359"></a>12359                     }
<a name="l12360"></a>12360                 }
<a name="l12361"></a>12361             }
<a name="l12362"></a>12362 
<a name="l12363"></a>12363           <span class="keywordflow">if</span> (!keep_in_target)
<a name="l12364"></a>12364             {
<a name="l12365"></a>12365               <span class="keywordflow">if</span> (remove_breakpoint (old_loc, <a class="code" href="breakpoint_8c.html#a644fb6ed981d6c6fe6276d324ac6be1caf92bac8f4a4afba3b9b475022a52dde2">mark_uninserted</a>))
<a name="l12366"></a>12366                 {
<a name="l12367"></a>12367                   <span class="comment">/* This is just about all we can do.  We could keep</span>
<a name="l12368"></a>12368 <span class="comment">                     this location on the global list, and try to</span>
<a name="l12369"></a>12369 <span class="comment">                     remove it next time, but there&#39;s no particular</span>
<a name="l12370"></a>12370 <span class="comment">                     reason why we will succeed next time.</span>
<a name="l12371"></a>12371 <span class="comment">                     </span>
<a name="l12372"></a>12372 <span class="comment">                     Note that at this point, old_loc-&gt;owner is still</span>
<a name="l12373"></a>12373 <span class="comment">                     valid, as delete_breakpoint frees the breakpoint</span>
<a name="l12374"></a>12374 <span class="comment">                     only after calling us.  */</span>
<a name="l12375"></a>12375                   <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;warning: Error removing &quot;</span>
<a name="l12376"></a>12376                                      <span class="stringliteral">&quot;breakpoint %d\n&quot;</span>), 
<a name="l12377"></a>12377                                    old_loc-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>);
<a name="l12378"></a>12378                 }
<a name="l12379"></a>12379               removed = 1;
<a name="l12380"></a>12380             }
<a name="l12381"></a>12381         }
<a name="l12382"></a>12382 
<a name="l12383"></a>12383       <span class="keywordflow">if</span> (!found_object)
<a name="l12384"></a>12384         {
<a name="l12385"></a>12385           <span class="keywordflow">if</span> (removed &amp;&amp; <a class="code" href="inferior_8h.html#af01b8288bc30e83805793d6908408e81">non_stop</a>
<a name="l12386"></a>12386               &amp;&amp; breakpoint_address_is_meaningful (old_loc-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>)
<a name="l12387"></a>12387               &amp;&amp; !is_hardware_watchpoint (old_loc-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>))
<a name="l12388"></a>12388             {
<a name="l12389"></a>12389               <span class="comment">/* This location was removed from the target.  In</span>
<a name="l12390"></a>12390 <span class="comment">                 non-stop mode, a race condition is possible where</span>
<a name="l12391"></a>12391 <span class="comment">                 we&#39;ve removed a breakpoint, but stop events for that</span>
<a name="l12392"></a>12392 <span class="comment">                 breakpoint are already queued and will arrive later.</span>
<a name="l12393"></a>12393 <span class="comment">                 We apply an heuristic to be able to distinguish such</span>
<a name="l12394"></a>12394 <span class="comment">                 SIGTRAPs from other random SIGTRAPs: we keep this</span>
<a name="l12395"></a>12395 <span class="comment">                 breakpoint location for a bit, and will retire it</span>
<a name="l12396"></a>12396 <span class="comment">                 after we see some number of events.  The theory here</span>
<a name="l12397"></a>12397 <span class="comment">                 is that reporting of events should, &quot;on the average&quot;,</span>
<a name="l12398"></a>12398 <span class="comment">                 be fair, so after a while we&#39;ll see events from all</span>
<a name="l12399"></a>12399 <span class="comment">                 threads that have anything of interest, and no longer</span>
<a name="l12400"></a>12400 <span class="comment">                 need to keep this breakpoint location around.  We</span>
<a name="l12401"></a>12401 <span class="comment">                 don&#39;t hold locations forever so to reduce chances of</span>
<a name="l12402"></a>12402 <span class="comment">                 mistaking a non-breakpoint SIGTRAP for a breakpoint</span>
<a name="l12403"></a>12403 <span class="comment">                 SIGTRAP.</span>
<a name="l12404"></a>12404 <span class="comment"></span>
<a name="l12405"></a>12405 <span class="comment">                 The heuristic failing can be disastrous on</span>
<a name="l12406"></a>12406 <span class="comment">                 decr_pc_after_break targets.</span>
<a name="l12407"></a>12407 <span class="comment"></span>
<a name="l12408"></a>12408 <span class="comment">                 On decr_pc_after_break targets, like e.g., x86-linux,</span>
<a name="l12409"></a>12409 <span class="comment">                 if we fail to recognize a late breakpoint SIGTRAP,</span>
<a name="l12410"></a>12410 <span class="comment">                 because events_till_retirement has reached 0 too</span>
<a name="l12411"></a>12411 <span class="comment">                 soon, we&#39;ll fail to do the PC adjustment, and report</span>
<a name="l12412"></a>12412 <span class="comment">                 a random SIGTRAP to the user.  When the user resumes</span>
<a name="l12413"></a>12413 <span class="comment">                 the inferior, it will most likely immediately crash</span>
<a name="l12414"></a>12414 <span class="comment">                 with SIGILL/SIGBUS/SIGSEGV, or worse, get silently</span>
<a name="l12415"></a>12415 <span class="comment">                 corrupted, because of being resumed e.g., in the</span>
<a name="l12416"></a>12416 <span class="comment">                 middle of a multi-byte instruction, or skipped a</span>
<a name="l12417"></a>12417 <span class="comment">                 one-byte instruction.  This was actually seen happen</span>
<a name="l12418"></a>12418 <span class="comment">                 on native x86-linux, and should be less rare on</span>
<a name="l12419"></a>12419 <span class="comment">                 targets that do not support new thread events, like</span>
<a name="l12420"></a>12420 <span class="comment">                 remote, due to the heuristic depending on</span>
<a name="l12421"></a>12421 <span class="comment">                 thread_count.</span>
<a name="l12422"></a>12422 <span class="comment"></span>
<a name="l12423"></a>12423 <span class="comment">                 Mistaking a random SIGTRAP for a breakpoint trap</span>
<a name="l12424"></a>12424 <span class="comment">                 causes similar symptoms (PC adjustment applied when</span>
<a name="l12425"></a>12425 <span class="comment">                 it shouldn&#39;t), but then again, playing with SIGTRAPs</span>
<a name="l12426"></a>12426 <span class="comment">                 behind the debugger&#39;s back is asking for trouble.</span>
<a name="l12427"></a>12427 <span class="comment"></span>
<a name="l12428"></a>12428 <span class="comment">                 Since hardware watchpoint traps are always</span>
<a name="l12429"></a>12429 <span class="comment">                 distinguishable from other traps, so we don&#39;t need to</span>
<a name="l12430"></a>12430 <span class="comment">                 apply keep hardware watchpoint moribund locations</span>
<a name="l12431"></a>12431 <span class="comment">                 around.  We simply always ignore hardware watchpoint</span>
<a name="l12432"></a>12432 <span class="comment">                 traps we can no longer explain.  */</span>
<a name="l12433"></a>12433 
<a name="l12434"></a>12434               old_loc-&gt;<a class="code" href="structbp__location.html#ab21b971addfb038cae975d73502406d8">events_till_retirement</a> = 3 * (<a class="code" href="gdbthread_8h.html#a1b936e50d518844f9b9b8e09a6dc9a7d">thread_count</a> () + 1);
<a name="l12435"></a>12435               old_loc-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a> = NULL;
<a name="l12436"></a>12436 
<a name="l12437"></a>12437               <a class="code" href="vec_8h.html#a8d090c0524726d00931070e0c438ba3f">VEC_safe_push</a> (<a class="code" href="structbp__location.html">bp_location_p</a>, moribund_locations, old_loc);
<a name="l12438"></a>12438             }
<a name="l12439"></a>12439           <span class="keywordflow">else</span>
<a name="l12440"></a>12440             {
<a name="l12441"></a>12441               old_loc-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a> = NULL;
<a name="l12442"></a>12442               decref_bp_location (&amp;old_loc);
<a name="l12443"></a>12443             }
<a name="l12444"></a>12444         }
<a name="l12445"></a>12445     }
<a name="l12446"></a>12446 
<a name="l12447"></a>12447   <span class="comment">/* Rescan breakpoints at the same address and section, marking the</span>
<a name="l12448"></a>12448 <span class="comment">     first one as &quot;first&quot; and any others as &quot;duplicates&quot;.  This is so</span>
<a name="l12449"></a>12449 <span class="comment">     that the bpt instruction is only inserted once.  If we have a</span>
<a name="l12450"></a>12450 <span class="comment">     permanent breakpoint at the same place as BPT, make that one the</span>
<a name="l12451"></a>12451 <span class="comment">     official one, and the rest as duplicates.  Permanent breakpoints</span>
<a name="l12452"></a>12452 <span class="comment">     are sorted first for the same address.</span>
<a name="l12453"></a>12453 <span class="comment"></span>
<a name="l12454"></a>12454 <span class="comment">     Do the same for hardware watchpoints, but also considering the</span>
<a name="l12455"></a>12455 <span class="comment">     watchpoint&#39;s type (regular/access/read) and length.  */</span>
<a name="l12456"></a>12456 
<a name="l12457"></a>12457   bp_loc_first = NULL;
<a name="l12458"></a>12458   wp_loc_first = NULL;
<a name="l12459"></a>12459   awp_loc_first = NULL;
<a name="l12460"></a>12460   rwp_loc_first = NULL;
<a name="l12461"></a>12461   <a class="code" href="breakpoint_8c.html#a6f97c7962df1d91150e0e8de40ff7fe4">ALL_BP_LOCATIONS</a> (loc, locp)
<a name="l12462"></a>12462     {
<a name="l12463"></a>12463       <span class="comment">/* ALL_BP_LOCATIONS bp_location has LOC-&gt;OWNER always</span>
<a name="l12464"></a>12464 <span class="comment">         non-NULL.  */</span>
<a name="l12465"></a>12465       <span class="keyword">struct </span>bp_location **loc_first_p;
<a name="l12466"></a>12466       b = loc-&gt;owner;
<a name="l12467"></a>12467 
<a name="l12468"></a>12468       <span class="keywordflow">if</span> (!unduplicated_should_be_inserted (loc)
<a name="l12469"></a>12469           || !breakpoint_address_is_meaningful (b)
<a name="l12470"></a>12470           <span class="comment">/* Don&#39;t detect duplicate for tracepoint locations because they are</span>
<a name="l12471"></a>12471 <span class="comment">           never duplicated.  See the comments in field `duplicate&#39; of</span>
<a name="l12472"></a>12472 <span class="comment">           `struct bp_location&#39;.  */</span>
<a name="l12473"></a>12473           || <a class="code" href="breakpoint_8c.html#ac537492fb781218601862c78225bd118">is_tracepoint</a> (b))
<a name="l12474"></a>12474         {
<a name="l12475"></a>12475           <span class="comment">/* Clear the condition modification flag.  */</span>
<a name="l12476"></a>12476           loc-&gt;condition_changed = <a class="code" href="breakpoint_8h.html#aa20936ce427010a0e9ecaea42e6c3ac3ac0ae47fdcdaa140292e55057bc5aa29a">condition_unchanged</a>;
<a name="l12477"></a>12477           <span class="keywordflow">continue</span>;
<a name="l12478"></a>12478         }
<a name="l12479"></a>12479 
<a name="l12480"></a>12480       <span class="comment">/* Permanent breakpoint should always be inserted.  */</span>
<a name="l12481"></a>12481       <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#acb53352fd35aaad37054508fabc0f3bf">enable_state</a> == <a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577adbf2e9b210d33b1ac7e8a7ed87a2b46f">bp_permanent</a> &amp;&amp; ! loc-&gt;inserted)
<a name="l12482"></a>12482         <a class="code" href="common-utils_8h.html#aa14285d9d3d4171016ef9cf09447e8bb">internal_error</a> (__FILE__, __LINE__,
<a name="l12483"></a>12483                         <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;allegedly permanent breakpoint is not &quot;</span>
<a name="l12484"></a>12484                         <span class="stringliteral">&quot;actually inserted&quot;</span>));
<a name="l12485"></a>12485 
<a name="l12486"></a>12486       <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfae38a33f5a6725fbca8b5da2d491cfbcb">bp_hardware_watchpoint</a>)
<a name="l12487"></a>12487         loc_first_p = &amp;wp_loc_first;
<a name="l12488"></a>12488       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa7013ee22be60f470b10b2de2f9d22c21">bp_read_watchpoint</a>)
<a name="l12489"></a>12489         loc_first_p = &amp;rwp_loc_first;
<a name="l12490"></a>12490       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa9148c330e0f813ed6fb421af9d7da820">bp_access_watchpoint</a>)
<a name="l12491"></a>12491         loc_first_p = &amp;awp_loc_first;
<a name="l12492"></a>12492       <span class="keywordflow">else</span>
<a name="l12493"></a>12493         loc_first_p = &amp;bp_loc_first;
<a name="l12494"></a>12494 
<a name="l12495"></a>12495       <span class="keywordflow">if</span> (*loc_first_p == NULL
<a name="l12496"></a>12496           || (<a class="code" href="symfile_8c.html#ad96d01ef61ee2925825b3992d37408f5">overlay_debugging</a> &amp;&amp; loc-&gt;section != (*loc_first_p)-&gt;section)
<a name="l12497"></a>12497           || !breakpoint_locations_match (loc, *loc_first_p))
<a name="l12498"></a>12498         {
<a name="l12499"></a>12499           *loc_first_p = loc;
<a name="l12500"></a>12500           loc-&gt;<a class="code" href="structbp__location.html#a1d15bb8313f27fdcdd035bedcfd89199">duplicate</a> = 0;
<a name="l12501"></a>12501 
<a name="l12502"></a>12502           <span class="keywordflow">if</span> (<a class="code" href="breakpoint_8c.html#a5de9005cc5b36d1d327aa9127ea64f9c">is_breakpoint</a> (loc-&gt;owner) &amp;&amp; loc-&gt;condition_changed)
<a name="l12503"></a>12503             {
<a name="l12504"></a>12504               loc-&gt;needs_update = 1;
<a name="l12505"></a>12505               <span class="comment">/* Clear the condition modification flag.  */</span>
<a name="l12506"></a>12506               loc-&gt;condition_changed = <a class="code" href="breakpoint_8h.html#aa20936ce427010a0e9ecaea42e6c3ac3ac0ae47fdcdaa140292e55057bc5aa29a">condition_unchanged</a>;
<a name="l12507"></a>12507             }
<a name="l12508"></a>12508           <span class="keywordflow">continue</span>;
<a name="l12509"></a>12509         }
<a name="l12510"></a>12510 
<a name="l12511"></a>12511 
<a name="l12512"></a>12512       <span class="comment">/* This and the above ensure the invariant that the first location</span>
<a name="l12513"></a>12513 <span class="comment">         is not duplicated, and is the inserted one.</span>
<a name="l12514"></a>12514 <span class="comment">         All following are marked as duplicated, and are not inserted.  */</span>
<a name="l12515"></a>12515       <span class="keywordflow">if</span> (loc-&gt;inserted)
<a name="l12516"></a>12516         swap_insertion (loc, *loc_first_p);
<a name="l12517"></a>12517       loc-&gt;duplicate = 1;
<a name="l12518"></a>12518 
<a name="l12519"></a>12519       <span class="comment">/* Clear the condition modification flag.  */</span>
<a name="l12520"></a>12520       loc-&gt;condition_changed = <a class="code" href="breakpoint_8h.html#aa20936ce427010a0e9ecaea42e6c3ac3ac0ae47fdcdaa140292e55057bc5aa29a">condition_unchanged</a>;
<a name="l12521"></a>12521 
<a name="l12522"></a>12522       <span class="keywordflow">if</span> ((*loc_first_p)-&gt;owner-&gt;enable_state == <a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577adbf2e9b210d33b1ac7e8a7ed87a2b46f">bp_permanent</a> &amp;&amp; loc-&gt;inserted
<a name="l12523"></a>12523           &amp;&amp; b-&gt;<a class="code" href="structbreakpoint.html#acb53352fd35aaad37054508fabc0f3bf">enable_state</a> != <a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577adbf2e9b210d33b1ac7e8a7ed87a2b46f">bp_permanent</a>)
<a name="l12524"></a>12524         <a class="code" href="common-utils_8h.html#aa14285d9d3d4171016ef9cf09447e8bb">internal_error</a> (__FILE__, __LINE__,
<a name="l12525"></a>12525                         <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;another breakpoint was inserted on top of &quot;</span>
<a name="l12526"></a>12526                         <span class="stringliteral">&quot;a permanent breakpoint&quot;</span>));
<a name="l12527"></a>12527     }
<a name="l12528"></a>12528 
<a name="l12529"></a>12529   <span class="keywordflow">if</span> (<a class="code" href="breakpoint_8c.html#a95acbb90087d0c5f6bd455fa8fcdafdc">breakpoints_always_inserted_mode</a> ()
<a name="l12530"></a>12530       &amp;&amp; (<a class="code" href="inferior_8c.html#a943840f890b2cbf5b971cd8b9b30cd9a">have_live_inferiors</a> ()
<a name="l12531"></a>12531           || (<a class="code" href="gdbarch_8c.html#a5e7deb9f392fcd0f807759896fe00919">gdbarch_has_global_breakpoints</a> (<a class="code" href="gdbarch_8c.html#ad648a33f69abe34e9679744a0c5a0580">target_gdbarch</a> ()))))
<a name="l12532"></a>12532     {
<a name="l12533"></a>12533       <span class="keywordflow">if</span> (should_insert)
<a name="l12534"></a>12534         insert_breakpoint_locations ();
<a name="l12535"></a>12535       <span class="keywordflow">else</span>
<a name="l12536"></a>12536         {
<a name="l12537"></a>12537           <span class="comment">/* Though should_insert is false, we may need to update conditions</span>
<a name="l12538"></a>12538 <span class="comment">             on the target&#39;s side if it is evaluating such conditions.  We</span>
<a name="l12539"></a>12539 <span class="comment">             only update conditions for locations that are marked</span>
<a name="l12540"></a>12540 <span class="comment">             &quot;needs_update&quot;.  */</span>
<a name="l12541"></a>12541           update_inserted_breakpoint_locations ();
<a name="l12542"></a>12542         }
<a name="l12543"></a>12543     }
<a name="l12544"></a>12544 
<a name="l12545"></a>12545   <span class="keywordflow">if</span> (should_insert)
<a name="l12546"></a>12546     download_tracepoint_locations ();
<a name="l12547"></a>12547 
<a name="l12548"></a>12548   <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (cleanups);
<a name="l12549"></a>12549 }
<a name="l12550"></a>12550 
<a name="l12551"></a>12551 <span class="keywordtype">void</span>
<a name="l12552"></a><a class="code" href="breakpoint_8h.html#a14b7320a5d81696c6bce84e489b4d050">12552</a> <a class="code" href="breakpoint_8c.html#a14b7320a5d81696c6bce84e489b4d050">breakpoint_retire_moribund</a> (<span class="keywordtype">void</span>)
<a name="l12553"></a>12553 {
<a name="l12554"></a>12554   <span class="keyword">struct </span>bp_location *loc;
<a name="l12555"></a>12555   <span class="keywordtype">int</span> ix;
<a name="l12556"></a>12556 
<a name="l12557"></a>12557   <span class="keywordflow">for</span> (ix = 0; <a class="code" href="vec_8h.html#ae7795b0c8e65f45eb49aac5ec2c0fa52">VEC_iterate</a> (<a class="code" href="structbp__location.html">bp_location_p</a>, moribund_locations, ix, loc); ++ix)
<a name="l12558"></a>12558     <span class="keywordflow">if</span> (--(loc-&gt;<a class="code" href="structbp__location.html#ab21b971addfb038cae975d73502406d8">events_till_retirement</a>) == 0)
<a name="l12559"></a>12559       {
<a name="l12560"></a>12560         decref_bp_location (&amp;loc);
<a name="l12561"></a>12561         <a class="code" href="vec_8h.html#a9b8030a97476b5742a90e8d29e2e9dac">VEC_unordered_remove</a> (<a class="code" href="structbp__location.html">bp_location_p</a>, moribund_locations, ix);
<a name="l12562"></a>12562         --ix;
<a name="l12563"></a>12563       }
<a name="l12564"></a>12564 }
<a name="l12565"></a>12565 
<a name="l12566"></a>12566 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l12567"></a>12567 update_global_location_list_nothrow (<span class="keywordtype">int</span> inserting)
<a name="l12568"></a>12568 {
<a name="l12569"></a>12569   <span class="keyword">volatile</span> <span class="keyword">struct </span><a class="code" href="structgdb__exception.html">gdb_exception</a> e;
<a name="l12570"></a>12570 
<a name="l12571"></a>12571   <a class="code" href="exceptions_8h.html#aef4514ee39b9305fddee27f49c7c34eb">TRY_CATCH</a> (e, <a class="code" href="exceptions_8h.html#abfa3a3b99557b11f5766baf69465fdf6a44de51845416ac49ab08438792b908f0">RETURN_MASK_ERROR</a>)
<a name="l12572"></a>12572     update_global_location_list (inserting);
<a name="l12573"></a>12573 }
<a name="l12574"></a>12574 
<a name="l12575"></a>12575 <span class="comment">/* Clear BKP from a BPS.  */</span>
<a name="l12576"></a>12576 
<a name="l12577"></a>12577 static <span class="keywordtype">void</span>
<a name="l12578"></a>12578 bpstat_remove_bp_location (<a class="code" href="structbpstats.html">bpstat</a> bps, struct <a class="code" href="structbreakpoint.html">breakpoint</a> *bpt)
<a name="l12579"></a>12579 {
<a name="l12580"></a>12580   <a class="code" href="structbpstats.html">bpstat</a> bs;
<a name="l12581"></a>12581 
<a name="l12582"></a>12582   <span class="keywordflow">for</span> (bs = bps; bs; bs = bs-&gt;<a class="code" href="structbpstats.html#a48ed65e040defb4d45e1cea1a8414d6c">next</a>)
<a name="l12583"></a>12583     <span class="keywordflow">if</span> (bs-&gt;<a class="code" href="structbpstats.html#ac105ed7263dd10f9d65e92e706b04e39">breakpoint_at</a> == bpt)
<a name="l12584"></a>12584       {
<a name="l12585"></a>12585         bs-&gt;<a class="code" href="structbpstats.html#ac105ed7263dd10f9d65e92e706b04e39">breakpoint_at</a> = NULL;
<a name="l12586"></a>12586         bs-&gt;<a class="code" href="structbpstats.html#aa68c6ad7e88a1d21640560008a44c287">old_val</a> = NULL;
<a name="l12587"></a>12587         <span class="comment">/* bs-&gt;commands will be freed later.  */</span>
<a name="l12588"></a>12588       }
<a name="l12589"></a>12589 }
<a name="l12590"></a>12590 
<a name="l12591"></a>12591 <span class="comment">/* Callback for iterate_over_threads.  */</span>
<a name="l12592"></a>12592 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l12593"></a>12593 bpstat_remove_breakpoint_callback (<span class="keyword">struct</span> <a class="code" href="structthread__info.html">thread_info</a> *th, <span class="keywordtype">void</span> *data)
<a name="l12594"></a>12594 {
<a name="l12595"></a>12595   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *bpt = data;
<a name="l12596"></a>12596 
<a name="l12597"></a>12597   bpstat_remove_bp_location (th-&gt;<a class="code" href="structthread__info.html#a223c3ebf1726773195c6e75c247ddd3c">control</a>.<a class="code" href="structthread__control__state.html#a15ed8032aa30422557798ba220c38073">stop_bpstat</a>, bpt);
<a name="l12598"></a>12598   <span class="keywordflow">return</span> 0;
<a name="l12599"></a>12599 }
<a name="l12600"></a>12600 
<a name="l12601"></a>12601 <span class="comment">/* Helper for breakpoint and tracepoint breakpoint_ops-&gt;mention</span>
<a name="l12602"></a>12602 <span class="comment">   callbacks.  */</span>
<a name="l12603"></a>12603 
<a name="l12604"></a>12604 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l12605"></a>12605 say_where (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b)
<a name="l12606"></a>12606 {
<a name="l12607"></a>12607   <span class="keyword">struct </span><a class="code" href="structvalue__print__options.html">value_print_options</a> opts;
<a name="l12608"></a>12608 
<a name="l12609"></a>12609   <a class="code" href="valprint_8c.html#aa2d4dfe4b11841ccafc4d0c0d410095d">get_user_print_options</a> (&amp;opts);
<a name="l12610"></a>12610 
<a name="l12611"></a>12611   <span class="comment">/* i18n: cagney/2005-02-11: Below needs to be merged into a</span>
<a name="l12612"></a>12612 <span class="comment">     single string.  */</span>
<a name="l12613"></a>12613   <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a> == NULL)
<a name="l12614"></a>12614     {
<a name="l12615"></a>12615       <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot; (%s) pending.&quot;</span>), b-&gt;<a class="code" href="structbreakpoint.html#a885e704e5cdcfc314069b970c396d1a4">addr_string</a>);
<a name="l12616"></a>12616     }
<a name="l12617"></a>12617   <span class="keywordflow">else</span>
<a name="l12618"></a>12618     {
<a name="l12619"></a>12619       <span class="keywordflow">if</span> (opts.addressprint || b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>-&gt;<a class="code" href="structbp__location.html#a1fbe0229a1e449ad3f855dc443869239">symtab</a> == NULL)
<a name="l12620"></a>12620         {
<a name="l12621"></a>12621           <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot; at &quot;</span>);
<a name="l12622"></a>12622           <a class="code" href="utils_8c.html#a4b28488051faf9ab4a2f07633225835f">fputs_filtered</a> (<a class="code" href="utils_8c.html#ab5c76d72090f01d3848b63dda4e37d1c">paddress</a> (b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>-&gt;<a class="code" href="structbp__location.html#a55f3ff99d536775f5095f11e5f5c3f3e">gdbarch</a>, b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>),
<a name="l12623"></a>12623                           <a class="code" href="main_8c.html#a41a2b997ba5454df787d61f051dd918c">gdb_stdout</a>);
<a name="l12624"></a>12624         }
<a name="l12625"></a>12625       <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>-&gt;<a class="code" href="structbp__location.html#a1fbe0229a1e449ad3f855dc443869239">symtab</a> != NULL)
<a name="l12626"></a>12626         {
<a name="l12627"></a>12627           <span class="comment">/* If there is a single location, we can print the location</span>
<a name="l12628"></a>12628 <span class="comment">             more nicely.  */</span>
<a name="l12629"></a>12629           <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>-&gt;<a class="code" href="structbp__location.html#ab193cb38f87fea89105db96d94191541">next</a> == NULL)
<a name="l12630"></a>12630             <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;: file %s, line %d.&quot;</span>,
<a name="l12631"></a>12631                              <a class="code" href="source_8c.html#ae251616cab166301d5fed95cbdd31232">symtab_to_filename_for_display</a> (b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>-&gt;<a class="code" href="structbp__location.html#a1fbe0229a1e449ad3f855dc443869239">symtab</a>),
<a name="l12632"></a>12632                              b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>-&gt;<a class="code" href="structbp__location.html#a47eb96040eebcaabb5ab1e2ea7726d17">line_number</a>);
<a name="l12633"></a>12633           <span class="keywordflow">else</span>
<a name="l12634"></a>12634             <span class="comment">/* This is not ideal, but each location may have a</span>
<a name="l12635"></a>12635 <span class="comment">               different file name, and this at least reflects the</span>
<a name="l12636"></a>12636 <span class="comment">               real situation somewhat.  */</span>
<a name="l12637"></a>12637             <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;: %s.&quot;</span>, b-&gt;<a class="code" href="structbreakpoint.html#a885e704e5cdcfc314069b970c396d1a4">addr_string</a>);
<a name="l12638"></a>12638         }
<a name="l12639"></a>12639 
<a name="l12640"></a>12640       <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>-&gt;<a class="code" href="structbp__location.html#ab193cb38f87fea89105db96d94191541">next</a>)
<a name="l12641"></a>12641         {
<a name="l12642"></a>12642           <span class="keyword">struct </span>bp_location *loc = b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>;
<a name="l12643"></a>12643           <span class="keywordtype">int</span> n = 0;
<a name="l12644"></a>12644           <span class="keywordflow">for</span> (; loc; loc = loc-&gt;<a class="code" href="structbp__location.html#ab193cb38f87fea89105db96d94191541">next</a>)
<a name="l12645"></a>12645             ++n;
<a name="l12646"></a>12646           <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot; (%d locations)&quot;</span>, n);
<a name="l12647"></a>12647         }
<a name="l12648"></a>12648     }
<a name="l12649"></a>12649 }
<a name="l12650"></a>12650 
<a name="l12651"></a>12651 <span class="comment">/* Default bp_location_ops methods.  */</span>
<a name="l12652"></a>12652 
<a name="l12653"></a>12653 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l12654"></a>12654 bp_location_dtor (<span class="keyword">struct</span> bp_location *<span class="keyword">self</span>)
<a name="l12655"></a>12655 {
<a name="l12656"></a>12656   <a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a> (self-&gt;cond);
<a name="l12657"></a>12657   <span class="keywordflow">if</span> (self-&gt;cond_bytecode)
<a name="l12658"></a>12658     <a class="code" href="ax-general_8c.html#a212888d48dd043f9a37823fb799cd8e4">free_agent_expr</a> (self-&gt;cond_bytecode);
<a name="l12659"></a>12659   <a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a> (self-&gt;function_name);
<a name="l12660"></a>12660 }
<a name="l12661"></a>12661 
<a name="l12662"></a>12662 <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structbp__location__ops.html">bp_location_ops</a> <a class="code" href="structbp__location__ops.html">bp_location_ops</a> =
<a name="l12663"></a>12663 {
<a name="l12664"></a>12664   bp_location_dtor
<a name="l12665"></a>12665 };
<a name="l12666"></a>12666 
<a name="l12667"></a>12667 <span class="comment">/* Default breakpoint_ops methods all breakpoint_ops ultimately</span>
<a name="l12668"></a>12668 <span class="comment">   inherit from.  */</span>
<a name="l12669"></a>12669 
<a name="l12670"></a>12670 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l12671"></a>12671 base_breakpoint_dtor (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *<span class="keyword">self</span>)
<a name="l12672"></a>12672 {
<a name="l12673"></a>12673   decref_counted_command_line (&amp;self-&gt;commands);
<a name="l12674"></a>12674   <a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a> (self-&gt;cond_string);
<a name="l12675"></a>12675   <a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a> (self-&gt;extra_string);
<a name="l12676"></a>12676   <a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a> (self-&gt;addr_string);
<a name="l12677"></a>12677   <a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a> (self-&gt;filter);
<a name="l12678"></a>12678   <a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a> (self-&gt;addr_string_range_end);
<a name="l12679"></a>12679 }
<a name="l12680"></a>12680 
<a name="l12681"></a>12681 <span class="keyword">static</span> <span class="keyword">struct </span>bp_location *
<a name="l12682"></a>12682 base_breakpoint_allocate_location (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *<span class="keyword">self</span>)
<a name="l12683"></a>12683 {
<a name="l12684"></a>12684   <span class="keyword">struct </span>bp_location *loc;
<a name="l12685"></a>12685 
<a name="l12686"></a>12686   loc = XNEW (<span class="keyword">struct</span> bp_location);
<a name="l12687"></a>12687   <a class="code" href="breakpoint_8c.html#ae971720e6c09c471408d173beee367cd">init_bp_location</a> (loc, &amp;bp_location_ops, <span class="keyword">self</span>);
<a name="l12688"></a>12688   <span class="keywordflow">return</span> loc;
<a name="l12689"></a>12689 }
<a name="l12690"></a>12690 
<a name="l12691"></a>12691 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l12692"></a>12692 base_breakpoint_re_set (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b)
<a name="l12693"></a>12693 {
<a name="l12694"></a>12694   <span class="comment">/* Nothing to re-set. */</span>
<a name="l12695"></a>12695 }
<a name="l12696"></a>12696 
<a name="l12697"></a><a class="code" href="breakpoint_8c.html#aa0e08e0b13f7e12e22ca3039ced9bc36">12697</a> <span class="preprocessor">#define internal_error_pure_virtual_called() \</span>
<a name="l12698"></a>12698 <span class="preprocessor">  gdb_assert_not_reached (&quot;pure virtual function called&quot;)</span>
<a name="l12699"></a>12699 <span class="preprocessor"></span>
<a name="l12700"></a>12700 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l12701"></a>12701 base_breakpoint_insert_location (<span class="keyword">struct</span> bp_location *bl)
<a name="l12702"></a>12702 {
<a name="l12703"></a>12703   <a class="code" href="breakpoint_8c.html#aa0e08e0b13f7e12e22ca3039ced9bc36">internal_error_pure_virtual_called</a> ();
<a name="l12704"></a>12704 }
<a name="l12705"></a>12705 
<a name="l12706"></a>12706 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l12707"></a>12707 base_breakpoint_remove_location (<span class="keyword">struct</span> bp_location *bl)
<a name="l12708"></a>12708 {
<a name="l12709"></a>12709   <a class="code" href="breakpoint_8c.html#aa0e08e0b13f7e12e22ca3039ced9bc36">internal_error_pure_virtual_called</a> ();
<a name="l12710"></a>12710 }
<a name="l12711"></a>12711 
<a name="l12712"></a>12712 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l12713"></a>12713 base_breakpoint_breakpoint_hit (<span class="keyword">const</span> <span class="keyword">struct</span> bp_location *bl,
<a name="l12714"></a>12714                                 <span class="keyword">struct</span> address_space *aspace,
<a name="l12715"></a>12715                                 <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> bp_addr,
<a name="l12716"></a>12716                                 <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structtarget__waitstatus.html">target_waitstatus</a> *ws)
<a name="l12717"></a>12717 {
<a name="l12718"></a>12718   <a class="code" href="breakpoint_8c.html#aa0e08e0b13f7e12e22ca3039ced9bc36">internal_error_pure_virtual_called</a> ();
<a name="l12719"></a>12719 }
<a name="l12720"></a>12720 
<a name="l12721"></a>12721 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l12722"></a>12722 base_breakpoint_check_status (<a class="code" href="structbpstats.html">bpstat</a> bs)
<a name="l12723"></a>12723 {
<a name="l12724"></a>12724   <span class="comment">/* Always stop.   */</span>
<a name="l12725"></a>12725 }
<a name="l12726"></a>12726 
<a name="l12727"></a>12727 <span class="comment">/* A &quot;works_in_software_mode&quot; breakpoint_ops method that just internal</span>
<a name="l12728"></a>12728 <span class="comment">   errors.  */</span>
<a name="l12729"></a>12729 
<a name="l12730"></a>12730 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l12731"></a>12731 base_breakpoint_works_in_software_mode (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b)
<a name="l12732"></a>12732 {
<a name="l12733"></a>12733   <a class="code" href="breakpoint_8c.html#aa0e08e0b13f7e12e22ca3039ced9bc36">internal_error_pure_virtual_called</a> ();
<a name="l12734"></a>12734 }
<a name="l12735"></a>12735 
<a name="l12736"></a>12736 <span class="comment">/* A &quot;resources_needed&quot; breakpoint_ops method that just internal</span>
<a name="l12737"></a>12737 <span class="comment">   errors.  */</span>
<a name="l12738"></a>12738 
<a name="l12739"></a>12739 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l12740"></a>12740 base_breakpoint_resources_needed (<span class="keyword">const</span> <span class="keyword">struct</span> bp_location *bl)
<a name="l12741"></a>12741 {
<a name="l12742"></a>12742   <a class="code" href="breakpoint_8c.html#aa0e08e0b13f7e12e22ca3039ced9bc36">internal_error_pure_virtual_called</a> ();
<a name="l12743"></a>12743 }
<a name="l12744"></a>12744 
<a name="l12745"></a>12745 <span class="keyword">static</span> <span class="keyword">enum</span> <a class="code" href="breakpoint_8h.html#ab6ab1d6a867561653e32a901b41be66b">print_stop_action</a>
<a name="l12746"></a>12746 base_breakpoint_print_it (<a class="code" href="structbpstats.html">bpstat</a> bs)
<a name="l12747"></a>12747 {
<a name="l12748"></a>12748   <a class="code" href="breakpoint_8c.html#aa0e08e0b13f7e12e22ca3039ced9bc36">internal_error_pure_virtual_called</a> ();
<a name="l12749"></a>12749 }
<a name="l12750"></a>12750 
<a name="l12751"></a>12751 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l12752"></a>12752 base_breakpoint_print_one_detail (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *<span class="keyword">self</span>,
<a name="l12753"></a>12753                                   <span class="keyword">struct</span> ui_out *uiout)
<a name="l12754"></a>12754 {
<a name="l12755"></a>12755   <span class="comment">/* nothing */</span>
<a name="l12756"></a>12756 }
<a name="l12757"></a>12757 
<a name="l12758"></a>12758 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l12759"></a>12759 base_breakpoint_print_mention (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b)
<a name="l12760"></a>12760 {
<a name="l12761"></a>12761   <a class="code" href="breakpoint_8c.html#aa0e08e0b13f7e12e22ca3039ced9bc36">internal_error_pure_virtual_called</a> ();
<a name="l12762"></a>12762 }
<a name="l12763"></a>12763 
<a name="l12764"></a>12764 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l12765"></a>12765 base_breakpoint_print_recreate (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b, <span class="keyword">struct</span> ui_file *fp)
<a name="l12766"></a>12766 {
<a name="l12767"></a>12767   <a class="code" href="breakpoint_8c.html#aa0e08e0b13f7e12e22ca3039ced9bc36">internal_error_pure_virtual_called</a> ();
<a name="l12768"></a>12768 }
<a name="l12769"></a>12769 
<a name="l12770"></a>12770 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l12771"></a>12771 base_breakpoint_create_sals_from_address (<span class="keywordtype">char</span> **arg,
<a name="l12772"></a>12772                                           <span class="keyword">struct</span> <a class="code" href="structlinespec__result.html">linespec_result</a> *canonical,
<a name="l12773"></a>12773                                           <span class="keyword">enum</span> bptype type_wanted,
<a name="l12774"></a>12774                                           <span class="keywordtype">char</span> *addr_start,
<a name="l12775"></a>12775                                           <span class="keywordtype">char</span> **copy_arg)
<a name="l12776"></a>12776 {
<a name="l12777"></a>12777   <a class="code" href="breakpoint_8c.html#aa0e08e0b13f7e12e22ca3039ced9bc36">internal_error_pure_virtual_called</a> ();
<a name="l12778"></a>12778 }
<a name="l12779"></a>12779 
<a name="l12780"></a>12780 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l12781"></a>12781 base_breakpoint_create_breakpoints_sal (<span class="keyword">struct</span> gdbarch *gdbarch,
<a name="l12782"></a>12782                                         <span class="keyword">struct</span> <a class="code" href="structlinespec__result.html">linespec_result</a> *c,
<a name="l12783"></a>12783                                         <span class="keywordtype">char</span> *cond_string,
<a name="l12784"></a>12784                                         <span class="keywordtype">char</span> *extra_string,
<a name="l12785"></a>12785                                         <span class="keyword">enum</span> bptype type_wanted,
<a name="l12786"></a>12786                                         <span class="keyword">enum</span> <a class="code" href="breakpoint_8h.html#a15f2bbd9012f59bc09d59feef0c15732">bpdisp</a> disposition,
<a name="l12787"></a>12787                                         <span class="keywordtype">int</span> thread,
<a name="l12788"></a>12788                                         <span class="keywordtype">int</span> task, <span class="keywordtype">int</span> ignore_count,
<a name="l12789"></a>12789                                         <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structbreakpoint__ops.html">breakpoint_ops</a> *o,
<a name="l12790"></a>12790                                         <span class="keywordtype">int</span> from_tty, <span class="keywordtype">int</span> enabled,
<a name="l12791"></a>12791                                         <span class="keywordtype">int</span> <span class="keyword">internal</span>, <span class="keywordtype">unsigned</span> flags)
<a name="l12792"></a>12792 {
<a name="l12793"></a>12793   <a class="code" href="breakpoint_8c.html#aa0e08e0b13f7e12e22ca3039ced9bc36">internal_error_pure_virtual_called</a> ();
<a name="l12794"></a>12794 }
<a name="l12795"></a>12795 
<a name="l12796"></a>12796 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l12797"></a>12797 base_breakpoint_decode_linespec (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b, <span class="keywordtype">char</span> **s,
<a name="l12798"></a>12798                                  <span class="keyword">struct</span> <a class="code" href="structsymtabs__and__lines.html">symtabs_and_lines</a> *sals)
<a name="l12799"></a>12799 {
<a name="l12800"></a>12800   <a class="code" href="breakpoint_8c.html#aa0e08e0b13f7e12e22ca3039ced9bc36">internal_error_pure_virtual_called</a> ();
<a name="l12801"></a>12801 }
<a name="l12802"></a>12802 
<a name="l12803"></a>12803 <span class="comment">/* The default &#39;explains_signal&#39; method.  */</span>
<a name="l12804"></a>12804 
<a name="l12805"></a>12805 <span class="keyword">static</span> <span class="keyword">enum</span> <a class="code" href="breakpoint_8h.html#a5ac39ee414da54677fa916b1d5579d6f">bpstat_signal_value</a>
<a name="l12806"></a>12806 base_breakpoint_explains_signal (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b, <span class="keyword">enum</span> <a class="code" href="signals_8h.html#a1169a44d7b94bdcf747c3f69138dafe7">gdb_signal</a> sig)
<a name="l12807"></a>12807 {
<a name="l12808"></a>12808   <span class="keywordflow">return</span> <a class="code" href="breakpoint_8h.html#a5ac39ee414da54677fa916b1d5579d6fa7c293d7c0de70c6e2549b8fc0e84cbfe">BPSTAT_SIGNAL_HIDE</a>;
<a name="l12809"></a>12809 }
<a name="l12810"></a>12810 
<a name="l12811"></a>12811 <span class="comment">/* The default &quot;after_condition_true&quot; method.  */</span>
<a name="l12812"></a>12812 
<a name="l12813"></a>12813 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l12814"></a>12814 base_breakpoint_after_condition_true (<span class="keyword">struct</span> <a class="code" href="structbpstats.html">bpstats</a> *bs)
<a name="l12815"></a>12815 {
<a name="l12816"></a>12816   <span class="comment">/* Nothing to do.   */</span>
<a name="l12817"></a>12817 }
<a name="l12818"></a>12818 
<a name="l12819"></a>12819 <span class="keyword">struct </span><a class="code" href="structbreakpoint__ops.html">breakpoint_ops</a> <a class="code" href="breakpoint_8c.html#aefe1d12780f2d7ae5fb89ac113e204e0">base_breakpoint_ops</a> =
<a name="l12820"></a>12820 {
<a name="l12821"></a>12821   base_breakpoint_dtor,
<a name="l12822"></a>12822   base_breakpoint_allocate_location,
<a name="l12823"></a>12823   base_breakpoint_re_set,
<a name="l12824"></a>12824   base_breakpoint_insert_location,
<a name="l12825"></a>12825   base_breakpoint_remove_location,
<a name="l12826"></a>12826   base_breakpoint_breakpoint_hit,
<a name="l12827"></a>12827   base_breakpoint_check_status,
<a name="l12828"></a>12828   base_breakpoint_resources_needed,
<a name="l12829"></a>12829   base_breakpoint_works_in_software_mode,
<a name="l12830"></a>12830   base_breakpoint_print_it,
<a name="l12831"></a>12831   NULL,
<a name="l12832"></a>12832   base_breakpoint_print_one_detail,
<a name="l12833"></a>12833   base_breakpoint_print_mention,
<a name="l12834"></a>12834   base_breakpoint_print_recreate,
<a name="l12835"></a>12835   base_breakpoint_create_sals_from_address,
<a name="l12836"></a>12836   base_breakpoint_create_breakpoints_sal,
<a name="l12837"></a>12837   base_breakpoint_decode_linespec,
<a name="l12838"></a>12838   base_breakpoint_explains_signal,
<a name="l12839"></a>12839   base_breakpoint_after_condition_true,
<a name="l12840"></a>12840 };
<a name="l12841"></a>12841 
<a name="l12842"></a>12842 <span class="comment">/* Default breakpoint_ops methods.  */</span>
<a name="l12843"></a>12843 
<a name="l12844"></a>12844 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l12845"></a>12845 bkpt_re_set (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b)
<a name="l12846"></a>12846 {
<a name="l12847"></a>12847   <span class="comment">/* FIXME: is this still reachable?  */</span>
<a name="l12848"></a>12848   <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#a885e704e5cdcfc314069b970c396d1a4">addr_string</a> == NULL)
<a name="l12849"></a>12849     {
<a name="l12850"></a>12850       <span class="comment">/* Anything without a string can&#39;t be re-set.  */</span>
<a name="l12851"></a>12851       <a class="code" href="breakpoint_8c.html#a0701191361b1ed0d40d76661e88de3f4">delete_breakpoint</a> (b);
<a name="l12852"></a>12852       <span class="keywordflow">return</span>;
<a name="l12853"></a>12853     }
<a name="l12854"></a>12854 
<a name="l12855"></a>12855   breakpoint_re_set_default (b);
<a name="l12856"></a>12856 }
<a name="l12857"></a>12857 
<a name="l12858"></a>12858 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l12859"></a>12859 bkpt_insert_location (<span class="keyword">struct</span> bp_location *bl)
<a name="l12860"></a>12860 {
<a name="l12861"></a>12861   <span class="keywordflow">if</span> (bl-&gt;<a class="code" href="structbp__location.html#aefe49818487e5876fc995f7831e2e809">loc_type</a> == <a class="code" href="breakpoint_8h.html#ad7006ab95a9d2493c6ad2c685f45f5dca4a1949653a3b3c36db5cb269a46adb60">bp_loc_hardware_breakpoint</a>)
<a name="l12862"></a>12862     <span class="keywordflow">return</span> <a class="code" href="target_8h.html#aa87a3bd797a738bd9a12df0732781013">target_insert_hw_breakpoint</a> (bl-&gt;<a class="code" href="structbp__location.html#a55f3ff99d536775f5095f11e5f5c3f3e">gdbarch</a>,
<a name="l12863"></a>12863                                         &amp;bl-&gt;<a class="code" href="structbp__location.html#a72be6a63cd025a9a040df0325fa507af">target_info</a>);
<a name="l12864"></a>12864   <span class="keywordflow">else</span>
<a name="l12865"></a>12865     <span class="keywordflow">return</span> <a class="code" href="target_8c.html#a4a288f6e92a74cf83fdae9d6ac05cd80">target_insert_breakpoint</a> (bl-&gt;<a class="code" href="structbp__location.html#a55f3ff99d536775f5095f11e5f5c3f3e">gdbarch</a>,
<a name="l12866"></a>12866                                      &amp;bl-&gt;<a class="code" href="structbp__location.html#a72be6a63cd025a9a040df0325fa507af">target_info</a>);
<a name="l12867"></a>12867 }
<a name="l12868"></a>12868 
<a name="l12869"></a>12869 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l12870"></a>12870 bkpt_remove_location (<span class="keyword">struct</span> bp_location *bl)
<a name="l12871"></a>12871 {
<a name="l12872"></a>12872   <span class="keywordflow">if</span> (bl-&gt;<a class="code" href="structbp__location.html#aefe49818487e5876fc995f7831e2e809">loc_type</a> == <a class="code" href="breakpoint_8h.html#ad7006ab95a9d2493c6ad2c685f45f5dca4a1949653a3b3c36db5cb269a46adb60">bp_loc_hardware_breakpoint</a>)
<a name="l12873"></a>12873     <span class="keywordflow">return</span> <a class="code" href="target_8h.html#a8cb43153c60123ceebd4597888b2d8bf">target_remove_hw_breakpoint</a> (bl-&gt;<a class="code" href="structbp__location.html#a55f3ff99d536775f5095f11e5f5c3f3e">gdbarch</a>, &amp;bl-&gt;<a class="code" href="structbp__location.html#a72be6a63cd025a9a040df0325fa507af">target_info</a>);
<a name="l12874"></a>12874   <span class="keywordflow">else</span>
<a name="l12875"></a>12875     <span class="keywordflow">return</span> <a class="code" href="target_8c.html#a9c2f1e0aacdecef04948e3714a934b70">target_remove_breakpoint</a> (bl-&gt;<a class="code" href="structbp__location.html#a55f3ff99d536775f5095f11e5f5c3f3e">gdbarch</a>, &amp;bl-&gt;<a class="code" href="structbp__location.html#a72be6a63cd025a9a040df0325fa507af">target_info</a>);
<a name="l12876"></a>12876 }
<a name="l12877"></a>12877 
<a name="l12878"></a>12878 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l12879"></a>12879 bkpt_breakpoint_hit (<span class="keyword">const</span> <span class="keyword">struct</span> bp_location *bl,
<a name="l12880"></a>12880                      <span class="keyword">struct</span> address_space *aspace, <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> bp_addr,
<a name="l12881"></a>12881                      <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structtarget__waitstatus.html">target_waitstatus</a> *ws)
<a name="l12882"></a>12882 {
<a name="l12883"></a>12883   <span class="keywordflow">if</span> (ws-&gt;<a class="code" href="structtarget__waitstatus.html#a17ed1783e9146f443fa51ace8da76198">kind</a> != <a class="code" href="waitstatus_8h.html#aa3229b489ec985f04f7e9f652138b7c3a8e1dc525cf3131501a541b4412bcd493">TARGET_WAITKIND_STOPPED</a>
<a name="l12884"></a>12884       || ws-&gt;<a class="code" href="structtarget__waitstatus.html#af33b8f5721dc36f6b5b829286d38f825">value</a>.<a class="code" href="structtarget__waitstatus.html#a7cc711572c26d1f095a87105f4afd1e1">sig</a> != GDB_SIGNAL_TRAP)
<a name="l12885"></a>12885     <span class="keywordflow">return</span> 0;
<a name="l12886"></a>12886 
<a name="l12887"></a>12887   <span class="keywordflow">if</span> (!breakpoint_address_match (bl-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a>-&gt;<a class="code" href="structprogram__space.html#abf2a489f5ed3c1d5cad74d14dbb318e4">aspace</a>, bl-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>,
<a name="l12888"></a>12888                                  aspace, bp_addr))
<a name="l12889"></a>12889     <span class="keywordflow">return</span> 0;
<a name="l12890"></a>12890 
<a name="l12891"></a>12891   <span class="keywordflow">if</span> (<a class="code" href="symfile_8c.html#ad96d01ef61ee2925825b3992d37408f5">overlay_debugging</a>         <span class="comment">/* unmapped overlay section */</span>
<a name="l12892"></a>12892       &amp;&amp; <a class="code" href="symfile_8c.html#ad63f10fe5266cd2e98883d6f4c054c3a">section_is_overlay</a> (bl-&gt;<a class="code" href="structbp__location.html#ac6d8286e46db5c4be6dab9139c43a00d">section</a>)
<a name="l12893"></a>12893       &amp;&amp; !<a class="code" href="symfile_8c.html#a2d6f94d48a782be7460e704fec67adb4">section_is_mapped</a> (bl-&gt;<a class="code" href="structbp__location.html#ac6d8286e46db5c4be6dab9139c43a00d">section</a>))
<a name="l12894"></a>12894     <span class="keywordflow">return</span> 0;
<a name="l12895"></a>12895 
<a name="l12896"></a>12896   <span class="keywordflow">return</span> 1;
<a name="l12897"></a>12897 }
<a name="l12898"></a>12898 
<a name="l12899"></a>12899 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l12900"></a>12900 bkpt_resources_needed (<span class="keyword">const</span> <span class="keyword">struct</span> bp_location *bl)
<a name="l12901"></a>12901 {
<a name="l12902"></a>12902   <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (bl-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa657fad68a9d83a24532fb06715b77628">bp_hardware_breakpoint</a>);
<a name="l12903"></a>12903 
<a name="l12904"></a>12904   <span class="keywordflow">return</span> 1;
<a name="l12905"></a>12905 }
<a name="l12906"></a>12906 
<a name="l12907"></a>12907 <span class="keyword">static</span> <span class="keyword">enum</span> <a class="code" href="breakpoint_8h.html#ab6ab1d6a867561653e32a901b41be66b">print_stop_action</a>
<a name="l12908"></a>12908 bkpt_print_it (<a class="code" href="structbpstats.html">bpstat</a> bs)
<a name="l12909"></a>12909 {
<a name="l12910"></a>12910   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b;
<a name="l12911"></a>12911   <span class="keyword">const</span> <span class="keyword">struct </span>bp_location *bl;
<a name="l12912"></a>12912   <span class="keywordtype">int</span> bp_temp;
<a name="l12913"></a>12913   <span class="keyword">struct </span>ui_out *uiout = <a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>;
<a name="l12914"></a>12914 
<a name="l12915"></a>12915   <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (bs-&gt;<a class="code" href="structbpstats.html#a510428e7ce2e4852e0613b3b5579142b">bp_location_at</a> != NULL);
<a name="l12916"></a>12916 
<a name="l12917"></a>12917   bl = bs-&gt;<a class="code" href="structbpstats.html#a510428e7ce2e4852e0613b3b5579142b">bp_location_at</a>;
<a name="l12918"></a>12918   b = bs-&gt;<a class="code" href="structbpstats.html#ac105ed7263dd10f9d65e92e706b04e39">breakpoint_at</a>;
<a name="l12919"></a>12919 
<a name="l12920"></a>12920   bp_temp = b-&gt;<a class="code" href="structbreakpoint.html#a75f0f9a837eac292ab6e768e8d8f1bd7">disposition</a> == <a class="code" href="breakpoint_8h.html#a15f2bbd9012f59bc09d59feef0c15732a16da7fb4204cb3f58c753fafa80bfab7">disp_del</a>;
<a name="l12921"></a>12921   <span class="keywordflow">if</span> (bl-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a> != bl-&gt;<a class="code" href="structbp__location.html#a4e316d8cab3c014aa85b8858d6223ce2">requested_address</a>)
<a name="l12922"></a>12922     breakpoint_adjustment_warning (bl-&gt;<a class="code" href="structbp__location.html#a4e316d8cab3c014aa85b8858d6223ce2">requested_address</a>,
<a name="l12923"></a>12923                                    bl-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>,
<a name="l12924"></a>12924                                    b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>, 1);
<a name="l12925"></a>12925   <a class="code" href="annotate_8c.html#a0121251245d45abcacd78c0a61ef721a">annotate_breakpoint</a> (b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>);
<a name="l12926"></a>12926   <span class="keywordflow">if</span> (bp_temp)
<a name="l12927"></a>12927     <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;\nTemporary breakpoint &quot;</span>);
<a name="l12928"></a>12928   <span class="keywordflow">else</span>
<a name="l12929"></a>12929     <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;\nBreakpoint &quot;</span>);
<a name="l12930"></a>12930   <span class="keywordflow">if</span> (<a class="code" href="ui-out_8c.html#a473db54efcfbc60feeb5a4f54f27af46">ui_out_is_mi_like_p</a> (uiout))
<a name="l12931"></a>12931     {
<a name="l12932"></a>12932       <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a> (uiout, <span class="stringliteral">&quot;reason&quot;</span>,
<a name="l12933"></a>12933                            <a class="code" href="mi-common_8c.html#a619e7d180d78af6e6d63a611c6680e90">async_reason_lookup</a> (<a class="code" href="mi-common_8h.html#a06d7bf56f98dcc556d686f49ea570daea20df3a258e30b94df1705d51dff3a180">EXEC_ASYNC_BREAKPOINT_HIT</a>));
<a name="l12934"></a>12934       <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a> (uiout, <span class="stringliteral">&quot;disp&quot;</span>, <a class="code" href="breakpoint_8c.html#a6f45019563f41b3ae4dc92df09f12618">bpdisp_text</a> (b-&gt;<a class="code" href="structbreakpoint.html#a75f0f9a837eac292ab6e768e8d8f1bd7">disposition</a>));
<a name="l12935"></a>12935     }
<a name="l12936"></a>12936   <a class="code" href="ui-out_8c.html#aa6f66551d03db456fb94ca1c9038f5a0">ui_out_field_int</a> (uiout, <span class="stringliteral">&quot;bkptno&quot;</span>, b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>);
<a name="l12937"></a>12937   <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;, &quot;</span>);
<a name="l12938"></a>12938 
<a name="l12939"></a>12939   <span class="keywordflow">return</span> <a class="code" href="breakpoint_8h.html#ab6ab1d6a867561653e32a901b41be66ba322bad7b3370a43f44f33ae73a196231">PRINT_SRC_AND_LOC</a>;
<a name="l12940"></a>12940 }
<a name="l12941"></a>12941 
<a name="l12942"></a>12942 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l12943"></a>12943 bkpt_print_mention (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b)
<a name="l12944"></a>12944 {
<a name="l12945"></a>12945   <span class="keywordflow">if</span> (<a class="code" href="ui-out_8c.html#a473db54efcfbc60feeb5a4f54f27af46">ui_out_is_mi_like_p</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>))
<a name="l12946"></a>12946     <span class="keywordflow">return</span>;
<a name="l12947"></a>12947 
<a name="l12948"></a>12948   <span class="keywordflow">switch</span> (b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a>)
<a name="l12949"></a>12949     {
<a name="l12950"></a>12950     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa17768c2bd9137ec6e30c922c5c1d0ffa">bp_breakpoint</a>:
<a name="l12951"></a>12951     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfaa264cea9a07a1fbe63f2047913425831">bp_gnu_ifunc_resolver</a>:
<a name="l12952"></a>12952       <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#a75f0f9a837eac292ab6e768e8d8f1bd7">disposition</a> == <a class="code" href="breakpoint_8h.html#a15f2bbd9012f59bc09d59feef0c15732a16da7fb4204cb3f58c753fafa80bfab7">disp_del</a>)
<a name="l12953"></a>12953         <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Temporary breakpoint&quot;</span>));
<a name="l12954"></a>12954       <span class="keywordflow">else</span>
<a name="l12955"></a>12955         <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Breakpoint&quot;</span>));
<a name="l12956"></a>12956       <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot; %d&quot;</span>), b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>);
<a name="l12957"></a>12957       <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfaa264cea9a07a1fbe63f2047913425831">bp_gnu_ifunc_resolver</a>)
<a name="l12958"></a>12958         <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot; at gnu-indirect-function resolver&quot;</span>));
<a name="l12959"></a>12959       <span class="keywordflow">break</span>;
<a name="l12960"></a>12960     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa657fad68a9d83a24532fb06715b77628">bp_hardware_breakpoint</a>:
<a name="l12961"></a>12961       <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Hardware assisted breakpoint %d&quot;</span>), b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>);
<a name="l12962"></a>12962       <span class="keywordflow">break</span>;
<a name="l12963"></a>12963     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa404b00503edb7eba238aea705ea34231">bp_dprintf</a>:
<a name="l12964"></a>12964       <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Dprintf %d&quot;</span>), b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>);
<a name="l12965"></a>12965       <span class="keywordflow">break</span>;
<a name="l12966"></a>12966     }
<a name="l12967"></a>12967 
<a name="l12968"></a>12968   say_where (b);
<a name="l12969"></a>12969 }
<a name="l12970"></a>12970 
<a name="l12971"></a>12971 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l12972"></a>12972 bkpt_print_recreate (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *tp, <span class="keyword">struct</span> ui_file *fp)
<a name="l12973"></a>12973 {
<a name="l12974"></a>12974   <span class="keywordflow">if</span> (tp-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa17768c2bd9137ec6e30c922c5c1d0ffa">bp_breakpoint</a> &amp;&amp; tp-&gt;<a class="code" href="structbreakpoint.html#a75f0f9a837eac292ab6e768e8d8f1bd7">disposition</a> == <a class="code" href="breakpoint_8h.html#a15f2bbd9012f59bc09d59feef0c15732a16da7fb4204cb3f58c753fafa80bfab7">disp_del</a>)
<a name="l12975"></a>12975     <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (fp, <span class="stringliteral">&quot;tbreak&quot;</span>);
<a name="l12976"></a>12976   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (tp-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa17768c2bd9137ec6e30c922c5c1d0ffa">bp_breakpoint</a>)
<a name="l12977"></a>12977     <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (fp, <span class="stringliteral">&quot;break&quot;</span>);
<a name="l12978"></a>12978   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (tp-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa657fad68a9d83a24532fb06715b77628">bp_hardware_breakpoint</a>
<a name="l12979"></a>12979            &amp;&amp; tp-&gt;<a class="code" href="structbreakpoint.html#a75f0f9a837eac292ab6e768e8d8f1bd7">disposition</a> == <a class="code" href="breakpoint_8h.html#a15f2bbd9012f59bc09d59feef0c15732a16da7fb4204cb3f58c753fafa80bfab7">disp_del</a>)
<a name="l12980"></a>12980     <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (fp, <span class="stringliteral">&quot;thbreak&quot;</span>);
<a name="l12981"></a>12981   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (tp-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa657fad68a9d83a24532fb06715b77628">bp_hardware_breakpoint</a>)
<a name="l12982"></a>12982     <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (fp, <span class="stringliteral">&quot;hbreak&quot;</span>);
<a name="l12983"></a>12983   <span class="keywordflow">else</span>
<a name="l12984"></a>12984     <a class="code" href="common-utils_8h.html#aa14285d9d3d4171016ef9cf09447e8bb">internal_error</a> (__FILE__, __LINE__,
<a name="l12985"></a>12985                     <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;unhandled breakpoint type %d&quot;</span>), (<span class="keywordtype">int</span>) tp-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a>);
<a name="l12986"></a>12986 
<a name="l12987"></a>12987   <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (fp, <span class="stringliteral">&quot; %s&quot;</span>, tp-&gt;<a class="code" href="structbreakpoint.html#a885e704e5cdcfc314069b970c396d1a4">addr_string</a>);
<a name="l12988"></a>12988   <a class="code" href="breakpoint_8c.html#aae7cd38b01782db6011bcd0150059625">print_recreate_thread</a> (tp, fp);
<a name="l12989"></a>12989 }
<a name="l12990"></a>12990 
<a name="l12991"></a>12991 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l12992"></a>12992 bkpt_create_sals_from_address (<span class="keywordtype">char</span> **arg,
<a name="l12993"></a>12993                                <span class="keyword">struct</span> <a class="code" href="structlinespec__result.html">linespec_result</a> *canonical,
<a name="l12994"></a>12994                                <span class="keyword">enum</span> bptype type_wanted,
<a name="l12995"></a>12995                                <span class="keywordtype">char</span> *addr_start, <span class="keywordtype">char</span> **copy_arg)
<a name="l12996"></a>12996 {
<a name="l12997"></a>12997   create_sals_from_address_default (arg, canonical, type_wanted,
<a name="l12998"></a>12998                                     addr_start, copy_arg);
<a name="l12999"></a>12999 }
<a name="l13000"></a>13000 
<a name="l13001"></a>13001 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l13002"></a>13002 bkpt_create_breakpoints_sal (<span class="keyword">struct</span> gdbarch *gdbarch,
<a name="l13003"></a>13003                              <span class="keyword">struct</span> <a class="code" href="structlinespec__result.html">linespec_result</a> *canonical,
<a name="l13004"></a>13004                              <span class="keywordtype">char</span> *cond_string,
<a name="l13005"></a>13005                              <span class="keywordtype">char</span> *extra_string,
<a name="l13006"></a>13006                              <span class="keyword">enum</span> bptype type_wanted,
<a name="l13007"></a>13007                              <span class="keyword">enum</span> <a class="code" href="breakpoint_8h.html#a15f2bbd9012f59bc09d59feef0c15732">bpdisp</a> disposition,
<a name="l13008"></a>13008                              <span class="keywordtype">int</span> thread,
<a name="l13009"></a>13009                              <span class="keywordtype">int</span> task, <span class="keywordtype">int</span> ignore_count,
<a name="l13010"></a>13010                              <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structbreakpoint__ops.html">breakpoint_ops</a> *ops,
<a name="l13011"></a>13011                              <span class="keywordtype">int</span> from_tty, <span class="keywordtype">int</span> enabled,
<a name="l13012"></a>13012                              <span class="keywordtype">int</span> <span class="keyword">internal</span>, <span class="keywordtype">unsigned</span> flags)
<a name="l13013"></a>13013 {
<a name="l13014"></a>13014   create_breakpoints_sal_default (gdbarch, canonical,
<a name="l13015"></a>13015                                   cond_string, extra_string,
<a name="l13016"></a>13016                                   type_wanted,
<a name="l13017"></a>13017                                   disposition, thread, task,
<a name="l13018"></a>13018                                   ignore_count, ops, from_tty,
<a name="l13019"></a>13019                                   enabled, <span class="keyword">internal</span>, flags);
<a name="l13020"></a>13020 }
<a name="l13021"></a>13021 
<a name="l13022"></a>13022 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l13023"></a>13023 bkpt_decode_linespec (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b, <span class="keywordtype">char</span> **s,
<a name="l13024"></a>13024                       <span class="keyword">struct</span> <a class="code" href="structsymtabs__and__lines.html">symtabs_and_lines</a> *sals)
<a name="l13025"></a>13025 {
<a name="l13026"></a>13026   decode_linespec_default (b, s, sals);
<a name="l13027"></a>13027 }
<a name="l13028"></a>13028 
<a name="l13029"></a>13029 <span class="comment">/* Virtual table for internal breakpoints.  */</span>
<a name="l13030"></a>13030 
<a name="l13031"></a>13031 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l13032"></a>13032 internal_bkpt_re_set (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b)
<a name="l13033"></a>13033 {
<a name="l13034"></a>13034   <span class="keywordflow">switch</span> (b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a>)
<a name="l13035"></a>13035     {
<a name="l13036"></a>13036       <span class="comment">/* Delete overlay event and longjmp master breakpoints; they</span>
<a name="l13037"></a>13037 <span class="comment">         will be reset later by breakpoint_re_set.  */</span>
<a name="l13038"></a>13038     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa5bd9bbdb42933350595475584c48d844">bp_overlay_event</a>:
<a name="l13039"></a>13039     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfad159b4f5b0a64a88067c3d310ebed7ce">bp_longjmp_master</a>:
<a name="l13040"></a>13040     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa0d6052d15a11c79e0c6703aeef4148ba">bp_std_terminate_master</a>:
<a name="l13041"></a>13041     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa6d04f06608676691bf5f211117427b48">bp_exception_master</a>:
<a name="l13042"></a>13042       <a class="code" href="breakpoint_8c.html#a0701191361b1ed0d40d76661e88de3f4">delete_breakpoint</a> (b);
<a name="l13043"></a>13043       <span class="keywordflow">break</span>;
<a name="l13044"></a>13044 
<a name="l13045"></a>13045       <span class="comment">/* This breakpoint is special, it&#39;s set up when the inferior</span>
<a name="l13046"></a>13046 <span class="comment">         starts and we really don&#39;t want to touch it.  */</span>
<a name="l13047"></a>13047     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa7ff3ee755a0635e1c8aa45bbeba6734a">bp_shlib_event</a>:
<a name="l13048"></a>13048 
<a name="l13049"></a>13049       <span class="comment">/* Like bp_shlib_event, this breakpoint type is special.  Once</span>
<a name="l13050"></a>13050 <span class="comment">         it is set up, we do not want to touch it.  */</span>
<a name="l13051"></a>13051     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa363ddd674339fdbb98fc4b0525905172">bp_thread_event</a>:
<a name="l13052"></a>13052       <span class="keywordflow">break</span>;
<a name="l13053"></a>13053     }
<a name="l13054"></a>13054 }
<a name="l13055"></a>13055 
<a name="l13056"></a>13056 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l13057"></a>13057 internal_bkpt_check_status (<a class="code" href="structbpstats.html">bpstat</a> bs)
<a name="l13058"></a>13058 {
<a name="l13059"></a>13059   <span class="keywordflow">if</span> (bs-&gt;<a class="code" href="structbpstats.html#ac105ed7263dd10f9d65e92e706b04e39">breakpoint_at</a>-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa7ff3ee755a0635e1c8aa45bbeba6734a">bp_shlib_event</a>)
<a name="l13060"></a>13060     {
<a name="l13061"></a>13061       <span class="comment">/* If requested, stop when the dynamic linker notifies GDB of</span>
<a name="l13062"></a>13062 <span class="comment">         events.  This allows the user to get control and place</span>
<a name="l13063"></a>13063 <span class="comment">         breakpoints in initializer routines for dynamically loaded</span>
<a name="l13064"></a>13064 <span class="comment">         objects (among other things).  */</span>
<a name="l13065"></a>13065       bs-&gt;<a class="code" href="structbpstats.html#acff86901962f7bc070661b85248c4652">stop</a> = <a class="code" href="inferior_8h.html#ac7bc726360351e9a1322fd22fbf24504">stop_on_solib_events</a>;
<a name="l13066"></a>13066       bs-&gt;<a class="code" href="structbpstats.html#a2248119ffe4efcc99d08f4ffb562b54b">print</a> = <a class="code" href="inferior_8h.html#ac7bc726360351e9a1322fd22fbf24504">stop_on_solib_events</a>;
<a name="l13067"></a>13067     }
<a name="l13068"></a>13068   <span class="keywordflow">else</span>
<a name="l13069"></a>13069     bs-&gt;<a class="code" href="structbpstats.html#acff86901962f7bc070661b85248c4652">stop</a> = 0;
<a name="l13070"></a>13070 }
<a name="l13071"></a>13071 
<a name="l13072"></a>13072 <span class="keyword">static</span> <span class="keyword">enum</span> <a class="code" href="breakpoint_8h.html#ab6ab1d6a867561653e32a901b41be66b">print_stop_action</a>
<a name="l13073"></a>13073 internal_bkpt_print_it (<a class="code" href="structbpstats.html">bpstat</a> bs)
<a name="l13074"></a>13074 {
<a name="l13075"></a>13075   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b;
<a name="l13076"></a>13076 
<a name="l13077"></a>13077   b = bs-&gt;<a class="code" href="structbpstats.html#ac105ed7263dd10f9d65e92e706b04e39">breakpoint_at</a>;
<a name="l13078"></a>13078 
<a name="l13079"></a>13079   <span class="keywordflow">switch</span> (b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a>)
<a name="l13080"></a>13080     {
<a name="l13081"></a>13081     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa7ff3ee755a0635e1c8aa45bbeba6734a">bp_shlib_event</a>:
<a name="l13082"></a>13082       <span class="comment">/* Did we stop because the user set the stop_on_solib_events</span>
<a name="l13083"></a>13083 <span class="comment">         variable?  (If so, we report this as a generic, &quot;Stopped due</span>
<a name="l13084"></a>13084 <span class="comment">         to shlib event&quot; message.) */</span>
<a name="l13085"></a>13085       print_solib_event (0);
<a name="l13086"></a>13086       <span class="keywordflow">break</span>;
<a name="l13087"></a>13087 
<a name="l13088"></a>13088     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa363ddd674339fdbb98fc4b0525905172">bp_thread_event</a>:
<a name="l13089"></a>13089       <span class="comment">/* Not sure how we will get here.</span>
<a name="l13090"></a>13090 <span class="comment">         GDB should not stop for these breakpoints.  */</span>
<a name="l13091"></a>13091       <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Thread Event Breakpoint: gdb should not stop!\n&quot;</span>));
<a name="l13092"></a>13092       <span class="keywordflow">break</span>;
<a name="l13093"></a>13093 
<a name="l13094"></a>13094     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa5bd9bbdb42933350595475584c48d844">bp_overlay_event</a>:
<a name="l13095"></a>13095       <span class="comment">/* By analogy with the thread event, GDB should not stop for these.  */</span>
<a name="l13096"></a>13096       <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Overlay Event Breakpoint: gdb should not stop!\n&quot;</span>));
<a name="l13097"></a>13097       <span class="keywordflow">break</span>;
<a name="l13098"></a>13098 
<a name="l13099"></a>13099     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfad159b4f5b0a64a88067c3d310ebed7ce">bp_longjmp_master</a>:
<a name="l13100"></a>13100       <span class="comment">/* These should never be enabled.  */</span>
<a name="l13101"></a>13101       <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Longjmp Master Breakpoint: gdb should not stop!\n&quot;</span>));
<a name="l13102"></a>13102       <span class="keywordflow">break</span>;
<a name="l13103"></a>13103 
<a name="l13104"></a>13104     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa0d6052d15a11c79e0c6703aeef4148ba">bp_std_terminate_master</a>:
<a name="l13105"></a>13105       <span class="comment">/* These should never be enabled.  */</span>
<a name="l13106"></a>13106       <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;std::terminate Master Breakpoint: &quot;</span>
<a name="l13107"></a>13107                          <span class="stringliteral">&quot;gdb should not stop!\n&quot;</span>));
<a name="l13108"></a>13108       <span class="keywordflow">break</span>;
<a name="l13109"></a>13109 
<a name="l13110"></a>13110     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa6d04f06608676691bf5f211117427b48">bp_exception_master</a>:
<a name="l13111"></a>13111       <span class="comment">/* These should never be enabled.  */</span>
<a name="l13112"></a>13112       <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Exception Master Breakpoint: &quot;</span>
<a name="l13113"></a>13113                          <span class="stringliteral">&quot;gdb should not stop!\n&quot;</span>));
<a name="l13114"></a>13114       <span class="keywordflow">break</span>;
<a name="l13115"></a>13115     }
<a name="l13116"></a>13116 
<a name="l13117"></a>13117   <span class="keywordflow">return</span> <a class="code" href="breakpoint_8h.html#ab6ab1d6a867561653e32a901b41be66ba7a9d478397b9193cdbdce184d31446d4">PRINT_NOTHING</a>;
<a name="l13118"></a>13118 }
<a name="l13119"></a>13119 
<a name="l13120"></a>13120 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l13121"></a>13121 internal_bkpt_print_mention (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b)
<a name="l13122"></a>13122 {
<a name="l13123"></a>13123   <span class="comment">/* Nothing to mention.  These breakpoints are internal.  */</span>
<a name="l13124"></a>13124 }
<a name="l13125"></a>13125 
<a name="l13126"></a>13126 <span class="comment">/* Virtual table for momentary breakpoints  */</span>
<a name="l13127"></a>13127 
<a name="l13128"></a>13128 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l13129"></a>13129 momentary_bkpt_re_set (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b)
<a name="l13130"></a>13130 {
<a name="l13131"></a>13131   <span class="comment">/* Keep temporary breakpoints, which can be encountered when we step</span>
<a name="l13132"></a>13132 <span class="comment">     over a dlopen call and solib_add is resetting the breakpoints.</span>
<a name="l13133"></a>13133 <span class="comment">     Otherwise these should have been blown away via the cleanup chain</span>
<a name="l13134"></a>13134 <span class="comment">     or by breakpoint_init_inferior when we rerun the executable.  */</span>
<a name="l13135"></a>13135 }
<a name="l13136"></a>13136 
<a name="l13137"></a>13137 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l13138"></a>13138 momentary_bkpt_check_status (<a class="code" href="structbpstats.html">bpstat</a> bs)
<a name="l13139"></a>13139 {
<a name="l13140"></a>13140   <span class="comment">/* Nothing.  The point of these breakpoints is causing a stop.  */</span>
<a name="l13141"></a>13141 }
<a name="l13142"></a>13142 
<a name="l13143"></a>13143 <span class="keyword">static</span> <span class="keyword">enum</span> <a class="code" href="breakpoint_8h.html#ab6ab1d6a867561653e32a901b41be66b">print_stop_action</a>
<a name="l13144"></a>13144 momentary_bkpt_print_it (<a class="code" href="structbpstats.html">bpstat</a> bs)
<a name="l13145"></a>13145 {
<a name="l13146"></a>13146   <span class="keyword">struct </span>ui_out *uiout = <a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>;
<a name="l13147"></a>13147 
<a name="l13148"></a>13148   <span class="keywordflow">if</span> (<a class="code" href="ui-out_8c.html#a473db54efcfbc60feeb5a4f54f27af46">ui_out_is_mi_like_p</a> (uiout))
<a name="l13149"></a>13149     {
<a name="l13150"></a>13150       <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b = bs-&gt;<a class="code" href="structbpstats.html#ac105ed7263dd10f9d65e92e706b04e39">breakpoint_at</a>;
<a name="l13151"></a>13151 
<a name="l13152"></a>13152       <span class="keywordflow">switch</span> (b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a>)
<a name="l13153"></a>13153         {
<a name="l13154"></a>13154         <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa86f9369de92fbd10422ccc3d4ea68a20">bp_finish</a>:
<a name="l13155"></a>13155           <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a>
<a name="l13156"></a>13156             (uiout, <span class="stringliteral">&quot;reason&quot;</span>,
<a name="l13157"></a>13157              <a class="code" href="mi-common_8c.html#a619e7d180d78af6e6d63a611c6680e90">async_reason_lookup</a> (<a class="code" href="mi-common_8h.html#a06d7bf56f98dcc556d686f49ea570daea11c591c349105386ffa7910272b7d645">EXEC_ASYNC_FUNCTION_FINISHED</a>));
<a name="l13158"></a>13158           <span class="keywordflow">break</span>;
<a name="l13159"></a>13159 
<a name="l13160"></a>13160         <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa8e5fb22bf54672648756e2431a7827b6">bp_until</a>:
<a name="l13161"></a>13161           <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a>
<a name="l13162"></a>13162             (uiout, <span class="stringliteral">&quot;reason&quot;</span>,
<a name="l13163"></a>13163              <a class="code" href="mi-common_8c.html#a619e7d180d78af6e6d63a611c6680e90">async_reason_lookup</a> (<a class="code" href="mi-common_8h.html#a06d7bf56f98dcc556d686f49ea570daea0c154c4f159141d7f368bd5ff26c6ea2">EXEC_ASYNC_LOCATION_REACHED</a>));
<a name="l13164"></a>13164           <span class="keywordflow">break</span>;
<a name="l13165"></a>13165         }
<a name="l13166"></a>13166     }
<a name="l13167"></a>13167 
<a name="l13168"></a>13168   <span class="keywordflow">return</span> <a class="code" href="breakpoint_8h.html#ab6ab1d6a867561653e32a901b41be66ba84f0c3d5c073b6e26479e7b2ae2c7df0">PRINT_UNKNOWN</a>;
<a name="l13169"></a>13169 }
<a name="l13170"></a>13170 
<a name="l13171"></a>13171 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l13172"></a>13172 momentary_bkpt_print_mention (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b)
<a name="l13173"></a>13173 {
<a name="l13174"></a>13174   <span class="comment">/* Nothing to mention.  These breakpoints are internal.  */</span>
<a name="l13175"></a>13175 }
<a name="l13176"></a>13176 
<a name="l13177"></a>13177 <span class="comment">/* Ensure INITIATING_FRAME is cleared when no such breakpoint exists.</span>
<a name="l13178"></a>13178 <span class="comment"></span>
<a name="l13179"></a>13179 <span class="comment">   It gets cleared already on the removal of the first one of such placed</span>
<a name="l13180"></a>13180 <span class="comment">   breakpoints.  This is OK as they get all removed altogether.  */</span>
<a name="l13181"></a>13181 
<a name="l13182"></a>13182 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l13183"></a>13183 longjmp_bkpt_dtor (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *<span class="keyword">self</span>)
<a name="l13184"></a>13184 {
<a name="l13185"></a>13185   <span class="keyword">struct </span><a class="code" href="structthread__info.html">thread_info</a> *tp = <a class="code" href="gdbthread_8h.html#aa42b391e60deba0c8c4c2ef4496334f0">find_thread_id</a> (self-&gt;thread);
<a name="l13186"></a>13186 
<a name="l13187"></a>13187   <span class="keywordflow">if</span> (tp)
<a name="l13188"></a>13188     tp-&gt;<a class="code" href="structthread__info.html#a97f89589e47e0e6459e9ff0f92c3e2df">initiating_frame</a> = <a class="code" href="frame_8c.html#a0e92fecdd3b01549ccdc07795de2afee">null_frame_id</a>;
<a name="l13189"></a>13189 
<a name="l13190"></a>13190   momentary_breakpoint_ops.<a class="code" href="structbreakpoint__ops.html#a110b2df7b285e5f83bf40b9a0e5435c1">dtor</a> (<span class="keyword">self</span>);
<a name="l13191"></a>13191 }
<a name="l13192"></a>13192 
<a name="l13193"></a>13193 <span class="comment">/* Specific methods for probe breakpoints.  */</span>
<a name="l13194"></a>13194 
<a name="l13195"></a>13195 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l13196"></a>13196 bkpt_probe_insert_location (<span class="keyword">struct</span> bp_location *bl)
<a name="l13197"></a>13197 {
<a name="l13198"></a>13198   <span class="keywordtype">int</span> v = bkpt_insert_location (bl);
<a name="l13199"></a>13199 
<a name="l13200"></a>13200   <span class="keywordflow">if</span> (v == 0)
<a name="l13201"></a>13201     {
<a name="l13202"></a>13202       <span class="comment">/* The insertion was successful, now let&#39;s set the probe&#39;s semaphore</span>
<a name="l13203"></a>13203 <span class="comment">         if needed.  */</span>
<a name="l13204"></a>13204       bl-&gt;<a class="code" href="structbp__location.html#a848151cbedd05ac5a77d211aea60a013">probe</a>-&gt;<a class="code" href="structprobe.html#a3dccc3dce7fb807c3638af97192bbb1c">pops</a>-&gt;<a class="code" href="structprobe__ops.html#ae0abc1f99919ca0a5874232e16998d41">set_semaphore</a> (bl-&gt;<a class="code" href="structbp__location.html#a848151cbedd05ac5a77d211aea60a013">probe</a>, bl-&gt;<a class="code" href="structbp__location.html#a55f3ff99d536775f5095f11e5f5c3f3e">gdbarch</a>);
<a name="l13205"></a>13205     }
<a name="l13206"></a>13206 
<a name="l13207"></a>13207   <span class="keywordflow">return</span> v;
<a name="l13208"></a>13208 }
<a name="l13209"></a>13209 
<a name="l13210"></a>13210 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l13211"></a>13211 bkpt_probe_remove_location (<span class="keyword">struct</span> bp_location *bl)
<a name="l13212"></a>13212 {
<a name="l13213"></a>13213   <span class="comment">/* Let&#39;s clear the semaphore before removing the location.  */</span>
<a name="l13214"></a>13214   bl-&gt;<a class="code" href="structbp__location.html#a848151cbedd05ac5a77d211aea60a013">probe</a>-&gt;<a class="code" href="structprobe.html#a3dccc3dce7fb807c3638af97192bbb1c">pops</a>-&gt;<a class="code" href="structprobe__ops.html#a73b95a91aebe6d1a4379a0e995bb1c66">clear_semaphore</a> (bl-&gt;<a class="code" href="structbp__location.html#a848151cbedd05ac5a77d211aea60a013">probe</a>, bl-&gt;<a class="code" href="structbp__location.html#a55f3ff99d536775f5095f11e5f5c3f3e">gdbarch</a>);
<a name="l13215"></a>13215 
<a name="l13216"></a>13216   <span class="keywordflow">return</span> bkpt_remove_location (bl);
<a name="l13217"></a>13217 }
<a name="l13218"></a>13218 
<a name="l13219"></a>13219 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l13220"></a>13220 bkpt_probe_create_sals_from_address (<span class="keywordtype">char</span> **arg,
<a name="l13221"></a>13221                                      <span class="keyword">struct</span> <a class="code" href="structlinespec__result.html">linespec_result</a> *canonical,
<a name="l13222"></a>13222                                      <span class="keyword">enum</span> bptype type_wanted,
<a name="l13223"></a>13223                                      <span class="keywordtype">char</span> *addr_start, <span class="keywordtype">char</span> **copy_arg)
<a name="l13224"></a>13224 {
<a name="l13225"></a>13225   <span class="keyword">struct </span><a class="code" href="structlinespec__sals.html">linespec_sals</a> lsal;
<a name="l13226"></a>13226 
<a name="l13227"></a>13227   lsal.<a class="code" href="structlinespec__sals.html#a34ac2e438b2835722c998f409c85dcee">sals</a> = <a class="code" href="probe_8c.html#a824026d9508d93118179fd42a4d65b12">parse_probes</a> (arg, canonical);
<a name="l13228"></a>13228 
<a name="l13229"></a>13229   *copy_arg = xstrdup (canonical-&gt;<a class="code" href="structlinespec__result.html#abfccf5d367c072077ac366af4d3f23f9">addr_string</a>);
<a name="l13230"></a>13230   lsal.<a class="code" href="structlinespec__sals.html#a5a6b2c7bb2c9b91d8077fb7186a6c466">canonical</a> = xstrdup (*copy_arg);
<a name="l13231"></a>13231 
<a name="l13232"></a>13232   <a class="code" href="vec_8h.html#a8d090c0524726d00931070e0c438ba3f">VEC_safe_push</a> (<a class="code" href="structlinespec__sals.html">linespec_sals</a>, canonical-&gt;sals, &amp;lsal);
<a name="l13233"></a>13233 }
<a name="l13234"></a>13234 
<a name="l13235"></a>13235 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l13236"></a>13236 bkpt_probe_decode_linespec (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b, <span class="keywordtype">char</span> **s,
<a name="l13237"></a>13237                             <span class="keyword">struct</span> <a class="code" href="structsymtabs__and__lines.html">symtabs_and_lines</a> *sals)
<a name="l13238"></a>13238 {
<a name="l13239"></a>13239   *sals = <a class="code" href="probe_8c.html#a824026d9508d93118179fd42a4d65b12">parse_probes</a> (s, NULL);
<a name="l13240"></a>13240   <span class="keywordflow">if</span> (!sals-&gt;<a class="code" href="structsymtabs__and__lines.html#ab601f48fdf29c3b190ba068f57983df4">sals</a>)
<a name="l13241"></a>13241     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;probe not found&quot;</span>));
<a name="l13242"></a>13242 }
<a name="l13243"></a>13243 
<a name="l13244"></a>13244 <span class="comment">/* The breakpoint_ops structure to be used in tracepoints.  */</span>
<a name="l13245"></a>13245 
<a name="l13246"></a>13246 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l13247"></a>13247 tracepoint_re_set (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b)
<a name="l13248"></a>13248 {
<a name="l13249"></a>13249   breakpoint_re_set_default (b);
<a name="l13250"></a>13250 }
<a name="l13251"></a>13251 
<a name="l13252"></a>13252 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l13253"></a>13253 tracepoint_breakpoint_hit (<span class="keyword">const</span> <span class="keyword">struct</span> bp_location *bl,
<a name="l13254"></a>13254                            <span class="keyword">struct</span> address_space *aspace, <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> bp_addr,
<a name="l13255"></a>13255                            <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structtarget__waitstatus.html">target_waitstatus</a> *ws)
<a name="l13256"></a>13256 {
<a name="l13257"></a>13257   <span class="comment">/* By definition, the inferior does not report stops at</span>
<a name="l13258"></a>13258 <span class="comment">     tracepoints.  */</span>
<a name="l13259"></a>13259   <span class="keywordflow">return</span> 0;
<a name="l13260"></a>13260 }
<a name="l13261"></a>13261 
<a name="l13262"></a>13262 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l13263"></a>13263 tracepoint_print_one_detail (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *<span class="keyword">self</span>,
<a name="l13264"></a>13264                              <span class="keyword">struct</span> ui_out *uiout)
<a name="l13265"></a>13265 {
<a name="l13266"></a>13266   <span class="keyword">struct </span><a class="code" href="structtracepoint.html">tracepoint</a> *tp = (<span class="keyword">struct </span><a class="code" href="structtracepoint.html">tracepoint</a> *) <span class="keyword">self</span>;
<a name="l13267"></a>13267   <span class="keywordflow">if</span> (tp-&gt;<a class="code" href="structtracepoint.html#adeab8a95f18310c90340e7468151db92">static_trace_marker_id</a>)
<a name="l13268"></a>13268     {
<a name="l13269"></a>13269       <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (self-&gt;type == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfae4357544e8e764b68ef3729aa9ac2be3">bp_static_tracepoint</a>);
<a name="l13270"></a>13270 
<a name="l13271"></a>13271       <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;\tmarker id is &quot;</span>);
<a name="l13272"></a>13272       <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a> (uiout, <span class="stringliteral">&quot;static-tracepoint-marker-string-id&quot;</span>,
<a name="l13273"></a>13273                            tp-&gt;<a class="code" href="structtracepoint.html#adeab8a95f18310c90340e7468151db92">static_trace_marker_id</a>);
<a name="l13274"></a>13274       <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;\n&quot;</span>);
<a name="l13275"></a>13275     }
<a name="l13276"></a>13276 }
<a name="l13277"></a>13277 
<a name="l13278"></a>13278 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l13279"></a>13279 tracepoint_print_mention (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b)
<a name="l13280"></a>13280 {
<a name="l13281"></a>13281   <span class="keywordflow">if</span> (<a class="code" href="ui-out_8c.html#a473db54efcfbc60feeb5a4f54f27af46">ui_out_is_mi_like_p</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>))
<a name="l13282"></a>13282     <span class="keywordflow">return</span>;
<a name="l13283"></a>13283 
<a name="l13284"></a>13284   <span class="keywordflow">switch</span> (b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a>)
<a name="l13285"></a>13285     {
<a name="l13286"></a>13286     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfae87f3c5422e7ecec815f5cb7254b4b4c">bp_tracepoint</a>:
<a name="l13287"></a>13287       <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Tracepoint&quot;</span>));
<a name="l13288"></a>13288       <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot; %d&quot;</span>), b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>);
<a name="l13289"></a>13289       <span class="keywordflow">break</span>;
<a name="l13290"></a>13290     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa563d27bd02a1303a86081828b40002db">bp_fast_tracepoint</a>:
<a name="l13291"></a>13291       <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Fast tracepoint&quot;</span>));
<a name="l13292"></a>13292       <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot; %d&quot;</span>), b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>);
<a name="l13293"></a>13293       <span class="keywordflow">break</span>;
<a name="l13294"></a>13294     <span class="keywordflow">case</span> <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfae4357544e8e764b68ef3729aa9ac2be3">bp_static_tracepoint</a>:
<a name="l13295"></a>13295       <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Static tracepoint&quot;</span>));
<a name="l13296"></a>13296       <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot; %d&quot;</span>), b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>);
<a name="l13297"></a>13297       <span class="keywordflow">break</span>;
<a name="l13298"></a>13298     <span class="keywordflow">default</span>:
<a name="l13299"></a>13299       <a class="code" href="common-utils_8h.html#aa14285d9d3d4171016ef9cf09447e8bb">internal_error</a> (__FILE__, __LINE__,
<a name="l13300"></a>13300                       <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;unhandled tracepoint type %d&quot;</span>), (<span class="keywordtype">int</span>) b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a>);
<a name="l13301"></a>13301     }
<a name="l13302"></a>13302 
<a name="l13303"></a>13303   say_where (b);
<a name="l13304"></a>13304 }
<a name="l13305"></a>13305 
<a name="l13306"></a>13306 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l13307"></a>13307 tracepoint_print_recreate (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *<span class="keyword">self</span>, <span class="keyword">struct</span> ui_file *fp)
<a name="l13308"></a>13308 {
<a name="l13309"></a>13309   <span class="keyword">struct </span><a class="code" href="structtracepoint.html">tracepoint</a> *tp = (<span class="keyword">struct </span><a class="code" href="structtracepoint.html">tracepoint</a> *) <span class="keyword">self</span>;
<a name="l13310"></a>13310 
<a name="l13311"></a>13311   <span class="keywordflow">if</span> (self-&gt;type == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa563d27bd02a1303a86081828b40002db">bp_fast_tracepoint</a>)
<a name="l13312"></a>13312     <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (fp, <span class="stringliteral">&quot;ftrace&quot;</span>);
<a name="l13313"></a>13313   <span class="keywordflow">if</span> (self-&gt;type == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfae4357544e8e764b68ef3729aa9ac2be3">bp_static_tracepoint</a>)
<a name="l13314"></a>13314     <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (fp, <span class="stringliteral">&quot;strace&quot;</span>);
<a name="l13315"></a>13315   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (self-&gt;type == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfae87f3c5422e7ecec815f5cb7254b4b4c">bp_tracepoint</a>)
<a name="l13316"></a>13316     <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (fp, <span class="stringliteral">&quot;trace&quot;</span>);
<a name="l13317"></a>13317   <span class="keywordflow">else</span>
<a name="l13318"></a>13318     <a class="code" href="common-utils_8h.html#aa14285d9d3d4171016ef9cf09447e8bb">internal_error</a> (__FILE__, __LINE__,
<a name="l13319"></a>13319                     <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;unhandled tracepoint type %d&quot;</span>), (<span class="keywordtype">int</span>) self-&gt;type);
<a name="l13320"></a>13320 
<a name="l13321"></a>13321   <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (fp, <span class="stringliteral">&quot; %s&quot;</span>, self-&gt;addr_string);
<a name="l13322"></a>13322   <a class="code" href="breakpoint_8c.html#aae7cd38b01782db6011bcd0150059625">print_recreate_thread</a> (<span class="keyword">self</span>, fp);
<a name="l13323"></a>13323 
<a name="l13324"></a>13324   <span class="keywordflow">if</span> (tp-&gt;<a class="code" href="structtracepoint.html#adaea7cf613860650f86cd9e0ac9cd5f1">pass_count</a>)
<a name="l13325"></a>13325     <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (fp, <span class="stringliteral">&quot;  passcount %d\n&quot;</span>, tp-&gt;<a class="code" href="structtracepoint.html#adaea7cf613860650f86cd9e0ac9cd5f1">pass_count</a>);
<a name="l13326"></a>13326 }
<a name="l13327"></a>13327 
<a name="l13328"></a>13328 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l13329"></a>13329 tracepoint_create_sals_from_address (<span class="keywordtype">char</span> **arg,
<a name="l13330"></a>13330                                      <span class="keyword">struct</span> <a class="code" href="structlinespec__result.html">linespec_result</a> *canonical,
<a name="l13331"></a>13331                                      <span class="keyword">enum</span> bptype type_wanted,
<a name="l13332"></a>13332                                      <span class="keywordtype">char</span> *addr_start, <span class="keywordtype">char</span> **copy_arg)
<a name="l13333"></a>13333 {
<a name="l13334"></a>13334   create_sals_from_address_default (arg, canonical, type_wanted,
<a name="l13335"></a>13335                                     addr_start, copy_arg);
<a name="l13336"></a>13336 }
<a name="l13337"></a>13337 
<a name="l13338"></a>13338 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l13339"></a>13339 tracepoint_create_breakpoints_sal (<span class="keyword">struct</span> gdbarch *gdbarch,
<a name="l13340"></a>13340                                    <span class="keyword">struct</span> <a class="code" href="structlinespec__result.html">linespec_result</a> *canonical,
<a name="l13341"></a>13341                                    <span class="keywordtype">char</span> *cond_string,
<a name="l13342"></a>13342                                    <span class="keywordtype">char</span> *extra_string,
<a name="l13343"></a>13343                                    <span class="keyword">enum</span> bptype type_wanted,
<a name="l13344"></a>13344                                    <span class="keyword">enum</span> <a class="code" href="breakpoint_8h.html#a15f2bbd9012f59bc09d59feef0c15732">bpdisp</a> disposition,
<a name="l13345"></a>13345                                    <span class="keywordtype">int</span> thread,
<a name="l13346"></a>13346                                    <span class="keywordtype">int</span> task, <span class="keywordtype">int</span> ignore_count,
<a name="l13347"></a>13347                                    <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structbreakpoint__ops.html">breakpoint_ops</a> *ops,
<a name="l13348"></a>13348                                    <span class="keywordtype">int</span> from_tty, <span class="keywordtype">int</span> enabled,
<a name="l13349"></a>13349                                    <span class="keywordtype">int</span> <span class="keyword">internal</span>, <span class="keywordtype">unsigned</span> flags)
<a name="l13350"></a>13350 {
<a name="l13351"></a>13351   create_breakpoints_sal_default (gdbarch, canonical,
<a name="l13352"></a>13352                                   cond_string, extra_string,
<a name="l13353"></a>13353                                   type_wanted,
<a name="l13354"></a>13354                                   disposition, thread, task,
<a name="l13355"></a>13355                                   ignore_count, ops, from_tty,
<a name="l13356"></a>13356                                   enabled, <span class="keyword">internal</span>, flags);
<a name="l13357"></a>13357 }
<a name="l13358"></a>13358 
<a name="l13359"></a>13359 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l13360"></a>13360 tracepoint_decode_linespec (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b, <span class="keywordtype">char</span> **s,
<a name="l13361"></a>13361                             <span class="keyword">struct</span> <a class="code" href="structsymtabs__and__lines.html">symtabs_and_lines</a> *sals)
<a name="l13362"></a>13362 {
<a name="l13363"></a>13363   decode_linespec_default (b, s, sals);
<a name="l13364"></a>13364 }
<a name="l13365"></a>13365 
<a name="l13366"></a><a class="code" href="breakpoint_8h.html#ab588518ae329b0c2371895fa0efd772f">13366</a> <span class="keyword">struct </span><a class="code" href="structbreakpoint__ops.html">breakpoint_ops</a> <a class="code" href="breakpoint_8c.html#ab588518ae329b0c2371895fa0efd772f">tracepoint_breakpoint_ops</a>;
<a name="l13367"></a>13367 
<a name="l13368"></a>13368 <span class="comment">/* The breakpoint_ops structure to be use on tracepoints placed in a</span>
<a name="l13369"></a>13369 <span class="comment">   static probe.  */</span>
<a name="l13370"></a>13370 
<a name="l13371"></a>13371 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l13372"></a>13372 tracepoint_probe_create_sals_from_address (<span class="keywordtype">char</span> **arg,
<a name="l13373"></a>13373                                            <span class="keyword">struct</span> <a class="code" href="structlinespec__result.html">linespec_result</a> *canonical,
<a name="l13374"></a>13374                                            <span class="keyword">enum</span> bptype type_wanted,
<a name="l13375"></a>13375                                            <span class="keywordtype">char</span> *addr_start, <span class="keywordtype">char</span> **copy_arg)
<a name="l13376"></a>13376 {
<a name="l13377"></a>13377   <span class="comment">/* We use the same method for breakpoint on probes.  */</span>
<a name="l13378"></a>13378   bkpt_probe_create_sals_from_address (arg, canonical, type_wanted,
<a name="l13379"></a>13379                                        addr_start, copy_arg);
<a name="l13380"></a>13380 }
<a name="l13381"></a>13381 
<a name="l13382"></a>13382 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l13383"></a>13383 tracepoint_probe_decode_linespec (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b, <span class="keywordtype">char</span> **s,
<a name="l13384"></a>13384                                   <span class="keyword">struct</span> <a class="code" href="structsymtabs__and__lines.html">symtabs_and_lines</a> *sals)
<a name="l13385"></a>13385 {
<a name="l13386"></a>13386   <span class="comment">/* We use the same method for breakpoint on probes.  */</span>
<a name="l13387"></a>13387   bkpt_probe_decode_linespec (b, s, sals);
<a name="l13388"></a>13388 }
<a name="l13389"></a>13389 
<a name="l13390"></a>13390 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structbreakpoint__ops.html">breakpoint_ops</a> tracepoint_probe_breakpoint_ops;
<a name="l13391"></a>13391 
<a name="l13392"></a>13392 <span class="comment">/* Dprintf breakpoint_ops methods.  */</span>
<a name="l13393"></a>13393 
<a name="l13394"></a>13394 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l13395"></a>13395 dprintf_re_set (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b)
<a name="l13396"></a>13396 {
<a name="l13397"></a>13397   breakpoint_re_set_default (b);
<a name="l13398"></a>13398 
<a name="l13399"></a>13399   <span class="comment">/* This breakpoint could have been pending, and be resolved now, and</span>
<a name="l13400"></a>13400 <span class="comment">     if so, we should now have the extra string.  If we don&#39;t, the</span>
<a name="l13401"></a>13401 <span class="comment">     dprintf was malformed when created, but we couldn&#39;t tell because</span>
<a name="l13402"></a>13402 <span class="comment">     we can&#39;t extract the extra string until the location is</span>
<a name="l13403"></a>13403 <span class="comment">     resolved.  */</span>
<a name="l13404"></a>13404   <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a> != NULL &amp;&amp; b-&gt;<a class="code" href="structbreakpoint.html#a814299ce6585ae3945072a6df05ecb83">extra_string</a> == NULL)
<a name="l13405"></a>13405     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Format string required&quot;</span>));
<a name="l13406"></a>13406 
<a name="l13407"></a>13407   <span class="comment">/* 1 - connect to target 1, that can run breakpoint commands.</span>
<a name="l13408"></a>13408 <span class="comment">     2 - create a dprintf, which resolves fine.</span>
<a name="l13409"></a>13409 <span class="comment">     3 - disconnect from target 1</span>
<a name="l13410"></a>13410 <span class="comment">     4 - connect to target 2, that can NOT run breakpoint commands.</span>
<a name="l13411"></a>13411 <span class="comment"></span>
<a name="l13412"></a>13412 <span class="comment">     After steps #3/#4, you&#39;ll want the dprintf command list to</span>
<a name="l13413"></a>13413 <span class="comment">     be updated, because target 1 and 2 may well return different</span>
<a name="l13414"></a>13414 <span class="comment">     answers for target_can_run_breakpoint_commands().</span>
<a name="l13415"></a>13415 <span class="comment">     Given absence of finer grained resetting, we get to do</span>
<a name="l13416"></a>13416 <span class="comment">     it all the time.  */</span>
<a name="l13417"></a>13417   <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#a814299ce6585ae3945072a6df05ecb83">extra_string</a> != NULL)
<a name="l13418"></a>13418     update_dprintf_command_list (b);
<a name="l13419"></a>13419 }
<a name="l13420"></a>13420 
<a name="l13421"></a>13421 <span class="comment">/* Implement the &quot;print_recreate&quot; breakpoint_ops method for dprintf.  */</span>
<a name="l13422"></a>13422 
<a name="l13423"></a>13423 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l13424"></a>13424 dprintf_print_recreate (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *tp, <span class="keyword">struct</span> ui_file *fp)
<a name="l13425"></a>13425 {
<a name="l13426"></a>13426   <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (fp, <span class="stringliteral">&quot;dprintf %s%s&quot;</span>, tp-&gt;<a class="code" href="structbreakpoint.html#a885e704e5cdcfc314069b970c396d1a4">addr_string</a>,
<a name="l13427"></a>13427                       tp-&gt;<a class="code" href="structbreakpoint.html#a814299ce6585ae3945072a6df05ecb83">extra_string</a>);
<a name="l13428"></a>13428   <a class="code" href="breakpoint_8c.html#aae7cd38b01782db6011bcd0150059625">print_recreate_thread</a> (tp, fp);
<a name="l13429"></a>13429 }
<a name="l13430"></a>13430 
<a name="l13431"></a>13431 <span class="comment">/* Implement the &quot;after_condition_true&quot; breakpoint_ops method for</span>
<a name="l13432"></a>13432 <span class="comment">   dprintf.</span>
<a name="l13433"></a>13433 <span class="comment"></span>
<a name="l13434"></a>13434 <span class="comment">   dprintf&#39;s are implemented with regular commands in their command</span>
<a name="l13435"></a>13435 <span class="comment">   list, but we run the commands here instead of before presenting the</span>
<a name="l13436"></a>13436 <span class="comment">   stop to the user, as dprintf&#39;s don&#39;t actually cause a stop.  This</span>
<a name="l13437"></a>13437 <span class="comment">   also makes it so that the commands of multiple dprintfs at the same</span>
<a name="l13438"></a>13438 <span class="comment">   address are all handled.  */</span>
<a name="l13439"></a>13439 
<a name="l13440"></a>13440 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l13441"></a>13441 dprintf_after_condition_true (<span class="keyword">struct</span> <a class="code" href="structbpstats.html">bpstats</a> *bs)
<a name="l13442"></a>13442 {
<a name="l13443"></a>13443   <span class="keyword">struct </span>cleanup *old_chain;
<a name="l13444"></a>13444   <span class="keyword">struct </span><a class="code" href="structbpstats.html">bpstats</a> tmp_bs = { NULL };
<a name="l13445"></a>13445   <span class="keyword">struct </span><a class="code" href="structbpstats.html">bpstats</a> *tmp_bs_p = &amp;tmp_bs;
<a name="l13446"></a>13446 
<a name="l13447"></a>13447   <span class="comment">/* dprintf&#39;s never cause a stop.  This wasn&#39;t set in the</span>
<a name="l13448"></a>13448 <span class="comment">     check_status hook instead because that would make the dprintf&#39;s</span>
<a name="l13449"></a>13449 <span class="comment">     condition not be evaluated.  */</span>
<a name="l13450"></a>13450   bs-&gt;<a class="code" href="structbpstats.html#acff86901962f7bc070661b85248c4652">stop</a> = 0;
<a name="l13451"></a>13451 
<a name="l13452"></a>13452   <span class="comment">/* Run the command list here.  Take ownership of it instead of</span>
<a name="l13453"></a>13453 <span class="comment">     copying.  We never want these commands to run later in</span>
<a name="l13454"></a>13454 <span class="comment">     bpstat_do_actions, if a breakpoint that causes a stop happens to</span>
<a name="l13455"></a>13455 <span class="comment">     be set at same address as this dprintf, or even if running the</span>
<a name="l13456"></a>13456 <span class="comment">     commands here throws.  */</span>
<a name="l13457"></a>13457   tmp_bs.<a class="code" href="structbpstats.html#a2c06ba2ce8217014988be902dc5228a4">commands</a> = bs-&gt;<a class="code" href="structbpstats.html#a2c06ba2ce8217014988be902dc5228a4">commands</a>;
<a name="l13458"></a>13458   bs-&gt;<a class="code" href="structbpstats.html#a2c06ba2ce8217014988be902dc5228a4">commands</a> = NULL;
<a name="l13459"></a>13459   old_chain = make_cleanup_decref_counted_command_line (&amp;tmp_bs.<a class="code" href="structbpstats.html#a2c06ba2ce8217014988be902dc5228a4">commands</a>);
<a name="l13460"></a>13460 
<a name="l13461"></a>13461   bpstat_do_actions_1 (&amp;tmp_bs_p);
<a name="l13462"></a>13462 
<a name="l13463"></a>13463   <span class="comment">/* &#39;tmp_bs.commands&#39; will usually be NULL by now, but</span>
<a name="l13464"></a>13464 <span class="comment">     bpstat_do_actions_1 may return early without processing the whole</span>
<a name="l13465"></a>13465 <span class="comment">     list.  */</span>
<a name="l13466"></a>13466   <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (old_chain);
<a name="l13467"></a>13467 }
<a name="l13468"></a>13468 
<a name="l13469"></a>13469 <span class="comment">/* The breakpoint_ops structure to be used on static tracepoints with</span>
<a name="l13470"></a>13470 <span class="comment">   markers (`-m&#39;).  */</span>
<a name="l13471"></a>13471 
<a name="l13472"></a>13472 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l13473"></a>13473 strace_marker_create_sals_from_address (<span class="keywordtype">char</span> **arg,
<a name="l13474"></a>13474                                         <span class="keyword">struct</span> <a class="code" href="structlinespec__result.html">linespec_result</a> *canonical,
<a name="l13475"></a>13475                                         <span class="keyword">enum</span> bptype type_wanted,
<a name="l13476"></a>13476                                         <span class="keywordtype">char</span> *addr_start, <span class="keywordtype">char</span> **copy_arg)
<a name="l13477"></a>13477 {
<a name="l13478"></a>13478   <span class="keyword">struct </span><a class="code" href="structlinespec__sals.html">linespec_sals</a> lsal;
<a name="l13479"></a>13479 
<a name="l13480"></a>13480   lsal.<a class="code" href="structlinespec__sals.html#a34ac2e438b2835722c998f409c85dcee">sals</a> = decode_static_tracepoint_spec (arg);
<a name="l13481"></a>13481 
<a name="l13482"></a>13482   *copy_arg = <a class="code" href="common-utils_8c.html#a5f388f89054b57d850779d7d71bc4d1c">savestring</a> (addr_start, *arg - addr_start);
<a name="l13483"></a>13483 
<a name="l13484"></a>13484   canonical-&gt;<a class="code" href="structlinespec__result.html#abfccf5d367c072077ac366af4d3f23f9">addr_string</a> = xstrdup (*copy_arg);
<a name="l13485"></a>13485   lsal.<a class="code" href="structlinespec__sals.html#a5a6b2c7bb2c9b91d8077fb7186a6c466">canonical</a> = xstrdup (*copy_arg);
<a name="l13486"></a>13486   <a class="code" href="vec_8h.html#a8d090c0524726d00931070e0c438ba3f">VEC_safe_push</a> (<a class="code" href="structlinespec__sals.html">linespec_sals</a>, canonical-&gt;sals, &amp;lsal);
<a name="l13487"></a>13487 }
<a name="l13488"></a>13488 
<a name="l13489"></a>13489 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l13490"></a>13490 strace_marker_create_breakpoints_sal (<span class="keyword">struct</span> gdbarch *gdbarch,
<a name="l13491"></a>13491                                       <span class="keyword">struct</span> <a class="code" href="structlinespec__result.html">linespec_result</a> *canonical,
<a name="l13492"></a>13492                                       <span class="keywordtype">char</span> *cond_string,
<a name="l13493"></a>13493                                       <span class="keywordtype">char</span> *extra_string,
<a name="l13494"></a>13494                                       <span class="keyword">enum</span> bptype type_wanted,
<a name="l13495"></a>13495                                       <span class="keyword">enum</span> <a class="code" href="breakpoint_8h.html#a15f2bbd9012f59bc09d59feef0c15732">bpdisp</a> disposition,
<a name="l13496"></a>13496                                       <span class="keywordtype">int</span> thread,
<a name="l13497"></a>13497                                       <span class="keywordtype">int</span> task, <span class="keywordtype">int</span> ignore_count,
<a name="l13498"></a>13498                                       <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structbreakpoint__ops.html">breakpoint_ops</a> *ops,
<a name="l13499"></a>13499                                       <span class="keywordtype">int</span> from_tty, <span class="keywordtype">int</span> enabled,
<a name="l13500"></a>13500                                       <span class="keywordtype">int</span> <span class="keyword">internal</span>, <span class="keywordtype">unsigned</span> flags)
<a name="l13501"></a>13501 {
<a name="l13502"></a>13502   <span class="keywordtype">int</span> i;
<a name="l13503"></a>13503   <span class="keyword">struct </span><a class="code" href="structlinespec__sals.html">linespec_sals</a> *lsal = <a class="code" href="vec_8h.html#a49c128c353995ea8fca27be70829ca52">VEC_index</a> (<a class="code" href="structlinespec__sals.html">linespec_sals</a>,
<a name="l13504"></a>13504                                           canonical-&gt;sals, 0);
<a name="l13505"></a>13505 
<a name="l13506"></a>13506   <span class="comment">/* If the user is creating a static tracepoint by marker id</span>
<a name="l13507"></a>13507 <span class="comment">     (strace -m MARKER_ID), then store the sals index, so that</span>
<a name="l13508"></a>13508 <span class="comment">     breakpoint_re_set can try to match up which of the newly</span>
<a name="l13509"></a>13509 <span class="comment">     found markers corresponds to this one, and, don&#39;t try to</span>
<a name="l13510"></a>13510 <span class="comment">     expand multiple locations for each sal, given than SALS</span>
<a name="l13511"></a>13511 <span class="comment">     already should contain all sals for MARKER_ID.  */</span>
<a name="l13512"></a>13512 
<a name="l13513"></a>13513   <span class="keywordflow">for</span> (i = 0; i &lt; lsal-&gt;<a class="code" href="structlinespec__sals.html#a34ac2e438b2835722c998f409c85dcee">sals</a>.<a class="code" href="structsymtabs__and__lines.html#a1c8b832fc2f8c096c95144a2acedd36a">nelts</a>; ++i)
<a name="l13514"></a>13514     {
<a name="l13515"></a>13515       <span class="keyword">struct </span><a class="code" href="structsymtabs__and__lines.html">symtabs_and_lines</a> expanded;
<a name="l13516"></a>13516       <span class="keyword">struct </span><a class="code" href="structtracepoint.html">tracepoint</a> *tp;
<a name="l13517"></a>13517       <span class="keyword">struct </span>cleanup *old_chain;
<a name="l13518"></a>13518       <span class="keywordtype">char</span> *addr_string;
<a name="l13519"></a>13519 
<a name="l13520"></a>13520       expanded.nelts = 1;
<a name="l13521"></a>13521       expanded.sals = &amp;lsal-&gt;<a class="code" href="structlinespec__sals.html#a34ac2e438b2835722c998f409c85dcee">sals</a>.<a class="code" href="structsymtabs__and__lines.html#ab601f48fdf29c3b190ba068f57983df4">sals</a>[i];
<a name="l13522"></a>13522 
<a name="l13523"></a>13523       addr_string = xstrdup (canonical-&gt;<a class="code" href="structlinespec__result.html#abfccf5d367c072077ac366af4d3f23f9">addr_string</a>);
<a name="l13524"></a>13524       old_chain = <a class="code" href="cleanups_8c.html#a3d418f8af424aec399898c2d48b26224">make_cleanup</a> (<a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a>, addr_string);
<a name="l13525"></a>13525 
<a name="l13526"></a>13526       tp = XCNEW (<span class="keyword">struct</span> <a class="code" href="structtracepoint.html">tracepoint</a>);
<a name="l13527"></a>13527       init_breakpoint_sal (&amp;tp-&gt;<a class="code" href="structtracepoint.html#a881af30b18b555e6ff11113da6b01a02">base</a>, gdbarch, expanded,
<a name="l13528"></a>13528                            addr_string, NULL,
<a name="l13529"></a>13529                            cond_string, extra_string,
<a name="l13530"></a>13530                            type_wanted, disposition,
<a name="l13531"></a>13531                            thread, task, ignore_count, ops,
<a name="l13532"></a>13532                            from_tty, enabled, <span class="keyword">internal</span>, flags,
<a name="l13533"></a>13533                            canonical-&gt;<a class="code" href="structlinespec__result.html#ae890c0bedee5c8dec0bf977bb4c3b1bc">special_display</a>);
<a name="l13534"></a>13534       <span class="comment">/* Given that its possible to have multiple markers with</span>
<a name="l13535"></a>13535 <span class="comment">         the same string id, if the user is creating a static</span>
<a name="l13536"></a>13536 <span class="comment">         tracepoint by marker id (&quot;strace -m MARKER_ID&quot;), then</span>
<a name="l13537"></a>13537 <span class="comment">         store the sals index, so that breakpoint_re_set can</span>
<a name="l13538"></a>13538 <span class="comment">         try to match up which of the newly found markers</span>
<a name="l13539"></a>13539 <span class="comment">         corresponds to this one  */</span>
<a name="l13540"></a>13540       tp-&gt;<a class="code" href="structtracepoint.html#a8afc34dd7a28b9e8936a50c53cd2c79b">static_trace_marker_id_idx</a> = i;
<a name="l13541"></a>13541 
<a name="l13542"></a>13542       <a class="code" href="breakpoint_8c.html#a74ff6d8191c3b444efd5631143d21635">install_breakpoint</a> (<span class="keyword">internal</span>, &amp;tp-&gt;<a class="code" href="structtracepoint.html#a881af30b18b555e6ff11113da6b01a02">base</a>, 0);
<a name="l13543"></a>13543 
<a name="l13544"></a>13544       <a class="code" href="cleanups_8c.html#a5ec3987bf995edcc44def9e17ada6eba">discard_cleanups</a> (old_chain);
<a name="l13545"></a>13545     }
<a name="l13546"></a>13546 }
<a name="l13547"></a>13547 
<a name="l13548"></a>13548 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l13549"></a>13549 strace_marker_decode_linespec (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b, <span class="keywordtype">char</span> **s,
<a name="l13550"></a>13550                                <span class="keyword">struct</span> <a class="code" href="structsymtabs__and__lines.html">symtabs_and_lines</a> *sals)
<a name="l13551"></a>13551 {
<a name="l13552"></a>13552   <span class="keyword">struct </span><a class="code" href="structtracepoint.html">tracepoint</a> *tp = (<span class="keyword">struct </span><a class="code" href="structtracepoint.html">tracepoint</a> *) b;
<a name="l13553"></a>13553 
<a name="l13554"></a>13554   *sals = decode_static_tracepoint_spec (s);
<a name="l13555"></a>13555   <span class="keywordflow">if</span> (sals-&gt;<a class="code" href="structsymtabs__and__lines.html#a1c8b832fc2f8c096c95144a2acedd36a">nelts</a> &gt; tp-&gt;<a class="code" href="structtracepoint.html#a8afc34dd7a28b9e8936a50c53cd2c79b">static_trace_marker_id_idx</a>)
<a name="l13556"></a>13556     {
<a name="l13557"></a>13557       sals-&gt;<a class="code" href="structsymtabs__and__lines.html#ab601f48fdf29c3b190ba068f57983df4">sals</a>[0] = sals-&gt;<a class="code" href="structsymtabs__and__lines.html#ab601f48fdf29c3b190ba068f57983df4">sals</a>[tp-&gt;<a class="code" href="structtracepoint.html#a8afc34dd7a28b9e8936a50c53cd2c79b">static_trace_marker_id_idx</a>];
<a name="l13558"></a>13558       sals-&gt;<a class="code" href="structsymtabs__and__lines.html#a1c8b832fc2f8c096c95144a2acedd36a">nelts</a> = 1;
<a name="l13559"></a>13559     }
<a name="l13560"></a>13560   <span class="keywordflow">else</span>
<a name="l13561"></a>13561     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;marker %s not found&quot;</span>), tp-&gt;<a class="code" href="structtracepoint.html#adeab8a95f18310c90340e7468151db92">static_trace_marker_id</a>);
<a name="l13562"></a>13562 }
<a name="l13563"></a>13563 
<a name="l13564"></a>13564 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structbreakpoint__ops.html">breakpoint_ops</a> strace_marker_breakpoint_ops;
<a name="l13565"></a>13565 
<a name="l13566"></a>13566 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l13567"></a>13567 strace_marker_p (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b)
<a name="l13568"></a>13568 {
<a name="l13569"></a>13569   <span class="keywordflow">return</span> b-&gt;<a class="code" href="structbreakpoint.html#aba258aa23496f6434aaa1cf8c8dc7ea7">ops</a> == &amp;strace_marker_breakpoint_ops;
<a name="l13570"></a>13570 }
<a name="l13571"></a>13571 
<a name="l13572"></a>13572 <span class="comment">/* Delete a breakpoint and clean up all traces of it in the data</span>
<a name="l13573"></a>13573 <span class="comment">   structures.  */</span>
<a name="l13574"></a>13574 
<a name="l13575"></a>13575 <span class="keywordtype">void</span>
<a name="l13576"></a><a class="code" href="breakpoint_8h.html#a6d9e82555a23ff11ef66bb37decb7d38">13576</a> <a class="code" href="breakpoint_8c.html#a0701191361b1ed0d40d76661e88de3f4">delete_breakpoint</a> (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *bpt)
<a name="l13577"></a>13577 {
<a name="l13578"></a>13578   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b;
<a name="l13579"></a>13579 
<a name="l13580"></a>13580   <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (bpt != NULL);
<a name="l13581"></a>13581 
<a name="l13582"></a>13582   <span class="comment">/* Has this bp already been deleted?  This can happen because</span>
<a name="l13583"></a>13583 <span class="comment">     multiple lists can hold pointers to bp&#39;s.  bpstat lists are</span>
<a name="l13584"></a>13584 <span class="comment">     especial culprits.</span>
<a name="l13585"></a>13585 <span class="comment"></span>
<a name="l13586"></a>13586 <span class="comment">     One example of this happening is a watchpoint&#39;s scope bp.  When</span>
<a name="l13587"></a>13587 <span class="comment">     the scope bp triggers, we notice that the watchpoint is out of</span>
<a name="l13588"></a>13588 <span class="comment">     scope, and delete it.  We also delete its scope bp.  But the</span>
<a name="l13589"></a>13589 <span class="comment">     scope bp is marked &quot;auto-deleting&quot;, and is already on a bpstat.</span>
<a name="l13590"></a>13590 <span class="comment">     That bpstat is then checked for auto-deleting bp&#39;s, which are</span>
<a name="l13591"></a>13591 <span class="comment">     deleted.</span>
<a name="l13592"></a>13592 <span class="comment"></span>
<a name="l13593"></a>13593 <span class="comment">     A real solution to this problem might involve reference counts in</span>
<a name="l13594"></a>13594 <span class="comment">     bp&#39;s, and/or giving them pointers back to their referencing</span>
<a name="l13595"></a>13595 <span class="comment">     bpstat&#39;s, and teaching delete_breakpoint to only free a bp&#39;s</span>
<a name="l13596"></a>13596 <span class="comment">     storage when no more references were extent.  A cheaper bandaid</span>
<a name="l13597"></a>13597 <span class="comment">     was chosen.  */</span>
<a name="l13598"></a>13598   <span class="keywordflow">if</span> (bpt-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfac0517cbb17f625d6cf900fb3aa64636e">bp_none</a>)
<a name="l13599"></a>13599     <span class="keywordflow">return</span>;
<a name="l13600"></a>13600 
<a name="l13601"></a>13601   <span class="comment">/* At least avoid this stale reference until the reference counting</span>
<a name="l13602"></a>13602 <span class="comment">     of breakpoints gets resolved.  */</span>
<a name="l13603"></a>13603   <span class="keywordflow">if</span> (bpt-&gt;<a class="code" href="structbreakpoint.html#a7d9882daea896de8ff1f7981e9508500">related_breakpoint</a> != bpt)
<a name="l13604"></a>13604     {
<a name="l13605"></a>13605       <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *related;
<a name="l13606"></a>13606       <span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *w;
<a name="l13607"></a>13607 
<a name="l13608"></a>13608       <span class="keywordflow">if</span> (bpt-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfad6bfd2f2654949462085c78f02480366">bp_watchpoint_scope</a>)
<a name="l13609"></a>13609         w = (<span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *) bpt-&gt;<a class="code" href="structbreakpoint.html#a7d9882daea896de8ff1f7981e9508500">related_breakpoint</a>;
<a name="l13610"></a>13610       <span class="keywordflow">else</span> if (bpt-&gt;<a class="code" href="structbreakpoint.html#a7d9882daea896de8ff1f7981e9508500">related_breakpoint</a>-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfad6bfd2f2654949462085c78f02480366">bp_watchpoint_scope</a>)
<a name="l13611"></a>13611         w = (<span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *) bpt;
<a name="l13612"></a>13612       <span class="keywordflow">else</span>
<a name="l13613"></a>13613         w = NULL;
<a name="l13614"></a>13614       <span class="keywordflow">if</span> (w != NULL)
<a name="l13615"></a>13615         watchpoint_del_at_next_stop (w);
<a name="l13616"></a>13616 
<a name="l13617"></a>13617       <span class="comment">/* Unlink bpt from the bpt-&gt;related_breakpoint ring.  */</span>
<a name="l13618"></a>13618       <span class="keywordflow">for</span> (related = bpt; related-&gt;<a class="code" href="structbreakpoint.html#a7d9882daea896de8ff1f7981e9508500">related_breakpoint</a> != bpt;
<a name="l13619"></a>13619            related = related-&gt;<a class="code" href="structbreakpoint.html#a7d9882daea896de8ff1f7981e9508500">related_breakpoint</a>);
<a name="l13620"></a>13620       related-&gt;<a class="code" href="structbreakpoint.html#a7d9882daea896de8ff1f7981e9508500">related_breakpoint</a> = bpt-&gt;<a class="code" href="structbreakpoint.html#a7d9882daea896de8ff1f7981e9508500">related_breakpoint</a>;
<a name="l13621"></a>13621       bpt-&gt;<a class="code" href="structbreakpoint.html#a7d9882daea896de8ff1f7981e9508500">related_breakpoint</a> = bpt;
<a name="l13622"></a>13622     }
<a name="l13623"></a>13623 
<a name="l13624"></a>13624   <span class="comment">/* watch_command_1 creates a watchpoint but only sets its number if</span>
<a name="l13625"></a>13625 <span class="comment">     update_watchpoint succeeds in creating its bp_locations.  If there&#39;s</span>
<a name="l13626"></a>13626 <span class="comment">     a problem in that process, we&#39;ll be asked to delete the half-created</span>
<a name="l13627"></a>13627 <span class="comment">     watchpoint.  In that case, don&#39;t announce the deletion.  */</span>
<a name="l13628"></a>13628   <span class="keywordflow">if</span> (bpt-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>)
<a name="l13629"></a>13629     <a class="code" href="observer_8h.html#a9a972bc0dd5cbca1b24bd90d4c663b3b">observer_notify_breakpoint_deleted</a> (bpt);
<a name="l13630"></a>13630 
<a name="l13631"></a>13631   <span class="keywordflow">if</span> (breakpoint_chain == bpt)
<a name="l13632"></a>13632     breakpoint_chain = bpt-&gt;<a class="code" href="structbreakpoint.html#a30f997b48b04a520ea99e35a74451933">next</a>;
<a name="l13633"></a>13633 
<a name="l13634"></a>13634   <a class="code" href="breakpoint_8c.html#a781d5d3dc50a92364edfbacac3d0c107">ALL_BREAKPOINTS</a> (b)
<a name="l13635"></a>13635     <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#a30f997b48b04a520ea99e35a74451933">next</a> == bpt)
<a name="l13636"></a>13636     {
<a name="l13637"></a>13637       b-&gt;<a class="code" href="structbreakpoint.html#a30f997b48b04a520ea99e35a74451933">next</a> = bpt-&gt;<a class="code" href="structbreakpoint.html#a30f997b48b04a520ea99e35a74451933">next</a>;
<a name="l13638"></a>13638       <span class="keywordflow">break</span>;
<a name="l13639"></a>13639     }
<a name="l13640"></a>13640 
<a name="l13641"></a>13641   <span class="comment">/* Be sure no bpstat&#39;s are pointing at the breakpoint after it&#39;s</span>
<a name="l13642"></a>13642 <span class="comment">     been freed.  */</span>
<a name="l13643"></a>13643   <span class="comment">/* FIXME, how can we find all bpstat&#39;s?  We just check stop_bpstat</span>
<a name="l13644"></a>13644 <span class="comment">     in all threads for now.  Note that we cannot just remove bpstats</span>
<a name="l13645"></a>13645 <span class="comment">     pointing at bpt from the stop_bpstat list entirely, as breakpoint</span>
<a name="l13646"></a>13646 <span class="comment">     commands are associated with the bpstat; if we remove it here,</span>
<a name="l13647"></a>13647 <span class="comment">     then the later call to bpstat_do_actions (&amp;stop_bpstat); in</span>
<a name="l13648"></a>13648 <span class="comment">     event-top.c won&#39;t do anything, and temporary breakpoints with</span>
<a name="l13649"></a>13649 <span class="comment">     commands won&#39;t work.  */</span>
<a name="l13650"></a>13650 
<a name="l13651"></a>13651   <a class="code" href="gdbthread_8h.html#a5dc20fee3cc8a79f615f2f5d695ae1bc">iterate_over_threads</a> (bpstat_remove_breakpoint_callback, bpt);
<a name="l13652"></a>13652 
<a name="l13653"></a>13653   <span class="comment">/* Now that breakpoint is removed from breakpoint list, update the</span>
<a name="l13654"></a>13654 <span class="comment">     global location list.  This will remove locations that used to</span>
<a name="l13655"></a>13655 <span class="comment">     belong to this breakpoint.  Do this before freeing the breakpoint</span>
<a name="l13656"></a>13656 <span class="comment">     itself, since remove_breakpoint looks at location&#39;s owner.  It</span>
<a name="l13657"></a>13657 <span class="comment">     might be better design to have location completely</span>
<a name="l13658"></a>13658 <span class="comment">     self-contained, but it&#39;s not the case now.  */</span>
<a name="l13659"></a>13659   update_global_location_list (0);
<a name="l13660"></a>13660 
<a name="l13661"></a>13661   bpt-&gt;<a class="code" href="structbreakpoint.html#aba258aa23496f6434aaa1cf8c8dc7ea7">ops</a>-&gt;<a class="code" href="structbreakpoint__ops.html#a110b2df7b285e5f83bf40b9a0e5435c1">dtor</a> (bpt);
<a name="l13662"></a>13662   <span class="comment">/* On the chance that someone will soon try again to delete this</span>
<a name="l13663"></a>13663 <span class="comment">     same bp, we mark it as deleted before freeing its storage.  */</span>
<a name="l13664"></a>13664   bpt-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> = <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfac0517cbb17f625d6cf900fb3aa64636e">bp_none</a>;
<a name="l13665"></a>13665   <a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a> (bpt);
<a name="l13666"></a>13666 }
<a name="l13667"></a>13667 
<a name="l13668"></a>13668 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l13669"></a>13669 do_delete_breakpoint_cleanup (<span class="keywordtype">void</span> *b)
<a name="l13670"></a>13670 {
<a name="l13671"></a>13671   <a class="code" href="breakpoint_8c.html#a0701191361b1ed0d40d76661e88de3f4">delete_breakpoint</a> (b);
<a name="l13672"></a>13672 }
<a name="l13673"></a>13673 
<a name="l13674"></a>13674 <span class="keyword">struct </span>cleanup *
<a name="l13675"></a><a class="code" href="breakpoint_8h.html#a2af8494e734c37748d78da90056efff2">13675</a> <a class="code" href="breakpoint_8c.html#a9a2dfa07301bdbe8c3b5e7d3f0a6f346">make_cleanup_delete_breakpoint</a> (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b)
<a name="l13676"></a>13676 {
<a name="l13677"></a>13677   <span class="keywordflow">return</span> <a class="code" href="cleanups_8c.html#a3d418f8af424aec399898c2d48b26224">make_cleanup</a> (do_delete_breakpoint_cleanup, b);
<a name="l13678"></a>13678 }
<a name="l13679"></a>13679 
<a name="l13680"></a>13680 <span class="comment">/* Iterator function to call a user-provided callback function once</span>
<a name="l13681"></a>13681 <span class="comment">   for each of B and its related breakpoints.  */</span>
<a name="l13682"></a>13682 
<a name="l13683"></a>13683 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l13684"></a>13684 iterate_over_related_breakpoints (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b,
<a name="l13685"></a>13685                                   <span class="keywordtype">void</span> (*<span class="keyword">function</span>) (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *,
<a name="l13686"></a>13686                                                     <span class="keywordtype">void</span> *),
<a name="l13687"></a>13687                                   <span class="keywordtype">void</span> *data)
<a name="l13688"></a>13688 {
<a name="l13689"></a>13689   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *related;
<a name="l13690"></a>13690 
<a name="l13691"></a>13691   related = b;
<a name="l13692"></a>13692   <span class="keywordflow">do</span>
<a name="l13693"></a>13693     {
<a name="l13694"></a>13694       <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *<a class="code" href="structbreakpoint.html#a30f997b48b04a520ea99e35a74451933">next</a>;
<a name="l13695"></a>13695 
<a name="l13696"></a>13696       <span class="comment">/* FUNCTION may delete RELATED.  */</span>
<a name="l13697"></a>13697       next = related-&gt;<a class="code" href="structbreakpoint.html#a7d9882daea896de8ff1f7981e9508500">related_breakpoint</a>;
<a name="l13698"></a>13698 
<a name="l13699"></a>13699       <span class="keywordflow">if</span> (next == related)
<a name="l13700"></a>13700         {
<a name="l13701"></a>13701           <span class="comment">/* RELATED is the last ring entry.  */</span>
<a name="l13702"></a>13702           <span class="keyword">function</span> (related, data);
<a name="l13703"></a>13703 
<a name="l13704"></a>13704           <span class="comment">/* FUNCTION may have deleted it, so we&#39;d never reach back to</span>
<a name="l13705"></a>13705 <span class="comment">             B.  There&#39;s nothing left to do anyway, so just break</span>
<a name="l13706"></a>13706 <span class="comment">             out.  */</span>
<a name="l13707"></a>13707           <span class="keywordflow">break</span>;
<a name="l13708"></a>13708         }
<a name="l13709"></a>13709       <span class="keywordflow">else</span>
<a name="l13710"></a>13710         <span class="keyword">function</span> (related, data);
<a name="l13711"></a>13711 
<a name="l13712"></a>13712       related = <a class="code" href="structbreakpoint.html#a30f997b48b04a520ea99e35a74451933">next</a>;
<a name="l13713"></a>13713     }
<a name="l13714"></a>13714   <span class="keywordflow">while</span> (related != b);
<a name="l13715"></a>13715 }
<a name="l13716"></a>13716 
<a name="l13717"></a>13717 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l13718"></a>13718 do_delete_breakpoint (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b, <span class="keywordtype">void</span> *ignore)
<a name="l13719"></a>13719 {
<a name="l13720"></a>13720   <a class="code" href="breakpoint_8c.html#a0701191361b1ed0d40d76661e88de3f4">delete_breakpoint</a> (b);
<a name="l13721"></a>13721 }
<a name="l13722"></a>13722 
<a name="l13723"></a>13723 <span class="comment">/* A callback for map_breakpoint_numbers that calls</span>
<a name="l13724"></a>13724 <span class="comment">   delete_breakpoint.  */</span>
<a name="l13725"></a>13725 
<a name="l13726"></a>13726 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l13727"></a>13727 do_map_delete_breakpoint (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b, <span class="keywordtype">void</span> *ignore)
<a name="l13728"></a>13728 {
<a name="l13729"></a>13729   iterate_over_related_breakpoints (b, do_delete_breakpoint, NULL);
<a name="l13730"></a>13730 }
<a name="l13731"></a>13731 
<a name="l13732"></a>13732 <span class="keywordtype">void</span>
<a name="l13733"></a><a class="code" href="breakpoint_8h.html#a17a62f25c595697afa257f7f9df1736f">13733</a> <a class="code" href="breakpoint_8c.html#a17a62f25c595697afa257f7f9df1736f">delete_command</a> (<span class="keywordtype">char</span> *arg, <span class="keywordtype">int</span> from_tty)
<a name="l13734"></a>13734 {
<a name="l13735"></a>13735   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b, *b_tmp;
<a name="l13736"></a>13736 
<a name="l13737"></a>13737   <a class="code" href="command_8h.html#ac7af34b03605d65b114a173d49532050">dont_repeat</a> ();
<a name="l13738"></a>13738 
<a name="l13739"></a>13739   <span class="keywordflow">if</span> (arg == 0)
<a name="l13740"></a>13740     {
<a name="l13741"></a>13741       <span class="keywordtype">int</span> breaks_to_delete = 0;
<a name="l13742"></a>13742 
<a name="l13743"></a>13743       <span class="comment">/* Delete all breakpoints if no argument.  Do not delete</span>
<a name="l13744"></a>13744 <span class="comment">         internal breakpoints, these have to be deleted with an</span>
<a name="l13745"></a>13745 <span class="comment">         explicit breakpoint number argument.  */</span>
<a name="l13746"></a>13746       <a class="code" href="breakpoint_8c.html#a781d5d3dc50a92364edfbacac3d0c107">ALL_BREAKPOINTS</a> (b)
<a name="l13747"></a>13747         <span class="keywordflow">if</span> (<a class="code" href="breakpoint_8c.html#ac7893fb93c9f1d907b89a1655481602d">user_breakpoint_p</a> (b))
<a name="l13748"></a>13748           {
<a name="l13749"></a>13749             breaks_to_delete = 1;
<a name="l13750"></a>13750             <span class="keywordflow">break</span>;
<a name="l13751"></a>13751           }
<a name="l13752"></a>13752 
<a name="l13753"></a>13753       <span class="comment">/* Ask user only if there are some breakpoints to delete.  */</span>
<a name="l13754"></a>13754       <span class="keywordflow">if</span> (!from_tty
<a name="l13755"></a>13755           || (breaks_to_delete &amp;&amp; <a class="code" href="utils_8c.html#a4b369431cd1ce5d26bccf6b79a44c085">query</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Delete all breakpoints? &quot;</span>))))
<a name="l13756"></a>13756         {
<a name="l13757"></a>13757           <a class="code" href="breakpoint_8c.html#ace15af58ae54149fbef6d72ecb61e12d">ALL_BREAKPOINTS_SAFE</a> (b, b_tmp)
<a name="l13758"></a>13758             <span class="keywordflow">if</span> (<a class="code" href="breakpoint_8c.html#ac7893fb93c9f1d907b89a1655481602d">user_breakpoint_p</a> (b))
<a name="l13759"></a>13759               <a class="code" href="breakpoint_8c.html#a0701191361b1ed0d40d76661e88de3f4">delete_breakpoint</a> (b);
<a name="l13760"></a>13760         }
<a name="l13761"></a>13761     }
<a name="l13762"></a>13762   <span class="keywordflow">else</span>
<a name="l13763"></a>13763     map_breakpoint_numbers (arg, do_map_delete_breakpoint, NULL);
<a name="l13764"></a>13764 }
<a name="l13765"></a>13765 
<a name="l13766"></a>13766 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l13767"></a>13767 all_locations_are_pending (<span class="keyword">struct</span> bp_location *loc)
<a name="l13768"></a>13768 {
<a name="l13769"></a>13769   <span class="keywordflow">for</span> (; <a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>; loc = loc-&gt;<a class="code" href="structbp__location.html#ab193cb38f87fea89105db96d94191541">next</a>)
<a name="l13770"></a>13770     <span class="keywordflow">if</span> (!loc-&gt;<a class="code" href="structbp__location.html#a3732b41958ed311106bffd202cbfe4ff">shlib_disabled</a>
<a name="l13771"></a>13771         &amp;&amp; !loc-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a>-&gt;<a class="code" href="structprogram__space.html#a66c8a669a715e0f3c717bf0fd8951724">executing_startup</a>)
<a name="l13772"></a>13772       <span class="keywordflow">return</span> 0;
<a name="l13773"></a>13773   <span class="keywordflow">return</span> 1;
<a name="l13774"></a>13774 }
<a name="l13775"></a>13775 
<a name="l13776"></a>13776 <span class="comment">/* Subroutine of update_breakpoint_locations to simplify it.</span>
<a name="l13777"></a>13777 <span class="comment">   Return non-zero if multiple fns in list LOC have the same name.</span>
<a name="l13778"></a>13778 <span class="comment">   Null names are ignored.  */</span>
<a name="l13779"></a>13779 
<a name="l13780"></a>13780 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l13781"></a>13781 ambiguous_names_p (<span class="keyword">struct</span> bp_location *loc)
<a name="l13782"></a>13782 {
<a name="l13783"></a>13783   <span class="keyword">struct </span>bp_location *l;
<a name="l13784"></a>13784   htab_t htab = htab_create_alloc (13, htab_hash_string,
<a name="l13785"></a>13785                                    (<span class="keywordtype">int</span> (*) (<span class="keyword">const</span> <span class="keywordtype">void</span> *, 
<a name="l13786"></a>13786                                              <span class="keyword">const</span> <span class="keywordtype">void</span> *)) <a class="code" href="utils_8c.html#aa6e179aa2fa149e001055d2697342085">streq</a>,
<a name="l13787"></a>13787                                    NULL, <a class="code" href="common-utils_8c.html#a05a0a3435b91a07d6cc1a0b4c8788a4d">xcalloc</a>, <a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a>);
<a name="l13788"></a>13788 
<a name="l13789"></a>13789   <span class="keywordflow">for</span> (l = loc; l != NULL; l = l-&gt;<a class="code" href="structbp__location.html#ab193cb38f87fea89105db96d94191541">next</a>)
<a name="l13790"></a>13790     {
<a name="l13791"></a>13791       <span class="keyword">const</span> <span class="keywordtype">char</span> **slot;
<a name="l13792"></a>13792       <span class="keyword">const</span> <span class="keywordtype">char</span> *name = l-&gt;<a class="code" href="structbp__location.html#aaaefbb59159defe719f775ae4fd0f7a7">function_name</a>;
<a name="l13793"></a>13793 
<a name="l13794"></a>13794       <span class="comment">/* Allow for some names to be NULL, ignore them.  */</span>
<a name="l13795"></a>13795       <span class="keywordflow">if</span> (name == NULL)
<a name="l13796"></a>13796         <span class="keywordflow">continue</span>;
<a name="l13797"></a>13797 
<a name="l13798"></a>13798       slot = (<span class="keyword">const</span> <span class="keywordtype">char</span> **) htab_find_slot (htab, (<span class="keyword">const</span> <span class="keywordtype">void</span> *) <a class="code" href="aarch64-tdep_8c.html#acc128f98d9ceca227038c771308eff39">name</a>,
<a name="l13799"></a>13799                                              INSERT);
<a name="l13800"></a>13800       <span class="comment">/* NOTE: We can assume slot != NULL here because xcalloc never</span>
<a name="l13801"></a>13801 <span class="comment">         returns NULL.  */</span>
<a name="l13802"></a>13802       <span class="keywordflow">if</span> (*slot != NULL)
<a name="l13803"></a>13803         {
<a name="l13804"></a>13804           htab_delete (htab);
<a name="l13805"></a>13805           <span class="keywordflow">return</span> 1;
<a name="l13806"></a>13806         }
<a name="l13807"></a>13807       *slot = <a class="code" href="aarch64-tdep_8c.html#acc128f98d9ceca227038c771308eff39">name</a>;
<a name="l13808"></a>13808     }
<a name="l13809"></a>13809 
<a name="l13810"></a>13810   htab_delete (htab);
<a name="l13811"></a>13811   <span class="keywordflow">return</span> 0;
<a name="l13812"></a>13812 }
<a name="l13813"></a>13813 
<a name="l13814"></a>13814 <span class="comment">/* When symbols change, it probably means the sources changed as well,</span>
<a name="l13815"></a>13815 <span class="comment">   and it might mean the static tracepoint markers are no longer at</span>
<a name="l13816"></a>13816 <span class="comment">   the same address or line numbers they used to be at last we</span>
<a name="l13817"></a>13817 <span class="comment">   checked.  Losing your static tracepoints whenever you rebuild is</span>
<a name="l13818"></a>13818 <span class="comment">   undesirable.  This function tries to resync/rematch gdb static</span>
<a name="l13819"></a>13819 <span class="comment">   tracepoints with the markers on the target, for static tracepoints</span>
<a name="l13820"></a>13820 <span class="comment">   that have not been set by marker id.  Static tracepoint that have</span>
<a name="l13821"></a>13821 <span class="comment">   been set by marker id are reset by marker id in breakpoint_re_set.</span>
<a name="l13822"></a>13822 <span class="comment">   The heuristic is:</span>
<a name="l13823"></a>13823 <span class="comment"></span>
<a name="l13824"></a>13824 <span class="comment">   1) For a tracepoint set at a specific address, look for a marker at</span>
<a name="l13825"></a>13825 <span class="comment">   the old PC.  If one is found there, assume to be the same marker.</span>
<a name="l13826"></a>13826 <span class="comment">   If the name / string id of the marker found is different from the</span>
<a name="l13827"></a>13827 <span class="comment">   previous known name, assume that means the user renamed the marker</span>
<a name="l13828"></a>13828 <span class="comment">   in the sources, and output a warning.</span>
<a name="l13829"></a>13829 <span class="comment"></span>
<a name="l13830"></a>13830 <span class="comment">   2) For a tracepoint set at a given line number, look for a marker</span>
<a name="l13831"></a>13831 <span class="comment">   at the new address of the old line number.  If one is found there,</span>
<a name="l13832"></a>13832 <span class="comment">   assume to be the same marker.  If the name / string id of the</span>
<a name="l13833"></a>13833 <span class="comment">   marker found is different from the previous known name, assume that</span>
<a name="l13834"></a>13834 <span class="comment">   means the user renamed the marker in the sources, and output a</span>
<a name="l13835"></a>13835 <span class="comment">   warning.</span>
<a name="l13836"></a>13836 <span class="comment"></span>
<a name="l13837"></a>13837 <span class="comment">   3) If a marker is no longer found at the same address or line, it</span>
<a name="l13838"></a>13838 <span class="comment">   may mean the marker no longer exists.  But it may also just mean</span>
<a name="l13839"></a>13839 <span class="comment">   the code changed a bit.  Maybe the user added a few lines of code</span>
<a name="l13840"></a>13840 <span class="comment">   that made the marker move up or down (in line number terms).  Ask</span>
<a name="l13841"></a>13841 <span class="comment">   the target for info about the marker with the string id as we knew</span>
<a name="l13842"></a>13842 <span class="comment">   it.  If found, update line number and address in the matching</span>
<a name="l13843"></a>13843 <span class="comment">   static tracepoint.  This will get confused if there&#39;s more than one</span>
<a name="l13844"></a>13844 <span class="comment">   marker with the same ID (possible in UST, although unadvised</span>
<a name="l13845"></a>13845 <span class="comment">   precisely because it confuses tools).  */</span>
<a name="l13846"></a>13846 
<a name="l13847"></a>13847 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structsymtab__and__line.html">symtab_and_line</a>
<a name="l13848"></a>13848 update_static_tracepoint (struct <a class="code" href="structbreakpoint.html">breakpoint</a> *b, <span class="keyword">struct </span><a class="code" href="structsymtab__and__line.html">symtab_and_line</a> sal)
<a name="l13849"></a>13849 {
<a name="l13850"></a>13850   <span class="keyword">struct </span><a class="code" href="structtracepoint.html">tracepoint</a> *tp = (<span class="keyword">struct </span><a class="code" href="structtracepoint.html">tracepoint</a> *) b;
<a name="l13851"></a>13851   <span class="keyword">struct </span><a class="code" href="structstatic__tracepoint__marker.html">static_tracepoint_marker</a> marker;
<a name="l13852"></a>13852   <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> <a class="code" href="structsymtab__and__line.html#a77665fa461ad187cb755efa256ba44d7">pc</a>;
<a name="l13853"></a>13853 
<a name="l13854"></a>13854   pc = sal.<a class="code" href="structsymtab__and__line.html#a77665fa461ad187cb755efa256ba44d7">pc</a>;
<a name="l13855"></a>13855   <span class="keywordflow">if</span> (sal.<a class="code" href="structsymtab__and__line.html#a6a0468be675b9ac19a5b3ef26f471eaf">line</a>)
<a name="l13856"></a>13856     <a class="code" href="symtab_8c.html#a3efe9f4dc1edb5d91fceb5d8dfa5c427">find_line_pc</a> (sal.<a class="code" href="structsymtab__and__line.html#a74216e171a96d8bcaab43fe69b49c599">symtab</a>, sal.<a class="code" href="structsymtab__and__line.html#a6a0468be675b9ac19a5b3ef26f471eaf">line</a>, &amp;pc);
<a name="l13857"></a>13857 
<a name="l13858"></a>13858   <span class="keywordflow">if</span> (<a class="code" href="target_8h.html#ae08c5fc84179c507e7eb68640f32a5f4">target_static_tracepoint_marker_at</a> (pc, &amp;marker))
<a name="l13859"></a>13859     {
<a name="l13860"></a>13860       <span class="keywordflow">if</span> (strcmp (tp-&gt;<a class="code" href="structtracepoint.html#adeab8a95f18310c90340e7468151db92">static_trace_marker_id</a>, marker.str_id) != 0)
<a name="l13861"></a>13861         <a class="code" href="utils_8c.html#a5fc201a4181499a6b4057a6caa15b5e2">warning</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;static tracepoint %d changed probed marker from %s to %s&quot;</span>),
<a name="l13862"></a>13862                  b-&gt;number,
<a name="l13863"></a>13863                  tp-&gt;<a class="code" href="structtracepoint.html#adeab8a95f18310c90340e7468151db92">static_trace_marker_id</a>, marker.str_id);
<a name="l13864"></a>13864 
<a name="l13865"></a>13865       <a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a> (tp-&gt;<a class="code" href="structtracepoint.html#adeab8a95f18310c90340e7468151db92">static_trace_marker_id</a>);
<a name="l13866"></a>13866       tp-&gt;<a class="code" href="structtracepoint.html#adeab8a95f18310c90340e7468151db92">static_trace_marker_id</a> = xstrdup (marker.str_id);
<a name="l13867"></a>13867       <a class="code" href="tracepoint_8c.html#a6eb95e5022deae349e0523ceb87e6252">release_static_tracepoint_marker</a> (&amp;marker);
<a name="l13868"></a>13868 
<a name="l13869"></a>13869       <span class="keywordflow">return</span> sal;
<a name="l13870"></a>13870     }
<a name="l13871"></a>13871 
<a name="l13872"></a>13872   <span class="comment">/* Old marker wasn&#39;t found on target at lineno.  Try looking it up</span>
<a name="l13873"></a>13873 <span class="comment">     by string ID.  */</span>
<a name="l13874"></a>13874   <span class="keywordflow">if</span> (!sal.<a class="code" href="structsymtab__and__line.html#aa1cadecc3ac47f587f6725c2851a73ac">explicit_pc</a>
<a name="l13875"></a>13875       &amp;&amp; sal.<a class="code" href="structsymtab__and__line.html#a6a0468be675b9ac19a5b3ef26f471eaf">line</a> != 0
<a name="l13876"></a>13876       &amp;&amp; sal.<a class="code" href="structsymtab__and__line.html#a74216e171a96d8bcaab43fe69b49c599">symtab</a> != NULL
<a name="l13877"></a>13877       &amp;&amp; tp-&gt;<a class="code" href="structtracepoint.html#adeab8a95f18310c90340e7468151db92">static_trace_marker_id</a> != NULL)
<a name="l13878"></a>13878     {
<a name="l13879"></a>13879       <a class="code" href="vec_8h.html#ab084f6f29fcf16a6b15d15feb653d414">VEC</a>(<a class="code" href="structstatic__tracepoint__marker.html">static_tracepoint_marker_p</a>) *markers;
<a name="l13880"></a>13880 
<a name="l13881"></a>13881       markers
<a name="l13882"></a>13882         = <a class="code" href="target_8h.html#a0a86c51b45e40100c97b3dd4540455e8">target_static_tracepoint_markers_by_strid</a> (tp-&gt;<a class="code" href="structtracepoint.html#adeab8a95f18310c90340e7468151db92">static_trace_marker_id</a>);
<a name="l13883"></a>13883 
<a name="l13884"></a>13884       <span class="keywordflow">if</span> (!<a class="code" href="vec_8h.html#ac9981d313a5e114db0e05b7b9cd16319">VEC_empty</a>(<a class="code" href="structstatic__tracepoint__marker.html">static_tracepoint_marker_p</a>, markers))
<a name="l13885"></a>13885         {
<a name="l13886"></a>13886           <span class="keyword">struct </span><a class="code" href="structsymtab__and__line.html">symtab_and_line</a> sal2;
<a name="l13887"></a>13887           <span class="keyword">struct </span><a class="code" href="structsymbol.html">symbol</a> *sym;
<a name="l13888"></a>13888           <span class="keyword">struct </span><a class="code" href="structstatic__tracepoint__marker.html">static_tracepoint_marker</a> *tpmarker;
<a name="l13889"></a>13889           <span class="keyword">struct </span>ui_out *uiout = <a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>;
<a name="l13890"></a>13890 
<a name="l13891"></a>13891           tpmarker = <a class="code" href="vec_8h.html#a49c128c353995ea8fca27be70829ca52">VEC_index</a> (<a class="code" href="structstatic__tracepoint__marker.html">static_tracepoint_marker_p</a>, markers, 0);
<a name="l13892"></a>13892 
<a name="l13893"></a>13893           <a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a> (tp-&gt;<a class="code" href="structtracepoint.html#adeab8a95f18310c90340e7468151db92">static_trace_marker_id</a>);
<a name="l13894"></a>13894           tp-&gt;<a class="code" href="structtracepoint.html#adeab8a95f18310c90340e7468151db92">static_trace_marker_id</a> = xstrdup (tpmarker-&gt;<a class="code" href="structstatic__tracepoint__marker.html#a8e6faa0cf36d03b0a2d8bff0f53e0118">str_id</a>);
<a name="l13895"></a>13895 
<a name="l13896"></a>13896           <a class="code" href="utils_8c.html#a5fc201a4181499a6b4057a6caa15b5e2">warning</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;marker for static tracepoint %d (%s) not &quot;</span>
<a name="l13897"></a>13897                      <span class="stringliteral">&quot;found at previous line number&quot;</span>),
<a name="l13898"></a>13898                    b-&gt;number, tp-&gt;<a class="code" href="structtracepoint.html#adeab8a95f18310c90340e7468151db92">static_trace_marker_id</a>);
<a name="l13899"></a>13899 
<a name="l13900"></a>13900           <a class="code" href="symtab_8c.html#aca3a01a4f0e1a09f99e8308faecc9028">init_sal</a> (&amp;sal2);
<a name="l13901"></a>13901 
<a name="l13902"></a>13902           sal2.pc = tpmarker-&gt;<a class="code" href="structstatic__tracepoint__marker.html#aa5ab18cb7b106119a67b22528f98f89d">address</a>;
<a name="l13903"></a>13903 
<a name="l13904"></a>13904           sal2 = <a class="code" href="symtab_8c.html#ad9bbd85700e3d7fa50e7ba0e32f37846">find_pc_line</a> (tpmarker-&gt;<a class="code" href="structstatic__tracepoint__marker.html#aa5ab18cb7b106119a67b22528f98f89d">address</a>, 0);
<a name="l13905"></a>13905           sym = <a class="code" href="blockframe_8c.html#a255def7e64445af1e9b15dfaa24b07a5">find_pc_sect_function</a> (tpmarker-&gt;<a class="code" href="structstatic__tracepoint__marker.html#aa5ab18cb7b106119a67b22528f98f89d">address</a>, NULL);
<a name="l13906"></a>13906           <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;Now in &quot;</span>);
<a name="l13907"></a>13907           <span class="keywordflow">if</span> (sym)
<a name="l13908"></a>13908             {
<a name="l13909"></a>13909               <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a> (uiout, <span class="stringliteral">&quot;func&quot;</span>,
<a name="l13910"></a>13910                                    <a class="code" href="symtab_8h.html#ac7f4cb1648125545fbd0e4f13b0c572c">SYMBOL_PRINT_NAME</a> (sym));
<a name="l13911"></a>13911               <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot; at &quot;</span>);
<a name="l13912"></a>13912             }
<a name="l13913"></a>13913           <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a> (uiout, <span class="stringliteral">&quot;file&quot;</span>,
<a name="l13914"></a>13914                                <a class="code" href="source_8c.html#ae251616cab166301d5fed95cbdd31232">symtab_to_filename_for_display</a> (sal2.symtab));
<a name="l13915"></a>13915           <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;:&quot;</span>);
<a name="l13916"></a>13916 
<a name="l13917"></a>13917           <span class="keywordflow">if</span> (<a class="code" href="ui-out_8c.html#a473db54efcfbc60feeb5a4f54f27af46">ui_out_is_mi_like_p</a> (uiout))
<a name="l13918"></a>13918             {
<a name="l13919"></a>13919               <span class="keyword">const</span> <span class="keywordtype">char</span> *fullname = <a class="code" href="source_8c.html#aa78177718e9d6c01595600975e8254df">symtab_to_fullname</a> (sal2.symtab);
<a name="l13920"></a>13920 
<a name="l13921"></a>13921               <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a> (uiout, <span class="stringliteral">&quot;fullname&quot;</span>, fullname);
<a name="l13922"></a>13922             }
<a name="l13923"></a>13923 
<a name="l13924"></a>13924           <a class="code" href="ui-out_8c.html#aa6f66551d03db456fb94ca1c9038f5a0">ui_out_field_int</a> (uiout, <span class="stringliteral">&quot;line&quot;</span>, sal2.line);
<a name="l13925"></a>13925           <a class="code" href="ui-out_8c.html#a6a23596295dce32ba2a5bd2fd2d309f8">ui_out_text</a> (uiout, <span class="stringliteral">&quot;\n&quot;</span>);
<a name="l13926"></a>13926 
<a name="l13927"></a>13927           b-&gt;loc-&gt;line_number = sal2.<a class="code" href="structsymtab__and__line.html#a6a0468be675b9ac19a5b3ef26f471eaf">line</a>;
<a name="l13928"></a>13928           b-&gt;loc-&gt;<a class="code" href="structsymtab__and__line.html#a74216e171a96d8bcaab43fe69b49c599">symtab</a> = sym != NULL ? sal2.<a class="code" href="structsymbol.html#aabf563c8e01c4e316ff975c3666a3f5d">symtab</a> : NULL;
<a name="l13929"></a>13929 
<a name="l13930"></a>13930           <a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a> (b-&gt;addr_string);
<a name="l13931"></a>13931           b-&gt;addr_string = <a class="code" href="common-utils_8c.html#ab9bf7e1b4e68bdd0078e9e1e55c62cec">xstrprintf</a> (<span class="stringliteral">&quot;%s:%d&quot;</span>,
<a name="l13932"></a>13932                                    <a class="code" href="source_8c.html#ae251616cab166301d5fed95cbdd31232">symtab_to_filename_for_display</a> (sal2.symtab),
<a name="l13933"></a>13933                                        b-&gt;loc-&gt;line_number);
<a name="l13934"></a>13934 
<a name="l13935"></a>13935           <span class="comment">/* Might be nice to check if function changed, and warn if</span>
<a name="l13936"></a>13936 <span class="comment">             so.  */</span>
<a name="l13937"></a>13937 
<a name="l13938"></a>13938           <a class="code" href="tracepoint_8c.html#a6eb95e5022deae349e0523ceb87e6252">release_static_tracepoint_marker</a> (tpmarker);
<a name="l13939"></a>13939         }
<a name="l13940"></a>13940     }
<a name="l13941"></a>13941   <span class="keywordflow">return</span> sal;
<a name="l13942"></a>13942 }
<a name="l13943"></a>13943 
<a name="l13944"></a>13944 <span class="comment">/* Returns 1 iff locations A and B are sufficiently same that</span>
<a name="l13945"></a>13945 <span class="comment">   we don&#39;t need to report breakpoint as changed.  */</span>
<a name="l13946"></a>13946 
<a name="l13947"></a>13947 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l13948"></a>13948 locations_are_equal (<span class="keyword">struct</span> bp_location *a, <span class="keyword">struct</span> bp_location *b)
<a name="l13949"></a>13949 {
<a name="l13950"></a>13950   <span class="keywordflow">while</span> (a &amp;&amp; b)
<a name="l13951"></a>13951     {
<a name="l13952"></a>13952       <span class="keywordflow">if</span> (a-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a> != b-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>)
<a name="l13953"></a>13953         <span class="keywordflow">return</span> 0;
<a name="l13954"></a>13954 
<a name="l13955"></a>13955       <span class="keywordflow">if</span> (a-&gt;<a class="code" href="structbp__location.html#a3732b41958ed311106bffd202cbfe4ff">shlib_disabled</a> != b-&gt;<a class="code" href="structbp__location.html#a3732b41958ed311106bffd202cbfe4ff">shlib_disabled</a>)
<a name="l13956"></a>13956         <span class="keywordflow">return</span> 0;
<a name="l13957"></a>13957 
<a name="l13958"></a>13958       <span class="keywordflow">if</span> (a-&gt;<a class="code" href="structbp__location.html#abe93e091d18373d27bda3ad3eb6316f8">enabled</a> != b-&gt;<a class="code" href="structbp__location.html#abe93e091d18373d27bda3ad3eb6316f8">enabled</a>)
<a name="l13959"></a>13959         <span class="keywordflow">return</span> 0;
<a name="l13960"></a>13960 
<a name="l13961"></a>13961       a = a-&gt;<a class="code" href="structbp__location.html#ab193cb38f87fea89105db96d94191541">next</a>;
<a name="l13962"></a>13962       b = b-&gt;<a class="code" href="structbp__location.html#ab193cb38f87fea89105db96d94191541">next</a>;
<a name="l13963"></a>13963     }
<a name="l13964"></a>13964 
<a name="l13965"></a>13965   <span class="keywordflow">if</span> ((a == NULL) != (b == NULL))
<a name="l13966"></a>13966     <span class="keywordflow">return</span> 0;
<a name="l13967"></a>13967 
<a name="l13968"></a>13968   <span class="keywordflow">return</span> 1;
<a name="l13969"></a>13969 }
<a name="l13970"></a>13970 
<a name="l13971"></a>13971 <span class="comment">/* Create new breakpoint locations for B (a hardware or software breakpoint)</span>
<a name="l13972"></a>13972 <span class="comment">   based on SALS and SALS_END.  If SALS_END.NELTS is not zero, then B is</span>
<a name="l13973"></a>13973 <span class="comment">   a ranged breakpoint.  */</span>
<a name="l13974"></a>13974 
<a name="l13975"></a>13975 <span class="keywordtype">void</span>
<a name="l13976"></a><a class="code" href="breakpoint_8h.html#acaca095c56aea3e0694e412a65b447ce">13976</a> <a class="code" href="breakpoint_8c.html#acaca095c56aea3e0694e412a65b447ce">update_breakpoint_locations</a> (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b,
<a name="l13977"></a>13977                              <span class="keyword">struct</span> <a class="code" href="structsymtabs__and__lines.html">symtabs_and_lines</a> sals,
<a name="l13978"></a>13978                              <span class="keyword">struct</span> <a class="code" href="structsymtabs__and__lines.html">symtabs_and_lines</a> sals_end)
<a name="l13979"></a>13979 {
<a name="l13980"></a>13980   <span class="keywordtype">int</span> i;
<a name="l13981"></a>13981   <span class="keyword">struct </span>bp_location *existing_locations = b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>;
<a name="l13982"></a>13982 
<a name="l13983"></a>13983   <span class="keywordflow">if</span> (sals_end.<a class="code" href="structsymtabs__and__lines.html#a1c8b832fc2f8c096c95144a2acedd36a">nelts</a> != 0 &amp;&amp; (sals.<a class="code" href="structsymtabs__and__lines.html#a1c8b832fc2f8c096c95144a2acedd36a">nelts</a> != 1 || sals_end.<a class="code" href="structsymtabs__and__lines.html#a1c8b832fc2f8c096c95144a2acedd36a">nelts</a> != 1))
<a name="l13984"></a>13984     {
<a name="l13985"></a>13985       <span class="comment">/* Ranged breakpoints have only one start location and one end</span>
<a name="l13986"></a>13986 <span class="comment">         location.  */</span>
<a name="l13987"></a>13987       b-&gt;<a class="code" href="structbreakpoint.html#acb53352fd35aaad37054508fabc0f3bf">enable_state</a> = <a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577a4605f207d0d15bd8195c9b1aa1bfee96">bp_disabled</a>;
<a name="l13988"></a>13988       update_global_location_list (1);
<a name="l13989"></a>13989       <a class="code" href="utils_8c.html#ad57145632bbcb0361dc1dfa134b1efd0">printf_unfiltered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Could not reset ranged breakpoint %d: &quot;</span>
<a name="l13990"></a>13990                            <span class="stringliteral">&quot;multiple locations found\n&quot;</span>),
<a name="l13991"></a>13991                          b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>);
<a name="l13992"></a>13992       <span class="keywordflow">return</span>;
<a name="l13993"></a>13993     }
<a name="l13994"></a>13994 
<a name="l13995"></a>13995   <span class="comment">/* If there&#39;s no new locations, and all existing locations are</span>
<a name="l13996"></a>13996 <span class="comment">     pending, don&#39;t do anything.  This optimizes the common case where</span>
<a name="l13997"></a>13997 <span class="comment">     all locations are in the same shared library, that was unloaded.</span>
<a name="l13998"></a>13998 <span class="comment">     We&#39;d like to retain the location, so that when the library is</span>
<a name="l13999"></a>13999 <span class="comment">     loaded again, we don&#39;t loose the enabled/disabled status of the</span>
<a name="l14000"></a>14000 <span class="comment">     individual locations.  */</span>
<a name="l14001"></a>14001   <span class="keywordflow">if</span> (all_locations_are_pending (existing_locations) &amp;&amp; sals.<a class="code" href="structsymtabs__and__lines.html#a1c8b832fc2f8c096c95144a2acedd36a">nelts</a> == 0)
<a name="l14002"></a>14002     <span class="keywordflow">return</span>;
<a name="l14003"></a>14003 
<a name="l14004"></a>14004   b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a> = NULL;
<a name="l14005"></a>14005 
<a name="l14006"></a>14006   <span class="keywordflow">for</span> (i = 0; i &lt; sals.<a class="code" href="structsymtabs__and__lines.html#a1c8b832fc2f8c096c95144a2acedd36a">nelts</a>; ++i)
<a name="l14007"></a>14007     {
<a name="l14008"></a>14008       <span class="keyword">struct </span>bp_location *new_loc;
<a name="l14009"></a>14009 
<a name="l14010"></a>14010       <a class="code" href="progspace_8c.html#a58d979e46585ad85280e488204e0147e">switch_to_program_space_and_thread</a> (sals.<a class="code" href="structsymtabs__and__lines.html#ab601f48fdf29c3b190ba068f57983df4">sals</a>[i].<a class="code" href="structsymtab__and__line.html#acc91f0276f4648cb5a970f17ddcbaf09">pspace</a>);
<a name="l14011"></a>14011 
<a name="l14012"></a>14012       new_loc = add_location_to_breakpoint (b, &amp;(sals.<a class="code" href="structsymtabs__and__lines.html#ab601f48fdf29c3b190ba068f57983df4">sals</a>[i]));
<a name="l14013"></a>14013 
<a name="l14014"></a>14014       <span class="comment">/* Reparse conditions, they might contain references to the</span>
<a name="l14015"></a>14015 <span class="comment">         old symtab.  */</span>
<a name="l14016"></a>14016       <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#a817904eee4ded1a9e18ab46709c1245b">cond_string</a> != NULL)
<a name="l14017"></a>14017         {
<a name="l14018"></a>14018           <span class="keyword">const</span> <span class="keywordtype">char</span> *s;
<a name="l14019"></a>14019           <span class="keyword">volatile</span> <span class="keyword">struct </span><a class="code" href="structgdb__exception.html">gdb_exception</a> e;
<a name="l14020"></a>14020 
<a name="l14021"></a>14021           s = b-&gt;<a class="code" href="structbreakpoint.html#a817904eee4ded1a9e18ab46709c1245b">cond_string</a>;
<a name="l14022"></a>14022           <a class="code" href="exceptions_8h.html#aef4514ee39b9305fddee27f49c7c34eb">TRY_CATCH</a> (e, <a class="code" href="exceptions_8h.html#abfa3a3b99557b11f5766baf69465fdf6a44de51845416ac49ab08438792b908f0">RETURN_MASK_ERROR</a>)
<a name="l14023"></a>14023             {
<a name="l14024"></a>14024               new_loc-&gt;<a class="code" href="structbp__location.html#a1594433a0c3734e79b98d8296984ec7a">cond</a> = <a class="code" href="expression_8h.html#abdad295cc4b5351f6e6ec024ab665475">parse_exp_1</a> (&amp;s, sals.<a class="code" href="structsymtabs__and__lines.html#ab601f48fdf29c3b190ba068f57983df4">sals</a>[i].<a class="code" href="structsymtab__and__line.html#a77665fa461ad187cb755efa256ba44d7">pc</a>,
<a name="l14025"></a>14025                                            <a class="code" href="block_8c.html#a35aadf82f92cb4a47ec068dba0e1b36c">block_for_pc</a> (sals.<a class="code" href="structsymtabs__and__lines.html#ab601f48fdf29c3b190ba068f57983df4">sals</a>[i].<a class="code" href="structsymtab__and__line.html#a77665fa461ad187cb755efa256ba44d7">pc</a>), 
<a name="l14026"></a>14026                                            0);
<a name="l14027"></a>14027             }
<a name="l14028"></a>14028           <span class="keywordflow">if</span> (e.<a class="code" href="structgdb__exception.html#ae0e14189c63f830024865d557c1122cc">reason</a> &lt; 0)
<a name="l14029"></a>14029             {
<a name="l14030"></a>14030               <a class="code" href="utils_8c.html#a5fc201a4181499a6b4057a6caa15b5e2">warning</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;failed to reevaluate condition &quot;</span>
<a name="l14031"></a>14031                          <span class="stringliteral">&quot;for breakpoint %d: %s&quot;</span>), 
<a name="l14032"></a>14032                        b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>, e.<a class="code" href="structgdb__exception.html#a7f57f80c4d36200d121cee8cce513e5f">message</a>);
<a name="l14033"></a>14033               new_loc-&gt;<a class="code" href="structbp__location.html#abe93e091d18373d27bda3ad3eb6316f8">enabled</a> = 0;
<a name="l14034"></a>14034             }
<a name="l14035"></a>14035         }
<a name="l14036"></a>14036 
<a name="l14037"></a>14037       <span class="keywordflow">if</span> (sals_end.<a class="code" href="structsymtabs__and__lines.html#a1c8b832fc2f8c096c95144a2acedd36a">nelts</a>)
<a name="l14038"></a>14038         {
<a name="l14039"></a>14039           <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> end = find_breakpoint_range_end (sals_end.<a class="code" href="structsymtabs__and__lines.html#ab601f48fdf29c3b190ba068f57983df4">sals</a>[0]);
<a name="l14040"></a>14040 
<a name="l14041"></a>14041           new_loc-&gt;<a class="code" href="structbp__location.html#a3d4ad6914964554ca761607f9e8fab62">length</a> = end - sals.<a class="code" href="structsymtabs__and__lines.html#ab601f48fdf29c3b190ba068f57983df4">sals</a>[0].<a class="code" href="structsymtab__and__line.html#a77665fa461ad187cb755efa256ba44d7">pc</a> + 1;
<a name="l14042"></a>14042         }
<a name="l14043"></a>14043     }
<a name="l14044"></a>14044 
<a name="l14045"></a>14045   <span class="comment">/* Update locations of permanent breakpoints.  */</span>
<a name="l14046"></a>14046   <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#acb53352fd35aaad37054508fabc0f3bf">enable_state</a> == <a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577adbf2e9b210d33b1ac7e8a7ed87a2b46f">bp_permanent</a>)
<a name="l14047"></a>14047     <a class="code" href="breakpoint_8c.html#a23d7b67630cc8572e7c3dc83c7dd9fe2">make_breakpoint_permanent</a> (b);
<a name="l14048"></a>14048 
<a name="l14049"></a>14049   <span class="comment">/* If possible, carry over &#39;disable&#39; status from existing</span>
<a name="l14050"></a>14050 <span class="comment">     breakpoints.  */</span>
<a name="l14051"></a>14051   {
<a name="l14052"></a>14052     <span class="keyword">struct </span>bp_location *e = existing_locations;
<a name="l14053"></a>14053     <span class="comment">/* If there are multiple breakpoints with the same function name,</span>
<a name="l14054"></a>14054 <span class="comment">       e.g. for inline functions, comparing function names won&#39;t work.</span>
<a name="l14055"></a>14055 <span class="comment">       Instead compare pc addresses; this is just a heuristic as things</span>
<a name="l14056"></a>14056 <span class="comment">       may have moved, but in practice it gives the correct answer</span>
<a name="l14057"></a>14057 <span class="comment">       often enough until a better solution is found.  */</span>
<a name="l14058"></a>14058     <span class="keywordtype">int</span> have_ambiguous_names = ambiguous_names_p (b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>);
<a name="l14059"></a>14059 
<a name="l14060"></a>14060     <span class="keywordflow">for</span> (; e; e = e-&gt;<a class="code" href="structbp__location.html#ab193cb38f87fea89105db96d94191541">next</a>)
<a name="l14061"></a>14061       {
<a name="l14062"></a>14062         <span class="keywordflow">if</span> (!e-&gt;<a class="code" href="structbp__location.html#abe93e091d18373d27bda3ad3eb6316f8">enabled</a> &amp;&amp; e-&gt;<a class="code" href="structbp__location.html#aaaefbb59159defe719f775ae4fd0f7a7">function_name</a>)
<a name="l14063"></a>14063           {
<a name="l14064"></a>14064             <span class="keyword">struct </span>bp_location *l = b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>;
<a name="l14065"></a>14065             <span class="keywordflow">if</span> (have_ambiguous_names)
<a name="l14066"></a>14066               {
<a name="l14067"></a>14067                 <span class="keywordflow">for</span> (; l; l = l-&gt;<a class="code" href="structbp__location.html#ab193cb38f87fea89105db96d94191541">next</a>)
<a name="l14068"></a>14068                   <span class="keywordflow">if</span> (breakpoint_locations_match (e, l))
<a name="l14069"></a>14069                     {
<a name="l14070"></a>14070                       l-&gt;<a class="code" href="structbp__location.html#abe93e091d18373d27bda3ad3eb6316f8">enabled</a> = 0;
<a name="l14071"></a>14071                       <span class="keywordflow">break</span>;
<a name="l14072"></a>14072                     }
<a name="l14073"></a>14073               }
<a name="l14074"></a>14074             <span class="keywordflow">else</span>
<a name="l14075"></a>14075               {
<a name="l14076"></a>14076                 <span class="keywordflow">for</span> (; l; l = l-&gt;<a class="code" href="structbp__location.html#ab193cb38f87fea89105db96d94191541">next</a>)
<a name="l14077"></a>14077                   <span class="keywordflow">if</span> (l-&gt;<a class="code" href="structbp__location.html#aaaefbb59159defe719f775ae4fd0f7a7">function_name</a>
<a name="l14078"></a>14078                       &amp;&amp; strcmp (e-&gt;<a class="code" href="structbp__location.html#aaaefbb59159defe719f775ae4fd0f7a7">function_name</a>, l-&gt;<a class="code" href="structbp__location.html#aaaefbb59159defe719f775ae4fd0f7a7">function_name</a>) == 0)
<a name="l14079"></a>14079                     {
<a name="l14080"></a>14080                       l-&gt;<a class="code" href="structbp__location.html#abe93e091d18373d27bda3ad3eb6316f8">enabled</a> = 0;
<a name="l14081"></a>14081                       <span class="keywordflow">break</span>;
<a name="l14082"></a>14082                     }
<a name="l14083"></a>14083               }
<a name="l14084"></a>14084           }
<a name="l14085"></a>14085       }
<a name="l14086"></a>14086   }
<a name="l14087"></a>14087 
<a name="l14088"></a>14088   <span class="keywordflow">if</span> (!locations_are_equal (existing_locations, b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>))
<a name="l14089"></a>14089     <a class="code" href="observer_8h.html#a3edacfe44ac49f71646caded92072cad">observer_notify_breakpoint_modified</a> (b);
<a name="l14090"></a>14090 
<a name="l14091"></a>14091   update_global_location_list (1);
<a name="l14092"></a>14092 }
<a name="l14093"></a>14093 
<a name="l14094"></a>14094 <span class="comment">/* Find the SaL locations corresponding to the given ADDR_STRING.</span>
<a name="l14095"></a>14095 <span class="comment">   On return, FOUND will be 1 if any SaL was found, zero otherwise.  */</span>
<a name="l14096"></a>14096 
<a name="l14097"></a>14097 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structsymtabs__and__lines.html">symtabs_and_lines</a>
<a name="l14098"></a>14098 addr_string_to_sals (struct <a class="code" href="structbreakpoint.html">breakpoint</a> *b, <span class="keywordtype">char</span> *addr_string, <span class="keywordtype">int</span> *found)
<a name="l14099"></a>14099 {
<a name="l14100"></a>14100   <span class="keywordtype">char</span> *s;
<a name="l14101"></a>14101   <span class="keyword">struct </span><a class="code" href="structsymtabs__and__lines.html">symtabs_and_lines</a> sals = {0};
<a name="l14102"></a>14102   <span class="keyword">volatile</span> <span class="keyword">struct </span><a class="code" href="structgdb__exception.html">gdb_exception</a> e;
<a name="l14103"></a>14103 
<a name="l14104"></a>14104   <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (b-&gt;ops != NULL);
<a name="l14105"></a>14105   s = addr_string;
<a name="l14106"></a>14106 
<a name="l14107"></a>14107   <a class="code" href="exceptions_8h.html#aef4514ee39b9305fddee27f49c7c34eb">TRY_CATCH</a> (e, <a class="code" href="exceptions_8h.html#abfa3a3b99557b11f5766baf69465fdf6a44de51845416ac49ab08438792b908f0">RETURN_MASK_ERROR</a>)
<a name="l14108"></a>14108     {
<a name="l14109"></a>14109       b-&gt;ops-&gt;decode_linespec (b, &amp;s, &amp;sals);
<a name="l14110"></a>14110     }
<a name="l14111"></a>14111   <span class="keywordflow">if</span> (e.reason &lt; 0)
<a name="l14112"></a>14112     {
<a name="l14113"></a>14113       <span class="keywordtype">int</span> not_found_and_ok = 0;
<a name="l14114"></a>14114       <span class="comment">/* For pending breakpoints, it&#39;s expected that parsing will</span>
<a name="l14115"></a>14115 <span class="comment">         fail until the right shared library is loaded.  User has</span>
<a name="l14116"></a>14116 <span class="comment">         already told to create pending breakpoints and don&#39;t need</span>
<a name="l14117"></a>14117 <span class="comment">         extra messages.  If breakpoint is in bp_shlib_disabled</span>
<a name="l14118"></a>14118 <span class="comment">         state, then user already saw the message about that</span>
<a name="l14119"></a>14119 <span class="comment">         breakpoint being disabled, and don&#39;t want to see more</span>
<a name="l14120"></a>14120 <span class="comment">         errors.  */</span>
<a name="l14121"></a>14121       <span class="keywordflow">if</span> (e.error == <a class="code" href="exceptions_8h.html#acc42076253600be964e110149b458971a513a53522eb4741e8910f010e0ff9530">NOT_FOUND_ERROR</a>
<a name="l14122"></a>14122           &amp;&amp; (b-&gt;condition_not_parsed 
<a name="l14123"></a>14123               || (b-&gt;loc &amp;&amp; b-&gt;loc-&gt;shlib_disabled)
<a name="l14124"></a>14124               || (b-&gt;loc &amp;&amp; b-&gt;loc-&gt;pspace-&gt;executing_startup)
<a name="l14125"></a>14125               || b-&gt;enable_state == <a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577a4605f207d0d15bd8195c9b1aa1bfee96">bp_disabled</a>))
<a name="l14126"></a>14126         not_found_and_ok = 1;
<a name="l14127"></a>14127 
<a name="l14128"></a>14128       <span class="keywordflow">if</span> (!not_found_and_ok)
<a name="l14129"></a>14129         {
<a name="l14130"></a>14130           <span class="comment">/* We surely don&#39;t want to warn about the same breakpoint</span>
<a name="l14131"></a>14131 <span class="comment">             10 times.  One solution, implemented here, is disable</span>
<a name="l14132"></a>14132 <span class="comment">             the breakpoint on error.  Another solution would be to</span>
<a name="l14133"></a>14133 <span class="comment">             have separate &#39;warning emitted&#39; flag.  Since this</span>
<a name="l14134"></a>14134 <span class="comment">             happens only when a binary has changed, I don&#39;t know</span>
<a name="l14135"></a>14135 <span class="comment">             which approach is better.  */</span>
<a name="l14136"></a>14136           b-&gt;enable_state = <a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577a4605f207d0d15bd8195c9b1aa1bfee96">bp_disabled</a>;
<a name="l14137"></a>14137           <a class="code" href="exceptions_8c.html#a541d1b545da68efe4f8b729a945f83e7">throw_exception</a> (e);
<a name="l14138"></a>14138         }
<a name="l14139"></a>14139     }
<a name="l14140"></a>14140 
<a name="l14141"></a>14141   <span class="keywordflow">if</span> (e.reason == 0 || e.error != <a class="code" href="exceptions_8h.html#acc42076253600be964e110149b458971a513a53522eb4741e8910f010e0ff9530">NOT_FOUND_ERROR</a>)
<a name="l14142"></a>14142     {
<a name="l14143"></a>14143       <span class="keywordtype">int</span> i;
<a name="l14144"></a>14144 
<a name="l14145"></a>14145       <span class="keywordflow">for</span> (i = 0; i &lt; sals.<a class="code" href="structsymtabs__and__lines.html#a1c8b832fc2f8c096c95144a2acedd36a">nelts</a>; ++i)
<a name="l14146"></a>14146         <a class="code" href="breakpoint_8c.html#a4ca5af087eb50f4017f1eac8be554088">resolve_sal_pc</a> (&amp;sals.<a class="code" href="structsymtabs__and__lines.html#ab601f48fdf29c3b190ba068f57983df4">sals</a>[i]);
<a name="l14147"></a>14147       <span class="keywordflow">if</span> (b-&gt;condition_not_parsed &amp;&amp; s &amp;&amp; s[0])
<a name="l14148"></a>14148         {
<a name="l14149"></a>14149           <span class="keywordtype">char</span> *cond_string, *extra_string;
<a name="l14150"></a>14150           <span class="keywordtype">int</span> thread, task;
<a name="l14151"></a>14151 
<a name="l14152"></a>14152           find_condition_and_thread (s, sals.<a class="code" href="structsymtabs__and__lines.html#ab601f48fdf29c3b190ba068f57983df4">sals</a>[0].<a class="code" href="structsymtab__and__line.html#a77665fa461ad187cb755efa256ba44d7">pc</a>,
<a name="l14153"></a>14153                                      &amp;cond_string, &amp;thread, &amp;task,
<a name="l14154"></a>14154                                      &amp;extra_string);
<a name="l14155"></a>14155           <span class="keywordflow">if</span> (cond_string)
<a name="l14156"></a>14156             b-&gt;cond_string = cond_string;
<a name="l14157"></a>14157           b-&gt;thread = thread;
<a name="l14158"></a>14158           b-&gt;task = task;
<a name="l14159"></a>14159           <span class="keywordflow">if</span> (extra_string)
<a name="l14160"></a>14160             b-&gt;extra_string = extra_string;
<a name="l14161"></a>14161           b-&gt;condition_not_parsed = 0;
<a name="l14162"></a>14162         }
<a name="l14163"></a>14163 
<a name="l14164"></a>14164       <span class="keywordflow">if</span> (b-&gt;type == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfae4357544e8e764b68ef3729aa9ac2be3">bp_static_tracepoint</a> &amp;&amp; !strace_marker_p (b))
<a name="l14165"></a>14165         sals.<a class="code" href="structsymtabs__and__lines.html#ab601f48fdf29c3b190ba068f57983df4">sals</a>[0] = update_static_tracepoint (b, sals.<a class="code" href="structsymtabs__and__lines.html#ab601f48fdf29c3b190ba068f57983df4">sals</a>[0]);
<a name="l14166"></a>14166 
<a name="l14167"></a>14167       *found = 1;
<a name="l14168"></a>14168     }
<a name="l14169"></a>14169   <span class="keywordflow">else</span>
<a name="l14170"></a>14170     *found = 0;
<a name="l14171"></a>14171 
<a name="l14172"></a>14172   <span class="keywordflow">return</span> sals;
<a name="l14173"></a>14173 }
<a name="l14174"></a>14174 
<a name="l14175"></a>14175 <span class="comment">/* The default re_set method, for typical hardware or software</span>
<a name="l14176"></a>14176 <span class="comment">   breakpoints.  Reevaluate the breakpoint and recreate its</span>
<a name="l14177"></a>14177 <span class="comment">   locations.  */</span>
<a name="l14178"></a>14178 
<a name="l14179"></a>14179 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l14180"></a>14180 breakpoint_re_set_default (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b)
<a name="l14181"></a>14181 {
<a name="l14182"></a>14182   <span class="keywordtype">int</span> found;
<a name="l14183"></a>14183   <span class="keyword">struct </span><a class="code" href="structsymtabs__and__lines.html">symtabs_and_lines</a> sals, sals_end;
<a name="l14184"></a>14184   <span class="keyword">struct </span><a class="code" href="structsymtabs__and__lines.html">symtabs_and_lines</a> expanded = {0};
<a name="l14185"></a>14185   <span class="keyword">struct </span><a class="code" href="structsymtabs__and__lines.html">symtabs_and_lines</a> expanded_end = {0};
<a name="l14186"></a>14186 
<a name="l14187"></a>14187   sals = addr_string_to_sals (b, b-&gt;<a class="code" href="structbreakpoint.html#a885e704e5cdcfc314069b970c396d1a4">addr_string</a>, &amp;found);
<a name="l14188"></a>14188   <span class="keywordflow">if</span> (found)
<a name="l14189"></a>14189     {
<a name="l14190"></a>14190       <a class="code" href="cleanups_8c.html#a3d418f8af424aec399898c2d48b26224">make_cleanup</a> (<a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a>, sals.<a class="code" href="structsymtabs__and__lines.html#ab601f48fdf29c3b190ba068f57983df4">sals</a>);
<a name="l14191"></a>14191       expanded = <a class="code" href="structsymtabs__and__lines.html#ab601f48fdf29c3b190ba068f57983df4">sals</a>;
<a name="l14192"></a>14192     }
<a name="l14193"></a>14193 
<a name="l14194"></a>14194   <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#a0bad27f6d3009411fec7525ff7e309d5">addr_string_range_end</a>)
<a name="l14195"></a>14195     {
<a name="l14196"></a>14196       sals_end = addr_string_to_sals (b, b-&gt;<a class="code" href="structbreakpoint.html#a0bad27f6d3009411fec7525ff7e309d5">addr_string_range_end</a>, &amp;found);
<a name="l14197"></a>14197       <span class="keywordflow">if</span> (found)
<a name="l14198"></a>14198         {
<a name="l14199"></a>14199           <a class="code" href="cleanups_8c.html#a3d418f8af424aec399898c2d48b26224">make_cleanup</a> (<a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a>, sals_end.sals);
<a name="l14200"></a>14200           expanded_end = sals_end;
<a name="l14201"></a>14201         }
<a name="l14202"></a>14202     }
<a name="l14203"></a>14203 
<a name="l14204"></a>14204   <a class="code" href="breakpoint_8c.html#acaca095c56aea3e0694e412a65b447ce">update_breakpoint_locations</a> (b, expanded, expanded_end);
<a name="l14205"></a>14205 }
<a name="l14206"></a>14206 
<a name="l14207"></a>14207 <span class="comment">/* Default method for creating SALs from an address string.  It basically</span>
<a name="l14208"></a>14208 <span class="comment">   calls parse_breakpoint_sals.  Return 1 for success, zero for failure.  */</span>
<a name="l14209"></a>14209 
<a name="l14210"></a>14210 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l14211"></a>14211 create_sals_from_address_default (<span class="keywordtype">char</span> **arg,
<a name="l14212"></a>14212                                   <span class="keyword">struct</span> <a class="code" href="structlinespec__result.html">linespec_result</a> *canonical,
<a name="l14213"></a>14213                                   <span class="keyword">enum</span> bptype type_wanted,
<a name="l14214"></a>14214                                   <span class="keywordtype">char</span> *addr_start, <span class="keywordtype">char</span> **copy_arg)
<a name="l14215"></a>14215 {
<a name="l14216"></a>14216   parse_breakpoint_sals (arg, canonical);
<a name="l14217"></a>14217 }
<a name="l14218"></a>14218 
<a name="l14219"></a>14219 <span class="comment">/* Call create_breakpoints_sal for the given arguments.  This is the default</span>
<a name="l14220"></a>14220 <span class="comment">   function for the `create_breakpoints_sal&#39; method of</span>
<a name="l14221"></a>14221 <span class="comment">   breakpoint_ops.  */</span>
<a name="l14222"></a>14222 
<a name="l14223"></a>14223 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l14224"></a>14224 create_breakpoints_sal_default (<span class="keyword">struct</span> gdbarch *gdbarch,
<a name="l14225"></a>14225                                 <span class="keyword">struct</span> <a class="code" href="structlinespec__result.html">linespec_result</a> *canonical,
<a name="l14226"></a>14226                                 <span class="keywordtype">char</span> *cond_string,
<a name="l14227"></a>14227                                 <span class="keywordtype">char</span> *extra_string,
<a name="l14228"></a>14228                                 <span class="keyword">enum</span> bptype type_wanted,
<a name="l14229"></a>14229                                 <span class="keyword">enum</span> <a class="code" href="breakpoint_8h.html#a15f2bbd9012f59bc09d59feef0c15732">bpdisp</a> disposition,
<a name="l14230"></a>14230                                 <span class="keywordtype">int</span> thread,
<a name="l14231"></a>14231                                 <span class="keywordtype">int</span> task, <span class="keywordtype">int</span> ignore_count,
<a name="l14232"></a>14232                                 <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structbreakpoint__ops.html">breakpoint_ops</a> *ops,
<a name="l14233"></a>14233                                 <span class="keywordtype">int</span> from_tty, <span class="keywordtype">int</span> enabled,
<a name="l14234"></a>14234                                 <span class="keywordtype">int</span> <span class="keyword">internal</span>, <span class="keywordtype">unsigned</span> flags)
<a name="l14235"></a>14235 {
<a name="l14236"></a>14236   create_breakpoints_sal (gdbarch, canonical, cond_string,
<a name="l14237"></a>14237                           extra_string,
<a name="l14238"></a>14238                           type_wanted, disposition,
<a name="l14239"></a>14239                           thread, task, ignore_count, ops, from_tty,
<a name="l14240"></a>14240                           enabled, <span class="keyword">internal</span>, flags);
<a name="l14241"></a>14241 }
<a name="l14242"></a>14242 
<a name="l14243"></a>14243 <span class="comment">/* Decode the line represented by S by calling decode_line_full.  This is the</span>
<a name="l14244"></a>14244 <span class="comment">   default function for the `decode_linespec&#39; method of breakpoint_ops.  */</span>
<a name="l14245"></a>14245 
<a name="l14246"></a>14246 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l14247"></a>14247 decode_linespec_default (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b, <span class="keywordtype">char</span> **s,
<a name="l14248"></a>14248                          <span class="keyword">struct</span> <a class="code" href="structsymtabs__and__lines.html">symtabs_and_lines</a> *sals)
<a name="l14249"></a>14249 {
<a name="l14250"></a>14250   <span class="keyword">struct </span><a class="code" href="structlinespec__result.html">linespec_result</a> canonical;
<a name="l14251"></a>14251 
<a name="l14252"></a>14252   <a class="code" href="linespec_8c.html#a7264361d0a42e631634188c78dd8a96e">init_linespec_result</a> (&amp;canonical);
<a name="l14253"></a>14253   <a class="code" href="linespec_8c.html#af57ff2f3f7a08d8b7f1d8c1fb3f24e12">decode_line_full</a> (s, <a class="code" href="linespec_8h.html#a66db0c56cdf6b7d07a996c374a0572caadb5b3965c89f02bfa79f8871fde72588">DECODE_LINE_FUNFIRSTLINE</a>,
<a name="l14254"></a>14254                     (<span class="keyword">struct</span> <a class="code" href="structsymtab.html">symtab</a> *) NULL, 0,
<a name="l14255"></a>14255                     &amp;canonical, <a class="code" href="symtab_8c.html#a2457c524e394ad239661c86ceedb99a7">multiple_symbols_all</a>,
<a name="l14256"></a>14256                     b-&gt;<a class="code" href="structbreakpoint.html#a2b1a690827488a6b2385d72d9dc857a0">filter</a>);
<a name="l14257"></a>14257 
<a name="l14258"></a>14258   <span class="comment">/* We should get 0 or 1 resulting SALs.  */</span>
<a name="l14259"></a>14259   <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (<a class="code" href="vec_8h.html#a844523bba6d0565ef73a0f4a63e48d19">VEC_length</a> (<a class="code" href="structlinespec__sals.html">linespec_sals</a>, canonical.sals) &lt; 2);
<a name="l14260"></a>14260 
<a name="l14261"></a>14261   <span class="keywordflow">if</span> (<a class="code" href="vec_8h.html#a844523bba6d0565ef73a0f4a63e48d19">VEC_length</a> (<a class="code" href="structlinespec__sals.html">linespec_sals</a>, canonical.sals) &gt; 0)
<a name="l14262"></a>14262     {
<a name="l14263"></a>14263       <span class="keyword">struct </span><a class="code" href="structlinespec__sals.html">linespec_sals</a> *lsal;
<a name="l14264"></a>14264 
<a name="l14265"></a>14265       lsal = <a class="code" href="vec_8h.html#a49c128c353995ea8fca27be70829ca52">VEC_index</a> (<a class="code" href="structlinespec__sals.html">linespec_sals</a>, canonical.sals, 0);
<a name="l14266"></a>14266       *sals = lsal-&gt;<a class="code" href="structlinespec__sals.html#a34ac2e438b2835722c998f409c85dcee">sals</a>;
<a name="l14267"></a>14267       <span class="comment">/* Arrange it so the destructor does not free the</span>
<a name="l14268"></a>14268 <span class="comment">         contents.  */</span>
<a name="l14269"></a>14269       lsal-&gt;<a class="code" href="structlinespec__sals.html#a34ac2e438b2835722c998f409c85dcee">sals</a>.<a class="code" href="structsymtabs__and__lines.html#ab601f48fdf29c3b190ba068f57983df4">sals</a> = NULL;
<a name="l14270"></a>14270     }
<a name="l14271"></a>14271 
<a name="l14272"></a>14272   <a class="code" href="linespec_8c.html#a414e9a3f3213cb2db079a126177024bb">destroy_linespec_result</a> (&amp;canonical);
<a name="l14273"></a>14273 }
<a name="l14274"></a>14274 
<a name="l14275"></a>14275 <span class="comment">/* Prepare the global context for a re-set of breakpoint B.  */</span>
<a name="l14276"></a>14276 
<a name="l14277"></a>14277 <span class="keyword">static</span> <span class="keyword">struct </span>cleanup *
<a name="l14278"></a>14278 prepare_re_set_context (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b)
<a name="l14279"></a>14279 {
<a name="l14280"></a>14280   <span class="keyword">struct </span>cleanup *cleanups;
<a name="l14281"></a>14281 
<a name="l14282"></a>14282   <a class="code" href="defs_8h.html#a64e476dca2e961ebe24ba32289c77c4e">input_radix</a> = b-&gt;<a class="code" href="structbreakpoint.html#acdacf7dbb73ba99f07e19f32e2d389d1">input_radix</a>;
<a name="l14283"></a>14283   cleanups = <a class="code" href="progspace_8c.html#a6326460454db4e192e2bc221cb322977">save_current_space_and_thread</a> ();
<a name="l14284"></a>14284   <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#a82f4fd8ee6ddee61f3529fbd747c78b2">pspace</a> != NULL)
<a name="l14285"></a>14285     <a class="code" href="progspace_8c.html#a58d979e46585ad85280e488204e0147e">switch_to_program_space_and_thread</a> (b-&gt;<a class="code" href="structbreakpoint.html#a82f4fd8ee6ddee61f3529fbd747c78b2">pspace</a>);
<a name="l14286"></a>14286   <a class="code" href="language_8c.html#a87176c846a3ec717ada5e5622fe18550">set_language</a> (b-&gt;<a class="code" href="structbreakpoint.html#adb277de5c8fe68b963cd04aefab977e7">language</a>);
<a name="l14287"></a>14287 
<a name="l14288"></a>14288   <span class="keywordflow">return</span> cleanups;
<a name="l14289"></a>14289 }
<a name="l14290"></a>14290 
<a name="l14291"></a>14291 <span class="comment">/* Reset a breakpoint given it&#39;s struct breakpoint * BINT.</span>
<a name="l14292"></a>14292 <span class="comment">   The value we return ends up being the return value from catch_errors.</span>
<a name="l14293"></a>14293 <span class="comment">   Unused in this case.  */</span>
<a name="l14294"></a>14294 
<a name="l14295"></a>14295 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l14296"></a>14296 breakpoint_re_set_one (<span class="keywordtype">void</span> *bint)
<a name="l14297"></a>14297 {
<a name="l14298"></a>14298   <span class="comment">/* Get past catch_errs.  */</span>
<a name="l14299"></a>14299   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b = (<span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *) bint;
<a name="l14300"></a>14300   <span class="keyword">struct </span>cleanup *cleanups;
<a name="l14301"></a>14301 
<a name="l14302"></a>14302   cleanups = prepare_re_set_context (b);
<a name="l14303"></a>14303   b-&gt;<a class="code" href="structbreakpoint.html#aba258aa23496f6434aaa1cf8c8dc7ea7">ops</a>-&gt;<a class="code" href="structbreakpoint__ops.html#a42f6ff20f3eb39f78874c914d34e09b5">re_set</a> (b);
<a name="l14304"></a>14304   <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (cleanups);
<a name="l14305"></a>14305   <span class="keywordflow">return</span> 0;
<a name="l14306"></a>14306 }
<a name="l14307"></a>14307 
<a name="l14308"></a>14308 <span class="comment">/* Re-set all breakpoints after symbols have been re-loaded.  */</span>
<a name="l14309"></a>14309 <span class="keywordtype">void</span>
<a name="l14310"></a><a class="code" href="breakpoint_8h.html#a04a0dfc2bda60f172d9e76df4fe6187f">14310</a> <a class="code" href="breakpoint_8c.html#a04a0dfc2bda60f172d9e76df4fe6187f">breakpoint_re_set</a> (<span class="keywordtype">void</span>)
<a name="l14311"></a>14311 {
<a name="l14312"></a>14312   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b, *b_tmp;
<a name="l14313"></a>14313   <span class="keyword">enum</span> <a class="code" href="defs_8h.html#aa37aa8979934d47ac32fd96ecff32202">language</a> save_language;
<a name="l14314"></a>14314   <span class="keywordtype">int</span> save_input_radix;
<a name="l14315"></a>14315   <span class="keyword">struct </span>cleanup *old_chain;
<a name="l14316"></a>14316 
<a name="l14317"></a>14317   save_language = <a class="code" href="language_8c.html#acd2505a014a95629da9c836f8914fc79">current_language</a>-&gt;<a class="code" href="structlanguage__defn.html#a1395b7eb05a09e5798dc29257f30810a">la_language</a>;
<a name="l14318"></a>14318   save_input_radix = <a class="code" href="defs_8h.html#a64e476dca2e961ebe24ba32289c77c4e">input_radix</a>;
<a name="l14319"></a>14319   old_chain = <a class="code" href="progspace_8c.html#a702df4a5aa34e81fc0bb38dd8c2d68df">save_current_program_space</a> ();
<a name="l14320"></a>14320 
<a name="l14321"></a>14321   <a class="code" href="breakpoint_8c.html#ace15af58ae54149fbef6d72ecb61e12d">ALL_BREAKPOINTS_SAFE</a> (b, b_tmp)
<a name="l14322"></a>14322   {
<a name="l14323"></a>14323     <span class="comment">/* Format possible error msg.  */</span>
<a name="l14324"></a>14324     <span class="keywordtype">char</span> *message = <a class="code" href="common-utils_8c.html#ab9bf7e1b4e68bdd0078e9e1e55c62cec">xstrprintf</a> (<span class="stringliteral">&quot;Error in re-setting breakpoint %d: &quot;</span>,
<a name="l14325"></a>14325                                 b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>);
<a name="l14326"></a>14326     <span class="keyword">struct </span>cleanup *cleanups = <a class="code" href="cleanups_8c.html#a3d418f8af424aec399898c2d48b26224">make_cleanup</a> (<a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a>, message);
<a name="l14327"></a>14327     <a class="code" href="exceptions_8c.html#ad6275ae3cd191f69dd2fe540f138cb2d">catch_errors</a> (breakpoint_re_set_one, b, message, <a class="code" href="exceptions_8h.html#abfa3a3b99557b11f5766baf69465fdf6ab50fde886a7de8c013bf2bd4e7c073a4">RETURN_MASK_ALL</a>);
<a name="l14328"></a>14328     <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (cleanups);
<a name="l14329"></a>14329   }
<a name="l14330"></a>14330   <a class="code" href="language_8c.html#a87176c846a3ec717ada5e5622fe18550">set_language</a> (save_language);
<a name="l14331"></a>14331   <a class="code" href="defs_8h.html#a64e476dca2e961ebe24ba32289c77c4e">input_radix</a> = save_input_radix;
<a name="l14332"></a>14332 
<a name="l14333"></a>14333   <a class="code" href="jit_8c.html#a92c04c4728e9782c8ac138ff543ac272">jit_breakpoint_re_set</a> ();
<a name="l14334"></a>14334 
<a name="l14335"></a>14335   <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (old_chain);
<a name="l14336"></a>14336 
<a name="l14337"></a>14337   create_overlay_event_breakpoint ();
<a name="l14338"></a>14338   create_longjmp_master_breakpoint ();
<a name="l14339"></a>14339   create_std_terminate_master_breakpoint ();
<a name="l14340"></a>14340   create_exception_master_breakpoint ();
<a name="l14341"></a>14341 }
<a name="l14342"></a>14342 
<a name="l14343"></a>14343 <span class="comment">/* Reset the thread number of this breakpoint:</span>
<a name="l14344"></a>14344 <span class="comment"></span>
<a name="l14345"></a>14345 <span class="comment">   - If the breakpoint is for all threads, leave it as-is.</span>
<a name="l14346"></a>14346 <span class="comment">   - Else, reset it to the current thread for inferior_ptid.  */</span>
<a name="l14347"></a>14347 <span class="keywordtype">void</span>
<a name="l14348"></a><a class="code" href="breakpoint_8h.html#a20d025aaf30b775f3f505c61c663d6e5">14348</a> <a class="code" href="breakpoint_8c.html#a292b61ede8fb53fd2282d61a6db12282">breakpoint_re_set_thread</a> (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b)
<a name="l14349"></a>14349 {
<a name="l14350"></a>14350   <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#ae8613b6d8cf464f30ea39597be0cc192">thread</a> != -1)
<a name="l14351"></a>14351     {
<a name="l14352"></a>14352       <span class="keywordflow">if</span> (<a class="code" href="gdbthread_8h.html#a75cff5779f03e4119723fd41a5583fa7">in_thread_list</a> (<a class="code" href="infcmd_8c.html#a428c5be9ce5e70bd03760e828e19c6b7">inferior_ptid</a>))
<a name="l14353"></a>14353         b-&gt;<a class="code" href="structbreakpoint.html#ae8613b6d8cf464f30ea39597be0cc192">thread</a> = <a class="code" href="gdbthread_8h.html#a3dbd3518561f91d8aa7621a65d39f305">pid_to_thread_id</a> (<a class="code" href="infcmd_8c.html#a428c5be9ce5e70bd03760e828e19c6b7">inferior_ptid</a>);
<a name="l14354"></a>14354 
<a name="l14355"></a>14355       <span class="comment">/* We&#39;re being called after following a fork.  The new fork is</span>
<a name="l14356"></a>14356 <span class="comment">         selected as current, and unless this was a vfork will have a</span>
<a name="l14357"></a>14357 <span class="comment">         different program space from the original thread.  Reset that</span>
<a name="l14358"></a>14358 <span class="comment">         as well.  */</span>
<a name="l14359"></a>14359       b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>-&gt;<a class="code" href="structbp__location.html#a0d597e3dbf754a5b8a3d0d84425de77d">pspace</a> = <a class="code" href="progspace_8c.html#a07722ff15a98814c086dda44f93380c9">current_program_space</a>;
<a name="l14360"></a>14360     }
<a name="l14361"></a>14361 }
<a name="l14362"></a>14362 
<a name="l14363"></a>14363 <span class="comment">/* Set ignore-count of breakpoint number BPTNUM to COUNT.</span>
<a name="l14364"></a>14364 <span class="comment">   If from_tty is nonzero, it prints a message to that effect,</span>
<a name="l14365"></a>14365 <span class="comment">   which ends with a period (no newline).  */</span>
<a name="l14366"></a>14366 
<a name="l14367"></a>14367 <span class="keywordtype">void</span>
<a name="l14368"></a><a class="code" href="breakpoint_8h.html#afb713c14975bfcb2aae86c9e459e3824">14368</a> <a class="code" href="breakpoint_8c.html#aa9296315228b8b0add61792b4086cef6">set_ignore_count</a> (<span class="keywordtype">int</span> bptnum, <span class="keywordtype">int</span> count, <span class="keywordtype">int</span> from_tty)
<a name="l14369"></a>14369 {
<a name="l14370"></a>14370   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b;
<a name="l14371"></a>14371 
<a name="l14372"></a>14372   <span class="keywordflow">if</span> (count &lt; 0)
<a name="l14373"></a>14373     count = 0;
<a name="l14374"></a>14374 
<a name="l14375"></a>14375   <a class="code" href="breakpoint_8c.html#a781d5d3dc50a92364edfbacac3d0c107">ALL_BREAKPOINTS</a> (b)
<a name="l14376"></a>14376     <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a> == bptnum)
<a name="l14377"></a>14377     {
<a name="l14378"></a>14378       <span class="keywordflow">if</span> (<a class="code" href="breakpoint_8c.html#ac537492fb781218601862c78225bd118">is_tracepoint</a> (b))
<a name="l14379"></a>14379         {
<a name="l14380"></a>14380           <span class="keywordflow">if</span> (from_tty &amp;&amp; count != 0)
<a name="l14381"></a>14381             <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Ignore count ignored for tracepoint %d.&quot;</span>),
<a name="l14382"></a>14382                              bptnum);
<a name="l14383"></a>14383           <span class="keywordflow">return</span>;
<a name="l14384"></a>14384         }
<a name="l14385"></a>14385       
<a name="l14386"></a>14386       b-&gt;<a class="code" href="structbreakpoint.html#a0e1286b838f13a04031a220f81c04d2d">ignore_count</a> = count;
<a name="l14387"></a>14387       <span class="keywordflow">if</span> (from_tty)
<a name="l14388"></a>14388         {
<a name="l14389"></a>14389           <span class="keywordflow">if</span> (count == 0)
<a name="l14390"></a>14390             <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Will stop next time &quot;</span>
<a name="l14391"></a>14391                                <span class="stringliteral">&quot;breakpoint %d is reached.&quot;</span>),
<a name="l14392"></a>14392                              bptnum);
<a name="l14393"></a>14393           <span class="keywordflow">else</span> <span class="keywordflow">if</span> (count == 1)
<a name="l14394"></a>14394             <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Will ignore next crossing of breakpoint %d.&quot;</span>),
<a name="l14395"></a>14395                              bptnum);
<a name="l14396"></a>14396           <span class="keywordflow">else</span>
<a name="l14397"></a>14397             <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Will ignore next %d &quot;</span>
<a name="l14398"></a>14398                                <span class="stringliteral">&quot;crossings of breakpoint %d.&quot;</span>),
<a name="l14399"></a>14399                              count, bptnum);
<a name="l14400"></a>14400         }
<a name="l14401"></a>14401       <a class="code" href="observer_8h.html#a3edacfe44ac49f71646caded92072cad">observer_notify_breakpoint_modified</a> (b);
<a name="l14402"></a>14402       <span class="keywordflow">return</span>;
<a name="l14403"></a>14403     }
<a name="l14404"></a>14404 
<a name="l14405"></a>14405   <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;No breakpoint number %d.&quot;</span>), bptnum);
<a name="l14406"></a>14406 }
<a name="l14407"></a>14407 
<a name="l14408"></a>14408 <span class="comment">/* Command to set ignore-count of breakpoint N to COUNT.  */</span>
<a name="l14409"></a>14409 
<a name="l14410"></a>14410 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l14411"></a>14411 ignore_command (<span class="keywordtype">char</span> *args, <span class="keywordtype">int</span> from_tty)
<a name="l14412"></a>14412 {
<a name="l14413"></a>14413   <span class="keywordtype">char</span> *p = args;
<a name="l14414"></a>14414   <span class="keywordtype">int</span> num;
<a name="l14415"></a>14415 
<a name="l14416"></a>14416   <span class="keywordflow">if</span> (p == 0)
<a name="l14417"></a>14417     <a class="code" href="cli-cmds_8c.html#a68aef78cdf72abc9df2495a4618842c3">error_no_arg</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;a breakpoint number&quot;</span>));
<a name="l14418"></a>14418 
<a name="l14419"></a>14419   num = <a class="code" href="cli-utils_8c.html#a90dc5fbdc073138a035cd142f0739e8b">get_number</a> (&amp;p);
<a name="l14420"></a>14420   <span class="keywordflow">if</span> (num == 0)
<a name="l14421"></a>14421     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;bad breakpoint number: &#39;%s&#39;&quot;</span>), args);
<a name="l14422"></a>14422   <span class="keywordflow">if</span> (*p == 0)
<a name="l14423"></a>14423     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Second argument (specified ignore-count) is missing.&quot;</span>));
<a name="l14424"></a>14424 
<a name="l14425"></a>14425   <a class="code" href="breakpoint_8c.html#aa9296315228b8b0add61792b4086cef6">set_ignore_count</a> (num,
<a name="l14426"></a>14426                     <a class="code" href="defs_8h.html#a6e860bbd0169e0686e0a559410a7e02e">longest_to_int</a> (<a class="code" href="value_8c.html#aa95e2692a6e5338edb5db75909064bc1">value_as_long</a> (<a class="code" href="eval_8c.html#a4e744c8c383f947f6e3da4112541c2f7">parse_and_eval</a> (p))),
<a name="l14427"></a>14427                     from_tty);
<a name="l14428"></a>14428   <span class="keywordflow">if</span> (from_tty)
<a name="l14429"></a>14429     <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l14430"></a>14430 }
<a name="l14431"></a>14431 
<a name="l14432"></a>14432 <span class="comment">/* Call FUNCTION on each of the breakpoints</span>
<a name="l14433"></a>14433 <span class="comment">   whose numbers are given in ARGS.  */</span>
<a name="l14434"></a>14434 
<a name="l14435"></a>14435 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l14436"></a>14436 map_breakpoint_numbers (<span class="keywordtype">char</span> *args, <span class="keywordtype">void</span> (*<span class="keyword">function</span>) (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *,
<a name="l14437"></a>14437                                                       <span class="keywordtype">void</span> *),
<a name="l14438"></a>14438                         <span class="keywordtype">void</span> *data)
<a name="l14439"></a>14439 {
<a name="l14440"></a>14440   <span class="keywordtype">int</span> num;
<a name="l14441"></a>14441   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b, *tmp;
<a name="l14442"></a>14442   <span class="keywordtype">int</span> match;
<a name="l14443"></a>14443   <span class="keyword">struct </span><a class="code" href="structget__number__or__range__state.html">get_number_or_range_state</a> state;
<a name="l14444"></a>14444 
<a name="l14445"></a>14445   <span class="keywordflow">if</span> (args == 0)
<a name="l14446"></a>14446     <a class="code" href="cli-cmds_8c.html#a68aef78cdf72abc9df2495a4618842c3">error_no_arg</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;one or more breakpoint numbers&quot;</span>));
<a name="l14447"></a>14447 
<a name="l14448"></a>14448   <a class="code" href="cli-utils_8c.html#a8c5a78ced74fbfc685ab08664c47fa9b">init_number_or_range</a> (&amp;state, args);
<a name="l14449"></a>14449 
<a name="l14450"></a>14450   <span class="keywordflow">while</span> (!state.finished)
<a name="l14451"></a>14451     {
<a name="l14452"></a>14452       <span class="keywordtype">char</span> *p = state.string;
<a name="l14453"></a>14453 
<a name="l14454"></a>14454       match = 0;
<a name="l14455"></a>14455 
<a name="l14456"></a>14456       num = <a class="code" href="cli-utils_8c.html#a6d6bbeb272a5fb5ac91e7e2a20e54fef">get_number_or_range</a> (&amp;state);
<a name="l14457"></a>14457       <span class="keywordflow">if</span> (num == 0)
<a name="l14458"></a>14458         {
<a name="l14459"></a>14459           <a class="code" href="utils_8c.html#a5fc201a4181499a6b4057a6caa15b5e2">warning</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;bad breakpoint number at or near &#39;%s&#39;&quot;</span>), p);
<a name="l14460"></a>14460         }
<a name="l14461"></a>14461       <span class="keywordflow">else</span>
<a name="l14462"></a>14462         {
<a name="l14463"></a>14463           <a class="code" href="breakpoint_8c.html#ace15af58ae54149fbef6d72ecb61e12d">ALL_BREAKPOINTS_SAFE</a> (b, tmp)
<a name="l14464"></a>14464             if (b-&gt;number == num)
<a name="l14465"></a>14465               {
<a name="l14466"></a>14466                 match = 1;
<a name="l14467"></a>14467                 <span class="keyword">function</span> (b, data);
<a name="l14468"></a>14468                 <span class="keywordflow">break</span>;
<a name="l14469"></a>14469               }
<a name="l14470"></a>14470           <span class="keywordflow">if</span> (match == 0)
<a name="l14471"></a>14471             <a class="code" href="utils_8c.html#ad57145632bbcb0361dc1dfa134b1efd0">printf_unfiltered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;No breakpoint number %d.\n&quot;</span>), num);
<a name="l14472"></a>14472         }
<a name="l14473"></a>14473     }
<a name="l14474"></a>14474 }
<a name="l14475"></a>14475 
<a name="l14476"></a>14476 <span class="keyword">static</span> <span class="keyword">struct </span>bp_location *
<a name="l14477"></a>14477 find_location_by_number (<span class="keywordtype">char</span> *number)
<a name="l14478"></a>14478 {
<a name="l14479"></a>14479   <span class="keywordtype">char</span> *dot = <a class="code" href="gdb__string_8h.html#adf46aa8f2e08cfb505868bbfc88b5fd4">strchr</a> (number, <span class="charliteral">&#39;.&#39;</span>);
<a name="l14480"></a>14480   <span class="keywordtype">char</span> *p1;
<a name="l14481"></a>14481   <span class="keywordtype">int</span> bp_num;
<a name="l14482"></a>14482   <span class="keywordtype">int</span> loc_num;
<a name="l14483"></a>14483   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b;
<a name="l14484"></a>14484   <span class="keyword">struct </span>bp_location *loc;  
<a name="l14485"></a>14485 
<a name="l14486"></a>14486   *dot = <span class="charliteral">&#39;\0&#39;</span>;
<a name="l14487"></a>14487 
<a name="l14488"></a>14488   p1 = number;
<a name="l14489"></a>14489   bp_num = <a class="code" href="cli-utils_8c.html#a90dc5fbdc073138a035cd142f0739e8b">get_number</a> (&amp;p1);
<a name="l14490"></a>14490   <span class="keywordflow">if</span> (bp_num == 0)
<a name="l14491"></a>14491     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Bad breakpoint number &#39;%s&#39;&quot;</span>), number);
<a name="l14492"></a>14492 
<a name="l14493"></a>14493   <a class="code" href="breakpoint_8c.html#a781d5d3dc50a92364edfbacac3d0c107">ALL_BREAKPOINTS</a> (b)
<a name="l14494"></a>14494     if (b-&gt;number == bp_num)
<a name="l14495"></a>14495       {
<a name="l14496"></a>14496         <span class="keywordflow">break</span>;
<a name="l14497"></a>14497       }
<a name="l14498"></a>14498 
<a name="l14499"></a>14499   <span class="keywordflow">if</span> (!b || b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a> != bp_num)
<a name="l14500"></a>14500     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Bad breakpoint number &#39;%s&#39;&quot;</span>), number);
<a name="l14501"></a>14501   
<a name="l14502"></a>14502   p1 = dot+1;
<a name="l14503"></a>14503   loc_num = <a class="code" href="cli-utils_8c.html#a90dc5fbdc073138a035cd142f0739e8b">get_number</a> (&amp;p1);
<a name="l14504"></a>14504   <span class="keywordflow">if</span> (loc_num == 0)
<a name="l14505"></a>14505     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Bad breakpoint location number &#39;%s&#39;&quot;</span>), number);
<a name="l14506"></a>14506 
<a name="l14507"></a>14507   --loc_num;
<a name="l14508"></a>14508   loc = b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>;
<a name="l14509"></a>14509   <span class="keywordflow">for</span> (;loc_num &amp;&amp; loc; --loc_num, loc = loc-&gt;<a class="code" href="structbp__location.html#ab193cb38f87fea89105db96d94191541">next</a>)
<a name="l14510"></a>14510     ;
<a name="l14511"></a>14511   <span class="keywordflow">if</span> (!loc)
<a name="l14512"></a>14512     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Bad breakpoint location number &#39;%s&#39;&quot;</span>), dot+1);
<a name="l14513"></a>14513     
<a name="l14514"></a>14514   <span class="keywordflow">return</span> loc;  
<a name="l14515"></a>14515 }
<a name="l14516"></a>14516 
<a name="l14517"></a>14517 
<a name="l14518"></a>14518 <span class="comment">/* Set ignore-count of breakpoint number BPTNUM to COUNT.</span>
<a name="l14519"></a>14519 <span class="comment">   If from_tty is nonzero, it prints a message to that effect,</span>
<a name="l14520"></a>14520 <span class="comment">   which ends with a period (no newline).  */</span>
<a name="l14521"></a>14521 
<a name="l14522"></a>14522 <span class="keywordtype">void</span>
<a name="l14523"></a><a class="code" href="breakpoint_8h.html#acedf59ecf1744fecb055f135a745da4e">14523</a> <a class="code" href="breakpoint_8c.html#a78b8032b510154e6246e59cfd7d6d9be">disable_breakpoint</a> (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *bpt)
<a name="l14524"></a>14524 {
<a name="l14525"></a>14525   <span class="comment">/* Never disable a watchpoint scope breakpoint; we want to</span>
<a name="l14526"></a>14526 <span class="comment">     hit them when we leave scope so we can delete both the</span>
<a name="l14527"></a>14527 <span class="comment">     watchpoint and its scope breakpoint at that time.  */</span>
<a name="l14528"></a>14528   <span class="keywordflow">if</span> (bpt-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfad6bfd2f2654949462085c78f02480366">bp_watchpoint_scope</a>)
<a name="l14529"></a>14529     <span class="keywordflow">return</span>;
<a name="l14530"></a>14530 
<a name="l14531"></a>14531   <span class="comment">/* You can&#39;t disable permanent breakpoints.  */</span>
<a name="l14532"></a>14532   <span class="keywordflow">if</span> (bpt-&gt;<a class="code" href="structbreakpoint.html#acb53352fd35aaad37054508fabc0f3bf">enable_state</a> == <a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577adbf2e9b210d33b1ac7e8a7ed87a2b46f">bp_permanent</a>)
<a name="l14533"></a>14533     <span class="keywordflow">return</span>;
<a name="l14534"></a>14534 
<a name="l14535"></a>14535   bpt-&gt;<a class="code" href="structbreakpoint.html#acb53352fd35aaad37054508fabc0f3bf">enable_state</a> = <a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577a4605f207d0d15bd8195c9b1aa1bfee96">bp_disabled</a>;
<a name="l14536"></a>14536 
<a name="l14537"></a>14537   <span class="comment">/* Mark breakpoint locations modified.  */</span>
<a name="l14538"></a>14538   mark_breakpoint_modified (bpt);
<a name="l14539"></a>14539 
<a name="l14540"></a>14540   <span class="keywordflow">if</span> (<a class="code" href="target_8h.html#ab7943bd804233ce9d742037eb6398579">target_supports_enable_disable_tracepoint</a> ()
<a name="l14541"></a>14541       &amp;&amp; <a class="code" href="tracepoint_8c.html#af4041987a9ba21b88378bb6a3873baca">current_trace_status</a> ()-&gt;running &amp;&amp; <a class="code" href="breakpoint_8c.html#ac537492fb781218601862c78225bd118">is_tracepoint</a> (bpt))
<a name="l14542"></a>14542     {
<a name="l14543"></a>14543       <span class="keyword">struct </span>bp_location *location;
<a name="l14544"></a>14544      
<a name="l14545"></a>14545       <span class="keywordflow">for</span> (location = bpt-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>; location; location = location-&gt;<a class="code" href="structbp__location.html#ab193cb38f87fea89105db96d94191541">next</a>)
<a name="l14546"></a>14546         <a class="code" href="target_8h.html#a1cea3310d44ec81d08890ad35f2c0868">target_disable_tracepoint</a> (location);
<a name="l14547"></a>14547     }
<a name="l14548"></a>14548 
<a name="l14549"></a>14549   update_global_location_list (0);
<a name="l14550"></a>14550 
<a name="l14551"></a>14551   <a class="code" href="observer_8h.html#a3edacfe44ac49f71646caded92072cad">observer_notify_breakpoint_modified</a> (bpt);
<a name="l14552"></a>14552 }
<a name="l14553"></a>14553 
<a name="l14554"></a>14554 <span class="comment">/* A callback for iterate_over_related_breakpoints.  */</span>
<a name="l14555"></a>14555 
<a name="l14556"></a>14556 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l14557"></a>14557 do_disable_breakpoint (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b, <span class="keywordtype">void</span> *ignore)
<a name="l14558"></a>14558 {
<a name="l14559"></a>14559   <a class="code" href="breakpoint_8c.html#a78b8032b510154e6246e59cfd7d6d9be">disable_breakpoint</a> (b);
<a name="l14560"></a>14560 }
<a name="l14561"></a>14561 
<a name="l14562"></a>14562 <span class="comment">/* A callback for map_breakpoint_numbers that calls</span>
<a name="l14563"></a>14563 <span class="comment">   disable_breakpoint.  */</span>
<a name="l14564"></a>14564 
<a name="l14565"></a>14565 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l14566"></a>14566 do_map_disable_breakpoint (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b, <span class="keywordtype">void</span> *ignore)
<a name="l14567"></a>14567 {
<a name="l14568"></a>14568   iterate_over_related_breakpoints (b, do_disable_breakpoint, NULL);
<a name="l14569"></a>14569 }
<a name="l14570"></a>14570 
<a name="l14571"></a>14571 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l14572"></a>14572 disable_command (<span class="keywordtype">char</span> *args, <span class="keywordtype">int</span> from_tty)
<a name="l14573"></a>14573 {
<a name="l14574"></a>14574   <span class="keywordflow">if</span> (args == 0)
<a name="l14575"></a>14575     {
<a name="l14576"></a>14576       <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *bpt;
<a name="l14577"></a>14577 
<a name="l14578"></a>14578       <a class="code" href="breakpoint_8c.html#a781d5d3dc50a92364edfbacac3d0c107">ALL_BREAKPOINTS</a> (bpt)
<a name="l14579"></a>14579         if (<a class="code" href="breakpoint_8c.html#ac7893fb93c9f1d907b89a1655481602d">user_breakpoint_p</a> (bpt))
<a name="l14580"></a>14580           <a class="code" href="breakpoint_8c.html#a78b8032b510154e6246e59cfd7d6d9be">disable_breakpoint</a> (bpt);
<a name="l14581"></a>14581     }
<a name="l14582"></a>14582   else
<a name="l14583"></a>14583     {
<a name="l14584"></a>14584       <span class="keywordtype">char</span> *num = <a class="code" href="cli-utils_8c.html#ab9a3176e7db081a2621a8f460770bb80">extract_arg</a> (&amp;args);
<a name="l14585"></a>14585 
<a name="l14586"></a>14586       <span class="keywordflow">while</span> (num)
<a name="l14587"></a>14587         {
<a name="l14588"></a>14588           <span class="keywordflow">if</span> (<a class="code" href="gdb__string_8h.html#adf46aa8f2e08cfb505868bbfc88b5fd4">strchr</a> (num, <span class="charliteral">&#39;.&#39;</span>))
<a name="l14589"></a>14589             {
<a name="l14590"></a>14590               <span class="keyword">struct </span>bp_location *loc = find_location_by_number (num);
<a name="l14591"></a>14591 
<a name="l14592"></a>14592               <span class="keywordflow">if</span> (loc)
<a name="l14593"></a>14593                 {
<a name="l14594"></a>14594                   <span class="keywordflow">if</span> (loc-&gt;<a class="code" href="structbp__location.html#abe93e091d18373d27bda3ad3eb6316f8">enabled</a>)
<a name="l14595"></a>14595                     {
<a name="l14596"></a>14596                       loc-&gt;<a class="code" href="structbp__location.html#abe93e091d18373d27bda3ad3eb6316f8">enabled</a> = 0;
<a name="l14597"></a>14597                       mark_breakpoint_location_modified (loc);
<a name="l14598"></a>14598                     }
<a name="l14599"></a>14599                   <span class="keywordflow">if</span> (<a class="code" href="target_8h.html#ab7943bd804233ce9d742037eb6398579">target_supports_enable_disable_tracepoint</a> ()
<a name="l14600"></a>14600                       &amp;&amp; <a class="code" href="tracepoint_8c.html#af4041987a9ba21b88378bb6a3873baca">current_trace_status</a> ()-&gt;running &amp;&amp; loc-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>
<a name="l14601"></a>14601                       &amp;&amp; <a class="code" href="breakpoint_8c.html#ac537492fb781218601862c78225bd118">is_tracepoint</a> (loc-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>))
<a name="l14602"></a>14602                     <a class="code" href="target_8h.html#a1cea3310d44ec81d08890ad35f2c0868">target_disable_tracepoint</a> (loc);
<a name="l14603"></a>14603                 }
<a name="l14604"></a>14604               update_global_location_list (0);
<a name="l14605"></a>14605             }
<a name="l14606"></a>14606           <span class="keywordflow">else</span>
<a name="l14607"></a>14607             map_breakpoint_numbers (num, do_map_disable_breakpoint, NULL);
<a name="l14608"></a>14608           num = <a class="code" href="cli-utils_8c.html#ab9a3176e7db081a2621a8f460770bb80">extract_arg</a> (&amp;args);
<a name="l14609"></a>14609         }
<a name="l14610"></a>14610     }
<a name="l14611"></a>14611 }
<a name="l14612"></a>14612 
<a name="l14613"></a>14613 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l14614"></a>14614 enable_breakpoint_disp (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *bpt, <span class="keyword">enum</span> <a class="code" href="breakpoint_8h.html#a15f2bbd9012f59bc09d59feef0c15732">bpdisp</a> disposition,
<a name="l14615"></a>14615                         <span class="keywordtype">int</span> count)
<a name="l14616"></a>14616 {
<a name="l14617"></a>14617   <span class="keywordtype">int</span> target_resources_ok;
<a name="l14618"></a>14618 
<a name="l14619"></a>14619   <span class="keywordflow">if</span> (bpt-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa657fad68a9d83a24532fb06715b77628">bp_hardware_breakpoint</a>)
<a name="l14620"></a>14620     {
<a name="l14621"></a>14621       <span class="keywordtype">int</span> i;
<a name="l14622"></a>14622       i = hw_breakpoint_used_count ();
<a name="l14623"></a>14623       target_resources_ok = 
<a name="l14624"></a>14624         <a class="code" href="target_8h.html#a426728386dc9c2a6d50a7a20e90fe13b">target_can_use_hardware_watchpoint</a> (<a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa657fad68a9d83a24532fb06715b77628">bp_hardware_breakpoint</a>, 
<a name="l14625"></a>14625                                             i + 1, 0);
<a name="l14626"></a>14626       <span class="keywordflow">if</span> (target_resources_ok == 0)
<a name="l14627"></a>14627         <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;No hardware breakpoint support in the target.&quot;</span>));
<a name="l14628"></a>14628       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (target_resources_ok &lt; 0)
<a name="l14629"></a>14629         <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Hardware breakpoints used exceeds limit.&quot;</span>));
<a name="l14630"></a>14630     }
<a name="l14631"></a>14631 
<a name="l14632"></a>14632   <span class="keywordflow">if</span> (<a class="code" href="breakpoint_8c.html#a49f0d5ff628dd506db5b81f660eb4610">is_watchpoint</a> (bpt))
<a name="l14633"></a>14633     {
<a name="l14634"></a>14634       <span class="comment">/* Initialize it just to avoid a GCC false warning.  */</span>
<a name="l14635"></a>14635       <span class="keyword">enum</span> <a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577">enable_state</a> orig_enable_state = 0;
<a name="l14636"></a>14636       <span class="keyword">volatile</span> <span class="keyword">struct </span><a class="code" href="structgdb__exception.html">gdb_exception</a> e;
<a name="l14637"></a>14637 
<a name="l14638"></a>14638       <a class="code" href="exceptions_8h.html#aef4514ee39b9305fddee27f49c7c34eb">TRY_CATCH</a> (e, <a class="code" href="exceptions_8h.html#abfa3a3b99557b11f5766baf69465fdf6ab50fde886a7de8c013bf2bd4e7c073a4">RETURN_MASK_ALL</a>)
<a name="l14639"></a>14639         {
<a name="l14640"></a>14640           <span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *w = (<span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *) bpt;
<a name="l14641"></a>14641 
<a name="l14642"></a>14642           orig_enable_state = bpt-&gt;<a class="code" href="structbreakpoint.html#acb53352fd35aaad37054508fabc0f3bf">enable_state</a>;
<a name="l14643"></a>14643           bpt-&gt;<a class="code" href="structbreakpoint.html#acb53352fd35aaad37054508fabc0f3bf">enable_state</a> = <a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577a72f1fa981d13a62d05324c1de974b44b">bp_enabled</a>;
<a name="l14644"></a>14644           update_watchpoint (w, 1 <span class="comment">/* reparse */</span>);
<a name="l14645"></a>14645         }
<a name="l14646"></a>14646       <span class="keywordflow">if</span> (e.reason &lt; 0)
<a name="l14647"></a>14647         {
<a name="l14648"></a>14648           bpt-&gt;<a class="code" href="structbreakpoint.html#acb53352fd35aaad37054508fabc0f3bf">enable_state</a> = orig_enable_state;
<a name="l14649"></a>14649           <a class="code" href="exceptions_8c.html#ae1dffc77e3a96d17e813da7d2165b16d">exception_fprintf</a> (<a class="code" href="main_8c.html#a2a1dea1e551cadb9541353a004193a47">gdb_stderr</a>, e, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Cannot enable watchpoint %d: &quot;</span>),
<a name="l14650"></a>14650                              bpt-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>);
<a name="l14651"></a>14651           <span class="keywordflow">return</span>;
<a name="l14652"></a>14652         }
<a name="l14653"></a>14653     }
<a name="l14654"></a>14654 
<a name="l14655"></a>14655   <span class="keywordflow">if</span> (bpt-&gt;<a class="code" href="structbreakpoint.html#acb53352fd35aaad37054508fabc0f3bf">enable_state</a> != <a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577adbf2e9b210d33b1ac7e8a7ed87a2b46f">bp_permanent</a>)
<a name="l14656"></a>14656     bpt-&gt;<a class="code" href="structbreakpoint.html#acb53352fd35aaad37054508fabc0f3bf">enable_state</a> = <a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577a72f1fa981d13a62d05324c1de974b44b">bp_enabled</a>;
<a name="l14657"></a>14657 
<a name="l14658"></a>14658   bpt-&gt;<a class="code" href="structbreakpoint.html#acb53352fd35aaad37054508fabc0f3bf">enable_state</a> = <a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577a72f1fa981d13a62d05324c1de974b44b">bp_enabled</a>;
<a name="l14659"></a>14659 
<a name="l14660"></a>14660   <span class="comment">/* Mark breakpoint locations modified.  */</span>
<a name="l14661"></a>14661   mark_breakpoint_modified (bpt);
<a name="l14662"></a>14662 
<a name="l14663"></a>14663   <span class="keywordflow">if</span> (<a class="code" href="target_8h.html#ab7943bd804233ce9d742037eb6398579">target_supports_enable_disable_tracepoint</a> ()
<a name="l14664"></a>14664       &amp;&amp; <a class="code" href="tracepoint_8c.html#af4041987a9ba21b88378bb6a3873baca">current_trace_status</a> ()-&gt;running &amp;&amp; <a class="code" href="breakpoint_8c.html#ac537492fb781218601862c78225bd118">is_tracepoint</a> (bpt))
<a name="l14665"></a>14665     {
<a name="l14666"></a>14666       <span class="keyword">struct </span>bp_location *location;
<a name="l14667"></a>14667 
<a name="l14668"></a>14668       <span class="keywordflow">for</span> (location = bpt-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>; location; location = location-&gt;<a class="code" href="structbp__location.html#ab193cb38f87fea89105db96d94191541">next</a>)
<a name="l14669"></a>14669         <a class="code" href="target_8h.html#a4eea3933763ac18e46f7adeee5c02c7c">target_enable_tracepoint</a> (location);
<a name="l14670"></a>14670     }
<a name="l14671"></a>14671 
<a name="l14672"></a>14672   bpt-&gt;<a class="code" href="structbreakpoint.html#a75f0f9a837eac292ab6e768e8d8f1bd7">disposition</a> = disposition;
<a name="l14673"></a>14673   bpt-&gt;<a class="code" href="structbreakpoint.html#a1971955032b554a7b688b6b842cdc393">enable_count</a> = count;
<a name="l14674"></a>14674   update_global_location_list (1);
<a name="l14675"></a>14675 
<a name="l14676"></a>14676   <a class="code" href="observer_8h.html#a3edacfe44ac49f71646caded92072cad">observer_notify_breakpoint_modified</a> (bpt);
<a name="l14677"></a>14677 }
<a name="l14678"></a>14678 
<a name="l14679"></a>14679 
<a name="l14680"></a>14680 <span class="keywordtype">void</span>
<a name="l14681"></a><a class="code" href="breakpoint_8h.html#a4a448681a5036e19cf97b0faece9beb2">14681</a> <a class="code" href="breakpoint_8c.html#a0144c9eb1182c71c1367fa30b98d0f9d">enable_breakpoint</a> (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *bpt)
<a name="l14682"></a>14682 {
<a name="l14683"></a>14683   enable_breakpoint_disp (bpt, bpt-&gt;<a class="code" href="structbreakpoint.html#a75f0f9a837eac292ab6e768e8d8f1bd7">disposition</a>, 0);
<a name="l14684"></a>14684 }
<a name="l14685"></a>14685 
<a name="l14686"></a>14686 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l14687"></a>14687 do_enable_breakpoint (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *bpt, <span class="keywordtype">void</span> *arg)
<a name="l14688"></a>14688 {
<a name="l14689"></a>14689   <a class="code" href="breakpoint_8c.html#a0144c9eb1182c71c1367fa30b98d0f9d">enable_breakpoint</a> (bpt);
<a name="l14690"></a>14690 }
<a name="l14691"></a>14691 
<a name="l14692"></a>14692 <span class="comment">/* A callback for map_breakpoint_numbers that calls</span>
<a name="l14693"></a>14693 <span class="comment">   enable_breakpoint.  */</span>
<a name="l14694"></a>14694 
<a name="l14695"></a>14695 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l14696"></a>14696 do_map_enable_breakpoint (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b, <span class="keywordtype">void</span> *ignore)
<a name="l14697"></a>14697 {
<a name="l14698"></a>14698   iterate_over_related_breakpoints (b, do_enable_breakpoint, NULL);
<a name="l14699"></a>14699 }
<a name="l14700"></a>14700 
<a name="l14701"></a>14701 <span class="comment">/* The enable command enables the specified breakpoints (or all defined</span>
<a name="l14702"></a>14702 <span class="comment">   breakpoints) so they once again become (or continue to be) effective</span>
<a name="l14703"></a>14703 <span class="comment">   in stopping the inferior.  */</span>
<a name="l14704"></a>14704 
<a name="l14705"></a>14705 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l14706"></a>14706 enable_command (<span class="keywordtype">char</span> *args, <span class="keywordtype">int</span> from_tty)
<a name="l14707"></a>14707 {
<a name="l14708"></a>14708   <span class="keywordflow">if</span> (args == 0)
<a name="l14709"></a>14709     {
<a name="l14710"></a>14710       <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *bpt;
<a name="l14711"></a>14711 
<a name="l14712"></a>14712       <a class="code" href="breakpoint_8c.html#a781d5d3dc50a92364edfbacac3d0c107">ALL_BREAKPOINTS</a> (bpt)
<a name="l14713"></a>14713         if (<a class="code" href="breakpoint_8c.html#ac7893fb93c9f1d907b89a1655481602d">user_breakpoint_p</a> (bpt))
<a name="l14714"></a>14714           <a class="code" href="breakpoint_8c.html#a0144c9eb1182c71c1367fa30b98d0f9d">enable_breakpoint</a> (bpt);
<a name="l14715"></a>14715     }
<a name="l14716"></a>14716   else
<a name="l14717"></a>14717     {
<a name="l14718"></a>14718       <span class="keywordtype">char</span> *num = <a class="code" href="cli-utils_8c.html#ab9a3176e7db081a2621a8f460770bb80">extract_arg</a> (&amp;args);
<a name="l14719"></a>14719 
<a name="l14720"></a>14720       <span class="keywordflow">while</span> (num)
<a name="l14721"></a>14721         {
<a name="l14722"></a>14722           <span class="keywordflow">if</span> (<a class="code" href="gdb__string_8h.html#adf46aa8f2e08cfb505868bbfc88b5fd4">strchr</a> (num, <span class="charliteral">&#39;.&#39;</span>))
<a name="l14723"></a>14723             {
<a name="l14724"></a>14724               <span class="keyword">struct </span>bp_location *loc = find_location_by_number (num);
<a name="l14725"></a>14725 
<a name="l14726"></a>14726               <span class="keywordflow">if</span> (loc)
<a name="l14727"></a>14727                 {
<a name="l14728"></a>14728                   <span class="keywordflow">if</span> (!loc-&gt;<a class="code" href="structbp__location.html#abe93e091d18373d27bda3ad3eb6316f8">enabled</a>)
<a name="l14729"></a>14729                     {
<a name="l14730"></a>14730                       loc-&gt;<a class="code" href="structbp__location.html#abe93e091d18373d27bda3ad3eb6316f8">enabled</a> = 1;
<a name="l14731"></a>14731                       mark_breakpoint_location_modified (loc);
<a name="l14732"></a>14732                     }
<a name="l14733"></a>14733                   <span class="keywordflow">if</span> (<a class="code" href="target_8h.html#ab7943bd804233ce9d742037eb6398579">target_supports_enable_disable_tracepoint</a> ()
<a name="l14734"></a>14734                       &amp;&amp; <a class="code" href="tracepoint_8c.html#af4041987a9ba21b88378bb6a3873baca">current_trace_status</a> ()-&gt;running &amp;&amp; loc-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>
<a name="l14735"></a>14735                       &amp;&amp; <a class="code" href="breakpoint_8c.html#ac537492fb781218601862c78225bd118">is_tracepoint</a> (loc-&gt;<a class="code" href="structbp__location.html#ade5cd870d1e7255c36ac84c2c6f1c4c2">owner</a>))
<a name="l14736"></a>14736                     <a class="code" href="target_8h.html#a4eea3933763ac18e46f7adeee5c02c7c">target_enable_tracepoint</a> (loc);
<a name="l14737"></a>14737                 }
<a name="l14738"></a>14738               update_global_location_list (1);
<a name="l14739"></a>14739             }
<a name="l14740"></a>14740           <span class="keywordflow">else</span>
<a name="l14741"></a>14741             map_breakpoint_numbers (num, do_map_enable_breakpoint, NULL);
<a name="l14742"></a>14742           num = <a class="code" href="cli-utils_8c.html#ab9a3176e7db081a2621a8f460770bb80">extract_arg</a> (&amp;args);
<a name="l14743"></a>14743         }
<a name="l14744"></a>14744     }
<a name="l14745"></a>14745 }
<a name="l14746"></a>14746 
<a name="l14747"></a>14747 <span class="comment">/* This struct packages up disposition data for application to multiple</span>
<a name="l14748"></a>14748 <span class="comment">   breakpoints.  */</span>
<a name="l14749"></a>14749 
<a name="l14750"></a>14750 <span class="keyword">struct </span>disp_data
<a name="l14751"></a>14751 {
<a name="l14752"></a>14752   <span class="keyword">enum</span> <a class="code" href="breakpoint_8h.html#a15f2bbd9012f59bc09d59feef0c15732">bpdisp</a> disp;
<a name="l14753"></a>14753   <span class="keywordtype">int</span> count;
<a name="l14754"></a>14754 };
<a name="l14755"></a>14755 
<a name="l14756"></a>14756 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l14757"></a>14757 do_enable_breakpoint_disp (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *bpt, <span class="keywordtype">void</span> *arg)
<a name="l14758"></a>14758 {
<a name="l14759"></a>14759   <span class="keyword">struct </span>disp_data disp_data = *(<span class="keyword">struct </span>disp_data *) arg;
<a name="l14760"></a>14760 
<a name="l14761"></a>14761   enable_breakpoint_disp (bpt, disp_data.disp, disp_data.count);
<a name="l14762"></a>14762 }
<a name="l14763"></a>14763 
<a name="l14764"></a>14764 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l14765"></a>14765 do_map_enable_once_breakpoint (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *bpt, <span class="keywordtype">void</span> *ignore)
<a name="l14766"></a>14766 {
<a name="l14767"></a>14767   <span class="keyword">struct </span>disp_data disp = { <a class="code" href="breakpoint_8h.html#a15f2bbd9012f59bc09d59feef0c15732a5207a2e1dd4e0223ab6a853264242d7b">disp_disable</a>, 1 };
<a name="l14768"></a>14768 
<a name="l14769"></a>14769   iterate_over_related_breakpoints (bpt, do_enable_breakpoint_disp, &amp;disp);
<a name="l14770"></a>14770 }
<a name="l14771"></a>14771 
<a name="l14772"></a>14772 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l14773"></a>14773 enable_once_command (<span class="keywordtype">char</span> *args, <span class="keywordtype">int</span> from_tty)
<a name="l14774"></a>14774 {
<a name="l14775"></a>14775   map_breakpoint_numbers (args, do_map_enable_once_breakpoint, NULL);
<a name="l14776"></a>14776 }
<a name="l14777"></a>14777 
<a name="l14778"></a>14778 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l14779"></a>14779 do_map_enable_count_breakpoint (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *bpt, <span class="keywordtype">void</span> *countptr)
<a name="l14780"></a>14780 {
<a name="l14781"></a>14781   <span class="keyword">struct </span>disp_data disp = { <a class="code" href="breakpoint_8h.html#a15f2bbd9012f59bc09d59feef0c15732a5207a2e1dd4e0223ab6a853264242d7b">disp_disable</a>, *(<span class="keywordtype">int</span> *) countptr };
<a name="l14782"></a>14782 
<a name="l14783"></a>14783   iterate_over_related_breakpoints (bpt, do_enable_breakpoint_disp, &amp;disp);
<a name="l14784"></a>14784 }
<a name="l14785"></a>14785 
<a name="l14786"></a>14786 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l14787"></a>14787 enable_count_command (<span class="keywordtype">char</span> *args, <span class="keywordtype">int</span> from_tty)
<a name="l14788"></a>14788 {
<a name="l14789"></a>14789   <span class="keywordtype">int</span> count = <a class="code" href="cli-utils_8c.html#a90dc5fbdc073138a035cd142f0739e8b">get_number</a> (&amp;args);
<a name="l14790"></a>14790 
<a name="l14791"></a>14791   map_breakpoint_numbers (args, do_map_enable_count_breakpoint, &amp;count);
<a name="l14792"></a>14792 }
<a name="l14793"></a>14793 
<a name="l14794"></a>14794 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l14795"></a>14795 do_map_enable_delete_breakpoint (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *bpt, <span class="keywordtype">void</span> *ignore)
<a name="l14796"></a>14796 {
<a name="l14797"></a>14797   <span class="keyword">struct </span>disp_data disp = { <a class="code" href="breakpoint_8h.html#a15f2bbd9012f59bc09d59feef0c15732a16da7fb4204cb3f58c753fafa80bfab7">disp_del</a>, 1 };
<a name="l14798"></a>14798 
<a name="l14799"></a>14799   iterate_over_related_breakpoints (bpt, do_enable_breakpoint_disp, &amp;disp);
<a name="l14800"></a>14800 }
<a name="l14801"></a>14801 
<a name="l14802"></a>14802 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l14803"></a>14803 enable_delete_command (<span class="keywordtype">char</span> *args, <span class="keywordtype">int</span> from_tty)
<a name="l14804"></a>14804 {
<a name="l14805"></a>14805   map_breakpoint_numbers (args, do_map_enable_delete_breakpoint, NULL);
<a name="l14806"></a>14806 }
<a name="l14807"></a>14807 
<a name="l14808"></a>14808 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l14809"></a>14809 set_breakpoint_cmd (<span class="keywordtype">char</span> *args, <span class="keywordtype">int</span> from_tty)
<a name="l14810"></a>14810 {
<a name="l14811"></a>14811 }
<a name="l14812"></a>14812 
<a name="l14813"></a>14813 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l14814"></a>14814 show_breakpoint_cmd (<span class="keywordtype">char</span> *args, <span class="keywordtype">int</span> from_tty)
<a name="l14815"></a>14815 {
<a name="l14816"></a>14816 }
<a name="l14817"></a>14817 
<a name="l14818"></a>14818 <span class="comment">/* Invalidate last known value of any hardware watchpoint if</span>
<a name="l14819"></a>14819 <span class="comment">   the memory which that value represents has been written to by</span>
<a name="l14820"></a>14820 <span class="comment">   GDB itself.  */</span>
<a name="l14821"></a>14821 
<a name="l14822"></a>14822 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l14823"></a>14823 invalidate_bp_value_on_memory_change (<span class="keyword">struct</span> <a class="code" href="structinferior.html">inferior</a> *<a class="code" href="structinferior.html">inferior</a>,
<a name="l14824"></a>14824                                       <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> addr, ssize_t len,
<a name="l14825"></a>14825                                       <span class="keyword">const</span> bfd_byte *data)
<a name="l14826"></a>14826 {
<a name="l14827"></a>14827   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *bp;
<a name="l14828"></a>14828 
<a name="l14829"></a>14829   <a class="code" href="breakpoint_8c.html#a781d5d3dc50a92364edfbacac3d0c107">ALL_BREAKPOINTS</a> (bp)
<a name="l14830"></a>14830     if (bp-&gt;<a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577">enable_state</a> == <a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577a72f1fa981d13a62d05324c1de974b44b">bp_enabled</a>
<a name="l14831"></a>14831         &amp;&amp; bp-&gt;type == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfae38a33f5a6725fbca8b5da2d491cfbcb">bp_hardware_watchpoint</a>)
<a name="l14832"></a>14832       {
<a name="l14833"></a>14833         <span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *wp = (<span class="keyword">struct </span><a class="code" href="structwatchpoint.html">watchpoint</a> *) bp;
<a name="l14834"></a>14834 
<a name="l14835"></a>14835         <span class="keywordflow">if</span> (wp-&gt;<a class="code" href="structwatchpoint.html#ab2e6ea6495c9663c86652b00af5bea1d">val_valid</a> &amp;&amp; wp-&gt;<a class="code" href="structwatchpoint.html#afafe9b6d8ed19e6c10764499cb35a7d1">val</a>)
<a name="l14836"></a>14836           {
<a name="l14837"></a>14837             <span class="keyword">struct </span>bp_location *loc;
<a name="l14838"></a>14838 
<a name="l14839"></a>14839             <span class="keywordflow">for</span> (loc = bp-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>; loc != NULL; loc = loc-&gt;<a class="code" href="structbp__location.html#ab193cb38f87fea89105db96d94191541">next</a>)
<a name="l14840"></a>14840               <span class="keywordflow">if</span> (loc-&gt;<a class="code" href="structbp__location.html#aefe49818487e5876fc995f7831e2e809">loc_type</a> == <a class="code" href="breakpoint_8h.html#ad7006ab95a9d2493c6ad2c685f45f5dcaf30d35565c228c0d80de4d7af9d9fbd2">bp_loc_hardware_watchpoint</a>
<a name="l14841"></a>14841                   &amp;&amp; loc-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a> + loc-&gt;<a class="code" href="structbp__location.html#a3d4ad6914964554ca761607f9e8fab62">length</a> &gt; addr
<a name="l14842"></a>14842                   &amp;&amp; addr + len &gt; loc-&gt;<a class="code" href="structbp__location.html#a6b6cd8b8a488e632200f323309d23823">address</a>)
<a name="l14843"></a>14843                 {
<a name="l14844"></a>14844                   <a class="code" href="value_8c.html#a1f9b3ee232ece65ddc75c2407b97a50d">value_free</a> (wp-&gt;<a class="code" href="structwatchpoint.html#afafe9b6d8ed19e6c10764499cb35a7d1">val</a>);
<a name="l14845"></a>14845                   wp-&gt;<a class="code" href="structwatchpoint.html#afafe9b6d8ed19e6c10764499cb35a7d1">val</a> = NULL;
<a name="l14846"></a>14846                   wp-&gt;<a class="code" href="structwatchpoint.html#ab2e6ea6495c9663c86652b00af5bea1d">val_valid</a> = 0;
<a name="l14847"></a>14847                 }
<a name="l14848"></a>14848           }
<a name="l14849"></a>14849       }
<a name="l14850"></a>14850 }
<a name="l14851"></a>14851 
<a name="l14852"></a>14852 <span class="comment">/* Create and insert a raw software breakpoint at PC.  Return an</span>
<a name="l14853"></a>14853 <span class="comment">   identifier, which should be used to remove the breakpoint later.</span>
<a name="l14854"></a>14854 <span class="comment">   In general, places which call this should be using something on the</span>
<a name="l14855"></a>14855 <span class="comment">   breakpoint chain instead; this function should be eliminated</span>
<a name="l14856"></a>14856 <span class="comment">   someday.  */</span>
<a name="l14857"></a>14857 
<a name="l14858"></a>14858 <span class="keywordtype">void</span> *
<a name="l14859"></a><a class="code" href="breakpoint_8h.html#abe6366b0ced2b7f740154823bc39e16e">14859</a> <a class="code" href="breakpoint_8c.html#ae69a79875b28e9bbe7a56465f378ff2a">deprecated_insert_raw_breakpoint</a> (<span class="keyword">struct</span> gdbarch *gdbarch,
<a name="l14860"></a>14860                                   <span class="keyword">struct</span> address_space *aspace, <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> pc)
<a name="l14861"></a>14861 {
<a name="l14862"></a>14862   <span class="keyword">struct </span><a class="code" href="structbp__target__info.html">bp_target_info</a> *bp_tgt;
<a name="l14863"></a>14863 
<a name="l14864"></a>14864   bp_tgt = <a class="code" href="defs_8h.html#ab004b072c2eba9eb35ffb7b86a72b8c0">XZALLOC</a> (<span class="keyword">struct</span> <a class="code" href="structbp__target__info.html">bp_target_info</a>);
<a name="l14865"></a>14865 
<a name="l14866"></a>14866   bp_tgt-&gt;<a class="code" href="structbp__target__info.html#afe5a9e41037d27e13353a24f733c4693">placed_address_space</a> = aspace;
<a name="l14867"></a>14867   bp_tgt-&gt;<a class="code" href="structbp__target__info.html#a8e3d47e670e13db11873c3ff52934fbb">placed_address</a> = pc;
<a name="l14868"></a>14868 
<a name="l14869"></a>14869   <span class="keywordflow">if</span> (<a class="code" href="target_8c.html#a4a288f6e92a74cf83fdae9d6ac05cd80">target_insert_breakpoint</a> (gdbarch, bp_tgt) != 0)
<a name="l14870"></a>14870     {
<a name="l14871"></a>14871       <span class="comment">/* Could not insert the breakpoint.  */</span>
<a name="l14872"></a>14872       <a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a> (bp_tgt);
<a name="l14873"></a>14873       <span class="keywordflow">return</span> NULL;
<a name="l14874"></a>14874     }
<a name="l14875"></a>14875 
<a name="l14876"></a>14876   <span class="keywordflow">return</span> bp_tgt;
<a name="l14877"></a>14877 }
<a name="l14878"></a>14878 
<a name="l14879"></a>14879 <span class="comment">/* Remove a breakpoint BP inserted by</span>
<a name="l14880"></a>14880 <span class="comment">   deprecated_insert_raw_breakpoint.  */</span>
<a name="l14881"></a>14881 
<a name="l14882"></a>14882 <span class="keywordtype">int</span>
<a name="l14883"></a><a class="code" href="breakpoint_8h.html#aabbe0893901513444137cdb677e2dd91">14883</a> <a class="code" href="breakpoint_8c.html#a1355b81d333bd3fe9e87bd29ea08b779">deprecated_remove_raw_breakpoint</a> (<span class="keyword">struct</span> gdbarch *gdbarch, <span class="keywordtype">void</span> *bp)
<a name="l14884"></a>14884 {
<a name="l14885"></a>14885   <span class="keyword">struct </span><a class="code" href="structbp__target__info.html">bp_target_info</a> *bp_tgt = bp;
<a name="l14886"></a>14886   <span class="keywordtype">int</span> ret;
<a name="l14887"></a>14887 
<a name="l14888"></a>14888   ret = <a class="code" href="target_8c.html#a9c2f1e0aacdecef04948e3714a934b70">target_remove_breakpoint</a> (gdbarch, bp_tgt);
<a name="l14889"></a>14889   <a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a> (bp_tgt);
<a name="l14890"></a>14890 
<a name="l14891"></a>14891   <span class="keywordflow">return</span> ret;
<a name="l14892"></a>14892 }
<a name="l14893"></a>14893 
<a name="l14894"></a>14894 <span class="comment">/* One (or perhaps two) breakpoints used for software single</span>
<a name="l14895"></a>14895 <span class="comment">   stepping.  */</span>
<a name="l14896"></a>14896 
<a name="l14897"></a>14897 <span class="keyword">static</span> <span class="keywordtype">void</span> *single_step_breakpoints[2];
<a name="l14898"></a>14898 <span class="keyword">static</span> <span class="keyword">struct </span>gdbarch *single_step_gdbarch[2];
<a name="l14899"></a>14899 
<a name="l14900"></a>14900 <span class="comment">/* Create and insert a breakpoint for software single step.  */</span>
<a name="l14901"></a>14901 
<a name="l14902"></a>14902 <span class="keywordtype">void</span>
<a name="l14903"></a><a class="code" href="breakpoint_8h.html#abbc4bd7e9b9461de1d9d04c554caefe2">14903</a> <a class="code" href="breakpoint_8c.html#a8decd828f1a0042e3e40a1ed86940140">insert_single_step_breakpoint</a> (<span class="keyword">struct</span> gdbarch *gdbarch,
<a name="l14904"></a>14904                                <span class="keyword">struct</span> address_space *aspace, 
<a name="l14905"></a>14905                                <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> next_pc)
<a name="l14906"></a>14906 {
<a name="l14907"></a>14907   <span class="keywordtype">void</span> **bpt_p;
<a name="l14908"></a>14908 
<a name="l14909"></a>14909   <span class="keywordflow">if</span> (single_step_breakpoints[0] == NULL)
<a name="l14910"></a>14910     {
<a name="l14911"></a>14911       bpt_p = &amp;single_step_breakpoints[0];
<a name="l14912"></a>14912       single_step_gdbarch[0] = gdbarch;
<a name="l14913"></a>14913     }
<a name="l14914"></a>14914   <span class="keywordflow">else</span>
<a name="l14915"></a>14915     {
<a name="l14916"></a>14916       <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (single_step_breakpoints[1] == NULL);
<a name="l14917"></a>14917       bpt_p = &amp;single_step_breakpoints[1];
<a name="l14918"></a>14918       single_step_gdbarch[1] = gdbarch;
<a name="l14919"></a>14919     }
<a name="l14920"></a>14920 
<a name="l14921"></a>14921   <span class="comment">/* NOTE drow/2006-04-11: A future improvement to this function would</span>
<a name="l14922"></a>14922 <span class="comment">     be to only create the breakpoints once, and actually put them on</span>
<a name="l14923"></a>14923 <span class="comment">     the breakpoint chain.  That would let us use set_raw_breakpoint.</span>
<a name="l14924"></a>14924 <span class="comment">     We could adjust the addresses each time they were needed.  Doing</span>
<a name="l14925"></a>14925 <span class="comment">     this requires corresponding changes elsewhere where single step</span>
<a name="l14926"></a>14926 <span class="comment">     breakpoints are handled, however.  So, for now, we use this.  */</span>
<a name="l14927"></a>14927 
<a name="l14928"></a>14928   *bpt_p = <a class="code" href="breakpoint_8c.html#ae69a79875b28e9bbe7a56465f378ff2a">deprecated_insert_raw_breakpoint</a> (gdbarch, aspace, next_pc);
<a name="l14929"></a>14929   <span class="keywordflow">if</span> (*bpt_p == NULL)
<a name="l14930"></a>14930     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Could not insert single-step breakpoint at %s&quot;</span>),
<a name="l14931"></a>14931              <a class="code" href="utils_8c.html#ab5c76d72090f01d3848b63dda4e37d1c">paddress</a> (gdbarch, next_pc));
<a name="l14932"></a>14932 }
<a name="l14933"></a>14933 
<a name="l14934"></a>14934 <span class="comment">/* Check if the breakpoints used for software single stepping</span>
<a name="l14935"></a>14935 <span class="comment">   were inserted or not.  */</span>
<a name="l14936"></a>14936 
<a name="l14937"></a>14937 <span class="keywordtype">int</span>
<a name="l14938"></a><a class="code" href="breakpoint_8h.html#a3495fbd8e1bce67e44831f70d96e3b99">14938</a> <a class="code" href="breakpoint_8c.html#a3495fbd8e1bce67e44831f70d96e3b99">single_step_breakpoints_inserted</a> (<span class="keywordtype">void</span>)
<a name="l14939"></a>14939 {
<a name="l14940"></a>14940   <span class="keywordflow">return</span> (single_step_breakpoints[0] != NULL
<a name="l14941"></a>14941           || single_step_breakpoints[1] != NULL);
<a name="l14942"></a>14942 }
<a name="l14943"></a>14943 
<a name="l14944"></a>14944 <span class="comment">/* Remove and delete any breakpoints used for software single step.  */</span>
<a name="l14945"></a>14945 
<a name="l14946"></a>14946 <span class="keywordtype">void</span>
<a name="l14947"></a><a class="code" href="breakpoint_8h.html#a6a5eaa1399493139020021db409d08b7">14947</a> <a class="code" href="breakpoint_8c.html#a6a5eaa1399493139020021db409d08b7">remove_single_step_breakpoints</a> (<span class="keywordtype">void</span>)
<a name="l14948"></a>14948 {
<a name="l14949"></a>14949   <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (single_step_breakpoints[0] != NULL);
<a name="l14950"></a>14950 
<a name="l14951"></a>14951   <span class="comment">/* See insert_single_step_breakpoint for more about this deprecated</span>
<a name="l14952"></a>14952 <span class="comment">     call.  */</span>
<a name="l14953"></a>14953   <a class="code" href="breakpoint_8c.html#a1355b81d333bd3fe9e87bd29ea08b779">deprecated_remove_raw_breakpoint</a> (single_step_gdbarch[0],
<a name="l14954"></a>14954                                     single_step_breakpoints[0]);
<a name="l14955"></a>14955   single_step_gdbarch[0] = NULL;
<a name="l14956"></a>14956   single_step_breakpoints[0] = NULL;
<a name="l14957"></a>14957 
<a name="l14958"></a>14958   <span class="keywordflow">if</span> (single_step_breakpoints[1] != NULL)
<a name="l14959"></a>14959     {
<a name="l14960"></a>14960       <a class="code" href="breakpoint_8c.html#a1355b81d333bd3fe9e87bd29ea08b779">deprecated_remove_raw_breakpoint</a> (single_step_gdbarch[1],
<a name="l14961"></a>14961                                         single_step_breakpoints[1]);
<a name="l14962"></a>14962       single_step_gdbarch[1] = NULL;
<a name="l14963"></a>14963       single_step_breakpoints[1] = NULL;
<a name="l14964"></a>14964     }
<a name="l14965"></a>14965 }
<a name="l14966"></a>14966 
<a name="l14967"></a>14967 <span class="comment">/* Delete software single step breakpoints without removing them from</span>
<a name="l14968"></a>14968 <span class="comment">   the inferior.  This is intended to be used if the inferior&#39;s address</span>
<a name="l14969"></a>14969 <span class="comment">   space where they were inserted is already gone, e.g. after exit or</span>
<a name="l14970"></a>14970 <span class="comment">   exec.  */</span>
<a name="l14971"></a>14971 
<a name="l14972"></a>14972 <span class="keywordtype">void</span>
<a name="l14973"></a><a class="code" href="breakpoint_8h.html#ab7c85e2eb1f5bab6a1c14144cdc69c5c">14973</a> <a class="code" href="breakpoint_8c.html#ab7c85e2eb1f5bab6a1c14144cdc69c5c">cancel_single_step_breakpoints</a> (<span class="keywordtype">void</span>)
<a name="l14974"></a>14974 {
<a name="l14975"></a>14975   <span class="keywordtype">int</span> i;
<a name="l14976"></a>14976 
<a name="l14977"></a>14977   <span class="keywordflow">for</span> (i = 0; i &lt; 2; i++)
<a name="l14978"></a>14978     <span class="keywordflow">if</span> (single_step_breakpoints[i])
<a name="l14979"></a>14979       {
<a name="l14980"></a>14980         <a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a> (single_step_breakpoints[i]);
<a name="l14981"></a>14981         single_step_breakpoints[i] = NULL;
<a name="l14982"></a>14982         single_step_gdbarch[i] = NULL;
<a name="l14983"></a>14983       }
<a name="l14984"></a>14984 }
<a name="l14985"></a>14985 
<a name="l14986"></a>14986 <span class="comment">/* Detach software single-step breakpoints from INFERIOR_PTID without</span>
<a name="l14987"></a>14987 <span class="comment">   removing them.  */</span>
<a name="l14988"></a>14988 
<a name="l14989"></a>14989 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l14990"></a>14990 detach_single_step_breakpoints (<span class="keywordtype">void</span>)
<a name="l14991"></a>14991 {
<a name="l14992"></a>14992   <span class="keywordtype">int</span> i;
<a name="l14993"></a>14993 
<a name="l14994"></a>14994   <span class="keywordflow">for</span> (i = 0; i &lt; 2; i++)
<a name="l14995"></a>14995     <span class="keywordflow">if</span> (single_step_breakpoints[i])
<a name="l14996"></a>14996       <a class="code" href="target_8c.html#a9c2f1e0aacdecef04948e3714a934b70">target_remove_breakpoint</a> (single_step_gdbarch[i],
<a name="l14997"></a>14997                                 single_step_breakpoints[i]);
<a name="l14998"></a>14998 }
<a name="l14999"></a>14999 
<a name="l15000"></a>15000 <span class="comment">/* Check whether a software single-step breakpoint is inserted at</span>
<a name="l15001"></a>15001 <span class="comment">   PC.  */</span>
<a name="l15002"></a>15002 
<a name="l15003"></a>15003 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l15004"></a>15004 single_step_breakpoint_inserted_here_p (<span class="keyword">struct</span> address_space *aspace, 
<a name="l15005"></a>15005                                         <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> pc)
<a name="l15006"></a>15006 {
<a name="l15007"></a>15007   <span class="keywordtype">int</span> i;
<a name="l15008"></a>15008 
<a name="l15009"></a>15009   <span class="keywordflow">for</span> (i = 0; i &lt; 2; i++)
<a name="l15010"></a>15010     {
<a name="l15011"></a>15011       <span class="keyword">struct </span><a class="code" href="structbp__target__info.html">bp_target_info</a> *bp_tgt = single_step_breakpoints[i];
<a name="l15012"></a>15012       <span class="keywordflow">if</span> (bp_tgt
<a name="l15013"></a>15013           &amp;&amp; breakpoint_address_match (bp_tgt-&gt;<a class="code" href="structbp__target__info.html#afe5a9e41037d27e13353a24f733c4693">placed_address_space</a>,
<a name="l15014"></a>15014                                        bp_tgt-&gt;<a class="code" href="structbp__target__info.html#a8e3d47e670e13db11873c3ff52934fbb">placed_address</a>,
<a name="l15015"></a>15015                                        aspace, pc))
<a name="l15016"></a>15016         <span class="keywordflow">return</span> 1;
<a name="l15017"></a>15017     }
<a name="l15018"></a>15018 
<a name="l15019"></a>15019   <span class="keywordflow">return</span> 0;
<a name="l15020"></a>15020 }
<a name="l15021"></a>15021 
<a name="l15022"></a>15022 <span class="comment">/* Returns 0 if &#39;bp&#39; is NOT a syscall catchpoint,</span>
<a name="l15023"></a>15023 <span class="comment">   non-zero otherwise.  */</span>
<a name="l15024"></a>15024 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l15025"></a>15025 is_syscall_catchpoint_enabled (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *bp)
<a name="l15026"></a>15026 {
<a name="l15027"></a>15027   <span class="keywordflow">if</span> (syscall_catchpoint_p (bp)
<a name="l15028"></a>15028       &amp;&amp; bp-&gt;<a class="code" href="structbreakpoint.html#acb53352fd35aaad37054508fabc0f3bf">enable_state</a> != <a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577a4605f207d0d15bd8195c9b1aa1bfee96">bp_disabled</a>
<a name="l15029"></a>15029       &amp;&amp; bp-&gt;<a class="code" href="structbreakpoint.html#acb53352fd35aaad37054508fabc0f3bf">enable_state</a> != <a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577ab336fa5d61d3c4424c6aac80c107d1c6">bp_call_disabled</a>)
<a name="l15030"></a>15030     <span class="keywordflow">return</span> 1;
<a name="l15031"></a>15031   <span class="keywordflow">else</span>
<a name="l15032"></a>15032     <span class="keywordflow">return</span> 0;
<a name="l15033"></a>15033 }
<a name="l15034"></a>15034 
<a name="l15035"></a>15035 <span class="keywordtype">int</span>
<a name="l15036"></a><a class="code" href="breakpoint_8h.html#a96cbe1fc7933b72264b407b5debf772c">15036</a> <a class="code" href="breakpoint_8c.html#a96cbe1fc7933b72264b407b5debf772c">catch_syscall_enabled</a> (<span class="keywordtype">void</span>)
<a name="l15037"></a>15037 {
<a name="l15038"></a>15038   <span class="keyword">struct </span>catch_syscall_inferior_data *inf_data
<a name="l15039"></a>15039     = get_catch_syscall_inferior_data (<a class="code" href="inferior_8c.html#a9e592c83e7c0c1f89f1a4a392bd1a277">current_inferior</a> ());
<a name="l15040"></a>15040 
<a name="l15041"></a>15041   <span class="keywordflow">return</span> inf_data-&gt;total_syscalls_count != 0;
<a name="l15042"></a>15042 }
<a name="l15043"></a>15043 
<a name="l15044"></a>15044 <span class="keywordtype">int</span>
<a name="l15045"></a><a class="code" href="breakpoint_8h.html#a62d07595972abf5be63d923e305d98e1">15045</a> <a class="code" href="breakpoint_8c.html#a62d07595972abf5be63d923e305d98e1">catching_syscall_number</a> (<span class="keywordtype">int</span> syscall_number)
<a name="l15046"></a>15046 {
<a name="l15047"></a>15047   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *bp;
<a name="l15048"></a>15048 
<a name="l15049"></a>15049   <a class="code" href="breakpoint_8c.html#a781d5d3dc50a92364edfbacac3d0c107">ALL_BREAKPOINTS</a> (bp)
<a name="l15050"></a>15050     <span class="keywordflow">if</span> (is_syscall_catchpoint_enabled (bp))
<a name="l15051"></a>15051       {
<a name="l15052"></a>15052         <span class="keyword">struct </span>syscall_catchpoint *c = (<span class="keyword">struct </span>syscall_catchpoint *) bp;
<a name="l15053"></a>15053 
<a name="l15054"></a>15054         <span class="keywordflow">if</span> (c-&gt;syscalls_to_be_caught)
<a name="l15055"></a>15055           {
<a name="l15056"></a>15056             <span class="keywordtype">int</span> i, iter;
<a name="l15057"></a>15057             <span class="keywordflow">for</span> (i = 0;
<a name="l15058"></a>15058                  <a class="code" href="vec_8h.html#ae7795b0c8e65f45eb49aac5ec2c0fa52">VEC_iterate</a> (<span class="keywordtype">int</span>, c-&gt;syscalls_to_be_caught, i, iter);
<a name="l15059"></a>15059                  i++)
<a name="l15060"></a>15060               <span class="keywordflow">if</span> (syscall_number == iter)
<a name="l15061"></a>15061                 <span class="keywordflow">return</span> 1;
<a name="l15062"></a>15062           }
<a name="l15063"></a>15063         <span class="keywordflow">else</span>
<a name="l15064"></a>15064           <span class="keywordflow">return</span> 1;
<a name="l15065"></a>15065       }
<a name="l15066"></a>15066 
<a name="l15067"></a>15067   <span class="keywordflow">return</span> 0;
<a name="l15068"></a>15068 }
<a name="l15069"></a>15069 
<a name="l15070"></a>15070 <span class="comment">/* Complete syscall names.  Used by &quot;catch syscall&quot;.  */</span>
<a name="l15071"></a>15071 <span class="keyword">static</span> <a class="code" href="vec_8h.html#ab084f6f29fcf16a6b15d15feb653d414">VEC</a> (<a class="code" href="gdb__vecs_8h.html#a5ea7d3fefa2144d9bddaf2053c9691a1">char_ptr</a>) *
<a name="l15072"></a>15072 catch_syscall_completer (<span class="keyword">struct</span> <a class="code" href="structcmd__list__element.html">cmd_list_element</a> *cmd,
<a name="l15073"></a>15073                          <span class="keyword">const</span> <span class="keywordtype">char</span> *text, <span class="keyword">const</span> <span class="keywordtype">char</span> *word)
<a name="l15074"></a>15074 {
<a name="l15075"></a>15075   <span class="keyword">const</span> <span class="keywordtype">char</span> **list = <a class="code" href="xml-syscall_8c.html#af718fe517d46c0bd521b0551b9d330b1">get_syscall_names</a> ();
<a name="l15076"></a>15076   <a class="code" href="vec_8h.html#ab084f6f29fcf16a6b15d15feb653d414">VEC</a> (<a class="code" href="gdb__vecs_8h.html#a5ea7d3fefa2144d9bddaf2053c9691a1">char_ptr</a>) *retlist
<a name="l15077"></a>15077     = (list == NULL) ? NULL : complete_on_enum (list, word, word);
<a name="l15078"></a>15078 
<a name="l15079"></a>15079   <a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a> (list);
<a name="l15080"></a>15080   <span class="keywordflow">return</span> retlist;
<a name="l15081"></a>15081 }
<a name="l15082"></a>15082 
<a name="l15083"></a>15083 <span class="comment">/* Tracepoint-specific operations.  */</span>
<a name="l15084"></a>15084 
<a name="l15085"></a>15085 <span class="comment">/* Set tracepoint count to NUM.  */</span>
<a name="l15086"></a>15086 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l15087"></a>15087 set_tracepoint_count (<span class="keywordtype">int</span> num)
<a name="l15088"></a>15088 {
<a name="l15089"></a>15089   tracepoint_count = num;
<a name="l15090"></a>15090   <a class="code" href="value_8c.html#ac0d9f889423ba9ff189ea48da13204a3">set_internalvar_integer</a> (<a class="code" href="value_8c.html#ac96b41b37d2b8eeb44137ec148ca5c7c">lookup_internalvar</a> (<span class="stringliteral">&quot;tpnum&quot;</span>), num);
<a name="l15091"></a>15091 }
<a name="l15092"></a>15092 
<a name="l15093"></a>15093 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l15094"></a>15094 trace_command (<span class="keywordtype">char</span> *arg, <span class="keywordtype">int</span> from_tty)
<a name="l15095"></a>15095 {
<a name="l15096"></a>15096   <span class="keyword">struct </span><a class="code" href="structbreakpoint__ops.html">breakpoint_ops</a> *ops;
<a name="l15097"></a>15097   <span class="keyword">const</span> <span class="keywordtype">char</span> *arg_cp = arg;
<a name="l15098"></a>15098 
<a name="l15099"></a>15099   <span class="keywordflow">if</span> (arg &amp;&amp; <a class="code" href="probe_8c.html#ad1f3404178e403b595c76b312a647726">probe_linespec_to_ops</a> (&amp;arg_cp))
<a name="l15100"></a>15100     ops = &amp;tracepoint_probe_breakpoint_ops;
<a name="l15101"></a>15101   <span class="keywordflow">else</span>
<a name="l15102"></a>15102     ops = &amp;<a class="code" href="breakpoint_8c.html#ab588518ae329b0c2371895fa0efd772f">tracepoint_breakpoint_ops</a>;
<a name="l15103"></a>15103 
<a name="l15104"></a>15104   <a class="code" href="breakpoint_8c.html#a9f0540734ee04440fbb9f6c3c1558d0f">create_breakpoint</a> (<a class="code" href="arch-utils_8c.html#a0fe1e68475f442e5d6dda589e0c62454">get_current_arch</a> (),
<a name="l15105"></a>15105                      arg,
<a name="l15106"></a>15106                      NULL, 0, NULL, 1 <span class="comment">/* parse arg */</span>,
<a name="l15107"></a>15107                      0 <span class="comment">/* tempflag */</span>,
<a name="l15108"></a>15108                      <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfae87f3c5422e7ecec815f5cb7254b4b4c">bp_tracepoint</a> <span class="comment">/* type_wanted */</span>,
<a name="l15109"></a>15109                      0 <span class="comment">/* Ignore count */</span>,
<a name="l15110"></a>15110                      pending_break_support,
<a name="l15111"></a>15111                      ops,
<a name="l15112"></a>15112                      from_tty,
<a name="l15113"></a>15113                      1 <span class="comment">/* enabled */</span>,
<a name="l15114"></a>15114                      0 <span class="comment">/* internal */</span>, 0);
<a name="l15115"></a>15115 }
<a name="l15116"></a>15116 
<a name="l15117"></a>15117 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l15118"></a>15118 ftrace_command (<span class="keywordtype">char</span> *arg, <span class="keywordtype">int</span> from_tty)
<a name="l15119"></a>15119 {
<a name="l15120"></a>15120   <a class="code" href="breakpoint_8c.html#a9f0540734ee04440fbb9f6c3c1558d0f">create_breakpoint</a> (<a class="code" href="arch-utils_8c.html#a0fe1e68475f442e5d6dda589e0c62454">get_current_arch</a> (),
<a name="l15121"></a>15121                      arg,
<a name="l15122"></a>15122                      NULL, 0, NULL, 1 <span class="comment">/* parse arg */</span>,
<a name="l15123"></a>15123                      0 <span class="comment">/* tempflag */</span>,
<a name="l15124"></a>15124                      <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa563d27bd02a1303a86081828b40002db">bp_fast_tracepoint</a> <span class="comment">/* type_wanted */</span>,
<a name="l15125"></a>15125                      0 <span class="comment">/* Ignore count */</span>,
<a name="l15126"></a>15126                      pending_break_support,
<a name="l15127"></a>15127                      &amp;<a class="code" href="breakpoint_8c.html#ab588518ae329b0c2371895fa0efd772f">tracepoint_breakpoint_ops</a>,
<a name="l15128"></a>15128                      from_tty,
<a name="l15129"></a>15129                      1 <span class="comment">/* enabled */</span>,
<a name="l15130"></a>15130                      0 <span class="comment">/* internal */</span>, 0);
<a name="l15131"></a>15131 }
<a name="l15132"></a>15132 
<a name="l15133"></a>15133 <span class="comment">/* strace command implementation.  Creates a static tracepoint.  */</span>
<a name="l15134"></a>15134 
<a name="l15135"></a>15135 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l15136"></a>15136 strace_command (<span class="keywordtype">char</span> *arg, <span class="keywordtype">int</span> from_tty)
<a name="l15137"></a>15137 {
<a name="l15138"></a>15138   <span class="keyword">struct </span><a class="code" href="structbreakpoint__ops.html">breakpoint_ops</a> *ops;
<a name="l15139"></a>15139 
<a name="l15140"></a>15140   <span class="comment">/* Decide if we are dealing with a static tracepoint marker (`-m&#39;),</span>
<a name="l15141"></a>15141 <span class="comment">     or with a normal static tracepoint.  */</span>
<a name="l15142"></a>15142   <span class="keywordflow">if</span> (arg &amp;&amp; strncmp (arg, <span class="stringliteral">&quot;-m&quot;</span>, 2) == 0 &amp;&amp; isspace (arg[2]))
<a name="l15143"></a>15143     ops = &amp;strace_marker_breakpoint_ops;
<a name="l15144"></a>15144   <span class="keywordflow">else</span>
<a name="l15145"></a>15145     ops = &amp;<a class="code" href="breakpoint_8c.html#ab588518ae329b0c2371895fa0efd772f">tracepoint_breakpoint_ops</a>;
<a name="l15146"></a>15146 
<a name="l15147"></a>15147   <a class="code" href="breakpoint_8c.html#a9f0540734ee04440fbb9f6c3c1558d0f">create_breakpoint</a> (<a class="code" href="arch-utils_8c.html#a0fe1e68475f442e5d6dda589e0c62454">get_current_arch</a> (),
<a name="l15148"></a>15148                      arg,
<a name="l15149"></a>15149                      NULL, 0, NULL, 1 <span class="comment">/* parse arg */</span>,
<a name="l15150"></a>15150                      0 <span class="comment">/* tempflag */</span>,
<a name="l15151"></a>15151                      <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfae4357544e8e764b68ef3729aa9ac2be3">bp_static_tracepoint</a> <span class="comment">/* type_wanted */</span>,
<a name="l15152"></a>15152                      0 <span class="comment">/* Ignore count */</span>,
<a name="l15153"></a>15153                      pending_break_support,
<a name="l15154"></a>15154                      ops,
<a name="l15155"></a>15155                      from_tty,
<a name="l15156"></a>15156                      1 <span class="comment">/* enabled */</span>,
<a name="l15157"></a>15157                      0 <span class="comment">/* internal */</span>, 0);
<a name="l15158"></a>15158 }
<a name="l15159"></a>15159 
<a name="l15160"></a>15160 <span class="comment">/* Set up a fake reader function that gets command lines from a linked</span>
<a name="l15161"></a>15161 <span class="comment">   list that was acquired during tracepoint uploading.  */</span>
<a name="l15162"></a>15162 
<a name="l15163"></a>15163 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structuploaded__tp.html">uploaded_tp</a> *this_utp;
<a name="l15164"></a>15164 <span class="keyword">static</span> <span class="keywordtype">int</span> next_cmd;
<a name="l15165"></a>15165 
<a name="l15166"></a>15166 <span class="keyword">static</span> <span class="keywordtype">char</span> *
<a name="l15167"></a>15167 read_uploaded_action (<span class="keywordtype">void</span>)
<a name="l15168"></a>15168 {
<a name="l15169"></a>15169   <span class="keywordtype">char</span> *rslt;
<a name="l15170"></a>15170 
<a name="l15171"></a>15171   <a class="code" href="vec_8h.html#ae7795b0c8e65f45eb49aac5ec2c0fa52">VEC_iterate</a> (<a class="code" href="gdb__vecs_8h.html#a5ea7d3fefa2144d9bddaf2053c9691a1">char_ptr</a>, this_utp-&gt;cmd_strings, next_cmd, rslt);
<a name="l15172"></a>15172 
<a name="l15173"></a>15173   next_cmd++;
<a name="l15174"></a>15174 
<a name="l15175"></a>15175   <span class="keywordflow">return</span> rslt;
<a name="l15176"></a>15176 }
<a name="l15177"></a>15177 
<a name="l15178"></a>15178 <span class="comment">/* Given information about a tracepoint as recorded on a target (which</span>
<a name="l15179"></a>15179 <span class="comment">   can be either a live system or a trace file), attempt to create an</span>
<a name="l15180"></a>15180 <span class="comment">   equivalent GDB tracepoint.  This is not a reliable process, since</span>
<a name="l15181"></a>15181 <span class="comment">   the target does not necessarily have all the information used when</span>
<a name="l15182"></a>15182 <span class="comment">   the tracepoint was originally defined.  */</span>
<a name="l15183"></a>15183   
<a name="l15184"></a>15184 <span class="keyword">struct </span><a class="code" href="structtracepoint.html">tracepoint</a> *
<a name="l15185"></a><a class="code" href="tracepoint_8h.html#abb139ab21ba604841b086e5bfe71e196">15185</a> <a class="code" href="breakpoint_8c.html#abb139ab21ba604841b086e5bfe71e196">create_tracepoint_from_upload</a> (<span class="keyword">struct</span> <a class="code" href="structuploaded__tp.html">uploaded_tp</a> *utp)
<a name="l15186"></a>15186 {
<a name="l15187"></a>15187   <span class="keywordtype">char</span> *addr_str, small_buf[100];
<a name="l15188"></a>15188   <span class="keyword">struct </span><a class="code" href="structtracepoint.html">tracepoint</a> *tp;
<a name="l15189"></a>15189 
<a name="l15190"></a>15190   <span class="keywordflow">if</span> (utp-&gt;<a class="code" href="structuploaded__tp.html#abad64180bd34a5eef3c928e4909ce8b0">at_string</a>)
<a name="l15191"></a>15191     addr_str = utp-&gt;<a class="code" href="structuploaded__tp.html#abad64180bd34a5eef3c928e4909ce8b0">at_string</a>;
<a name="l15192"></a>15192   <span class="keywordflow">else</span>
<a name="l15193"></a>15193     {
<a name="l15194"></a>15194       <span class="comment">/* In the absence of a source location, fall back to raw</span>
<a name="l15195"></a>15195 <span class="comment">         address.  Since there is no way to confirm that the address</span>
<a name="l15196"></a>15196 <span class="comment">         means the same thing as when the trace was started, warn the</span>
<a name="l15197"></a>15197 <span class="comment">         user.  */</span>
<a name="l15198"></a>15198       <a class="code" href="utils_8c.html#a5fc201a4181499a6b4057a6caa15b5e2">warning</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Uploaded tracepoint %d has no &quot;</span>
<a name="l15199"></a>15199                  <span class="stringliteral">&quot;source location, using raw address&quot;</span>),
<a name="l15200"></a>15200                utp-&gt;<a class="code" href="structuploaded__tp.html#a58cc4be1b86f8aa20de77b27929dfe12">number</a>);
<a name="l15201"></a>15201       <a class="code" href="common-utils_8c.html#ad9940337ec98983dae9951c947879fc8">xsnprintf</a> (small_buf, <span class="keyword">sizeof</span> (small_buf), <span class="stringliteral">&quot;*%s&quot;</span>, <a class="code" href="utils_8c.html#a4178635f8faef38f4f9af755a8b16edb">hex_string</a> (utp-&gt;<a class="code" href="structuploaded__tp.html#a97572e43a086932e96df20104262d0e8">addr</a>));
<a name="l15202"></a>15202       addr_str = small_buf;
<a name="l15203"></a>15203     }
<a name="l15204"></a>15204 
<a name="l15205"></a>15205   <span class="comment">/* There&#39;s not much we can do with a sequence of bytecodes.  */</span>
<a name="l15206"></a>15206   <span class="keywordflow">if</span> (utp-&gt;<a class="code" href="structuploaded__tp.html#aa2faa5d0dcfadebb40ae25a72e3a6f37">cond</a> &amp;&amp; !utp-&gt;<a class="code" href="structuploaded__tp.html#a6413e606d74685de1dbe098ac06b8d26">cond_string</a>)
<a name="l15207"></a>15207     <a class="code" href="utils_8c.html#a5fc201a4181499a6b4057a6caa15b5e2">warning</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Uploaded tracepoint %d condition &quot;</span>
<a name="l15208"></a>15208                <span class="stringliteral">&quot;has no source form, ignoring it&quot;</span>),
<a name="l15209"></a>15209              utp-&gt;<a class="code" href="structuploaded__tp.html#a58cc4be1b86f8aa20de77b27929dfe12">number</a>);
<a name="l15210"></a>15210 
<a name="l15211"></a>15211   <span class="keywordflow">if</span> (!<a class="code" href="breakpoint_8c.html#a9f0540734ee04440fbb9f6c3c1558d0f">create_breakpoint</a> (<a class="code" href="arch-utils_8c.html#a0fe1e68475f442e5d6dda589e0c62454">get_current_arch</a> (),
<a name="l15212"></a>15212                           addr_str,
<a name="l15213"></a>15213                           utp-&gt;<a class="code" href="structuploaded__tp.html#a6413e606d74685de1dbe098ac06b8d26">cond_string</a>, -1, NULL,
<a name="l15214"></a>15214                           0 <span class="comment">/* parse cond/thread */</span>,
<a name="l15215"></a>15215                           0 <span class="comment">/* tempflag */</span>,
<a name="l15216"></a>15216                           utp-&gt;<a class="code" href="structuploaded__tp.html#a3e983c135ec77bcb96798d08c683869d">type</a> <span class="comment">/* type_wanted */</span>,
<a name="l15217"></a>15217                           0 <span class="comment">/* Ignore count */</span>,
<a name="l15218"></a>15218                           pending_break_support,
<a name="l15219"></a>15219                           &amp;<a class="code" href="breakpoint_8c.html#ab588518ae329b0c2371895fa0efd772f">tracepoint_breakpoint_ops</a>,
<a name="l15220"></a>15220                           0 <span class="comment">/* from_tty */</span>,
<a name="l15221"></a>15221                           utp-&gt;<a class="code" href="structuploaded__tp.html#ac4180327fbf6bbbc002cbe17b8bde381">enabled</a> <span class="comment">/* enabled */</span>,
<a name="l15222"></a>15222                           0 <span class="comment">/* internal */</span>,
<a name="l15223"></a>15223                           CREATE_BREAKPOINT_FLAGS_INSERTED))
<a name="l15224"></a>15224     <span class="keywordflow">return</span> NULL;
<a name="l15225"></a>15225 
<a name="l15226"></a>15226   <span class="comment">/* Get the tracepoint we just created.  */</span>
<a name="l15227"></a>15227   tp = <a class="code" href="breakpoint_8c.html#a8a2d0403a74a7a2edf8131dc2462df62">get_tracepoint</a> (tracepoint_count);
<a name="l15228"></a>15228   <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (tp != NULL);
<a name="l15229"></a>15229 
<a name="l15230"></a>15230   <span class="keywordflow">if</span> (utp-&gt;<a class="code" href="structuploaded__tp.html#ac4636b0feec50663698467304285954d">pass</a> &gt; 0)
<a name="l15231"></a>15231     {
<a name="l15232"></a>15232       <a class="code" href="common-utils_8c.html#ad9940337ec98983dae9951c947879fc8">xsnprintf</a> (small_buf, <span class="keyword">sizeof</span> (small_buf), <span class="stringliteral">&quot;%d %d&quot;</span>, utp-&gt;<a class="code" href="structuploaded__tp.html#ac4636b0feec50663698467304285954d">pass</a>,
<a name="l15233"></a>15233                  tp-&gt;<a class="code" href="structtracepoint.html#a881af30b18b555e6ff11113da6b01a02">base</a>.<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>);
<a name="l15234"></a>15234 
<a name="l15235"></a>15235       trace_pass_command (small_buf, 0);
<a name="l15236"></a>15236     }
<a name="l15237"></a>15237 
<a name="l15238"></a>15238   <span class="comment">/* If we have uploaded versions of the original commands, set up a</span>
<a name="l15239"></a>15239 <span class="comment">     special-purpose &quot;reader&quot; function and call the usual command line</span>
<a name="l15240"></a>15240 <span class="comment">     reader, then pass the result to the breakpoint command-setting</span>
<a name="l15241"></a>15241 <span class="comment">     function.  */</span>
<a name="l15242"></a>15242   <span class="keywordflow">if</span> (!<a class="code" href="vec_8h.html#ac9981d313a5e114db0e05b7b9cd16319">VEC_empty</a> (<a class="code" href="gdb__vecs_8h.html#a5ea7d3fefa2144d9bddaf2053c9691a1">char_ptr</a>, utp-&gt;cmd_strings))
<a name="l15243"></a>15243     {
<a name="l15244"></a>15244       <span class="keyword">struct </span><a class="code" href="structcommand__line.html">command_line</a> *cmd_list;
<a name="l15245"></a>15245 
<a name="l15246"></a>15246       this_utp = utp;
<a name="l15247"></a>15247       next_cmd = 0;
<a name="l15248"></a>15248 
<a name="l15249"></a>15249       cmd_list = <a class="code" href="cli-script_8c.html#a3cd1e0eb88053787269fe9562294101c">read_command_lines_1</a> (read_uploaded_action, 1, NULL, NULL);
<a name="l15250"></a>15250 
<a name="l15251"></a>15251       <a class="code" href="breakpoint_8c.html#af44da744b723fb36892418db535ed855">breakpoint_set_commands</a> (&amp;tp-&gt;<a class="code" href="structtracepoint.html#a881af30b18b555e6ff11113da6b01a02">base</a>, cmd_list);
<a name="l15252"></a>15252     }
<a name="l15253"></a>15253   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="vec_8h.html#ac9981d313a5e114db0e05b7b9cd16319">VEC_empty</a> (<a class="code" href="gdb__vecs_8h.html#a5ea7d3fefa2144d9bddaf2053c9691a1">char_ptr</a>, utp-&gt;actions)
<a name="l15254"></a>15254            || !<a class="code" href="vec_8h.html#ac9981d313a5e114db0e05b7b9cd16319">VEC_empty</a> (<a class="code" href="gdb__vecs_8h.html#a5ea7d3fefa2144d9bddaf2053c9691a1">char_ptr</a>, utp-&gt;step_actions))
<a name="l15255"></a>15255     <a class="code" href="utils_8c.html#a5fc201a4181499a6b4057a6caa15b5e2">warning</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Uploaded tracepoint %d actions &quot;</span>
<a name="l15256"></a>15256                <span class="stringliteral">&quot;have no source form, ignoring them&quot;</span>),
<a name="l15257"></a>15257              utp-&gt;<a class="code" href="structuploaded__tp.html#a58cc4be1b86f8aa20de77b27929dfe12">number</a>);
<a name="l15258"></a>15258 
<a name="l15259"></a>15259   <span class="comment">/* Copy any status information that might be available.  */</span>
<a name="l15260"></a>15260   tp-&gt;<a class="code" href="structtracepoint.html#a881af30b18b555e6ff11113da6b01a02">base</a>.<a class="code" href="structbreakpoint.html#a4431b9e9db0a123962a90e8a82419494">hit_count</a> = utp-&gt;<a class="code" href="structuploaded__tp.html#af46a3f029b74faa22ce2a4760815edd7">hit_count</a>;
<a name="l15261"></a>15261   tp-&gt;<a class="code" href="structtracepoint.html#a37aed89a4e99207a4854199a834ca7d3">traceframe_usage</a> = utp-&gt;<a class="code" href="structuploaded__tp.html#a719fe3ac2c13968739deef8283512665">traceframe_usage</a>;
<a name="l15262"></a>15262 
<a name="l15263"></a>15263   <span class="keywordflow">return</span> tp;
<a name="l15264"></a>15264 }
<a name="l15265"></a>15265   
<a name="l15266"></a>15266 <span class="comment">/* Print information on tracepoint number TPNUM_EXP, or all if</span>
<a name="l15267"></a>15267 <span class="comment">   omitted.  */</span>
<a name="l15268"></a>15268 
<a name="l15269"></a>15269 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l15270"></a>15270 tracepoints_info (<span class="keywordtype">char</span> *args, <span class="keywordtype">int</span> from_tty)
<a name="l15271"></a>15271 {
<a name="l15272"></a>15272   <span class="keyword">struct </span>ui_out *uiout = <a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>;
<a name="l15273"></a>15273   <span class="keywordtype">int</span> num_printed;
<a name="l15274"></a>15274 
<a name="l15275"></a>15275   num_printed = breakpoint_1 (args, 0, <a class="code" href="breakpoint_8c.html#ac537492fb781218601862c78225bd118">is_tracepoint</a>);
<a name="l15276"></a>15276 
<a name="l15277"></a>15277   <span class="keywordflow">if</span> (num_printed == 0)
<a name="l15278"></a>15278     {
<a name="l15279"></a>15279       <span class="keywordflow">if</span> (args == NULL || *args == <span class="charliteral">&#39;\0&#39;</span>)
<a name="l15280"></a>15280         <a class="code" href="ui-out_8c.html#a65967c27cd058d2739afdbc5a51f377e">ui_out_message</a> (uiout, 0, <span class="stringliteral">&quot;No tracepoints.\n&quot;</span>);
<a name="l15281"></a>15281       <span class="keywordflow">else</span>
<a name="l15282"></a>15282         <a class="code" href="ui-out_8c.html#a65967c27cd058d2739afdbc5a51f377e">ui_out_message</a> (uiout, 0, <span class="stringliteral">&quot;No tracepoint matching &#39;%s&#39;.\n&quot;</span>, args);
<a name="l15283"></a>15283     }
<a name="l15284"></a>15284 
<a name="l15285"></a>15285   default_collect_info ();
<a name="l15286"></a>15286 }
<a name="l15287"></a>15287 
<a name="l15288"></a>15288 <span class="comment">/* The &#39;enable trace&#39; command enables tracepoints.</span>
<a name="l15289"></a>15289 <span class="comment">   Not supported by all targets.  */</span>
<a name="l15290"></a>15290 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l15291"></a>15291 enable_trace_command (<span class="keywordtype">char</span> *args, <span class="keywordtype">int</span> from_tty)
<a name="l15292"></a>15292 {
<a name="l15293"></a>15293   enable_command (args, from_tty);
<a name="l15294"></a>15294 }
<a name="l15295"></a>15295 
<a name="l15296"></a>15296 <span class="comment">/* The &#39;disable trace&#39; command disables tracepoints.</span>
<a name="l15297"></a>15297 <span class="comment">   Not supported by all targets.  */</span>
<a name="l15298"></a>15298 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l15299"></a>15299 disable_trace_command (<span class="keywordtype">char</span> *args, <span class="keywordtype">int</span> from_tty)
<a name="l15300"></a>15300 {
<a name="l15301"></a>15301   disable_command (args, from_tty);
<a name="l15302"></a>15302 }
<a name="l15303"></a>15303 
<a name="l15304"></a>15304 <span class="comment">/* Remove a tracepoint (or all if no argument).  */</span>
<a name="l15305"></a>15305 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l15306"></a>15306 delete_trace_command (<span class="keywordtype">char</span> *arg, <span class="keywordtype">int</span> from_tty)
<a name="l15307"></a>15307 {
<a name="l15308"></a>15308   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b, *b_tmp;
<a name="l15309"></a>15309 
<a name="l15310"></a>15310   <a class="code" href="command_8h.html#ac7af34b03605d65b114a173d49532050">dont_repeat</a> ();
<a name="l15311"></a>15311 
<a name="l15312"></a>15312   <span class="keywordflow">if</span> (arg == 0)
<a name="l15313"></a>15313     {
<a name="l15314"></a>15314       <span class="keywordtype">int</span> breaks_to_delete = 0;
<a name="l15315"></a>15315 
<a name="l15316"></a>15316       <span class="comment">/* Delete all breakpoints if no argument.</span>
<a name="l15317"></a>15317 <span class="comment">         Do not delete internal or call-dummy breakpoints, these</span>
<a name="l15318"></a>15318 <span class="comment">         have to be deleted with an explicit breakpoint number </span>
<a name="l15319"></a>15319 <span class="comment">         argument.  */</span>
<a name="l15320"></a>15320       <a class="code" href="breakpoint_8c.html#ab5d28883ea0eb745187fab7613ec67d6">ALL_TRACEPOINTS</a> (b)
<a name="l15321"></a>15321         if (<a class="code" href="breakpoint_8c.html#ac537492fb781218601862c78225bd118">is_tracepoint</a> (b) &amp;&amp; <a class="code" href="breakpoint_8c.html#ac7893fb93c9f1d907b89a1655481602d">user_breakpoint_p</a> (b))
<a name="l15322"></a>15322           {
<a name="l15323"></a>15323             breaks_to_delete = 1;
<a name="l15324"></a>15324             <span class="keywordflow">break</span>;
<a name="l15325"></a>15325           }
<a name="l15326"></a>15326 
<a name="l15327"></a>15327       <span class="comment">/* Ask user only if there are some breakpoints to delete.  */</span>
<a name="l15328"></a>15328       <span class="keywordflow">if</span> (!from_tty
<a name="l15329"></a>15329           || (breaks_to_delete &amp;&amp; <a class="code" href="utils_8c.html#a4b369431cd1ce5d26bccf6b79a44c085">query</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Delete all tracepoints? &quot;</span>))))
<a name="l15330"></a>15330         {
<a name="l15331"></a>15331           <a class="code" href="breakpoint_8c.html#ace15af58ae54149fbef6d72ecb61e12d">ALL_BREAKPOINTS_SAFE</a> (b, b_tmp)
<a name="l15332"></a>15332             if (<a class="code" href="breakpoint_8c.html#ac537492fb781218601862c78225bd118">is_tracepoint</a> (b) &amp;&amp; <a class="code" href="breakpoint_8c.html#ac7893fb93c9f1d907b89a1655481602d">user_breakpoint_p</a> (b))
<a name="l15333"></a>15333               <a class="code" href="breakpoint_8c.html#a0701191361b1ed0d40d76661e88de3f4">delete_breakpoint</a> (b);
<a name="l15334"></a>15334         }
<a name="l15335"></a>15335     }
<a name="l15336"></a>15336   else
<a name="l15337"></a>15337     map_breakpoint_numbers (arg, do_map_delete_breakpoint, NULL);
<a name="l15338"></a>15338 }
<a name="l15339"></a>15339 
<a name="l15340"></a>15340 <span class="comment">/* Helper function for trace_pass_command.  */</span>
<a name="l15341"></a>15341 
<a name="l15342"></a>15342 static <span class="keywordtype">void</span>
<a name="l15343"></a>15343 trace_pass_set_count (struct <a class="code" href="structtracepoint.html">tracepoint</a> *tp, <span class="keywordtype">int</span> count, <span class="keywordtype">int</span> from_tty)
<a name="l15344"></a>15344 {
<a name="l15345"></a>15345   tp-&gt;pass_count = count;
<a name="l15346"></a>15346   <a class="code" href="observer_8h.html#a3edacfe44ac49f71646caded92072cad">observer_notify_breakpoint_modified</a> (&amp;tp-&gt;base);
<a name="l15347"></a>15347   <span class="keywordflow">if</span> (from_tty)
<a name="l15348"></a>15348     <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Setting tracepoint %d&#39;s passcount to %d\n&quot;</span>),
<a name="l15349"></a>15349                      tp-&gt;base.number, count);
<a name="l15350"></a>15350 }
<a name="l15351"></a>15351 
<a name="l15352"></a>15352 <span class="comment">/* Set passcount for tracepoint.</span>
<a name="l15353"></a>15353 <span class="comment"></span>
<a name="l15354"></a>15354 <span class="comment">   First command argument is passcount, second is tracepoint number.</span>
<a name="l15355"></a>15355 <span class="comment">   If tracepoint number omitted, apply to most recently defined.</span>
<a name="l15356"></a>15356 <span class="comment">   Also accepts special argument &quot;all&quot;.  */</span>
<a name="l15357"></a>15357 
<a name="l15358"></a>15358 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l15359"></a>15359 trace_pass_command (<span class="keywordtype">char</span> *args, <span class="keywordtype">int</span> from_tty)
<a name="l15360"></a>15360 {
<a name="l15361"></a>15361   <span class="keyword">struct </span><a class="code" href="structtracepoint.html">tracepoint</a> *t1;
<a name="l15362"></a>15362   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> count;
<a name="l15363"></a>15363 
<a name="l15364"></a>15364   <span class="keywordflow">if</span> (args == 0 || *args == 0)
<a name="l15365"></a>15365     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;passcount command requires an &quot;</span>
<a name="l15366"></a>15366              <span class="stringliteral">&quot;argument (count + optional TP num)&quot;</span>));
<a name="l15367"></a>15367 
<a name="l15368"></a>15368   count = strtoul (args, &amp;args, 10);    <span class="comment">/* Count comes first, then TP num.  */</span>
<a name="l15369"></a>15369 
<a name="l15370"></a>15370   args = <a class="code" href="cli-utils_8c.html#afa70bcaee54d487b4412d2a7a5a0c8fa">skip_spaces</a> (args);
<a name="l15371"></a>15371   <span class="keywordflow">if</span> (*args &amp;&amp; strncasecmp (args, <span class="stringliteral">&quot;all&quot;</span>, 3) == 0)
<a name="l15372"></a>15372     {
<a name="l15373"></a>15373       <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b;
<a name="l15374"></a>15374 
<a name="l15375"></a>15375       args += 3;                        <span class="comment">/* Skip special argument &quot;all&quot;.  */</span>
<a name="l15376"></a>15376       <span class="keywordflow">if</span> (*args)
<a name="l15377"></a>15377         <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Junk at end of arguments.&quot;</span>));
<a name="l15378"></a>15378 
<a name="l15379"></a>15379       <a class="code" href="breakpoint_8c.html#ab5d28883ea0eb745187fab7613ec67d6">ALL_TRACEPOINTS</a> (b)
<a name="l15380"></a>15380       {
<a name="l15381"></a>15381         t1 = (<span class="keyword">struct </span><a class="code" href="structtracepoint.html">tracepoint</a> *) b;
<a name="l15382"></a>15382         trace_pass_set_count (t1, count, from_tty);
<a name="l15383"></a>15383       }
<a name="l15384"></a>15384     }
<a name="l15385"></a>15385   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*args == <span class="charliteral">&#39;\0&#39;</span>)
<a name="l15386"></a>15386     {
<a name="l15387"></a>15387       t1 = <a class="code" href="breakpoint_8c.html#a637d18c918c6a205f28b22b1e024d3b4">get_tracepoint_by_number</a> (&amp;args, NULL, 1);
<a name="l15388"></a>15388       <span class="keywordflow">if</span> (t1)
<a name="l15389"></a>15389         trace_pass_set_count (t1, count, from_tty);
<a name="l15390"></a>15390     }
<a name="l15391"></a>15391   <span class="keywordflow">else</span>
<a name="l15392"></a>15392     {
<a name="l15393"></a>15393       <span class="keyword">struct </span><a class="code" href="structget__number__or__range__state.html">get_number_or_range_state</a> state;
<a name="l15394"></a>15394 
<a name="l15395"></a>15395       <a class="code" href="cli-utils_8c.html#a8c5a78ced74fbfc685ab08664c47fa9b">init_number_or_range</a> (&amp;state, args);
<a name="l15396"></a>15396       <span class="keywordflow">while</span> (!state.finished)
<a name="l15397"></a>15397         {
<a name="l15398"></a>15398           t1 = <a class="code" href="breakpoint_8c.html#a637d18c918c6a205f28b22b1e024d3b4">get_tracepoint_by_number</a> (&amp;args, &amp;state, 1);
<a name="l15399"></a>15399           <span class="keywordflow">if</span> (t1)
<a name="l15400"></a>15400             trace_pass_set_count (t1, count, from_tty);
<a name="l15401"></a>15401         }
<a name="l15402"></a>15402     }
<a name="l15403"></a>15403 }
<a name="l15404"></a>15404 
<a name="l15405"></a>15405 <span class="keyword">struct </span><a class="code" href="structtracepoint.html">tracepoint</a> *
<a name="l15406"></a><a class="code" href="breakpoint_8h.html#a8a2d0403a74a7a2edf8131dc2462df62">15406</a> <a class="code" href="breakpoint_8c.html#a8a2d0403a74a7a2edf8131dc2462df62">get_tracepoint</a> (<span class="keywordtype">int</span> num)
<a name="l15407"></a>15407 {
<a name="l15408"></a>15408   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *t;
<a name="l15409"></a>15409 
<a name="l15410"></a>15410   <a class="code" href="breakpoint_8c.html#ab5d28883ea0eb745187fab7613ec67d6">ALL_TRACEPOINTS</a> (t)
<a name="l15411"></a>15411     <span class="keywordflow">if</span> (t-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a> == num)
<a name="l15412"></a>15412       <span class="keywordflow">return</span> (<span class="keyword">struct</span> <a class="code" href="structtracepoint.html">tracepoint</a> *) t;
<a name="l15413"></a>15413 
<a name="l15414"></a>15414   <span class="keywordflow">return</span> NULL;
<a name="l15415"></a>15415 }
<a name="l15416"></a>15416 
<a name="l15417"></a>15417 <span class="comment">/* Find the tracepoint with the given target-side number (which may be</span>
<a name="l15418"></a>15418 <span class="comment">   different from the tracepoint number after disconnecting and</span>
<a name="l15419"></a>15419 <span class="comment">   reconnecting).  */</span>
<a name="l15420"></a>15420 
<a name="l15421"></a>15421 <span class="keyword">struct </span><a class="code" href="structtracepoint.html">tracepoint</a> *
<a name="l15422"></a><a class="code" href="breakpoint_8h.html#ac6160629aa4fcd8afc53503d861f7f90">15422</a> <a class="code" href="breakpoint_8c.html#ac6160629aa4fcd8afc53503d861f7f90">get_tracepoint_by_number_on_target</a> (<span class="keywordtype">int</span> num)
<a name="l15423"></a>15423 {
<a name="l15424"></a>15424   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b;
<a name="l15425"></a>15425 
<a name="l15426"></a>15426   <a class="code" href="breakpoint_8c.html#ab5d28883ea0eb745187fab7613ec67d6">ALL_TRACEPOINTS</a> (b)
<a name="l15427"></a>15427     {
<a name="l15428"></a>15428       <span class="keyword">struct </span><a class="code" href="structtracepoint.html">tracepoint</a> *t = (<span class="keyword">struct </span><a class="code" href="structtracepoint.html">tracepoint</a> *) b;
<a name="l15429"></a>15429 
<a name="l15430"></a>15430       <span class="keywordflow">if</span> (t-&gt;<a class="code" href="structtracepoint.html#a32f485dd859434fab98013e1738187d7">number_on_target</a> == num)
<a name="l15431"></a>15431         <span class="keywordflow">return</span> t;
<a name="l15432"></a>15432     }
<a name="l15433"></a>15433 
<a name="l15434"></a>15434   <span class="keywordflow">return</span> NULL;
<a name="l15435"></a>15435 }
<a name="l15436"></a>15436 
<a name="l15437"></a>15437 <span class="comment">/* Utility: parse a tracepoint number and look it up in the list.</span>
<a name="l15438"></a>15438 <span class="comment">   If STATE is not NULL, use, get_number_or_range_state and ignore ARG.</span>
<a name="l15439"></a>15439 <span class="comment">   If OPTIONAL_P is true, then if the argument is missing, the most</span>
<a name="l15440"></a>15440 <span class="comment">   recent tracepoint (tracepoint_count) is returned.  */</span>
<a name="l15441"></a>15441 <span class="keyword">struct </span><a class="code" href="structtracepoint.html">tracepoint</a> *
<a name="l15442"></a><a class="code" href="breakpoint_8h.html#a637d18c918c6a205f28b22b1e024d3b4">15442</a> <a class="code" href="breakpoint_8c.html#a637d18c918c6a205f28b22b1e024d3b4">get_tracepoint_by_number</a> (<span class="keywordtype">char</span> **arg,
<a name="l15443"></a>15443                           <span class="keyword">struct</span> <a class="code" href="structget__number__or__range__state.html">get_number_or_range_state</a> *state,
<a name="l15444"></a>15444                           <span class="keywordtype">int</span> optional_p)
<a name="l15445"></a>15445 {
<a name="l15446"></a>15446   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *t;
<a name="l15447"></a>15447   <span class="keywordtype">int</span> tpnum;
<a name="l15448"></a>15448   <span class="keywordtype">char</span> *instring = arg == NULL ? NULL : *arg;
<a name="l15449"></a>15449 
<a name="l15450"></a>15450   <span class="keywordflow">if</span> (state)
<a name="l15451"></a>15451     {
<a name="l15452"></a>15452       <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (!state-&gt;<a class="code" href="structget__number__or__range__state.html#a24a05f99ac52490b580655f2d97238e6">finished</a>);
<a name="l15453"></a>15453       tpnum = <a class="code" href="cli-utils_8c.html#a6d6bbeb272a5fb5ac91e7e2a20e54fef">get_number_or_range</a> (state);
<a name="l15454"></a>15454     }
<a name="l15455"></a>15455   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (arg == NULL || *arg == NULL || ! **arg)
<a name="l15456"></a>15456     {
<a name="l15457"></a>15457       <span class="keywordflow">if</span> (optional_p)
<a name="l15458"></a>15458         tpnum = tracepoint_count;
<a name="l15459"></a>15459       <span class="keywordflow">else</span>
<a name="l15460"></a>15460         <a class="code" href="cli-cmds_8c.html#a68aef78cdf72abc9df2495a4618842c3">error_no_arg</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;tracepoint number&quot;</span>));
<a name="l15461"></a>15461     }
<a name="l15462"></a>15462   <span class="keywordflow">else</span>
<a name="l15463"></a>15463     tpnum = <a class="code" href="cli-utils_8c.html#a90dc5fbdc073138a035cd142f0739e8b">get_number</a> (arg);
<a name="l15464"></a>15464 
<a name="l15465"></a>15465   <span class="keywordflow">if</span> (tpnum &lt;= 0)
<a name="l15466"></a>15466     {
<a name="l15467"></a>15467       <span class="keywordflow">if</span> (instring &amp;&amp; *instring)
<a name="l15468"></a>15468         <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;bad tracepoint number at or near &#39;%s&#39;\n&quot;</span>), 
<a name="l15469"></a>15469                          instring);
<a name="l15470"></a>15470       <span class="keywordflow">else</span>
<a name="l15471"></a>15471         <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Tracepoint argument missing &quot;</span>
<a name="l15472"></a>15472                            <span class="stringliteral">&quot;and no previous tracepoint\n&quot;</span>));
<a name="l15473"></a>15473       <span class="keywordflow">return</span> NULL;
<a name="l15474"></a>15474     }
<a name="l15475"></a>15475 
<a name="l15476"></a>15476   <a class="code" href="breakpoint_8c.html#ab5d28883ea0eb745187fab7613ec67d6">ALL_TRACEPOINTS</a> (t)
<a name="l15477"></a>15477     <span class="keywordflow">if</span> (t-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a> == tpnum)
<a name="l15478"></a>15478     {
<a name="l15479"></a>15479       <span class="keywordflow">return</span> (<span class="keyword">struct</span> <a class="code" href="structtracepoint.html">tracepoint</a> *) t;
<a name="l15480"></a>15480     }
<a name="l15481"></a>15481 
<a name="l15482"></a>15482   <a class="code" href="utils_8c.html#ad57145632bbcb0361dc1dfa134b1efd0">printf_unfiltered</a> (<span class="stringliteral">&quot;No tracepoint number %d.\n&quot;</span>, tpnum);
<a name="l15483"></a>15483   <span class="keywordflow">return</span> NULL;
<a name="l15484"></a>15484 }
<a name="l15485"></a>15485 
<a name="l15486"></a>15486 <span class="keywordtype">void</span>
<a name="l15487"></a><a class="code" href="breakpoint_8h.html#aae7cd38b01782db6011bcd0150059625">15487</a> <a class="code" href="breakpoint_8c.html#aae7cd38b01782db6011bcd0150059625">print_recreate_thread</a> (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b, <span class="keyword">struct</span> ui_file *fp)
<a name="l15488"></a>15488 {
<a name="l15489"></a>15489   <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#ae8613b6d8cf464f30ea39597be0cc192">thread</a> != -1)
<a name="l15490"></a>15490     <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (fp, <span class="stringliteral">&quot; thread %d&quot;</span>, b-&gt;<a class="code" href="structbreakpoint.html#ae8613b6d8cf464f30ea39597be0cc192">thread</a>);
<a name="l15491"></a>15491 
<a name="l15492"></a>15492   <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#a9dc2d2b94cb051b28f86f8780dbad907">task</a> != 0)
<a name="l15493"></a>15493     <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (fp, <span class="stringliteral">&quot; task %d&quot;</span>, b-&gt;<a class="code" href="structbreakpoint.html#a9dc2d2b94cb051b28f86f8780dbad907">task</a>);
<a name="l15494"></a>15494 
<a name="l15495"></a>15495   <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (fp, <span class="stringliteral">&quot;\n&quot;</span>);
<a name="l15496"></a>15496 }
<a name="l15497"></a>15497 
<a name="l15498"></a>15498 <span class="comment">/* Save information on user settable breakpoints (watchpoints, etc) to</span>
<a name="l15499"></a>15499 <span class="comment">   a new script file named FILENAME.  If FILTER is non-NULL, call it</span>
<a name="l15500"></a>15500 <span class="comment">   on each breakpoint and only include the ones for which it returns</span>
<a name="l15501"></a>15501 <span class="comment">   non-zero.  */</span>
<a name="l15502"></a>15502 
<a name="l15503"></a>15503 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l15504"></a>15504 save_breakpoints (<span class="keywordtype">char</span> *filename, <span class="keywordtype">int</span> from_tty,
<a name="l15505"></a>15505                   <span class="keywordtype">int</span> (*filter) (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *))
<a name="l15506"></a>15506 {
<a name="l15507"></a>15507   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *tp;
<a name="l15508"></a>15508   <span class="keywordtype">int</span> any = 0;
<a name="l15509"></a>15509   <span class="keyword">struct </span>cleanup *cleanup;
<a name="l15510"></a>15510   <span class="keyword">struct </span>ui_file *fp;
<a name="l15511"></a>15511   <span class="keywordtype">int</span> extra_trace_bits = 0;
<a name="l15512"></a>15512 
<a name="l15513"></a>15513   <span class="keywordflow">if</span> (filename == 0 || *filename == 0)
<a name="l15514"></a>15514     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Argument required (file name in which to save)&quot;</span>));
<a name="l15515"></a>15515 
<a name="l15516"></a>15516   <span class="comment">/* See if we have anything to save.  */</span>
<a name="l15517"></a>15517   <a class="code" href="breakpoint_8c.html#a781d5d3dc50a92364edfbacac3d0c107">ALL_BREAKPOINTS</a> (tp)
<a name="l15518"></a>15518   {
<a name="l15519"></a>15519     <span class="comment">/* Skip internal and momentary breakpoints.  */</span>
<a name="l15520"></a>15520     <span class="keywordflow">if</span> (!<a class="code" href="breakpoint_8c.html#ac7893fb93c9f1d907b89a1655481602d">user_breakpoint_p</a> (tp))
<a name="l15521"></a>15521       <span class="keywordflow">continue</span>;
<a name="l15522"></a>15522 
<a name="l15523"></a>15523     <span class="comment">/* If we have a filter, only save the breakpoints it accepts.  */</span>
<a name="l15524"></a>15524     <span class="keywordflow">if</span> (filter &amp;&amp; !filter (tp))
<a name="l15525"></a>15525       <span class="keywordflow">continue</span>;
<a name="l15526"></a>15526 
<a name="l15527"></a>15527     any = 1;
<a name="l15528"></a>15528 
<a name="l15529"></a>15529     <span class="keywordflow">if</span> (<a class="code" href="breakpoint_8c.html#ac537492fb781218601862c78225bd118">is_tracepoint</a> (tp))
<a name="l15530"></a>15530       {
<a name="l15531"></a>15531         extra_trace_bits = 1;
<a name="l15532"></a>15532 
<a name="l15533"></a>15533         <span class="comment">/* We can stop searching.  */</span>
<a name="l15534"></a>15534         <span class="keywordflow">break</span>;
<a name="l15535"></a>15535       }
<a name="l15536"></a>15536   }
<a name="l15537"></a>15537 
<a name="l15538"></a>15538   <span class="keywordflow">if</span> (!any)
<a name="l15539"></a>15539     {
<a name="l15540"></a>15540       <a class="code" href="utils_8c.html#a5fc201a4181499a6b4057a6caa15b5e2">warning</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Nothing to save.&quot;</span>));
<a name="l15541"></a>15541       <span class="keywordflow">return</span>;
<a name="l15542"></a>15542     }
<a name="l15543"></a>15543 
<a name="l15544"></a>15544   filename = tilde_expand (filename);
<a name="l15545"></a>15545   cleanup = <a class="code" href="cleanups_8c.html#a3d418f8af424aec399898c2d48b26224">make_cleanup</a> (<a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a>, filename);
<a name="l15546"></a>15546   fp = <a class="code" href="ui-file_8c.html#a3ab113067050b62e6a56f08fe86e72c5">gdb_fopen</a> (filename, <span class="stringliteral">&quot;w&quot;</span>);
<a name="l15547"></a>15547   <span class="keywordflow">if</span> (!fp)
<a name="l15548"></a>15548     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Unable to open file &#39;%s&#39; for saving (%s)&quot;</span>),
<a name="l15549"></a>15549            filename, <a class="code" href="mingw-hdep_8c.html#a69f9363599db68d3ff495cd5e78f6b62">safe_strerror</a> (errno));
<a name="l15550"></a>15550   <a class="code" href="utils_8c.html#a94dc56baeb57791e114136764f7763aa">make_cleanup_ui_file_delete</a> (fp);
<a name="l15551"></a>15551 
<a name="l15552"></a>15552   <span class="keywordflow">if</span> (extra_trace_bits)
<a name="l15553"></a>15553     <a class="code" href="tracepoint_8c.html#a3fc00a1b3f396cc0633c9eda84195002">save_trace_state_variables</a> (fp);
<a name="l15554"></a>15554 
<a name="l15555"></a>15555   <a class="code" href="breakpoint_8c.html#a781d5d3dc50a92364edfbacac3d0c107">ALL_BREAKPOINTS</a> (tp)
<a name="l15556"></a>15556   {
<a name="l15557"></a>15557     <span class="comment">/* Skip internal and momentary breakpoints.  */</span>
<a name="l15558"></a>15558     <span class="keywordflow">if</span> (!<a class="code" href="breakpoint_8c.html#ac7893fb93c9f1d907b89a1655481602d">user_breakpoint_p</a> (tp))
<a name="l15559"></a>15559       <span class="keywordflow">continue</span>;
<a name="l15560"></a>15560 
<a name="l15561"></a>15561     <span class="comment">/* If we have a filter, only save the breakpoints it accepts.  */</span>
<a name="l15562"></a>15562     <span class="keywordflow">if</span> (filter &amp;&amp; !filter (tp))
<a name="l15563"></a>15563       <span class="keywordflow">continue</span>;
<a name="l15564"></a>15564 
<a name="l15565"></a>15565     tp-&gt;<a class="code" href="structbreakpoint.html#aba258aa23496f6434aaa1cf8c8dc7ea7">ops</a>-&gt;<a class="code" href="structbreakpoint__ops.html#a218bc56decfb6ebbcf35def58b7dd271">print_recreate</a> (tp, fp);
<a name="l15566"></a>15566 
<a name="l15567"></a>15567     <span class="comment">/* Note, we can&#39;t rely on tp-&gt;number for anything, as we can&#39;t</span>
<a name="l15568"></a>15568 <span class="comment">       assume the recreated breakpoint numbers will match.  Use $bpnum</span>
<a name="l15569"></a>15569 <span class="comment">       instead.  */</span>
<a name="l15570"></a>15570 
<a name="l15571"></a>15571     <span class="keywordflow">if</span> (tp-&gt;<a class="code" href="structbreakpoint.html#a817904eee4ded1a9e18ab46709c1245b">cond_string</a>)
<a name="l15572"></a>15572       <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (fp, <span class="stringliteral">&quot;  condition $bpnum %s\n&quot;</span>, tp-&gt;<a class="code" href="structbreakpoint.html#a817904eee4ded1a9e18ab46709c1245b">cond_string</a>);
<a name="l15573"></a>15573 
<a name="l15574"></a>15574     <span class="keywordflow">if</span> (tp-&gt;<a class="code" href="structbreakpoint.html#a0e1286b838f13a04031a220f81c04d2d">ignore_count</a>)
<a name="l15575"></a>15575       <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (fp, <span class="stringliteral">&quot;  ignore $bpnum %d\n&quot;</span>, tp-&gt;<a class="code" href="structbreakpoint.html#a0e1286b838f13a04031a220f81c04d2d">ignore_count</a>);
<a name="l15576"></a>15576 
<a name="l15577"></a>15577     <span class="keywordflow">if</span> (tp-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> != <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa404b00503edb7eba238aea705ea34231">bp_dprintf</a> &amp;&amp; tp-&gt;<a class="code" href="structbreakpoint.html#a054780dffadb1a4af0fc35037834fe4b">commands</a>)
<a name="l15578"></a>15578       {
<a name="l15579"></a>15579         <span class="keyword">volatile</span> <span class="keyword">struct </span><a class="code" href="structgdb__exception.html">gdb_exception</a> ex;       
<a name="l15580"></a>15580 
<a name="l15581"></a>15581         <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (fp, <span class="stringliteral">&quot;  commands\n&quot;</span>);
<a name="l15582"></a>15582         
<a name="l15583"></a>15583         <a class="code" href="ui-out_8c.html#a6ed7ee65c5533a37f6af18d8a689cd38">ui_out_redirect</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, fp);
<a name="l15584"></a>15584         <a class="code" href="exceptions_8h.html#aef4514ee39b9305fddee27f49c7c34eb">TRY_CATCH</a> (ex, <a class="code" href="exceptions_8h.html#abfa3a3b99557b11f5766baf69465fdf6ab50fde886a7de8c013bf2bd4e7c073a4">RETURN_MASK_ALL</a>)
<a name="l15585"></a>15585           {
<a name="l15586"></a>15586             <a class="code" href="cli-script_8c.html#ab81cf0813b404cbb43a612bd704698ea">print_command_lines</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, tp-&gt;<a class="code" href="structbreakpoint.html#a054780dffadb1a4af0fc35037834fe4b">commands</a>-&gt;commands, 2);
<a name="l15587"></a>15587           }
<a name="l15588"></a>15588         <a class="code" href="ui-out_8c.html#a6ed7ee65c5533a37f6af18d8a689cd38">ui_out_redirect</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, NULL);
<a name="l15589"></a>15589 
<a name="l15590"></a>15590         <span class="keywordflow">if</span> (ex.reason &lt; 0)
<a name="l15591"></a>15591           <a class="code" href="exceptions_8c.html#a541d1b545da68efe4f8b729a945f83e7">throw_exception</a> (ex);
<a name="l15592"></a>15592 
<a name="l15593"></a>15593         <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (fp, <span class="stringliteral">&quot;  end\n&quot;</span>);
<a name="l15594"></a>15594       }
<a name="l15595"></a>15595 
<a name="l15596"></a>15596     <span class="keywordflow">if</span> (tp-&gt;<a class="code" href="structbreakpoint.html#acb53352fd35aaad37054508fabc0f3bf">enable_state</a> == <a class="code" href="breakpoint_8h.html#ad50d69fd76a14436ad8f4db078baa577a4605f207d0d15bd8195c9b1aa1bfee96">bp_disabled</a>)
<a name="l15597"></a>15597       <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (fp, <span class="stringliteral">&quot;disable\n&quot;</span>);
<a name="l15598"></a>15598 
<a name="l15599"></a>15599     <span class="comment">/* If this is a multi-location breakpoint, check if the locations</span>
<a name="l15600"></a>15600 <span class="comment">       should be individually disabled.  Watchpoint locations are</span>
<a name="l15601"></a>15601 <span class="comment">       special, and not user visible.  */</span>
<a name="l15602"></a>15602     <span class="keywordflow">if</span> (!<a class="code" href="breakpoint_8c.html#a49f0d5ff628dd506db5b81f660eb4610">is_watchpoint</a> (tp) &amp;&amp; tp-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a> &amp;&amp; tp-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>-&gt;<a class="code" href="structbp__location.html#ab193cb38f87fea89105db96d94191541">next</a>)
<a name="l15603"></a>15603       {
<a name="l15604"></a>15604         <span class="keyword">struct </span>bp_location *loc;
<a name="l15605"></a>15605         <span class="keywordtype">int</span> n = 1;
<a name="l15606"></a>15606 
<a name="l15607"></a>15607         <span class="keywordflow">for</span> (loc = tp-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>; loc != NULL; loc = loc-&gt;<a class="code" href="structbp__location.html#ab193cb38f87fea89105db96d94191541">next</a>, n++)
<a name="l15608"></a>15608           <span class="keywordflow">if</span> (!loc-&gt;<a class="code" href="structbp__location.html#abe93e091d18373d27bda3ad3eb6316f8">enabled</a>)
<a name="l15609"></a>15609             <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (fp, <span class="stringliteral">&quot;disable $bpnum.%d\n&quot;</span>, n);
<a name="l15610"></a>15610       }
<a name="l15611"></a>15611   }
<a name="l15612"></a>15612 
<a name="l15613"></a>15613   <span class="keywordflow">if</span> (extra_trace_bits &amp;&amp; *default_collect)
<a name="l15614"></a>15614     <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (fp, <span class="stringliteral">&quot;set default-collect %s\n&quot;</span>, default_collect);
<a name="l15615"></a>15615 
<a name="l15616"></a>15616   <span class="keywordflow">if</span> (from_tty)
<a name="l15617"></a>15617     <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Saved to file &#39;%s&#39;.\n&quot;</span>), filename);
<a name="l15618"></a>15618   <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (cleanup);
<a name="l15619"></a>15619 }
<a name="l15620"></a>15620 
<a name="l15621"></a>15621 <span class="comment">/* The `save breakpoints&#39; command.  */</span>
<a name="l15622"></a>15622 
<a name="l15623"></a>15623 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l15624"></a>15624 save_breakpoints_command (<span class="keywordtype">char</span> *args, <span class="keywordtype">int</span> from_tty)
<a name="l15625"></a>15625 {
<a name="l15626"></a>15626   save_breakpoints (args, from_tty, NULL);
<a name="l15627"></a>15627 }
<a name="l15628"></a>15628 
<a name="l15629"></a>15629 <span class="comment">/* The `save tracepoints&#39; command.  */</span>
<a name="l15630"></a>15630 
<a name="l15631"></a>15631 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l15632"></a>15632 save_tracepoints_command (<span class="keywordtype">char</span> *args, <span class="keywordtype">int</span> from_tty)
<a name="l15633"></a>15633 {
<a name="l15634"></a>15634   save_breakpoints (args, from_tty, <a class="code" href="breakpoint_8c.html#ac537492fb781218601862c78225bd118">is_tracepoint</a>);
<a name="l15635"></a>15635 }
<a name="l15636"></a>15636 
<a name="l15637"></a>15637 <span class="comment">/* Create a vector of all tracepoints.  */</span>
<a name="l15638"></a>15638 
<a name="l15639"></a>15639 <a class="code" href="vec_8h.html#ab084f6f29fcf16a6b15d15feb653d414">VEC</a>(<a class="code" href="structbreakpoint.html">breakpoint_p</a>) *
<a name="l15640"></a>15640 all_tracepoints (<span class="keywordtype">void</span>)
<a name="l15641"></a>15641 {
<a name="l15642"></a>15642   <a class="code" href="vec_8h.html#ab084f6f29fcf16a6b15d15feb653d414">VEC</a>(<a class="code" href="structbreakpoint.html">breakpoint_p</a>) *tp_vec = 0;
<a name="l15643"></a>15643   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *tp;
<a name="l15644"></a>15644 
<a name="l15645"></a>15645   <a class="code" href="breakpoint_8c.html#ab5d28883ea0eb745187fab7613ec67d6">ALL_TRACEPOINTS</a> (tp)
<a name="l15646"></a>15646   {
<a name="l15647"></a>15647     <a class="code" href="vec_8h.html#a8d090c0524726d00931070e0c438ba3f">VEC_safe_push</a> (<a class="code" href="structbreakpoint.html">breakpoint_p</a>, tp_vec, tp);
<a name="l15648"></a>15648   }
<a name="l15649"></a>15649 
<a name="l15650"></a>15650   <span class="keywordflow">return</span> tp_vec;
<a name="l15651"></a>15651 }
<a name="l15652"></a>15652 
<a name="l15653"></a>15653 
<a name="l15654"></a>15654 <span class="comment">/* This help string is used for the break, hbreak, tbreak and thbreak</span>
<a name="l15655"></a>15655 <span class="comment">   commands.  It is defined as a macro to prevent duplication.</span>
<a name="l15656"></a>15656 <span class="comment">   COMMAND should be a string constant containing the name of the</span>
<a name="l15657"></a>15657 <span class="comment">   command.  */</span>
<a name="l15658"></a><a class="code" href="breakpoint_8c.html#a9d42163f35217654ad290c99fabf329d">15658</a> <span class="preprocessor">#define BREAK_ARGS_HELP(command) \</span>
<a name="l15659"></a>15659 <span class="preprocessor">command&quot; [PROBE_MODIFIER] [LOCATION] [thread THREADNUM] [if CONDITION]\n\</span>
<a name="l15660"></a>15660 <span class="preprocessor">PROBE_MODIFIER shall be present if the command is to be placed in a\n\</span>
<a name="l15661"></a>15661 <span class="preprocessor">probe point.  Accepted values are `-probe&#39; (for a generic, automatically\n\</span>
<a name="l15662"></a>15662 <span class="preprocessor">guessed probe type) or `-probe-stap&#39; (for a SystemTap probe).\n\</span>
<a name="l15663"></a>15663 <span class="preprocessor">LOCATION may be a line number, function name, or \&quot;*\&quot; and an address.\n\</span>
<a name="l15664"></a>15664 <span class="preprocessor">If a line number is specified, break at start of code for that line.\n\</span>
<a name="l15665"></a>15665 <span class="preprocessor">If a function is specified, break at start of code for that function.\n\</span>
<a name="l15666"></a>15666 <span class="preprocessor">If an address is specified, break at that exact address.\n\</span>
<a name="l15667"></a>15667 <span class="preprocessor">With no LOCATION, uses current execution address of the selected\n\</span>
<a name="l15668"></a>15668 <span class="preprocessor">stack frame.  This is useful for breaking on return to a stack frame.\n\</span>
<a name="l15669"></a>15669 <span class="preprocessor">\n\</span>
<a name="l15670"></a>15670 <span class="preprocessor">THREADNUM is the number from \&quot;info threads\&quot;.\n\</span>
<a name="l15671"></a>15671 <span class="preprocessor">CONDITION is a boolean expression.\n\</span>
<a name="l15672"></a>15672 <span class="preprocessor">\n\</span>
<a name="l15673"></a>15673 <span class="preprocessor">Multiple breakpoints at one place are permitted, and useful if their\n\</span>
<a name="l15674"></a>15674 <span class="preprocessor">conditions are different.\n\</span>
<a name="l15675"></a>15675 <span class="preprocessor">\n\</span>
<a name="l15676"></a>15676 <span class="preprocessor">Do \&quot;help breakpoints\&quot; for info on other commands dealing with breakpoints.&quot;</span>
<a name="l15677"></a>15677 <span class="preprocessor"></span>
<a name="l15678"></a>15678 <span class="comment">/* List of subcommands for &quot;catch&quot;.  */</span>
<a name="l15679"></a>15679 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structcmd__list__element.html">cmd_list_element</a> *catch_cmdlist;
<a name="l15680"></a>15680 
<a name="l15681"></a>15681 <span class="comment">/* List of subcommands for &quot;tcatch&quot;.  */</span>
<a name="l15682"></a>15682 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structcmd__list__element.html">cmd_list_element</a> *tcatch_cmdlist;
<a name="l15683"></a>15683 
<a name="l15684"></a>15684 <span class="keywordtype">void</span>
<a name="l15685"></a><a class="code" href="breakpoint_8h.html#a2f9b60e7aa76c6796bf67b46a1f758ce">15685</a> <a class="code" href="breakpoint_8c.html#a2f9b60e7aa76c6796bf67b46a1f758ce">add_catch_command</a> (<span class="keywordtype">char</span> *name, <span class="keywordtype">char</span> *docstring,
<a name="l15686"></a>15686                    <span class="keywordtype">void</span> (*<a class="code" href="structcmd__list__element.html#a90d41ba9e4aaecf9d8560261db3ddacb">sfunc</a>) (<span class="keywordtype">char</span> *args, <span class="keywordtype">int</span> from_tty,
<a name="l15687"></a>15687                                   <span class="keyword">struct</span> <a class="code" href="structcmd__list__element.html">cmd_list_element</a> *command),
<a name="l15688"></a>15688                    completer_ftype *<a class="code" href="structcmd__list__element.html#a7bc6bf3a762bc1e7be8ce3d0a28affeb">completer</a>,
<a name="l15689"></a>15689                    <span class="keywordtype">void</span> *user_data_catch,
<a name="l15690"></a>15690                    <span class="keywordtype">void</span> *user_data_tcatch)
<a name="l15691"></a>15691 {
<a name="l15692"></a>15692   <span class="keyword">struct </span><a class="code" href="structcmd__list__element.html">cmd_list_element</a> *command;
<a name="l15693"></a>15693 
<a name="l15694"></a>15694   command = <a class="code" href="cli-decode_8c.html#ab87b0ba51ed9aa4c8aac0c96373537f8">add_cmd</a> (name, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a803cb23b7faac7d3b865a0e6de82eda7">class_breakpoint</a>, NULL, docstring,
<a name="l15695"></a>15695                      &amp;catch_cmdlist);
<a name="l15696"></a>15696   <a class="code" href="cli-decode_8c.html#a6063d42a1748110bf1383183e3d8b6b1">set_cmd_sfunc</a> (command, <a class="code" href="structcmd__list__element.html#a90d41ba9e4aaecf9d8560261db3ddacb">sfunc</a>);
<a name="l15697"></a>15697   <a class="code" href="cli-decode_8c.html#af95ac5cd38e6d4ec47d30aa5e56b005c">set_cmd_context</a> (command, user_data_catch);
<a name="l15698"></a>15698   <a class="code" href="command_8h.html#abe42a75e35cfa78e2574e94904d86713">set_cmd_completer</a> (command, completer);
<a name="l15699"></a>15699 
<a name="l15700"></a>15700   command = <a class="code" href="cli-decode_8c.html#ab87b0ba51ed9aa4c8aac0c96373537f8">add_cmd</a> (name, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a803cb23b7faac7d3b865a0e6de82eda7">class_breakpoint</a>, NULL, docstring,
<a name="l15701"></a>15701                      &amp;tcatch_cmdlist);
<a name="l15702"></a>15702   <a class="code" href="cli-decode_8c.html#a6063d42a1748110bf1383183e3d8b6b1">set_cmd_sfunc</a> (command, <a class="code" href="structcmd__list__element.html#a90d41ba9e4aaecf9d8560261db3ddacb">sfunc</a>);
<a name="l15703"></a>15703   <a class="code" href="cli-decode_8c.html#af95ac5cd38e6d4ec47d30aa5e56b005c">set_cmd_context</a> (command, user_data_tcatch);
<a name="l15704"></a>15704   <a class="code" href="command_8h.html#abe42a75e35cfa78e2574e94904d86713">set_cmd_completer</a> (command, completer);
<a name="l15705"></a>15705 }
<a name="l15706"></a>15706 
<a name="l15707"></a>15707 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l15708"></a>15708 clear_syscall_counts (<span class="keyword">struct</span> inferior *inf)
<a name="l15709"></a>15709 {
<a name="l15710"></a>15710   <span class="keyword">struct </span>catch_syscall_inferior_data *inf_data
<a name="l15711"></a>15711     = get_catch_syscall_inferior_data (inf);
<a name="l15712"></a>15712 
<a name="l15713"></a>15713   inf_data-&gt;total_syscalls_count = 0;
<a name="l15714"></a>15714   inf_data-&gt;any_syscall_count = 0;
<a name="l15715"></a>15715   <a class="code" href="vec_8h.html#af5724b2bbce65103300279f9abe7f577">VEC_free</a> (<span class="keywordtype">int</span>, inf_data-&gt;syscalls_counts);
<a name="l15716"></a>15716 }
<a name="l15717"></a>15717 
<a name="l15718"></a>15718 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l15719"></a>15719 save_command (<span class="keywordtype">char</span> *arg, <span class="keywordtype">int</span> from_tty)
<a name="l15720"></a>15720 {
<a name="l15721"></a>15721   <a class="code" href="utils_8c.html#ad57145632bbcb0361dc1dfa134b1efd0">printf_unfiltered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\&quot;save\&quot; must be followed by &quot;</span>
<a name="l15722"></a>15722                        <span class="stringliteral">&quot;the name of a save subcommand.\n&quot;</span>));
<a name="l15723"></a>15723   <a class="code" href="cli-decode_8c.html#a2ae762f5189f3597666852868defc038">help_list</a> (save_cmdlist, <span class="stringliteral">&quot;save &quot;</span>, -1, <a class="code" href="main_8c.html#a41a2b997ba5454df787d61f051dd918c">gdb_stdout</a>);
<a name="l15724"></a>15724 }
<a name="l15725"></a>15725 
<a name="l15726"></a>15726 <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *
<a name="l15727"></a><a class="code" href="breakpoint_8h.html#ab7c1f5d77b0b164656ac953a15f120f2">15727</a> <a class="code" href="breakpoint_8c.html#a66966fb39739a41307b0e828c7a63dc9">iterate_over_breakpoints</a> (<span class="keywordtype">int</span> (*callback) (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *, <span class="keywordtype">void</span> *),
<a name="l15728"></a>15728                           <span class="keywordtype">void</span> *data)
<a name="l15729"></a>15729 {
<a name="l15730"></a>15730   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b, *b_tmp;
<a name="l15731"></a>15731 
<a name="l15732"></a>15732   <a class="code" href="breakpoint_8c.html#ace15af58ae54149fbef6d72ecb61e12d">ALL_BREAKPOINTS_SAFE</a> (b, b_tmp)
<a name="l15733"></a>15733     {
<a name="l15734"></a>15734       <span class="keywordflow">if</span> ((*callback) (b, data))
<a name="l15735"></a>15735         <span class="keywordflow">return</span> b;
<a name="l15736"></a>15736     }
<a name="l15737"></a>15737 
<a name="l15738"></a>15738   <span class="keywordflow">return</span> NULL;
<a name="l15739"></a>15739 }
<a name="l15740"></a>15740 
<a name="l15741"></a>15741 <span class="comment">/* Zero if any of the breakpoint&#39;s locations could be a location where</span>
<a name="l15742"></a>15742 <span class="comment">   functions have been inlined, nonzero otherwise.  */</span>
<a name="l15743"></a>15743 
<a name="l15744"></a>15744 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l15745"></a>15745 is_non_inline_function (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b)
<a name="l15746"></a>15746 {
<a name="l15747"></a>15747   <span class="comment">/* The shared library event breakpoint is set on the address of a</span>
<a name="l15748"></a>15748 <span class="comment">     non-inline function.  */</span>
<a name="l15749"></a>15749   <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#aefce6e7d22540b3fffaecd1264a0f73f">type</a> == <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa7ff3ee755a0635e1c8aa45bbeba6734a">bp_shlib_event</a>)
<a name="l15750"></a>15750     <span class="keywordflow">return</span> 1;
<a name="l15751"></a>15751 
<a name="l15752"></a>15752   <span class="keywordflow">return</span> 0;
<a name="l15753"></a>15753 }
<a name="l15754"></a>15754 
<a name="l15755"></a>15755 <span class="comment">/* Nonzero if the specified PC cannot be a location where functions</span>
<a name="l15756"></a>15756 <span class="comment">   have been inlined.  */</span>
<a name="l15757"></a>15757 
<a name="l15758"></a>15758 <span class="keywordtype">int</span>
<a name="l15759"></a><a class="code" href="breakpoint_8h.html#a6fc60150b02370e6ed34a4993f025c5c">15759</a> <a class="code" href="breakpoint_8c.html#a6fc60150b02370e6ed34a4993f025c5c">pc_at_non_inline_function</a> (<span class="keyword">struct</span> address_space *aspace, <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> pc,
<a name="l15760"></a>15760                            <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structtarget__waitstatus.html">target_waitstatus</a> *ws)
<a name="l15761"></a>15761 {
<a name="l15762"></a>15762   <span class="keyword">struct </span><a class="code" href="structbreakpoint.html">breakpoint</a> *b;
<a name="l15763"></a>15763   <span class="keyword">struct </span>bp_location *bl;
<a name="l15764"></a>15764 
<a name="l15765"></a>15765   <a class="code" href="breakpoint_8c.html#a781d5d3dc50a92364edfbacac3d0c107">ALL_BREAKPOINTS</a> (b)
<a name="l15766"></a>15766     {
<a name="l15767"></a>15767       <span class="keywordflow">if</span> (!is_non_inline_function (b))
<a name="l15768"></a>15768         <span class="keywordflow">continue</span>;
<a name="l15769"></a>15769 
<a name="l15770"></a>15770       <span class="keywordflow">for</span> (bl = b-&gt;<a class="code" href="structbreakpoint.html#aa869260f7e4c94204275861d820bb1a9">loc</a>; bl != NULL; bl = bl-&gt;<a class="code" href="structbp__location.html#ab193cb38f87fea89105db96d94191541">next</a>)
<a name="l15771"></a>15771         {
<a name="l15772"></a>15772           <span class="keywordflow">if</span> (!bl-&gt;<a class="code" href="structbp__location.html#a3732b41958ed311106bffd202cbfe4ff">shlib_disabled</a>
<a name="l15773"></a>15773               &amp;&amp; bpstat_check_location (bl, aspace, pc, ws))
<a name="l15774"></a>15774             <span class="keywordflow">return</span> 1;
<a name="l15775"></a>15775         }
<a name="l15776"></a>15776     }
<a name="l15777"></a>15777 
<a name="l15778"></a>15778   <span class="keywordflow">return</span> 0;
<a name="l15779"></a>15779 }
<a name="l15780"></a>15780 
<a name="l15781"></a>15781 <span class="comment">/* Remove any references to OBJFILE which is going to be freed.  */</span>
<a name="l15782"></a>15782 
<a name="l15783"></a>15783 <span class="keywordtype">void</span>
<a name="l15784"></a><a class="code" href="breakpoint_8h.html#a7db1bd2d7b10df9c632163c7568d63ff">15784</a> <a class="code" href="breakpoint_8c.html#a7db1bd2d7b10df9c632163c7568d63ff">breakpoint_free_objfile</a> (<span class="keyword">struct</span> objfile *objfile)
<a name="l15785"></a>15785 {
<a name="l15786"></a>15786   <span class="keyword">struct </span>bp_location **locp, *loc;
<a name="l15787"></a>15787 
<a name="l15788"></a>15788   <a class="code" href="breakpoint_8c.html#a6f97c7962df1d91150e0e8de40ff7fe4">ALL_BP_LOCATIONS</a> (loc, locp)
<a name="l15789"></a>15789     <span class="keywordflow">if</span> (loc-&gt;<a class="code" href="structbp__location.html#a1fbe0229a1e449ad3f855dc443869239">symtab</a> != NULL &amp;&amp; loc-&gt;<a class="code" href="structbp__location.html#a1fbe0229a1e449ad3f855dc443869239">symtab</a>-&gt;<a class="code" href="structsymtab.html#a5fbe801333fb00c20190a6193b708be0">objfile</a> == objfile)
<a name="l15790"></a>15790       loc-&gt;<a class="code" href="structbp__location.html#a1fbe0229a1e449ad3f855dc443869239">symtab</a> = NULL;
<a name="l15791"></a>15791 }
<a name="l15792"></a>15792 
<a name="l15793"></a>15793 <span class="keywordtype">void</span>
<a name="l15794"></a><a class="code" href="breakpoint_8h.html#a1576e03931c016f098138a3e4cfabb66">15794</a> <a class="code" href="breakpoint_8c.html#a1576e03931c016f098138a3e4cfabb66">initialize_breakpoint_ops</a> (<span class="keywordtype">void</span>)
<a name="l15795"></a>15795 {
<a name="l15796"></a>15796   <span class="keyword">static</span> <span class="keywordtype">int</span> initialized = 0;
<a name="l15797"></a>15797 
<a name="l15798"></a>15798   <span class="keyword">struct </span><a class="code" href="structbreakpoint__ops.html">breakpoint_ops</a> *ops;
<a name="l15799"></a>15799 
<a name="l15800"></a>15800   <span class="keywordflow">if</span> (initialized)
<a name="l15801"></a>15801     <span class="keywordflow">return</span>;
<a name="l15802"></a>15802   initialized = 1;
<a name="l15803"></a>15803 
<a name="l15804"></a>15804   <span class="comment">/* The breakpoint_ops structure to be inherit by all kinds of</span>
<a name="l15805"></a>15805 <span class="comment">     breakpoints (real breakpoints, i.e., user &quot;break&quot; breakpoints,</span>
<a name="l15806"></a>15806 <span class="comment">     internal and momentary breakpoints, etc.).  */</span>
<a name="l15807"></a>15807   ops = &amp;bkpt_base_breakpoint_ops;
<a name="l15808"></a>15808   *ops = <a class="code" href="breakpoint_8c.html#aefe1d12780f2d7ae5fb89ac113e204e0">base_breakpoint_ops</a>;
<a name="l15809"></a>15809   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a42f6ff20f3eb39f78874c914d34e09b5">re_set</a> = bkpt_re_set;
<a name="l15810"></a>15810   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a36581d1abf4c42e5b9aac2febd1b72ff">insert_location</a> = bkpt_insert_location;
<a name="l15811"></a>15811   ops-&gt;<a class="code" href="structbreakpoint__ops.html#ad2f8547a4949f5480fa4c4dc7487cb78">remove_location</a> = bkpt_remove_location;
<a name="l15812"></a>15812   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a4aa8d8d1c3a346f7e7efa58474697a90">breakpoint_hit</a> = bkpt_breakpoint_hit;
<a name="l15813"></a>15813   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a5d8cd9819fd3e8131e0a2627a1e3b81d">create_sals_from_address</a> = bkpt_create_sals_from_address;
<a name="l15814"></a>15814   ops-&gt;<a class="code" href="structbreakpoint__ops.html#aa79150c4ebd418f67e92eba37abded26">create_breakpoints_sal</a> = bkpt_create_breakpoints_sal;
<a name="l15815"></a>15815   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a9b0bf463a18067e3d5eb37b50cc6219b">decode_linespec</a> = bkpt_decode_linespec;
<a name="l15816"></a>15816 
<a name="l15817"></a>15817   <span class="comment">/* The breakpoint_ops structure to be used in regular breakpoints.  */</span>
<a name="l15818"></a>15818   ops = &amp;<a class="code" href="breakpoint_8c.html#a9b47dd7cd982ec63ffd303246d93cf7a">bkpt_breakpoint_ops</a>;
<a name="l15819"></a>15819   *ops = bkpt_base_breakpoint_ops;
<a name="l15820"></a>15820   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a42f6ff20f3eb39f78874c914d34e09b5">re_set</a> = bkpt_re_set;
<a name="l15821"></a>15821   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a372a323c3f122204085f7faf52bd2adb">resources_needed</a> = bkpt_resources_needed;
<a name="l15822"></a>15822   ops-&gt;<a class="code" href="structbreakpoint__ops.html#aa8d21fdff10f7839583383d6397fe6a0">print_it</a> = bkpt_print_it;
<a name="l15823"></a>15823   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a56e47601d6d5230479033e7b7b2d910e">print_mention</a> = bkpt_print_mention;
<a name="l15824"></a>15824   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a218bc56decfb6ebbcf35def58b7dd271">print_recreate</a> = bkpt_print_recreate;
<a name="l15825"></a>15825 
<a name="l15826"></a>15826   <span class="comment">/* Ranged breakpoints.  */</span>
<a name="l15827"></a>15827   ops = &amp;ranged_breakpoint_ops;
<a name="l15828"></a>15828   *ops = <a class="code" href="breakpoint_8c.html#a9b47dd7cd982ec63ffd303246d93cf7a">bkpt_breakpoint_ops</a>;
<a name="l15829"></a>15829   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a4aa8d8d1c3a346f7e7efa58474697a90">breakpoint_hit</a> = breakpoint_hit_ranged_breakpoint;
<a name="l15830"></a>15830   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a372a323c3f122204085f7faf52bd2adb">resources_needed</a> = resources_needed_ranged_breakpoint;
<a name="l15831"></a>15831   ops-&gt;<a class="code" href="structbreakpoint__ops.html#aa8d21fdff10f7839583383d6397fe6a0">print_it</a> = print_it_ranged_breakpoint;
<a name="l15832"></a>15832   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a20a11e27ae594ff232488495fd0a0476">print_one</a> = print_one_ranged_breakpoint;
<a name="l15833"></a>15833   ops-&gt;<a class="code" href="structbreakpoint__ops.html#ae62b41b11f54d236edaf365bd4aab8ba">print_one_detail</a> = print_one_detail_ranged_breakpoint;
<a name="l15834"></a>15834   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a56e47601d6d5230479033e7b7b2d910e">print_mention</a> = print_mention_ranged_breakpoint;
<a name="l15835"></a>15835   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a218bc56decfb6ebbcf35def58b7dd271">print_recreate</a> = print_recreate_ranged_breakpoint;
<a name="l15836"></a>15836 
<a name="l15837"></a>15837   <span class="comment">/* Internal breakpoints.  */</span>
<a name="l15838"></a>15838   ops = &amp;internal_breakpoint_ops;
<a name="l15839"></a>15839   *ops = bkpt_base_breakpoint_ops;
<a name="l15840"></a>15840   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a42f6ff20f3eb39f78874c914d34e09b5">re_set</a> = internal_bkpt_re_set;
<a name="l15841"></a>15841   ops-&gt;<a class="code" href="structbreakpoint__ops.html#afd5b5a27bf4d9d9d49b267507b0633c4">check_status</a> = internal_bkpt_check_status;
<a name="l15842"></a>15842   ops-&gt;<a class="code" href="structbreakpoint__ops.html#aa8d21fdff10f7839583383d6397fe6a0">print_it</a> = internal_bkpt_print_it;
<a name="l15843"></a>15843   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a56e47601d6d5230479033e7b7b2d910e">print_mention</a> = internal_bkpt_print_mention;
<a name="l15844"></a>15844 
<a name="l15845"></a>15845   <span class="comment">/* Momentary breakpoints.  */</span>
<a name="l15846"></a>15846   ops = &amp;momentary_breakpoint_ops;
<a name="l15847"></a>15847   *ops = bkpt_base_breakpoint_ops;
<a name="l15848"></a>15848   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a42f6ff20f3eb39f78874c914d34e09b5">re_set</a> = momentary_bkpt_re_set;
<a name="l15849"></a>15849   ops-&gt;<a class="code" href="structbreakpoint__ops.html#afd5b5a27bf4d9d9d49b267507b0633c4">check_status</a> = momentary_bkpt_check_status;
<a name="l15850"></a>15850   ops-&gt;<a class="code" href="structbreakpoint__ops.html#aa8d21fdff10f7839583383d6397fe6a0">print_it</a> = momentary_bkpt_print_it;
<a name="l15851"></a>15851   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a56e47601d6d5230479033e7b7b2d910e">print_mention</a> = momentary_bkpt_print_mention;
<a name="l15852"></a>15852 
<a name="l15853"></a>15853   <span class="comment">/* Momentary breakpoints for bp_longjmp and bp_exception.  */</span>
<a name="l15854"></a>15854   ops = &amp;longjmp_breakpoint_ops;
<a name="l15855"></a>15855   *ops = momentary_breakpoint_ops;
<a name="l15856"></a>15856   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a110b2df7b285e5f83bf40b9a0e5435c1">dtor</a> = longjmp_bkpt_dtor;
<a name="l15857"></a>15857 
<a name="l15858"></a>15858   <span class="comment">/* Probe breakpoints.  */</span>
<a name="l15859"></a>15859   ops = &amp;bkpt_probe_breakpoint_ops;
<a name="l15860"></a>15860   *ops = <a class="code" href="breakpoint_8c.html#a9b47dd7cd982ec63ffd303246d93cf7a">bkpt_breakpoint_ops</a>;
<a name="l15861"></a>15861   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a36581d1abf4c42e5b9aac2febd1b72ff">insert_location</a> = bkpt_probe_insert_location;
<a name="l15862"></a>15862   ops-&gt;<a class="code" href="structbreakpoint__ops.html#ad2f8547a4949f5480fa4c4dc7487cb78">remove_location</a> = bkpt_probe_remove_location;
<a name="l15863"></a>15863   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a5d8cd9819fd3e8131e0a2627a1e3b81d">create_sals_from_address</a> = bkpt_probe_create_sals_from_address;
<a name="l15864"></a>15864   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a9b0bf463a18067e3d5eb37b50cc6219b">decode_linespec</a> = bkpt_probe_decode_linespec;
<a name="l15865"></a>15865 
<a name="l15866"></a>15866   <span class="comment">/* Watchpoints.  */</span>
<a name="l15867"></a>15867   ops = &amp;watchpoint_breakpoint_ops;
<a name="l15868"></a>15868   *ops = <a class="code" href="breakpoint_8c.html#aefe1d12780f2d7ae5fb89ac113e204e0">base_breakpoint_ops</a>;
<a name="l15869"></a>15869   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a110b2df7b285e5f83bf40b9a0e5435c1">dtor</a> = dtor_watchpoint;
<a name="l15870"></a>15870   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a42f6ff20f3eb39f78874c914d34e09b5">re_set</a> = re_set_watchpoint;
<a name="l15871"></a>15871   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a36581d1abf4c42e5b9aac2febd1b72ff">insert_location</a> = insert_watchpoint;
<a name="l15872"></a>15872   ops-&gt;<a class="code" href="structbreakpoint__ops.html#ad2f8547a4949f5480fa4c4dc7487cb78">remove_location</a> = remove_watchpoint;
<a name="l15873"></a>15873   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a4aa8d8d1c3a346f7e7efa58474697a90">breakpoint_hit</a> = breakpoint_hit_watchpoint;
<a name="l15874"></a>15874   ops-&gt;<a class="code" href="structbreakpoint__ops.html#afd5b5a27bf4d9d9d49b267507b0633c4">check_status</a> = check_status_watchpoint;
<a name="l15875"></a>15875   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a372a323c3f122204085f7faf52bd2adb">resources_needed</a> = resources_needed_watchpoint;
<a name="l15876"></a>15876   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a733bd8f4226e832bf9992b3352e0e8b5">works_in_software_mode</a> = works_in_software_mode_watchpoint;
<a name="l15877"></a>15877   ops-&gt;<a class="code" href="structbreakpoint__ops.html#aa8d21fdff10f7839583383d6397fe6a0">print_it</a> = print_it_watchpoint;
<a name="l15878"></a>15878   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a56e47601d6d5230479033e7b7b2d910e">print_mention</a> = print_mention_watchpoint;
<a name="l15879"></a>15879   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a218bc56decfb6ebbcf35def58b7dd271">print_recreate</a> = print_recreate_watchpoint;
<a name="l15880"></a>15880   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a5d8be90b4517d50f92133e164e1b5c93">explains_signal</a> = explains_signal_watchpoint;
<a name="l15881"></a>15881 
<a name="l15882"></a>15882   <span class="comment">/* Masked watchpoints.  */</span>
<a name="l15883"></a>15883   ops = &amp;masked_watchpoint_breakpoint_ops;
<a name="l15884"></a>15884   *ops = watchpoint_breakpoint_ops;
<a name="l15885"></a>15885   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a36581d1abf4c42e5b9aac2febd1b72ff">insert_location</a> = insert_masked_watchpoint;
<a name="l15886"></a>15886   ops-&gt;<a class="code" href="structbreakpoint__ops.html#ad2f8547a4949f5480fa4c4dc7487cb78">remove_location</a> = remove_masked_watchpoint;
<a name="l15887"></a>15887   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a372a323c3f122204085f7faf52bd2adb">resources_needed</a> = resources_needed_masked_watchpoint;
<a name="l15888"></a>15888   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a733bd8f4226e832bf9992b3352e0e8b5">works_in_software_mode</a> = works_in_software_mode_masked_watchpoint;
<a name="l15889"></a>15889   ops-&gt;<a class="code" href="structbreakpoint__ops.html#aa8d21fdff10f7839583383d6397fe6a0">print_it</a> = print_it_masked_watchpoint;
<a name="l15890"></a>15890   ops-&gt;<a class="code" href="structbreakpoint__ops.html#ae62b41b11f54d236edaf365bd4aab8ba">print_one_detail</a> = print_one_detail_masked_watchpoint;
<a name="l15891"></a>15891   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a56e47601d6d5230479033e7b7b2d910e">print_mention</a> = print_mention_masked_watchpoint;
<a name="l15892"></a>15892   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a218bc56decfb6ebbcf35def58b7dd271">print_recreate</a> = print_recreate_masked_watchpoint;
<a name="l15893"></a>15893 
<a name="l15894"></a>15894   <span class="comment">/* Tracepoints.  */</span>
<a name="l15895"></a>15895   ops = &amp;<a class="code" href="breakpoint_8c.html#ab588518ae329b0c2371895fa0efd772f">tracepoint_breakpoint_ops</a>;
<a name="l15896"></a>15896   *ops = <a class="code" href="breakpoint_8c.html#aefe1d12780f2d7ae5fb89ac113e204e0">base_breakpoint_ops</a>;
<a name="l15897"></a>15897   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a42f6ff20f3eb39f78874c914d34e09b5">re_set</a> = tracepoint_re_set;
<a name="l15898"></a>15898   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a4aa8d8d1c3a346f7e7efa58474697a90">breakpoint_hit</a> = tracepoint_breakpoint_hit;
<a name="l15899"></a>15899   ops-&gt;<a class="code" href="structbreakpoint__ops.html#ae62b41b11f54d236edaf365bd4aab8ba">print_one_detail</a> = tracepoint_print_one_detail;
<a name="l15900"></a>15900   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a56e47601d6d5230479033e7b7b2d910e">print_mention</a> = tracepoint_print_mention;
<a name="l15901"></a>15901   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a218bc56decfb6ebbcf35def58b7dd271">print_recreate</a> = tracepoint_print_recreate;
<a name="l15902"></a>15902   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a5d8cd9819fd3e8131e0a2627a1e3b81d">create_sals_from_address</a> = tracepoint_create_sals_from_address;
<a name="l15903"></a>15903   ops-&gt;<a class="code" href="structbreakpoint__ops.html#aa79150c4ebd418f67e92eba37abded26">create_breakpoints_sal</a> = tracepoint_create_breakpoints_sal;
<a name="l15904"></a>15904   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a9b0bf463a18067e3d5eb37b50cc6219b">decode_linespec</a> = tracepoint_decode_linespec;
<a name="l15905"></a>15905 
<a name="l15906"></a>15906   <span class="comment">/* Probe tracepoints.  */</span>
<a name="l15907"></a>15907   ops = &amp;tracepoint_probe_breakpoint_ops;
<a name="l15908"></a>15908   *ops = <a class="code" href="breakpoint_8c.html#ab588518ae329b0c2371895fa0efd772f">tracepoint_breakpoint_ops</a>;
<a name="l15909"></a>15909   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a5d8cd9819fd3e8131e0a2627a1e3b81d">create_sals_from_address</a> = tracepoint_probe_create_sals_from_address;
<a name="l15910"></a>15910   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a9b0bf463a18067e3d5eb37b50cc6219b">decode_linespec</a> = tracepoint_probe_decode_linespec;
<a name="l15911"></a>15911 
<a name="l15912"></a>15912   <span class="comment">/* Static tracepoints with marker (`-m&#39;).  */</span>
<a name="l15913"></a>15913   ops = &amp;strace_marker_breakpoint_ops;
<a name="l15914"></a>15914   *ops = <a class="code" href="breakpoint_8c.html#ab588518ae329b0c2371895fa0efd772f">tracepoint_breakpoint_ops</a>;
<a name="l15915"></a>15915   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a5d8cd9819fd3e8131e0a2627a1e3b81d">create_sals_from_address</a> = strace_marker_create_sals_from_address;
<a name="l15916"></a>15916   ops-&gt;<a class="code" href="structbreakpoint__ops.html#aa79150c4ebd418f67e92eba37abded26">create_breakpoints_sal</a> = strace_marker_create_breakpoints_sal;
<a name="l15917"></a>15917   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a9b0bf463a18067e3d5eb37b50cc6219b">decode_linespec</a> = strace_marker_decode_linespec;
<a name="l15918"></a>15918 
<a name="l15919"></a>15919   <span class="comment">/* Fork catchpoints.  */</span>
<a name="l15920"></a>15920   ops = &amp;catch_fork_breakpoint_ops;
<a name="l15921"></a>15921   *ops = <a class="code" href="breakpoint_8c.html#aefe1d12780f2d7ae5fb89ac113e204e0">base_breakpoint_ops</a>;
<a name="l15922"></a>15922   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a36581d1abf4c42e5b9aac2febd1b72ff">insert_location</a> = insert_catch_fork;
<a name="l15923"></a>15923   ops-&gt;<a class="code" href="structbreakpoint__ops.html#ad2f8547a4949f5480fa4c4dc7487cb78">remove_location</a> = remove_catch_fork;
<a name="l15924"></a>15924   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a4aa8d8d1c3a346f7e7efa58474697a90">breakpoint_hit</a> = breakpoint_hit_catch_fork;
<a name="l15925"></a>15925   ops-&gt;<a class="code" href="structbreakpoint__ops.html#aa8d21fdff10f7839583383d6397fe6a0">print_it</a> = print_it_catch_fork;
<a name="l15926"></a>15926   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a20a11e27ae594ff232488495fd0a0476">print_one</a> = print_one_catch_fork;
<a name="l15927"></a>15927   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a56e47601d6d5230479033e7b7b2d910e">print_mention</a> = print_mention_catch_fork;
<a name="l15928"></a>15928   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a218bc56decfb6ebbcf35def58b7dd271">print_recreate</a> = print_recreate_catch_fork;
<a name="l15929"></a>15929 
<a name="l15930"></a>15930   <span class="comment">/* Vfork catchpoints.  */</span>
<a name="l15931"></a>15931   ops = &amp;catch_vfork_breakpoint_ops;
<a name="l15932"></a>15932   *ops = <a class="code" href="breakpoint_8c.html#aefe1d12780f2d7ae5fb89ac113e204e0">base_breakpoint_ops</a>;
<a name="l15933"></a>15933   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a36581d1abf4c42e5b9aac2febd1b72ff">insert_location</a> = insert_catch_vfork;
<a name="l15934"></a>15934   ops-&gt;<a class="code" href="structbreakpoint__ops.html#ad2f8547a4949f5480fa4c4dc7487cb78">remove_location</a> = remove_catch_vfork;
<a name="l15935"></a>15935   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a4aa8d8d1c3a346f7e7efa58474697a90">breakpoint_hit</a> = breakpoint_hit_catch_vfork;
<a name="l15936"></a>15936   ops-&gt;<a class="code" href="structbreakpoint__ops.html#aa8d21fdff10f7839583383d6397fe6a0">print_it</a> = print_it_catch_vfork;
<a name="l15937"></a>15937   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a20a11e27ae594ff232488495fd0a0476">print_one</a> = print_one_catch_vfork;
<a name="l15938"></a>15938   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a56e47601d6d5230479033e7b7b2d910e">print_mention</a> = print_mention_catch_vfork;
<a name="l15939"></a>15939   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a218bc56decfb6ebbcf35def58b7dd271">print_recreate</a> = print_recreate_catch_vfork;
<a name="l15940"></a>15940 
<a name="l15941"></a>15941   <span class="comment">/* Exec catchpoints.  */</span>
<a name="l15942"></a>15942   ops = &amp;catch_exec_breakpoint_ops;
<a name="l15943"></a>15943   *ops = <a class="code" href="breakpoint_8c.html#aefe1d12780f2d7ae5fb89ac113e204e0">base_breakpoint_ops</a>;
<a name="l15944"></a>15944   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a110b2df7b285e5f83bf40b9a0e5435c1">dtor</a> = dtor_catch_exec;
<a name="l15945"></a>15945   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a36581d1abf4c42e5b9aac2febd1b72ff">insert_location</a> = insert_catch_exec;
<a name="l15946"></a>15946   ops-&gt;<a class="code" href="structbreakpoint__ops.html#ad2f8547a4949f5480fa4c4dc7487cb78">remove_location</a> = remove_catch_exec;
<a name="l15947"></a>15947   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a4aa8d8d1c3a346f7e7efa58474697a90">breakpoint_hit</a> = breakpoint_hit_catch_exec;
<a name="l15948"></a>15948   ops-&gt;<a class="code" href="structbreakpoint__ops.html#aa8d21fdff10f7839583383d6397fe6a0">print_it</a> = print_it_catch_exec;
<a name="l15949"></a>15949   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a20a11e27ae594ff232488495fd0a0476">print_one</a> = print_one_catch_exec;
<a name="l15950"></a>15950   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a56e47601d6d5230479033e7b7b2d910e">print_mention</a> = print_mention_catch_exec;
<a name="l15951"></a>15951   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a218bc56decfb6ebbcf35def58b7dd271">print_recreate</a> = print_recreate_catch_exec;
<a name="l15952"></a>15952 
<a name="l15953"></a>15953   <span class="comment">/* Syscall catchpoints.  */</span>
<a name="l15954"></a>15954   ops = &amp;catch_syscall_breakpoint_ops;
<a name="l15955"></a>15955   *ops = <a class="code" href="breakpoint_8c.html#aefe1d12780f2d7ae5fb89ac113e204e0">base_breakpoint_ops</a>;
<a name="l15956"></a>15956   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a110b2df7b285e5f83bf40b9a0e5435c1">dtor</a> = dtor_catch_syscall;
<a name="l15957"></a>15957   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a36581d1abf4c42e5b9aac2febd1b72ff">insert_location</a> = insert_catch_syscall;
<a name="l15958"></a>15958   ops-&gt;<a class="code" href="structbreakpoint__ops.html#ad2f8547a4949f5480fa4c4dc7487cb78">remove_location</a> = remove_catch_syscall;
<a name="l15959"></a>15959   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a4aa8d8d1c3a346f7e7efa58474697a90">breakpoint_hit</a> = breakpoint_hit_catch_syscall;
<a name="l15960"></a>15960   ops-&gt;<a class="code" href="structbreakpoint__ops.html#aa8d21fdff10f7839583383d6397fe6a0">print_it</a> = print_it_catch_syscall;
<a name="l15961"></a>15961   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a20a11e27ae594ff232488495fd0a0476">print_one</a> = print_one_catch_syscall;
<a name="l15962"></a>15962   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a56e47601d6d5230479033e7b7b2d910e">print_mention</a> = print_mention_catch_syscall;
<a name="l15963"></a>15963   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a218bc56decfb6ebbcf35def58b7dd271">print_recreate</a> = print_recreate_catch_syscall;
<a name="l15964"></a>15964 
<a name="l15965"></a>15965   <span class="comment">/* Solib-related catchpoints.  */</span>
<a name="l15966"></a>15966   ops = &amp;catch_solib_breakpoint_ops;
<a name="l15967"></a>15967   *ops = <a class="code" href="breakpoint_8c.html#aefe1d12780f2d7ae5fb89ac113e204e0">base_breakpoint_ops</a>;
<a name="l15968"></a>15968   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a110b2df7b285e5f83bf40b9a0e5435c1">dtor</a> = dtor_catch_solib;
<a name="l15969"></a>15969   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a36581d1abf4c42e5b9aac2febd1b72ff">insert_location</a> = insert_catch_solib;
<a name="l15970"></a>15970   ops-&gt;<a class="code" href="structbreakpoint__ops.html#ad2f8547a4949f5480fa4c4dc7487cb78">remove_location</a> = remove_catch_solib;
<a name="l15971"></a>15971   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a4aa8d8d1c3a346f7e7efa58474697a90">breakpoint_hit</a> = breakpoint_hit_catch_solib;
<a name="l15972"></a>15972   ops-&gt;<a class="code" href="structbreakpoint__ops.html#afd5b5a27bf4d9d9d49b267507b0633c4">check_status</a> = check_status_catch_solib;
<a name="l15973"></a>15973   ops-&gt;<a class="code" href="structbreakpoint__ops.html#aa8d21fdff10f7839583383d6397fe6a0">print_it</a> = print_it_catch_solib;
<a name="l15974"></a>15974   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a20a11e27ae594ff232488495fd0a0476">print_one</a> = print_one_catch_solib;
<a name="l15975"></a>15975   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a56e47601d6d5230479033e7b7b2d910e">print_mention</a> = print_mention_catch_solib;
<a name="l15976"></a>15976   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a218bc56decfb6ebbcf35def58b7dd271">print_recreate</a> = print_recreate_catch_solib;
<a name="l15977"></a>15977 
<a name="l15978"></a>15978   ops = &amp;<a class="code" href="breakpoint_8c.html#a21625ec72da41a93186216198d3bceae">dprintf_breakpoint_ops</a>;
<a name="l15979"></a>15979   *ops = bkpt_base_breakpoint_ops;
<a name="l15980"></a>15980   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a42f6ff20f3eb39f78874c914d34e09b5">re_set</a> = dprintf_re_set;
<a name="l15981"></a>15981   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a372a323c3f122204085f7faf52bd2adb">resources_needed</a> = bkpt_resources_needed;
<a name="l15982"></a>15982   ops-&gt;<a class="code" href="structbreakpoint__ops.html#aa8d21fdff10f7839583383d6397fe6a0">print_it</a> = bkpt_print_it;
<a name="l15983"></a>15983   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a56e47601d6d5230479033e7b7b2d910e">print_mention</a> = bkpt_print_mention;
<a name="l15984"></a>15984   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a218bc56decfb6ebbcf35def58b7dd271">print_recreate</a> = dprintf_print_recreate;
<a name="l15985"></a>15985   ops-&gt;<a class="code" href="structbreakpoint__ops.html#a350e56ca3a9a7600acc19e7e0a20eeee">after_condition_true</a> = dprintf_after_condition_true;
<a name="l15986"></a>15986 }
<a name="l15987"></a>15987 
<a name="l15988"></a>15988 <span class="comment">/* Chain containing all defined &quot;enable breakpoint&quot; subcommands.  */</span>
<a name="l15989"></a>15989 
<a name="l15990"></a>15990 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structcmd__list__element.html">cmd_list_element</a> *enablebreaklist = NULL;
<a name="l15991"></a>15991 
<a name="l15992"></a>15992 <span class="keywordtype">void</span>
<a name="l15993"></a><a class="code" href="init_8c.html#a4a4836c6f20eed2fd07ca4779285a7bf">15993</a> <a class="code" href="init_8c.html#a4a4836c6f20eed2fd07ca4779285a7bf">_initialize_breakpoint</a> (<span class="keywordtype">void</span>)
<a name="l15994"></a>15994 {
<a name="l15995"></a>15995   <span class="keyword">struct </span><a class="code" href="structcmd__list__element.html">cmd_list_element</a> *c;
<a name="l15996"></a>15996 
<a name="l15997"></a>15997   <a class="code" href="breakpoint_8c.html#a1576e03931c016f098138a3e4cfabb66">initialize_breakpoint_ops</a> ();
<a name="l15998"></a>15998 
<a name="l15999"></a>15999   <a class="code" href="observer_8h.html#adcc6152213c4fbd8094b5bd439c0747a">observer_attach_solib_unloaded</a> (disable_breakpoints_in_unloaded_shlib);
<a name="l16000"></a>16000   <a class="code" href="observer_8h.html#a9a54ebb2156e3189a09d3e7afcf1b067">observer_attach_inferior_exit</a> (clear_syscall_counts);
<a name="l16001"></a>16001   <a class="code" href="observer_8h.html#a930b5ab9555a6b6bca3337c14b89de2e">observer_attach_memory_changed</a> (invalidate_bp_value_on_memory_change);
<a name="l16002"></a>16002 
<a name="l16003"></a>16003   breakpoint_objfile_key
<a name="l16004"></a>16004     = register_objfile_data_with_cleanup (NULL, free_breakpoint_probes);
<a name="l16005"></a>16005 
<a name="l16006"></a>16006   catch_syscall_inferior_data
<a name="l16007"></a>16007     = register_inferior_data_with_cleanup (NULL,
<a name="l16008"></a>16008                                            catch_syscall_inferior_data_cleanup);
<a name="l16009"></a>16009 
<a name="l16010"></a>16010   breakpoint_chain = 0;
<a name="l16011"></a>16011   <span class="comment">/* Don&#39;t bother to call set_breakpoint_count.  $bpnum isn&#39;t useful</span>
<a name="l16012"></a>16012 <span class="comment">     before a breakpoint is set.  */</span>
<a name="l16013"></a>16013   breakpoint_count = 0;
<a name="l16014"></a>16014 
<a name="l16015"></a>16015   tracepoint_count = 0;
<a name="l16016"></a>16016 
<a name="l16017"></a>16017   <a class="code" href="cli-decode_8c.html#a0df0ca36d9acd96440e24407cbef593c">add_com</a> (<span class="stringliteral">&quot;ignore&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a803cb23b7faac7d3b865a0e6de82eda7">class_breakpoint</a>, ignore_command, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16018"></a>16018 <span class="stringliteral">Set ignore-count of breakpoint number N to COUNT.\n\</span>
<a name="l16019"></a>16019 <span class="stringliteral">Usage is `ignore N COUNT&#39;.&quot;</span>));
<a name="l16020"></a>16020   <span class="keywordflow">if</span> (<a class="code" href="defs_8h.html#a195fb001f0890cfc064403357feecca1">xdb_commands</a>)
<a name="l16021"></a>16021     <a class="code" href="cli-decode_8c.html#aeeea74da863db26c8d7fee1573f26a05">add_com_alias</a> (<span class="stringliteral">&quot;bc&quot;</span>, <span class="stringliteral">&quot;ignore&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a803cb23b7faac7d3b865a0e6de82eda7">class_breakpoint</a>, 1);
<a name="l16022"></a>16022 
<a name="l16023"></a>16023   <a class="code" href="cli-decode_8c.html#a0df0ca36d9acd96440e24407cbef593c">add_com</a> (<span class="stringliteral">&quot;commands&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a803cb23b7faac7d3b865a0e6de82eda7">class_breakpoint</a>, commands_command, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16024"></a>16024 <span class="stringliteral">Set commands to be executed when a breakpoint is hit.\n\</span>
<a name="l16025"></a>16025 <span class="stringliteral">Give breakpoint number as argument after \&quot;commands\&quot;.\n\</span>
<a name="l16026"></a>16026 <span class="stringliteral">With no argument, the targeted breakpoint is the last one set.\n\</span>
<a name="l16027"></a>16027 <span class="stringliteral">The commands themselves follow starting on the next line.\n\</span>
<a name="l16028"></a>16028 <span class="stringliteral">Type a line containing \&quot;end\&quot; to indicate the end of them.\n\</span>
<a name="l16029"></a>16029 <span class="stringliteral">Give \&quot;silent\&quot; as the first line to make the breakpoint silent;\n\</span>
<a name="l16030"></a>16030 <span class="stringliteral">then no output is printed when it is hit, except what the commands print.&quot;</span>));
<a name="l16031"></a>16031 
<a name="l16032"></a>16032   c = <a class="code" href="cli-decode_8c.html#a0df0ca36d9acd96440e24407cbef593c">add_com</a> (<span class="stringliteral">&quot;condition&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a803cb23b7faac7d3b865a0e6de82eda7">class_breakpoint</a>, condition_command, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16033"></a>16033 <span class="stringliteral">Specify breakpoint number N to break only if COND is true.\n\</span>
<a name="l16034"></a>16034 <span class="stringliteral">Usage is `condition N COND&#39;, where N is an integer and COND is an\n\</span>
<a name="l16035"></a>16035 <span class="stringliteral">expression to be evaluated whenever breakpoint N is reached.&quot;</span>));
<a name="l16036"></a>16036   <a class="code" href="command_8h.html#abe42a75e35cfa78e2574e94904d86713">set_cmd_completer</a> (c, condition_completer);
<a name="l16037"></a>16037 
<a name="l16038"></a>16038   c = <a class="code" href="cli-decode_8c.html#a0df0ca36d9acd96440e24407cbef593c">add_com</a> (<span class="stringliteral">&quot;tbreak&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a803cb23b7faac7d3b865a0e6de82eda7">class_breakpoint</a>, <a class="code" href="breakpoint_8c.html#a81f8125287168f705e6e9b1eef1ba79c">tbreak_command</a>, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16039"></a>16039 <span class="stringliteral">Set a temporary breakpoint.\n\</span>
<a name="l16040"></a>16040 <span class="stringliteral">Like \&quot;break\&quot; except the breakpoint is only temporary,\n\</span>
<a name="l16041"></a>16041 <span class="stringliteral">so it will be deleted when hit.  Equivalent to \&quot;break\&quot; followed\n\</span>
<a name="l16042"></a>16042 <span class="stringliteral">by using \&quot;enable delete\&quot; on the breakpoint number.\n\</span>
<a name="l16043"></a>16043 <span class="stringliteral">\n&quot;</span>
<a name="l16044"></a>16044 <a class="code" href="breakpoint_8c.html#a9d42163f35217654ad290c99fabf329d">BREAK_ARGS_HELP</a> (<span class="stringliteral">&quot;tbreak&quot;</span>)));
<a name="l16045"></a>16045   <a class="code" href="command_8h.html#abe42a75e35cfa78e2574e94904d86713">set_cmd_completer</a> (c, location_completer);
<a name="l16046"></a>16046 
<a name="l16047"></a>16047   c = <a class="code" href="cli-decode_8c.html#a0df0ca36d9acd96440e24407cbef593c">add_com</a> (<span class="stringliteral">&quot;hbreak&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a803cb23b7faac7d3b865a0e6de82eda7">class_breakpoint</a>, hbreak_command, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16048"></a>16048 <span class="stringliteral">Set a hardware assisted breakpoint.\n\</span>
<a name="l16049"></a>16049 <span class="stringliteral">Like \&quot;break\&quot; except the breakpoint requires hardware support,\n\</span>
<a name="l16050"></a>16050 <span class="stringliteral">some target hardware may not have this support.\n\</span>
<a name="l16051"></a>16051 <span class="stringliteral">\n&quot;</span>
<a name="l16052"></a>16052 <a class="code" href="breakpoint_8c.html#a9d42163f35217654ad290c99fabf329d">BREAK_ARGS_HELP</a> (<span class="stringliteral">&quot;hbreak&quot;</span>)));
<a name="l16053"></a>16053   <a class="code" href="command_8h.html#abe42a75e35cfa78e2574e94904d86713">set_cmd_completer</a> (c, location_completer);
<a name="l16054"></a>16054 
<a name="l16055"></a>16055   c = <a class="code" href="cli-decode_8c.html#a0df0ca36d9acd96440e24407cbef593c">add_com</a> (<span class="stringliteral">&quot;thbreak&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a803cb23b7faac7d3b865a0e6de82eda7">class_breakpoint</a>, thbreak_command, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16056"></a>16056 <span class="stringliteral">Set a temporary hardware assisted breakpoint.\n\</span>
<a name="l16057"></a>16057 <span class="stringliteral">Like \&quot;hbreak\&quot; except the breakpoint is only temporary,\n\</span>
<a name="l16058"></a>16058 <span class="stringliteral">so it will be deleted when hit.\n\</span>
<a name="l16059"></a>16059 <span class="stringliteral">\n&quot;</span>
<a name="l16060"></a>16060 <a class="code" href="breakpoint_8c.html#a9d42163f35217654ad290c99fabf329d">BREAK_ARGS_HELP</a> (<span class="stringliteral">&quot;thbreak&quot;</span>)));
<a name="l16061"></a>16061   <a class="code" href="command_8h.html#abe42a75e35cfa78e2574e94904d86713">set_cmd_completer</a> (c, location_completer);
<a name="l16062"></a>16062 
<a name="l16063"></a>16063   <a class="code" href="cli-decode_8c.html#a8abc1e9af59eb3cb12bb03977d5e8e5a">add_prefix_cmd</a> (<span class="stringliteral">&quot;enable&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a803cb23b7faac7d3b865a0e6de82eda7">class_breakpoint</a>, enable_command, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16064"></a>16064 <span class="stringliteral">Enable some breakpoints.\n\</span>
<a name="l16065"></a>16065 <span class="stringliteral">Give breakpoint numbers (separated by spaces) as arguments.\n\</span>
<a name="l16066"></a>16066 <span class="stringliteral">With no subcommand, breakpoints are enabled until you command otherwise.\n\</span>
<a name="l16067"></a>16067 <span class="stringliteral">This is used to cancel the effect of the \&quot;disable\&quot; command.\n\</span>
<a name="l16068"></a>16068 <span class="stringliteral">With a subcommand you can enable temporarily.&quot;</span>),
<a name="l16069"></a>16069                   &amp;<a class="code" href="cli-cmds_8c.html#ac657b85f876b2f45ced4c900825b6256">enablelist</a>, <span class="stringliteral">&quot;enable &quot;</span>, 1, &amp;<a class="code" href="cli-cmds_8c.html#a6b7ab0355d0fa8d6ce7d5feb83ff78e7">cmdlist</a>);
<a name="l16070"></a>16070   <span class="keywordflow">if</span> (<a class="code" href="defs_8h.html#a195fb001f0890cfc064403357feecca1">xdb_commands</a>)
<a name="l16071"></a>16071     <a class="code" href="cli-decode_8c.html#a0df0ca36d9acd96440e24407cbef593c">add_com</a> (<span class="stringliteral">&quot;ab&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a803cb23b7faac7d3b865a0e6de82eda7">class_breakpoint</a>, enable_command, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16072"></a>16072 <span class="stringliteral">Enable some breakpoints.\n\</span>
<a name="l16073"></a>16073 <span class="stringliteral">Give breakpoint numbers (separated by spaces) as arguments.\n\</span>
<a name="l16074"></a>16074 <span class="stringliteral">With no subcommand, breakpoints are enabled until you command otherwise.\n\</span>
<a name="l16075"></a>16075 <span class="stringliteral">This is used to cancel the effect of the \&quot;disable\&quot; command.\n\</span>
<a name="l16076"></a>16076 <span class="stringliteral">With a subcommand you can enable temporarily.&quot;</span>));
<a name="l16077"></a>16077 
<a name="l16078"></a>16078   <a class="code" href="cli-decode_8c.html#aeeea74da863db26c8d7fee1573f26a05">add_com_alias</a> (<span class="stringliteral">&quot;en&quot;</span>, <span class="stringliteral">&quot;enable&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a803cb23b7faac7d3b865a0e6de82eda7">class_breakpoint</a>, 1);
<a name="l16079"></a>16079 
<a name="l16080"></a>16080   <a class="code" href="cli-decode_8c.html#a8abc1e9af59eb3cb12bb03977d5e8e5a">add_prefix_cmd</a> (<span class="stringliteral">&quot;breakpoints&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a803cb23b7faac7d3b865a0e6de82eda7">class_breakpoint</a>, enable_command, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16081"></a>16081 <span class="stringliteral">Enable some breakpoints.\n\</span>
<a name="l16082"></a>16082 <span class="stringliteral">Give breakpoint numbers (separated by spaces) as arguments.\n\</span>
<a name="l16083"></a>16083 <span class="stringliteral">This is used to cancel the effect of the \&quot;disable\&quot; command.\n\</span>
<a name="l16084"></a>16084 <span class="stringliteral">May be abbreviated to simply \&quot;enable\&quot;.\n&quot;</span>),
<a name="l16085"></a>16085                    &amp;enablebreaklist, <span class="stringliteral">&quot;enable breakpoints &quot;</span>, 1, &amp;<a class="code" href="cli-cmds_8c.html#ac657b85f876b2f45ced4c900825b6256">enablelist</a>);
<a name="l16086"></a>16086 
<a name="l16087"></a>16087   <a class="code" href="cli-decode_8c.html#ab87b0ba51ed9aa4c8aac0c96373537f8">add_cmd</a> (<span class="stringliteral">&quot;once&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49afbf489a4abce7e8770b178aa54f0908b">no_class</a>, enable_once_command, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16088"></a>16088 <span class="stringliteral">Enable breakpoints for one hit.  Give breakpoint numbers.\n\</span>
<a name="l16089"></a>16089 <span class="stringliteral">If a breakpoint is hit while enabled in this fashion, it becomes disabled.&quot;</span>),
<a name="l16090"></a>16090            &amp;enablebreaklist);
<a name="l16091"></a>16091 
<a name="l16092"></a>16092   <a class="code" href="cli-decode_8c.html#ab87b0ba51ed9aa4c8aac0c96373537f8">add_cmd</a> (<span class="stringliteral">&quot;delete&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49afbf489a4abce7e8770b178aa54f0908b">no_class</a>, enable_delete_command, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16093"></a>16093 <span class="stringliteral">Enable breakpoints and delete when hit.  Give breakpoint numbers.\n\</span>
<a name="l16094"></a>16094 <span class="stringliteral">If a breakpoint is hit while enabled in this fashion, it is deleted.&quot;</span>),
<a name="l16095"></a>16095            &amp;enablebreaklist);
<a name="l16096"></a>16096 
<a name="l16097"></a>16097   <a class="code" href="cli-decode_8c.html#ab87b0ba51ed9aa4c8aac0c96373537f8">add_cmd</a> (<span class="stringliteral">&quot;count&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49afbf489a4abce7e8770b178aa54f0908b">no_class</a>, enable_count_command, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16098"></a>16098 <span class="stringliteral">Enable breakpoints for COUNT hits.  Give count and then breakpoint numbers.\n\</span>
<a name="l16099"></a>16099 <span class="stringliteral">If a breakpoint is hit while enabled in this fashion,\n\</span>
<a name="l16100"></a>16100 <span class="stringliteral">the count is decremented; when it reaches zero, the breakpoint is disabled.&quot;</span>),
<a name="l16101"></a>16101            &amp;enablebreaklist);
<a name="l16102"></a>16102 
<a name="l16103"></a>16103   <a class="code" href="cli-decode_8c.html#ab87b0ba51ed9aa4c8aac0c96373537f8">add_cmd</a> (<span class="stringliteral">&quot;delete&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49afbf489a4abce7e8770b178aa54f0908b">no_class</a>, enable_delete_command, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16104"></a>16104 <span class="stringliteral">Enable breakpoints and delete when hit.  Give breakpoint numbers.\n\</span>
<a name="l16105"></a>16105 <span class="stringliteral">If a breakpoint is hit while enabled in this fashion, it is deleted.&quot;</span>),
<a name="l16106"></a>16106            &amp;<a class="code" href="cli-cmds_8c.html#ac657b85f876b2f45ced4c900825b6256">enablelist</a>);
<a name="l16107"></a>16107 
<a name="l16108"></a>16108   <a class="code" href="cli-decode_8c.html#ab87b0ba51ed9aa4c8aac0c96373537f8">add_cmd</a> (<span class="stringliteral">&quot;once&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49afbf489a4abce7e8770b178aa54f0908b">no_class</a>, enable_once_command, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16109"></a>16109 <span class="stringliteral">Enable breakpoints for one hit.  Give breakpoint numbers.\n\</span>
<a name="l16110"></a>16110 <span class="stringliteral">If a breakpoint is hit while enabled in this fashion, it becomes disabled.&quot;</span>),
<a name="l16111"></a>16111            &amp;<a class="code" href="cli-cmds_8c.html#ac657b85f876b2f45ced4c900825b6256">enablelist</a>);
<a name="l16112"></a>16112 
<a name="l16113"></a>16113   <a class="code" href="cli-decode_8c.html#ab87b0ba51ed9aa4c8aac0c96373537f8">add_cmd</a> (<span class="stringliteral">&quot;count&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49afbf489a4abce7e8770b178aa54f0908b">no_class</a>, enable_count_command, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16114"></a>16114 <span class="stringliteral">Enable breakpoints for COUNT hits.  Give count and then breakpoint numbers.\n\</span>
<a name="l16115"></a>16115 <span class="stringliteral">If a breakpoint is hit while enabled in this fashion,\n\</span>
<a name="l16116"></a>16116 <span class="stringliteral">the count is decremented; when it reaches zero, the breakpoint is disabled.&quot;</span>),
<a name="l16117"></a>16117            &amp;<a class="code" href="cli-cmds_8c.html#ac657b85f876b2f45ced4c900825b6256">enablelist</a>);
<a name="l16118"></a>16118 
<a name="l16119"></a>16119   <a class="code" href="cli-decode_8c.html#a8abc1e9af59eb3cb12bb03977d5e8e5a">add_prefix_cmd</a> (<span class="stringliteral">&quot;disable&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a803cb23b7faac7d3b865a0e6de82eda7">class_breakpoint</a>, disable_command, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16120"></a>16120 <span class="stringliteral">Disable some breakpoints.\n\</span>
<a name="l16121"></a>16121 <span class="stringliteral">Arguments are breakpoint numbers with spaces in between.\n\</span>
<a name="l16122"></a>16122 <span class="stringliteral">To disable all breakpoints, give no argument.\n\</span>
<a name="l16123"></a>16123 <span class="stringliteral">A disabled breakpoint is not forgotten, but has no effect until re-enabled.&quot;</span>),
<a name="l16124"></a>16124                   &amp;<a class="code" href="cli-cmds_8c.html#a8c0d2e4e2bfbed6c7cc589768fce36fb">disablelist</a>, <span class="stringliteral">&quot;disable &quot;</span>, 1, &amp;<a class="code" href="cli-cmds_8c.html#a6b7ab0355d0fa8d6ce7d5feb83ff78e7">cmdlist</a>);
<a name="l16125"></a>16125   <a class="code" href="cli-decode_8c.html#aeeea74da863db26c8d7fee1573f26a05">add_com_alias</a> (<span class="stringliteral">&quot;dis&quot;</span>, <span class="stringliteral">&quot;disable&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a803cb23b7faac7d3b865a0e6de82eda7">class_breakpoint</a>, 1);
<a name="l16126"></a>16126   <a class="code" href="cli-decode_8c.html#aeeea74da863db26c8d7fee1573f26a05">add_com_alias</a> (<span class="stringliteral">&quot;disa&quot;</span>, <span class="stringliteral">&quot;disable&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a803cb23b7faac7d3b865a0e6de82eda7">class_breakpoint</a>, 1);
<a name="l16127"></a>16127   <span class="keywordflow">if</span> (<a class="code" href="defs_8h.html#a195fb001f0890cfc064403357feecca1">xdb_commands</a>)
<a name="l16128"></a>16128     <a class="code" href="cli-decode_8c.html#a0df0ca36d9acd96440e24407cbef593c">add_com</a> (<span class="stringliteral">&quot;sb&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a803cb23b7faac7d3b865a0e6de82eda7">class_breakpoint</a>, disable_command, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16129"></a>16129 <span class="stringliteral">Disable some breakpoints.\n\</span>
<a name="l16130"></a>16130 <span class="stringliteral">Arguments are breakpoint numbers with spaces in between.\n\</span>
<a name="l16131"></a>16131 <span class="stringliteral">To disable all breakpoints, give no argument.\n\</span>
<a name="l16132"></a>16132 <span class="stringliteral">A disabled breakpoint is not forgotten, but has no effect until re-enabled.&quot;</span>));
<a name="l16133"></a>16133 
<a name="l16134"></a>16134   <a class="code" href="cli-decode_8c.html#ab87b0ba51ed9aa4c8aac0c96373537f8">add_cmd</a> (<span class="stringliteral">&quot;breakpoints&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49ab3f4371cd43a9a1392c164b37cdef36f">class_alias</a>, disable_command, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16135"></a>16135 <span class="stringliteral">Disable some breakpoints.\n\</span>
<a name="l16136"></a>16136 <span class="stringliteral">Arguments are breakpoint numbers with spaces in between.\n\</span>
<a name="l16137"></a>16137 <span class="stringliteral">To disable all breakpoints, give no argument.\n\</span>
<a name="l16138"></a>16138 <span class="stringliteral">A disabled breakpoint is not forgotten, but has no effect until re-enabled.\n\</span>
<a name="l16139"></a>16139 <span class="stringliteral">This command may be abbreviated \&quot;disable\&quot;.&quot;</span>),
<a name="l16140"></a>16140            &amp;<a class="code" href="cli-cmds_8c.html#a8c0d2e4e2bfbed6c7cc589768fce36fb">disablelist</a>);
<a name="l16141"></a>16141 
<a name="l16142"></a>16142   <a class="code" href="cli-decode_8c.html#a8abc1e9af59eb3cb12bb03977d5e8e5a">add_prefix_cmd</a> (<span class="stringliteral">&quot;delete&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a803cb23b7faac7d3b865a0e6de82eda7">class_breakpoint</a>, <a class="code" href="breakpoint_8c.html#a17a62f25c595697afa257f7f9df1736f">delete_command</a>, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16143"></a>16143 <span class="stringliteral">Delete some breakpoints or auto-display expressions.\n\</span>
<a name="l16144"></a>16144 <span class="stringliteral">Arguments are breakpoint numbers with spaces in between.\n\</span>
<a name="l16145"></a>16145 <span class="stringliteral">To delete all breakpoints, give no argument.\n\</span>
<a name="l16146"></a>16146 <span class="stringliteral">\n\</span>
<a name="l16147"></a>16147 <span class="stringliteral">Also a prefix command for deletion of other GDB objects.\n\</span>
<a name="l16148"></a>16148 <span class="stringliteral">The \&quot;unset\&quot; command is also an alias for \&quot;delete\&quot;.&quot;</span>),
<a name="l16149"></a>16149                   &amp;<a class="code" href="cli-cmds_8c.html#a38161c9c3dd4b9956acc3ba4456bcdd7">deletelist</a>, <span class="stringliteral">&quot;delete &quot;</span>, 1, &amp;<a class="code" href="cli-cmds_8c.html#a6b7ab0355d0fa8d6ce7d5feb83ff78e7">cmdlist</a>);
<a name="l16150"></a>16150   <a class="code" href="cli-decode_8c.html#aeeea74da863db26c8d7fee1573f26a05">add_com_alias</a> (<span class="stringliteral">&quot;d&quot;</span>, <span class="stringliteral">&quot;delete&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a803cb23b7faac7d3b865a0e6de82eda7">class_breakpoint</a>, 1);
<a name="l16151"></a>16151   <a class="code" href="cli-decode_8c.html#aeeea74da863db26c8d7fee1573f26a05">add_com_alias</a> (<span class="stringliteral">&quot;del&quot;</span>, <span class="stringliteral">&quot;delete&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a803cb23b7faac7d3b865a0e6de82eda7">class_breakpoint</a>, 1);
<a name="l16152"></a>16152   <span class="keywordflow">if</span> (<a class="code" href="defs_8h.html#a195fb001f0890cfc064403357feecca1">xdb_commands</a>)
<a name="l16153"></a>16153     <a class="code" href="cli-decode_8c.html#a0df0ca36d9acd96440e24407cbef593c">add_com</a> (<span class="stringliteral">&quot;db&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a803cb23b7faac7d3b865a0e6de82eda7">class_breakpoint</a>, <a class="code" href="breakpoint_8c.html#a17a62f25c595697afa257f7f9df1736f">delete_command</a>, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16154"></a>16154 <span class="stringliteral">Delete some breakpoints.\n\</span>
<a name="l16155"></a>16155 <span class="stringliteral">Arguments are breakpoint numbers with spaces in between.\n\</span>
<a name="l16156"></a>16156 <span class="stringliteral">To delete all breakpoints, give no argument.\n&quot;</span>));
<a name="l16157"></a>16157 
<a name="l16158"></a>16158   <a class="code" href="cli-decode_8c.html#ab87b0ba51ed9aa4c8aac0c96373537f8">add_cmd</a> (<span class="stringliteral">&quot;breakpoints&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49ab3f4371cd43a9a1392c164b37cdef36f">class_alias</a>, <a class="code" href="breakpoint_8c.html#a17a62f25c595697afa257f7f9df1736f">delete_command</a>, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16159"></a>16159 <span class="stringliteral">Delete some breakpoints or auto-display expressions.\n\</span>
<a name="l16160"></a>16160 <span class="stringliteral">Arguments are breakpoint numbers with spaces in between.\n\</span>
<a name="l16161"></a>16161 <span class="stringliteral">To delete all breakpoints, give no argument.\n\</span>
<a name="l16162"></a>16162 <span class="stringliteral">This command may be abbreviated \&quot;delete\&quot;.&quot;</span>),
<a name="l16163"></a>16163            &amp;<a class="code" href="cli-cmds_8c.html#a38161c9c3dd4b9956acc3ba4456bcdd7">deletelist</a>);
<a name="l16164"></a>16164 
<a name="l16165"></a>16165   <a class="code" href="cli-decode_8c.html#a0df0ca36d9acd96440e24407cbef593c">add_com</a> (<span class="stringliteral">&quot;clear&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a803cb23b7faac7d3b865a0e6de82eda7">class_breakpoint</a>, clear_command, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16166"></a>16166 <span class="stringliteral">Clear breakpoint at specified line or function.\n\</span>
<a name="l16167"></a>16167 <span class="stringliteral">Argument may be line number, function name, or \&quot;*\&quot; and an address.\n\</span>
<a name="l16168"></a>16168 <span class="stringliteral">If line number is specified, all breakpoints in that line are cleared.\n\</span>
<a name="l16169"></a>16169 <span class="stringliteral">If function is specified, breakpoints at beginning of function are cleared.\n\</span>
<a name="l16170"></a>16170 <span class="stringliteral">If an address is specified, breakpoints at that address are cleared.\n\</span>
<a name="l16171"></a>16171 <span class="stringliteral">\n\</span>
<a name="l16172"></a>16172 <span class="stringliteral">With no argument, clears all breakpoints in the line that the selected frame\n\</span>
<a name="l16173"></a>16173 <span class="stringliteral">is executing in.\n\</span>
<a name="l16174"></a>16174 <span class="stringliteral">\n\</span>
<a name="l16175"></a>16175 <span class="stringliteral">See also the \&quot;delete\&quot; command which clears breakpoints by number.&quot;</span>));
<a name="l16176"></a>16176   <a class="code" href="cli-decode_8c.html#aeeea74da863db26c8d7fee1573f26a05">add_com_alias</a> (<span class="stringliteral">&quot;cl&quot;</span>, <span class="stringliteral">&quot;clear&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a803cb23b7faac7d3b865a0e6de82eda7">class_breakpoint</a>, 1);
<a name="l16177"></a>16177 
<a name="l16178"></a>16178   c = <a class="code" href="cli-decode_8c.html#a0df0ca36d9acd96440e24407cbef593c">add_com</a> (<span class="stringliteral">&quot;break&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a803cb23b7faac7d3b865a0e6de82eda7">class_breakpoint</a>, <a class="code" href="breakpoint_8c.html#a969c96b44566691286776d06748a69c3">break_command</a>, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16179"></a>16179 <span class="stringliteral">Set breakpoint at specified line or function.\n&quot;</span>
<a name="l16180"></a>16180 <a class="code" href="breakpoint_8c.html#a9d42163f35217654ad290c99fabf329d">BREAK_ARGS_HELP</a> (<span class="stringliteral">&quot;break&quot;</span>)));
<a name="l16181"></a>16181   <a class="code" href="command_8h.html#abe42a75e35cfa78e2574e94904d86713">set_cmd_completer</a> (c, location_completer);
<a name="l16182"></a>16182 
<a name="l16183"></a>16183   <a class="code" href="cli-decode_8c.html#aeeea74da863db26c8d7fee1573f26a05">add_com_alias</a> (<span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;break&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49ad643fdd97463076e831c6dba0c505e95">class_run</a>, 1);
<a name="l16184"></a>16184   <a class="code" href="cli-decode_8c.html#aeeea74da863db26c8d7fee1573f26a05">add_com_alias</a> (<span class="stringliteral">&quot;br&quot;</span>, <span class="stringliteral">&quot;break&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49ad643fdd97463076e831c6dba0c505e95">class_run</a>, 1);
<a name="l16185"></a>16185   <a class="code" href="cli-decode_8c.html#aeeea74da863db26c8d7fee1573f26a05">add_com_alias</a> (<span class="stringliteral">&quot;bre&quot;</span>, <span class="stringliteral">&quot;break&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49ad643fdd97463076e831c6dba0c505e95">class_run</a>, 1);
<a name="l16186"></a>16186   <a class="code" href="cli-decode_8c.html#aeeea74da863db26c8d7fee1573f26a05">add_com_alias</a> (<span class="stringliteral">&quot;brea&quot;</span>, <span class="stringliteral">&quot;break&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49ad643fdd97463076e831c6dba0c505e95">class_run</a>, 1);
<a name="l16187"></a>16187 
<a name="l16188"></a>16188   <span class="keywordflow">if</span> (<a class="code" href="defs_8h.html#a195fb001f0890cfc064403357feecca1">xdb_commands</a>)
<a name="l16189"></a>16189    <a class="code" href="cli-decode_8c.html#aeeea74da863db26c8d7fee1573f26a05">add_com_alias</a> (<span class="stringliteral">&quot;ba&quot;</span>, <span class="stringliteral">&quot;break&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a803cb23b7faac7d3b865a0e6de82eda7">class_breakpoint</a>, 1);
<a name="l16190"></a>16190 
<a name="l16191"></a>16191   <span class="keywordflow">if</span> (<a class="code" href="defs_8h.html#a05c64837f5abc518eec4f97238728111">dbx_commands</a>)
<a name="l16192"></a>16192     {
<a name="l16193"></a>16193       <a class="code" href="cli-decode_8c.html#a3cfb81dad75e57489d03c75fdd1d0f34">add_abbrev_prefix_cmd</a> (<span class="stringliteral">&quot;stop&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a803cb23b7faac7d3b865a0e6de82eda7">class_breakpoint</a>, stop_command, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16194"></a>16194 <span class="stringliteral">Break in function/address or break at a line in the current file.&quot;</span>),
<a name="l16195"></a>16195                              &amp;<a class="code" href="cli-cmds_8c.html#a59aeaddb34c6d874010a67e00cd8abb0">stoplist</a>, <span class="stringliteral">&quot;stop &quot;</span>, 1, &amp;<a class="code" href="cli-cmds_8c.html#a6b7ab0355d0fa8d6ce7d5feb83ff78e7">cmdlist</a>);
<a name="l16196"></a>16196       <a class="code" href="cli-decode_8c.html#ab87b0ba51ed9aa4c8aac0c96373537f8">add_cmd</a> (<span class="stringliteral">&quot;in&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a803cb23b7faac7d3b865a0e6de82eda7">class_breakpoint</a>, stopin_command,
<a name="l16197"></a>16197                <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Break in function or address.&quot;</span>), &amp;<a class="code" href="cli-cmds_8c.html#a59aeaddb34c6d874010a67e00cd8abb0">stoplist</a>);
<a name="l16198"></a>16198       <a class="code" href="cli-decode_8c.html#ab87b0ba51ed9aa4c8aac0c96373537f8">add_cmd</a> (<span class="stringliteral">&quot;at&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a803cb23b7faac7d3b865a0e6de82eda7">class_breakpoint</a>, stopat_command,
<a name="l16199"></a>16199                <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Break at a line in the current file.&quot;</span>), &amp;<a class="code" href="cli-cmds_8c.html#a59aeaddb34c6d874010a67e00cd8abb0">stoplist</a>);
<a name="l16200"></a>16200       <a class="code" href="cli-decode_8c.html#a0df0ca36d9acd96440e24407cbef593c">add_com</a> (<span class="stringliteral">&quot;status&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49afeb5c4e1710a4f7dfc804136248d274d">class_info</a>, breakpoints_info, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16201"></a>16201 <span class="stringliteral">Status of user-settable breakpoints, or breakpoint number NUMBER.\n\</span>
<a name="l16202"></a>16202 <span class="stringliteral">The \&quot;Type\&quot; column indicates one of:\n\</span>
<a name="l16203"></a>16203 <span class="stringliteral">\tbreakpoint     - normal breakpoint\n\</span>
<a name="l16204"></a>16204 <span class="stringliteral">\twatchpoint     - watchpoint\n\</span>
<a name="l16205"></a>16205 <span class="stringliteral">The \&quot;Disp\&quot; column contains one of \&quot;keep\&quot;, \&quot;del\&quot;, or \&quot;dis\&quot; to indicate\n\</span>
<a name="l16206"></a>16206 <span class="stringliteral">the disposition of the breakpoint after it gets hit.  \&quot;dis\&quot; means that the\n\</span>
<a name="l16207"></a>16207 <span class="stringliteral">breakpoint will be disabled.  The \&quot;Address\&quot; and \&quot;What\&quot; columns indicate the\n\</span>
<a name="l16208"></a>16208 <span class="stringliteral">address and file/line number respectively.\n\</span>
<a name="l16209"></a>16209 <span class="stringliteral">\n\</span>
<a name="l16210"></a>16210 <span class="stringliteral">Convenience variable \&quot;$_\&quot; and default examine address for \&quot;x\&quot;\n\</span>
<a name="l16211"></a>16211 <span class="stringliteral">are set to the address of the last breakpoint listed unless the command\n\</span>
<a name="l16212"></a>16212 <span class="stringliteral">is prefixed with \&quot;server \&quot;.\n\n\</span>
<a name="l16213"></a>16213 <span class="stringliteral">Convenience variable \&quot;$bpnum\&quot; contains the number of the last\n\</span>
<a name="l16214"></a>16214 <span class="stringliteral">breakpoint set.&quot;</span>));
<a name="l16215"></a>16215     }
<a name="l16216"></a>16216 
<a name="l16217"></a>16217   <a class="code" href="cli-decode_8c.html#a9f6cd2f7798c32a7a27cab617e71cf6a">add_info</a> (<span class="stringliteral">&quot;breakpoints&quot;</span>, breakpoints_info, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16218"></a>16218 <span class="stringliteral">Status of specified breakpoints (all user-settable breakpoints if no argument).\n\</span>
<a name="l16219"></a>16219 <span class="stringliteral">The \&quot;Type\&quot; column indicates one of:\n\</span>
<a name="l16220"></a>16220 <span class="stringliteral">\tbreakpoint     - normal breakpoint\n\</span>
<a name="l16221"></a>16221 <span class="stringliteral">\twatchpoint     - watchpoint\n\</span>
<a name="l16222"></a>16222 <span class="stringliteral">The \&quot;Disp\&quot; column contains one of \&quot;keep\&quot;, \&quot;del\&quot;, or \&quot;dis\&quot; to indicate\n\</span>
<a name="l16223"></a>16223 <span class="stringliteral">the disposition of the breakpoint after it gets hit.  \&quot;dis\&quot; means that the\n\</span>
<a name="l16224"></a>16224 <span class="stringliteral">breakpoint will be disabled.  The \&quot;Address\&quot; and \&quot;What\&quot; columns indicate the\n\</span>
<a name="l16225"></a>16225 <span class="stringliteral">address and file/line number respectively.\n\</span>
<a name="l16226"></a>16226 <span class="stringliteral">\n\</span>
<a name="l16227"></a>16227 <span class="stringliteral">Convenience variable \&quot;$_\&quot; and default examine address for \&quot;x\&quot;\n\</span>
<a name="l16228"></a>16228 <span class="stringliteral">are set to the address of the last breakpoint listed unless the command\n\</span>
<a name="l16229"></a>16229 <span class="stringliteral">is prefixed with \&quot;server \&quot;.\n\n\</span>
<a name="l16230"></a>16230 <span class="stringliteral">Convenience variable \&quot;$bpnum\&quot; contains the number of the last\n\</span>
<a name="l16231"></a>16231 <span class="stringliteral">breakpoint set.&quot;</span>));
<a name="l16232"></a>16232 
<a name="l16233"></a>16233   <a class="code" href="cli-decode_8c.html#a156b2909061aa101144577fbea69ca77">add_info_alias</a> (<span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;breakpoints&quot;</span>, 1);
<a name="l16234"></a>16234 
<a name="l16235"></a>16235   <span class="keywordflow">if</span> (<a class="code" href="defs_8h.html#a195fb001f0890cfc064403357feecca1">xdb_commands</a>)
<a name="l16236"></a>16236     <a class="code" href="cli-decode_8c.html#a0df0ca36d9acd96440e24407cbef593c">add_com</a> (<span class="stringliteral">&quot;lb&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a803cb23b7faac7d3b865a0e6de82eda7">class_breakpoint</a>, breakpoints_info, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16237"></a>16237 <span class="stringliteral">Status of user-settable breakpoints, or breakpoint number NUMBER.\n\</span>
<a name="l16238"></a>16238 <span class="stringliteral">The \&quot;Type\&quot; column indicates one of:\n\</span>
<a name="l16239"></a>16239 <span class="stringliteral">\tbreakpoint     - normal breakpoint\n\</span>
<a name="l16240"></a>16240 <span class="stringliteral">\twatchpoint     - watchpoint\n\</span>
<a name="l16241"></a>16241 <span class="stringliteral">The \&quot;Disp\&quot; column contains one of \&quot;keep\&quot;, \&quot;del\&quot;, or \&quot;dis\&quot; to indicate\n\</span>
<a name="l16242"></a>16242 <span class="stringliteral">the disposition of the breakpoint after it gets hit.  \&quot;dis\&quot; means that the\n\</span>
<a name="l16243"></a>16243 <span class="stringliteral">breakpoint will be disabled.  The \&quot;Address\&quot; and \&quot;What\&quot; columns indicate the\n\</span>
<a name="l16244"></a>16244 <span class="stringliteral">address and file/line number respectively.\n\</span>
<a name="l16245"></a>16245 <span class="stringliteral">\n\</span>
<a name="l16246"></a>16246 <span class="stringliteral">Convenience variable \&quot;$_\&quot; and default examine address for \&quot;x\&quot;\n\</span>
<a name="l16247"></a>16247 <span class="stringliteral">are set to the address of the last breakpoint listed unless the command\n\</span>
<a name="l16248"></a>16248 <span class="stringliteral">is prefixed with \&quot;server \&quot;.\n\n\</span>
<a name="l16249"></a>16249 <span class="stringliteral">Convenience variable \&quot;$bpnum\&quot; contains the number of the last\n\</span>
<a name="l16250"></a>16250 <span class="stringliteral">breakpoint set.&quot;</span>));
<a name="l16251"></a>16251 
<a name="l16252"></a>16252   <a class="code" href="cli-decode_8c.html#ab87b0ba51ed9aa4c8aac0c96373537f8">add_cmd</a> (<span class="stringliteral">&quot;breakpoints&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a502c7b57c7172ac88ef735f68070bb59">class_maintenance</a>, maintenance_info_breakpoints, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16253"></a>16253 <span class="stringliteral">Status of all breakpoints, or breakpoint number NUMBER.\n\</span>
<a name="l16254"></a>16254 <span class="stringliteral">The \&quot;Type\&quot; column indicates one of:\n\</span>
<a name="l16255"></a>16255 <span class="stringliteral">\tbreakpoint     - normal breakpoint\n\</span>
<a name="l16256"></a>16256 <span class="stringliteral">\twatchpoint     - watchpoint\n\</span>
<a name="l16257"></a>16257 <span class="stringliteral">\tlongjmp        - internal breakpoint used to step through longjmp()\n\</span>
<a name="l16258"></a>16258 <span class="stringliteral">\tlongjmp resume - internal breakpoint at the target of longjmp()\n\</span>
<a name="l16259"></a>16259 <span class="stringliteral">\tuntil          - internal breakpoint used by the \&quot;until\&quot; command\n\</span>
<a name="l16260"></a>16260 <span class="stringliteral">\tfinish         - internal breakpoint used by the \&quot;finish\&quot; command\n\</span>
<a name="l16261"></a>16261 <span class="stringliteral">The \&quot;Disp\&quot; column contains one of \&quot;keep\&quot;, \&quot;del\&quot;, or \&quot;dis\&quot; to indicate\n\</span>
<a name="l16262"></a>16262 <span class="stringliteral">the disposition of the breakpoint after it gets hit.  \&quot;dis\&quot; means that the\n\</span>
<a name="l16263"></a>16263 <span class="stringliteral">breakpoint will be disabled.  The \&quot;Address\&quot; and \&quot;What\&quot; columns indicate the\n\</span>
<a name="l16264"></a>16264 <span class="stringliteral">address and file/line number respectively.\n\</span>
<a name="l16265"></a>16265 <span class="stringliteral">\n\</span>
<a name="l16266"></a>16266 <span class="stringliteral">Convenience variable \&quot;$_\&quot; and default examine address for \&quot;x\&quot;\n\</span>
<a name="l16267"></a>16267 <span class="stringliteral">are set to the address of the last breakpoint listed unless the command\n\</span>
<a name="l16268"></a>16268 <span class="stringliteral">is prefixed with \&quot;server \&quot;.\n\n\</span>
<a name="l16269"></a>16269 <span class="stringliteral">Convenience variable \&quot;$bpnum\&quot; contains the number of the last\n\</span>
<a name="l16270"></a>16270 <span class="stringliteral">breakpoint set.&quot;</span>),
<a name="l16271"></a>16271            &amp;<a class="code" href="cli-cmds_8c.html#adea9c2a6ad27de2f64d04262ff61d43f">maintenanceinfolist</a>);
<a name="l16272"></a>16272 
<a name="l16273"></a>16273   <a class="code" href="cli-decode_8c.html#a8abc1e9af59eb3cb12bb03977d5e8e5a">add_prefix_cmd</a> (<span class="stringliteral">&quot;catch&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a803cb23b7faac7d3b865a0e6de82eda7">class_breakpoint</a>, catch_command, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16274"></a>16274 <span class="stringliteral">Set catchpoints to catch events.&quot;</span>),
<a name="l16275"></a>16275                   &amp;catch_cmdlist, <span class="stringliteral">&quot;catch &quot;</span>,
<a name="l16276"></a>16276                   0<span class="comment">/*allow-unknown*/</span>, &amp;<a class="code" href="cli-cmds_8c.html#a6b7ab0355d0fa8d6ce7d5feb83ff78e7">cmdlist</a>);
<a name="l16277"></a>16277 
<a name="l16278"></a>16278   <a class="code" href="cli-decode_8c.html#a8abc1e9af59eb3cb12bb03977d5e8e5a">add_prefix_cmd</a> (<span class="stringliteral">&quot;tcatch&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a803cb23b7faac7d3b865a0e6de82eda7">class_breakpoint</a>, tcatch_command, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16279"></a>16279 <span class="stringliteral">Set temporary catchpoints to catch events.&quot;</span>),
<a name="l16280"></a>16280                   &amp;tcatch_cmdlist, <span class="stringliteral">&quot;tcatch &quot;</span>,
<a name="l16281"></a>16281                   0<span class="comment">/*allow-unknown*/</span>, &amp;<a class="code" href="cli-cmds_8c.html#a6b7ab0355d0fa8d6ce7d5feb83ff78e7">cmdlist</a>);
<a name="l16282"></a>16282 
<a name="l16283"></a>16283   <a class="code" href="breakpoint_8c.html#a2f9b60e7aa76c6796bf67b46a1f758ce">add_catch_command</a> (<span class="stringliteral">&quot;fork&quot;</span>, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Catch calls to fork.&quot;</span>),
<a name="l16284"></a>16284                      catch_fork_command_1,
<a name="l16285"></a>16285                      NULL,
<a name="l16286"></a>16286                      (<span class="keywordtype">void</span> *) (uintptr_t) <a class="code" href="breakpoint_8c.html#add88a84f24c403251c4b4a497d9ebffea82ac2c073e10deb5cf47cf04fe6a0f54">catch_fork_permanent</a>,
<a name="l16287"></a>16287                      (<span class="keywordtype">void</span> *) (uintptr_t) <a class="code" href="breakpoint_8c.html#add88a84f24c403251c4b4a497d9ebffea3901caf5cfa8e80890450503d5b20ce2">catch_fork_temporary</a>);
<a name="l16288"></a>16288   <a class="code" href="breakpoint_8c.html#a2f9b60e7aa76c6796bf67b46a1f758ce">add_catch_command</a> (<span class="stringliteral">&quot;vfork&quot;</span>, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Catch calls to vfork.&quot;</span>),
<a name="l16289"></a>16289                      catch_fork_command_1,
<a name="l16290"></a>16290                      NULL,
<a name="l16291"></a>16291                      (<span class="keywordtype">void</span> *) (uintptr_t) <a class="code" href="breakpoint_8c.html#add88a84f24c403251c4b4a497d9ebffea16e523011bdfac6f801602631e429edb">catch_vfork_permanent</a>,
<a name="l16292"></a>16292                      (<span class="keywordtype">void</span> *) (uintptr_t) <a class="code" href="breakpoint_8c.html#add88a84f24c403251c4b4a497d9ebffea2797e961ccbe698d6691c8400d6d2bab">catch_vfork_temporary</a>);
<a name="l16293"></a>16293   <a class="code" href="breakpoint_8c.html#a2f9b60e7aa76c6796bf67b46a1f758ce">add_catch_command</a> (<span class="stringliteral">&quot;exec&quot;</span>, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Catch calls to exec.&quot;</span>),
<a name="l16294"></a>16294                      catch_exec_command_1,
<a name="l16295"></a>16295                      NULL,
<a name="l16296"></a>16296                      <a class="code" href="breakpoint_8h.html#a025e5e360b0c2f65dd7ac39daba9fee0">CATCH_PERMANENT</a>,
<a name="l16297"></a>16297                      <a class="code" href="breakpoint_8h.html#a9f80fa035808be1497fc37fd6595587e">CATCH_TEMPORARY</a>);
<a name="l16298"></a>16298   <a class="code" href="breakpoint_8c.html#a2f9b60e7aa76c6796bf67b46a1f758ce">add_catch_command</a> (<span class="stringliteral">&quot;load&quot;</span>, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Catch loads of shared libraries.\n\</span>
<a name="l16299"></a>16299 <span class="stringliteral">Usage: catch load [REGEX]\n\</span>
<a name="l16300"></a>16300 <span class="stringliteral">If REGEX is given, only stop for libraries matching the regular expression.&quot;</span>),
<a name="l16301"></a>16301                      catch_load_command_1,
<a name="l16302"></a>16302                      NULL,
<a name="l16303"></a>16303                      <a class="code" href="breakpoint_8h.html#a025e5e360b0c2f65dd7ac39daba9fee0">CATCH_PERMANENT</a>,
<a name="l16304"></a>16304                      <a class="code" href="breakpoint_8h.html#a9f80fa035808be1497fc37fd6595587e">CATCH_TEMPORARY</a>);
<a name="l16305"></a>16305   <a class="code" href="breakpoint_8c.html#a2f9b60e7aa76c6796bf67b46a1f758ce">add_catch_command</a> (<span class="stringliteral">&quot;unload&quot;</span>, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Catch unloads of shared libraries.\n\</span>
<a name="l16306"></a>16306 <span class="stringliteral">Usage: catch unload [REGEX]\n\</span>
<a name="l16307"></a>16307 <span class="stringliteral">If REGEX is given, only stop for libraries matching the regular expression.&quot;</span>),
<a name="l16308"></a>16308                      catch_unload_command_1,
<a name="l16309"></a>16309                      NULL,
<a name="l16310"></a>16310                      <a class="code" href="breakpoint_8h.html#a025e5e360b0c2f65dd7ac39daba9fee0">CATCH_PERMANENT</a>,
<a name="l16311"></a>16311                      <a class="code" href="breakpoint_8h.html#a9f80fa035808be1497fc37fd6595587e">CATCH_TEMPORARY</a>);
<a name="l16312"></a>16312   <a class="code" href="breakpoint_8c.html#a2f9b60e7aa76c6796bf67b46a1f758ce">add_catch_command</a> (<span class="stringliteral">&quot;syscall&quot;</span>, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16313"></a>16313 <span class="stringliteral">Catch system calls by their names and/or numbers.\n\</span>
<a name="l16314"></a>16314 <span class="stringliteral">Arguments say which system calls to catch.  If no arguments\n\</span>
<a name="l16315"></a>16315 <span class="stringliteral">are given, every system call will be caught.\n\</span>
<a name="l16316"></a>16316 <span class="stringliteral">Arguments, if given, should be one or more system call names\n\</span>
<a name="l16317"></a>16317 <span class="stringliteral">(if your system supports that), or system call numbers.&quot;</span>),
<a name="l16318"></a>16318                      catch_syscall_command_1,
<a name="l16319"></a>16319                      catch_syscall_completer,
<a name="l16320"></a>16320                      <a class="code" href="breakpoint_8h.html#a025e5e360b0c2f65dd7ac39daba9fee0">CATCH_PERMANENT</a>,
<a name="l16321"></a>16321                      <a class="code" href="breakpoint_8h.html#a9f80fa035808be1497fc37fd6595587e">CATCH_TEMPORARY</a>);
<a name="l16322"></a>16322 
<a name="l16323"></a>16323   c = <a class="code" href="cli-decode_8c.html#a0df0ca36d9acd96440e24407cbef593c">add_com</a> (<span class="stringliteral">&quot;watch&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a803cb23b7faac7d3b865a0e6de82eda7">class_breakpoint</a>, watch_command, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16324"></a>16324 <span class="stringliteral">Set a watchpoint for an expression.\n\</span>
<a name="l16325"></a>16325 <span class="stringliteral">Usage: watch [-l|-location] EXPRESSION\n\</span>
<a name="l16326"></a>16326 <span class="stringliteral">A watchpoint stops execution of your program whenever the value of\n\</span>
<a name="l16327"></a>16327 <span class="stringliteral">an expression changes.\n\</span>
<a name="l16328"></a>16328 <span class="stringliteral">If -l or -location is given, this evaluates EXPRESSION and watches\n\</span>
<a name="l16329"></a>16329 <span class="stringliteral">the memory to which it refers.&quot;</span>));
<a name="l16330"></a>16330   <a class="code" href="command_8h.html#abe42a75e35cfa78e2574e94904d86713">set_cmd_completer</a> (c, expression_completer);
<a name="l16331"></a>16331 
<a name="l16332"></a>16332   c = <a class="code" href="cli-decode_8c.html#a0df0ca36d9acd96440e24407cbef593c">add_com</a> (<span class="stringliteral">&quot;rwatch&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a803cb23b7faac7d3b865a0e6de82eda7">class_breakpoint</a>, rwatch_command, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16333"></a>16333 <span class="stringliteral">Set a read watchpoint for an expression.\n\</span>
<a name="l16334"></a>16334 <span class="stringliteral">Usage: rwatch [-l|-location] EXPRESSION\n\</span>
<a name="l16335"></a>16335 <span class="stringliteral">A watchpoint stops execution of your program whenever the value of\n\</span>
<a name="l16336"></a>16336 <span class="stringliteral">an expression is read.\n\</span>
<a name="l16337"></a>16337 <span class="stringliteral">If -l or -location is given, this evaluates EXPRESSION and watches\n\</span>
<a name="l16338"></a>16338 <span class="stringliteral">the memory to which it refers.&quot;</span>));
<a name="l16339"></a>16339   <a class="code" href="command_8h.html#abe42a75e35cfa78e2574e94904d86713">set_cmd_completer</a> (c, expression_completer);
<a name="l16340"></a>16340 
<a name="l16341"></a>16341   c = <a class="code" href="cli-decode_8c.html#a0df0ca36d9acd96440e24407cbef593c">add_com</a> (<span class="stringliteral">&quot;awatch&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a803cb23b7faac7d3b865a0e6de82eda7">class_breakpoint</a>, awatch_command, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16342"></a>16342 <span class="stringliteral">Set a watchpoint for an expression.\n\</span>
<a name="l16343"></a>16343 <span class="stringliteral">Usage: awatch [-l|-location] EXPRESSION\n\</span>
<a name="l16344"></a>16344 <span class="stringliteral">A watchpoint stops execution of your program whenever the value of\n\</span>
<a name="l16345"></a>16345 <span class="stringliteral">an expression is either read or written.\n\</span>
<a name="l16346"></a>16346 <span class="stringliteral">If -l or -location is given, this evaluates EXPRESSION and watches\n\</span>
<a name="l16347"></a>16347 <span class="stringliteral">the memory to which it refers.&quot;</span>));
<a name="l16348"></a>16348   <a class="code" href="command_8h.html#abe42a75e35cfa78e2574e94904d86713">set_cmd_completer</a> (c, expression_completer);
<a name="l16349"></a>16349 
<a name="l16350"></a>16350   <a class="code" href="cli-decode_8c.html#a9f6cd2f7798c32a7a27cab617e71cf6a">add_info</a> (<span class="stringliteral">&quot;watchpoints&quot;</span>, watchpoints_info, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16351"></a>16351 <span class="stringliteral">Status of specified watchpoints (all watchpoints if no argument).&quot;</span>));
<a name="l16352"></a>16352 
<a name="l16353"></a>16353   <span class="comment">/* XXX: cagney/2005-02-23: This should be a boolean, and should</span>
<a name="l16354"></a>16354 <span class="comment">     respond to changes - contrary to the description.  */</span>
<a name="l16355"></a>16355   <a class="code" href="cli-decode_8c.html#abe99e440fc306f22620b97664e584cff">add_setshow_zinteger_cmd</a> (<span class="stringliteral">&quot;can-use-hw-watchpoints&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a92be6efbab6bd9647a6f7a2862712d9b">class_support</a>,
<a name="l16356"></a>16356                             &amp;can_use_hw_watchpoints, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16357"></a>16357 <span class="stringliteral">Set debugger&#39;s willingness to use watchpoint hardware.&quot;</span>), <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16358"></a>16358 <span class="stringliteral">Show debugger&#39;s willingness to use watchpoint hardware.&quot;</span>), <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16359"></a>16359 <span class="stringliteral">If zero, gdb will not use hardware for new watchpoints, even if\n\</span>
<a name="l16360"></a>16360 <span class="stringliteral">such is available.  (However, any hardware watchpoints that were\n\</span>
<a name="l16361"></a>16361 <span class="stringliteral">created before setting this to nonzero, will continue to use watchpoint\n\</span>
<a name="l16362"></a>16362 <span class="stringliteral">hardware.)&quot;</span>),
<a name="l16363"></a>16363                             NULL,
<a name="l16364"></a>16364                             show_can_use_hw_watchpoints,
<a name="l16365"></a>16365                             &amp;<a class="code" href="cli-cmds_8c.html#a723e0174d833cba0aa82fb936a56c8fa">setlist</a>, &amp;<a class="code" href="cli-cmds_8c.html#a003932aa76fd3f41763ecc6bee5e2ca8">showlist</a>);
<a name="l16366"></a>16366 
<a name="l16367"></a>16367   can_use_hw_watchpoints = 1;
<a name="l16368"></a>16368 
<a name="l16369"></a>16369   <span class="comment">/* Tracepoint manipulation commands.  */</span>
<a name="l16370"></a>16370 
<a name="l16371"></a>16371   c = <a class="code" href="cli-decode_8c.html#a0df0ca36d9acd96440e24407cbef593c">add_com</a> (<span class="stringliteral">&quot;trace&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a803cb23b7faac7d3b865a0e6de82eda7">class_breakpoint</a>, trace_command, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16372"></a>16372 <span class="stringliteral">Set a tracepoint at specified line or function.\n\</span>
<a name="l16373"></a>16373 <span class="stringliteral">\n&quot;</span>
<a name="l16374"></a>16374 <a class="code" href="breakpoint_8c.html#a9d42163f35217654ad290c99fabf329d">BREAK_ARGS_HELP</a> (<span class="stringliteral">&quot;trace&quot;</span>) <span class="stringliteral">&quot;\n\</span>
<a name="l16375"></a>16375 <span class="stringliteral">Do \&quot;help tracepoints\&quot; for info on other tracepoint commands.&quot;</span>));
<a name="l16376"></a>16376   <a class="code" href="command_8h.html#abe42a75e35cfa78e2574e94904d86713">set_cmd_completer</a> (c, location_completer);
<a name="l16377"></a>16377 
<a name="l16378"></a>16378   <a class="code" href="cli-decode_8c.html#aeeea74da863db26c8d7fee1573f26a05">add_com_alias</a> (<span class="stringliteral">&quot;tp&quot;</span>, <span class="stringliteral">&quot;trace&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49ab3f4371cd43a9a1392c164b37cdef36f">class_alias</a>, 0);
<a name="l16379"></a>16379   <a class="code" href="cli-decode_8c.html#aeeea74da863db26c8d7fee1573f26a05">add_com_alias</a> (<span class="stringliteral">&quot;tr&quot;</span>, <span class="stringliteral">&quot;trace&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49ab3f4371cd43a9a1392c164b37cdef36f">class_alias</a>, 1);
<a name="l16380"></a>16380   <a class="code" href="cli-decode_8c.html#aeeea74da863db26c8d7fee1573f26a05">add_com_alias</a> (<span class="stringliteral">&quot;tra&quot;</span>, <span class="stringliteral">&quot;trace&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49ab3f4371cd43a9a1392c164b37cdef36f">class_alias</a>, 1);
<a name="l16381"></a>16381   <a class="code" href="cli-decode_8c.html#aeeea74da863db26c8d7fee1573f26a05">add_com_alias</a> (<span class="stringliteral">&quot;trac&quot;</span>, <span class="stringliteral">&quot;trace&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49ab3f4371cd43a9a1392c164b37cdef36f">class_alias</a>, 1);
<a name="l16382"></a>16382 
<a name="l16383"></a>16383   c = <a class="code" href="cli-decode_8c.html#a0df0ca36d9acd96440e24407cbef593c">add_com</a> (<span class="stringliteral">&quot;ftrace&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a803cb23b7faac7d3b865a0e6de82eda7">class_breakpoint</a>, ftrace_command, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16384"></a>16384 <span class="stringliteral">Set a fast tracepoint at specified line or function.\n\</span>
<a name="l16385"></a>16385 <span class="stringliteral">\n&quot;</span>
<a name="l16386"></a>16386 <a class="code" href="breakpoint_8c.html#a9d42163f35217654ad290c99fabf329d">BREAK_ARGS_HELP</a> (<span class="stringliteral">&quot;ftrace&quot;</span>) <span class="stringliteral">&quot;\n\</span>
<a name="l16387"></a>16387 <span class="stringliteral">Do \&quot;help tracepoints\&quot; for info on other tracepoint commands.&quot;</span>));
<a name="l16388"></a>16388   <a class="code" href="command_8h.html#abe42a75e35cfa78e2574e94904d86713">set_cmd_completer</a> (c, location_completer);
<a name="l16389"></a>16389 
<a name="l16390"></a>16390   c = <a class="code" href="cli-decode_8c.html#a0df0ca36d9acd96440e24407cbef593c">add_com</a> (<span class="stringliteral">&quot;strace&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a803cb23b7faac7d3b865a0e6de82eda7">class_breakpoint</a>, strace_command, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16391"></a>16391 <span class="stringliteral">Set a static tracepoint at specified line, function or marker.\n\</span>
<a name="l16392"></a>16392 <span class="stringliteral">\n\</span>
<a name="l16393"></a>16393 <span class="stringliteral">strace [LOCATION] [if CONDITION]\n\</span>
<a name="l16394"></a>16394 <span class="stringliteral">LOCATION may be a line number, function name, \&quot;*\&quot; and an address,\n\</span>
<a name="l16395"></a>16395 <span class="stringliteral">or -m MARKER_ID.\n\</span>
<a name="l16396"></a>16396 <span class="stringliteral">If a line number is specified, probe the marker at start of code\n\</span>
<a name="l16397"></a>16397 <span class="stringliteral">for that line.  If a function is specified, probe the marker at start\n\</span>
<a name="l16398"></a>16398 <span class="stringliteral">of code for that function.  If an address is specified, probe the marker\n\</span>
<a name="l16399"></a>16399 <span class="stringliteral">at that exact address.  If a marker id is specified, probe the marker\n\</span>
<a name="l16400"></a>16400 <span class="stringliteral">with that name.  With no LOCATION, uses current execution address of\n\</span>
<a name="l16401"></a>16401 <span class="stringliteral">the selected stack frame.\n\</span>
<a name="l16402"></a>16402 <span class="stringliteral">Static tracepoints accept an extra collect action -- ``collect $_sdata&#39;&#39;.\n\</span>
<a name="l16403"></a>16403 <span class="stringliteral">This collects arbitrary user data passed in the probe point call to the\n\</span>
<a name="l16404"></a>16404 <span class="stringliteral">tracing library.  You can inspect it when analyzing the trace buffer,\n\</span>
<a name="l16405"></a>16405 <span class="stringliteral">by printing the $_sdata variable like any other convenience variable.\n\</span>
<a name="l16406"></a>16406 <span class="stringliteral">\n\</span>
<a name="l16407"></a>16407 <span class="stringliteral">CONDITION is a boolean expression.\n\</span>
<a name="l16408"></a>16408 <span class="stringliteral">\n\</span>
<a name="l16409"></a>16409 <span class="stringliteral">Multiple tracepoints at one place are permitted, and useful if their\n\</span>
<a name="l16410"></a>16410 <span class="stringliteral">conditions are different.\n\</span>
<a name="l16411"></a>16411 <span class="stringliteral">\n\</span>
<a name="l16412"></a>16412 <span class="stringliteral">Do \&quot;help breakpoints\&quot; for info on other commands dealing with breakpoints.\n\</span>
<a name="l16413"></a>16413 <span class="stringliteral">Do \&quot;help tracepoints\&quot; for info on other tracepoint commands.&quot;</span>));
<a name="l16414"></a>16414   <a class="code" href="command_8h.html#abe42a75e35cfa78e2574e94904d86713">set_cmd_completer</a> (c, location_completer);
<a name="l16415"></a>16415 
<a name="l16416"></a>16416   <a class="code" href="cli-decode_8c.html#a9f6cd2f7798c32a7a27cab617e71cf6a">add_info</a> (<span class="stringliteral">&quot;tracepoints&quot;</span>, tracepoints_info, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16417"></a>16417 <span class="stringliteral">Status of specified tracepoints (all tracepoints if no argument).\n\</span>
<a name="l16418"></a>16418 <span class="stringliteral">Convenience variable \&quot;$tpnum\&quot; contains the number of the\n\</span>
<a name="l16419"></a>16419 <span class="stringliteral">last tracepoint set.&quot;</span>));
<a name="l16420"></a>16420 
<a name="l16421"></a>16421   <a class="code" href="cli-decode_8c.html#a156b2909061aa101144577fbea69ca77">add_info_alias</a> (<span class="stringliteral">&quot;tp&quot;</span>, <span class="stringliteral">&quot;tracepoints&quot;</span>, 1);
<a name="l16422"></a>16422 
<a name="l16423"></a>16423   <a class="code" href="cli-decode_8c.html#ab87b0ba51ed9aa4c8aac0c96373537f8">add_cmd</a> (<span class="stringliteral">&quot;tracepoints&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49ad11a6f2eabeb9fa4cfd96d211d58581f">class_trace</a>, delete_trace_command, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16424"></a>16424 <span class="stringliteral">Delete specified tracepoints.\n\</span>
<a name="l16425"></a>16425 <span class="stringliteral">Arguments are tracepoint numbers, separated by spaces.\n\</span>
<a name="l16426"></a>16426 <span class="stringliteral">No argument means delete all tracepoints.&quot;</span>),
<a name="l16427"></a>16427            &amp;<a class="code" href="cli-cmds_8c.html#a38161c9c3dd4b9956acc3ba4456bcdd7">deletelist</a>);
<a name="l16428"></a>16428   <a class="code" href="cli-decode_8c.html#a81a250b03b0a6626b31d35be82961c38">add_alias_cmd</a> (<span class="stringliteral">&quot;tr&quot;</span>, <span class="stringliteral">&quot;tracepoints&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49ad11a6f2eabeb9fa4cfd96d211d58581f">class_trace</a>, 1, &amp;<a class="code" href="cli-cmds_8c.html#a38161c9c3dd4b9956acc3ba4456bcdd7">deletelist</a>);
<a name="l16429"></a>16429 
<a name="l16430"></a>16430   c = <a class="code" href="cli-decode_8c.html#ab87b0ba51ed9aa4c8aac0c96373537f8">add_cmd</a> (<span class="stringliteral">&quot;tracepoints&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49ad11a6f2eabeb9fa4cfd96d211d58581f">class_trace</a>, disable_trace_command, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16431"></a>16431 <span class="stringliteral">Disable specified tracepoints.\n\</span>
<a name="l16432"></a>16432 <span class="stringliteral">Arguments are tracepoint numbers, separated by spaces.\n\</span>
<a name="l16433"></a>16433 <span class="stringliteral">No argument means disable all tracepoints.&quot;</span>),
<a name="l16434"></a>16434            &amp;<a class="code" href="cli-cmds_8c.html#a8c0d2e4e2bfbed6c7cc589768fce36fb">disablelist</a>);
<a name="l16435"></a>16435   <a class="code" href="cli-decode_8c.html#a5227f15011728981d016d9c6fd4e3c74">deprecate_cmd</a> (c, <span class="stringliteral">&quot;disable&quot;</span>);
<a name="l16436"></a>16436 
<a name="l16437"></a>16437   c = <a class="code" href="cli-decode_8c.html#ab87b0ba51ed9aa4c8aac0c96373537f8">add_cmd</a> (<span class="stringliteral">&quot;tracepoints&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49ad11a6f2eabeb9fa4cfd96d211d58581f">class_trace</a>, enable_trace_command, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16438"></a>16438 <span class="stringliteral">Enable specified tracepoints.\n\</span>
<a name="l16439"></a>16439 <span class="stringliteral">Arguments are tracepoint numbers, separated by spaces.\n\</span>
<a name="l16440"></a>16440 <span class="stringliteral">No argument means enable all tracepoints.&quot;</span>),
<a name="l16441"></a>16441            &amp;<a class="code" href="cli-cmds_8c.html#ac657b85f876b2f45ced4c900825b6256">enablelist</a>);
<a name="l16442"></a>16442   <a class="code" href="cli-decode_8c.html#a5227f15011728981d016d9c6fd4e3c74">deprecate_cmd</a> (c, <span class="stringliteral">&quot;enable&quot;</span>);
<a name="l16443"></a>16443 
<a name="l16444"></a>16444   <a class="code" href="cli-decode_8c.html#a0df0ca36d9acd96440e24407cbef593c">add_com</a> (<span class="stringliteral">&quot;passcount&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49ad11a6f2eabeb9fa4cfd96d211d58581f">class_trace</a>, trace_pass_command, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16445"></a>16445 <span class="stringliteral">Set the passcount for a tracepoint.\n\</span>
<a name="l16446"></a>16446 <span class="stringliteral">The trace will end when the tracepoint has been passed &#39;count&#39; times.\n\</span>
<a name="l16447"></a>16447 <span class="stringliteral">Usage: passcount COUNT TPNUM, where TPNUM may also be \&quot;all\&quot;;\n\</span>
<a name="l16448"></a>16448 <span class="stringliteral">if TPNUM is omitted, passcount refers to the last tracepoint defined.&quot;</span>));
<a name="l16449"></a>16449 
<a name="l16450"></a>16450   <a class="code" href="cli-decode_8c.html#a8abc1e9af59eb3cb12bb03977d5e8e5a">add_prefix_cmd</a> (<span class="stringliteral">&quot;save&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a803cb23b7faac7d3b865a0e6de82eda7">class_breakpoint</a>, save_command,
<a name="l16451"></a>16451                   <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Save breakpoint definitions as a script.&quot;</span>),
<a name="l16452"></a>16452                   &amp;save_cmdlist, <span class="stringliteral">&quot;save &quot;</span>,
<a name="l16453"></a>16453                   0<span class="comment">/*allow-unknown*/</span>, &amp;<a class="code" href="cli-cmds_8c.html#a6b7ab0355d0fa8d6ce7d5feb83ff78e7">cmdlist</a>);
<a name="l16454"></a>16454 
<a name="l16455"></a>16455   c = <a class="code" href="cli-decode_8c.html#ab87b0ba51ed9aa4c8aac0c96373537f8">add_cmd</a> (<span class="stringliteral">&quot;breakpoints&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a803cb23b7faac7d3b865a0e6de82eda7">class_breakpoint</a>, save_breakpoints_command, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16456"></a>16456 <span class="stringliteral">Save current breakpoint definitions as a script.\n\</span>
<a name="l16457"></a>16457 <span class="stringliteral">This includes all types of breakpoints (breakpoints, watchpoints,\n\</span>
<a name="l16458"></a>16458 <span class="stringliteral">catchpoints, tracepoints).  Use the &#39;source&#39; command in another debug\n\</span>
<a name="l16459"></a>16459 <span class="stringliteral">session to restore them.&quot;</span>),
<a name="l16460"></a>16460                &amp;save_cmdlist);
<a name="l16461"></a>16461   <a class="code" href="command_8h.html#abe42a75e35cfa78e2574e94904d86713">set_cmd_completer</a> (c, filename_completer);
<a name="l16462"></a>16462 
<a name="l16463"></a>16463   c = <a class="code" href="cli-decode_8c.html#ab87b0ba51ed9aa4c8aac0c96373537f8">add_cmd</a> (<span class="stringliteral">&quot;tracepoints&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49ad11a6f2eabeb9fa4cfd96d211d58581f">class_trace</a>, save_tracepoints_command, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16464"></a>16464 <span class="stringliteral">Save current tracepoint definitions as a script.\n\</span>
<a name="l16465"></a>16465 <span class="stringliteral">Use the &#39;source&#39; command in another debug session to restore them.&quot;</span>),
<a name="l16466"></a>16466                &amp;save_cmdlist);
<a name="l16467"></a>16467   <a class="code" href="command_8h.html#abe42a75e35cfa78e2574e94904d86713">set_cmd_completer</a> (c, filename_completer);
<a name="l16468"></a>16468 
<a name="l16469"></a>16469   c = <a class="code" href="cli-decode_8c.html#aeeea74da863db26c8d7fee1573f26a05">add_com_alias</a> (<span class="stringliteral">&quot;save-tracepoints&quot;</span>, <span class="stringliteral">&quot;save tracepoints&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49ad11a6f2eabeb9fa4cfd96d211d58581f">class_trace</a>, 0);
<a name="l16470"></a>16470   <a class="code" href="cli-decode_8c.html#a5227f15011728981d016d9c6fd4e3c74">deprecate_cmd</a> (c, <span class="stringliteral">&quot;save tracepoints&quot;</span>);
<a name="l16471"></a>16471 
<a name="l16472"></a>16472   <a class="code" href="cli-decode_8c.html#a8abc1e9af59eb3cb12bb03977d5e8e5a">add_prefix_cmd</a> (<span class="stringliteral">&quot;breakpoint&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a502c7b57c7172ac88ef735f68070bb59">class_maintenance</a>, set_breakpoint_cmd, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16473"></a>16473 <span class="stringliteral">Breakpoint specific settings\n\</span>
<a name="l16474"></a>16474 <span class="stringliteral">Configure various breakpoint-specific variables such as\n\</span>
<a name="l16475"></a>16475 <span class="stringliteral">pending breakpoint behavior&quot;</span>),
<a name="l16476"></a>16476                   &amp;breakpoint_set_cmdlist, <span class="stringliteral">&quot;set breakpoint &quot;</span>,
<a name="l16477"></a>16477                   0<span class="comment">/*allow-unknown*/</span>, &amp;<a class="code" href="cli-cmds_8c.html#a723e0174d833cba0aa82fb936a56c8fa">setlist</a>);
<a name="l16478"></a>16478   <a class="code" href="cli-decode_8c.html#a8abc1e9af59eb3cb12bb03977d5e8e5a">add_prefix_cmd</a> (<span class="stringliteral">&quot;breakpoint&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a502c7b57c7172ac88ef735f68070bb59">class_maintenance</a>, show_breakpoint_cmd, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16479"></a>16479 <span class="stringliteral">Breakpoint specific settings\n\</span>
<a name="l16480"></a>16480 <span class="stringliteral">Configure various breakpoint-specific variables such as\n\</span>
<a name="l16481"></a>16481 <span class="stringliteral">pending breakpoint behavior&quot;</span>),
<a name="l16482"></a>16482                   &amp;breakpoint_show_cmdlist, <span class="stringliteral">&quot;show breakpoint &quot;</span>,
<a name="l16483"></a>16483                   0<span class="comment">/*allow-unknown*/</span>, &amp;<a class="code" href="cli-cmds_8c.html#a003932aa76fd3f41763ecc6bee5e2ca8">showlist</a>);
<a name="l16484"></a>16484 
<a name="l16485"></a>16485   <a class="code" href="cli-decode_8c.html#a23ea3d5840b00a6fad40e165ba4feba7">add_setshow_auto_boolean_cmd</a> (<span class="stringliteral">&quot;pending&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49afbf489a4abce7e8770b178aa54f0908b">no_class</a>,
<a name="l16486"></a>16486                                 &amp;pending_break_support, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16487"></a>16487 <span class="stringliteral">Set debugger&#39;s behavior regarding pending breakpoints.&quot;</span>), <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16488"></a>16488 <span class="stringliteral">Show debugger&#39;s behavior regarding pending breakpoints.&quot;</span>), <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16489"></a>16489 <span class="stringliteral">If on, an unrecognized breakpoint location will cause gdb to create a\n\</span>
<a name="l16490"></a>16490 <span class="stringliteral">pending breakpoint.  If off, an unrecognized breakpoint location results in\n\</span>
<a name="l16491"></a>16491 <span class="stringliteral">an error.  If auto, an unrecognized breakpoint location results in a\n\</span>
<a name="l16492"></a>16492 <span class="stringliteral">user-query to see if a pending breakpoint should be created.&quot;</span>),
<a name="l16493"></a>16493                                 NULL,
<a name="l16494"></a>16494                                 show_pending_break_support,
<a name="l16495"></a>16495                                 &amp;breakpoint_set_cmdlist,
<a name="l16496"></a>16496                                 &amp;breakpoint_show_cmdlist);
<a name="l16497"></a>16497 
<a name="l16498"></a>16498   pending_break_support = <a class="code" href="defs_8h.html#a7e28c5d9363062b4fd5eec5fed14448fa48f3bffd79907d65a7ee3aee7aabc163">AUTO_BOOLEAN_AUTO</a>;
<a name="l16499"></a>16499 
<a name="l16500"></a>16500   <a class="code" href="cli-decode_8c.html#ad86a0f135b6c546ae7ffbb41fd72e14f">add_setshow_boolean_cmd</a> (<span class="stringliteral">&quot;auto-hw&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49afbf489a4abce7e8770b178aa54f0908b">no_class</a>,
<a name="l16501"></a>16501                            &amp;automatic_hardware_breakpoints, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16502"></a>16502 <span class="stringliteral">Set automatic usage of hardware breakpoints.&quot;</span>), <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16503"></a>16503 <span class="stringliteral">Show automatic usage of hardware breakpoints.&quot;</span>), <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16504"></a>16504 <span class="stringliteral">If set, the debugger will automatically use hardware breakpoints for\n\</span>
<a name="l16505"></a>16505 <span class="stringliteral">breakpoints set with \&quot;break\&quot; but falling in read-only memory.  If not set,\n\</span>
<a name="l16506"></a>16506 <span class="stringliteral">a warning will be emitted for such breakpoints.&quot;</span>),
<a name="l16507"></a>16507                            NULL,
<a name="l16508"></a>16508                            show_automatic_hardware_breakpoints,
<a name="l16509"></a>16509                            &amp;breakpoint_set_cmdlist,
<a name="l16510"></a>16510                            &amp;breakpoint_show_cmdlist);
<a name="l16511"></a>16511 
<a name="l16512"></a>16512   <a class="code" href="cli-decode_8c.html#a23ea3d5840b00a6fad40e165ba4feba7">add_setshow_auto_boolean_cmd</a> (<span class="stringliteral">&quot;always-inserted&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a92be6efbab6bd9647a6f7a2862712d9b">class_support</a>,
<a name="l16513"></a>16513                                 &amp;always_inserted_mode, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16514"></a>16514 <span class="stringliteral">Set mode for inserting breakpoints.&quot;</span>), <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16515"></a>16515 <span class="stringliteral">Show mode for inserting breakpoints.&quot;</span>), <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16516"></a>16516 <span class="stringliteral">When this mode is off, breakpoints are inserted in inferior when it is\n\</span>
<a name="l16517"></a>16517 <span class="stringliteral">resumed, and removed when execution stops.  When this mode is on,\n\</span>
<a name="l16518"></a>16518 <span class="stringliteral">breakpoints are inserted immediately and removed only when the user\n\</span>
<a name="l16519"></a>16519 <span class="stringliteral">deletes the breakpoint.  When this mode is auto (which is the default),\n\</span>
<a name="l16520"></a>16520 <span class="stringliteral">the behaviour depends on the non-stop setting (see help set non-stop).\n\</span>
<a name="l16521"></a>16521 <span class="stringliteral">In this case, if gdb is controlling the inferior in non-stop mode, gdb\n\</span>
<a name="l16522"></a>16522 <span class="stringliteral">behaves as if always-inserted mode is on; if gdb is controlling the\n\</span>
<a name="l16523"></a>16523 <span class="stringliteral">inferior in all-stop mode, gdb behaves as if always-inserted mode is off.&quot;</span>),
<a name="l16524"></a>16524                                 NULL,
<a name="l16525"></a>16525                                 &amp;show_always_inserted_mode,
<a name="l16526"></a>16526                                 &amp;breakpoint_set_cmdlist,
<a name="l16527"></a>16527                                 &amp;breakpoint_show_cmdlist);
<a name="l16528"></a>16528 
<a name="l16529"></a>16529   <a class="code" href="cli-decode_8c.html#a79332268b2efb4698434e6ddf4d8c00e">add_setshow_enum_cmd</a> (<span class="stringliteral">&quot;condition-evaluation&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a803cb23b7faac7d3b865a0e6de82eda7">class_breakpoint</a>,
<a name="l16530"></a>16530                         condition_evaluation_enums,
<a name="l16531"></a>16531                         &amp;condition_evaluation_mode_1, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16532"></a>16532 <span class="stringliteral">Set mode of breakpoint condition evaluation.&quot;</span>), <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16533"></a>16533 <span class="stringliteral">Show mode of breakpoint condition evaluation.&quot;</span>), <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16534"></a>16534 <span class="stringliteral">When this is set to \&quot;host\&quot;, breakpoint conditions will be\n\</span>
<a name="l16535"></a>16535 <span class="stringliteral">evaluated on the host&#39;s side by GDB.  When it is set to \&quot;target\&quot;,\n\</span>
<a name="l16536"></a>16536 <span class="stringliteral">breakpoint conditions will be downloaded to the target (if the target\n\</span>
<a name="l16537"></a>16537 <span class="stringliteral">supports such feature) and conditions will be evaluated on the target&#39;s side.\n\</span>
<a name="l16538"></a>16538 <span class="stringliteral">If this is set to \&quot;auto\&quot; (default), this will be automatically set to\n\</span>
<a name="l16539"></a>16539 <span class="stringliteral">\&quot;target\&quot; if it supports condition evaluation, otherwise it will\n\</span>
<a name="l16540"></a>16540 <span class="stringliteral">be set to \&quot;gdb\&quot;&quot;</span>),
<a name="l16541"></a>16541                            &amp;set_condition_evaluation_mode,
<a name="l16542"></a>16542                            &amp;show_condition_evaluation_mode,
<a name="l16543"></a>16543                            &amp;breakpoint_set_cmdlist,
<a name="l16544"></a>16544                            &amp;breakpoint_show_cmdlist);
<a name="l16545"></a>16545 
<a name="l16546"></a>16546   <a class="code" href="cli-decode_8c.html#a0df0ca36d9acd96440e24407cbef593c">add_com</a> (<span class="stringliteral">&quot;break-range&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a803cb23b7faac7d3b865a0e6de82eda7">class_breakpoint</a>, break_range_command, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16547"></a>16547 <span class="stringliteral">Set a breakpoint for an address range.\n\</span>
<a name="l16548"></a>16548 <span class="stringliteral">break-range START-LOCATION, END-LOCATION\n\</span>
<a name="l16549"></a>16549 <span class="stringliteral">where START-LOCATION and END-LOCATION can be one of the following:\n\</span>
<a name="l16550"></a>16550 <span class="stringliteral">  LINENUM, for that line in the current file,\n\</span>
<a name="l16551"></a>16551 <span class="stringliteral">  FILE:LINENUM, for that line in that file,\n\</span>
<a name="l16552"></a>16552 <span class="stringliteral">  +OFFSET, for that number of lines after the current line\n\</span>
<a name="l16553"></a>16553 <span class="stringliteral">           or the start of the range\n\</span>
<a name="l16554"></a>16554 <span class="stringliteral">  FUNCTION, for the first line in that function,\n\</span>
<a name="l16555"></a>16555 <span class="stringliteral">  FILE:FUNCTION, to distinguish among like-named static functions.\n\</span>
<a name="l16556"></a>16556 <span class="stringliteral">  *ADDRESS, for the instruction at that address.\n\</span>
<a name="l16557"></a>16557 <span class="stringliteral">\n\</span>
<a name="l16558"></a>16558 <span class="stringliteral">The breakpoint will stop execution of the inferior whenever it executes\n\</span>
<a name="l16559"></a>16559 <span class="stringliteral">an instruction at any address within the [START-LOCATION, END-LOCATION]\n\</span>
<a name="l16560"></a>16560 <span class="stringliteral">range (including START-LOCATION and END-LOCATION).&quot;</span>));
<a name="l16561"></a>16561 
<a name="l16562"></a>16562   c = <a class="code" href="cli-decode_8c.html#a0df0ca36d9acd96440e24407cbef593c">add_com</a> (<span class="stringliteral">&quot;dprintf&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a803cb23b7faac7d3b865a0e6de82eda7">class_breakpoint</a>, dprintf_command, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16563"></a>16563 <span class="stringliteral">Set a dynamic printf at specified line or function.\n\</span>
<a name="l16564"></a>16564 <span class="stringliteral">dprintf location,format string,arg1,arg2,...\n\</span>
<a name="l16565"></a>16565 <span class="stringliteral">location may be a line number, function name, or \&quot;*\&quot; and an address.\n\</span>
<a name="l16566"></a>16566 <span class="stringliteral">If a line number is specified, break at start of code for that line.\n\</span>
<a name="l16567"></a>16567 <span class="stringliteral">If a function is specified, break at start of code for that function.&quot;</span>));
<a name="l16568"></a>16568   <a class="code" href="command_8h.html#abe42a75e35cfa78e2574e94904d86713">set_cmd_completer</a> (c, location_completer);
<a name="l16569"></a>16569 
<a name="l16570"></a>16570   <a class="code" href="cli-decode_8c.html#a79332268b2efb4698434e6ddf4d8c00e">add_setshow_enum_cmd</a> (<span class="stringliteral">&quot;dprintf-style&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a92be6efbab6bd9647a6f7a2862712d9b">class_support</a>,
<a name="l16571"></a>16571                         dprintf_style_enums, &amp;dprintf_style, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16572"></a>16572 <span class="stringliteral">Set the style of usage for dynamic printf.&quot;</span>), <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16573"></a>16573 <span class="stringliteral">Show the style of usage for dynamic printf.&quot;</span>), <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16574"></a>16574 <span class="stringliteral">This setting chooses how GDB will do a dynamic printf.\n\</span>
<a name="l16575"></a>16575 <span class="stringliteral">If the value is \&quot;gdb\&quot;, then the printing is done by GDB to its own\n\</span>
<a name="l16576"></a>16576 <span class="stringliteral">console, as with the \&quot;printf\&quot; command.\n\</span>
<a name="l16577"></a>16577 <span class="stringliteral">If the value is \&quot;call\&quot;, the print is done by calling a function in your\n\</span>
<a name="l16578"></a>16578 <span class="stringliteral">program; by default printf(), but you can choose a different function or\n\</span>
<a name="l16579"></a>16579 <span class="stringliteral">output stream by setting dprintf-function and dprintf-channel.&quot;</span>),
<a name="l16580"></a>16580                         update_dprintf_commands, NULL,
<a name="l16581"></a>16581                         &amp;<a class="code" href="cli-cmds_8c.html#a723e0174d833cba0aa82fb936a56c8fa">setlist</a>, &amp;<a class="code" href="cli-cmds_8c.html#a003932aa76fd3f41763ecc6bee5e2ca8">showlist</a>);
<a name="l16582"></a>16582 
<a name="l16583"></a>16583   dprintf_function = xstrdup (<span class="stringliteral">&quot;printf&quot;</span>);
<a name="l16584"></a>16584   <a class="code" href="cli-decode_8c.html#ae1abcdc8b2f24a182f5ba065cf50c81b">add_setshow_string_cmd</a> (<span class="stringliteral">&quot;dprintf-function&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a92be6efbab6bd9647a6f7a2862712d9b">class_support</a>,
<a name="l16585"></a>16585                           &amp;dprintf_function, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16586"></a>16586 <span class="stringliteral">Set the function to use for dynamic printf&quot;</span>), <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16587"></a>16587 <span class="stringliteral">Show the function to use for dynamic printf&quot;</span>), NULL,
<a name="l16588"></a>16588                           update_dprintf_commands, NULL,
<a name="l16589"></a>16589                           &amp;<a class="code" href="cli-cmds_8c.html#a723e0174d833cba0aa82fb936a56c8fa">setlist</a>, &amp;<a class="code" href="cli-cmds_8c.html#a003932aa76fd3f41763ecc6bee5e2ca8">showlist</a>);
<a name="l16590"></a>16590 
<a name="l16591"></a>16591   dprintf_channel = xstrdup (<span class="stringliteral">&quot;&quot;</span>);
<a name="l16592"></a>16592   <a class="code" href="cli-decode_8c.html#ae1abcdc8b2f24a182f5ba065cf50c81b">add_setshow_string_cmd</a> (<span class="stringliteral">&quot;dprintf-channel&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a92be6efbab6bd9647a6f7a2862712d9b">class_support</a>,
<a name="l16593"></a>16593                           &amp;dprintf_channel, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16594"></a>16594 <span class="stringliteral">Set the channel to use for dynamic printf&quot;</span>), <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16595"></a>16595 <span class="stringliteral">Show the channel to use for dynamic printf&quot;</span>), NULL,
<a name="l16596"></a>16596                           update_dprintf_commands, NULL,
<a name="l16597"></a>16597                           &amp;<a class="code" href="cli-cmds_8c.html#a723e0174d833cba0aa82fb936a56c8fa">setlist</a>, &amp;<a class="code" href="cli-cmds_8c.html#a003932aa76fd3f41763ecc6bee5e2ca8">showlist</a>);
<a name="l16598"></a>16598 
<a name="l16599"></a>16599   <a class="code" href="cli-decode_8c.html#ad86a0f135b6c546ae7ffbb41fd72e14f">add_setshow_boolean_cmd</a> (<span class="stringliteral">&quot;disconnected-dprintf&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49afbf489a4abce7e8770b178aa54f0908b">no_class</a>,
<a name="l16600"></a>16600                            &amp;disconnected_dprintf, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16601"></a>16601 <span class="stringliteral">Set whether dprintf continues after GDB disconnects.&quot;</span>), <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16602"></a>16602 <span class="stringliteral">Show whether dprintf continues after GDB disconnects.&quot;</span>), <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16603"></a>16603 <span class="stringliteral">Use this to let dprintf commands continue to hit and produce output\n\</span>
<a name="l16604"></a>16604 <span class="stringliteral">even if GDB disconnects or detaches from the target.&quot;</span>),
<a name="l16605"></a>16605                            NULL,
<a name="l16606"></a>16606                            NULL,
<a name="l16607"></a>16607                            &amp;<a class="code" href="cli-cmds_8c.html#a723e0174d833cba0aa82fb936a56c8fa">setlist</a>, &amp;<a class="code" href="cli-cmds_8c.html#a003932aa76fd3f41763ecc6bee5e2ca8">showlist</a>);
<a name="l16608"></a>16608 
<a name="l16609"></a>16609   <a class="code" href="cli-decode_8c.html#a0df0ca36d9acd96440e24407cbef593c">add_com</a> (<span class="stringliteral">&quot;agent-printf&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a882324bfe96480c161105fe35d4cd58b">class_vars</a>, agent_printf_command, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l16610"></a>16610 <span class="stringliteral">agent-printf \&quot;printf format string\&quot;, arg1, arg2, arg3, ..., argn\n\</span>
<a name="l16611"></a>16611 <span class="stringliteral">(target agent only) This is useful for formatted output in user-defined commands.&quot;</span>));
<a name="l16612"></a>16612 
<a name="l16613"></a>16613   automatic_hardware_breakpoints = 1;
<a name="l16614"></a>16614 
<a name="l16615"></a>16615   <a class="code" href="observer_8h.html#a36029354af4d88ac9a531ccf89aede20">observer_attach_about_to_proceed</a> (breakpoint_about_to_proceed);
<a name="l16616"></a>16616   <a class="code" href="observer_8h.html#ab8ba29ba5f9bd5ae038ee11c550b062d">observer_attach_thread_exit</a> (remove_threaded_breakpoints);
<a name="l16617"></a>16617 }
</pre></div></div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated on Fri Oct 11 2013 14:12:11 for GDB (API) by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
