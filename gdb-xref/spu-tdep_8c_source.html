<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>GDB (xrefs): /home/stan/gdb/src/gdb/spu-tdep.c Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">GDB (xrefs)
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">/home/stan/gdb/src/gdb/spu-tdep.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="spu-tdep_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/* SPU target-dependent code for GDB, the GNU debugger.</span>
<a name="l00002"></a>00002 <span class="comment">   Copyright (C) 2006-2013 Free Software Foundation, Inc.</span>
<a name="l00003"></a>00003 <span class="comment"></span>
<a name="l00004"></a>00004 <span class="comment">   Contributed by Ulrich Weigand &lt;uweigand@de.ibm.com&gt;.</span>
<a name="l00005"></a>00005 <span class="comment">   Based on a port by Sid Manning &lt;sid@us.ibm.com&gt;.</span>
<a name="l00006"></a>00006 <span class="comment"></span>
<a name="l00007"></a>00007 <span class="comment">   This file is part of GDB.</span>
<a name="l00008"></a>00008 <span class="comment"></span>
<a name="l00009"></a>00009 <span class="comment">   This program is free software; you can redistribute it and/or modify</span>
<a name="l00010"></a>00010 <span class="comment">   it under the terms of the GNU General Public License as published by</span>
<a name="l00011"></a>00011 <span class="comment">   the Free Software Foundation; either version 3 of the License, or</span>
<a name="l00012"></a>00012 <span class="comment">   (at your option) any later version.</span>
<a name="l00013"></a>00013 <span class="comment"></span>
<a name="l00014"></a>00014 <span class="comment">   This program is distributed in the hope that it will be useful,</span>
<a name="l00015"></a>00015 <span class="comment">   but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00016"></a>00016 <span class="comment">   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00017"></a>00017 <span class="comment">   GNU General Public License for more details.</span>
<a name="l00018"></a>00018 <span class="comment"></span>
<a name="l00019"></a>00019 <span class="comment">   You should have received a copy of the GNU General Public License</span>
<a name="l00020"></a>00020 <span class="comment">   along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.  */</span>
<a name="l00021"></a>00021 
<a name="l00022"></a>00022 <span class="preprocessor">#include &quot;<a class="code" href="defs_8h.html">defs.h</a>&quot;</span>
<a name="l00023"></a>00023 <span class="preprocessor">#include &quot;<a class="code" href="arch-utils_8h.html">arch-utils.h</a>&quot;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &quot;<a class="code" href="gdbtypes_8h.html">gdbtypes.h</a>&quot;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &quot;<a class="code" href="gdbcmd_8h.html">gdbcmd.h</a>&quot;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &quot;<a class="code" href="gdbcore_8h.html">gdbcore.h</a>&quot;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &quot;<a class="code" href="gdb__string_8h.html">gdb_string.h</a>&quot;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &quot;<a class="code" href="gdb__assert_8h.html">gdb_assert.h</a>&quot;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &quot;<a class="code" href="frame_8h.html">frame.h</a>&quot;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &quot;<a class="code" href="frame-unwind_8h.html">frame-unwind.h</a>&quot;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &quot;<a class="code" href="frame-base_8h.html">frame-base.h</a>&quot;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &quot;<a class="code" href="trad-frame_8h.html">trad-frame.h</a>&quot;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &quot;<a class="code" href="symtab_8h.html">symtab.h</a>&quot;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &quot;<a class="code" href="symfile_8h.html">symfile.h</a>&quot;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &quot;<a class="code" href="value_8h.html">value.h</a>&quot;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &quot;<a class="code" href="inferior_8h.html">inferior.h</a>&quot;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &quot;dis-asm.h&quot;</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include &quot;<a class="code" href="objfiles_8h.html">objfiles.h</a>&quot;</span>
<a name="l00039"></a>00039 <span class="preprocessor">#include &quot;<a class="code" href="language_8h.html">language.h</a>&quot;</span>
<a name="l00040"></a>00040 <span class="preprocessor">#include &quot;<a class="code" href="regcache_8h.html">regcache.h</a>&quot;</span>
<a name="l00041"></a>00041 <span class="preprocessor">#include &quot;<a class="code" href="reggroups_8h.html">reggroups.h</a>&quot;</span>
<a name="l00042"></a>00042 <span class="preprocessor">#include &quot;floatformat.h&quot;</span>
<a name="l00043"></a>00043 <span class="preprocessor">#include &quot;<a class="code" href="block_8h.html">block.h</a>&quot;</span>
<a name="l00044"></a>00044 <span class="preprocessor">#include &quot;<a class="code" href="observer_8h.html">observer.h</a>&quot;</span>
<a name="l00045"></a>00045 <span class="preprocessor">#include &quot;<a class="code" href="infcall_8h.html">infcall.h</a>&quot;</span>
<a name="l00046"></a>00046 <span class="preprocessor">#include &quot;dwarf2.h&quot;</span>
<a name="l00047"></a>00047 <span class="preprocessor">#include &quot;<a class="code" href="exceptions_8h.html">exceptions.h</a>&quot;</span>
<a name="l00048"></a>00048 <span class="preprocessor">#include &quot;<a class="code" href="spu-tdep_8h.html">spu-tdep.h</a>&quot;</span>
<a name="l00049"></a>00049 
<a name="l00050"></a>00050 
<a name="l00051"></a>00051 <span class="comment">/* The list of available &quot;set spu &quot; and &quot;show spu &quot; commands.  */</span>
<a name="l00052"></a><a class="code" href="spu-tdep_8c.html#a7abf3af79d7b03847b7d51dd7ea09471">00052</a> <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structcmd__list__element.html">cmd_list_element</a> *<a class="code" href="spu-tdep_8c.html#a7abf3af79d7b03847b7d51dd7ea09471">setspucmdlist</a> = NULL;
<a name="l00053"></a><a class="code" href="spu-tdep_8c.html#abd02f7861786bda031570cb9b0a2fba7">00053</a> <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structcmd__list__element.html">cmd_list_element</a> *<a class="code" href="spu-tdep_8c.html#abd02f7861786bda031570cb9b0a2fba7">showspucmdlist</a> = NULL;
<a name="l00054"></a>00054 
<a name="l00055"></a>00055 <span class="comment">/* Whether to stop for new SPE contexts.  */</span>
<a name="l00056"></a><a class="code" href="spu-tdep_8c.html#a7727de4d3c84d3cea031dea8953b8ad6">00056</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="spu-tdep_8c.html#a7727de4d3c84d3cea031dea8953b8ad6">spu_stop_on_load_p</a> = 0;
<a name="l00057"></a>00057 <span class="comment">/* Whether to automatically flush the SW-managed cache.  */</span>
<a name="l00058"></a><a class="code" href="spu-tdep_8c.html#a7a6c9e0cdc6342602ad23650b8f55c45">00058</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="spu-tdep_8c.html#a7a6c9e0cdc6342602ad23650b8f55c45">spu_auto_flush_cache_p</a> = 1;
<a name="l00059"></a>00059 
<a name="l00060"></a>00060 
<a name="l00061"></a>00061 <span class="comment">/* The tdep structure.  */</span>
<a name="l00062"></a>00062 <span class="keyword">struct </span><a class="code" href="structgdbarch__tdep.html">gdbarch_tdep</a>
<a name="l00063"></a>00063 {
<a name="l00064"></a>00064   <span class="comment">/* The spufs ID identifying our address space.  */</span>
<a name="l00065"></a><a class="code" href="structgdbarch__tdep.html#a6c04333e4962a9690dea1334a6201d30">00065</a>   <span class="keywordtype">int</span> <a class="code" href="structgdbarch__tdep.html#a6c04333e4962a9690dea1334a6201d30">id</a>;
<a name="l00066"></a>00066 
<a name="l00067"></a>00067   <span class="comment">/* SPU-specific vector type.  */</span>
<a name="l00068"></a><a class="code" href="structgdbarch__tdep.html#a673a50ce1df2ef281a329c51309bfced">00068</a>   <span class="keyword">struct </span><a class="code" href="structtype.html">type</a> *<a class="code" href="structgdbarch__tdep.html#a673a50ce1df2ef281a329c51309bfced">spu_builtin_type_vec128</a>;
<a name="l00069"></a>00069 };
<a name="l00070"></a>00070 
<a name="l00071"></a>00071 
<a name="l00072"></a>00072 <span class="comment">/* SPU-specific vector type.  */</span>
<a name="l00073"></a>00073 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structtype.html">type</a> *
<a name="l00074"></a><a class="code" href="spu-tdep_8c.html#aed97ac4d508609b58f24d08f6e8cf6cc">00074</a> <a class="code" href="spu-tdep_8c.html#aed97ac4d508609b58f24d08f6e8cf6cc">spu_builtin_type_vec128</a> (<span class="keyword">struct</span> <a class="code" href="structgdbarch.html">gdbarch</a> *<a class="code" href="structgdbarch.html">gdbarch</a>)
<a name="l00075"></a>00075 {
<a name="l00076"></a>00076   <span class="keyword">struct </span><a class="code" href="structgdbarch__tdep.html">gdbarch_tdep</a> *tdep = <a class="code" href="gdbarch_8c.html#acea996b7421706849bc20567695b5b31">gdbarch_tdep</a> (gdbarch);
<a name="l00077"></a>00077 
<a name="l00078"></a>00078   <span class="keywordflow">if</span> (!tdep-&gt;<a class="code" href="structgdbarch__tdep.html#a673a50ce1df2ef281a329c51309bfced">spu_builtin_type_vec128</a>)
<a name="l00079"></a>00079     {
<a name="l00080"></a>00080       <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structbuiltin__type.html">builtin_type</a> *bt = <a class="code" href="gdbtypes_8c.html#addd01ebc9ccdf2cacb33ab01e281ddb8">builtin_type</a> (gdbarch);
<a name="l00081"></a>00081       <span class="keyword">struct </span><a class="code" href="structtype.html">type</a> *t;
<a name="l00082"></a>00082 
<a name="l00083"></a>00083       t = <a class="code" href="gdbtypes_8c.html#a3e82e9d618c11c61cbae9b89d00efc1b">arch_composite_type</a> (gdbarch,
<a name="l00084"></a>00084                                <span class="stringliteral">&quot;__spu_builtin_type_vec128&quot;</span>, <a class="code" href="gdbtypes_8h.html#a90e2a0fddaa6afff6a0a489ff4da3462a8c3218d2f780665395d57dcd4d909191">TYPE_CODE_UNION</a>);
<a name="l00085"></a>00085       <a class="code" href="gdbtypes_8c.html#a8e501de48b50f6deb1568b5ade567f2a">append_composite_type_field</a> (t, <span class="stringliteral">&quot;uint128&quot;</span>, bt-&gt;<a class="code" href="structbuiltin__type.html#adab156fb5ac8e061ea16e8d6d0873a8f">builtin_int128</a>);
<a name="l00086"></a>00086       <a class="code" href="gdbtypes_8c.html#a8e501de48b50f6deb1568b5ade567f2a">append_composite_type_field</a> (t, <span class="stringliteral">&quot;v2_int64&quot;</span>,
<a name="l00087"></a>00087                                    <a class="code" href="gdbtypes_8c.html#a93eefcbb5ac6aec0f3f1c96e186bfdef">init_vector_type</a> (bt-&gt;<a class="code" href="structbuiltin__type.html#a96f3cd71c9619fa5a5ae644402e841ec">builtin_int64</a>, 2));
<a name="l00088"></a>00088       <a class="code" href="gdbtypes_8c.html#a8e501de48b50f6deb1568b5ade567f2a">append_composite_type_field</a> (t, <span class="stringliteral">&quot;v4_int32&quot;</span>,
<a name="l00089"></a>00089                                    <a class="code" href="gdbtypes_8c.html#a93eefcbb5ac6aec0f3f1c96e186bfdef">init_vector_type</a> (bt-&gt;<a class="code" href="structbuiltin__type.html#ab514809bc3e50d6db51f7b1b0729f2cb">builtin_int32</a>, 4));
<a name="l00090"></a>00090       <a class="code" href="gdbtypes_8c.html#a8e501de48b50f6deb1568b5ade567f2a">append_composite_type_field</a> (t, <span class="stringliteral">&quot;v8_int16&quot;</span>,
<a name="l00091"></a>00091                                    <a class="code" href="gdbtypes_8c.html#a93eefcbb5ac6aec0f3f1c96e186bfdef">init_vector_type</a> (bt-&gt;<a class="code" href="structbuiltin__type.html#adfd7e6377d8b18a3a019bdc9a7eff0b8">builtin_int16</a>, 8));
<a name="l00092"></a>00092       <a class="code" href="gdbtypes_8c.html#a8e501de48b50f6deb1568b5ade567f2a">append_composite_type_field</a> (t, <span class="stringliteral">&quot;v16_int8&quot;</span>,
<a name="l00093"></a>00093                                    <a class="code" href="gdbtypes_8c.html#a93eefcbb5ac6aec0f3f1c96e186bfdef">init_vector_type</a> (bt-&gt;<a class="code" href="structbuiltin__type.html#a3bda6904e80e6a0de09549a1b51fb088">builtin_int8</a>, 16));
<a name="l00094"></a>00094       <a class="code" href="gdbtypes_8c.html#a8e501de48b50f6deb1568b5ade567f2a">append_composite_type_field</a> (t, <span class="stringliteral">&quot;v2_double&quot;</span>,
<a name="l00095"></a>00095                                    <a class="code" href="gdbtypes_8c.html#a93eefcbb5ac6aec0f3f1c96e186bfdef">init_vector_type</a> (bt-&gt;<a class="code" href="structbuiltin__type.html#a29f1e28c1aa70321c4c7d4094f672b57">builtin_double</a>, 2));
<a name="l00096"></a>00096       <a class="code" href="gdbtypes_8c.html#a8e501de48b50f6deb1568b5ade567f2a">append_composite_type_field</a> (t, <span class="stringliteral">&quot;v4_float&quot;</span>,
<a name="l00097"></a>00097                                    <a class="code" href="gdbtypes_8c.html#a93eefcbb5ac6aec0f3f1c96e186bfdef">init_vector_type</a> (bt-&gt;<a class="code" href="structbuiltin__type.html#af44abaec1868fa0a34efaab02a436d6a">builtin_float</a>, 4));
<a name="l00098"></a>00098 
<a name="l00099"></a>00099       <a class="code" href="gdbtypes_8h.html#a68a23253bcb233221400208f4c21c406">TYPE_VECTOR</a> (t) = 1;
<a name="l00100"></a>00100       <a class="code" href="gdbtypes_8h.html#a60f6434779617e9ff9c60121ceb25015">TYPE_NAME</a> (t) = <span class="stringliteral">&quot;spu_builtin_type_vec128&quot;</span>;
<a name="l00101"></a>00101 
<a name="l00102"></a>00102       tdep-&gt;<a class="code" href="structgdbarch__tdep.html#a673a50ce1df2ef281a329c51309bfced">spu_builtin_type_vec128</a> = t;
<a name="l00103"></a>00103     }
<a name="l00104"></a>00104 
<a name="l00105"></a>00105   <span class="keywordflow">return</span> tdep-&gt;<a class="code" href="structgdbarch__tdep.html#a673a50ce1df2ef281a329c51309bfced">spu_builtin_type_vec128</a>;
<a name="l00106"></a>00106 }
<a name="l00107"></a>00107 
<a name="l00108"></a>00108 
<a name="l00109"></a>00109 <span class="comment">/* The list of available &quot;info spu &quot; commands.  */</span>
<a name="l00110"></a><a class="code" href="spu-tdep_8c.html#a40eb12b20085e21e6e65c529ad14d190">00110</a> <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structcmd__list__element.html">cmd_list_element</a> *<a class="code" href="spu-tdep_8c.html#a40eb12b20085e21e6e65c529ad14d190">infospucmdlist</a> = NULL;
<a name="l00111"></a>00111 
<a name="l00112"></a>00112 <span class="comment">/* Registers.  */</span>
<a name="l00113"></a>00113 
<a name="l00114"></a>00114 <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *
<a name="l00115"></a><a class="code" href="spu-tdep_8c.html#aedddb239dbf3ae30926c8b5522bcae7a">00115</a> <a class="code" href="spu-tdep_8c.html#aedddb239dbf3ae30926c8b5522bcae7a">spu_register_name</a> (<span class="keyword">struct</span> <a class="code" href="structgdbarch.html">gdbarch</a> *<a class="code" href="structgdbarch.html">gdbarch</a>, <span class="keywordtype">int</span> reg_nr)
<a name="l00116"></a>00116 {
<a name="l00117"></a>00117   <span class="keyword">static</span> <span class="keywordtype">char</span> *register_names[] = 
<a name="l00118"></a>00118     {
<a name="l00119"></a>00119       <span class="stringliteral">&quot;r0&quot;</span>, <span class="stringliteral">&quot;r1&quot;</span>, <span class="stringliteral">&quot;r2&quot;</span>, <span class="stringliteral">&quot;r3&quot;</span>, <span class="stringliteral">&quot;r4&quot;</span>, <span class="stringliteral">&quot;r5&quot;</span>, <span class="stringliteral">&quot;r6&quot;</span>, <span class="stringliteral">&quot;r7&quot;</span>,
<a name="l00120"></a>00120       <span class="stringliteral">&quot;r8&quot;</span>, <span class="stringliteral">&quot;r9&quot;</span>, <span class="stringliteral">&quot;r10&quot;</span>, <span class="stringliteral">&quot;r11&quot;</span>, <span class="stringliteral">&quot;r12&quot;</span>, <span class="stringliteral">&quot;r13&quot;</span>, <span class="stringliteral">&quot;r14&quot;</span>, <span class="stringliteral">&quot;r15&quot;</span>,
<a name="l00121"></a>00121       <span class="stringliteral">&quot;r16&quot;</span>, <span class="stringliteral">&quot;r17&quot;</span>, <span class="stringliteral">&quot;r18&quot;</span>, <span class="stringliteral">&quot;r19&quot;</span>, <span class="stringliteral">&quot;r20&quot;</span>, <span class="stringliteral">&quot;r21&quot;</span>, <span class="stringliteral">&quot;r22&quot;</span>, <span class="stringliteral">&quot;r23&quot;</span>,
<a name="l00122"></a>00122       <span class="stringliteral">&quot;r24&quot;</span>, <span class="stringliteral">&quot;r25&quot;</span>, <span class="stringliteral">&quot;r26&quot;</span>, <span class="stringliteral">&quot;r27&quot;</span>, <span class="stringliteral">&quot;r28&quot;</span>, <span class="stringliteral">&quot;r29&quot;</span>, <span class="stringliteral">&quot;r30&quot;</span>, <span class="stringliteral">&quot;r31&quot;</span>,
<a name="l00123"></a>00123       <span class="stringliteral">&quot;r32&quot;</span>, <span class="stringliteral">&quot;r33&quot;</span>, <span class="stringliteral">&quot;r34&quot;</span>, <span class="stringliteral">&quot;r35&quot;</span>, <span class="stringliteral">&quot;r36&quot;</span>, <span class="stringliteral">&quot;r37&quot;</span>, <span class="stringliteral">&quot;r38&quot;</span>, <span class="stringliteral">&quot;r39&quot;</span>,
<a name="l00124"></a>00124       <span class="stringliteral">&quot;r40&quot;</span>, <span class="stringliteral">&quot;r41&quot;</span>, <span class="stringliteral">&quot;r42&quot;</span>, <span class="stringliteral">&quot;r43&quot;</span>, <span class="stringliteral">&quot;r44&quot;</span>, <span class="stringliteral">&quot;r45&quot;</span>, <span class="stringliteral">&quot;r46&quot;</span>, <span class="stringliteral">&quot;r47&quot;</span>,
<a name="l00125"></a>00125       <span class="stringliteral">&quot;r48&quot;</span>, <span class="stringliteral">&quot;r49&quot;</span>, <span class="stringliteral">&quot;r50&quot;</span>, <span class="stringliteral">&quot;r51&quot;</span>, <span class="stringliteral">&quot;r52&quot;</span>, <span class="stringliteral">&quot;r53&quot;</span>, <span class="stringliteral">&quot;r54&quot;</span>, <span class="stringliteral">&quot;r55&quot;</span>,
<a name="l00126"></a>00126       <span class="stringliteral">&quot;r56&quot;</span>, <span class="stringliteral">&quot;r57&quot;</span>, <span class="stringliteral">&quot;r58&quot;</span>, <span class="stringliteral">&quot;r59&quot;</span>, <span class="stringliteral">&quot;r60&quot;</span>, <span class="stringliteral">&quot;r61&quot;</span>, <span class="stringliteral">&quot;r62&quot;</span>, <span class="stringliteral">&quot;r63&quot;</span>,
<a name="l00127"></a>00127       <span class="stringliteral">&quot;r64&quot;</span>, <span class="stringliteral">&quot;r65&quot;</span>, <span class="stringliteral">&quot;r66&quot;</span>, <span class="stringliteral">&quot;r67&quot;</span>, <span class="stringliteral">&quot;r68&quot;</span>, <span class="stringliteral">&quot;r69&quot;</span>, <span class="stringliteral">&quot;r70&quot;</span>, <span class="stringliteral">&quot;r71&quot;</span>,
<a name="l00128"></a>00128       <span class="stringliteral">&quot;r72&quot;</span>, <span class="stringliteral">&quot;r73&quot;</span>, <span class="stringliteral">&quot;r74&quot;</span>, <span class="stringliteral">&quot;r75&quot;</span>, <span class="stringliteral">&quot;r76&quot;</span>, <span class="stringliteral">&quot;r77&quot;</span>, <span class="stringliteral">&quot;r78&quot;</span>, <span class="stringliteral">&quot;r79&quot;</span>,
<a name="l00129"></a>00129       <span class="stringliteral">&quot;r80&quot;</span>, <span class="stringliteral">&quot;r81&quot;</span>, <span class="stringliteral">&quot;r82&quot;</span>, <span class="stringliteral">&quot;r83&quot;</span>, <span class="stringliteral">&quot;r84&quot;</span>, <span class="stringliteral">&quot;r85&quot;</span>, <span class="stringliteral">&quot;r86&quot;</span>, <span class="stringliteral">&quot;r87&quot;</span>,
<a name="l00130"></a>00130       <span class="stringliteral">&quot;r88&quot;</span>, <span class="stringliteral">&quot;r89&quot;</span>, <span class="stringliteral">&quot;r90&quot;</span>, <span class="stringliteral">&quot;r91&quot;</span>, <span class="stringliteral">&quot;r92&quot;</span>, <span class="stringliteral">&quot;r93&quot;</span>, <span class="stringliteral">&quot;r94&quot;</span>, <span class="stringliteral">&quot;r95&quot;</span>,
<a name="l00131"></a>00131       <span class="stringliteral">&quot;r96&quot;</span>, <span class="stringliteral">&quot;r97&quot;</span>, <span class="stringliteral">&quot;r98&quot;</span>, <span class="stringliteral">&quot;r99&quot;</span>, <span class="stringliteral">&quot;r100&quot;</span>, <span class="stringliteral">&quot;r101&quot;</span>, <span class="stringliteral">&quot;r102&quot;</span>, <span class="stringliteral">&quot;r103&quot;</span>,
<a name="l00132"></a>00132       <span class="stringliteral">&quot;r104&quot;</span>, <span class="stringliteral">&quot;r105&quot;</span>, <span class="stringliteral">&quot;r106&quot;</span>, <span class="stringliteral">&quot;r107&quot;</span>, <span class="stringliteral">&quot;r108&quot;</span>, <span class="stringliteral">&quot;r109&quot;</span>, <span class="stringliteral">&quot;r110&quot;</span>, <span class="stringliteral">&quot;r111&quot;</span>,
<a name="l00133"></a>00133       <span class="stringliteral">&quot;r112&quot;</span>, <span class="stringliteral">&quot;r113&quot;</span>, <span class="stringliteral">&quot;r114&quot;</span>, <span class="stringliteral">&quot;r115&quot;</span>, <span class="stringliteral">&quot;r116&quot;</span>, <span class="stringliteral">&quot;r117&quot;</span>, <span class="stringliteral">&quot;r118&quot;</span>, <span class="stringliteral">&quot;r119&quot;</span>,
<a name="l00134"></a>00134       <span class="stringliteral">&quot;r120&quot;</span>, <span class="stringliteral">&quot;r121&quot;</span>, <span class="stringliteral">&quot;r122&quot;</span>, <span class="stringliteral">&quot;r123&quot;</span>, <span class="stringliteral">&quot;r124&quot;</span>, <span class="stringliteral">&quot;r125&quot;</span>, <span class="stringliteral">&quot;r126&quot;</span>, <span class="stringliteral">&quot;r127&quot;</span>,
<a name="l00135"></a>00135       <span class="stringliteral">&quot;id&quot;</span>, <span class="stringliteral">&quot;pc&quot;</span>, <span class="stringliteral">&quot;sp&quot;</span>, <span class="stringliteral">&quot;fpscr&quot;</span>, <span class="stringliteral">&quot;srr0&quot;</span>, <span class="stringliteral">&quot;lslr&quot;</span>, <span class="stringliteral">&quot;decr&quot;</span>, <span class="stringliteral">&quot;decr_status&quot;</span>
<a name="l00136"></a>00136     };
<a name="l00137"></a>00137 
<a name="l00138"></a>00138   <span class="keywordflow">if</span> (reg_nr &lt; 0)
<a name="l00139"></a>00139     <span class="keywordflow">return</span> NULL;
<a name="l00140"></a>00140   <span class="keywordflow">if</span> (reg_nr &gt;= <span class="keyword">sizeof</span> register_names / <span class="keyword">sizeof</span> *register_names)
<a name="l00141"></a>00141     <span class="keywordflow">return</span> NULL;
<a name="l00142"></a>00142 
<a name="l00143"></a>00143   <span class="keywordflow">return</span> register_names[reg_nr];
<a name="l00144"></a>00144 }
<a name="l00145"></a>00145 
<a name="l00146"></a>00146 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structtype.html">type</a> *
<a name="l00147"></a><a class="code" href="spu-tdep_8c.html#a87a7ef44e19d693394ed6e1baa584172">00147</a> <a class="code" href="spu-tdep_8c.html#a87a7ef44e19d693394ed6e1baa584172">spu_register_type</a> (<span class="keyword">struct</span> <a class="code" href="structgdbarch.html">gdbarch</a> *<a class="code" href="structgdbarch.html">gdbarch</a>, <span class="keywordtype">int</span> reg_nr)
<a name="l00148"></a>00148 {
<a name="l00149"></a>00149   <span class="keywordflow">if</span> (reg_nr &lt; <a class="code" href="spu-tdep_8h.html#ad0163bbd1f46cdbddab0c0871bfa1658">SPU_NUM_GPRS</a>)
<a name="l00150"></a>00150     <span class="keywordflow">return</span> <a class="code" href="spu-tdep_8c.html#aed97ac4d508609b58f24d08f6e8cf6cc">spu_builtin_type_vec128</a> (gdbarch);
<a name="l00151"></a>00151 
<a name="l00152"></a>00152   <span class="keywordflow">switch</span> (reg_nr)
<a name="l00153"></a>00153     {
<a name="l00154"></a>00154     <span class="keywordflow">case</span> <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4ca2d3903584b23e19e9df838dc3939cf45">SPU_ID_REGNUM</a>:
<a name="l00155"></a>00155       <span class="keywordflow">return</span> <a class="code" href="gdbtypes_8c.html#addd01ebc9ccdf2cacb33ab01e281ddb8">builtin_type</a> (gdbarch)-&gt;<a class="code" href="structbuiltin__type.html#a7d0cf7d4e93c3cd2f1b744a18fa23b80">builtin_uint32</a>;
<a name="l00156"></a>00156 
<a name="l00157"></a>00157     <span class="keywordflow">case</span> <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4cac5c6ca5984213bd79f0060b49caef630">SPU_PC_REGNUM</a>:
<a name="l00158"></a>00158       <span class="keywordflow">return</span> <a class="code" href="gdbtypes_8c.html#addd01ebc9ccdf2cacb33ab01e281ddb8">builtin_type</a> (gdbarch)-&gt;<a class="code" href="structbuiltin__type.html#a3db2ea73bd0003f6e6103bd031ba7cb1">builtin_func_ptr</a>;
<a name="l00159"></a>00159 
<a name="l00160"></a>00160     <span class="keywordflow">case</span> <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4ca4d2edf1cf9cd8c1c52cde68536a2c45d">SPU_SP_REGNUM</a>:
<a name="l00161"></a>00161       <span class="keywordflow">return</span> <a class="code" href="gdbtypes_8c.html#addd01ebc9ccdf2cacb33ab01e281ddb8">builtin_type</a> (gdbarch)-&gt;<a class="code" href="structbuiltin__type.html#a55f6f9ff7436431777683d8ba62f662a">builtin_data_ptr</a>;
<a name="l00162"></a>00162 
<a name="l00163"></a>00163     <span class="keywordflow">case</span> <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4cac92883c3c9296f67b9c33c181c6eeb7c">SPU_FPSCR_REGNUM</a>:
<a name="l00164"></a>00164       <span class="keywordflow">return</span> <a class="code" href="gdbtypes_8c.html#addd01ebc9ccdf2cacb33ab01e281ddb8">builtin_type</a> (gdbarch)-&gt;<a class="code" href="structbuiltin__type.html#a462e5c89d490be8effbd7f3efd50e330">builtin_uint128</a>;
<a name="l00165"></a>00165 
<a name="l00166"></a>00166     <span class="keywordflow">case</span> <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4ca7940e784d6350882f2dc3df2b9340770">SPU_SRR0_REGNUM</a>:
<a name="l00167"></a>00167       <span class="keywordflow">return</span> <a class="code" href="gdbtypes_8c.html#addd01ebc9ccdf2cacb33ab01e281ddb8">builtin_type</a> (gdbarch)-&gt;<a class="code" href="structbuiltin__type.html#a7d0cf7d4e93c3cd2f1b744a18fa23b80">builtin_uint32</a>;
<a name="l00168"></a>00168 
<a name="l00169"></a>00169     <span class="keywordflow">case</span> <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4caecf4c88f627410a19e73e47634c38b03">SPU_LSLR_REGNUM</a>:
<a name="l00170"></a>00170       <span class="keywordflow">return</span> <a class="code" href="gdbtypes_8c.html#addd01ebc9ccdf2cacb33ab01e281ddb8">builtin_type</a> (gdbarch)-&gt;<a class="code" href="structbuiltin__type.html#a7d0cf7d4e93c3cd2f1b744a18fa23b80">builtin_uint32</a>;
<a name="l00171"></a>00171 
<a name="l00172"></a>00172     <span class="keywordflow">case</span> <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4cacada022dbf96dd77584dc80f9bd67406">SPU_DECR_REGNUM</a>:
<a name="l00173"></a>00173       <span class="keywordflow">return</span> <a class="code" href="gdbtypes_8c.html#addd01ebc9ccdf2cacb33ab01e281ddb8">builtin_type</a> (gdbarch)-&gt;<a class="code" href="structbuiltin__type.html#a7d0cf7d4e93c3cd2f1b744a18fa23b80">builtin_uint32</a>;
<a name="l00174"></a>00174 
<a name="l00175"></a>00175     <span class="keywordflow">case</span> <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4caae4a813a063302e1a376c9dc6f3fb96f">SPU_DECR_STATUS_REGNUM</a>:
<a name="l00176"></a>00176       <span class="keywordflow">return</span> <a class="code" href="gdbtypes_8c.html#addd01ebc9ccdf2cacb33ab01e281ddb8">builtin_type</a> (gdbarch)-&gt;<a class="code" href="structbuiltin__type.html#a7d0cf7d4e93c3cd2f1b744a18fa23b80">builtin_uint32</a>;
<a name="l00177"></a>00177 
<a name="l00178"></a>00178     <span class="keywordflow">default</span>:
<a name="l00179"></a>00179       <a class="code" href="common-utils_8h.html#aa14285d9d3d4171016ef9cf09447e8bb">internal_error</a> (__FILE__, __LINE__, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;invalid regnum&quot;</span>));
<a name="l00180"></a>00180     }
<a name="l00181"></a>00181 }
<a name="l00182"></a>00182 
<a name="l00183"></a>00183 <span class="comment">/* Pseudo registers for preferred slots - stack pointer.  */</span>
<a name="l00184"></a>00184 
<a name="l00185"></a>00185 <span class="keyword">static</span> <span class="keyword">enum</span> <a class="code" href="regcache_8h.html#af900cc04e1a55ea5ae1edc80570f91f7">register_status</a>
<a name="l00186"></a><a class="code" href="spu-tdep_8c.html#a881c3dd3286bd0d2b195214d3dc7c522">00186</a> <a class="code" href="spu-tdep_8c.html#a881c3dd3286bd0d2b195214d3dc7c522">spu_pseudo_register_read_spu</a> (<span class="keyword">struct</span> <a class="code" href="structregcache.html">regcache</a> *<a class="code" href="structregcache.html">regcache</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *regname,
<a name="l00187"></a>00187                               <a class="code" href="defs_8h.html#a336b399b3b83dbcc61f176c33f26b607">gdb_byte</a> *buf)
<a name="l00188"></a>00188 {
<a name="l00189"></a>00189   <span class="keyword">struct </span><a class="code" href="structgdbarch.html">gdbarch</a> *<a class="code" href="structgdbarch.html">gdbarch</a> = <a class="code" href="regcache_8c.html#ad4f6d0cdf256b1fa45d59a6d71b50659">get_regcache_arch</a> (regcache);
<a name="l00190"></a>00190   <span class="keyword">enum</span> bfd_endian <a class="code" href="structgdbarch.html#a7a9dd6544406e9cbb574dae9d531346e">byte_order</a> = <a class="code" href="gdbarch_8c.html#abc300a3797421aa7342b288e1637483e">gdbarch_byte_order</a> (gdbarch);
<a name="l00191"></a>00191   <span class="keyword">enum</span> <a class="code" href="regcache_8h.html#af900cc04e1a55ea5ae1edc80570f91f7">register_status</a> <a class="code" href="namespaceexsummary.html#aa4a2eed06e51a1f73ff9053ec9f2591e">status</a>;
<a name="l00192"></a>00192   <a class="code" href="defs_8h.html#a336b399b3b83dbcc61f176c33f26b607">gdb_byte</a> <a class="code" href="structreg.html">reg</a>[32];
<a name="l00193"></a>00193   <span class="keywordtype">char</span> annex[32];
<a name="l00194"></a>00194   <a class="code" href="defs_8h.html#a4df4af8771b1016a24976757026f4984">ULONGEST</a> id;
<a name="l00195"></a>00195   <a class="code" href="defs_8h.html#a4df4af8771b1016a24976757026f4984">ULONGEST</a> ul;
<a name="l00196"></a>00196 
<a name="l00197"></a>00197   status = <a class="code" href="regcache_8c.html#a465c747dfdb94bb985d56e0374eb4481">regcache_raw_read_unsigned</a> (regcache, <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4ca2d3903584b23e19e9df838dc3939cf45">SPU_ID_REGNUM</a>, &amp;<span class="keywordtype">id</span>);
<a name="l00198"></a>00198   <span class="keywordflow">if</span> (status != <a class="code" href="regcache_8h.html#af900cc04e1a55ea5ae1edc80570f91f7a0155a2fd1e7e3b53cf1d75cf675d2ea2">REG_VALID</a>)
<a name="l00199"></a>00199     <span class="keywordflow">return</span> <a class="code" href="namespaceexsummary.html#aa4a2eed06e51a1f73ff9053ec9f2591e">status</a>;
<a name="l00200"></a>00200   <a class="code" href="common-utils_8c.html#ad9940337ec98983dae9951c947879fc8">xsnprintf</a> (annex, <span class="keyword">sizeof</span> annex, <span class="stringliteral">&quot;%d/%s&quot;</span>, (<span class="keywordtype">int</span>) <span class="keywordtype">id</span>, regname);
<a name="l00201"></a>00201   <a class="code" href="gdb__string_8h.html#adb03df3679ce1445e801310614624ccb">memset</a> (reg, 0, <span class="keyword">sizeof</span> reg);
<a name="l00202"></a>00202   <a class="code" href="target_8c.html#aac7df8f3a1d061c97c45219ed0cace6c">target_read</a> (&amp;<a class="code" href="target_8h.html#a2d8640b030266b58d3821eb5cfd112b9">current_target</a>, <a class="code" href="target_8h.html#aa5a3e4ceb377c9f5822cdc68c6f138e2a09790d59558546bb5ab8aa15ae6fbc74">TARGET_OBJECT_SPU</a>, annex,
<a name="l00203"></a>00203                reg, 0, <span class="keyword">sizeof</span> reg);
<a name="l00204"></a>00204 
<a name="l00205"></a>00205   ul = <a class="code" href="utils_8c.html#a4382e498f35b82f89a57692b78104d2d">strtoulst</a> ((<span class="keywordtype">char</span> *) reg, NULL, 16);
<a name="l00206"></a>00206   <a class="code" href="defs_8h.html#ad11c013c83c64d9d0ee2e4bdeb1fb62d">store_unsigned_integer</a> (buf, 4, byte_order, ul);
<a name="l00207"></a>00207   <span class="keywordflow">return</span> <a class="code" href="regcache_8h.html#af900cc04e1a55ea5ae1edc80570f91f7a0155a2fd1e7e3b53cf1d75cf675d2ea2">REG_VALID</a>;
<a name="l00208"></a>00208 }
<a name="l00209"></a>00209 
<a name="l00210"></a>00210 <span class="keyword">static</span> <span class="keyword">enum</span> <a class="code" href="regcache_8h.html#af900cc04e1a55ea5ae1edc80570f91f7">register_status</a>
<a name="l00211"></a><a class="code" href="spu-tdep_8c.html#a30664d6761ac66712b4edd96f95e2196">00211</a> <a class="code" href="spu-tdep_8c.html#a30664d6761ac66712b4edd96f95e2196">spu_pseudo_register_read</a> (<span class="keyword">struct</span> <a class="code" href="structgdbarch.html">gdbarch</a> *<a class="code" href="structgdbarch.html">gdbarch</a>, <span class="keyword">struct</span> <a class="code" href="structregcache.html">regcache</a> *<a class="code" href="structregcache.html">regcache</a>,
<a name="l00212"></a>00212                           <span class="keywordtype">int</span> <a class="code" href="aarch64-tdep_8c.html#a6b3d1ad0bca4067ccaef1366bea0db04">regnum</a>, <a class="code" href="defs_8h.html#a336b399b3b83dbcc61f176c33f26b607">gdb_byte</a> *buf)
<a name="l00213"></a>00213 {
<a name="l00214"></a>00214   <a class="code" href="defs_8h.html#a336b399b3b83dbcc61f176c33f26b607">gdb_byte</a> <a class="code" href="structreg.html">reg</a>[16];
<a name="l00215"></a>00215   <span class="keywordtype">char</span> annex[32];
<a name="l00216"></a>00216   <a class="code" href="defs_8h.html#a4df4af8771b1016a24976757026f4984">ULONGEST</a> id;
<a name="l00217"></a>00217   <span class="keyword">enum</span> <a class="code" href="regcache_8h.html#af900cc04e1a55ea5ae1edc80570f91f7">register_status</a> <a class="code" href="namespaceexsummary.html#aa4a2eed06e51a1f73ff9053ec9f2591e">status</a>;
<a name="l00218"></a>00218 
<a name="l00219"></a>00219   <span class="keywordflow">switch</span> (regnum)
<a name="l00220"></a>00220     {
<a name="l00221"></a>00221     <span class="keywordflow">case</span> <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4ca4d2edf1cf9cd8c1c52cde68536a2c45d">SPU_SP_REGNUM</a>:
<a name="l00222"></a>00222       status = <a class="code" href="regcache_8c.html#a995b366cfa6f89eaa36c6e88227f3462">regcache_raw_read</a> (regcache, <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4caa2793092717e5a3149a148e738f44a53">SPU_RAW_SP_REGNUM</a>, reg);
<a name="l00223"></a>00223       <span class="keywordflow">if</span> (status != <a class="code" href="regcache_8h.html#af900cc04e1a55ea5ae1edc80570f91f7a0155a2fd1e7e3b53cf1d75cf675d2ea2">REG_VALID</a>)
<a name="l00224"></a>00224         <span class="keywordflow">return</span> <a class="code" href="namespaceexsummary.html#aa4a2eed06e51a1f73ff9053ec9f2591e">status</a>;
<a name="l00225"></a>00225       <a class="code" href="gdb__string_8h.html#a39ebe6a4e122707997e78b549a1e8c5e">memcpy</a> (buf, reg, 4);
<a name="l00226"></a>00226       <span class="keywordflow">return</span> <a class="code" href="namespaceexsummary.html#aa4a2eed06e51a1f73ff9053ec9f2591e">status</a>;
<a name="l00227"></a>00227 
<a name="l00228"></a>00228     <span class="keywordflow">case</span> <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4cac92883c3c9296f67b9c33c181c6eeb7c">SPU_FPSCR_REGNUM</a>:
<a name="l00229"></a>00229       status = <a class="code" href="regcache_8c.html#a465c747dfdb94bb985d56e0374eb4481">regcache_raw_read_unsigned</a> (regcache, <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4ca2d3903584b23e19e9df838dc3939cf45">SPU_ID_REGNUM</a>, &amp;<span class="keywordtype">id</span>);
<a name="l00230"></a>00230       <span class="keywordflow">if</span> (status != <a class="code" href="regcache_8h.html#af900cc04e1a55ea5ae1edc80570f91f7a0155a2fd1e7e3b53cf1d75cf675d2ea2">REG_VALID</a>)
<a name="l00231"></a>00231         <span class="keywordflow">return</span> <a class="code" href="namespaceexsummary.html#aa4a2eed06e51a1f73ff9053ec9f2591e">status</a>;
<a name="l00232"></a>00232       <a class="code" href="common-utils_8c.html#ad9940337ec98983dae9951c947879fc8">xsnprintf</a> (annex, <span class="keyword">sizeof</span> annex, <span class="stringliteral">&quot;%d/fpcr&quot;</span>, (<span class="keywordtype">int</span>) <span class="keywordtype">id</span>);
<a name="l00233"></a>00233       <a class="code" href="target_8c.html#aac7df8f3a1d061c97c45219ed0cace6c">target_read</a> (&amp;<a class="code" href="target_8h.html#a2d8640b030266b58d3821eb5cfd112b9">current_target</a>, <a class="code" href="target_8h.html#aa5a3e4ceb377c9f5822cdc68c6f138e2a09790d59558546bb5ab8aa15ae6fbc74">TARGET_OBJECT_SPU</a>, annex, buf, 0, 16);
<a name="l00234"></a>00234       <span class="keywordflow">return</span> <a class="code" href="namespaceexsummary.html#aa4a2eed06e51a1f73ff9053ec9f2591e">status</a>;
<a name="l00235"></a>00235 
<a name="l00236"></a>00236     <span class="keywordflow">case</span> <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4ca7940e784d6350882f2dc3df2b9340770">SPU_SRR0_REGNUM</a>:
<a name="l00237"></a>00237       <span class="keywordflow">return</span> <a class="code" href="spu-tdep_8c.html#a881c3dd3286bd0d2b195214d3dc7c522">spu_pseudo_register_read_spu</a> (regcache, <span class="stringliteral">&quot;srr0&quot;</span>, buf);
<a name="l00238"></a>00238 
<a name="l00239"></a>00239     <span class="keywordflow">case</span> <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4caecf4c88f627410a19e73e47634c38b03">SPU_LSLR_REGNUM</a>:
<a name="l00240"></a>00240       <span class="keywordflow">return</span> <a class="code" href="spu-tdep_8c.html#a881c3dd3286bd0d2b195214d3dc7c522">spu_pseudo_register_read_spu</a> (regcache, <span class="stringliteral">&quot;lslr&quot;</span>, buf);
<a name="l00241"></a>00241 
<a name="l00242"></a>00242     <span class="keywordflow">case</span> <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4cacada022dbf96dd77584dc80f9bd67406">SPU_DECR_REGNUM</a>:
<a name="l00243"></a>00243       <span class="keywordflow">return</span> <a class="code" href="spu-tdep_8c.html#a881c3dd3286bd0d2b195214d3dc7c522">spu_pseudo_register_read_spu</a> (regcache, <span class="stringliteral">&quot;decr&quot;</span>, buf);
<a name="l00244"></a>00244 
<a name="l00245"></a>00245     <span class="keywordflow">case</span> <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4caae4a813a063302e1a376c9dc6f3fb96f">SPU_DECR_STATUS_REGNUM</a>:
<a name="l00246"></a>00246       <span class="keywordflow">return</span> <a class="code" href="spu-tdep_8c.html#a881c3dd3286bd0d2b195214d3dc7c522">spu_pseudo_register_read_spu</a> (regcache, <span class="stringliteral">&quot;decr_status&quot;</span>, buf);
<a name="l00247"></a>00247 
<a name="l00248"></a>00248     <span class="keywordflow">default</span>:
<a name="l00249"></a>00249       <a class="code" href="common-utils_8h.html#aa14285d9d3d4171016ef9cf09447e8bb">internal_error</a> (__FILE__, __LINE__, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;invalid regnum&quot;</span>));
<a name="l00250"></a>00250     }
<a name="l00251"></a>00251 }
<a name="l00252"></a>00252 
<a name="l00253"></a>00253 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00254"></a><a class="code" href="spu-tdep_8c.html#aca09f7ae2186ecf3ca4b28e0a3dc8128">00254</a> <a class="code" href="spu-tdep_8c.html#aca09f7ae2186ecf3ca4b28e0a3dc8128">spu_pseudo_register_write_spu</a> (<span class="keyword">struct</span> <a class="code" href="structregcache.html">regcache</a> *<a class="code" href="structregcache.html">regcache</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *regname,
<a name="l00255"></a>00255                                <span class="keyword">const</span> <a class="code" href="defs_8h.html#a336b399b3b83dbcc61f176c33f26b607">gdb_byte</a> *buf)
<a name="l00256"></a>00256 {
<a name="l00257"></a>00257   <span class="keyword">struct </span><a class="code" href="structgdbarch.html">gdbarch</a> *<a class="code" href="structgdbarch.html">gdbarch</a> = <a class="code" href="regcache_8c.html#ad4f6d0cdf256b1fa45d59a6d71b50659">get_regcache_arch</a> (regcache);
<a name="l00258"></a>00258   <span class="keyword">enum</span> bfd_endian <a class="code" href="structgdbarch.html#a7a9dd6544406e9cbb574dae9d531346e">byte_order</a> = <a class="code" href="gdbarch_8c.html#abc300a3797421aa7342b288e1637483e">gdbarch_byte_order</a> (gdbarch);
<a name="l00259"></a>00259   <span class="keywordtype">char</span> <a class="code" href="structreg.html">reg</a>[32];
<a name="l00260"></a>00260   <span class="keywordtype">char</span> annex[32];
<a name="l00261"></a>00261   <a class="code" href="defs_8h.html#a4df4af8771b1016a24976757026f4984">ULONGEST</a> id;
<a name="l00262"></a>00262 
<a name="l00263"></a>00263   <a class="code" href="regcache_8c.html#a465c747dfdb94bb985d56e0374eb4481">regcache_raw_read_unsigned</a> (regcache, <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4ca2d3903584b23e19e9df838dc3939cf45">SPU_ID_REGNUM</a>, &amp;<span class="keywordtype">id</span>);
<a name="l00264"></a>00264   <a class="code" href="common-utils_8c.html#ad9940337ec98983dae9951c947879fc8">xsnprintf</a> (annex, <span class="keyword">sizeof</span> annex, <span class="stringliteral">&quot;%d/%s&quot;</span>, (<span class="keywordtype">int</span>) <span class="keywordtype">id</span>, regname);
<a name="l00265"></a>00265   <a class="code" href="common-utils_8c.html#ad9940337ec98983dae9951c947879fc8">xsnprintf</a> (reg, <span class="keyword">sizeof</span> reg, <span class="stringliteral">&quot;0x%s&quot;</span>,
<a name="l00266"></a>00266              <a class="code" href="utils_8c.html#ac2742d41c48dc5ede26d22070fbc486a">phex_nz</a> (<a class="code" href="defs_8h.html#a99aec65329508b4d449a4f881026f844">extract_unsigned_integer</a> (buf, 4, byte_order), 4));
<a name="l00267"></a>00267   <a class="code" href="target_8c.html#ad865b9b4803919e5eae9df26437e0a59">target_write</a> (&amp;<a class="code" href="target_8h.html#a2d8640b030266b58d3821eb5cfd112b9">current_target</a>, <a class="code" href="target_8h.html#aa5a3e4ceb377c9f5822cdc68c6f138e2a09790d59558546bb5ab8aa15ae6fbc74">TARGET_OBJECT_SPU</a>, annex,
<a name="l00268"></a>00268                 (<a class="code" href="defs_8h.html#a336b399b3b83dbcc61f176c33f26b607">gdb_byte</a> *) reg, 0, strlen (reg));
<a name="l00269"></a>00269 }
<a name="l00270"></a>00270 
<a name="l00271"></a>00271 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00272"></a><a class="code" href="spu-tdep_8c.html#a3eab080857c685a19f04c45f6938c3e9">00272</a> <a class="code" href="spu-tdep_8c.html#a3eab080857c685a19f04c45f6938c3e9">spu_pseudo_register_write</a> (<span class="keyword">struct</span> <a class="code" href="structgdbarch.html">gdbarch</a> *<a class="code" href="structgdbarch.html">gdbarch</a>, <span class="keyword">struct</span> <a class="code" href="structregcache.html">regcache</a> *<a class="code" href="structregcache.html">regcache</a>,
<a name="l00273"></a>00273                            <span class="keywordtype">int</span> <a class="code" href="aarch64-tdep_8c.html#a6b3d1ad0bca4067ccaef1366bea0db04">regnum</a>, <span class="keyword">const</span> <a class="code" href="defs_8h.html#a336b399b3b83dbcc61f176c33f26b607">gdb_byte</a> *buf)
<a name="l00274"></a>00274 {
<a name="l00275"></a>00275   <a class="code" href="defs_8h.html#a336b399b3b83dbcc61f176c33f26b607">gdb_byte</a> <a class="code" href="structreg.html">reg</a>[16];
<a name="l00276"></a>00276   <span class="keywordtype">char</span> annex[32];
<a name="l00277"></a>00277   <a class="code" href="defs_8h.html#a4df4af8771b1016a24976757026f4984">ULONGEST</a> id;
<a name="l00278"></a>00278 
<a name="l00279"></a>00279   <span class="keywordflow">switch</span> (regnum)
<a name="l00280"></a>00280     {
<a name="l00281"></a>00281     <span class="keywordflow">case</span> <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4ca4d2edf1cf9cd8c1c52cde68536a2c45d">SPU_SP_REGNUM</a>:
<a name="l00282"></a>00282       <a class="code" href="regcache_8c.html#a995b366cfa6f89eaa36c6e88227f3462">regcache_raw_read</a> (regcache, <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4caa2793092717e5a3149a148e738f44a53">SPU_RAW_SP_REGNUM</a>, reg);
<a name="l00283"></a>00283       <a class="code" href="gdb__string_8h.html#a39ebe6a4e122707997e78b549a1e8c5e">memcpy</a> (reg, buf, 4);
<a name="l00284"></a>00284       <a class="code" href="regcache_8c.html#a1102769bb633fd84087614a3fc5c6e20">regcache_raw_write</a> (regcache, <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4caa2793092717e5a3149a148e738f44a53">SPU_RAW_SP_REGNUM</a>, reg);
<a name="l00285"></a>00285       <span class="keywordflow">break</span>;
<a name="l00286"></a>00286 
<a name="l00287"></a>00287     <span class="keywordflow">case</span> <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4cac92883c3c9296f67b9c33c181c6eeb7c">SPU_FPSCR_REGNUM</a>:
<a name="l00288"></a>00288       <a class="code" href="regcache_8c.html#a465c747dfdb94bb985d56e0374eb4481">regcache_raw_read_unsigned</a> (regcache, <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4ca2d3903584b23e19e9df838dc3939cf45">SPU_ID_REGNUM</a>, &amp;<span class="keywordtype">id</span>);
<a name="l00289"></a>00289       <a class="code" href="common-utils_8c.html#ad9940337ec98983dae9951c947879fc8">xsnprintf</a> (annex, <span class="keyword">sizeof</span> annex, <span class="stringliteral">&quot;%d/fpcr&quot;</span>, (<span class="keywordtype">int</span>) <span class="keywordtype">id</span>);
<a name="l00290"></a>00290       <a class="code" href="target_8c.html#ad865b9b4803919e5eae9df26437e0a59">target_write</a> (&amp;<a class="code" href="target_8h.html#a2d8640b030266b58d3821eb5cfd112b9">current_target</a>, <a class="code" href="target_8h.html#aa5a3e4ceb377c9f5822cdc68c6f138e2a09790d59558546bb5ab8aa15ae6fbc74">TARGET_OBJECT_SPU</a>, annex, buf, 0, 16);
<a name="l00291"></a>00291       <span class="keywordflow">break</span>;
<a name="l00292"></a>00292 
<a name="l00293"></a>00293     <span class="keywordflow">case</span> <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4ca7940e784d6350882f2dc3df2b9340770">SPU_SRR0_REGNUM</a>:
<a name="l00294"></a>00294       <a class="code" href="spu-tdep_8c.html#aca09f7ae2186ecf3ca4b28e0a3dc8128">spu_pseudo_register_write_spu</a> (regcache, <span class="stringliteral">&quot;srr0&quot;</span>, buf);
<a name="l00295"></a>00295       <span class="keywordflow">break</span>;
<a name="l00296"></a>00296 
<a name="l00297"></a>00297     <span class="keywordflow">case</span> <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4caecf4c88f627410a19e73e47634c38b03">SPU_LSLR_REGNUM</a>:
<a name="l00298"></a>00298       <a class="code" href="spu-tdep_8c.html#aca09f7ae2186ecf3ca4b28e0a3dc8128">spu_pseudo_register_write_spu</a> (regcache, <span class="stringliteral">&quot;lslr&quot;</span>, buf);
<a name="l00299"></a>00299       <span class="keywordflow">break</span>;
<a name="l00300"></a>00300 
<a name="l00301"></a>00301     <span class="keywordflow">case</span> <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4cacada022dbf96dd77584dc80f9bd67406">SPU_DECR_REGNUM</a>:
<a name="l00302"></a>00302       <a class="code" href="spu-tdep_8c.html#aca09f7ae2186ecf3ca4b28e0a3dc8128">spu_pseudo_register_write_spu</a> (regcache, <span class="stringliteral">&quot;decr&quot;</span>, buf);
<a name="l00303"></a>00303       <span class="keywordflow">break</span>;
<a name="l00304"></a>00304 
<a name="l00305"></a>00305     <span class="keywordflow">case</span> <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4caae4a813a063302e1a376c9dc6f3fb96f">SPU_DECR_STATUS_REGNUM</a>:
<a name="l00306"></a>00306       <a class="code" href="spu-tdep_8c.html#aca09f7ae2186ecf3ca4b28e0a3dc8128">spu_pseudo_register_write_spu</a> (regcache, <span class="stringliteral">&quot;decr_status&quot;</span>, buf);
<a name="l00307"></a>00307       <span class="keywordflow">break</span>;
<a name="l00308"></a>00308 
<a name="l00309"></a>00309     <span class="keywordflow">default</span>:
<a name="l00310"></a>00310       <a class="code" href="common-utils_8h.html#aa14285d9d3d4171016ef9cf09447e8bb">internal_error</a> (__FILE__, __LINE__, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;invalid regnum&quot;</span>));
<a name="l00311"></a>00311     }
<a name="l00312"></a>00312 }
<a name="l00313"></a>00313 
<a name="l00314"></a>00314 <span class="comment">/* Value conversion -- access scalar values at the preferred slot.  */</span>
<a name="l00315"></a>00315 
<a name="l00316"></a>00316 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structvalue.html">value</a> *
<a name="l00317"></a><a class="code" href="spu-tdep_8c.html#a593c2ca1951c05283797db39013c8673">00317</a> <a class="code" href="spu-tdep_8c.html#a593c2ca1951c05283797db39013c8673">spu_value_from_register</a> (<span class="keyword">struct</span> <a class="code" href="structtype.html">type</a> *<a class="code" href="structtype.html">type</a>, <span class="keywordtype">int</span> <a class="code" href="aarch64-tdep_8c.html#a6b3d1ad0bca4067ccaef1366bea0db04">regnum</a>,
<a name="l00318"></a>00318                          <span class="keyword">struct</span> <a class="code" href="structframe__info.html">frame_info</a> *frame)
<a name="l00319"></a>00319 {
<a name="l00320"></a>00320   <span class="keyword">struct </span><a class="code" href="structvalue.html">value</a> *<a class="code" href="structvalue.html">value</a> = <a class="code" href="findvar_8c.html#ab542ad3f3d8b01a2f3e4109fe393b484">default_value_from_register</a> (type, regnum, frame);
<a name="l00321"></a>00321   <span class="keywordtype">int</span> <a class="code" href="exec_8h.html#a00f945351279d3c8935f13d2b9f9b808">len</a> = <a class="code" href="gdbtypes_8h.html#aeac33f868e763780094aec8a2dcb9a1a">TYPE_LENGTH</a> (type);
<a name="l00322"></a>00322 
<a name="l00323"></a>00323   <span class="keywordflow">if</span> (regnum &lt; <a class="code" href="spu-tdep_8h.html#ad0163bbd1f46cdbddab0c0871bfa1658">SPU_NUM_GPRS</a> &amp;&amp; len &lt; 16)
<a name="l00324"></a>00324     {
<a name="l00325"></a>00325       <span class="keywordtype">int</span> preferred_slot = len &lt; 4 ? 4 - len : 0;
<a name="l00326"></a>00326       <a class="code" href="value_8c.html#a3d475a6b1e01fde10fa68ed0d666067e">set_value_offset</a> (value, preferred_slot);
<a name="l00327"></a>00327     }
<a name="l00328"></a>00328 
<a name="l00329"></a>00329   <span class="keywordflow">return</span> value;
<a name="l00330"></a>00330 }
<a name="l00331"></a>00331 
<a name="l00332"></a>00332 <span class="comment">/* Register groups.  */</span>
<a name="l00333"></a>00333 
<a name="l00334"></a>00334 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l00335"></a><a class="code" href="spu-tdep_8c.html#af6cab198f4a1060c33d5c2e6d8e8b201">00335</a> <a class="code" href="spu-tdep_8c.html#af6cab198f4a1060c33d5c2e6d8e8b201">spu_register_reggroup_p</a> (<span class="keyword">struct</span> <a class="code" href="structgdbarch.html">gdbarch</a> *<a class="code" href="structgdbarch.html">gdbarch</a>, <span class="keywordtype">int</span> <a class="code" href="aarch64-tdep_8c.html#a6b3d1ad0bca4067ccaef1366bea0db04">regnum</a>,
<a name="l00336"></a>00336                          <span class="keyword">struct</span> <a class="code" href="structreggroup.html">reggroup</a> *group)
<a name="l00337"></a>00337 {
<a name="l00338"></a>00338   <span class="comment">/* Registers displayed via &#39;info regs&#39;.  */</span>
<a name="l00339"></a>00339   <span class="keywordflow">if</span> (group == <a class="code" href="reggroups_8c.html#a2409cc2e19cc71ae02448af0ec0308fd">general_reggroup</a>)
<a name="l00340"></a>00340     <span class="keywordflow">return</span> 1;
<a name="l00341"></a>00341 
<a name="l00342"></a>00342   <span class="comment">/* Registers displayed via &#39;info float&#39;.  */</span>
<a name="l00343"></a>00343   <span class="keywordflow">if</span> (group == <a class="code" href="reggroups_8c.html#ad0b48edad91dabaa07f672908185a7d4">float_reggroup</a>)
<a name="l00344"></a>00344     <span class="keywordflow">return</span> 0;
<a name="l00345"></a>00345 
<a name="l00346"></a>00346   <span class="comment">/* Registers that need to be saved/restored in order to</span>
<a name="l00347"></a>00347 <span class="comment">     push or pop frames.  */</span>
<a name="l00348"></a>00348   <span class="keywordflow">if</span> (group == <a class="code" href="reggroups_8c.html#a9be54927c9d0393a70b8a3f0bc740de3">save_reggroup</a> || group == <a class="code" href="reggroups_8c.html#a627d3b74a917560e7d81d93c472e915c">restore_reggroup</a>)
<a name="l00349"></a>00349     <span class="keywordflow">return</span> 1;
<a name="l00350"></a>00350 
<a name="l00351"></a>00351   <span class="keywordflow">return</span> <a class="code" href="reggroups_8c.html#af8dd83e11930382e46910f10da113e94">default_register_reggroup_p</a> (gdbarch, regnum, group);
<a name="l00352"></a>00352 }
<a name="l00353"></a>00353 
<a name="l00354"></a>00354 
<a name="l00355"></a>00355 <span class="comment">/* Address handling.  */</span>
<a name="l00356"></a>00356 
<a name="l00357"></a>00357 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l00358"></a><a class="code" href="spu-tdep_8c.html#afa215e4ef6d505de7c14504ab2050b5b">00358</a> <a class="code" href="spu-tdep_8c.html#afa215e4ef6d505de7c14504ab2050b5b">spu_gdbarch_id</a> (<span class="keyword">struct</span> <a class="code" href="structgdbarch.html">gdbarch</a> *<a class="code" href="structgdbarch.html">gdbarch</a>)
<a name="l00359"></a>00359 {
<a name="l00360"></a>00360   <span class="keyword">struct </span><a class="code" href="structgdbarch__tdep.html">gdbarch_tdep</a> *tdep = <a class="code" href="gdbarch_8c.html#acea996b7421706849bc20567695b5b31">gdbarch_tdep</a> (gdbarch);
<a name="l00361"></a>00361   <span class="keywordtype">int</span> <span class="keywordtype">id</span> = tdep-&gt;<a class="code" href="structgdbarch__tdep.html#a6c04333e4962a9690dea1334a6201d30">id</a>;
<a name="l00362"></a>00362 
<a name="l00363"></a>00363   <span class="comment">/* The objfile architecture of a standalone SPU executable does not</span>
<a name="l00364"></a>00364 <span class="comment">     provide an SPU ID.  Retrieve it from the objfile&#39;s relocated</span>
<a name="l00365"></a>00365 <span class="comment">     address range in this special case.  */</span>
<a name="l00366"></a>00366   <span class="keywordflow">if</span> (<span class="keywordtype">id</span> == -1
<a name="l00367"></a>00367       &amp;&amp; <a class="code" href="progspace_8h.html#a4e703bd0d59c70e069bed3b4d9e1936b">symfile_objfile</a> &amp;&amp; <a class="code" href="progspace_8h.html#a4e703bd0d59c70e069bed3b4d9e1936b">symfile_objfile</a>-&gt;obfd
<a name="l00368"></a>00368       &amp;&amp; bfd_get_arch (<a class="code" href="progspace_8h.html#a4e703bd0d59c70e069bed3b4d9e1936b">symfile_objfile</a>-&gt;obfd) == bfd_arch_spu
<a name="l00369"></a>00369       &amp;&amp; <a class="code" href="progspace_8h.html#a4e703bd0d59c70e069bed3b4d9e1936b">symfile_objfile</a>-&gt;sections != <a class="code" href="progspace_8h.html#a4e703bd0d59c70e069bed3b4d9e1936b">symfile_objfile</a>-&gt;sections_end)
<a name="l00370"></a>00370     <span class="keywordtype">id</span> = <a class="code" href="spu-tdep_8h.html#afafb4132b7fe5507e3c9ff629b54fcbb">SPUADDR_SPU</a> (<a class="code" href="objfiles_8h.html#add2e3fffc531c5f6789a03324308ccf6">obj_section_addr</a> (<a class="code" href="progspace_8h.html#a4e703bd0d59c70e069bed3b4d9e1936b">symfile_objfile</a>-&gt;sections));
<a name="l00371"></a>00371 
<a name="l00372"></a>00372   <span class="keywordflow">return</span> <a class="code" href="structgdbarch__tdep.html#a6c04333e4962a9690dea1334a6201d30">id</a>;
<a name="l00373"></a>00373 }
<a name="l00374"></a>00374 
<a name="l00375"></a>00375 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l00376"></a><a class="code" href="spu-tdep_8c.html#af2ee8d21ae3390a25bf86ce304a27414">00376</a> <a class="code" href="spu-tdep_8c.html#af2ee8d21ae3390a25bf86ce304a27414">spu_address_class_type_flags</a> (<span class="keywordtype">int</span> byte_size, <span class="keywordtype">int</span> dwarf2_addr_class)
<a name="l00377"></a>00377 {
<a name="l00378"></a>00378   <span class="keywordflow">if</span> (dwarf2_addr_class == 1)
<a name="l00379"></a>00379     <span class="keywordflow">return</span> <a class="code" href="gdbtypes_8h.html#a390c31e15117ac7eda1a5d1341967029ae85ffd953771426c2ad732e51d8d0e84">TYPE_INSTANCE_FLAG_ADDRESS_CLASS_1</a>;
<a name="l00380"></a>00380   <span class="keywordflow">else</span>
<a name="l00381"></a>00381     <span class="keywordflow">return</span> 0;
<a name="l00382"></a>00382 }
<a name="l00383"></a>00383 
<a name="l00384"></a>00384 <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *
<a name="l00385"></a><a class="code" href="spu-tdep_8c.html#a2c775c9bbdc903d75ab54387c6ba2fd7">00385</a> <a class="code" href="spu-tdep_8c.html#a2c775c9bbdc903d75ab54387c6ba2fd7">spu_address_class_type_flags_to_name</a> (<span class="keyword">struct</span> <a class="code" href="structgdbarch.html">gdbarch</a> *<a class="code" href="structgdbarch.html">gdbarch</a>, <span class="keywordtype">int</span> type_flags)
<a name="l00386"></a>00386 {
<a name="l00387"></a>00387   <span class="keywordflow">if</span> (type_flags &amp; <a class="code" href="gdbtypes_8h.html#a390c31e15117ac7eda1a5d1341967029ae85ffd953771426c2ad732e51d8d0e84">TYPE_INSTANCE_FLAG_ADDRESS_CLASS_1</a>)
<a name="l00388"></a>00388     <span class="keywordflow">return</span> <span class="stringliteral">&quot;__ea&quot;</span>;
<a name="l00389"></a>00389   <span class="keywordflow">else</span>
<a name="l00390"></a>00390     <span class="keywordflow">return</span> NULL;
<a name="l00391"></a>00391 }
<a name="l00392"></a>00392 
<a name="l00393"></a>00393 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l00394"></a><a class="code" href="spu-tdep_8c.html#a06e98506018d058814e39ff9e232b741">00394</a> <a class="code" href="spu-tdep_8c.html#a06e98506018d058814e39ff9e232b741">spu_address_class_name_to_type_flags</a> (<span class="keyword">struct</span> <a class="code" href="structgdbarch.html">gdbarch</a> *<a class="code" href="structgdbarch.html">gdbarch</a>,
<a name="l00395"></a>00395                                       <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="aarch64-tdep_8c.html#acc128f98d9ceca227038c771308eff39">name</a>, <span class="keywordtype">int</span> *type_flags_ptr)
<a name="l00396"></a>00396 {
<a name="l00397"></a>00397   <span class="keywordflow">if</span> (strcmp (name, <span class="stringliteral">&quot;__ea&quot;</span>) == 0)
<a name="l00398"></a>00398     {
<a name="l00399"></a>00399       *type_flags_ptr = <a class="code" href="gdbtypes_8h.html#a390c31e15117ac7eda1a5d1341967029ae85ffd953771426c2ad732e51d8d0e84">TYPE_INSTANCE_FLAG_ADDRESS_CLASS_1</a>;
<a name="l00400"></a>00400       <span class="keywordflow">return</span> 1;
<a name="l00401"></a>00401     }
<a name="l00402"></a>00402   <span class="keywordflow">else</span>
<a name="l00403"></a>00403    <span class="keywordflow">return</span> 0;
<a name="l00404"></a>00404 }
<a name="l00405"></a>00405 
<a name="l00406"></a>00406 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00407"></a><a class="code" href="spu-tdep_8c.html#a4dbad6733cd47d047a27d2ca5f03449d">00407</a> <a class="code" href="spu-tdep_8c.html#a4dbad6733cd47d047a27d2ca5f03449d">spu_address_to_pointer</a> (<span class="keyword">struct</span> <a class="code" href="structgdbarch.html">gdbarch</a> *<a class="code" href="structgdbarch.html">gdbarch</a>,
<a name="l00408"></a>00408                         <span class="keyword">struct</span> <a class="code" href="structtype.html">type</a> *<a class="code" href="structtype.html">type</a>, <a class="code" href="defs_8h.html#a336b399b3b83dbcc61f176c33f26b607">gdb_byte</a> *buf, <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> addr)
<a name="l00409"></a>00409 {
<a name="l00410"></a>00410   <span class="keyword">enum</span> bfd_endian byte_order = <a class="code" href="gdbarch_8c.html#abc300a3797421aa7342b288e1637483e">gdbarch_byte_order</a> (gdbarch);
<a name="l00411"></a>00411   <a class="code" href="defs_8h.html#ad11c013c83c64d9d0ee2e4bdeb1fb62d">store_unsigned_integer</a> (buf, <a class="code" href="gdbtypes_8h.html#aeac33f868e763780094aec8a2dcb9a1a">TYPE_LENGTH</a> (type), byte_order,
<a name="l00412"></a>00412                           <a class="code" href="spu-tdep_8h.html#a774f32c94d1e14fd951edbf335cd0c51">SPUADDR_ADDR</a> (addr));
<a name="l00413"></a>00413 }
<a name="l00414"></a>00414 
<a name="l00415"></a>00415 <span class="keyword">static</span> <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a>
<a name="l00416"></a><a class="code" href="spu-tdep_8c.html#a8f8b5b87f57db941738d914ebf000009">00416</a> <a class="code" href="spu-tdep_8c.html#a8f8b5b87f57db941738d914ebf000009">spu_pointer_to_address</a> (<span class="keyword">struct</span> <a class="code" href="structgdbarch.html">gdbarch</a> *<a class="code" href="structgdbarch.html">gdbarch</a>,
<a name="l00417"></a>00417                         <span class="keyword">struct</span> <a class="code" href="structtype.html">type</a> *<a class="code" href="structtype.html">type</a>, <span class="keyword">const</span> <a class="code" href="defs_8h.html#a336b399b3b83dbcc61f176c33f26b607">gdb_byte</a> *buf)
<a name="l00418"></a>00418 {
<a name="l00419"></a>00419   <span class="keywordtype">int</span> <span class="keywordtype">id</span> = <a class="code" href="spu-tdep_8c.html#afa215e4ef6d505de7c14504ab2050b5b">spu_gdbarch_id</a> (gdbarch);
<a name="l00420"></a>00420   <span class="keyword">enum</span> bfd_endian byte_order = <a class="code" href="gdbarch_8c.html#abc300a3797421aa7342b288e1637483e">gdbarch_byte_order</a> (gdbarch);
<a name="l00421"></a>00421   <a class="code" href="defs_8h.html#a4df4af8771b1016a24976757026f4984">ULONGEST</a> addr
<a name="l00422"></a>00422     = <a class="code" href="defs_8h.html#a99aec65329508b4d449a4f881026f844">extract_unsigned_integer</a> (buf, <a class="code" href="gdbtypes_8h.html#aeac33f868e763780094aec8a2dcb9a1a">TYPE_LENGTH</a> (type), byte_order);
<a name="l00423"></a>00423 
<a name="l00424"></a>00424   <span class="comment">/* Do not convert __ea pointers.  */</span>
<a name="l00425"></a>00425   <span class="keywordflow">if</span> (<a class="code" href="gdbtypes_8h.html#a6cf300892a28f0f7657fae944de060ac">TYPE_ADDRESS_CLASS_1</a> (type))
<a name="l00426"></a>00426     <span class="keywordflow">return</span> addr;
<a name="l00427"></a>00427 
<a name="l00428"></a>00428   <span class="keywordflow">return</span> addr? <a class="code" href="spu-tdep_8h.html#a9dd6343d7c2ebf90bf29d78289bdb110">SPUADDR</a> (<span class="keywordtype">id</span>, addr) : 0;
<a name="l00429"></a>00429 }
<a name="l00430"></a>00430 
<a name="l00431"></a>00431 <span class="keyword">static</span> <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a>
<a name="l00432"></a><a class="code" href="spu-tdep_8c.html#aa45cc57405b97309e1ef2d0061090fe1">00432</a> <a class="code" href="spu-tdep_8c.html#aa45cc57405b97309e1ef2d0061090fe1">spu_integer_to_address</a> (<span class="keyword">struct</span> <a class="code" href="structgdbarch.html">gdbarch</a> *<a class="code" href="structgdbarch.html">gdbarch</a>,
<a name="l00433"></a>00433                         <span class="keyword">struct</span> <a class="code" href="structtype.html">type</a> *<a class="code" href="structtype.html">type</a>, <span class="keyword">const</span> <a class="code" href="defs_8h.html#a336b399b3b83dbcc61f176c33f26b607">gdb_byte</a> *buf)
<a name="l00434"></a>00434 {
<a name="l00435"></a>00435   <span class="keywordtype">int</span> <span class="keywordtype">id</span> = <a class="code" href="spu-tdep_8c.html#afa215e4ef6d505de7c14504ab2050b5b">spu_gdbarch_id</a> (gdbarch);
<a name="l00436"></a>00436   <a class="code" href="defs_8h.html#a4df4af8771b1016a24976757026f4984">ULONGEST</a> addr = <a class="code" href="value_8c.html#af8ee32c3e2a2e1cd7cdfe92be37a759f">unpack_long</a> (type, buf);
<a name="l00437"></a>00437 
<a name="l00438"></a>00438   <span class="keywordflow">return</span> <a class="code" href="spu-tdep_8h.html#a9dd6343d7c2ebf90bf29d78289bdb110">SPUADDR</a> (<span class="keywordtype">id</span>, addr);
<a name="l00439"></a>00439 }
<a name="l00440"></a>00440 
<a name="l00441"></a>00441 
<a name="l00442"></a>00442 <span class="comment">/* Decoding SPU instructions.  */</span>
<a name="l00443"></a>00443 
<a name="l00444"></a>00444 <span class="keyword">enum</span>
<a name="l00445"></a>00445   {
<a name="l00446"></a><a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002a247255bf4445a9593f81b04b813592fa">00446</a>     <a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002a247255bf4445a9593f81b04b813592fa">op_lqd</a>   = 0x34,
<a name="l00447"></a><a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002a056300990a16bf695cdd0b39a42e280b">00447</a>     <a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002a056300990a16bf695cdd0b39a42e280b">op_lqx</a>   = 0x3c4,
<a name="l00448"></a><a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002aa692ab4f726ccacd3c76380f9c645203">00448</a>     <a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002aa692ab4f726ccacd3c76380f9c645203">op_lqa</a>   = 0x61,
<a name="l00449"></a><a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002a420b0dcc25274987522e111f578cfacb">00449</a>     <a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002a420b0dcc25274987522e111f578cfacb">op_lqr</a>   = 0x67,
<a name="l00450"></a><a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002ac109fcd6b21957800d88d0e8351829dc">00450</a>     <a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002ac109fcd6b21957800d88d0e8351829dc">op_stqd</a>  = 0x24,
<a name="l00451"></a><a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002a8db0038a67509c3e7a397b3f1bd2f8c4">00451</a>     <a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002a8db0038a67509c3e7a397b3f1bd2f8c4">op_stqx</a>  = 0x144,
<a name="l00452"></a><a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002a778a1ea0078118cb0d3e1c8c92624558">00452</a>     <a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002a778a1ea0078118cb0d3e1c8c92624558">op_stqa</a>  = 0x41,
<a name="l00453"></a><a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002af55e2630f8a59d74a873d945a6d90045">00453</a>     <a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002af55e2630f8a59d74a873d945a6d90045">op_stqr</a>  = 0x47,
<a name="l00454"></a>00454 
<a name="l00455"></a><a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002a63045d8773e8e41e8358d2516f89f115">00455</a>     <a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002a63045d8773e8e41e8358d2516f89f115">op_il</a>    = 0x081,
<a name="l00456"></a><a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002a20197e0e9809651c5ac9dea5d2ca55af">00456</a>     <a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002a20197e0e9809651c5ac9dea5d2ca55af">op_ila</a>   = 0x21,
<a name="l00457"></a><a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002af3134e04b09f15e32c646d70c006ca47">00457</a>     <a class="code" href="s390-tdep_8c.html#ae62fccd8cea8f216b24ba625d404c4aeaf3134e04b09f15e32c646d70c006ca47">op_a</a>     = 0x0c0,
<a name="l00458"></a><a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002a865eade71dadafdce05817fa97f552b5">00458</a>     <a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002a865eade71dadafdce05817fa97f552b5">op_ai</a>    = 0x1c,
<a name="l00459"></a>00459 
<a name="l00460"></a><a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002a3d3b48513b8bcec71cc1425fa93557c5">00460</a>     <a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002a3d3b48513b8bcec71cc1425fa93557c5">op_selb</a>  = 0x8,
<a name="l00461"></a>00461 
<a name="l00462"></a><a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002a10be3dddf1d9d9f2723d1ed715686d49">00462</a>     <a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002a10be3dddf1d9d9f2723d1ed715686d49">op_br</a>    = 0x64,
<a name="l00463"></a><a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002a9d91777fc612492303b72a5177572327">00463</a>     <a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002a9d91777fc612492303b72a5177572327">op_bra</a>   = 0x60,
<a name="l00464"></a><a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002a74ee0148cf754a1a0463b8a0c4504b41">00464</a>     <a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002a74ee0148cf754a1a0463b8a0c4504b41">op_brsl</a>  = 0x66,
<a name="l00465"></a><a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002a8a34a72547a846e5f350992aecbda2cf">00465</a>     <a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002a8a34a72547a846e5f350992aecbda2cf">op_brasl</a> = 0x62,
<a name="l00466"></a><a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002acc49ff19af2149df78e1516163424ec6">00466</a>     <a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002acc49ff19af2149df78e1516163424ec6">op_brnz</a>  = 0x42,
<a name="l00467"></a><a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002a3806d2a01df7b725bf0cfd56c23a79f3">00467</a>     <a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002a3806d2a01df7b725bf0cfd56c23a79f3">op_brz</a>   = 0x40,
<a name="l00468"></a><a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002a6064ea324c1ae5a9d5e22a3a230cb2e1">00468</a>     <a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002a6064ea324c1ae5a9d5e22a3a230cb2e1">op_brhnz</a> = 0x46,
<a name="l00469"></a><a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002a1ed7f7e1bfc32aaaca5a2d67c3e48d90">00469</a>     <a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002a1ed7f7e1bfc32aaaca5a2d67c3e48d90">op_brhz</a>  = 0x44,
<a name="l00470"></a><a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002a1a8a7672da3c491bafae8be6a0843c4c">00470</a>     <a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002a1a8a7672da3c491bafae8be6a0843c4c">op_bi</a>    = 0x1a8,
<a name="l00471"></a><a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002aaa786b2f382930652342fb7e7a22b0c5">00471</a>     <a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002aaa786b2f382930652342fb7e7a22b0c5">op_bisl</a>  = 0x1a9,
<a name="l00472"></a><a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002acea985342372e549161927e74a8b6373">00472</a>     <a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002acea985342372e549161927e74a8b6373">op_biz</a>   = 0x128,
<a name="l00473"></a><a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002ae9b5cff7d05db47eb00133a6b0269b1d">00473</a>     <a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002ae9b5cff7d05db47eb00133a6b0269b1d">op_binz</a>  = 0x129,
<a name="l00474"></a><a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002acdb7e6c7b9e70914f299e52eb10555dc">00474</a>     <a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002acdb7e6c7b9e70914f299e52eb10555dc">op_bihz</a>  = 0x12a,
<a name="l00475"></a><a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002a069237a775795ec7ad77c3de9b2a48ac">00475</a>     <a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002a069237a775795ec7ad77c3de9b2a48ac">op_bihnz</a> = 0x12b,
<a name="l00476"></a>00476   };
<a name="l00477"></a>00477 
<a name="l00478"></a>00478 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l00479"></a><a class="code" href="spu-tdep_8c.html#aa19100c912130f0db3793b039073eba9">00479</a> <a class="code" href="spu-tdep_8c.html#aa19100c912130f0db3793b039073eba9">is_rr</a> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> insn, <span class="keywordtype">int</span> op, <span class="keywordtype">int</span> *rt, <span class="keywordtype">int</span> *ra, <span class="keywordtype">int</span> *rb)
<a name="l00480"></a>00480 {
<a name="l00481"></a>00481   <span class="keywordflow">if</span> ((insn &gt;&gt; 21) == op)
<a name="l00482"></a>00482     {
<a name="l00483"></a>00483       *rt = insn &amp; 127;
<a name="l00484"></a>00484       *ra = (insn &gt;&gt; 7) &amp; 127;
<a name="l00485"></a>00485       *rb = (insn &gt;&gt; 14) &amp; 127;
<a name="l00486"></a>00486       <span class="keywordflow">return</span> 1;
<a name="l00487"></a>00487     }
<a name="l00488"></a>00488 
<a name="l00489"></a>00489   <span class="keywordflow">return</span> 0;
<a name="l00490"></a>00490 }
<a name="l00491"></a>00491 
<a name="l00492"></a>00492 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l00493"></a><a class="code" href="spu-tdep_8c.html#a6e920be30778adce4fa27e3f8b392e02">00493</a> <a class="code" href="spu-tdep_8c.html#a6e920be30778adce4fa27e3f8b392e02">is_rrr</a> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> insn, <span class="keywordtype">int</span> op, <span class="keywordtype">int</span> *rt, <span class="keywordtype">int</span> *ra, <span class="keywordtype">int</span> *rb, <span class="keywordtype">int</span> *rc)
<a name="l00494"></a>00494 {
<a name="l00495"></a>00495   <span class="keywordflow">if</span> ((insn &gt;&gt; 28) == op)
<a name="l00496"></a>00496     {
<a name="l00497"></a>00497       *rt = (insn &gt;&gt; 21) &amp; 127;
<a name="l00498"></a>00498       *ra = (insn &gt;&gt; 7) &amp; 127;
<a name="l00499"></a>00499       *rb = (insn &gt;&gt; 14) &amp; 127;
<a name="l00500"></a>00500       *rc = insn &amp; 127;
<a name="l00501"></a>00501       <span class="keywordflow">return</span> 1;
<a name="l00502"></a>00502     }
<a name="l00503"></a>00503 
<a name="l00504"></a>00504   <span class="keywordflow">return</span> 0;
<a name="l00505"></a>00505 }
<a name="l00506"></a>00506 
<a name="l00507"></a>00507 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l00508"></a><a class="code" href="spu-tdep_8c.html#a2f6903a746369f5d4031abc6b0c26998">00508</a> <a class="code" href="spu-tdep_8c.html#a2f6903a746369f5d4031abc6b0c26998">is_ri7</a> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> insn, <span class="keywordtype">int</span> op, <span class="keywordtype">int</span> *rt, <span class="keywordtype">int</span> *ra, <span class="keywordtype">int</span> *i7)
<a name="l00509"></a>00509 {
<a name="l00510"></a>00510   <span class="keywordflow">if</span> ((insn &gt;&gt; 21) == op)
<a name="l00511"></a>00511     {
<a name="l00512"></a>00512       *rt = insn &amp; 127;
<a name="l00513"></a>00513       *ra = (insn &gt;&gt; 7) &amp; 127;
<a name="l00514"></a>00514       *i7 = (((insn &gt;&gt; 14) &amp; 127) ^ 0x40) - 0x40;
<a name="l00515"></a>00515       <span class="keywordflow">return</span> 1;
<a name="l00516"></a>00516     }
<a name="l00517"></a>00517 
<a name="l00518"></a>00518   <span class="keywordflow">return</span> 0;
<a name="l00519"></a>00519 }
<a name="l00520"></a>00520 
<a name="l00521"></a>00521 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l00522"></a><a class="code" href="spu-tdep_8c.html#a405b7811e361a84412b212bf3405e294">00522</a> <a class="code" href="spu-tdep_8c.html#a405b7811e361a84412b212bf3405e294">is_ri10</a> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> insn, <span class="keywordtype">int</span> op, <span class="keywordtype">int</span> *rt, <span class="keywordtype">int</span> *ra, <span class="keywordtype">int</span> *i10)
<a name="l00523"></a>00523 {
<a name="l00524"></a>00524   <span class="keywordflow">if</span> ((insn &gt;&gt; 24) == op)
<a name="l00525"></a>00525     {
<a name="l00526"></a>00526       *rt = insn &amp; 127;
<a name="l00527"></a>00527       *ra = (insn &gt;&gt; 7) &amp; 127;
<a name="l00528"></a>00528       *i10 = (((insn &gt;&gt; 14) &amp; 0x3ff) ^ 0x200) - 0x200;
<a name="l00529"></a>00529       <span class="keywordflow">return</span> 1;
<a name="l00530"></a>00530     }
<a name="l00531"></a>00531 
<a name="l00532"></a>00532   <span class="keywordflow">return</span> 0;
<a name="l00533"></a>00533 }
<a name="l00534"></a>00534 
<a name="l00535"></a>00535 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l00536"></a><a class="code" href="spu-tdep_8c.html#ac2362e31797fe26cc7fb6cfa791656c0">00536</a> <a class="code" href="spu-tdep_8c.html#ac2362e31797fe26cc7fb6cfa791656c0">is_ri16</a> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> insn, <span class="keywordtype">int</span> op, <span class="keywordtype">int</span> *rt, <span class="keywordtype">int</span> *i16)
<a name="l00537"></a>00537 {
<a name="l00538"></a>00538   <span class="keywordflow">if</span> ((insn &gt;&gt; 23) == op)
<a name="l00539"></a>00539     {
<a name="l00540"></a>00540       *rt = insn &amp; 127;
<a name="l00541"></a>00541       *i16 = (((insn &gt;&gt; 7) &amp; 0xffff) ^ 0x8000) - 0x8000;
<a name="l00542"></a>00542       <span class="keywordflow">return</span> 1;
<a name="l00543"></a>00543     }
<a name="l00544"></a>00544 
<a name="l00545"></a>00545   <span class="keywordflow">return</span> 0;
<a name="l00546"></a>00546 }
<a name="l00547"></a>00547 
<a name="l00548"></a>00548 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l00549"></a><a class="code" href="spu-tdep_8c.html#a3503939dd4a7bc1716cac3c69b881e3e">00549</a> <a class="code" href="spu-tdep_8c.html#a3503939dd4a7bc1716cac3c69b881e3e">is_ri18</a> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> insn, <span class="keywordtype">int</span> op, <span class="keywordtype">int</span> *rt, <span class="keywordtype">int</span> *i18)
<a name="l00550"></a>00550 {
<a name="l00551"></a>00551   <span class="keywordflow">if</span> ((insn &gt;&gt; 25) == op)
<a name="l00552"></a>00552     {
<a name="l00553"></a>00553       *rt = insn &amp; 127;
<a name="l00554"></a>00554       *i18 = (((insn &gt;&gt; 7) &amp; 0x3ffff) ^ 0x20000) - 0x20000;
<a name="l00555"></a>00555       <span class="keywordflow">return</span> 1;
<a name="l00556"></a>00556     }
<a name="l00557"></a>00557 
<a name="l00558"></a>00558   <span class="keywordflow">return</span> 0;
<a name="l00559"></a>00559 }
<a name="l00560"></a>00560 
<a name="l00561"></a>00561 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l00562"></a><a class="code" href="spu-tdep_8c.html#a9a9da19452acd9c01c0d3d98ed971126">00562</a> <a class="code" href="spu-tdep_8c.html#a9a9da19452acd9c01c0d3d98ed971126">is_branch</a> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> insn, <span class="keywordtype">int</span> *<a class="code" href="common_2agent_8c.html#aed7ea92f45bd273dde380a45ddced592">offset</a>, <span class="keywordtype">int</span> *<a class="code" href="structreg.html">reg</a>)
<a name="l00563"></a>00563 {
<a name="l00564"></a>00564   <span class="keywordtype">int</span> rt, i7, i16;
<a name="l00565"></a>00565 
<a name="l00566"></a>00566   <span class="keywordflow">if</span> (<a class="code" href="spu-tdep_8c.html#ac2362e31797fe26cc7fb6cfa791656c0">is_ri16</a> (insn, <a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002a10be3dddf1d9d9f2723d1ed715686d49">op_br</a>, &amp;rt, &amp;i16)
<a name="l00567"></a>00567       || <a class="code" href="spu-tdep_8c.html#ac2362e31797fe26cc7fb6cfa791656c0">is_ri16</a> (insn, <a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002a74ee0148cf754a1a0463b8a0c4504b41">op_brsl</a>, &amp;rt, &amp;i16)
<a name="l00568"></a>00568       || <a class="code" href="spu-tdep_8c.html#ac2362e31797fe26cc7fb6cfa791656c0">is_ri16</a> (insn, <a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002acc49ff19af2149df78e1516163424ec6">op_brnz</a>, &amp;rt, &amp;i16)
<a name="l00569"></a>00569       || <a class="code" href="spu-tdep_8c.html#ac2362e31797fe26cc7fb6cfa791656c0">is_ri16</a> (insn, <a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002a3806d2a01df7b725bf0cfd56c23a79f3">op_brz</a>, &amp;rt, &amp;i16)
<a name="l00570"></a>00570       || <a class="code" href="spu-tdep_8c.html#ac2362e31797fe26cc7fb6cfa791656c0">is_ri16</a> (insn, <a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002a6064ea324c1ae5a9d5e22a3a230cb2e1">op_brhnz</a>, &amp;rt, &amp;i16)
<a name="l00571"></a>00571       || <a class="code" href="spu-tdep_8c.html#ac2362e31797fe26cc7fb6cfa791656c0">is_ri16</a> (insn, <a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002a1ed7f7e1bfc32aaaca5a2d67c3e48d90">op_brhz</a>, &amp;rt, &amp;i16))
<a name="l00572"></a>00572     {
<a name="l00573"></a>00573       *reg = <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4cac5c6ca5984213bd79f0060b49caef630">SPU_PC_REGNUM</a>;
<a name="l00574"></a>00574       *offset = i16 &lt;&lt; 2;
<a name="l00575"></a>00575       <span class="keywordflow">return</span> 1;
<a name="l00576"></a>00576     }
<a name="l00577"></a>00577 
<a name="l00578"></a>00578   <span class="keywordflow">if</span> (<a class="code" href="spu-tdep_8c.html#ac2362e31797fe26cc7fb6cfa791656c0">is_ri16</a> (insn, <a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002a9d91777fc612492303b72a5177572327">op_bra</a>, &amp;rt, &amp;i16)
<a name="l00579"></a>00579       || <a class="code" href="spu-tdep_8c.html#ac2362e31797fe26cc7fb6cfa791656c0">is_ri16</a> (insn, <a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002a8a34a72547a846e5f350992aecbda2cf">op_brasl</a>, &amp;rt, &amp;i16))
<a name="l00580"></a>00580     {
<a name="l00581"></a>00581       *reg = -1;
<a name="l00582"></a>00582       *offset = i16 &lt;&lt; 2;
<a name="l00583"></a>00583       <span class="keywordflow">return</span> 1;
<a name="l00584"></a>00584     }
<a name="l00585"></a>00585 
<a name="l00586"></a>00586   <span class="keywordflow">if</span> (<a class="code" href="spu-tdep_8c.html#a2f6903a746369f5d4031abc6b0c26998">is_ri7</a> (insn, <a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002a1a8a7672da3c491bafae8be6a0843c4c">op_bi</a>, &amp;rt, reg, &amp;i7)
<a name="l00587"></a>00587       || <a class="code" href="spu-tdep_8c.html#a2f6903a746369f5d4031abc6b0c26998">is_ri7</a> (insn, <a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002aaa786b2f382930652342fb7e7a22b0c5">op_bisl</a>, &amp;rt, reg, &amp;i7)
<a name="l00588"></a>00588       || <a class="code" href="spu-tdep_8c.html#a2f6903a746369f5d4031abc6b0c26998">is_ri7</a> (insn, <a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002acea985342372e549161927e74a8b6373">op_biz</a>, &amp;rt, reg, &amp;i7)
<a name="l00589"></a>00589       || <a class="code" href="spu-tdep_8c.html#a2f6903a746369f5d4031abc6b0c26998">is_ri7</a> (insn, <a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002ae9b5cff7d05db47eb00133a6b0269b1d">op_binz</a>, &amp;rt, reg, &amp;i7)
<a name="l00590"></a>00590       || <a class="code" href="spu-tdep_8c.html#a2f6903a746369f5d4031abc6b0c26998">is_ri7</a> (insn, <a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002acdb7e6c7b9e70914f299e52eb10555dc">op_bihz</a>, &amp;rt, reg, &amp;i7)
<a name="l00591"></a>00591       || <a class="code" href="spu-tdep_8c.html#a2f6903a746369f5d4031abc6b0c26998">is_ri7</a> (insn, <a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002a069237a775795ec7ad77c3de9b2a48ac">op_bihnz</a>, &amp;rt, reg, &amp;i7))
<a name="l00592"></a>00592     {
<a name="l00593"></a>00593       *offset = 0;
<a name="l00594"></a>00594       <span class="keywordflow">return</span> 1;
<a name="l00595"></a>00595     }
<a name="l00596"></a>00596 
<a name="l00597"></a>00597   <span class="keywordflow">return</span> 0;
<a name="l00598"></a>00598 }
<a name="l00599"></a>00599 
<a name="l00600"></a>00600 
<a name="l00601"></a>00601 <span class="comment">/* Prolog parsing.  */</span>
<a name="l00602"></a>00602 
<a name="l00603"></a><a class="code" href="structspu__prologue__data.html">00603</a> <span class="keyword">struct </span><a class="code" href="structspu__prologue__data.html">spu_prologue_data</a>
<a name="l00604"></a>00604   {
<a name="l00605"></a>00605     <span class="comment">/* Stack frame size.  -1 if analysis was unsuccessful.  */</span>
<a name="l00606"></a><a class="code" href="structspu__prologue__data.html#a0a9b37fa0ef603a699ebf3c3c4fa58d9">00606</a>     <span class="keywordtype">int</span> <a class="code" href="structspu__prologue__data.html#a0a9b37fa0ef603a699ebf3c3c4fa58d9">size</a>;
<a name="l00607"></a>00607 
<a name="l00608"></a>00608     <span class="comment">/* How to find the CFA.  The CFA is equal to SP at function entry.  */</span>
<a name="l00609"></a><a class="code" href="structspu__prologue__data.html#a0505d23d4283e6d4ea09c76454a16b05">00609</a>     <span class="keywordtype">int</span> <a class="code" href="structspu__prologue__data.html#a0505d23d4283e6d4ea09c76454a16b05">cfa_reg</a>;
<a name="l00610"></a><a class="code" href="structspu__prologue__data.html#a557f142233a45386f736b61edb44c9a9">00610</a>     <span class="keywordtype">int</span> <a class="code" href="structspu__prologue__data.html#a557f142233a45386f736b61edb44c9a9">cfa_offset</a>;
<a name="l00611"></a>00611 
<a name="l00612"></a>00612     <span class="comment">/* Offset relative to CFA where a register is saved.  -1 if invalid.  */</span>
<a name="l00613"></a><a class="code" href="structspu__prologue__data.html#adef2304dc0400cda3f78e1b75a773d97">00613</a>     <span class="keywordtype">int</span> <a class="code" href="structspu__prologue__data.html#adef2304dc0400cda3f78e1b75a773d97">reg_offset</a>[<a class="code" href="spu-tdep_8h.html#ad0163bbd1f46cdbddab0c0871bfa1658">SPU_NUM_GPRS</a>];
<a name="l00614"></a>00614   };
<a name="l00615"></a>00615 
<a name="l00616"></a>00616 <span class="keyword">static</span> <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a>
<a name="l00617"></a><a class="code" href="spu-tdep_8c.html#a9e729da5d4ba91813baab2343ad16541">00617</a> <a class="code" href="spu-tdep_8c.html#a9e729da5d4ba91813baab2343ad16541">spu_analyze_prologue</a> (<span class="keyword">struct</span> <a class="code" href="structgdbarch.html">gdbarch</a> *<a class="code" href="structgdbarch.html">gdbarch</a>,
<a name="l00618"></a>00618                       <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> start_pc, <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> end_pc,
<a name="l00619"></a>00619                       <span class="keyword">struct</span> <a class="code" href="structspu__prologue__data.html">spu_prologue_data</a> *data)
<a name="l00620"></a>00620 {
<a name="l00621"></a>00621   <span class="keyword">enum</span> bfd_endian byte_order = <a class="code" href="gdbarch_8c.html#abc300a3797421aa7342b288e1637483e">gdbarch_byte_order</a> (gdbarch);
<a name="l00622"></a>00622   <span class="keywordtype">int</span> found_sp = 0;
<a name="l00623"></a>00623   <span class="keywordtype">int</span> found_fp = 0;
<a name="l00624"></a>00624   <span class="keywordtype">int</span> found_lr = 0;
<a name="l00625"></a>00625   <span class="keywordtype">int</span> found_bc = 0;
<a name="l00626"></a>00626   <span class="keywordtype">int</span> reg_immed[<a class="code" href="spu-tdep_8h.html#ad0163bbd1f46cdbddab0c0871bfa1658">SPU_NUM_GPRS</a>];
<a name="l00627"></a>00627   <a class="code" href="defs_8h.html#a336b399b3b83dbcc61f176c33f26b607">gdb_byte</a> buf[16];
<a name="l00628"></a>00628   <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> prolog_pc = start_pc;
<a name="l00629"></a>00629   <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> pc;
<a name="l00630"></a>00630   <span class="keywordtype">int</span> i;
<a name="l00631"></a>00631 
<a name="l00632"></a>00632 
<a name="l00633"></a>00633   <span class="comment">/* Initialize DATA to default values.  */</span>
<a name="l00634"></a>00634   data-&gt;<a class="code" href="structspu__prologue__data.html#a0a9b37fa0ef603a699ebf3c3c4fa58d9">size</a> = -1;
<a name="l00635"></a>00635 
<a name="l00636"></a>00636   data-&gt;<a class="code" href="structspu__prologue__data.html#a0505d23d4283e6d4ea09c76454a16b05">cfa_reg</a> = <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4caa2793092717e5a3149a148e738f44a53">SPU_RAW_SP_REGNUM</a>;
<a name="l00637"></a>00637   data-&gt;<a class="code" href="structspu__prologue__data.html#a557f142233a45386f736b61edb44c9a9">cfa_offset</a> = 0;
<a name="l00638"></a>00638 
<a name="l00639"></a>00639   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="spu-tdep_8h.html#ad0163bbd1f46cdbddab0c0871bfa1658">SPU_NUM_GPRS</a>; i++)
<a name="l00640"></a>00640     data-&gt;<a class="code" href="structspu__prologue__data.html#adef2304dc0400cda3f78e1b75a773d97">reg_offset</a>[i] = -1;
<a name="l00641"></a>00641 
<a name="l00642"></a>00642   <span class="comment">/* Set up REG_IMMED array.  This is non-zero for a register if we know its</span>
<a name="l00643"></a>00643 <span class="comment">     preferred slot currently holds this immediate value.  */</span>
<a name="l00644"></a>00644   for (i = 0; i &lt; <a class="code" href="spu-tdep_8h.html#ad0163bbd1f46cdbddab0c0871bfa1658">SPU_NUM_GPRS</a>; i++)
<a name="l00645"></a>00645       reg_immed[i] = 0;
<a name="l00646"></a>00646 
<a name="l00647"></a>00647   <span class="comment">/* Scan instructions until the first branch.</span>
<a name="l00648"></a>00648 <span class="comment"></span>
<a name="l00649"></a>00649 <span class="comment">     The following instructions are important prolog components:</span>
<a name="l00650"></a>00650 <span class="comment"></span>
<a name="l00651"></a>00651 <span class="comment">        - The first instruction to set up the stack pointer.</span>
<a name="l00652"></a>00652 <span class="comment">        - The first instruction to set up the frame pointer.</span>
<a name="l00653"></a>00653 <span class="comment">        - The first instruction to save the link register.</span>
<a name="l00654"></a>00654 <span class="comment">        - The first instruction to save the backchain.</span>
<a name="l00655"></a>00655 <span class="comment"></span>
<a name="l00656"></a>00656 <span class="comment">     We return the instruction after the latest of these four,</span>
<a name="l00657"></a>00657 <span class="comment">     or the incoming PC if none is found.  The first instruction</span>
<a name="l00658"></a>00658 <span class="comment">     to set up the stack pointer also defines the frame size.</span>
<a name="l00659"></a>00659 <span class="comment"></span>
<a name="l00660"></a>00660 <span class="comment">     Note that instructions saving incoming arguments to their stack</span>
<a name="l00661"></a>00661 <span class="comment">     slots are not counted as important, because they are hard to</span>
<a name="l00662"></a>00662 <span class="comment">     identify with certainty.  This should not matter much, because</span>
<a name="l00663"></a>00663 <span class="comment">     arguments are relevant only in code compiled with debug data,</span>
<a name="l00664"></a>00664 <span class="comment">     and in such code the GDB core will advance until the first source</span>
<a name="l00665"></a>00665 <span class="comment">     line anyway, using SAL data.</span>
<a name="l00666"></a>00666 <span class="comment"></span>
<a name="l00667"></a>00667 <span class="comment">     For purposes of stack unwinding, we analyze the following types</span>
<a name="l00668"></a>00668 <span class="comment">     of instructions in addition:</span>
<a name="l00669"></a>00669 <span class="comment"></span>
<a name="l00670"></a>00670 <span class="comment">      - Any instruction adding to the current frame pointer.</span>
<a name="l00671"></a>00671 <span class="comment">      - Any instruction loading an immediate constant into a register.</span>
<a name="l00672"></a>00672 <span class="comment">      - Any instruction storing a register onto the stack.</span>
<a name="l00673"></a>00673 <span class="comment"></span>
<a name="l00674"></a>00674 <span class="comment">     These are used to compute the CFA and REG_OFFSET output.  */</span>
<a name="l00675"></a>00675 
<a name="l00676"></a>00676   <span class="keywordflow">for</span> (pc = start_pc; pc &lt; end_pc; pc += 4)
<a name="l00677"></a>00677     {
<a name="l00678"></a>00678       <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> insn;
<a name="l00679"></a>00679       <span class="keywordtype">int</span> rt, ra, rb, rc, immed;
<a name="l00680"></a>00680 
<a name="l00681"></a>00681       <span class="keywordflow">if</span> (<a class="code" href="target_8c.html#ac579515fbccfb9e6b1a45766a71c1d4f">target_read_memory</a> (pc, buf, 4))
<a name="l00682"></a>00682         <span class="keywordflow">break</span>;
<a name="l00683"></a>00683       insn = <a class="code" href="defs_8h.html#a99aec65329508b4d449a4f881026f844">extract_unsigned_integer</a> (buf, 4, byte_order);
<a name="l00684"></a>00684 
<a name="l00685"></a>00685       <span class="comment">/* AI is the typical instruction to set up a stack frame.</span>
<a name="l00686"></a>00686 <span class="comment">         It is also used to initialize the frame pointer.  */</span>
<a name="l00687"></a>00687       <span class="keywordflow">if</span> (<a class="code" href="spu-tdep_8c.html#a405b7811e361a84412b212bf3405e294">is_ri10</a> (insn, <a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002a865eade71dadafdce05817fa97f552b5">op_ai</a>, &amp;rt, &amp;ra, &amp;immed))
<a name="l00688"></a>00688         {
<a name="l00689"></a>00689           <span class="keywordflow">if</span> (rt == data-&gt;<a class="code" href="structspu__prologue__data.html#a0505d23d4283e6d4ea09c76454a16b05">cfa_reg</a> &amp;&amp; ra == data-&gt;<a class="code" href="structspu__prologue__data.html#a0505d23d4283e6d4ea09c76454a16b05">cfa_reg</a>)
<a name="l00690"></a>00690             data-&gt;<a class="code" href="structspu__prologue__data.html#a557f142233a45386f736b61edb44c9a9">cfa_offset</a> -= immed;
<a name="l00691"></a>00691 
<a name="l00692"></a>00692           <span class="keywordflow">if</span> (rt == <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4caa2793092717e5a3149a148e738f44a53">SPU_RAW_SP_REGNUM</a> &amp;&amp; ra == <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4caa2793092717e5a3149a148e738f44a53">SPU_RAW_SP_REGNUM</a>
<a name="l00693"></a>00693               &amp;&amp; !found_sp)
<a name="l00694"></a>00694             {
<a name="l00695"></a>00695               found_sp = 1;
<a name="l00696"></a>00696               prolog_pc = pc + 4;
<a name="l00697"></a>00697 
<a name="l00698"></a>00698               data-&gt;<a class="code" href="structspu__prologue__data.html#a0a9b37fa0ef603a699ebf3c3c4fa58d9">size</a> = -immed;
<a name="l00699"></a>00699             }
<a name="l00700"></a>00700           <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rt == <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4cae5e64550c303dedbc8d7dd9786cfdec7">SPU_FP_REGNUM</a> &amp;&amp; ra == <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4caa2793092717e5a3149a148e738f44a53">SPU_RAW_SP_REGNUM</a>
<a name="l00701"></a>00701                    &amp;&amp; !found_fp)
<a name="l00702"></a>00702             {
<a name="l00703"></a>00703               found_fp = 1;
<a name="l00704"></a>00704               prolog_pc = pc + 4;
<a name="l00705"></a>00705 
<a name="l00706"></a>00706               data-&gt;<a class="code" href="structspu__prologue__data.html#a0505d23d4283e6d4ea09c76454a16b05">cfa_reg</a> = <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4cae5e64550c303dedbc8d7dd9786cfdec7">SPU_FP_REGNUM</a>;
<a name="l00707"></a>00707               data-&gt;<a class="code" href="structspu__prologue__data.html#a557f142233a45386f736b61edb44c9a9">cfa_offset</a> -= immed;
<a name="l00708"></a>00708             }
<a name="l00709"></a>00709         }
<a name="l00710"></a>00710 
<a name="l00711"></a>00711       <span class="comment">/* A is used to set up stack frames of size &gt;= 512 bytes.</span>
<a name="l00712"></a>00712 <span class="comment">         If we have tracked the contents of the addend register,</span>
<a name="l00713"></a>00713 <span class="comment">         we can handle this as well.  */</span>
<a name="l00714"></a>00714       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="spu-tdep_8c.html#aa19100c912130f0db3793b039073eba9">is_rr</a> (insn, <a class="code" href="s390-tdep_8c.html#ae62fccd8cea8f216b24ba625d404c4aeaf3134e04b09f15e32c646d70c006ca47">op_a</a>, &amp;rt, &amp;ra, &amp;rb))
<a name="l00715"></a>00715         {
<a name="l00716"></a>00716           <span class="keywordflow">if</span> (rt == data-&gt;<a class="code" href="structspu__prologue__data.html#a0505d23d4283e6d4ea09c76454a16b05">cfa_reg</a> &amp;&amp; ra == data-&gt;<a class="code" href="structspu__prologue__data.html#a0505d23d4283e6d4ea09c76454a16b05">cfa_reg</a>)
<a name="l00717"></a>00717             {
<a name="l00718"></a>00718               <span class="keywordflow">if</span> (reg_immed[rb] != 0)
<a name="l00719"></a>00719                 data-&gt;<a class="code" href="structspu__prologue__data.html#a557f142233a45386f736b61edb44c9a9">cfa_offset</a> -= reg_immed[rb];
<a name="l00720"></a>00720               <span class="keywordflow">else</span>
<a name="l00721"></a>00721                 data-&gt;<a class="code" href="structspu__prologue__data.html#a0505d23d4283e6d4ea09c76454a16b05">cfa_reg</a> = -1;  <span class="comment">/* We don&#39;t know the CFA any more.  */</span>
<a name="l00722"></a>00722             }
<a name="l00723"></a>00723 
<a name="l00724"></a>00724           <span class="keywordflow">if</span> (rt == <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4caa2793092717e5a3149a148e738f44a53">SPU_RAW_SP_REGNUM</a> &amp;&amp; ra == <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4caa2793092717e5a3149a148e738f44a53">SPU_RAW_SP_REGNUM</a>
<a name="l00725"></a>00725               &amp;&amp; !found_sp)
<a name="l00726"></a>00726             {
<a name="l00727"></a>00727               found_sp = 1;
<a name="l00728"></a>00728               prolog_pc = pc + 4;
<a name="l00729"></a>00729 
<a name="l00730"></a>00730               <span class="keywordflow">if</span> (reg_immed[rb] != 0)
<a name="l00731"></a>00731                 data-&gt;<a class="code" href="structspu__prologue__data.html#a0a9b37fa0ef603a699ebf3c3c4fa58d9">size</a> = -reg_immed[rb];
<a name="l00732"></a>00732             }
<a name="l00733"></a>00733         }
<a name="l00734"></a>00734 
<a name="l00735"></a>00735       <span class="comment">/* We need to track IL and ILA used to load immediate constants</span>
<a name="l00736"></a>00736 <span class="comment">         in case they are later used as input to an A instruction.  */</span>
<a name="l00737"></a>00737       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="spu-tdep_8c.html#ac2362e31797fe26cc7fb6cfa791656c0">is_ri16</a> (insn, <a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002a63045d8773e8e41e8358d2516f89f115">op_il</a>, &amp;rt, &amp;immed))
<a name="l00738"></a>00738         {
<a name="l00739"></a>00739           reg_immed[rt] = immed;
<a name="l00740"></a>00740 
<a name="l00741"></a>00741           <span class="keywordflow">if</span> (rt == <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4caa2793092717e5a3149a148e738f44a53">SPU_RAW_SP_REGNUM</a> &amp;&amp; !found_sp)
<a name="l00742"></a>00742             found_sp = 1;
<a name="l00743"></a>00743         }
<a name="l00744"></a>00744 
<a name="l00745"></a>00745       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="spu-tdep_8c.html#a3503939dd4a7bc1716cac3c69b881e3e">is_ri18</a> (insn, <a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002a20197e0e9809651c5ac9dea5d2ca55af">op_ila</a>, &amp;rt, &amp;immed))
<a name="l00746"></a>00746         {
<a name="l00747"></a>00747           reg_immed[rt] = immed &amp; 0x3ffff;
<a name="l00748"></a>00748 
<a name="l00749"></a>00749           <span class="keywordflow">if</span> (rt == <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4caa2793092717e5a3149a148e738f44a53">SPU_RAW_SP_REGNUM</a> &amp;&amp; !found_sp)
<a name="l00750"></a>00750             found_sp = 1;
<a name="l00751"></a>00751         }
<a name="l00752"></a>00752 
<a name="l00753"></a>00753       <span class="comment">/* STQD is used to save registers to the stack.  */</span>
<a name="l00754"></a>00754       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="spu-tdep_8c.html#a405b7811e361a84412b212bf3405e294">is_ri10</a> (insn, <a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002ac109fcd6b21957800d88d0e8351829dc">op_stqd</a>, &amp;rt, &amp;ra, &amp;immed))
<a name="l00755"></a>00755         {
<a name="l00756"></a>00756           <span class="keywordflow">if</span> (ra == data-&gt;<a class="code" href="structspu__prologue__data.html#a0505d23d4283e6d4ea09c76454a16b05">cfa_reg</a>)
<a name="l00757"></a>00757             data-&gt;<a class="code" href="structspu__prologue__data.html#adef2304dc0400cda3f78e1b75a773d97">reg_offset</a>[rt] = data-&gt;<a class="code" href="structspu__prologue__data.html#a557f142233a45386f736b61edb44c9a9">cfa_offset</a> - (immed &lt;&lt; 4);
<a name="l00758"></a>00758 
<a name="l00759"></a>00759           <span class="keywordflow">if</span> (ra == data-&gt;<a class="code" href="structspu__prologue__data.html#a0505d23d4283e6d4ea09c76454a16b05">cfa_reg</a> &amp;&amp; rt == <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4ca86906770085d81bb98f13de00851ac1f">SPU_LR_REGNUM</a>
<a name="l00760"></a>00760               &amp;&amp; !found_lr)
<a name="l00761"></a>00761             {
<a name="l00762"></a>00762               found_lr = 1;
<a name="l00763"></a>00763               prolog_pc = pc + 4;
<a name="l00764"></a>00764             }
<a name="l00765"></a>00765 
<a name="l00766"></a>00766           <span class="keywordflow">if</span> (ra == <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4caa2793092717e5a3149a148e738f44a53">SPU_RAW_SP_REGNUM</a>
<a name="l00767"></a>00767               &amp;&amp; (found_sp? immed == 0 : rt == <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4caa2793092717e5a3149a148e738f44a53">SPU_RAW_SP_REGNUM</a>)
<a name="l00768"></a>00768               &amp;&amp; !found_bc)
<a name="l00769"></a>00769             {
<a name="l00770"></a>00770               found_bc = 1;
<a name="l00771"></a>00771               prolog_pc = pc + 4;
<a name="l00772"></a>00772             }
<a name="l00773"></a>00773         }
<a name="l00774"></a>00774 
<a name="l00775"></a>00775       <span class="comment">/* _start uses SELB to set up the stack pointer.  */</span>
<a name="l00776"></a>00776       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="spu-tdep_8c.html#a6e920be30778adce4fa27e3f8b392e02">is_rrr</a> (insn, <a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002a3d3b48513b8bcec71cc1425fa93557c5">op_selb</a>, &amp;rt, &amp;ra, &amp;rb, &amp;rc))
<a name="l00777"></a>00777         {
<a name="l00778"></a>00778           <span class="keywordflow">if</span> (rt == <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4caa2793092717e5a3149a148e738f44a53">SPU_RAW_SP_REGNUM</a> &amp;&amp; !found_sp)
<a name="l00779"></a>00779             found_sp = 1;
<a name="l00780"></a>00780         }
<a name="l00781"></a>00781 
<a name="l00782"></a>00782       <span class="comment">/* We terminate if we find a branch.  */</span>
<a name="l00783"></a>00783       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="spu-tdep_8c.html#a9a9da19452acd9c01c0d3d98ed971126">is_branch</a> (insn, &amp;immed, &amp;ra))
<a name="l00784"></a>00784         <span class="keywordflow">break</span>;
<a name="l00785"></a>00785     }
<a name="l00786"></a>00786 
<a name="l00787"></a>00787 
<a name="l00788"></a>00788   <span class="comment">/* If we successfully parsed until here, and didn&#39;t find any instruction</span>
<a name="l00789"></a>00789 <span class="comment">     modifying SP, we assume we have a frameless function.  */</span>
<a name="l00790"></a>00790   <span class="keywordflow">if</span> (!found_sp)
<a name="l00791"></a>00791     data-&gt;<a class="code" href="structspu__prologue__data.html#a0a9b37fa0ef603a699ebf3c3c4fa58d9">size</a> = 0;
<a name="l00792"></a>00792 
<a name="l00793"></a>00793   <span class="comment">/* Return cooked instead of raw SP.  */</span>
<a name="l00794"></a>00794   <span class="keywordflow">if</span> (data-&gt;<a class="code" href="structspu__prologue__data.html#a0505d23d4283e6d4ea09c76454a16b05">cfa_reg</a> == <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4caa2793092717e5a3149a148e738f44a53">SPU_RAW_SP_REGNUM</a>)
<a name="l00795"></a>00795     data-&gt;<a class="code" href="structspu__prologue__data.html#a0505d23d4283e6d4ea09c76454a16b05">cfa_reg</a> = <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4ca4d2edf1cf9cd8c1c52cde68536a2c45d">SPU_SP_REGNUM</a>;
<a name="l00796"></a>00796 
<a name="l00797"></a>00797   <span class="keywordflow">return</span> prolog_pc;
<a name="l00798"></a>00798 }
<a name="l00799"></a>00799 
<a name="l00800"></a>00800 <span class="comment">/* Return the first instruction after the prologue starting at PC.  */</span>
<a name="l00801"></a>00801 <span class="keyword">static</span> <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a>
<a name="l00802"></a><a class="code" href="spu-tdep_8c.html#a898464df5dd4ab9698763a25395d4fd2">00802</a> <a class="code" href="spu-tdep_8c.html#a898464df5dd4ab9698763a25395d4fd2">spu_skip_prologue</a> (<span class="keyword">struct</span> <a class="code" href="structgdbarch.html">gdbarch</a> *<a class="code" href="structgdbarch.html">gdbarch</a>, <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> pc)
<a name="l00803"></a>00803 {
<a name="l00804"></a>00804   <span class="keyword">struct </span><a class="code" href="structspu__prologue__data.html">spu_prologue_data</a> data;
<a name="l00805"></a>00805   <span class="keywordflow">return</span> <a class="code" href="spu-tdep_8c.html#a9e729da5d4ba91813baab2343ad16541">spu_analyze_prologue</a> (gdbarch, pc, (<a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a>)-1, &amp;data);
<a name="l00806"></a>00806 }
<a name="l00807"></a>00807 
<a name="l00808"></a>00808 <span class="comment">/* Return the frame pointer in use at address PC.  */</span>
<a name="l00809"></a>00809 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00810"></a><a class="code" href="spu-tdep_8c.html#ada1c158ebf5147954ddf38c28d49d079">00810</a> <a class="code" href="spu-tdep_8c.html#ada1c158ebf5147954ddf38c28d49d079">spu_virtual_frame_pointer</a> (<span class="keyword">struct</span> <a class="code" href="structgdbarch.html">gdbarch</a> *<a class="code" href="structgdbarch.html">gdbarch</a>, <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> pc,
<a name="l00811"></a>00811                            <span class="keywordtype">int</span> *<a class="code" href="structreg.html">reg</a>, <a class="code" href="defs_8h.html#ac7647a3f71533007c9e128f3ddda1987">LONGEST</a> *<a class="code" href="common_2agent_8c.html#aed7ea92f45bd273dde380a45ddced592">offset</a>)
<a name="l00812"></a>00812 {
<a name="l00813"></a>00813   <span class="keyword">struct </span><a class="code" href="structspu__prologue__data.html">spu_prologue_data</a> data;
<a name="l00814"></a>00814   <a class="code" href="spu-tdep_8c.html#a9e729da5d4ba91813baab2343ad16541">spu_analyze_prologue</a> (gdbarch, pc, (<a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a>)-1, &amp;data);
<a name="l00815"></a>00815 
<a name="l00816"></a>00816   <span class="keywordflow">if</span> (data.<a class="code" href="structspu__prologue__data.html#a0a9b37fa0ef603a699ebf3c3c4fa58d9">size</a> != -1 &amp;&amp; data.<a class="code" href="structspu__prologue__data.html#a0505d23d4283e6d4ea09c76454a16b05">cfa_reg</a> != -1)
<a name="l00817"></a>00817     {
<a name="l00818"></a>00818       <span class="comment">/* The &#39;frame pointer&#39; address is CFA minus frame size.  */</span>
<a name="l00819"></a>00819       *reg = data.<a class="code" href="structspu__prologue__data.html#a0505d23d4283e6d4ea09c76454a16b05">cfa_reg</a>;
<a name="l00820"></a>00820       *offset = data.<a class="code" href="structspu__prologue__data.html#a557f142233a45386f736b61edb44c9a9">cfa_offset</a> - data.<a class="code" href="structspu__prologue__data.html#a0a9b37fa0ef603a699ebf3c3c4fa58d9">size</a>;
<a name="l00821"></a>00821     }
<a name="l00822"></a>00822   <span class="keywordflow">else</span>
<a name="l00823"></a>00823     {
<a name="l00824"></a>00824       <span class="comment">/* ??? We don&#39;t really know ...  */</span>
<a name="l00825"></a>00825       *reg = <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4ca4d2edf1cf9cd8c1c52cde68536a2c45d">SPU_SP_REGNUM</a>;
<a name="l00826"></a>00826       *offset = 0;
<a name="l00827"></a>00827     }
<a name="l00828"></a>00828 }
<a name="l00829"></a>00829 
<a name="l00830"></a>00830 <span class="comment">/* Return true if we are in the function&#39;s epilogue, i.e. after the</span>
<a name="l00831"></a>00831 <span class="comment">   instruction that destroyed the function&#39;s stack frame.</span>
<a name="l00832"></a>00832 <span class="comment"></span>
<a name="l00833"></a>00833 <span class="comment">   1) scan forward from the point of execution:</span>
<a name="l00834"></a>00834 <span class="comment">       a) If you find an instruction that modifies the stack pointer</span>
<a name="l00835"></a>00835 <span class="comment">          or transfers control (except a return), execution is not in</span>
<a name="l00836"></a>00836 <span class="comment">          an epilogue, return.</span>
<a name="l00837"></a>00837 <span class="comment">       b) Stop scanning if you find a return instruction or reach the</span>
<a name="l00838"></a>00838 <span class="comment">          end of the function or reach the hard limit for the size of</span>
<a name="l00839"></a>00839 <span class="comment">          an epilogue.</span>
<a name="l00840"></a>00840 <span class="comment">   2) scan backward from the point of execution:</span>
<a name="l00841"></a>00841 <span class="comment">        a) If you find an instruction that modifies the stack pointer,</span>
<a name="l00842"></a>00842 <span class="comment">            execution *is* in an epilogue, return.</span>
<a name="l00843"></a>00843 <span class="comment">        b) Stop scanning if you reach an instruction that transfers</span>
<a name="l00844"></a>00844 <span class="comment">           control or the beginning of the function or reach the hard</span>
<a name="l00845"></a>00845 <span class="comment">           limit for the size of an epilogue.  */</span>
<a name="l00846"></a>00846 
<a name="l00847"></a>00847 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l00848"></a><a class="code" href="spu-tdep_8c.html#a2f027eeca7e79f8c6781d09650ded7b5">00848</a> <a class="code" href="spu-tdep_8c.html#a2f027eeca7e79f8c6781d09650ded7b5">spu_in_function_epilogue_p</a> (<span class="keyword">struct</span> <a class="code" href="structgdbarch.html">gdbarch</a> *<a class="code" href="structgdbarch.html">gdbarch</a>, <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> pc)
<a name="l00849"></a>00849 {
<a name="l00850"></a>00850   <span class="keyword">enum</span> bfd_endian byte_order = <a class="code" href="gdbarch_8c.html#abc300a3797421aa7342b288e1637483e">gdbarch_byte_order</a> (gdbarch);
<a name="l00851"></a>00851   <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> scan_pc, func_start, func_end, epilogue_start, epilogue_end;
<a name="l00852"></a>00852   bfd_byte buf[4];
<a name="l00853"></a>00853   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> insn;
<a name="l00854"></a>00854   <span class="keywordtype">int</span> rt, ra, rb, immed;
<a name="l00855"></a>00855 
<a name="l00856"></a>00856   <span class="comment">/* Find the search limits based on function boundaries and hard limit.</span>
<a name="l00857"></a>00857 <span class="comment">     We assume the epilogue can be up to 64 instructions long.  */</span>
<a name="l00858"></a>00858 
<a name="l00859"></a>00859   <span class="keyword">const</span> <span class="keywordtype">int</span> spu_max_epilogue_size = 64 * 4;
<a name="l00860"></a>00860 
<a name="l00861"></a>00861   <span class="keywordflow">if</span> (!<a class="code" href="blockframe_8c.html#a2dae2257ad1417604d2c26f8b9071ca9">find_pc_partial_function</a> (pc, NULL, &amp;func_start, &amp;func_end))
<a name="l00862"></a>00862     <span class="keywordflow">return</span> 0;
<a name="l00863"></a>00863 
<a name="l00864"></a>00864   <span class="keywordflow">if</span> (pc - func_start &lt; spu_max_epilogue_size)
<a name="l00865"></a>00865     epilogue_start = func_start;
<a name="l00866"></a>00866   <span class="keywordflow">else</span>
<a name="l00867"></a>00867     epilogue_start = pc - spu_max_epilogue_size;
<a name="l00868"></a>00868 
<a name="l00869"></a>00869   <span class="keywordflow">if</span> (func_end - pc &lt; spu_max_epilogue_size)
<a name="l00870"></a>00870     epilogue_end = func_end;
<a name="l00871"></a>00871   <span class="keywordflow">else</span>
<a name="l00872"></a>00872     epilogue_end = pc + spu_max_epilogue_size;
<a name="l00873"></a>00873 
<a name="l00874"></a>00874   <span class="comment">/* Scan forward until next &#39;bi $0&#39;.  */</span>
<a name="l00875"></a>00875 
<a name="l00876"></a>00876   <span class="keywordflow">for</span> (scan_pc = pc; scan_pc &lt; epilogue_end; scan_pc += 4)
<a name="l00877"></a>00877     {
<a name="l00878"></a>00878       <span class="keywordflow">if</span> (<a class="code" href="target_8c.html#ac579515fbccfb9e6b1a45766a71c1d4f">target_read_memory</a> (scan_pc, buf, 4))
<a name="l00879"></a>00879         <span class="keywordflow">return</span> 0;
<a name="l00880"></a>00880       insn = <a class="code" href="defs_8h.html#a99aec65329508b4d449a4f881026f844">extract_unsigned_integer</a> (buf, 4, byte_order);
<a name="l00881"></a>00881 
<a name="l00882"></a>00882       <span class="keywordflow">if</span> (<a class="code" href="spu-tdep_8c.html#a9a9da19452acd9c01c0d3d98ed971126">is_branch</a> (insn, &amp;immed, &amp;ra))
<a name="l00883"></a>00883         {
<a name="l00884"></a>00884           <span class="keywordflow">if</span> (immed == 0 &amp;&amp; ra == <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4ca86906770085d81bb98f13de00851ac1f">SPU_LR_REGNUM</a>)
<a name="l00885"></a>00885             <span class="keywordflow">break</span>;
<a name="l00886"></a>00886 
<a name="l00887"></a>00887           <span class="keywordflow">return</span> 0;
<a name="l00888"></a>00888         }
<a name="l00889"></a>00889 
<a name="l00890"></a>00890       <span class="keywordflow">if</span> (<a class="code" href="spu-tdep_8c.html#a405b7811e361a84412b212bf3405e294">is_ri10</a> (insn, <a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002a865eade71dadafdce05817fa97f552b5">op_ai</a>, &amp;rt, &amp;ra, &amp;immed)
<a name="l00891"></a>00891           || <a class="code" href="spu-tdep_8c.html#aa19100c912130f0db3793b039073eba9">is_rr</a> (insn, <a class="code" href="s390-tdep_8c.html#ae62fccd8cea8f216b24ba625d404c4aeaf3134e04b09f15e32c646d70c006ca47">op_a</a>, &amp;rt, &amp;ra, &amp;rb)
<a name="l00892"></a>00892           || <a class="code" href="spu-tdep_8c.html#a405b7811e361a84412b212bf3405e294">is_ri10</a> (insn, <a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002a247255bf4445a9593f81b04b813592fa">op_lqd</a>, &amp;rt, &amp;ra, &amp;immed))
<a name="l00893"></a>00893         {
<a name="l00894"></a>00894           <span class="keywordflow">if</span> (rt == <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4caa2793092717e5a3149a148e738f44a53">SPU_RAW_SP_REGNUM</a>)
<a name="l00895"></a>00895             <span class="keywordflow">return</span> 0;
<a name="l00896"></a>00896         }
<a name="l00897"></a>00897     }
<a name="l00898"></a>00898 
<a name="l00899"></a>00899   <span class="keywordflow">if</span> (scan_pc &gt;= epilogue_end)
<a name="l00900"></a>00900     <span class="keywordflow">return</span> 0;
<a name="l00901"></a>00901 
<a name="l00902"></a>00902   <span class="comment">/* Scan backward until adjustment to stack pointer (R1).  */</span>
<a name="l00903"></a>00903 
<a name="l00904"></a>00904   <span class="keywordflow">for</span> (scan_pc = pc - 4; scan_pc &gt;= epilogue_start; scan_pc -= 4)
<a name="l00905"></a>00905     {
<a name="l00906"></a>00906       <span class="keywordflow">if</span> (<a class="code" href="target_8c.html#ac579515fbccfb9e6b1a45766a71c1d4f">target_read_memory</a> (scan_pc, buf, 4))
<a name="l00907"></a>00907         <span class="keywordflow">return</span> 0;
<a name="l00908"></a>00908       insn = <a class="code" href="defs_8h.html#a99aec65329508b4d449a4f881026f844">extract_unsigned_integer</a> (buf, 4, byte_order);
<a name="l00909"></a>00909 
<a name="l00910"></a>00910       <span class="keywordflow">if</span> (<a class="code" href="spu-tdep_8c.html#a9a9da19452acd9c01c0d3d98ed971126">is_branch</a> (insn, &amp;immed, &amp;ra))
<a name="l00911"></a>00911         <span class="keywordflow">return</span> 0;
<a name="l00912"></a>00912 
<a name="l00913"></a>00913       <span class="keywordflow">if</span> (<a class="code" href="spu-tdep_8c.html#a405b7811e361a84412b212bf3405e294">is_ri10</a> (insn, <a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002a865eade71dadafdce05817fa97f552b5">op_ai</a>, &amp;rt, &amp;ra, &amp;immed)
<a name="l00914"></a>00914           || <a class="code" href="spu-tdep_8c.html#aa19100c912130f0db3793b039073eba9">is_rr</a> (insn, <a class="code" href="s390-tdep_8c.html#ae62fccd8cea8f216b24ba625d404c4aeaf3134e04b09f15e32c646d70c006ca47">op_a</a>, &amp;rt, &amp;ra, &amp;rb)
<a name="l00915"></a>00915           || <a class="code" href="spu-tdep_8c.html#a405b7811e361a84412b212bf3405e294">is_ri10</a> (insn, <a class="code" href="spu-tdep_8c.html#a7ada2556f3c386db5f31969fb6d4d002a247255bf4445a9593f81b04b813592fa">op_lqd</a>, &amp;rt, &amp;ra, &amp;immed))
<a name="l00916"></a>00916         {
<a name="l00917"></a>00917           <span class="keywordflow">if</span> (rt == <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4caa2793092717e5a3149a148e738f44a53">SPU_RAW_SP_REGNUM</a>)
<a name="l00918"></a>00918             <span class="keywordflow">return</span> 1;
<a name="l00919"></a>00919         }
<a name="l00920"></a>00920     }
<a name="l00921"></a>00921 
<a name="l00922"></a>00922   <span class="keywordflow">return</span> 0;
<a name="l00923"></a>00923 }
<a name="l00924"></a>00924 
<a name="l00925"></a>00925 
<a name="l00926"></a>00926 <span class="comment">/* Normal stack frames.  */</span>
<a name="l00927"></a>00927 
<a name="l00928"></a><a class="code" href="structspu__unwind__cache.html">00928</a> <span class="keyword">struct </span><a class="code" href="structspu__unwind__cache.html">spu_unwind_cache</a>
<a name="l00929"></a>00929 {
<a name="l00930"></a><a class="code" href="structspu__unwind__cache.html#ad290c9fe8f35e562922e32a7291f8313">00930</a>   <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> <a class="code" href="structspu__unwind__cache.html#ad290c9fe8f35e562922e32a7291f8313">func</a>;
<a name="l00931"></a><a class="code" href="structspu__unwind__cache.html#a19138a4e2cb1663d999d3df8a4cf9981">00931</a>   <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> <a class="code" href="structspu__unwind__cache.html#a19138a4e2cb1663d999d3df8a4cf9981">frame_base</a>;
<a name="l00932"></a><a class="code" href="structspu__unwind__cache.html#a4dc689058b68c48e6f4da13cc4a8019d">00932</a>   <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> <a class="code" href="structspu__unwind__cache.html#a4dc689058b68c48e6f4da13cc4a8019d">local_base</a>;
<a name="l00933"></a>00933 
<a name="l00934"></a><a class="code" href="structspu__unwind__cache.html#a9b9d41c7cb1ee2cfc6ee355738cb2094">00934</a>   <span class="keyword">struct </span><a class="code" href="structtrad__frame__saved__reg.html">trad_frame_saved_reg</a> *<a class="code" href="structspu__unwind__cache.html#a9b9d41c7cb1ee2cfc6ee355738cb2094">saved_regs</a>;
<a name="l00935"></a>00935 };
<a name="l00936"></a>00936 
<a name="l00937"></a>00937 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structspu__unwind__cache.html">spu_unwind_cache</a> *
<a name="l00938"></a><a class="code" href="spu-tdep_8c.html#a211b8bec3727f9303466c519a9bb1ac4">00938</a> <a class="code" href="spu-tdep_8c.html#a211b8bec3727f9303466c519a9bb1ac4">spu_frame_unwind_cache</a> (<span class="keyword">struct</span> <a class="code" href="structframe__info.html">frame_info</a> *this_frame,
<a name="l00939"></a>00939                         <span class="keywordtype">void</span> **this_prologue_cache)
<a name="l00940"></a>00940 {
<a name="l00941"></a>00941   <span class="keyword">struct </span><a class="code" href="structgdbarch.html">gdbarch</a> *<a class="code" href="structgdbarch.html">gdbarch</a> = <a class="code" href="frame_8c.html#ab44507b5655da44e522ed5857835ede7">get_frame_arch</a> (this_frame);
<a name="l00942"></a>00942   <span class="keyword">struct </span><a class="code" href="structgdbarch__tdep.html">gdbarch_tdep</a> *tdep = <a class="code" href="gdbarch_8c.html#acea996b7421706849bc20567695b5b31">gdbarch_tdep</a> (gdbarch);
<a name="l00943"></a>00943   <span class="keyword">enum</span> bfd_endian byte_order = <a class="code" href="gdbarch_8c.html#abc300a3797421aa7342b288e1637483e">gdbarch_byte_order</a> (gdbarch);
<a name="l00944"></a>00944   <span class="keyword">struct </span><a class="code" href="structspu__unwind__cache.html">spu_unwind_cache</a> *info;
<a name="l00945"></a>00945   <span class="keyword">struct </span><a class="code" href="structspu__prologue__data.html">spu_prologue_data</a> data;
<a name="l00946"></a>00946   <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> <span class="keywordtype">id</span> = tdep-&gt;<a class="code" href="structgdbarch__tdep.html#a6c04333e4962a9690dea1334a6201d30">id</a>;
<a name="l00947"></a>00947   <a class="code" href="defs_8h.html#a336b399b3b83dbcc61f176c33f26b607">gdb_byte</a> buf[16];
<a name="l00948"></a>00948 
<a name="l00949"></a>00949   <span class="keywordflow">if</span> (*this_prologue_cache)
<a name="l00950"></a>00950     <span class="keywordflow">return</span> *this_prologue_cache;
<a name="l00951"></a>00951 
<a name="l00952"></a>00952   info = <a class="code" href="frame_8h.html#af9f5c3008a0d58374aa310c5c63af552">FRAME_OBSTACK_ZALLOC</a> (<span class="keyword">struct</span> <a class="code" href="structspu__unwind__cache.html">spu_unwind_cache</a>);
<a name="l00953"></a>00953   *this_prologue_cache = info;
<a name="l00954"></a>00954   info-&gt;<a class="code" href="structspu__unwind__cache.html#a9b9d41c7cb1ee2cfc6ee355738cb2094">saved_regs</a> = <a class="code" href="trad-frame_8c.html#a6b21318e80642c2b5e38b983f27cecec">trad_frame_alloc_saved_regs</a> (this_frame);
<a name="l00955"></a>00955   info-&gt;<a class="code" href="structspu__unwind__cache.html#a19138a4e2cb1663d999d3df8a4cf9981">frame_base</a> = 0;
<a name="l00956"></a>00956   info-&gt;<a class="code" href="structspu__unwind__cache.html#a4dc689058b68c48e6f4da13cc4a8019d">local_base</a> = 0;
<a name="l00957"></a>00957 
<a name="l00958"></a>00958   <span class="comment">/* Find the start of the current function, and analyze its prologue.  */</span>
<a name="l00959"></a>00959   info-&gt;<a class="code" href="structspu__unwind__cache.html#ad290c9fe8f35e562922e32a7291f8313">func</a> = <a class="code" href="frame_8c.html#ac64c0ce600cc134b2256c0d507f57cde">get_frame_func</a> (this_frame);
<a name="l00960"></a>00960   <span class="keywordflow">if</span> (info-&gt;<a class="code" href="structspu__unwind__cache.html#ad290c9fe8f35e562922e32a7291f8313">func</a> == 0)
<a name="l00961"></a>00961     {
<a name="l00962"></a>00962       <span class="comment">/* Fall back to using the current PC as frame ID.  */</span>
<a name="l00963"></a>00963       info-&gt;<a class="code" href="structspu__unwind__cache.html#ad290c9fe8f35e562922e32a7291f8313">func</a> = <a class="code" href="frame_8c.html#a27aafb00e05cba145dfba0e4bc7b1d70">get_frame_pc</a> (this_frame);
<a name="l00964"></a>00964       data.<a class="code" href="structspu__prologue__data.html#a0a9b37fa0ef603a699ebf3c3c4fa58d9">size</a> = -1;
<a name="l00965"></a>00965     }
<a name="l00966"></a>00966   <span class="keywordflow">else</span>
<a name="l00967"></a>00967     <a class="code" href="spu-tdep_8c.html#a9e729da5d4ba91813baab2343ad16541">spu_analyze_prologue</a> (gdbarch, info-&gt;<a class="code" href="structspu__unwind__cache.html#ad290c9fe8f35e562922e32a7291f8313">func</a>, <a class="code" href="frame_8c.html#a27aafb00e05cba145dfba0e4bc7b1d70">get_frame_pc</a> (this_frame),
<a name="l00968"></a>00968                           &amp;data);
<a name="l00969"></a>00969 
<a name="l00970"></a>00970   <span class="comment">/* If successful, use prologue analysis data.  */</span>
<a name="l00971"></a>00971   <span class="keywordflow">if</span> (data.<a class="code" href="structspu__prologue__data.html#a0a9b37fa0ef603a699ebf3c3c4fa58d9">size</a> != -1 &amp;&amp; data.<a class="code" href="structspu__prologue__data.html#a0505d23d4283e6d4ea09c76454a16b05">cfa_reg</a> != -1)
<a name="l00972"></a>00972     {
<a name="l00973"></a>00973       <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> cfa;
<a name="l00974"></a>00974       <span class="keywordtype">int</span> i;
<a name="l00975"></a>00975 
<a name="l00976"></a>00976       <span class="comment">/* Determine CFA via unwound CFA_REG plus CFA_OFFSET.  */</span>
<a name="l00977"></a>00977       <a class="code" href="frame_8c.html#ae0e45fe018a867aabc8d9a217575c42f">get_frame_register</a> (this_frame, data.<a class="code" href="structspu__prologue__data.html#a0505d23d4283e6d4ea09c76454a16b05">cfa_reg</a>, buf);
<a name="l00978"></a>00978       cfa = <a class="code" href="defs_8h.html#a99aec65329508b4d449a4f881026f844">extract_unsigned_integer</a> (buf, 4, byte_order) + data.<a class="code" href="structspu__prologue__data.html#a557f142233a45386f736b61edb44c9a9">cfa_offset</a>;
<a name="l00979"></a>00979       cfa = <a class="code" href="spu-tdep_8h.html#a9dd6343d7c2ebf90bf29d78289bdb110">SPUADDR</a> (<span class="keywordtype">id</span>, cfa);
<a name="l00980"></a>00980 
<a name="l00981"></a>00981       <span class="comment">/* Call-saved register slots.  */</span>
<a name="l00982"></a>00982       <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="spu-tdep_8h.html#ad0163bbd1f46cdbddab0c0871bfa1658">SPU_NUM_GPRS</a>; i++)
<a name="l00983"></a>00983         <span class="keywordflow">if</span> (i == <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4ca86906770085d81bb98f13de00851ac1f">SPU_LR_REGNUM</a>
<a name="l00984"></a>00984             || (i &gt;= <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4ca1a7a2c0f74f3f1e5f190e982429e2d4f">SPU_SAVED1_REGNUM</a> &amp;&amp; i &lt;= <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4caac69d380e6530e33c9ef702c56160019">SPU_SAVEDN_REGNUM</a>))
<a name="l00985"></a>00985           <span class="keywordflow">if</span> (data.<a class="code" href="structspu__prologue__data.html#adef2304dc0400cda3f78e1b75a773d97">reg_offset</a>[i] != -1)
<a name="l00986"></a>00986             info-&gt;<a class="code" href="structspu__unwind__cache.html#a9b9d41c7cb1ee2cfc6ee355738cb2094">saved_regs</a>[i].<a class="code" href="structtrad__frame__saved__reg.html#a61ae37bca806acd4b239bf27cbed527a">addr</a> = cfa - data.<a class="code" href="structspu__prologue__data.html#adef2304dc0400cda3f78e1b75a773d97">reg_offset</a>[i];
<a name="l00987"></a>00987 
<a name="l00988"></a>00988       <span class="comment">/* Frame bases.  */</span>
<a name="l00989"></a>00989       info-&gt;<a class="code" href="structspu__unwind__cache.html#a19138a4e2cb1663d999d3df8a4cf9981">frame_base</a> = cfa;
<a name="l00990"></a>00990       info-&gt;<a class="code" href="structspu__unwind__cache.html#a4dc689058b68c48e6f4da13cc4a8019d">local_base</a> = cfa - data.<a class="code" href="structspu__prologue__data.html#a0a9b37fa0ef603a699ebf3c3c4fa58d9">size</a>;
<a name="l00991"></a>00991     }
<a name="l00992"></a>00992 
<a name="l00993"></a>00993   <span class="comment">/* Otherwise, fall back to reading the backchain link.  */</span>
<a name="l00994"></a>00994   <span class="keywordflow">else</span>
<a name="l00995"></a>00995     {
<a name="l00996"></a>00996       <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> <a class="code" href="structreg.html">reg</a>;
<a name="l00997"></a>00997       <a class="code" href="defs_8h.html#ac7647a3f71533007c9e128f3ddda1987">LONGEST</a> backchain;
<a name="l00998"></a>00998       <a class="code" href="defs_8h.html#a4df4af8771b1016a24976757026f4984">ULONGEST</a> lslr;
<a name="l00999"></a>00999       <span class="keywordtype">int</span> <a class="code" href="namespaceexsummary.html#aa4a2eed06e51a1f73ff9053ec9f2591e">status</a>;
<a name="l01000"></a>01000 
<a name="l01001"></a>01001       <span class="comment">/* Get local store limit.  */</span>
<a name="l01002"></a>01002       lslr = <a class="code" href="frame_8c.html#affa785e8937e96fd727e46a2cfec94c4">get_frame_register_unsigned</a> (this_frame, <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4caecf4c88f627410a19e73e47634c38b03">SPU_LSLR_REGNUM</a>);
<a name="l01003"></a>01003       <span class="keywordflow">if</span> (!lslr)
<a name="l01004"></a>01004         lslr = (<a class="code" href="defs_8h.html#a4df4af8771b1016a24976757026f4984">ULONGEST</a>) -1;
<a name="l01005"></a>01005 
<a name="l01006"></a>01006       <span class="comment">/* Get the backchain.  */</span>
<a name="l01007"></a>01007       reg = <a class="code" href="frame_8c.html#affa785e8937e96fd727e46a2cfec94c4">get_frame_register_unsigned</a> (this_frame, <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4ca4d2edf1cf9cd8c1c52cde68536a2c45d">SPU_SP_REGNUM</a>);
<a name="l01008"></a>01008       status = <a class="code" href="corefile_8c.html#a699566bc75ae8b1b9a3a9963236845a8">safe_read_memory_integer</a> (<a class="code" href="spu-tdep_8h.html#a9dd6343d7c2ebf90bf29d78289bdb110">SPUADDR</a> (<span class="keywordtype">id</span>, reg), 4, byte_order,
<a name="l01009"></a>01009                                          &amp;backchain);
<a name="l01010"></a>01010 
<a name="l01011"></a>01011       <span class="comment">/* A zero backchain terminates the frame chain.  Also, sanity</span>
<a name="l01012"></a>01012 <span class="comment">         check against the local store size limit.  */</span>
<a name="l01013"></a>01013       <span class="keywordflow">if</span> (status &amp;&amp; backchain &gt; 0 &amp;&amp; backchain &lt;= lslr)
<a name="l01014"></a>01014         {
<a name="l01015"></a>01015           <span class="comment">/* Assume the link register is saved into its slot.  */</span>
<a name="l01016"></a>01016           <span class="keywordflow">if</span> (backchain + 16 &lt;= lslr)
<a name="l01017"></a>01017             info-&gt;<a class="code" href="structspu__unwind__cache.html#a9b9d41c7cb1ee2cfc6ee355738cb2094">saved_regs</a>[<a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4ca86906770085d81bb98f13de00851ac1f">SPU_LR_REGNUM</a>].<a class="code" href="structtrad__frame__saved__reg.html#a61ae37bca806acd4b239bf27cbed527a">addr</a> = <a class="code" href="spu-tdep_8h.html#a9dd6343d7c2ebf90bf29d78289bdb110">SPUADDR</a> (<span class="keywordtype">id</span>,
<a name="l01018"></a>01018                                                             backchain + 16);
<a name="l01019"></a>01019 
<a name="l01020"></a>01020           <span class="comment">/* Frame bases.  */</span>
<a name="l01021"></a>01021           info-&gt;<a class="code" href="structspu__unwind__cache.html#a19138a4e2cb1663d999d3df8a4cf9981">frame_base</a> = <a class="code" href="spu-tdep_8h.html#a9dd6343d7c2ebf90bf29d78289bdb110">SPUADDR</a> (<span class="keywordtype">id</span>, backchain);
<a name="l01022"></a>01022           info-&gt;<a class="code" href="structspu__unwind__cache.html#a4dc689058b68c48e6f4da13cc4a8019d">local_base</a> = <a class="code" href="spu-tdep_8h.html#a9dd6343d7c2ebf90bf29d78289bdb110">SPUADDR</a> (<span class="keywordtype">id</span>, reg);
<a name="l01023"></a>01023         }
<a name="l01024"></a>01024     }
<a name="l01025"></a>01025 
<a name="l01026"></a>01026   <span class="comment">/* If we didn&#39;t find a frame, we cannot determine SP / return address.  */</span>
<a name="l01027"></a>01027   <span class="keywordflow">if</span> (info-&gt;<a class="code" href="structspu__unwind__cache.html#a19138a4e2cb1663d999d3df8a4cf9981">frame_base</a> == 0)
<a name="l01028"></a>01028     <span class="keywordflow">return</span> info;
<a name="l01029"></a>01029 
<a name="l01030"></a>01030   <span class="comment">/* The previous SP is equal to the CFA.  */</span>
<a name="l01031"></a>01031   <a class="code" href="trad-frame_8c.html#aba845c5704e0bebe84b2a84eb8c9e962">trad_frame_set_value</a> (info-&gt;<a class="code" href="structspu__unwind__cache.html#a9b9d41c7cb1ee2cfc6ee355738cb2094">saved_regs</a>, <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4ca4d2edf1cf9cd8c1c52cde68536a2c45d">SPU_SP_REGNUM</a>,
<a name="l01032"></a>01032                         <a class="code" href="spu-tdep_8h.html#a774f32c94d1e14fd951edbf335cd0c51">SPUADDR_ADDR</a> (info-&gt;<a class="code" href="structspu__unwind__cache.html#a19138a4e2cb1663d999d3df8a4cf9981">frame_base</a>));
<a name="l01033"></a>01033 
<a name="l01034"></a>01034   <span class="comment">/* Read full contents of the unwound link register in order to</span>
<a name="l01035"></a>01035 <span class="comment">     be able to determine the return address.  */</span>
<a name="l01036"></a>01036   <span class="keywordflow">if</span> (<a class="code" href="trad-frame_8c.html#aa3a0e933330792e061147f62a08b7a32">trad_frame_addr_p</a> (info-&gt;<a class="code" href="structspu__unwind__cache.html#a9b9d41c7cb1ee2cfc6ee355738cb2094">saved_regs</a>, <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4ca86906770085d81bb98f13de00851ac1f">SPU_LR_REGNUM</a>))
<a name="l01037"></a>01037     <a class="code" href="target_8c.html#ac579515fbccfb9e6b1a45766a71c1d4f">target_read_memory</a> (info-&gt;<a class="code" href="structspu__unwind__cache.html#a9b9d41c7cb1ee2cfc6ee355738cb2094">saved_regs</a>[<a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4ca86906770085d81bb98f13de00851ac1f">SPU_LR_REGNUM</a>].<a class="code" href="structtrad__frame__saved__reg.html#a61ae37bca806acd4b239bf27cbed527a">addr</a>, buf, 16);
<a name="l01038"></a>01038   <span class="keywordflow">else</span>
<a name="l01039"></a>01039     <a class="code" href="frame_8c.html#ae0e45fe018a867aabc8d9a217575c42f">get_frame_register</a> (this_frame, <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4ca86906770085d81bb98f13de00851ac1f">SPU_LR_REGNUM</a>, buf);
<a name="l01040"></a>01040 
<a name="l01041"></a>01041   <span class="comment">/* Normally, the return address is contained in the slot 0 of the</span>
<a name="l01042"></a>01042 <span class="comment">     link register, and slots 1-3 are zero.  For an overlay return,</span>
<a name="l01043"></a>01043 <span class="comment">     slot 0 contains the address of the overlay manager return stub,</span>
<a name="l01044"></a>01044 <span class="comment">     slot 1 contains the partition number of the overlay section to</span>
<a name="l01045"></a>01045 <span class="comment">     be returned to, and slot 2 contains the return address within</span>
<a name="l01046"></a>01046 <span class="comment">     that section.  Return the latter address in that case.  */</span>
<a name="l01047"></a>01047   <span class="keywordflow">if</span> (<a class="code" href="defs_8h.html#a99aec65329508b4d449a4f881026f844">extract_unsigned_integer</a> (buf + 8, 4, byte_order) != 0)
<a name="l01048"></a>01048     <a class="code" href="trad-frame_8c.html#aba845c5704e0bebe84b2a84eb8c9e962">trad_frame_set_value</a> (info-&gt;<a class="code" href="structspu__unwind__cache.html#a9b9d41c7cb1ee2cfc6ee355738cb2094">saved_regs</a>, <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4cac5c6ca5984213bd79f0060b49caef630">SPU_PC_REGNUM</a>,
<a name="l01049"></a>01049                           <a class="code" href="defs_8h.html#a99aec65329508b4d449a4f881026f844">extract_unsigned_integer</a> (buf + 8, 4, byte_order));
<a name="l01050"></a>01050   <span class="keywordflow">else</span>
<a name="l01051"></a>01051     <a class="code" href="trad-frame_8c.html#aba845c5704e0bebe84b2a84eb8c9e962">trad_frame_set_value</a> (info-&gt;<a class="code" href="structspu__unwind__cache.html#a9b9d41c7cb1ee2cfc6ee355738cb2094">saved_regs</a>, <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4cac5c6ca5984213bd79f0060b49caef630">SPU_PC_REGNUM</a>,
<a name="l01052"></a>01052                           <a class="code" href="defs_8h.html#a99aec65329508b4d449a4f881026f844">extract_unsigned_integer</a> (buf, 4, byte_order));
<a name="l01053"></a>01053  
<a name="l01054"></a>01054   <span class="keywordflow">return</span> info;
<a name="l01055"></a>01055 }
<a name="l01056"></a>01056 
<a name="l01057"></a>01057 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01058"></a><a class="code" href="spu-tdep_8c.html#a37cf8996e20e6ef8db127d94fa1866de">01058</a> <a class="code" href="spu-tdep_8c.html#a37cf8996e20e6ef8db127d94fa1866de">spu_frame_this_id</a> (<span class="keyword">struct</span> <a class="code" href="structframe__info.html">frame_info</a> *this_frame,
<a name="l01059"></a>01059                    <span class="keywordtype">void</span> **this_prologue_cache, <span class="keyword">struct</span> <a class="code" href="structframe__id.html">frame_id</a> *this_id)
<a name="l01060"></a>01060 {
<a name="l01061"></a>01061   <span class="keyword">struct </span><a class="code" href="structspu__unwind__cache.html">spu_unwind_cache</a> *info =
<a name="l01062"></a>01062     <a class="code" href="spu-tdep_8c.html#a211b8bec3727f9303466c519a9bb1ac4">spu_frame_unwind_cache</a> (this_frame, this_prologue_cache);
<a name="l01063"></a>01063 
<a name="l01064"></a>01064   <span class="keywordflow">if</span> (info-&gt;<a class="code" href="structspu__unwind__cache.html#a19138a4e2cb1663d999d3df8a4cf9981">frame_base</a> == 0)
<a name="l01065"></a>01065     <span class="keywordflow">return</span>;
<a name="l01066"></a>01066 
<a name="l01067"></a>01067   *this_id = <a class="code" href="frame_8c.html#a7f32da6ddc275b4684c301448d891f5b">frame_id_build</a> (info-&gt;<a class="code" href="structspu__unwind__cache.html#a19138a4e2cb1663d999d3df8a4cf9981">frame_base</a>, info-&gt;<a class="code" href="structspu__unwind__cache.html#ad290c9fe8f35e562922e32a7291f8313">func</a>);
<a name="l01068"></a>01068 }
<a name="l01069"></a>01069 
<a name="l01070"></a>01070 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structvalue.html">value</a> *
<a name="l01071"></a><a class="code" href="spu-tdep_8c.html#ae3b84c52601a0f2d802c3bca2f1ed731">01071</a> <a class="code" href="spu-tdep_8c.html#ae3b84c52601a0f2d802c3bca2f1ed731">spu_frame_prev_register</a> (<span class="keyword">struct</span> <a class="code" href="structframe__info.html">frame_info</a> *this_frame,
<a name="l01072"></a>01072                          <span class="keywordtype">void</span> **this_prologue_cache, <span class="keywordtype">int</span> <a class="code" href="aarch64-tdep_8c.html#a6b3d1ad0bca4067ccaef1366bea0db04">regnum</a>)
<a name="l01073"></a>01073 {
<a name="l01074"></a>01074   <span class="keyword">struct </span><a class="code" href="structspu__unwind__cache.html">spu_unwind_cache</a> *info
<a name="l01075"></a>01075     = <a class="code" href="spu-tdep_8c.html#a211b8bec3727f9303466c519a9bb1ac4">spu_frame_unwind_cache</a> (this_frame, this_prologue_cache);
<a name="l01076"></a>01076 
<a name="l01077"></a>01077   <span class="comment">/* Special-case the stack pointer.  */</span>
<a name="l01078"></a>01078   <span class="keywordflow">if</span> (regnum == <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4caa2793092717e5a3149a148e738f44a53">SPU_RAW_SP_REGNUM</a>)
<a name="l01079"></a>01079     regnum = <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4ca4d2edf1cf9cd8c1c52cde68536a2c45d">SPU_SP_REGNUM</a>;
<a name="l01080"></a>01080 
<a name="l01081"></a>01081   <span class="keywordflow">return</span> <a class="code" href="trad-frame_8c.html#a942094830577eeb218e28c3c84452d59">trad_frame_get_prev_register</a> (this_frame, info-&gt;<a class="code" href="structspu__unwind__cache.html#a9b9d41c7cb1ee2cfc6ee355738cb2094">saved_regs</a>, regnum);
<a name="l01082"></a>01082 }
<a name="l01083"></a>01083 
<a name="l01084"></a><a class="code" href="spu-tdep_8c.html#a3bd7990a308250cad958a95c3962e2d8">01084</a> <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structframe__unwind.html">frame_unwind</a> <a class="code" href="spu-tdep_8c.html#a3bd7990a308250cad958a95c3962e2d8">spu_frame_unwind</a> = {
<a name="l01085"></a>01085   <a class="code" href="frame_8h.html#a3ca2c0bc7578bf3d337e34b2c08a6c5faeb4f7fd6d9e397d1141feb133746637a">NORMAL_FRAME</a>,
<a name="l01086"></a>01086   <a class="code" href="frame-unwind_8c.html#aa950afe60921514574c6150f0821f05c">default_frame_unwind_stop_reason</a>,
<a name="l01087"></a>01087   <a class="code" href="spu-tdep_8c.html#a37cf8996e20e6ef8db127d94fa1866de">spu_frame_this_id</a>,
<a name="l01088"></a>01088   <a class="code" href="spu-tdep_8c.html#ae3b84c52601a0f2d802c3bca2f1ed731">spu_frame_prev_register</a>,
<a name="l01089"></a>01089   NULL,
<a name="l01090"></a>01090   <a class="code" href="frame-unwind_8c.html#ade64a9807fa508622581cc779b10ff9c">default_frame_sniffer</a>
<a name="l01091"></a>01091 };
<a name="l01092"></a>01092 
<a name="l01093"></a>01093 <span class="keyword">static</span> <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a>
<a name="l01094"></a><a class="code" href="spu-tdep_8c.html#a6ceb5104e7bd7bd81c7dcf75a24e7d83">01094</a> <a class="code" href="spu-tdep_8c.html#a6ceb5104e7bd7bd81c7dcf75a24e7d83">spu_frame_base_address</a> (<span class="keyword">struct</span> <a class="code" href="structframe__info.html">frame_info</a> *this_frame, <span class="keywordtype">void</span> **this_cache)
<a name="l01095"></a>01095 {
<a name="l01096"></a>01096   <span class="keyword">struct </span><a class="code" href="structspu__unwind__cache.html">spu_unwind_cache</a> *info
<a name="l01097"></a>01097     = <a class="code" href="spu-tdep_8c.html#a211b8bec3727f9303466c519a9bb1ac4">spu_frame_unwind_cache</a> (this_frame, this_cache);
<a name="l01098"></a>01098   <span class="keywordflow">return</span> info-&gt;<a class="code" href="structspu__unwind__cache.html#a4dc689058b68c48e6f4da13cc4a8019d">local_base</a>;
<a name="l01099"></a>01099 }
<a name="l01100"></a>01100 
<a name="l01101"></a><a class="code" href="spu-tdep_8c.html#a09dac15bf76c88b3d8d20222fbe8b4d4">01101</a> <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structframe__base.html">frame_base</a> <a class="code" href="spu-tdep_8c.html#a09dac15bf76c88b3d8d20222fbe8b4d4">spu_frame_base</a> = {
<a name="l01102"></a>01102   &amp;<a class="code" href="spu-tdep_8c.html#a3bd7990a308250cad958a95c3962e2d8">spu_frame_unwind</a>,
<a name="l01103"></a>01103   <a class="code" href="spu-tdep_8c.html#a6ceb5104e7bd7bd81c7dcf75a24e7d83">spu_frame_base_address</a>,
<a name="l01104"></a>01104   <a class="code" href="spu-tdep_8c.html#a6ceb5104e7bd7bd81c7dcf75a24e7d83">spu_frame_base_address</a>,
<a name="l01105"></a>01105   spu_frame_base_address
<a name="l01106"></a>01106 };
<a name="l01107"></a>01107 
<a name="l01108"></a>01108 <span class="keyword">static</span> <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a>
<a name="l01109"></a><a class="code" href="spu-tdep_8c.html#a9473c264146aab82adcbf41922b1c3d6">01109</a> <a class="code" href="spu-tdep_8c.html#a9473c264146aab82adcbf41922b1c3d6">spu_unwind_pc</a> (<span class="keyword">struct</span> <a class="code" href="structgdbarch.html">gdbarch</a> *<a class="code" href="structgdbarch.html">gdbarch</a>, <span class="keyword">struct</span> <a class="code" href="structframe__info.html">frame_info</a> *next_frame)
<a name="l01110"></a>01110 {
<a name="l01111"></a>01111   <span class="keyword">struct </span><a class="code" href="structgdbarch__tdep.html">gdbarch_tdep</a> *tdep = <a class="code" href="gdbarch_8c.html#acea996b7421706849bc20567695b5b31">gdbarch_tdep</a> (gdbarch);
<a name="l01112"></a>01112   <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> <a class="code" href="structgdbarch__tdep.html#ab7a207d4e85b564c48238283745247b8">pc</a> = <a class="code" href="frame_8c.html#a294f6912118884550787fd59f2a08ff6">frame_unwind_register_unsigned</a> (next_frame, <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4cac5c6ca5984213bd79f0060b49caef630">SPU_PC_REGNUM</a>);
<a name="l01113"></a>01113   <span class="comment">/* Mask off interrupt enable bit.  */</span>
<a name="l01114"></a>01114   <span class="keywordflow">return</span> <a class="code" href="spu-tdep_8h.html#a9dd6343d7c2ebf90bf29d78289bdb110">SPUADDR</a> (tdep-&gt;<a class="code" href="structgdbarch__tdep.html#a6c04333e4962a9690dea1334a6201d30">id</a>, pc &amp; -4);
<a name="l01115"></a>01115 }
<a name="l01116"></a>01116 
<a name="l01117"></a>01117 <span class="keyword">static</span> <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a>
<a name="l01118"></a><a class="code" href="spu-tdep_8c.html#ae3bf0f68054dfcb863609c9278145186">01118</a> <a class="code" href="spu-tdep_8c.html#ae3bf0f68054dfcb863609c9278145186">spu_unwind_sp</a> (<span class="keyword">struct</span> <a class="code" href="structgdbarch.html">gdbarch</a> *<a class="code" href="structgdbarch.html">gdbarch</a>, <span class="keyword">struct</span> <a class="code" href="structframe__info.html">frame_info</a> *next_frame)
<a name="l01119"></a>01119 {
<a name="l01120"></a>01120   <span class="keyword">struct </span><a class="code" href="structgdbarch__tdep.html">gdbarch_tdep</a> *tdep = <a class="code" href="gdbarch_8c.html#acea996b7421706849bc20567695b5b31">gdbarch_tdep</a> (gdbarch);
<a name="l01121"></a>01121   <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> <a class="code" href="structgdbarch__tdep.html#a6c9a3fc3be4039b5ccd626c50ebcb2fd">sp</a> = <a class="code" href="frame_8c.html#a294f6912118884550787fd59f2a08ff6">frame_unwind_register_unsigned</a> (next_frame, <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4ca4d2edf1cf9cd8c1c52cde68536a2c45d">SPU_SP_REGNUM</a>);
<a name="l01122"></a>01122   <span class="keywordflow">return</span> <a class="code" href="spu-tdep_8h.html#a9dd6343d7c2ebf90bf29d78289bdb110">SPUADDR</a> (tdep-&gt;<a class="code" href="structgdbarch__tdep.html#a6c04333e4962a9690dea1334a6201d30">id</a>, sp);
<a name="l01123"></a>01123 }
<a name="l01124"></a>01124 
<a name="l01125"></a>01125 <span class="keyword">static</span> <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a>
<a name="l01126"></a><a class="code" href="spu-tdep_8c.html#af43e5f10b9caf800fbfda85907dc7baa">01126</a> <a class="code" href="spu-tdep_8c.html#af43e5f10b9caf800fbfda85907dc7baa">spu_read_pc</a> (<span class="keyword">struct</span> <a class="code" href="structregcache.html">regcache</a> *<a class="code" href="structregcache.html">regcache</a>)
<a name="l01127"></a>01127 {
<a name="l01128"></a>01128   <span class="keyword">struct </span><a class="code" href="structgdbarch__tdep.html">gdbarch_tdep</a> *tdep = <a class="code" href="gdbarch_8c.html#acea996b7421706849bc20567695b5b31">gdbarch_tdep</a> (<a class="code" href="regcache_8c.html#ad4f6d0cdf256b1fa45d59a6d71b50659">get_regcache_arch</a> (regcache));
<a name="l01129"></a>01129   <a class="code" href="defs_8h.html#a4df4af8771b1016a24976757026f4984">ULONGEST</a> <a class="code" href="structgdbarch__tdep.html#ab7a207d4e85b564c48238283745247b8">pc</a>;
<a name="l01130"></a>01130   <a class="code" href="regcache_8c.html#a959a077d769de1641d4f9754cc7b4a1f">regcache_cooked_read_unsigned</a> (regcache, <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4cac5c6ca5984213bd79f0060b49caef630">SPU_PC_REGNUM</a>, &amp;pc);
<a name="l01131"></a>01131   <span class="comment">/* Mask off interrupt enable bit.  */</span>
<a name="l01132"></a>01132   <span class="keywordflow">return</span> <a class="code" href="spu-tdep_8h.html#a9dd6343d7c2ebf90bf29d78289bdb110">SPUADDR</a> (tdep-&gt;<a class="code" href="structgdbarch__tdep.html#a6c04333e4962a9690dea1334a6201d30">id</a>, pc &amp; -4);
<a name="l01133"></a>01133 }
<a name="l01134"></a>01134 
<a name="l01135"></a>01135 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01136"></a><a class="code" href="spu-tdep_8c.html#a2ec06b5638bb6b107050e0cd1ca75a1c">01136</a> <a class="code" href="spu-tdep_8c.html#a2ec06b5638bb6b107050e0cd1ca75a1c">spu_write_pc</a> (<span class="keyword">struct</span> <a class="code" href="structregcache.html">regcache</a> *<a class="code" href="structregcache.html">regcache</a>, <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> <a class="code" href="structgdbarch__tdep.html#ab7a207d4e85b564c48238283745247b8">pc</a>)
<a name="l01137"></a>01137 {
<a name="l01138"></a>01138   <span class="comment">/* Keep interrupt enabled state unchanged.  */</span>
<a name="l01139"></a>01139   <a class="code" href="defs_8h.html#a4df4af8771b1016a24976757026f4984">ULONGEST</a> old_pc;
<a name="l01140"></a>01140 
<a name="l01141"></a>01141   <a class="code" href="regcache_8c.html#a959a077d769de1641d4f9754cc7b4a1f">regcache_cooked_read_unsigned</a> (regcache, <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4cac5c6ca5984213bd79f0060b49caef630">SPU_PC_REGNUM</a>, &amp;old_pc);
<a name="l01142"></a>01142   <a class="code" href="regcache_8c.html#ae5fb22bfd07bc89a855768ef6f910745">regcache_cooked_write_unsigned</a> (regcache, <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4cac5c6ca5984213bd79f0060b49caef630">SPU_PC_REGNUM</a>,
<a name="l01143"></a>01143                                   (<a class="code" href="spu-tdep_8h.html#a774f32c94d1e14fd951edbf335cd0c51">SPUADDR_ADDR</a> (pc) &amp; -4) | (old_pc &amp; 3));
<a name="l01144"></a>01144 }
<a name="l01145"></a>01145 
<a name="l01146"></a>01146 
<a name="l01147"></a>01147 <span class="comment">/* Cell/B.E. cross-architecture unwinder support.  */</span>
<a name="l01148"></a>01148 
<a name="l01149"></a><a class="code" href="structspu2ppu__cache.html">01149</a> <span class="keyword">struct </span><a class="code" href="structspu2ppu__cache.html">spu2ppu_cache</a>
<a name="l01150"></a>01150 {
<a name="l01151"></a><a class="code" href="structspu2ppu__cache.html#a699fc505d7d6b6b6c087d1d186aa031b">01151</a>   <span class="keyword">struct </span><a class="code" href="structframe__id.html">frame_id</a> <a class="code" href="structframe__id.html">frame_id</a>;
<a name="l01152"></a><a class="code" href="structspu2ppu__cache.html#ab4196207d7f11b4bb07541cc8d960211">01152</a>   <span class="keyword">struct </span><a class="code" href="structregcache.html">regcache</a> *<a class="code" href="structspu2ppu__cache.html#ab4196207d7f11b4bb07541cc8d960211">regcache</a>;
<a name="l01153"></a>01153 };
<a name="l01154"></a>01154 
<a name="l01155"></a>01155 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structgdbarch.html">gdbarch</a> *
<a name="l01156"></a><a class="code" href="spu-tdep_8c.html#a7ea94d4b13eb6d64650cc1abb19961ef">01156</a> <a class="code" href="spu-tdep_8c.html#a7ea94d4b13eb6d64650cc1abb19961ef">spu2ppu_prev_arch</a> (<span class="keyword">struct</span> <a class="code" href="structframe__info.html">frame_info</a> *this_frame, <span class="keywordtype">void</span> **this_cache)
<a name="l01157"></a>01157 {
<a name="l01158"></a>01158   <span class="keyword">struct </span><a class="code" href="structspu2ppu__cache.html">spu2ppu_cache</a> *cache = *this_cache;
<a name="l01159"></a>01159   <span class="keywordflow">return</span> <a class="code" href="regcache_8c.html#ad4f6d0cdf256b1fa45d59a6d71b50659">get_regcache_arch</a> (cache-&gt;<a class="code" href="structspu2ppu__cache.html#ab4196207d7f11b4bb07541cc8d960211">regcache</a>);
<a name="l01160"></a>01160 }
<a name="l01161"></a>01161 
<a name="l01162"></a>01162 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01163"></a><a class="code" href="spu-tdep_8c.html#ac955e9a65ff247c0eff13f916e299bb0">01163</a> <a class="code" href="spu-tdep_8c.html#ac955e9a65ff247c0eff13f916e299bb0">spu2ppu_this_id</a> (<span class="keyword">struct</span> <a class="code" href="structframe__info.html">frame_info</a> *this_frame,
<a name="l01164"></a>01164                  <span class="keywordtype">void</span> **this_cache, <span class="keyword">struct</span> <a class="code" href="structframe__id.html">frame_id</a> *this_id)
<a name="l01165"></a>01165 {
<a name="l01166"></a>01166   <span class="keyword">struct </span><a class="code" href="structspu2ppu__cache.html">spu2ppu_cache</a> *cache = *this_cache;
<a name="l01167"></a>01167   *this_id = cache-&gt;<a class="code" href="structspu2ppu__cache.html#a699fc505d7d6b6b6c087d1d186aa031b">frame_id</a>;
<a name="l01168"></a>01168 }
<a name="l01169"></a>01169 
<a name="l01170"></a>01170 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structvalue.html">value</a> *
<a name="l01171"></a><a class="code" href="spu-tdep_8c.html#a2bbec2aa33c06229752f5a990300972f">01171</a> <a class="code" href="spu-tdep_8c.html#a2bbec2aa33c06229752f5a990300972f">spu2ppu_prev_register</a> (<span class="keyword">struct</span> <a class="code" href="structframe__info.html">frame_info</a> *this_frame,
<a name="l01172"></a>01172                        <span class="keywordtype">void</span> **this_cache, <span class="keywordtype">int</span> <a class="code" href="aarch64-tdep_8c.html#a6b3d1ad0bca4067ccaef1366bea0db04">regnum</a>)
<a name="l01173"></a>01173 {
<a name="l01174"></a>01174   <span class="keyword">struct </span><a class="code" href="structspu2ppu__cache.html">spu2ppu_cache</a> *cache = *this_cache;
<a name="l01175"></a>01175   <span class="keyword">struct </span><a class="code" href="structgdbarch.html">gdbarch</a> *<a class="code" href="structgdbarch.html">gdbarch</a> = <a class="code" href="regcache_8c.html#ad4f6d0cdf256b1fa45d59a6d71b50659">get_regcache_arch</a> (cache-&gt;<a class="code" href="structspu2ppu__cache.html#ab4196207d7f11b4bb07541cc8d960211">regcache</a>);
<a name="l01176"></a>01176   <a class="code" href="defs_8h.html#a336b399b3b83dbcc61f176c33f26b607">gdb_byte</a> *buf;
<a name="l01177"></a>01177 
<a name="l01178"></a>01178   buf = alloca (<a class="code" href="regcache_8c.html#a4c51fa25edb9ce25451b9dc7bd127aac">register_size</a> (gdbarch, regnum));
<a name="l01179"></a>01179   <a class="code" href="regcache_8c.html#a7056a5ea585aa0938893952f52d95e2e">regcache_cooked_read</a> (cache-&gt;<a class="code" href="structspu2ppu__cache.html#ab4196207d7f11b4bb07541cc8d960211">regcache</a>, regnum, buf);
<a name="l01180"></a>01180   <span class="keywordflow">return</span> <a class="code" href="frame-unwind_8c.html#ae67cb1c60367c6ae67ba810d2d05665c">frame_unwind_got_bytes</a> (this_frame, regnum, buf);
<a name="l01181"></a>01181 }
<a name="l01182"></a>01182 
<a name="l01183"></a>01183 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l01184"></a><a class="code" href="spu-tdep_8c.html#a253555c4f327fcf82014db72cca002ea">01184</a> <a class="code" href="spu-tdep_8c.html#a253555c4f327fcf82014db72cca002ea">spu2ppu_sniffer</a> (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structframe__unwind.html">frame_unwind</a> *<span class="keyword">self</span>,
<a name="l01185"></a>01185                  <span class="keyword">struct</span> <a class="code" href="structframe__info.html">frame_info</a> *this_frame, <span class="keywordtype">void</span> **this_prologue_cache)
<a name="l01186"></a>01186 {
<a name="l01187"></a>01187   <span class="keyword">struct </span><a class="code" href="structgdbarch.html">gdbarch</a> *<a class="code" href="structgdbarch.html">gdbarch</a> = <a class="code" href="frame_8c.html#ab44507b5655da44e522ed5857835ede7">get_frame_arch</a> (this_frame);
<a name="l01188"></a>01188   <span class="keyword">enum</span> bfd_endian <a class="code" href="structgdbarch.html#a7a9dd6544406e9cbb574dae9d531346e">byte_order</a> = <a class="code" href="gdbarch_8c.html#abc300a3797421aa7342b288e1637483e">gdbarch_byte_order</a> (gdbarch);
<a name="l01189"></a>01189   <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> base, <a class="code" href="remote-fileio_8c.html#a7e97efb32ba66c3f1141bdbb82529d20">func</a>, backchain;
<a name="l01190"></a>01190   <a class="code" href="defs_8h.html#a336b399b3b83dbcc61f176c33f26b607">gdb_byte</a> buf[4];
<a name="l01191"></a>01191 
<a name="l01192"></a>01192   <span class="keywordflow">if</span> (<a class="code" href="gdbarch_8c.html#a305465885963fbf0fb5a7543594a7bff">gdbarch_bfd_arch_info</a> (<a class="code" href="gdbarch_8c.html#ad648a33f69abe34e9679744a0c5a0580">target_gdbarch</a> ())-&gt;arch == bfd_arch_spu)
<a name="l01193"></a>01193     <span class="keywordflow">return</span> 0;
<a name="l01194"></a>01194 
<a name="l01195"></a>01195   base = <a class="code" href="frame_8c.html#ae21020772c3938f6952da0e2595232a5">get_frame_sp</a> (this_frame);
<a name="l01196"></a>01196   func = <a class="code" href="frame_8c.html#a27aafb00e05cba145dfba0e4bc7b1d70">get_frame_pc</a> (this_frame);
<a name="l01197"></a>01197   <span class="keywordflow">if</span> (<a class="code" href="target_8c.html#ac579515fbccfb9e6b1a45766a71c1d4f">target_read_memory</a> (base, buf, 4))
<a name="l01198"></a>01198     <span class="keywordflow">return</span> 0;
<a name="l01199"></a>01199   backchain = <a class="code" href="defs_8h.html#a99aec65329508b4d449a4f881026f844">extract_unsigned_integer</a> (buf, 4, byte_order);
<a name="l01200"></a>01200 
<a name="l01201"></a>01201   <span class="keywordflow">if</span> (!backchain)
<a name="l01202"></a>01202     {
<a name="l01203"></a>01203       <span class="keyword">struct </span><a class="code" href="structframe__info.html">frame_info</a> *fi;
<a name="l01204"></a>01204 
<a name="l01205"></a>01205       <span class="keyword">struct </span><a class="code" href="structspu2ppu__cache.html">spu2ppu_cache</a> *cache
<a name="l01206"></a>01206         = <a class="code" href="frame_8h.html#ae654e578eaf7f8db1ba8b737f956b856">FRAME_OBSTACK_CALLOC</a> (1, <span class="keyword">struct</span> <a class="code" href="structspu2ppu__cache.html">spu2ppu_cache</a>);
<a name="l01207"></a>01207 
<a name="l01208"></a>01208       cache-&gt;<a class="code" href="structspu2ppu__cache.html#a699fc505d7d6b6b6c087d1d186aa031b">frame_id</a> = <a class="code" href="frame_8c.html#a7f32da6ddc275b4684c301448d891f5b">frame_id_build</a> (base + 16, func);
<a name="l01209"></a>01209 
<a name="l01210"></a>01210       <span class="keywordflow">for</span> (fi = <a class="code" href="frame_8c.html#a80df189cf511651209609685d5380340">get_next_frame</a> (this_frame); fi; fi = <a class="code" href="frame_8c.html#a80df189cf511651209609685d5380340">get_next_frame</a> (fi))
<a name="l01211"></a>01211         <span class="keywordflow">if</span> (<a class="code" href="gdbarch_8c.html#a305465885963fbf0fb5a7543594a7bff">gdbarch_bfd_arch_info</a> (<a class="code" href="frame_8c.html#ab44507b5655da44e522ed5857835ede7">get_frame_arch</a> (fi))-&gt;arch != bfd_arch_spu)
<a name="l01212"></a>01212           <span class="keywordflow">break</span>;
<a name="l01213"></a>01213 
<a name="l01214"></a>01214       <span class="keywordflow">if</span> (fi)
<a name="l01215"></a>01215         {
<a name="l01216"></a>01216           cache-&gt;<a class="code" href="structspu2ppu__cache.html#ab4196207d7f11b4bb07541cc8d960211">regcache</a> = <a class="code" href="frame_8c.html#a2f7482cb26f04433a174151e008433a1">frame_save_as_regcache</a> (fi);
<a name="l01217"></a>01217           *this_prologue_cache = cache;
<a name="l01218"></a>01218           <span class="keywordflow">return</span> 1;
<a name="l01219"></a>01219         }
<a name="l01220"></a>01220       <span class="keywordflow">else</span>
<a name="l01221"></a>01221         {
<a name="l01222"></a>01222           <span class="keyword">struct </span><a class="code" href="structregcache.html">regcache</a> *<a class="code" href="structregcache.html">regcache</a>;
<a name="l01223"></a>01223           regcache = <a class="code" href="regcache_8c.html#a25cbb6c0d6fb96e9e52937263db0986d">get_thread_arch_regcache</a> (<a class="code" href="infcmd_8c.html#a428c5be9ce5e70bd03760e828e19c6b7">inferior_ptid</a>, <a class="code" href="gdbarch_8c.html#ad648a33f69abe34e9679744a0c5a0580">target_gdbarch</a> ());
<a name="l01224"></a>01224           cache-&gt;<a class="code" href="structspu2ppu__cache.html#ab4196207d7f11b4bb07541cc8d960211">regcache</a> = <a class="code" href="regcache_8c.html#a0c328beed8da37878ea67640f4625db0">regcache_dup</a> (regcache);
<a name="l01225"></a>01225           *this_prologue_cache = cache;
<a name="l01226"></a>01226           <span class="keywordflow">return</span> 1;
<a name="l01227"></a>01227         }
<a name="l01228"></a>01228     }
<a name="l01229"></a>01229 
<a name="l01230"></a>01230   <span class="keywordflow">return</span> 0;
<a name="l01231"></a>01231 }
<a name="l01232"></a>01232 
<a name="l01233"></a>01233 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01234"></a><a class="code" href="spu-tdep_8c.html#a1523e936ab199cf43c3393cdc6c73886">01234</a> <a class="code" href="spu-tdep_8c.html#a1523e936ab199cf43c3393cdc6c73886">spu2ppu_dealloc_cache</a> (<span class="keyword">struct</span> <a class="code" href="structframe__info.html">frame_info</a> *<span class="keyword">self</span>, <span class="keywordtype">void</span> *this_cache)
<a name="l01235"></a>01235 {
<a name="l01236"></a>01236   <span class="keyword">struct </span><a class="code" href="structspu2ppu__cache.html">spu2ppu_cache</a> *cache = this_cache;
<a name="l01237"></a>01237   <a class="code" href="regcache_8c.html#ae9443862f0f82d2d3258dcaae4c3aecb">regcache_xfree</a> (cache-&gt;<a class="code" href="structspu2ppu__cache.html#ab4196207d7f11b4bb07541cc8d960211">regcache</a>);
<a name="l01238"></a>01238 }
<a name="l01239"></a>01239 
<a name="l01240"></a><a class="code" href="spu-tdep_8c.html#ab09cbee51d4f0459cfb5aeeb9f19e361">01240</a> <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structframe__unwind.html">frame_unwind</a> <a class="code" href="spu-tdep_8c.html#ab09cbee51d4f0459cfb5aeeb9f19e361">spu2ppu_unwind</a> = {
<a name="l01241"></a>01241   <a class="code" href="frame_8h.html#a3ca2c0bc7578bf3d337e34b2c08a6c5fa50388d38f494a082759eee92dff528aa">ARCH_FRAME</a>,
<a name="l01242"></a>01242   <a class="code" href="frame-unwind_8c.html#aa950afe60921514574c6150f0821f05c">default_frame_unwind_stop_reason</a>,
<a name="l01243"></a>01243   <a class="code" href="spu-tdep_8c.html#ac955e9a65ff247c0eff13f916e299bb0">spu2ppu_this_id</a>,
<a name="l01244"></a>01244   <a class="code" href="spu-tdep_8c.html#a2bbec2aa33c06229752f5a990300972f">spu2ppu_prev_register</a>,
<a name="l01245"></a>01245   NULL,
<a name="l01246"></a>01246   <a class="code" href="spu-tdep_8c.html#a253555c4f327fcf82014db72cca002ea">spu2ppu_sniffer</a>,
<a name="l01247"></a>01247   <a class="code" href="spu-tdep_8c.html#a1523e936ab199cf43c3393cdc6c73886">spu2ppu_dealloc_cache</a>,
<a name="l01248"></a>01248   <a class="code" href="spu-tdep_8c.html#a7ea94d4b13eb6d64650cc1abb19961ef">spu2ppu_prev_arch</a>,
<a name="l01249"></a>01249 };
<a name="l01250"></a>01250 
<a name="l01251"></a>01251 
<a name="l01252"></a>01252 <span class="comment">/* Function calling convention.  */</span>
<a name="l01253"></a>01253 
<a name="l01254"></a>01254 <span class="keyword">static</span> <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a>
<a name="l01255"></a><a class="code" href="spu-tdep_8c.html#a84db0a35173eb9e9cea85107677187a5">01255</a> <a class="code" href="spu-tdep_8c.html#a84db0a35173eb9e9cea85107677187a5">spu_frame_align</a> (<span class="keyword">struct</span> <a class="code" href="structgdbarch.html">gdbarch</a> *<a class="code" href="structgdbarch.html">gdbarch</a>, <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> sp)
<a name="l01256"></a>01256 {
<a name="l01257"></a>01257   <span class="keywordflow">return</span> sp &amp; ~15;
<a name="l01258"></a>01258 }
<a name="l01259"></a>01259 
<a name="l01260"></a>01260 <span class="keyword">static</span> <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a>
<a name="l01261"></a><a class="code" href="spu-tdep_8c.html#a1632a5411024f28aee614f6d39ab9e13">01261</a> <a class="code" href="spu-tdep_8c.html#a1632a5411024f28aee614f6d39ab9e13">spu_push_dummy_code</a> (<span class="keyword">struct</span> <a class="code" href="structgdbarch.html">gdbarch</a> *<a class="code" href="structgdbarch.html">gdbarch</a>, <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> sp, <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> funaddr,
<a name="l01262"></a>01262                      <span class="keyword">struct</span> <a class="code" href="structvalue.html">value</a> **args, <span class="keywordtype">int</span> nargs, <span class="keyword">struct</span> <a class="code" href="structtype.html">type</a> *<a class="code" href="value_8c.html#a263a4c0bee0b0df41074b952d3c121d0">value_type</a>,
<a name="l01263"></a>01263                      <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> *real_pc, <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> *bp_addr,
<a name="l01264"></a>01264                      <span class="keyword">struct</span> <a class="code" href="structregcache.html">regcache</a> *<a class="code" href="structregcache.html">regcache</a>)
<a name="l01265"></a>01265 {
<a name="l01266"></a>01266   <span class="comment">/* Allocate space sufficient for a breakpoint, keeping the stack aligned.  */</span>
<a name="l01267"></a>01267   sp = (sp - 4) &amp; ~15;
<a name="l01268"></a>01268   <span class="comment">/* Store the address of that breakpoint */</span>
<a name="l01269"></a>01269   *bp_addr = sp;
<a name="l01270"></a>01270   <span class="comment">/* The call starts at the callee&#39;s entry point.  */</span>
<a name="l01271"></a>01271   *real_pc = funaddr;
<a name="l01272"></a>01272 
<a name="l01273"></a>01273   <span class="keywordflow">return</span> sp;
<a name="l01274"></a>01274 }
<a name="l01275"></a>01275 
<a name="l01276"></a>01276 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l01277"></a><a class="code" href="spu-tdep_8c.html#aa447fe749987ba9a7b81f3961bfd7197">01277</a> <a class="code" href="spu-tdep_8c.html#aa447fe749987ba9a7b81f3961bfd7197">spu_scalar_value_p</a> (<span class="keyword">struct</span> <a class="code" href="structtype.html">type</a> *<a class="code" href="structtype.html">type</a>)
<a name="l01278"></a>01278 {
<a name="l01279"></a>01279   <span class="keywordflow">switch</span> (<a class="code" href="gdbtypes_8h.html#a9505f41c7012665947c6b4065ce190e1">TYPE_CODE</a> (type))
<a name="l01280"></a>01280     {
<a name="l01281"></a>01281     <span class="keywordflow">case</span> <a class="code" href="gdbtypes_8h.html#a90e2a0fddaa6afff6a0a489ff4da3462a7071a71840688811b992838bb09d0ddd">TYPE_CODE_INT</a>:
<a name="l01282"></a>01282     <span class="keywordflow">case</span> <a class="code" href="gdbtypes_8h.html#a90e2a0fddaa6afff6a0a489ff4da3462a1afbc1e8f69012b205070a3b5eac7217">TYPE_CODE_ENUM</a>:
<a name="l01283"></a>01283     <span class="keywordflow">case</span> <a class="code" href="gdbtypes_8h.html#a90e2a0fddaa6afff6a0a489ff4da3462a31cf8189b076711e63dea04c1136bafe">TYPE_CODE_RANGE</a>:
<a name="l01284"></a>01284     <span class="keywordflow">case</span> <a class="code" href="gdbtypes_8h.html#a90e2a0fddaa6afff6a0a489ff4da3462ae991dd7ea70631f3e1b67a1a75020b5f">TYPE_CODE_CHAR</a>:
<a name="l01285"></a>01285     <span class="keywordflow">case</span> <a class="code" href="gdbtypes_8h.html#a90e2a0fddaa6afff6a0a489ff4da3462afbf0aa0241df408e1017ae7ff8e6798c">TYPE_CODE_BOOL</a>:
<a name="l01286"></a>01286     <span class="keywordflow">case</span> <a class="code" href="gdbtypes_8h.html#a90e2a0fddaa6afff6a0a489ff4da3462a1a639160f3e3a2f9f7ac55255942c581">TYPE_CODE_PTR</a>:
<a name="l01287"></a>01287     <span class="keywordflow">case</span> <a class="code" href="gdbtypes_8h.html#a90e2a0fddaa6afff6a0a489ff4da3462a476430709e5a251f7e0f8e3fb48a713f">TYPE_CODE_REF</a>:
<a name="l01288"></a>01288       <span class="keywordflow">return</span> <a class="code" href="gdbtypes_8h.html#aeac33f868e763780094aec8a2dcb9a1a">TYPE_LENGTH</a> (type) &lt;= 16;
<a name="l01289"></a>01289 
<a name="l01290"></a>01290     <span class="keywordflow">default</span>:
<a name="l01291"></a>01291       <span class="keywordflow">return</span> 0;
<a name="l01292"></a>01292     }
<a name="l01293"></a>01293 }
<a name="l01294"></a>01294 
<a name="l01295"></a>01295 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01296"></a><a class="code" href="spu-tdep_8c.html#a4a3ef6106278ce966ba1b6feb42d9979">01296</a> <a class="code" href="spu-tdep_8c.html#a4a3ef6106278ce966ba1b6feb42d9979">spu_value_to_regcache</a> (<span class="keyword">struct</span> <a class="code" href="structregcache.html">regcache</a> *<a class="code" href="structregcache.html">regcache</a>, <span class="keywordtype">int</span> <a class="code" href="aarch64-tdep_8c.html#a6b3d1ad0bca4067ccaef1366bea0db04">regnum</a>,
<a name="l01297"></a>01297                        <span class="keyword">struct</span> <a class="code" href="structtype.html">type</a> *<a class="code" href="structtype.html">type</a>, <span class="keyword">const</span> <a class="code" href="defs_8h.html#a336b399b3b83dbcc61f176c33f26b607">gdb_byte</a> *in)
<a name="l01298"></a>01298 {
<a name="l01299"></a>01299   <span class="keywordtype">int</span> <a class="code" href="exec_8h.html#a00f945351279d3c8935f13d2b9f9b808">len</a> = <a class="code" href="gdbtypes_8h.html#aeac33f868e763780094aec8a2dcb9a1a">TYPE_LENGTH</a> (type);
<a name="l01300"></a>01300 
<a name="l01301"></a>01301   <span class="keywordflow">if</span> (<a class="code" href="spu-tdep_8c.html#aa447fe749987ba9a7b81f3961bfd7197">spu_scalar_value_p</a> (type))
<a name="l01302"></a>01302     {
<a name="l01303"></a>01303       <span class="keywordtype">int</span> preferred_slot = len &lt; 4 ? 4 - len : 0;
<a name="l01304"></a>01304       <a class="code" href="regcache_8c.html#a722867e06f34f859c10d2c3e175f4519">regcache_cooked_write_part</a> (regcache, regnum, preferred_slot, len, in);
<a name="l01305"></a>01305     }
<a name="l01306"></a>01306   <span class="keywordflow">else</span>
<a name="l01307"></a>01307     {
<a name="l01308"></a>01308       <span class="keywordflow">while</span> (len &gt;= 16)
<a name="l01309"></a>01309         {
<a name="l01310"></a>01310           <a class="code" href="regcache_8c.html#a25a43a21da95fa740c8efca31cf61d56">regcache_cooked_write</a> (regcache, regnum++, in);
<a name="l01311"></a>01311           in += 16;
<a name="l01312"></a>01312           len -= 16;
<a name="l01313"></a>01313         }
<a name="l01314"></a>01314 
<a name="l01315"></a>01315       <span class="keywordflow">if</span> (len &gt; 0)
<a name="l01316"></a>01316         <a class="code" href="regcache_8c.html#a722867e06f34f859c10d2c3e175f4519">regcache_cooked_write_part</a> (regcache, regnum, 0, len, in);
<a name="l01317"></a>01317     }
<a name="l01318"></a>01318 }
<a name="l01319"></a>01319 
<a name="l01320"></a>01320 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01321"></a><a class="code" href="spu-tdep_8c.html#a611833bea78ff4be711e0d8906d3d257">01321</a> <a class="code" href="spu-tdep_8c.html#a611833bea78ff4be711e0d8906d3d257">spu_regcache_to_value</a> (<span class="keyword">struct</span> <a class="code" href="structregcache.html">regcache</a> *<a class="code" href="structregcache.html">regcache</a>, <span class="keywordtype">int</span> <a class="code" href="aarch64-tdep_8c.html#a6b3d1ad0bca4067ccaef1366bea0db04">regnum</a>,
<a name="l01322"></a>01322                        <span class="keyword">struct</span> <a class="code" href="structtype.html">type</a> *<a class="code" href="structtype.html">type</a>, <a class="code" href="defs_8h.html#a336b399b3b83dbcc61f176c33f26b607">gdb_byte</a> *out)
<a name="l01323"></a>01323 {
<a name="l01324"></a>01324   <span class="keywordtype">int</span> <a class="code" href="exec_8h.html#a00f945351279d3c8935f13d2b9f9b808">len</a> = <a class="code" href="gdbtypes_8h.html#aeac33f868e763780094aec8a2dcb9a1a">TYPE_LENGTH</a> (type);
<a name="l01325"></a>01325 
<a name="l01326"></a>01326   <span class="keywordflow">if</span> (<a class="code" href="spu-tdep_8c.html#aa447fe749987ba9a7b81f3961bfd7197">spu_scalar_value_p</a> (type))
<a name="l01327"></a>01327     {
<a name="l01328"></a>01328       <span class="keywordtype">int</span> preferred_slot = len &lt; 4 ? 4 - len : 0;
<a name="l01329"></a>01329       <a class="code" href="regcache_8c.html#a0df90ba73f76a25dbbd99903a5b57a27">regcache_cooked_read_part</a> (regcache, regnum, preferred_slot, len, out);
<a name="l01330"></a>01330     }
<a name="l01331"></a>01331   <span class="keywordflow">else</span>
<a name="l01332"></a>01332     {
<a name="l01333"></a>01333       <span class="keywordflow">while</span> (len &gt;= 16)
<a name="l01334"></a>01334         {
<a name="l01335"></a>01335           <a class="code" href="regcache_8c.html#a7056a5ea585aa0938893952f52d95e2e">regcache_cooked_read</a> (regcache, regnum++, out);
<a name="l01336"></a>01336           out += 16;
<a name="l01337"></a>01337           len -= 16;
<a name="l01338"></a>01338         }
<a name="l01339"></a>01339 
<a name="l01340"></a>01340       <span class="keywordflow">if</span> (len &gt; 0)
<a name="l01341"></a>01341         <a class="code" href="regcache_8c.html#a0df90ba73f76a25dbbd99903a5b57a27">regcache_cooked_read_part</a> (regcache, regnum, 0, len, out);
<a name="l01342"></a>01342     }
<a name="l01343"></a>01343 }
<a name="l01344"></a>01344 
<a name="l01345"></a>01345 <span class="keyword">static</span> <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a>
<a name="l01346"></a><a class="code" href="spu-tdep_8c.html#a66feaa86c4753825f37064b384394300">01346</a> <a class="code" href="spu-tdep_8c.html#a66feaa86c4753825f37064b384394300">spu_push_dummy_call</a> (<span class="keyword">struct</span> <a class="code" href="structgdbarch.html">gdbarch</a> *<a class="code" href="structgdbarch.html">gdbarch</a>, <span class="keyword">struct</span> <a class="code" href="structvalue.html">value</a> *<span class="keyword">function</span>,
<a name="l01347"></a>01347                      <span class="keyword">struct</span> <a class="code" href="structregcache.html">regcache</a> *<a class="code" href="structregcache.html">regcache</a>, <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> bp_addr,
<a name="l01348"></a>01348                      <span class="keywordtype">int</span> nargs, <span class="keyword">struct</span> <a class="code" href="structvalue.html">value</a> **args, <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> sp,
<a name="l01349"></a>01349                      <span class="keywordtype">int</span> <a class="code" href="arm-tdep_8h.html#aabb639d85dec2f973451bb1e7b6d1be8">struct_return</a>, <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> struct_addr)
<a name="l01350"></a>01350 {
<a name="l01351"></a>01351   <span class="keyword">enum</span> bfd_endian byte_order = <a class="code" href="gdbarch_8c.html#abc300a3797421aa7342b288e1637483e">gdbarch_byte_order</a> (gdbarch);
<a name="l01352"></a>01352   <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> sp_delta;
<a name="l01353"></a>01353   <span class="keywordtype">int</span> i;
<a name="l01354"></a>01354   <span class="keywordtype">int</span> <a class="code" href="aarch64-tdep_8c.html#a6b3d1ad0bca4067ccaef1366bea0db04">regnum</a> = <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4ca44bae8a2f02334705b5a16261f7b3450">SPU_ARG1_REGNUM</a>;
<a name="l01355"></a>01355   <span class="keywordtype">int</span> stack_arg = -1;
<a name="l01356"></a>01356   <a class="code" href="defs_8h.html#a336b399b3b83dbcc61f176c33f26b607">gdb_byte</a> buf[16];
<a name="l01357"></a>01357 
<a name="l01358"></a>01358   <span class="comment">/* Set the return address.  */</span>
<a name="l01359"></a>01359   <a class="code" href="gdb__string_8h.html#adb03df3679ce1445e801310614624ccb">memset</a> (buf, 0, <span class="keyword">sizeof</span> buf);
<a name="l01360"></a>01360   <a class="code" href="defs_8h.html#ad11c013c83c64d9d0ee2e4bdeb1fb62d">store_unsigned_integer</a> (buf, 4, byte_order, <a class="code" href="spu-tdep_8h.html#a774f32c94d1e14fd951edbf335cd0c51">SPUADDR_ADDR</a> (bp_addr));
<a name="l01361"></a>01361   <a class="code" href="regcache_8c.html#a25a43a21da95fa740c8efca31cf61d56">regcache_cooked_write</a> (regcache, <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4ca86906770085d81bb98f13de00851ac1f">SPU_LR_REGNUM</a>, buf);
<a name="l01362"></a>01362 
<a name="l01363"></a>01363   <span class="comment">/* If STRUCT_RETURN is true, then the struct return address (in</span>
<a name="l01364"></a>01364 <span class="comment">     STRUCT_ADDR) will consume the first argument-passing register.</span>
<a name="l01365"></a>01365 <span class="comment">     Both adjust the register count and store that value.  */</span>
<a name="l01366"></a>01366   <span class="keywordflow">if</span> (struct_return)
<a name="l01367"></a>01367     {
<a name="l01368"></a>01368       <a class="code" href="gdb__string_8h.html#adb03df3679ce1445e801310614624ccb">memset</a> (buf, 0, <span class="keyword">sizeof</span> buf);
<a name="l01369"></a>01369       <a class="code" href="defs_8h.html#ad11c013c83c64d9d0ee2e4bdeb1fb62d">store_unsigned_integer</a> (buf, 4, byte_order, <a class="code" href="spu-tdep_8h.html#a774f32c94d1e14fd951edbf335cd0c51">SPUADDR_ADDR</a> (struct_addr));
<a name="l01370"></a>01370       <a class="code" href="regcache_8c.html#a25a43a21da95fa740c8efca31cf61d56">regcache_cooked_write</a> (regcache, regnum++, buf);
<a name="l01371"></a>01371     }
<a name="l01372"></a>01372 
<a name="l01373"></a>01373   <span class="comment">/* Fill in argument registers.  */</span>
<a name="l01374"></a>01374   <span class="keywordflow">for</span> (i = 0; i &lt; nargs; i++)
<a name="l01375"></a>01375     {
<a name="l01376"></a>01376       <span class="keyword">struct </span><a class="code" href="structvalue.html">value</a> *arg = args[i];
<a name="l01377"></a>01377       <span class="keyword">struct </span><a class="code" href="structtype.html">type</a> *<a class="code" href="structtype.html">type</a> = <a class="code" href="gdbtypes_8c.html#a0bf29d7521d8a8b8735b9a259e380386">check_typedef</a> (<a class="code" href="value_8c.html#a263a4c0bee0b0df41074b952d3c121d0">value_type</a> (arg));
<a name="l01378"></a>01378       <span class="keyword">const</span> <a class="code" href="defs_8h.html#a336b399b3b83dbcc61f176c33f26b607">gdb_byte</a> *contents = <a class="code" href="value_8c.html#ad41a6de8fde15c01e1ffabb603c4f108">value_contents</a> (arg);
<a name="l01379"></a>01379       <span class="keywordtype">int</span> n_regs = <a class="code" href="utils_8c.html#a1597f2e569978430feec3d64b5e4caa6">align_up</a> (<a class="code" href="gdbtypes_8h.html#aeac33f868e763780094aec8a2dcb9a1a">TYPE_LENGTH</a> (type), 16) / 16;
<a name="l01380"></a>01380 
<a name="l01381"></a>01381       <span class="comment">/* If the argument doesn&#39;t wholly fit into registers, it and</span>
<a name="l01382"></a>01382 <span class="comment">         all subsequent arguments go to the stack.  */</span>
<a name="l01383"></a>01383       <span class="keywordflow">if</span> (regnum + n_regs - 1 &gt; <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4caaedd9ea6d22a059eb9eb24899a08fd9d">SPU_ARGN_REGNUM</a>)
<a name="l01384"></a>01384         {
<a name="l01385"></a>01385           stack_arg = i;
<a name="l01386"></a>01386           <span class="keywordflow">break</span>;
<a name="l01387"></a>01387         }
<a name="l01388"></a>01388 
<a name="l01389"></a>01389       <a class="code" href="spu-tdep_8c.html#a4a3ef6106278ce966ba1b6feb42d9979">spu_value_to_regcache</a> (regcache, regnum, type, contents);
<a name="l01390"></a>01390       regnum += n_regs;
<a name="l01391"></a>01391     }
<a name="l01392"></a>01392 
<a name="l01393"></a>01393   <span class="comment">/* Overflow arguments go to the stack.  */</span>
<a name="l01394"></a>01394   <span class="keywordflow">if</span> (stack_arg != -1)
<a name="l01395"></a>01395     {
<a name="l01396"></a>01396       <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> ap;
<a name="l01397"></a>01397 
<a name="l01398"></a>01398       <span class="comment">/* Allocate all required stack size.  */</span>
<a name="l01399"></a>01399       <span class="keywordflow">for</span> (i = stack_arg; i &lt; nargs; i++)
<a name="l01400"></a>01400         {
<a name="l01401"></a>01401           <span class="keyword">struct </span><a class="code" href="structtype.html">type</a> *<a class="code" href="structtype.html">type</a> = <a class="code" href="gdbtypes_8c.html#a0bf29d7521d8a8b8735b9a259e380386">check_typedef</a> (<a class="code" href="value_8c.html#a263a4c0bee0b0df41074b952d3c121d0">value_type</a> (args[i]));
<a name="l01402"></a>01402           sp -= <a class="code" href="utils_8c.html#a1597f2e569978430feec3d64b5e4caa6">align_up</a> (<a class="code" href="gdbtypes_8h.html#aeac33f868e763780094aec8a2dcb9a1a">TYPE_LENGTH</a> (type), 16);
<a name="l01403"></a>01403         }
<a name="l01404"></a>01404 
<a name="l01405"></a>01405       <span class="comment">/* Fill in stack arguments.  */</span>
<a name="l01406"></a>01406       ap = sp;
<a name="l01407"></a>01407       <span class="keywordflow">for</span> (i = stack_arg; i &lt; nargs; i++)
<a name="l01408"></a>01408         {
<a name="l01409"></a>01409           <span class="keyword">struct </span><a class="code" href="structvalue.html">value</a> *arg = args[i];
<a name="l01410"></a>01410           <span class="keyword">struct </span><a class="code" href="structtype.html">type</a> *<a class="code" href="structtype.html">type</a> = <a class="code" href="gdbtypes_8c.html#a0bf29d7521d8a8b8735b9a259e380386">check_typedef</a> (<a class="code" href="value_8c.html#a263a4c0bee0b0df41074b952d3c121d0">value_type</a> (arg));
<a name="l01411"></a>01411           <span class="keywordtype">int</span> <a class="code" href="exec_8h.html#a00f945351279d3c8935f13d2b9f9b808">len</a> = <a class="code" href="gdbtypes_8h.html#aeac33f868e763780094aec8a2dcb9a1a">TYPE_LENGTH</a> (type);
<a name="l01412"></a>01412           <span class="keywordtype">int</span> preferred_slot;
<a name="l01413"></a>01413           
<a name="l01414"></a>01414           <span class="keywordflow">if</span> (<a class="code" href="spu-tdep_8c.html#aa447fe749987ba9a7b81f3961bfd7197">spu_scalar_value_p</a> (type))
<a name="l01415"></a>01415             preferred_slot = len &lt; 4 ? 4 - len : 0;
<a name="l01416"></a>01416           <span class="keywordflow">else</span>
<a name="l01417"></a>01417             preferred_slot = 0;
<a name="l01418"></a>01418 
<a name="l01419"></a>01419           <a class="code" href="target_8c.html#a7bd38b77fbf87c003396742f775dd2d4">target_write_memory</a> (ap + preferred_slot, <a class="code" href="value_8c.html#ad41a6de8fde15c01e1ffabb603c4f108">value_contents</a> (arg), len);
<a name="l01420"></a>01420           ap += <a class="code" href="utils_8c.html#a1597f2e569978430feec3d64b5e4caa6">align_up</a> (<a class="code" href="gdbtypes_8h.html#aeac33f868e763780094aec8a2dcb9a1a">TYPE_LENGTH</a> (type), 16);
<a name="l01421"></a>01421         }
<a name="l01422"></a>01422     }
<a name="l01423"></a>01423 
<a name="l01424"></a>01424   <span class="comment">/* Allocate stack frame header.  */</span>
<a name="l01425"></a>01425   sp -= 32;
<a name="l01426"></a>01426 
<a name="l01427"></a>01427   <span class="comment">/* Store stack back chain.  */</span>
<a name="l01428"></a>01428   <a class="code" href="regcache_8c.html#a7056a5ea585aa0938893952f52d95e2e">regcache_cooked_read</a> (regcache, <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4caa2793092717e5a3149a148e738f44a53">SPU_RAW_SP_REGNUM</a>, buf);
<a name="l01429"></a>01429   <a class="code" href="target_8c.html#a7bd38b77fbf87c003396742f775dd2d4">target_write_memory</a> (sp, buf, 16);
<a name="l01430"></a>01430 
<a name="l01431"></a>01431   <span class="comment">/* Finally, update all slots of the SP register.  */</span>
<a name="l01432"></a>01432   sp_delta = sp - <a class="code" href="defs_8h.html#a99aec65329508b4d449a4f881026f844">extract_unsigned_integer</a> (buf, 4, byte_order);
<a name="l01433"></a>01433   <span class="keywordflow">for</span> (i = 0; i &lt; 4; i++)
<a name="l01434"></a>01434     {
<a name="l01435"></a>01435       <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> sp_slot = <a class="code" href="defs_8h.html#a99aec65329508b4d449a4f881026f844">extract_unsigned_integer</a> (buf + 4*i, 4, byte_order);
<a name="l01436"></a>01436       <a class="code" href="defs_8h.html#ad11c013c83c64d9d0ee2e4bdeb1fb62d">store_unsigned_integer</a> (buf + 4*i, 4, byte_order, sp_slot + sp_delta);
<a name="l01437"></a>01437     }
<a name="l01438"></a>01438   <a class="code" href="regcache_8c.html#a25a43a21da95fa740c8efca31cf61d56">regcache_cooked_write</a> (regcache, <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4caa2793092717e5a3149a148e738f44a53">SPU_RAW_SP_REGNUM</a>, buf);
<a name="l01439"></a>01439 
<a name="l01440"></a>01440   <span class="keywordflow">return</span> sp;
<a name="l01441"></a>01441 }
<a name="l01442"></a>01442 
<a name="l01443"></a>01443 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structframe__id.html">frame_id</a>
<a name="l01444"></a><a class="code" href="spu-tdep_8c.html#a66ed1a8781f95b51c78ade30c6985cfb">01444</a> <a class="code" href="spu-tdep_8c.html#a66ed1a8781f95b51c78ade30c6985cfb">spu_dummy_id</a> (struct <a class="code" href="structgdbarch.html">gdbarch</a> *<a class="code" href="structgdbarch.html">gdbarch</a>, <span class="keyword">struct </span><a class="code" href="structframe__info.html">frame_info</a> *this_frame)
<a name="l01445"></a>01445 {
<a name="l01446"></a>01446   <span class="keyword">struct </span><a class="code" href="structgdbarch__tdep.html">gdbarch_tdep</a> *tdep = <a class="code" href="gdbarch_8c.html#acea996b7421706849bc20567695b5b31">gdbarch_tdep</a> (gdbarch);
<a name="l01447"></a>01447   <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> <a class="code" href="structgdbarch__tdep.html#ab7a207d4e85b564c48238283745247b8">pc</a> = <a class="code" href="frame_8c.html#affa785e8937e96fd727e46a2cfec94c4">get_frame_register_unsigned</a> (this_frame, <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4cac5c6ca5984213bd79f0060b49caef630">SPU_PC_REGNUM</a>);
<a name="l01448"></a>01448   <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> <a class="code" href="structgdbarch__tdep.html#a6c9a3fc3be4039b5ccd626c50ebcb2fd">sp</a> = <a class="code" href="frame_8c.html#affa785e8937e96fd727e46a2cfec94c4">get_frame_register_unsigned</a> (this_frame, <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4ca4d2edf1cf9cd8c1c52cde68536a2c45d">SPU_SP_REGNUM</a>);
<a name="l01449"></a>01449   <span class="keywordflow">return</span> <a class="code" href="frame_8c.html#a7f32da6ddc275b4684c301448d891f5b">frame_id_build</a> (<a class="code" href="spu-tdep_8h.html#a9dd6343d7c2ebf90bf29d78289bdb110">SPUADDR</a> (tdep-&gt;<a class="code" href="structgdbarch__tdep.html#a6c04333e4962a9690dea1334a6201d30">id</a>, sp), <a class="code" href="spu-tdep_8h.html#a9dd6343d7c2ebf90bf29d78289bdb110">SPUADDR</a> (tdep-&gt;<a class="code" href="structgdbarch__tdep.html#a6c04333e4962a9690dea1334a6201d30">id</a>, pc &amp; -4));
<a name="l01450"></a>01450 }
<a name="l01451"></a>01451 
<a name="l01452"></a>01452 <span class="comment">/* Function return value access.  */</span>
<a name="l01453"></a>01453 
<a name="l01454"></a>01454 <span class="keyword">static</span> <span class="keyword">enum</span> <a class="code" href="defs_8h.html#ad73ff2db888df8f297b907f7093082a5">return_value_convention</a>
<a name="l01455"></a><a class="code" href="spu-tdep_8c.html#ace219b3a4937b222c91e9b6137e464f3">01455</a> <a class="code" href="spu-tdep_8c.html#ace219b3a4937b222c91e9b6137e464f3">spu_return_value</a> (<span class="keyword">struct</span> gdbarch *gdbarch, <span class="keyword">struct</span> <a class="code" href="structvalue.html">value</a> *<span class="keyword">function</span>,
<a name="l01456"></a>01456                   <span class="keyword">struct</span> <a class="code" href="structtype.html">type</a> *<a class="code" href="structtype.html">type</a>, <span class="keyword">struct</span> <a class="code" href="structregcache.html">regcache</a> *<a class="code" href="structregcache.html">regcache</a>,
<a name="l01457"></a>01457                   <a class="code" href="defs_8h.html#a336b399b3b83dbcc61f176c33f26b607">gdb_byte</a> *out, <span class="keyword">const</span> <a class="code" href="defs_8h.html#a336b399b3b83dbcc61f176c33f26b607">gdb_byte</a> *in)
<a name="l01458"></a>01458 {
<a name="l01459"></a>01459   <span class="keyword">struct </span>type *<a class="code" href="structfunc__type.html">func_type</a> = <span class="keyword">function</span> ? <a class="code" href="value_8c.html#a263a4c0bee0b0df41074b952d3c121d0">value_type</a> (<span class="keyword">function</span>) : NULL;
<a name="l01460"></a>01460   <span class="keyword">enum</span> <a class="code" href="defs_8h.html#ad73ff2db888df8f297b907f7093082a5">return_value_convention</a> rvc;
<a name="l01461"></a>01461   <span class="keywordtype">int</span> opencl_vector = 0;
<a name="l01462"></a>01462 
<a name="l01463"></a>01463   <span class="keywordflow">if</span> (func_type)
<a name="l01464"></a>01464     {
<a name="l01465"></a>01465       func_type = <a class="code" href="gdbtypes_8c.html#a0bf29d7521d8a8b8735b9a259e380386">check_typedef</a> (func_type);
<a name="l01466"></a>01466 
<a name="l01467"></a>01467       <span class="keywordflow">if</span> (<a class="code" href="gdbtypes_8h.html#a9505f41c7012665947c6b4065ce190e1">TYPE_CODE</a> (func_type) == <a class="code" href="gdbtypes_8h.html#a90e2a0fddaa6afff6a0a489ff4da3462a1a639160f3e3a2f9f7ac55255942c581">TYPE_CODE_PTR</a>)
<a name="l01468"></a>01468         func_type = <a class="code" href="gdbtypes_8c.html#a0bf29d7521d8a8b8735b9a259e380386">check_typedef</a> (<a class="code" href="gdbtypes_8h.html#a87a33d723acd28a033e63c4297c6c916">TYPE_TARGET_TYPE</a> (func_type));
<a name="l01469"></a>01469 
<a name="l01470"></a>01470       <span class="keywordflow">if</span> (<a class="code" href="gdbtypes_8h.html#a9505f41c7012665947c6b4065ce190e1">TYPE_CODE</a> (func_type) == <a class="code" href="gdbtypes_8h.html#a90e2a0fddaa6afff6a0a489ff4da3462a4b6327934915849a4e96eef151fe312b">TYPE_CODE_FUNC</a>
<a name="l01471"></a>01471           &amp;&amp; <a class="code" href="gdbtypes_8h.html#a80f847a96456b925bec1116fe39f69dc">TYPE_CALLING_CONVENTION</a> (func_type) == DW_CC_GDB_IBM_OpenCL
<a name="l01472"></a>01472           &amp;&amp; <a class="code" href="gdbtypes_8h.html#a9505f41c7012665947c6b4065ce190e1">TYPE_CODE</a> (type) == <a class="code" href="gdbtypes_8h.html#a90e2a0fddaa6afff6a0a489ff4da3462a00c795b43d1a39f57d3e222385f14fc0">TYPE_CODE_ARRAY</a>
<a name="l01473"></a>01473           &amp;&amp; <a class="code" href="gdbtypes_8h.html#a68a23253bcb233221400208f4c21c406">TYPE_VECTOR</a> (type))
<a name="l01474"></a>01474         opencl_vector = 1;
<a name="l01475"></a>01475     }
<a name="l01476"></a>01476 
<a name="l01477"></a>01477   <span class="keywordflow">if</span> (<a class="code" href="gdbtypes_8h.html#aeac33f868e763780094aec8a2dcb9a1a">TYPE_LENGTH</a> (type) &lt;= (<a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4caaedd9ea6d22a059eb9eb24899a08fd9d">SPU_ARGN_REGNUM</a> - <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4ca44bae8a2f02334705b5a16261f7b3450">SPU_ARG1_REGNUM</a> + 1) * 16)
<a name="l01478"></a>01478     rvc = <a class="code" href="defs_8h.html#ad73ff2db888df8f297b907f7093082a5a0cd14b7546740080384acc0c7e5caf3b">RETURN_VALUE_REGISTER_CONVENTION</a>;
<a name="l01479"></a>01479   <span class="keywordflow">else</span>
<a name="l01480"></a>01480     rvc = <a class="code" href="defs_8h.html#ad73ff2db888df8f297b907f7093082a5a1fab6a0bfd44af88ba17a143673dc937">RETURN_VALUE_STRUCT_CONVENTION</a>;
<a name="l01481"></a>01481 
<a name="l01482"></a>01482   <span class="keywordflow">if</span> (in)
<a name="l01483"></a>01483     {
<a name="l01484"></a>01484       <span class="keywordflow">switch</span> (rvc)
<a name="l01485"></a>01485         {
<a name="l01486"></a>01486         <span class="keywordflow">case</span> <a class="code" href="defs_8h.html#ad73ff2db888df8f297b907f7093082a5a0cd14b7546740080384acc0c7e5caf3b">RETURN_VALUE_REGISTER_CONVENTION</a>:
<a name="l01487"></a>01487           <span class="keywordflow">if</span> (opencl_vector &amp;&amp; <a class="code" href="gdbtypes_8h.html#aeac33f868e763780094aec8a2dcb9a1a">TYPE_LENGTH</a> (type) == 2)
<a name="l01488"></a>01488             <a class="code" href="regcache_8c.html#a722867e06f34f859c10d2c3e175f4519">regcache_cooked_write_part</a> (regcache, <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4ca44bae8a2f02334705b5a16261f7b3450">SPU_ARG1_REGNUM</a>, 2, 2, in);
<a name="l01489"></a>01489           <span class="keywordflow">else</span>
<a name="l01490"></a>01490             <a class="code" href="spu-tdep_8c.html#a4a3ef6106278ce966ba1b6feb42d9979">spu_value_to_regcache</a> (regcache, <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4ca44bae8a2f02334705b5a16261f7b3450">SPU_ARG1_REGNUM</a>, type, in);
<a name="l01491"></a>01491           <span class="keywordflow">break</span>;
<a name="l01492"></a>01492 
<a name="l01493"></a>01493         <span class="keywordflow">case</span> <a class="code" href="defs_8h.html#ad73ff2db888df8f297b907f7093082a5a1fab6a0bfd44af88ba17a143673dc937">RETURN_VALUE_STRUCT_CONVENTION</a>:
<a name="l01494"></a>01494           <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Cannot set function return value.&quot;</span>));
<a name="l01495"></a>01495           <span class="keywordflow">break</span>;
<a name="l01496"></a>01496         }
<a name="l01497"></a>01497     }
<a name="l01498"></a>01498   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (out)
<a name="l01499"></a>01499     {
<a name="l01500"></a>01500       <span class="keywordflow">switch</span> (rvc)
<a name="l01501"></a>01501         {
<a name="l01502"></a>01502         <span class="keywordflow">case</span> <a class="code" href="defs_8h.html#ad73ff2db888df8f297b907f7093082a5a0cd14b7546740080384acc0c7e5caf3b">RETURN_VALUE_REGISTER_CONVENTION</a>:
<a name="l01503"></a>01503           <span class="keywordflow">if</span> (opencl_vector &amp;&amp; <a class="code" href="gdbtypes_8h.html#aeac33f868e763780094aec8a2dcb9a1a">TYPE_LENGTH</a> (type) == 2)
<a name="l01504"></a>01504             <a class="code" href="regcache_8c.html#a0df90ba73f76a25dbbd99903a5b57a27">regcache_cooked_read_part</a> (regcache, <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4ca44bae8a2f02334705b5a16261f7b3450">SPU_ARG1_REGNUM</a>, 2, 2, out);
<a name="l01505"></a>01505           <span class="keywordflow">else</span>
<a name="l01506"></a>01506             <a class="code" href="spu-tdep_8c.html#a611833bea78ff4be711e0d8906d3d257">spu_regcache_to_value</a> (regcache, <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4ca44bae8a2f02334705b5a16261f7b3450">SPU_ARG1_REGNUM</a>, type, out);
<a name="l01507"></a>01507           <span class="keywordflow">break</span>;
<a name="l01508"></a>01508 
<a name="l01509"></a>01509         <span class="keywordflow">case</span> <a class="code" href="defs_8h.html#ad73ff2db888df8f297b907f7093082a5a1fab6a0bfd44af88ba17a143673dc937">RETURN_VALUE_STRUCT_CONVENTION</a>:
<a name="l01510"></a>01510           <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Function return value unknown.&quot;</span>));
<a name="l01511"></a>01511           <span class="keywordflow">break</span>;
<a name="l01512"></a>01512         }
<a name="l01513"></a>01513     }
<a name="l01514"></a>01514 
<a name="l01515"></a>01515   <span class="keywordflow">return</span> rvc;
<a name="l01516"></a>01516 }
<a name="l01517"></a>01517 
<a name="l01518"></a>01518 
<a name="l01519"></a>01519 <span class="comment">/* Breakpoints.  */</span>
<a name="l01520"></a>01520 
<a name="l01521"></a>01521 <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="defs_8h.html#a336b399b3b83dbcc61f176c33f26b607">gdb_byte</a> *
<a name="l01522"></a><a class="code" href="spu-tdep_8c.html#af104778760276c04eba2bad4db341fdb">01522</a> <a class="code" href="spu-tdep_8c.html#af104778760276c04eba2bad4db341fdb">spu_breakpoint_from_pc</a> (<span class="keyword">struct</span> gdbarch *gdbarch,
<a name="l01523"></a>01523                         <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> * pcptr, <span class="keywordtype">int</span> *lenptr)
<a name="l01524"></a>01524 {
<a name="l01525"></a>01525   <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="defs_8h.html#a336b399b3b83dbcc61f176c33f26b607">gdb_byte</a> <a class="code" href="structbreakpoint.html">breakpoint</a>[] = { 0x00, 0x00, 0x3f, 0xff };
<a name="l01526"></a>01526 
<a name="l01527"></a>01527   *lenptr = <span class="keyword">sizeof</span> breakpoint;
<a name="l01528"></a>01528   <span class="keywordflow">return</span> breakpoint;
<a name="l01529"></a>01529 }
<a name="l01530"></a>01530 
<a name="l01531"></a>01531 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l01532"></a><a class="code" href="spu-tdep_8c.html#a8ba4f52f5196b027cd146ccdc78a6c98">01532</a> <a class="code" href="spu-tdep_8c.html#a8ba4f52f5196b027cd146ccdc78a6c98">spu_memory_remove_breakpoint</a> (<span class="keyword">struct</span> gdbarch *gdbarch,
<a name="l01533"></a>01533                               <span class="keyword">struct</span> <a class="code" href="structbp__target__info.html">bp_target_info</a> *bp_tgt)
<a name="l01534"></a>01534 {
<a name="l01535"></a>01535   <span class="comment">/* We work around a problem in combined Cell/B.E. debugging here.  Consider</span>
<a name="l01536"></a>01536 <span class="comment">     that in a combined application, we have some breakpoints inserted in SPU</span>
<a name="l01537"></a>01537 <span class="comment">     code, and now the application forks (on the PPU side).  GDB common code</span>
<a name="l01538"></a>01538 <span class="comment">     will assume that the fork system call copied all breakpoints into the new</span>
<a name="l01539"></a>01539 <span class="comment">     process&#39; address space, and that all those copies now need to be removed</span>
<a name="l01540"></a>01540 <span class="comment">     (see breakpoint.c:detach_breakpoints).</span>
<a name="l01541"></a>01541 <span class="comment"></span>
<a name="l01542"></a>01542 <span class="comment">     While this is certainly true for PPU side breakpoints, it is not true</span>
<a name="l01543"></a>01543 <span class="comment">     for SPU side breakpoints.  fork will clone the SPU context file</span>
<a name="l01544"></a>01544 <span class="comment">     descriptors, so that all the existing SPU contexts are in accessible</span>
<a name="l01545"></a>01545 <span class="comment">     in the new process.  However, the contents of the SPU contexts themselves</span>
<a name="l01546"></a>01546 <span class="comment">     are *not* cloned.  Therefore the effect of detach_breakpoints is to</span>
<a name="l01547"></a>01547 <span class="comment">     remove SPU breakpoints from the *original* SPU context&#39;s local store</span>
<a name="l01548"></a>01548 <span class="comment">     -- this is not the correct behaviour.</span>
<a name="l01549"></a>01549 <span class="comment"></span>
<a name="l01550"></a>01550 <span class="comment">     The workaround is to check whether the PID we are asked to remove this</span>
<a name="l01551"></a>01551 <span class="comment">     breakpoint from (i.e. ptid_get_pid (inferior_ptid)) is different from the</span>
<a name="l01552"></a>01552 <span class="comment">     PID of the current inferior (i.e. current_inferior ()-&gt;pid).  This is only</span>
<a name="l01553"></a>01553 <span class="comment">     true in the context of detach_breakpoints.  If so, we simply do nothing.</span>
<a name="l01554"></a>01554 <span class="comment">     [ Note that for the fork child process, it does not matter if breakpoints</span>
<a name="l01555"></a>01555 <span class="comment">     remain inserted, because those SPU contexts are not runnable anyway --</span>
<a name="l01556"></a>01556 <span class="comment">     the Linux kernel allows only the original process to invoke spu_run.  */</span>
<a name="l01557"></a>01557 
<a name="l01558"></a>01558   <span class="keywordflow">if</span> (<a class="code" href="ptid_8c.html#a264ba40fc2a0cf3d4fb24a55fe32aede">ptid_get_pid</a> (<a class="code" href="infcmd_8c.html#a428c5be9ce5e70bd03760e828e19c6b7">inferior_ptid</a>) != <a class="code" href="inferior_8c.html#a9e592c83e7c0c1f89f1a4a392bd1a277">current_inferior</a> ()-&gt;pid) 
<a name="l01559"></a>01559     <span class="keywordflow">return</span> 0;
<a name="l01560"></a>01560 
<a name="l01561"></a>01561   <span class="keywordflow">return</span> <a class="code" href="mem-break_8c.html#a7f59ba4c2b9e2eb77476352267fdffc8">default_memory_remove_breakpoint</a> (gdbarch, bp_tgt);
<a name="l01562"></a>01562 }
<a name="l01563"></a>01563 
<a name="l01564"></a>01564 
<a name="l01565"></a>01565 <span class="comment">/* Software single-stepping support.  */</span>
<a name="l01566"></a>01566 
<a name="l01567"></a>01567 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l01568"></a><a class="code" href="spu-tdep_8c.html#a19a63bc48633bb1f909f0f30dba516b6">01568</a> <a class="code" href="spu-tdep_8c.html#a19a63bc48633bb1f909f0f30dba516b6">spu_software_single_step</a> (<span class="keyword">struct</span> <a class="code" href="structframe__info.html">frame_info</a> *frame)
<a name="l01569"></a>01569 {
<a name="l01570"></a>01570   <span class="keyword">struct </span>gdbarch *gdbarch = <a class="code" href="frame_8c.html#ab44507b5655da44e522ed5857835ede7">get_frame_arch</a> (frame);
<a name="l01571"></a>01571   <span class="keyword">struct </span><a class="code" href="structaddress__space.html">address_space</a> *aspace = <a class="code" href="frame_8c.html#abdf9824b7a32ae3a71b8de560a16bfe8">get_frame_address_space</a> (frame);
<a name="l01572"></a>01572   <span class="keyword">enum</span> bfd_endian byte_order = <a class="code" href="gdbarch_8c.html#abc300a3797421aa7342b288e1637483e">gdbarch_byte_order</a> (gdbarch);
<a name="l01573"></a>01573   <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> pc, next_pc;
<a name="l01574"></a>01574   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> insn;
<a name="l01575"></a>01575   <span class="keywordtype">int</span> <a class="code" href="common_2agent_8c.html#aed7ea92f45bd273dde380a45ddced592">offset</a>, <a class="code" href="structreg.html">reg</a>;
<a name="l01576"></a>01576   <a class="code" href="defs_8h.html#a336b399b3b83dbcc61f176c33f26b607">gdb_byte</a> buf[4];
<a name="l01577"></a>01577   <a class="code" href="defs_8h.html#a4df4af8771b1016a24976757026f4984">ULONGEST</a> lslr;
<a name="l01578"></a>01578 
<a name="l01579"></a>01579   pc = <a class="code" href="frame_8c.html#a27aafb00e05cba145dfba0e4bc7b1d70">get_frame_pc</a> (frame);
<a name="l01580"></a>01580 
<a name="l01581"></a>01581   <span class="keywordflow">if</span> (<a class="code" href="target_8c.html#ac579515fbccfb9e6b1a45766a71c1d4f">target_read_memory</a> (pc, buf, 4))
<a name="l01582"></a>01582     <span class="keywordflow">return</span> 1;
<a name="l01583"></a>01583   insn = <a class="code" href="defs_8h.html#a99aec65329508b4d449a4f881026f844">extract_unsigned_integer</a> (buf, 4, byte_order);
<a name="l01584"></a>01584 
<a name="l01585"></a>01585   <span class="comment">/* Get local store limit.  */</span>
<a name="l01586"></a>01586   lslr = <a class="code" href="frame_8c.html#affa785e8937e96fd727e46a2cfec94c4">get_frame_register_unsigned</a> (frame, <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4caecf4c88f627410a19e73e47634c38b03">SPU_LSLR_REGNUM</a>);
<a name="l01587"></a>01587   <span class="keywordflow">if</span> (!lslr)
<a name="l01588"></a>01588     lslr = (<a class="code" href="defs_8h.html#a4df4af8771b1016a24976757026f4984">ULONGEST</a>) -1;
<a name="l01589"></a>01589 
<a name="l01590"></a>01590   <span class="comment">/* Next sequential instruction is at PC + 4, except if the current</span>
<a name="l01591"></a>01591 <span class="comment">     instruction is a PPE-assisted call, in which case it is at PC + 8.</span>
<a name="l01592"></a>01592 <span class="comment">     Wrap around LS limit to be on the safe side.  */</span>
<a name="l01593"></a>01593   <span class="keywordflow">if</span> ((insn &amp; 0xffffff00) == 0x00002100)
<a name="l01594"></a>01594     next_pc = (<a class="code" href="spu-tdep_8h.html#a774f32c94d1e14fd951edbf335cd0c51">SPUADDR_ADDR</a> (pc) + 8) &amp; lslr;
<a name="l01595"></a>01595   <span class="keywordflow">else</span>
<a name="l01596"></a>01596     next_pc = (<a class="code" href="spu-tdep_8h.html#a774f32c94d1e14fd951edbf335cd0c51">SPUADDR_ADDR</a> (pc) + 4) &amp; lslr;
<a name="l01597"></a>01597 
<a name="l01598"></a>01598   <a class="code" href="breakpoint_8c.html#a8decd828f1a0042e3e40a1ed86940140">insert_single_step_breakpoint</a> (gdbarch,
<a name="l01599"></a>01599                                  aspace, <a class="code" href="spu-tdep_8h.html#a9dd6343d7c2ebf90bf29d78289bdb110">SPUADDR</a> (<a class="code" href="spu-tdep_8h.html#afafb4132b7fe5507e3c9ff629b54fcbb">SPUADDR_SPU</a> (pc), next_pc));
<a name="l01600"></a>01600 
<a name="l01601"></a>01601   <span class="keywordflow">if</span> (<a class="code" href="spu-tdep_8c.html#a9a9da19452acd9c01c0d3d98ed971126">is_branch</a> (insn, &amp;offset, &amp;reg))
<a name="l01602"></a>01602     {
<a name="l01603"></a>01603       <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> target = <a class="code" href="common_2agent_8c.html#aed7ea92f45bd273dde380a45ddced592">offset</a>;
<a name="l01604"></a>01604 
<a name="l01605"></a>01605       <span class="keywordflow">if</span> (reg == <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4cac5c6ca5984213bd79f0060b49caef630">SPU_PC_REGNUM</a>)
<a name="l01606"></a>01606         target += <a class="code" href="spu-tdep_8h.html#a774f32c94d1e14fd951edbf335cd0c51">SPUADDR_ADDR</a> (pc);
<a name="l01607"></a>01607       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (reg != -1)
<a name="l01608"></a>01608         {
<a name="l01609"></a>01609           <span class="keywordtype">int</span> optim, unavail;
<a name="l01610"></a>01610 
<a name="l01611"></a>01611           <span class="keywordflow">if</span> (<a class="code" href="frame_8c.html#a2a2fcb8f8afb97611547f3b62026dfed">get_frame_register_bytes</a> (frame, reg, 0, 4, buf,
<a name="l01612"></a>01612                                          &amp;optim, &amp;unavail))
<a name="l01613"></a>01613             target += <a class="code" href="defs_8h.html#a99aec65329508b4d449a4f881026f844">extract_unsigned_integer</a> (buf, 4, byte_order) &amp; -4;
<a name="l01614"></a>01614           <span class="keywordflow">else</span>
<a name="l01615"></a>01615             {
<a name="l01616"></a>01616               <span class="keywordflow">if</span> (optim)
<a name="l01617"></a>01617                 <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Could not determine address of &quot;</span>
<a name="l01618"></a>01618                          <span class="stringliteral">&quot;single-step breakpoint.&quot;</span>));
<a name="l01619"></a>01619               <span class="keywordflow">if</span> (unavail)
<a name="l01620"></a>01620                 <a class="code" href="exceptions_8c.html#a366e9b618421f1f94a3318e81cc0489c">throw_error</a> (<a class="code" href="exceptions_8h.html#acc42076253600be964e110149b458971ad5f524b407f1cb2d36cb365112de18c9">NOT_AVAILABLE_ERROR</a>,
<a name="l01621"></a>01621                              <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Could not determine address of &quot;</span>
<a name="l01622"></a>01622                                <span class="stringliteral">&quot;single-step breakpoint.&quot;</span>));
<a name="l01623"></a>01623             }
<a name="l01624"></a>01624         }
<a name="l01625"></a>01625 
<a name="l01626"></a>01626       target = target &amp; lslr;
<a name="l01627"></a>01627       <span class="keywordflow">if</span> (target != next_pc)
<a name="l01628"></a>01628         <a class="code" href="breakpoint_8c.html#a8decd828f1a0042e3e40a1ed86940140">insert_single_step_breakpoint</a> (gdbarch, aspace,
<a name="l01629"></a>01629                                        <a class="code" href="spu-tdep_8h.html#a9dd6343d7c2ebf90bf29d78289bdb110">SPUADDR</a> (<a class="code" href="spu-tdep_8h.html#afafb4132b7fe5507e3c9ff629b54fcbb">SPUADDR_SPU</a> (pc), target));
<a name="l01630"></a>01630     }
<a name="l01631"></a>01631 
<a name="l01632"></a>01632   <span class="keywordflow">return</span> 1;
<a name="l01633"></a>01633 }
<a name="l01634"></a>01634 
<a name="l01635"></a>01635 
<a name="l01636"></a>01636 <span class="comment">/* Longjmp support.  */</span>
<a name="l01637"></a>01637 
<a name="l01638"></a>01638 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l01639"></a><a class="code" href="spu-tdep_8c.html#a1d65f2bff6878ccf0b53c99684a15309">01639</a> <a class="code" href="spu-tdep_8c.html#a1d65f2bff6878ccf0b53c99684a15309">spu_get_longjmp_target</a> (<span class="keyword">struct</span> <a class="code" href="structframe__info.html">frame_info</a> *frame, <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> *pc)
<a name="l01640"></a>01640 {
<a name="l01641"></a>01641   <span class="keyword">struct </span>gdbarch *gdbarch = <a class="code" href="frame_8c.html#ab44507b5655da44e522ed5857835ede7">get_frame_arch</a> (frame);
<a name="l01642"></a>01642   <span class="keyword">struct </span><a class="code" href="structgdbarch__tdep.html">gdbarch_tdep</a> *tdep = <a class="code" href="gdbarch_8c.html#acea996b7421706849bc20567695b5b31">gdbarch_tdep</a> (gdbarch);
<a name="l01643"></a>01643   <span class="keyword">enum</span> bfd_endian byte_order = <a class="code" href="gdbarch_8c.html#abc300a3797421aa7342b288e1637483e">gdbarch_byte_order</a> (gdbarch);
<a name="l01644"></a>01644   <a class="code" href="defs_8h.html#a336b399b3b83dbcc61f176c33f26b607">gdb_byte</a> buf[4];
<a name="l01645"></a>01645   <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> jb_addr;
<a name="l01646"></a>01646   <span class="keywordtype">int</span> optim, unavail;
<a name="l01647"></a>01647 
<a name="l01648"></a>01648   <span class="comment">/* Jump buffer is pointed to by the argument register $r3.  */</span>
<a name="l01649"></a>01649   <span class="keywordflow">if</span> (!<a class="code" href="frame_8c.html#a2a2fcb8f8afb97611547f3b62026dfed">get_frame_register_bytes</a> (frame, <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4ca44bae8a2f02334705b5a16261f7b3450">SPU_ARG1_REGNUM</a>, 0, 4, buf,
<a name="l01650"></a>01650                                  &amp;optim, &amp;unavail))
<a name="l01651"></a>01651     <span class="keywordflow">return</span> 0;
<a name="l01652"></a>01652 
<a name="l01653"></a>01653   jb_addr = <a class="code" href="defs_8h.html#a99aec65329508b4d449a4f881026f844">extract_unsigned_integer</a> (buf, 4, byte_order);
<a name="l01654"></a>01654   <span class="keywordflow">if</span> (<a class="code" href="target_8c.html#ac579515fbccfb9e6b1a45766a71c1d4f">target_read_memory</a> (<a class="code" href="spu-tdep_8h.html#a9dd6343d7c2ebf90bf29d78289bdb110">SPUADDR</a> (tdep-&gt;<a class="code" href="structgdbarch__tdep.html#a6c04333e4962a9690dea1334a6201d30">id</a>, jb_addr), buf, 4))
<a name="l01655"></a>01655     <span class="keywordflow">return</span> 0;
<a name="l01656"></a>01656 
<a name="l01657"></a>01657   *pc = <a class="code" href="defs_8h.html#a99aec65329508b4d449a4f881026f844">extract_unsigned_integer</a> (buf, 4, byte_order);
<a name="l01658"></a>01658   *pc = <a class="code" href="spu-tdep_8h.html#a9dd6343d7c2ebf90bf29d78289bdb110">SPUADDR</a> (tdep-&gt;<a class="code" href="structgdbarch__tdep.html#a6c04333e4962a9690dea1334a6201d30">id</a>, *pc);
<a name="l01659"></a>01659   <span class="keywordflow">return</span> 1;
<a name="l01660"></a>01660 }
<a name="l01661"></a>01661 
<a name="l01662"></a>01662 
<a name="l01663"></a>01663 <span class="comment">/* Disassembler.  */</span>
<a name="l01664"></a>01664 
<a name="l01665"></a><a class="code" href="structspu__dis__asm__data.html">01665</a> <span class="keyword">struct </span><a class="code" href="structspu__dis__asm__data.html">spu_dis_asm_data</a>
<a name="l01666"></a>01666 {
<a name="l01667"></a><a class="code" href="structspu__dis__asm__data.html#a5a20b23fcf171c01054ad3f5120f0576">01667</a>   <span class="keyword">struct </span>gdbarch *<a class="code" href="structspu__dis__asm__data.html#a5a20b23fcf171c01054ad3f5120f0576">gdbarch</a>;
<a name="l01668"></a><a class="code" href="structspu__dis__asm__data.html#a23bef58791923020a60e840acf997de5">01668</a>   <span class="keywordtype">int</span> <a class="code" href="structspu__dis__asm__data.html#a23bef58791923020a60e840acf997de5">id</a>;
<a name="l01669"></a>01669 };
<a name="l01670"></a>01670 
<a name="l01671"></a>01671 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01672"></a><a class="code" href="spu-tdep_8c.html#ad8112eb88d7dab14ae59e226f78d0441">01672</a> <a class="code" href="spu-tdep_8c.html#ad8112eb88d7dab14ae59e226f78d0441">spu_dis_asm_print_address</a> (bfd_vma addr, <span class="keyword">struct</span> disassemble_info *info)
<a name="l01673"></a>01673 {
<a name="l01674"></a>01674   <span class="keyword">struct </span><a class="code" href="structspu__dis__asm__data.html">spu_dis_asm_data</a> *data = info-&gt;application_data;
<a name="l01675"></a>01675   <a class="code" href="defs_8h.html#ac859be6d454d5718fb6faf3bd34fc27e">print_address</a> (data-&gt;<a class="code" href="structspu__dis__asm__data.html#a5a20b23fcf171c01054ad3f5120f0576">gdbarch</a>, <a class="code" href="spu-tdep_8h.html#a9dd6343d7c2ebf90bf29d78289bdb110">SPUADDR</a> (data-&gt;<a class="code" href="structspu__dis__asm__data.html#a23bef58791923020a60e840acf997de5">id</a>, addr), info-&gt;stream);
<a name="l01676"></a>01676 }
<a name="l01677"></a>01677 
<a name="l01678"></a>01678 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l01679"></a><a class="code" href="spu-tdep_8c.html#a7b7e70ab7b9e8842e75725c99189f8d1">01679</a> <a class="code" href="spu-tdep_8c.html#a7b7e70ab7b9e8842e75725c99189f8d1">gdb_print_insn_spu</a> (bfd_vma <a class="code" href="exec_8h.html#ab268c3184bf49615e16de006a296a542">memaddr</a>, <span class="keyword">struct</span> disassemble_info *info)
<a name="l01680"></a>01680 {
<a name="l01681"></a>01681   <span class="comment">/* The opcodes disassembler does 18-bit address arithmetic.  Make</span>
<a name="l01682"></a>01682 <span class="comment">     sure the SPU ID encoded in the high bits is added back when we</span>
<a name="l01683"></a>01683 <span class="comment">     call print_address.  */</span>
<a name="l01684"></a>01684   <span class="keyword">struct </span>disassemble_info spu_info = *info;
<a name="l01685"></a>01685   <span class="keyword">struct </span><a class="code" href="structspu__dis__asm__data.html">spu_dis_asm_data</a> data;
<a name="l01686"></a>01686   data.<a class="code" href="structspu__dis__asm__data.html#a5a20b23fcf171c01054ad3f5120f0576">gdbarch</a> = info-&gt;application_data;
<a name="l01687"></a>01687   data.<a class="code" href="structspu__dis__asm__data.html#a23bef58791923020a60e840acf997de5">id</a> = <a class="code" href="spu-tdep_8h.html#afafb4132b7fe5507e3c9ff629b54fcbb">SPUADDR_SPU</a> (memaddr);
<a name="l01688"></a>01688 
<a name="l01689"></a>01689   spu_info.application_data = &amp;data;
<a name="l01690"></a>01690   spu_info.print_address_func = <a class="code" href="spu-tdep_8c.html#ad8112eb88d7dab14ae59e226f78d0441">spu_dis_asm_print_address</a>;
<a name="l01691"></a>01691   <span class="keywordflow">return</span> print_insn_spu (memaddr, &amp;spu_info);
<a name="l01692"></a>01692 }
<a name="l01693"></a>01693 
<a name="l01694"></a>01694 
<a name="l01695"></a>01695 <span class="comment">/* Target overlays for the SPU overlay manager.</span>
<a name="l01696"></a>01696 <span class="comment"></span>
<a name="l01697"></a>01697 <span class="comment">   See the documentation of simple_overlay_update for how the</span>
<a name="l01698"></a>01698 <span class="comment">   interface is supposed to work.</span>
<a name="l01699"></a>01699 <span class="comment"></span>
<a name="l01700"></a>01700 <span class="comment">   Data structures used by the overlay manager:</span>
<a name="l01701"></a>01701 <span class="comment"></span>
<a name="l01702"></a>01702 <span class="comment">   struct ovly_table</span>
<a name="l01703"></a>01703 <span class="comment">     {</span>
<a name="l01704"></a>01704 <span class="comment">        u32 vma;</span>
<a name="l01705"></a>01705 <span class="comment">        u32 size;</span>
<a name="l01706"></a>01706 <span class="comment">        u32 pos;</span>
<a name="l01707"></a>01707 <span class="comment">        u32 buf;</span>
<a name="l01708"></a>01708 <span class="comment">     } _ovly_table[];   -- one entry per overlay section</span>
<a name="l01709"></a>01709 <span class="comment"></span>
<a name="l01710"></a>01710 <span class="comment">   struct ovly_buf_table</span>
<a name="l01711"></a>01711 <span class="comment">     {</span>
<a name="l01712"></a>01712 <span class="comment">        u32 mapped;</span>
<a name="l01713"></a>01713 <span class="comment">     } _ovly_buf_table[];  -- one entry per overlay buffer</span>
<a name="l01714"></a>01714 <span class="comment"></span>
<a name="l01715"></a>01715 <span class="comment">   _ovly_table should never change.</span>
<a name="l01716"></a>01716 <span class="comment"></span>
<a name="l01717"></a>01717 <span class="comment">   Both tables are aligned to a 16-byte boundary, the symbols</span>
<a name="l01718"></a>01718 <span class="comment">   _ovly_table and _ovly_buf_table are of type STT_OBJECT and their</span>
<a name="l01719"></a>01719 <span class="comment">   size set to the size of the respective array. buf in _ovly_table is</span>
<a name="l01720"></a>01720 <span class="comment">   an index into _ovly_buf_table.</span>
<a name="l01721"></a>01721 <span class="comment"></span>
<a name="l01722"></a>01722 <span class="comment">   mapped is an index into _ovly_table.  Both the mapped and buf indices start</span>
<a name="l01723"></a>01723 <span class="comment">   from one to reference the first entry in their respective tables.  */</span>
<a name="l01724"></a>01724 
<a name="l01725"></a>01725 <span class="comment">/* Using the per-objfile private data mechanism, we store for each</span>
<a name="l01726"></a>01726 <span class="comment">   objfile an array of &quot;struct spu_overlay_table&quot; structures, one</span>
<a name="l01727"></a>01727 <span class="comment">   for each obj_section of the objfile.  This structure holds two</span>
<a name="l01728"></a>01728 <span class="comment">   fields, MAPPED_PTR and MAPPED_VAL.  If MAPPED_PTR is zero, this</span>
<a name="l01729"></a>01729 <span class="comment">   is *not* an overlay section.  If it is non-zero, it represents</span>
<a name="l01730"></a>01730 <span class="comment">   a target address.  The overlay section is mapped iff the target</span>
<a name="l01731"></a>01731 <span class="comment">   integer at this location equals MAPPED_VAL.  */</span>
<a name="l01732"></a>01732 
<a name="l01733"></a><a class="code" href="spu-tdep_8c.html#a81051b5d2c73ade3382357773946f648">01733</a> <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span>objfile_data *<a class="code" href="spu-tdep_8c.html#a81051b5d2c73ade3382357773946f648">spu_overlay_data</a>;
<a name="l01734"></a>01734 
<a name="l01735"></a><a class="code" href="structspu__overlay__table.html">01735</a> <span class="keyword">struct </span><a class="code" href="structspu__overlay__table.html">spu_overlay_table</a>
<a name="l01736"></a>01736   {
<a name="l01737"></a><a class="code" href="structspu__overlay__table.html#af7e12e86bf9f2a0126cdeeffd11d7730">01737</a>     <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> <a class="code" href="structspu__overlay__table.html#af7e12e86bf9f2a0126cdeeffd11d7730">mapped_ptr</a>;
<a name="l01738"></a><a class="code" href="structspu__overlay__table.html#a94bf1a0b1b18667c28507677d6725964">01738</a>     <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> <a class="code" href="structspu__overlay__table.html#a94bf1a0b1b18667c28507677d6725964">mapped_val</a>;
<a name="l01739"></a>01739   };
<a name="l01740"></a>01740 
<a name="l01741"></a>01741 <span class="comment">/* Retrieve the overlay table for OBJFILE.  If not already cached, read</span>
<a name="l01742"></a>01742 <span class="comment">   the _ovly_table data structure from the target and initialize the</span>
<a name="l01743"></a>01743 <span class="comment">   spu_overlay_table data structure from it.  */</span>
<a name="l01744"></a>01744 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structspu__overlay__table.html">spu_overlay_table</a> *
<a name="l01745"></a><a class="code" href="spu-tdep_8c.html#a182a208f1fc816e814bf3baba8e29031">01745</a> <a class="code" href="spu-tdep_8c.html#a182a208f1fc816e814bf3baba8e29031">spu_get_overlay_table</a> (<span class="keyword">struct</span> <a class="code" href="structobjfile.html">objfile</a> *<a class="code" href="structobjfile.html">objfile</a>)
<a name="l01746"></a>01746 {
<a name="l01747"></a>01747   <span class="keyword">enum</span> bfd_endian byte_order = bfd_big_endian (objfile-&gt;<a class="code" href="structobjfile.html#a0b967b64f365ef71d618700b7308dcde">obfd</a>)?
<a name="l01748"></a>01748                    BFD_ENDIAN_BIG : BFD_ENDIAN_LITTLE;
<a name="l01749"></a>01749   <span class="keyword">struct </span><a class="code" href="structminimal__symbol.html">minimal_symbol</a> *ovly_table_msym, *ovly_buf_table_msym;
<a name="l01750"></a>01750   <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> ovly_table_base, ovly_buf_table_base;
<a name="l01751"></a>01751   <span class="keywordtype">unsigned</span> ovly_table_size, ovly_buf_table_size;
<a name="l01752"></a>01752   <span class="keyword">struct </span><a class="code" href="structspu__overlay__table.html">spu_overlay_table</a> *tbl;
<a name="l01753"></a>01753   <span class="keyword">struct </span><a class="code" href="structobj__section.html">obj_section</a> *osect;
<a name="l01754"></a>01754   <a class="code" href="defs_8h.html#a336b399b3b83dbcc61f176c33f26b607">gdb_byte</a> *ovly_table;
<a name="l01755"></a>01755   <span class="keywordtype">int</span> i;
<a name="l01756"></a>01756 
<a name="l01757"></a>01757   tbl = objfile_data (objfile, <a class="code" href="spu-tdep_8c.html#a81051b5d2c73ade3382357773946f648">spu_overlay_data</a>);
<a name="l01758"></a>01758   <span class="keywordflow">if</span> (tbl)
<a name="l01759"></a>01759     <span class="keywordflow">return</span> tbl;
<a name="l01760"></a>01760 
<a name="l01761"></a>01761   ovly_table_msym = <a class="code" href="minsyms_8c.html#af87f7a894386515074ddd71365bc09b8">lookup_minimal_symbol</a> (<span class="stringliteral">&quot;_ovly_table&quot;</span>, NULL, objfile);
<a name="l01762"></a>01762   <span class="keywordflow">if</span> (!ovly_table_msym)
<a name="l01763"></a>01763     <span class="keywordflow">return</span> NULL;
<a name="l01764"></a>01764 
<a name="l01765"></a>01765   ovly_buf_table_msym = <a class="code" href="minsyms_8c.html#af87f7a894386515074ddd71365bc09b8">lookup_minimal_symbol</a> (<span class="stringliteral">&quot;_ovly_buf_table&quot;</span>,
<a name="l01766"></a>01766                                                NULL, objfile);
<a name="l01767"></a>01767   <span class="keywordflow">if</span> (!ovly_buf_table_msym)
<a name="l01768"></a>01768     <span class="keywordflow">return</span> NULL;
<a name="l01769"></a>01769 
<a name="l01770"></a>01770   ovly_table_base = <a class="code" href="symtab_8h.html#abee697b9e3bb4f4d164ad920a87ab854">SYMBOL_VALUE_ADDRESS</a> (ovly_table_msym);
<a name="l01771"></a>01771   ovly_table_size = <a class="code" href="symtab_8h.html#abe76c055206f09da801b760076c9f68a">MSYMBOL_SIZE</a> (ovly_table_msym);
<a name="l01772"></a>01772 
<a name="l01773"></a>01773   ovly_buf_table_base = <a class="code" href="symtab_8h.html#abee697b9e3bb4f4d164ad920a87ab854">SYMBOL_VALUE_ADDRESS</a> (ovly_buf_table_msym);
<a name="l01774"></a>01774   ovly_buf_table_size = <a class="code" href="symtab_8h.html#abe76c055206f09da801b760076c9f68a">MSYMBOL_SIZE</a> (ovly_buf_table_msym);
<a name="l01775"></a>01775 
<a name="l01776"></a>01776   ovly_table = <a class="code" href="common-utils_8c.html#a634d6cd850bb831afebc499579303b3b">xmalloc</a> (ovly_table_size);
<a name="l01777"></a>01777   <a class="code" href="corefile_8c.html#a5e0189c6f21f1c9321b379877183b819">read_memory</a> (ovly_table_base, ovly_table, ovly_table_size);
<a name="l01778"></a>01778 
<a name="l01779"></a>01779   tbl = <a class="code" href="gdb__obstack_8h.html#ade84d21769345a1fad382ba39d83eb90">OBSTACK_CALLOC</a> (&amp;objfile-&gt;<a class="code" href="structobjfile.html#aab9cedc53383f1b540f0b725edd2d9be">objfile_obstack</a>,
<a name="l01780"></a>01780                         objfile-&gt;<a class="code" href="structobjfile.html#a14f54389e81e2ae3efa512a6fa3365ea">sections_end</a> - objfile-&gt;<a class="code" href="structobjfile.html#a728f934c27b3d13bb44fbba47edc37f7">sections</a>,
<a name="l01781"></a>01781                         <span class="keyword">struct</span> <a class="code" href="structspu__overlay__table.html">spu_overlay_table</a>);
<a name="l01782"></a>01782 
<a name="l01783"></a>01783   <span class="keywordflow">for</span> (i = 0; i &lt; ovly_table_size / 16; i++)
<a name="l01784"></a>01784     {
<a name="l01785"></a>01785       <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> vma  = <a class="code" href="defs_8h.html#a99aec65329508b4d449a4f881026f844">extract_unsigned_integer</a> (ovly_table + 16*i + 0,
<a name="l01786"></a>01786                                                  4, byte_order);
<a name="l01787"></a>01787       <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> <a class="code" href="go32-nat_8c.html#a854352f53b148adc24983a58a1866d66">size</a> = <a class="code" href="defs_8h.html#a99aec65329508b4d449a4f881026f844">extract_unsigned_integer</a> (ovly_table + 16*i + 4,
<a name="l01788"></a>01788                                                  4, byte_order);
<a name="l01789"></a>01789       <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> pos  = <a class="code" href="defs_8h.html#a99aec65329508b4d449a4f881026f844">extract_unsigned_integer</a> (ovly_table + 16*i + 8,
<a name="l01790"></a>01790                                                  4, byte_order);
<a name="l01791"></a>01791       <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> buf  = <a class="code" href="defs_8h.html#a99aec65329508b4d449a4f881026f844">extract_unsigned_integer</a> (ovly_table + 16*i + 12,
<a name="l01792"></a>01792                                                  4, byte_order);
<a name="l01793"></a>01793 
<a name="l01794"></a>01794       <span class="keywordflow">if</span> (buf == 0 || (buf - 1) * 4 &gt;= ovly_buf_table_size)
<a name="l01795"></a>01795         <span class="keywordflow">continue</span>;
<a name="l01796"></a>01796 
<a name="l01797"></a>01797       <a class="code" href="objfiles_8h.html#ad7608d3f6245108438ac6aca20412589">ALL_OBJFILE_OSECTIONS</a> (objfile, osect)
<a name="l01798"></a>01798         <span class="keywordflow">if</span> (vma == bfd_section_vma (objfile-&gt;<a class="code" href="structobjfile.html#a0b967b64f365ef71d618700b7308dcde">obfd</a>, osect-&gt;<a class="code" href="structobj__section.html#ad233927d4d1037bde66ab9628ae82345">the_bfd_section</a>)
<a name="l01799"></a>01799             &amp;&amp; pos == osect-&gt;<a class="code" href="structobj__section.html#ad233927d4d1037bde66ab9628ae82345">the_bfd_section</a>-&gt;filepos)
<a name="l01800"></a>01800           {
<a name="l01801"></a>01801             <span class="keywordtype">int</span> ndx = osect - objfile-&gt;<a class="code" href="structobjfile.html#a728f934c27b3d13bb44fbba47edc37f7">sections</a>;
<a name="l01802"></a>01802             tbl[ndx].<a class="code" href="structspu__overlay__table.html#af7e12e86bf9f2a0126cdeeffd11d7730">mapped_ptr</a> = ovly_buf_table_base + (buf - 1) * 4;
<a name="l01803"></a>01803             tbl[ndx].<a class="code" href="structspu__overlay__table.html#a94bf1a0b1b18667c28507677d6725964">mapped_val</a> = i + 1;
<a name="l01804"></a>01804             <span class="keywordflow">break</span>;
<a name="l01805"></a>01805           }
<a name="l01806"></a>01806     }
<a name="l01807"></a>01807 
<a name="l01808"></a>01808   <a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a> (ovly_table);
<a name="l01809"></a>01809   set_objfile_data (objfile, <a class="code" href="spu-tdep_8c.html#a81051b5d2c73ade3382357773946f648">spu_overlay_data</a>, tbl);
<a name="l01810"></a>01810   <span class="keywordflow">return</span> tbl;
<a name="l01811"></a>01811 }
<a name="l01812"></a>01812 
<a name="l01813"></a>01813 <span class="comment">/* Read _ovly_buf_table entry from the target to dermine whether</span>
<a name="l01814"></a>01814 <span class="comment">   OSECT is currently mapped, and update the mapped state.  */</span>
<a name="l01815"></a>01815 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01816"></a><a class="code" href="spu-tdep_8c.html#ab3c98ec3324c977a3374c89bf25721af">01816</a> <a class="code" href="spu-tdep_8c.html#ab3c98ec3324c977a3374c89bf25721af">spu_overlay_update_osect</a> (<span class="keyword">struct</span> <a class="code" href="structobj__section.html">obj_section</a> *osect)
<a name="l01817"></a>01817 {
<a name="l01818"></a>01818   <span class="keyword">enum</span> bfd_endian byte_order = bfd_big_endian (osect-&gt;<a class="code" href="structobj__section.html#a3dba4273f49b43a5e8c64bd29ac39ef1">objfile</a>-&gt;<a class="code" href="structobjfile.html#a0b967b64f365ef71d618700b7308dcde">obfd</a>)?
<a name="l01819"></a>01819                    BFD_ENDIAN_BIG : BFD_ENDIAN_LITTLE;
<a name="l01820"></a>01820   <span class="keyword">struct </span><a class="code" href="structspu__overlay__table.html">spu_overlay_table</a> *ovly_table;
<a name="l01821"></a>01821   <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> id, val;
<a name="l01822"></a>01822 
<a name="l01823"></a>01823   ovly_table = <a class="code" href="spu-tdep_8c.html#a182a208f1fc816e814bf3baba8e29031">spu_get_overlay_table</a> (osect-&gt;<a class="code" href="structobj__section.html#a3dba4273f49b43a5e8c64bd29ac39ef1">objfile</a>);
<a name="l01824"></a>01824   <span class="keywordflow">if</span> (!ovly_table)
<a name="l01825"></a>01825     <span class="keywordflow">return</span>;
<a name="l01826"></a>01826 
<a name="l01827"></a>01827   ovly_table += osect - osect-&gt;<a class="code" href="structobj__section.html#a3dba4273f49b43a5e8c64bd29ac39ef1">objfile</a>-&gt;<a class="code" href="structobjfile.html#a728f934c27b3d13bb44fbba47edc37f7">sections</a>;
<a name="l01828"></a>01828   <span class="keywordflow">if</span> (ovly_table-&gt;<a class="code" href="structspu__overlay__table.html#af7e12e86bf9f2a0126cdeeffd11d7730">mapped_ptr</a> == 0)
<a name="l01829"></a>01829     <span class="keywordflow">return</span>;
<a name="l01830"></a>01830 
<a name="l01831"></a>01831   <span class="keywordtype">id</span> = <a class="code" href="spu-tdep_8h.html#afafb4132b7fe5507e3c9ff629b54fcbb">SPUADDR_SPU</a> (<a class="code" href="objfiles_8h.html#add2e3fffc531c5f6789a03324308ccf6">obj_section_addr</a> (osect));
<a name="l01832"></a>01832   val = <a class="code" href="corefile_8c.html#a280cf81e766f60b30618ae3011f2cb07">read_memory_unsigned_integer</a> (<a class="code" href="spu-tdep_8h.html#a9dd6343d7c2ebf90bf29d78289bdb110">SPUADDR</a> (<span class="keywordtype">id</span>, ovly_table-&gt;<a class="code" href="structspu__overlay__table.html#af7e12e86bf9f2a0126cdeeffd11d7730">mapped_ptr</a>),
<a name="l01833"></a>01833                                       4, byte_order);
<a name="l01834"></a>01834   osect-&gt;<a class="code" href="structobj__section.html#a5304004a0276b0af9f106bb28cea546b">ovly_mapped</a> = (val == ovly_table-&gt;<a class="code" href="structspu__overlay__table.html#a94bf1a0b1b18667c28507677d6725964">mapped_val</a>);
<a name="l01835"></a>01835 }
<a name="l01836"></a>01836 
<a name="l01837"></a>01837 <span class="comment">/* If OSECT is NULL, then update all sections&#39; mapped state.</span>
<a name="l01838"></a>01838 <span class="comment">   If OSECT is non-NULL, then update only OSECT&#39;s mapped state.  */</span>
<a name="l01839"></a>01839 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01840"></a><a class="code" href="spu-tdep_8c.html#a8213a386e270b40a537b451ecebac22a">01840</a> <a class="code" href="spu-tdep_8c.html#a8213a386e270b40a537b451ecebac22a">spu_overlay_update</a> (<span class="keyword">struct</span> <a class="code" href="structobj__section.html">obj_section</a> *osect)
<a name="l01841"></a>01841 {
<a name="l01842"></a>01842   <span class="comment">/* Just one section.  */</span>
<a name="l01843"></a>01843   <span class="keywordflow">if</span> (osect)
<a name="l01844"></a>01844     <a class="code" href="spu-tdep_8c.html#ab3c98ec3324c977a3374c89bf25721af">spu_overlay_update_osect</a> (osect);
<a name="l01845"></a>01845 
<a name="l01846"></a>01846   <span class="comment">/* All sections.  */</span>
<a name="l01847"></a>01847   <span class="keywordflow">else</span>
<a name="l01848"></a>01848     {
<a name="l01849"></a>01849       <span class="keyword">struct </span><a class="code" href="structobjfile.html">objfile</a> *<a class="code" href="structobjfile.html">objfile</a>;
<a name="l01850"></a>01850 
<a name="l01851"></a>01851       <a class="code" href="objfiles_8h.html#ac97332e8e963307538cd23e38ab820b9">ALL_OBJSECTIONS</a> (objfile, osect)
<a name="l01852"></a>01852         <span class="keywordflow">if</span> (<a class="code" href="symfile_8c.html#ad63f10fe5266cd2e98883d6f4c054c3a">section_is_overlay</a> (osect))
<a name="l01853"></a>01853           <a class="code" href="spu-tdep_8c.html#ab3c98ec3324c977a3374c89bf25721af">spu_overlay_update_osect</a> (osect);
<a name="l01854"></a>01854     }
<a name="l01855"></a>01855 }
<a name="l01856"></a>01856 
<a name="l01857"></a>01857 <span class="comment">/* Whenever a new objfile is loaded, read the target&#39;s _ovly_table.</span>
<a name="l01858"></a>01858 <span class="comment">   If there is one, go through all sections and make sure for non-</span>
<a name="l01859"></a>01859 <span class="comment">   overlay sections LMA equals VMA, while for overlay sections LMA</span>
<a name="l01860"></a>01860 <span class="comment">   is larger than SPU_OVERLAY_LMA.  */</span>
<a name="l01861"></a>01861 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01862"></a><a class="code" href="spu-tdep_8c.html#a419e5a40fb8559d4b4ed9a1d17194975">01862</a> <a class="code" href="spu-tdep_8c.html#a419e5a40fb8559d4b4ed9a1d17194975">spu_overlay_new_objfile</a> (<span class="keyword">struct</span> <a class="code" href="structobjfile.html">objfile</a> *<a class="code" href="structobjfile.html">objfile</a>)
<a name="l01863"></a>01863 {
<a name="l01864"></a>01864   <span class="keyword">struct </span><a class="code" href="structspu__overlay__table.html">spu_overlay_table</a> *ovly_table;
<a name="l01865"></a>01865   <span class="keyword">struct </span><a class="code" href="structobj__section.html">obj_section</a> *osect;
<a name="l01866"></a>01866 
<a name="l01867"></a>01867   <span class="comment">/* If we&#39;ve already touched this file, do nothing.  */</span>
<a name="l01868"></a>01868   <span class="keywordflow">if</span> (!objfile || objfile_data (objfile, <a class="code" href="spu-tdep_8c.html#a81051b5d2c73ade3382357773946f648">spu_overlay_data</a>) != NULL)
<a name="l01869"></a>01869     <span class="keywordflow">return</span>;
<a name="l01870"></a>01870 
<a name="l01871"></a>01871   <span class="comment">/* Consider only SPU objfiles.  */</span>
<a name="l01872"></a>01872   <span class="keywordflow">if</span> (bfd_get_arch (objfile-&gt;<a class="code" href="structobjfile.html#a0b967b64f365ef71d618700b7308dcde">obfd</a>) != bfd_arch_spu)
<a name="l01873"></a>01873     <span class="keywordflow">return</span>;
<a name="l01874"></a>01874 
<a name="l01875"></a>01875   <span class="comment">/* Check if this objfile has overlays.  */</span>
<a name="l01876"></a>01876   ovly_table = <a class="code" href="spu-tdep_8c.html#a182a208f1fc816e814bf3baba8e29031">spu_get_overlay_table</a> (objfile);
<a name="l01877"></a>01877   <span class="keywordflow">if</span> (!ovly_table)
<a name="l01878"></a>01878     <span class="keywordflow">return</span>;
<a name="l01879"></a>01879 
<a name="l01880"></a>01880   <span class="comment">/* Now go and fiddle with all the LMAs.  */</span>
<a name="l01881"></a>01881   <a class="code" href="objfiles_8h.html#ad7608d3f6245108438ac6aca20412589">ALL_OBJFILE_OSECTIONS</a> (objfile, osect)
<a name="l01882"></a>01882     {
<a name="l01883"></a>01883       bfd *obfd = objfile-&gt;<a class="code" href="structobjfile.html#a0b967b64f365ef71d618700b7308dcde">obfd</a>;
<a name="l01884"></a>01884       asection *bsect = osect-&gt;<a class="code" href="structobj__section.html#ad233927d4d1037bde66ab9628ae82345">the_bfd_section</a>;
<a name="l01885"></a>01885       <span class="keywordtype">int</span> ndx = osect - objfile-&gt;<a class="code" href="structobjfile.html#a728f934c27b3d13bb44fbba47edc37f7">sections</a>;
<a name="l01886"></a>01886 
<a name="l01887"></a>01887       <span class="keywordflow">if</span> (ovly_table[ndx].mapped_ptr == 0)
<a name="l01888"></a>01888         bfd_section_lma (obfd, bsect) = bfd_section_vma (obfd, bsect);
<a name="l01889"></a>01889       <span class="keywordflow">else</span>
<a name="l01890"></a>01890         bfd_section_lma (obfd, bsect) = <a class="code" href="spu-tdep_8h.html#a0d88d668b4a1a17e372b4f364928ffc5">SPU_OVERLAY_LMA</a> + bsect-&gt;filepos;
<a name="l01891"></a>01891     }
<a name="l01892"></a>01892 }
<a name="l01893"></a>01893 
<a name="l01894"></a>01894 
<a name="l01895"></a>01895 <span class="comment">/* Insert temporary breakpoint on &quot;main&quot; function of newly loaded</span>
<a name="l01896"></a>01896 <span class="comment">   SPE context OBJFILE.  */</span>
<a name="l01897"></a>01897 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01898"></a><a class="code" href="spu-tdep_8c.html#a5e9f6785d6ad3dc5ac5681df0ec25448">01898</a> <a class="code" href="spu-tdep_8c.html#a5e9f6785d6ad3dc5ac5681df0ec25448">spu_catch_start</a> (<span class="keyword">struct</span> <a class="code" href="structobjfile.html">objfile</a> *<a class="code" href="structobjfile.html">objfile</a>)
<a name="l01899"></a>01899 {
<a name="l01900"></a>01900   <span class="keyword">struct </span><a class="code" href="structminimal__symbol.html">minimal_symbol</a> *minsym;
<a name="l01901"></a>01901   <span class="keyword">struct </span><a class="code" href="structsymtab.html">symtab</a> *<a class="code" href="structsymtab.html">symtab</a>;
<a name="l01902"></a>01902   <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> pc;
<a name="l01903"></a>01903   <span class="keywordtype">char</span> buf[32];
<a name="l01904"></a>01904 
<a name="l01905"></a>01905   <span class="comment">/* Do this only if requested by &quot;set spu stop-on-load on&quot;.  */</span>
<a name="l01906"></a>01906   <span class="keywordflow">if</span> (!<a class="code" href="spu-tdep_8c.html#a7727de4d3c84d3cea031dea8953b8ad6">spu_stop_on_load_p</a>)
<a name="l01907"></a>01907     <span class="keywordflow">return</span>;
<a name="l01908"></a>01908 
<a name="l01909"></a>01909   <span class="comment">/* Consider only SPU objfiles.  */</span>
<a name="l01910"></a>01910   <span class="keywordflow">if</span> (!objfile || bfd_get_arch (objfile-&gt;<a class="code" href="structobjfile.html#a0b967b64f365ef71d618700b7308dcde">obfd</a>) != bfd_arch_spu)
<a name="l01911"></a>01911     <span class="keywordflow">return</span>;
<a name="l01912"></a>01912 
<a name="l01913"></a>01913   <span class="comment">/* The main objfile is handled differently.  */</span>
<a name="l01914"></a>01914   <span class="keywordflow">if</span> (objfile == <a class="code" href="progspace_8h.html#a4e703bd0d59c70e069bed3b4d9e1936b">symfile_objfile</a>)
<a name="l01915"></a>01915     <span class="keywordflow">return</span>;
<a name="l01916"></a>01916 
<a name="l01917"></a>01917   <span class="comment">/* There can be multiple symbols named &quot;main&quot;.  Search for the</span>
<a name="l01918"></a>01918 <span class="comment">     &quot;main&quot; in *this* objfile.  */</span>
<a name="l01919"></a>01919   minsym = <a class="code" href="minsyms_8c.html#af87f7a894386515074ddd71365bc09b8">lookup_minimal_symbol</a> (<span class="stringliteral">&quot;main&quot;</span>, NULL, objfile);
<a name="l01920"></a>01920   <span class="keywordflow">if</span> (!minsym)
<a name="l01921"></a>01921     <span class="keywordflow">return</span>;
<a name="l01922"></a>01922 
<a name="l01923"></a>01923   <span class="comment">/* If we have debugging information, try to use it -- this</span>
<a name="l01924"></a>01924 <span class="comment">     will allow us to properly skip the prologue.  */</span>
<a name="l01925"></a>01925   pc = <a class="code" href="symtab_8h.html#abee697b9e3bb4f4d164ad920a87ab854">SYMBOL_VALUE_ADDRESS</a> (minsym);
<a name="l01926"></a>01926   symtab = <a class="code" href="symtab_8c.html#a3101bf74ef6a226365946e06f3e33932">find_pc_sect_symtab</a> (pc, <a class="code" href="symtab_8h.html#a68f0685d666b6934c762f89d9b996c63">SYMBOL_OBJ_SECTION</a> (objfile, minsym));
<a name="l01927"></a>01927   <span class="keywordflow">if</span> (symtab != NULL)
<a name="l01928"></a>01928     {
<a name="l01929"></a>01929       <span class="keyword">struct </span><a class="code" href="structblockvector.html">blockvector</a> *bv = <a class="code" href="symtab_8h.html#a6cd84410d73680ff8006ac44b1b98a9c">BLOCKVECTOR</a> (symtab);
<a name="l01930"></a>01930       <span class="keyword">struct </span><a class="code" href="structblock.html">block</a> *<a class="code" href="structblock.html">block</a> = <a class="code" href="block_8h.html#a84c4a3aa7b6b4d9a127a1c018dd6a776">BLOCKVECTOR_BLOCK</a> (bv, <a class="code" href="defs_8h.html#a8ec407cb404e1ae8ce984f792e83f124a973ee91cbe4b0cee4eb7603252a29bec">GLOBAL_BLOCK</a>);
<a name="l01931"></a>01931       <span class="keyword">struct </span><a class="code" href="structsymbol.html">symbol</a> *sym;
<a name="l01932"></a>01932       <span class="keyword">struct </span><a class="code" href="structsymtab__and__line.html">symtab_and_line</a> sal;
<a name="l01933"></a>01933 
<a name="l01934"></a>01934       sym = <a class="code" href="symtab_8c.html#a25f45a38ca9085f0fad46c8cd1394fda">lookup_block_symbol</a> (block, <span class="stringliteral">&quot;main&quot;</span>, <a class="code" href="symtab_8h.html#a5c384cef81c5f50f32caadbfd6974a1aa15693f9d844450eb4bfd4b37114f4aed">VAR_DOMAIN</a>);
<a name="l01935"></a>01935       <span class="keywordflow">if</span> (sym)
<a name="l01936"></a>01936         {
<a name="l01937"></a>01937           <a class="code" href="symtab_8c.html#a569809b8edfbd2e0a6d9bb40295840f0">fixup_symbol_section</a> (sym, objfile);
<a name="l01938"></a>01938           sal = <a class="code" href="symtab_8c.html#ab927e83e70b2cff20b3750daff6f84c5">find_function_start_sal</a> (sym, 1);
<a name="l01939"></a>01939           pc = sal.<a class="code" href="structsymtab__and__line.html#a77665fa461ad187cb755efa256ba44d7">pc</a>;
<a name="l01940"></a>01940         }
<a name="l01941"></a>01941     }
<a name="l01942"></a>01942 
<a name="l01943"></a>01943   <span class="comment">/* Use a numerical address for the set_breakpoint command to avoid having</span>
<a name="l01944"></a>01944 <span class="comment">     the breakpoint re-set incorrectly.  */</span>
<a name="l01945"></a>01945   <a class="code" href="common-utils_8c.html#ad9940337ec98983dae9951c947879fc8">xsnprintf</a> (buf, <span class="keyword">sizeof</span> buf, <span class="stringliteral">&quot;*%s&quot;</span>, <a class="code" href="utils_8c.html#acb2b4bf07dba43a005da21904906c533">core_addr_to_string</a> (pc));
<a name="l01946"></a>01946   <a class="code" href="breakpoint_8c.html#a9f0540734ee04440fbb9f6c3c1558d0f">create_breakpoint</a> (<a class="code" href="objfiles_8c.html#a1c7101234ac2edc601fa465e48bc3463">get_objfile_arch</a> (objfile), buf <span class="comment">/* arg */</span>,
<a name="l01947"></a>01947                      NULL <span class="comment">/* cond_string */</span>, -1 <span class="comment">/* thread */</span>,
<a name="l01948"></a>01948                      NULL <span class="comment">/* extra_string */</span>,
<a name="l01949"></a>01949                      0 <span class="comment">/* parse_condition_and_thread */</span>, 1 <span class="comment">/* tempflag */</span>,
<a name="l01950"></a>01950                      <a class="code" href="breakpoint_8h.html#a67735d134567a4ba184d011f1db556cfa17768c2bd9137ec6e30c922c5c1d0ffa">bp_breakpoint</a> <span class="comment">/* type_wanted */</span>,
<a name="l01951"></a>01951                      0 <span class="comment">/* ignore_count */</span>,
<a name="l01952"></a>01952                      <a class="code" href="defs_8h.html#a7e28c5d9363062b4fd5eec5fed14448fad5edac705ebbe17f475a693d6b00141c">AUTO_BOOLEAN_FALSE</a> <span class="comment">/* pending_break_support */</span>,
<a name="l01953"></a>01953                      &amp;<a class="code" href="breakpoint_8c.html#a9b47dd7cd982ec63ffd303246d93cf7a">bkpt_breakpoint_ops</a> <span class="comment">/* ops */</span>, 0 <span class="comment">/* from_tty */</span>,
<a name="l01954"></a>01954                      1 <span class="comment">/* enabled */</span>, 0 <span class="comment">/* internal  */</span>, 0);
<a name="l01955"></a>01955 }
<a name="l01956"></a>01956 
<a name="l01957"></a>01957 
<a name="l01958"></a>01958 <span class="comment">/* Look up OBJFILE loaded into FRAME&#39;s SPU context.  */</span>
<a name="l01959"></a>01959 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structobjfile.html">objfile</a> *
<a name="l01960"></a><a class="code" href="spu-tdep_8c.html#a8a41f4c407f91f9ec3abe2c5015fc1b1">01960</a> <a class="code" href="spu-tdep_8c.html#a8a41f4c407f91f9ec3abe2c5015fc1b1">spu_objfile_from_frame</a> (<span class="keyword">struct</span> <a class="code" href="structframe__info.html">frame_info</a> *frame)
<a name="l01961"></a>01961 {
<a name="l01962"></a>01962   <span class="keyword">struct </span>gdbarch *gdbarch = <a class="code" href="frame_8c.html#ab44507b5655da44e522ed5857835ede7">get_frame_arch</a> (frame);
<a name="l01963"></a>01963   <span class="keyword">struct </span><a class="code" href="structgdbarch__tdep.html">gdbarch_tdep</a> *tdep = <a class="code" href="gdbarch_8c.html#acea996b7421706849bc20567695b5b31">gdbarch_tdep</a> (gdbarch);
<a name="l01964"></a>01964   <span class="keyword">struct </span><a class="code" href="structobjfile.html">objfile</a> *obj;
<a name="l01965"></a>01965 
<a name="l01966"></a>01966   <span class="keywordflow">if</span> (<a class="code" href="gdbarch_8c.html#a305465885963fbf0fb5a7543594a7bff">gdbarch_bfd_arch_info</a> (gdbarch)-&gt;arch != bfd_arch_spu)
<a name="l01967"></a>01967     <span class="keywordflow">return</span> NULL;
<a name="l01968"></a>01968 
<a name="l01969"></a>01969   <a class="code" href="objfiles_8h.html#a8efee3b85a322006131a6056d45058b3">ALL_OBJFILES</a> (obj)
<a name="l01970"></a>01970     {
<a name="l01971"></a>01971       <span class="keywordflow">if</span> (obj-&gt;<a class="code" href="structobjfile.html#a728f934c27b3d13bb44fbba47edc37f7">sections</a> != obj-&gt;<a class="code" href="structobjfile.html#a14f54389e81e2ae3efa512a6fa3365ea">sections_end</a>
<a name="l01972"></a>01972           &amp;&amp; <a class="code" href="spu-tdep_8h.html#afafb4132b7fe5507e3c9ff629b54fcbb">SPUADDR_SPU</a> (<a class="code" href="objfiles_8h.html#add2e3fffc531c5f6789a03324308ccf6">obj_section_addr</a> (obj-&gt;<a class="code" href="structobjfile.html#a728f934c27b3d13bb44fbba47edc37f7">sections</a>)) == tdep-&gt;<a class="code" href="structgdbarch__tdep.html#a6c04333e4962a9690dea1334a6201d30">id</a>)
<a name="l01973"></a>01973         <span class="keywordflow">return</span> obj;
<a name="l01974"></a>01974     }
<a name="l01975"></a>01975 
<a name="l01976"></a>01976   <span class="keywordflow">return</span> NULL;
<a name="l01977"></a>01977 }
<a name="l01978"></a>01978 
<a name="l01979"></a>01979 <span class="comment">/* Flush cache for ea pointer access if available.  */</span>
<a name="l01980"></a>01980 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01981"></a><a class="code" href="spu-tdep_8c.html#a028affea8009efaf076176ea376608b6">01981</a> <a class="code" href="spu-tdep_8c.html#a028affea8009efaf076176ea376608b6">flush_ea_cache</a> (<span class="keywordtype">void</span>)
<a name="l01982"></a>01982 {
<a name="l01983"></a>01983   <span class="keyword">struct </span><a class="code" href="structminimal__symbol.html">minimal_symbol</a> *msymbol;
<a name="l01984"></a>01984   <span class="keyword">struct </span><a class="code" href="structobjfile.html">objfile</a> *obj;
<a name="l01985"></a>01985 
<a name="l01986"></a>01986   <span class="keywordflow">if</span> (!<a class="code" href="frame_8c.html#ad1e8bd5ac45df219a168640934f891cc">has_stack_frames</a> ())
<a name="l01987"></a>01987     <span class="keywordflow">return</span>;
<a name="l01988"></a>01988 
<a name="l01989"></a>01989   obj = <a class="code" href="spu-tdep_8c.html#a8a41f4c407f91f9ec3abe2c5015fc1b1">spu_objfile_from_frame</a> (<a class="code" href="frame_8c.html#a5ab254510728049878a232ed1b889820">get_current_frame</a> ());
<a name="l01990"></a>01990   <span class="keywordflow">if</span> (obj == NULL)
<a name="l01991"></a>01991     <span class="keywordflow">return</span>;
<a name="l01992"></a>01992 
<a name="l01993"></a>01993   <span class="comment">/* Lookup inferior function __cache_flush.  */</span>
<a name="l01994"></a>01994   msymbol = <a class="code" href="minsyms_8c.html#af87f7a894386515074ddd71365bc09b8">lookup_minimal_symbol</a> (<span class="stringliteral">&quot;__cache_flush&quot;</span>, NULL, obj);
<a name="l01995"></a>01995   <span class="keywordflow">if</span> (msymbol != NULL)
<a name="l01996"></a>01996     {
<a name="l01997"></a>01997       <span class="keyword">struct </span><a class="code" href="structtype.html">type</a> *<a class="code" href="language_8c.html#a763fd8db6bba8fbbbc113ca0d61c47c2">type</a>;
<a name="l01998"></a>01998       <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> addr;
<a name="l01999"></a>01999 
<a name="l02000"></a>02000       type = <a class="code" href="gdbtypes_8c.html#ac2b95ded04f0520eec8b4d0d79a097d0">objfile_type</a> (obj)-&gt;<a class="code" href="structobjfile__type.html#a4143df3933c553aa6f862ea7d3140151">builtin_void</a>;
<a name="l02001"></a>02001       type = <a class="code" href="gdbtypes_8c.html#ab21dd6531306fba2a7078534017df6fb">lookup_function_type</a> (type);
<a name="l02002"></a>02002       type = <a class="code" href="gdbtypes_8c.html#a8edb8d75a169b1455414b420088d1887">lookup_pointer_type</a> (type);
<a name="l02003"></a>02003       addr = <a class="code" href="symtab_8h.html#abee697b9e3bb4f4d164ad920a87ab854">SYMBOL_VALUE_ADDRESS</a> (msymbol);
<a name="l02004"></a>02004 
<a name="l02005"></a>02005       <a class="code" href="infcall_8c.html#a8344d63cd8405f1e9fae104da173283d">call_function_by_hand</a> (<a class="code" href="value_8c.html#a2f2d0d3d3ce482fc844f1fc4dc4c038e">value_from_pointer</a> (type, addr), 0, NULL);
<a name="l02006"></a>02006     }
<a name="l02007"></a>02007 }
<a name="l02008"></a>02008 
<a name="l02009"></a>02009 <span class="comment">/* This handler is called when the inferior has stopped.  If it is stopped in</span>
<a name="l02010"></a>02010 <span class="comment">   SPU architecture then flush the ea cache if used.  */</span>
<a name="l02011"></a>02011 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l02012"></a><a class="code" href="spu-tdep_8c.html#a8c5d1cf1825964d587766d8980534e71">02012</a> <a class="code" href="spu-tdep_8c.html#a8c5d1cf1825964d587766d8980534e71">spu_attach_normal_stop</a> (<span class="keyword">struct</span> <a class="code" href="structbpstats.html">bpstats</a> *bs, <span class="keywordtype">int</span> <a class="code" href="stack_8c.html#ab3f10aab610905e59c2a90953afd1d24">print_frame</a>)
<a name="l02013"></a>02013 {
<a name="l02014"></a>02014   <span class="keywordflow">if</span> (!<a class="code" href="spu-tdep_8c.html#a7a6c9e0cdc6342602ad23650b8f55c45">spu_auto_flush_cache_p</a>)
<a name="l02015"></a>02015     <span class="keywordflow">return</span>;
<a name="l02016"></a>02016 
<a name="l02017"></a>02017   <span class="comment">/* Temporarily reset spu_auto_flush_cache_p to avoid recursively</span>
<a name="l02018"></a>02018 <span class="comment">     re-entering this function when __cache_flush stops.  */</span>
<a name="l02019"></a>02019   <a class="code" href="spu-tdep_8c.html#a7a6c9e0cdc6342602ad23650b8f55c45">spu_auto_flush_cache_p</a> = 0;
<a name="l02020"></a>02020   <a class="code" href="spu-tdep_8c.html#a028affea8009efaf076176ea376608b6">flush_ea_cache</a> ();
<a name="l02021"></a>02021   <a class="code" href="spu-tdep_8c.html#a7a6c9e0cdc6342602ad23650b8f55c45">spu_auto_flush_cache_p</a> = 1;
<a name="l02022"></a>02022 }
<a name="l02023"></a>02023 
<a name="l02024"></a>02024 
<a name="l02025"></a>02025 <span class="comment">/* &quot;info spu&quot; commands.  */</span>
<a name="l02026"></a>02026 
<a name="l02027"></a>02027 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l02028"></a><a class="code" href="spu-tdep_8c.html#acb0050e806af1c59e4508d9e12061110">02028</a> <a class="code" href="spu-tdep_8c.html#acb0050e806af1c59e4508d9e12061110">info_spu_event_command</a> (<span class="keywordtype">char</span> *args, <span class="keywordtype">int</span> from_tty)
<a name="l02029"></a>02029 {
<a name="l02030"></a>02030   <span class="keyword">struct </span><a class="code" href="structframe__info.html">frame_info</a> *frame = <a class="code" href="frame_8c.html#a8b714a78478670e14a297eba8d1a9915">get_selected_frame</a> (NULL);
<a name="l02031"></a>02031   <a class="code" href="defs_8h.html#a4df4af8771b1016a24976757026f4984">ULONGEST</a> event_status = 0;
<a name="l02032"></a>02032   <a class="code" href="defs_8h.html#a4df4af8771b1016a24976757026f4984">ULONGEST</a> event_mask = 0;
<a name="l02033"></a>02033   <span class="keyword">struct </span><a class="code" href="structcleanup.html">cleanup</a> *chain;
<a name="l02034"></a>02034   <a class="code" href="defs_8h.html#a336b399b3b83dbcc61f176c33f26b607">gdb_byte</a> buf[100];
<a name="l02035"></a>02035   <span class="keywordtype">char</span> annex[32];
<a name="l02036"></a>02036   <a class="code" href="defs_8h.html#ac7647a3f71533007c9e128f3ddda1987">LONGEST</a> <a class="code" href="exec_8h.html#a00f945351279d3c8935f13d2b9f9b808">len</a>;
<a name="l02037"></a>02037   <span class="keywordtype">int</span> id;
<a name="l02038"></a>02038 
<a name="l02039"></a>02039   <span class="keywordflow">if</span> (<a class="code" href="gdbarch_8c.html#a305465885963fbf0fb5a7543594a7bff">gdbarch_bfd_arch_info</a> (<a class="code" href="frame_8c.html#ab44507b5655da44e522ed5857835ede7">get_frame_arch</a> (frame))-&gt;arch != bfd_arch_spu)
<a name="l02040"></a>02040     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\&quot;info spu\&quot; is only supported on the SPU architecture.&quot;</span>));
<a name="l02041"></a>02041 
<a name="l02042"></a>02042   <span class="keywordtype">id</span> = <a class="code" href="frame_8c.html#affa785e8937e96fd727e46a2cfec94c4">get_frame_register_unsigned</a> (frame, <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4ca2d3903584b23e19e9df838dc3939cf45">SPU_ID_REGNUM</a>);
<a name="l02043"></a>02043 
<a name="l02044"></a>02044   <a class="code" href="common-utils_8c.html#ad9940337ec98983dae9951c947879fc8">xsnprintf</a> (annex, <span class="keyword">sizeof</span> annex, <span class="stringliteral">&quot;%d/event_status&quot;</span>, <span class="keywordtype">id</span>);
<a name="l02045"></a>02045   len = <a class="code" href="target_8c.html#aac7df8f3a1d061c97c45219ed0cace6c">target_read</a> (&amp;<a class="code" href="target_8h.html#a2d8640b030266b58d3821eb5cfd112b9">current_target</a>, <a class="code" href="target_8h.html#aa5a3e4ceb377c9f5822cdc68c6f138e2a09790d59558546bb5ab8aa15ae6fbc74">TARGET_OBJECT_SPU</a>, annex,
<a name="l02046"></a>02046                      buf, 0, (<span class="keyword">sizeof</span> (buf) - 1));
<a name="l02047"></a>02047   <span class="keywordflow">if</span> (len &lt;= 0)
<a name="l02048"></a>02048     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Could not read event_status.&quot;</span>));
<a name="l02049"></a>02049   buf[<a class="code" href="exec_8h.html#a00f945351279d3c8935f13d2b9f9b808">len</a>] = <span class="charliteral">&#39;\0&#39;</span>;
<a name="l02050"></a>02050   event_status = <a class="code" href="utils_8c.html#a4382e498f35b82f89a57692b78104d2d">strtoulst</a> ((<span class="keywordtype">char</span> *) buf, NULL, 16);
<a name="l02051"></a>02051  
<a name="l02052"></a>02052   <a class="code" href="common-utils_8c.html#ad9940337ec98983dae9951c947879fc8">xsnprintf</a> (annex, <span class="keyword">sizeof</span> annex, <span class="stringliteral">&quot;%d/event_mask&quot;</span>, <span class="keywordtype">id</span>);
<a name="l02053"></a>02053   len = <a class="code" href="target_8c.html#aac7df8f3a1d061c97c45219ed0cace6c">target_read</a> (&amp;<a class="code" href="target_8h.html#a2d8640b030266b58d3821eb5cfd112b9">current_target</a>, <a class="code" href="target_8h.html#aa5a3e4ceb377c9f5822cdc68c6f138e2a09790d59558546bb5ab8aa15ae6fbc74">TARGET_OBJECT_SPU</a>, annex,
<a name="l02054"></a>02054                      buf, 0, (<span class="keyword">sizeof</span> (buf) - 1));
<a name="l02055"></a>02055   <span class="keywordflow">if</span> (len &lt;= 0)
<a name="l02056"></a>02056     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Could not read event_mask.&quot;</span>));
<a name="l02057"></a>02057   buf[<a class="code" href="exec_8h.html#a00f945351279d3c8935f13d2b9f9b808">len</a>] = <span class="charliteral">&#39;\0&#39;</span>;
<a name="l02058"></a>02058   event_mask = <a class="code" href="utils_8c.html#a4382e498f35b82f89a57692b78104d2d">strtoulst</a> ((<span class="keywordtype">char</span> *) buf, NULL, 16);
<a name="l02059"></a>02059  
<a name="l02060"></a>02060   chain = <a class="code" href="ui-out_8c.html#aaf5a0c991d74ad2e486f420d5c2ff058">make_cleanup_ui_out_tuple_begin_end</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, <span class="stringliteral">&quot;SPUInfoEvent&quot;</span>);
<a name="l02061"></a>02061 
<a name="l02062"></a>02062   <span class="keywordflow">if</span> (<a class="code" href="ui-out_8c.html#a473db54efcfbc60feeb5a4f54f27af46">ui_out_is_mi_like_p</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>))
<a name="l02063"></a>02063     {
<a name="l02064"></a>02064       <a class="code" href="ui-out_8c.html#ac29596ba86f387928e0d3e6b7385f998">ui_out_field_fmt</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, <span class="stringliteral">&quot;event_status&quot;</span>,
<a name="l02065"></a>02065                         <span class="stringliteral">&quot;0x%s&quot;</span>, <a class="code" href="utils_8c.html#ac2742d41c48dc5ede26d22070fbc486a">phex_nz</a> (event_status, 4));
<a name="l02066"></a>02066       <a class="code" href="ui-out_8c.html#ac29596ba86f387928e0d3e6b7385f998">ui_out_field_fmt</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, <span class="stringliteral">&quot;event_mask&quot;</span>,
<a name="l02067"></a>02067                         <span class="stringliteral">&quot;0x%s&quot;</span>, <a class="code" href="utils_8c.html#ac2742d41c48dc5ede26d22070fbc486a">phex_nz</a> (event_mask, 4));
<a name="l02068"></a>02068     }
<a name="l02069"></a>02069   <span class="keywordflow">else</span>
<a name="l02070"></a>02070     {
<a name="l02071"></a>02071       <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Event Status 0x%s\n&quot;</span>), <a class="code" href="utils_8c.html#a74449c9bb8c40997e79f44a3c2db935c">phex</a> (event_status, 4));
<a name="l02072"></a>02072       <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Event Mask   0x%s\n&quot;</span>), <a class="code" href="utils_8c.html#a74449c9bb8c40997e79f44a3c2db935c">phex</a> (event_mask, 4));
<a name="l02073"></a>02073     }
<a name="l02074"></a>02074 
<a name="l02075"></a>02075   <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (chain);
<a name="l02076"></a>02076 }
<a name="l02077"></a>02077 
<a name="l02078"></a>02078 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l02079"></a><a class="code" href="spu-tdep_8c.html#ae9ee817db6c353fd2d430c73978849b1">02079</a> <a class="code" href="spu-tdep_8c.html#ae9ee817db6c353fd2d430c73978849b1">info_spu_signal_command</a> (<span class="keywordtype">char</span> *args, <span class="keywordtype">int</span> from_tty)
<a name="l02080"></a>02080 {
<a name="l02081"></a>02081   <span class="keyword">struct </span><a class="code" href="structframe__info.html">frame_info</a> *frame = <a class="code" href="frame_8c.html#a8b714a78478670e14a297eba8d1a9915">get_selected_frame</a> (NULL);
<a name="l02082"></a>02082   <span class="keyword">struct </span>gdbarch *gdbarch = <a class="code" href="frame_8c.html#ab44507b5655da44e522ed5857835ede7">get_frame_arch</a> (frame);
<a name="l02083"></a>02083   <span class="keyword">enum</span> bfd_endian <a class="code" href="structgdbarch.html#a7a9dd6544406e9cbb574dae9d531346e">byte_order</a> = <a class="code" href="gdbarch_8c.html#abc300a3797421aa7342b288e1637483e">gdbarch_byte_order</a> (gdbarch);
<a name="l02084"></a>02084   <a class="code" href="defs_8h.html#a4df4af8771b1016a24976757026f4984">ULONGEST</a> signal1 = 0;
<a name="l02085"></a>02085   <a class="code" href="defs_8h.html#a4df4af8771b1016a24976757026f4984">ULONGEST</a> signal1_type = 0;
<a name="l02086"></a>02086   <span class="keywordtype">int</span> signal1_pending = 0;
<a name="l02087"></a>02087   <a class="code" href="defs_8h.html#a4df4af8771b1016a24976757026f4984">ULONGEST</a> signal2 = 0;
<a name="l02088"></a>02088   <a class="code" href="defs_8h.html#a4df4af8771b1016a24976757026f4984">ULONGEST</a> signal2_type = 0;
<a name="l02089"></a>02089   <span class="keywordtype">int</span> signal2_pending = 0;
<a name="l02090"></a>02090   <span class="keyword">struct </span><a class="code" href="structcleanup.html">cleanup</a> *chain;
<a name="l02091"></a>02091   <span class="keywordtype">char</span> annex[32];
<a name="l02092"></a>02092   <a class="code" href="defs_8h.html#a336b399b3b83dbcc61f176c33f26b607">gdb_byte</a> buf[100];
<a name="l02093"></a>02093   <a class="code" href="defs_8h.html#ac7647a3f71533007c9e128f3ddda1987">LONGEST</a> <a class="code" href="exec_8h.html#a00f945351279d3c8935f13d2b9f9b808">len</a>;
<a name="l02094"></a>02094   <span class="keywordtype">int</span> id;
<a name="l02095"></a>02095 
<a name="l02096"></a>02096   <span class="keywordflow">if</span> (<a class="code" href="gdbarch_8c.html#a305465885963fbf0fb5a7543594a7bff">gdbarch_bfd_arch_info</a> (gdbarch)-&gt;arch != bfd_arch_spu)
<a name="l02097"></a>02097     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\&quot;info spu\&quot; is only supported on the SPU architecture.&quot;</span>));
<a name="l02098"></a>02098 
<a name="l02099"></a>02099   <span class="keywordtype">id</span> = <a class="code" href="frame_8c.html#affa785e8937e96fd727e46a2cfec94c4">get_frame_register_unsigned</a> (frame, <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4ca2d3903584b23e19e9df838dc3939cf45">SPU_ID_REGNUM</a>);
<a name="l02100"></a>02100 
<a name="l02101"></a>02101   <a class="code" href="common-utils_8c.html#ad9940337ec98983dae9951c947879fc8">xsnprintf</a> (annex, <span class="keyword">sizeof</span> annex, <span class="stringliteral">&quot;%d/signal1&quot;</span>, <span class="keywordtype">id</span>);
<a name="l02102"></a>02102   len = <a class="code" href="target_8c.html#aac7df8f3a1d061c97c45219ed0cace6c">target_read</a> (&amp;<a class="code" href="target_8h.html#a2d8640b030266b58d3821eb5cfd112b9">current_target</a>, <a class="code" href="target_8h.html#aa5a3e4ceb377c9f5822cdc68c6f138e2a09790d59558546bb5ab8aa15ae6fbc74">TARGET_OBJECT_SPU</a>, annex, buf, 0, 4);
<a name="l02103"></a>02103   <span class="keywordflow">if</span> (len &lt; 0)
<a name="l02104"></a>02104     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Could not read signal1.&quot;</span>));
<a name="l02105"></a>02105   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (len == 4)
<a name="l02106"></a>02106     {
<a name="l02107"></a>02107       signal1 = <a class="code" href="defs_8h.html#a99aec65329508b4d449a4f881026f844">extract_unsigned_integer</a> (buf, 4, byte_order);
<a name="l02108"></a>02108       signal1_pending = 1;
<a name="l02109"></a>02109     }
<a name="l02110"></a>02110     
<a name="l02111"></a>02111   <a class="code" href="common-utils_8c.html#ad9940337ec98983dae9951c947879fc8">xsnprintf</a> (annex, <span class="keyword">sizeof</span> annex, <span class="stringliteral">&quot;%d/signal1_type&quot;</span>, <span class="keywordtype">id</span>);
<a name="l02112"></a>02112   len = <a class="code" href="target_8c.html#aac7df8f3a1d061c97c45219ed0cace6c">target_read</a> (&amp;<a class="code" href="target_8h.html#a2d8640b030266b58d3821eb5cfd112b9">current_target</a>, <a class="code" href="target_8h.html#aa5a3e4ceb377c9f5822cdc68c6f138e2a09790d59558546bb5ab8aa15ae6fbc74">TARGET_OBJECT_SPU</a>, annex,
<a name="l02113"></a>02113                      buf, 0, (<span class="keyword">sizeof</span> (buf) - 1));
<a name="l02114"></a>02114   <span class="keywordflow">if</span> (len &lt;= 0)
<a name="l02115"></a>02115     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Could not read signal1_type.&quot;</span>));
<a name="l02116"></a>02116   buf[<a class="code" href="exec_8h.html#a00f945351279d3c8935f13d2b9f9b808">len</a>] = <span class="charliteral">&#39;\0&#39;</span>;
<a name="l02117"></a>02117   signal1_type = <a class="code" href="utils_8c.html#a4382e498f35b82f89a57692b78104d2d">strtoulst</a> ((<span class="keywordtype">char</span> *) buf, NULL, 16);
<a name="l02118"></a>02118 
<a name="l02119"></a>02119   <a class="code" href="common-utils_8c.html#ad9940337ec98983dae9951c947879fc8">xsnprintf</a> (annex, <span class="keyword">sizeof</span> annex, <span class="stringliteral">&quot;%d/signal2&quot;</span>, <span class="keywordtype">id</span>);
<a name="l02120"></a>02120   len = <a class="code" href="target_8c.html#aac7df8f3a1d061c97c45219ed0cace6c">target_read</a> (&amp;<a class="code" href="target_8h.html#a2d8640b030266b58d3821eb5cfd112b9">current_target</a>, <a class="code" href="target_8h.html#aa5a3e4ceb377c9f5822cdc68c6f138e2a09790d59558546bb5ab8aa15ae6fbc74">TARGET_OBJECT_SPU</a>, annex, buf, 0, 4);
<a name="l02121"></a>02121   <span class="keywordflow">if</span> (len &lt; 0)
<a name="l02122"></a>02122     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Could not read signal2.&quot;</span>));
<a name="l02123"></a>02123   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (len == 4)
<a name="l02124"></a>02124     {
<a name="l02125"></a>02125       signal2 = <a class="code" href="defs_8h.html#a99aec65329508b4d449a4f881026f844">extract_unsigned_integer</a> (buf, 4, byte_order);
<a name="l02126"></a>02126       signal2_pending = 1;
<a name="l02127"></a>02127     }
<a name="l02128"></a>02128     
<a name="l02129"></a>02129   <a class="code" href="common-utils_8c.html#ad9940337ec98983dae9951c947879fc8">xsnprintf</a> (annex, <span class="keyword">sizeof</span> annex, <span class="stringliteral">&quot;%d/signal2_type&quot;</span>, <span class="keywordtype">id</span>);
<a name="l02130"></a>02130   len = <a class="code" href="target_8c.html#aac7df8f3a1d061c97c45219ed0cace6c">target_read</a> (&amp;<a class="code" href="target_8h.html#a2d8640b030266b58d3821eb5cfd112b9">current_target</a>, <a class="code" href="target_8h.html#aa5a3e4ceb377c9f5822cdc68c6f138e2a09790d59558546bb5ab8aa15ae6fbc74">TARGET_OBJECT_SPU</a>, annex,
<a name="l02131"></a>02131                      buf, 0, (<span class="keyword">sizeof</span> (buf) - 1));
<a name="l02132"></a>02132   <span class="keywordflow">if</span> (len &lt;= 0)
<a name="l02133"></a>02133     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Could not read signal2_type.&quot;</span>));
<a name="l02134"></a>02134   buf[<a class="code" href="exec_8h.html#a00f945351279d3c8935f13d2b9f9b808">len</a>] = <span class="charliteral">&#39;\0&#39;</span>;
<a name="l02135"></a>02135   signal2_type = <a class="code" href="utils_8c.html#a4382e498f35b82f89a57692b78104d2d">strtoulst</a> ((<span class="keywordtype">char</span> *) buf, NULL, 16);
<a name="l02136"></a>02136 
<a name="l02137"></a>02137   chain = <a class="code" href="ui-out_8c.html#aaf5a0c991d74ad2e486f420d5c2ff058">make_cleanup_ui_out_tuple_begin_end</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, <span class="stringliteral">&quot;SPUInfoSignal&quot;</span>);
<a name="l02138"></a>02138 
<a name="l02139"></a>02139   <span class="keywordflow">if</span> (<a class="code" href="ui-out_8c.html#a473db54efcfbc60feeb5a4f54f27af46">ui_out_is_mi_like_p</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>))
<a name="l02140"></a>02140     {
<a name="l02141"></a>02141       <a class="code" href="ui-out_8c.html#aa6f66551d03db456fb94ca1c9038f5a0">ui_out_field_int</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, <span class="stringliteral">&quot;signal1_pending&quot;</span>, signal1_pending);
<a name="l02142"></a>02142       <a class="code" href="ui-out_8c.html#ac29596ba86f387928e0d3e6b7385f998">ui_out_field_fmt</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, <span class="stringliteral">&quot;signal1&quot;</span>, <span class="stringliteral">&quot;0x%s&quot;</span>, <a class="code" href="utils_8c.html#ac2742d41c48dc5ede26d22070fbc486a">phex_nz</a> (signal1, 4));
<a name="l02143"></a>02143       <a class="code" href="ui-out_8c.html#aa6f66551d03db456fb94ca1c9038f5a0">ui_out_field_int</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, <span class="stringliteral">&quot;signal1_type&quot;</span>, signal1_type);
<a name="l02144"></a>02144       <a class="code" href="ui-out_8c.html#aa6f66551d03db456fb94ca1c9038f5a0">ui_out_field_int</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, <span class="stringliteral">&quot;signal2_pending&quot;</span>, signal2_pending);
<a name="l02145"></a>02145       <a class="code" href="ui-out_8c.html#ac29596ba86f387928e0d3e6b7385f998">ui_out_field_fmt</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, <span class="stringliteral">&quot;signal2&quot;</span>, <span class="stringliteral">&quot;0x%s&quot;</span>, <a class="code" href="utils_8c.html#ac2742d41c48dc5ede26d22070fbc486a">phex_nz</a> (signal2, 4));
<a name="l02146"></a>02146       <a class="code" href="ui-out_8c.html#aa6f66551d03db456fb94ca1c9038f5a0">ui_out_field_int</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, <span class="stringliteral">&quot;signal2_type&quot;</span>, signal2_type);
<a name="l02147"></a>02147     }
<a name="l02148"></a>02148   <span class="keywordflow">else</span>
<a name="l02149"></a>02149     {
<a name="l02150"></a>02150       <span class="keywordflow">if</span> (signal1_pending)
<a name="l02151"></a>02151         <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Signal 1 control word 0x%s &quot;</span>), <a class="code" href="utils_8c.html#a74449c9bb8c40997e79f44a3c2db935c">phex</a> (signal1, 4));
<a name="l02152"></a>02152       <span class="keywordflow">else</span>
<a name="l02153"></a>02153         <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Signal 1 not pending &quot;</span>));
<a name="l02154"></a>02154 
<a name="l02155"></a>02155       <span class="keywordflow">if</span> (signal1_type)
<a name="l02156"></a>02156         <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;(Type Or)\n&quot;</span>));
<a name="l02157"></a>02157       <span class="keywordflow">else</span>
<a name="l02158"></a>02158         <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;(Type Overwrite)\n&quot;</span>));
<a name="l02159"></a>02159 
<a name="l02160"></a>02160       <span class="keywordflow">if</span> (signal2_pending)
<a name="l02161"></a>02161         <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Signal 2 control word 0x%s &quot;</span>), <a class="code" href="utils_8c.html#a74449c9bb8c40997e79f44a3c2db935c">phex</a> (signal2, 4));
<a name="l02162"></a>02162       <span class="keywordflow">else</span>
<a name="l02163"></a>02163         <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Signal 2 not pending &quot;</span>));
<a name="l02164"></a>02164 
<a name="l02165"></a>02165       <span class="keywordflow">if</span> (signal2_type)
<a name="l02166"></a>02166         <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;(Type Or)\n&quot;</span>));
<a name="l02167"></a>02167       <span class="keywordflow">else</span>
<a name="l02168"></a>02168         <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;(Type Overwrite)\n&quot;</span>));
<a name="l02169"></a>02169     }
<a name="l02170"></a>02170 
<a name="l02171"></a>02171   <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (chain);
<a name="l02172"></a>02172 }
<a name="l02173"></a>02173 
<a name="l02174"></a>02174 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l02175"></a><a class="code" href="spu-tdep_8c.html#a4a80ea74b1f82942978a94f192183ff6">02175</a> <a class="code" href="spu-tdep_8c.html#a4a80ea74b1f82942978a94f192183ff6">info_spu_mailbox_list</a> (<a class="code" href="defs_8h.html#a336b399b3b83dbcc61f176c33f26b607">gdb_byte</a> *buf, <span class="keywordtype">int</span> nr, <span class="keyword">enum</span> bfd_endian byte_order,
<a name="l02176"></a>02176                        <span class="keyword">const</span> <span class="keywordtype">char</span> *field, <span class="keyword">const</span> <span class="keywordtype">char</span> *msg)
<a name="l02177"></a>02177 {
<a name="l02178"></a>02178   <span class="keyword">struct </span><a class="code" href="structcleanup.html">cleanup</a> *chain;
<a name="l02179"></a>02179   <span class="keywordtype">int</span> i;
<a name="l02180"></a>02180 
<a name="l02181"></a>02181   <span class="keywordflow">if</span> (nr &lt;= 0)
<a name="l02182"></a>02182     <span class="keywordflow">return</span>;
<a name="l02183"></a>02183 
<a name="l02184"></a>02184   chain = <a class="code" href="ui-out_8c.html#a9675e3968a06325a214ffe2fbb10bdc8">make_cleanup_ui_out_table_begin_end</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, 1, nr, <span class="stringliteral">&quot;mbox&quot;</span>);
<a name="l02185"></a>02185 
<a name="l02186"></a>02186   <a class="code" href="ui-out_8c.html#a6a85ff75fa4ac345725a2fd58498173f">ui_out_table_header</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, 32, <a class="code" href="ui-out_8h.html#ac5d0187f97768dc203458ddf644e0c7aac8a02f1b44706ba412f42aa3fc249695">ui_left</a>, field, msg);
<a name="l02187"></a>02187   <a class="code" href="ui-out_8c.html#a07042144a117bc974f5c41761b68975e">ui_out_table_body</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>);
<a name="l02188"></a>02188 
<a name="l02189"></a>02189   <span class="keywordflow">for</span> (i = 0; i &lt; nr; i++)
<a name="l02190"></a>02190     {
<a name="l02191"></a>02191       <span class="keyword">struct </span><a class="code" href="structcleanup.html">cleanup</a> *val_chain;
<a name="l02192"></a>02192       <a class="code" href="defs_8h.html#a4df4af8771b1016a24976757026f4984">ULONGEST</a> val;
<a name="l02193"></a>02193       val_chain = <a class="code" href="ui-out_8c.html#aaf5a0c991d74ad2e486f420d5c2ff058">make_cleanup_ui_out_tuple_begin_end</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, <span class="stringliteral">&quot;mbox&quot;</span>);
<a name="l02194"></a>02194       val = <a class="code" href="defs_8h.html#a99aec65329508b4d449a4f881026f844">extract_unsigned_integer</a> (buf + 4*i, 4, byte_order);
<a name="l02195"></a>02195       <a class="code" href="ui-out_8c.html#ac29596ba86f387928e0d3e6b7385f998">ui_out_field_fmt</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, field, <span class="stringliteral">&quot;0x%s&quot;</span>, <a class="code" href="utils_8c.html#a74449c9bb8c40997e79f44a3c2db935c">phex</a> (val, 4));
<a name="l02196"></a>02196       <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (val_chain);
<a name="l02197"></a>02197 
<a name="l02198"></a>02198       <span class="keywordflow">if</span> (!<a class="code" href="ui-out_8c.html#a473db54efcfbc60feeb5a4f54f27af46">ui_out_is_mi_like_p</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>))
<a name="l02199"></a>02199         <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l02200"></a>02200     }
<a name="l02201"></a>02201 
<a name="l02202"></a>02202   <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (chain);
<a name="l02203"></a>02203 }
<a name="l02204"></a>02204 
<a name="l02205"></a>02205 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l02206"></a><a class="code" href="spu-tdep_8c.html#a0a2f850288930aaca4eeb3ad29e31fe6">02206</a> <a class="code" href="spu-tdep_8c.html#a0a2f850288930aaca4eeb3ad29e31fe6">info_spu_mailbox_command</a> (<span class="keywordtype">char</span> *args, <span class="keywordtype">int</span> from_tty)
<a name="l02207"></a>02207 {
<a name="l02208"></a>02208   <span class="keyword">struct </span><a class="code" href="structframe__info.html">frame_info</a> *frame = <a class="code" href="frame_8c.html#a8b714a78478670e14a297eba8d1a9915">get_selected_frame</a> (NULL);
<a name="l02209"></a>02209   <span class="keyword">struct </span>gdbarch *gdbarch = <a class="code" href="frame_8c.html#ab44507b5655da44e522ed5857835ede7">get_frame_arch</a> (frame);
<a name="l02210"></a>02210   <span class="keyword">enum</span> bfd_endian <a class="code" href="structgdbarch.html#a7a9dd6544406e9cbb574dae9d531346e">byte_order</a> = <a class="code" href="gdbarch_8c.html#abc300a3797421aa7342b288e1637483e">gdbarch_byte_order</a> (gdbarch);
<a name="l02211"></a>02211   <span class="keyword">struct </span><a class="code" href="structcleanup.html">cleanup</a> *chain;
<a name="l02212"></a>02212   <span class="keywordtype">char</span> annex[32];
<a name="l02213"></a>02213   <a class="code" href="defs_8h.html#a336b399b3b83dbcc61f176c33f26b607">gdb_byte</a> buf[1024];
<a name="l02214"></a>02214   <a class="code" href="defs_8h.html#ac7647a3f71533007c9e128f3ddda1987">LONGEST</a> <a class="code" href="exec_8h.html#a00f945351279d3c8935f13d2b9f9b808">len</a>;
<a name="l02215"></a>02215   <span class="keywordtype">int</span> id;
<a name="l02216"></a>02216 
<a name="l02217"></a>02217   <span class="keywordflow">if</span> (<a class="code" href="gdbarch_8c.html#a305465885963fbf0fb5a7543594a7bff">gdbarch_bfd_arch_info</a> (gdbarch)-&gt;arch != bfd_arch_spu)
<a name="l02218"></a>02218     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\&quot;info spu\&quot; is only supported on the SPU architecture.&quot;</span>));
<a name="l02219"></a>02219 
<a name="l02220"></a>02220   <span class="keywordtype">id</span> = <a class="code" href="frame_8c.html#affa785e8937e96fd727e46a2cfec94c4">get_frame_register_unsigned</a> (frame, <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4ca2d3903584b23e19e9df838dc3939cf45">SPU_ID_REGNUM</a>);
<a name="l02221"></a>02221 
<a name="l02222"></a>02222   chain = <a class="code" href="ui-out_8c.html#aaf5a0c991d74ad2e486f420d5c2ff058">make_cleanup_ui_out_tuple_begin_end</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, <span class="stringliteral">&quot;SPUInfoMailbox&quot;</span>);
<a name="l02223"></a>02223 
<a name="l02224"></a>02224   <a class="code" href="common-utils_8c.html#ad9940337ec98983dae9951c947879fc8">xsnprintf</a> (annex, <span class="keyword">sizeof</span> annex, <span class="stringliteral">&quot;%d/mbox_info&quot;</span>, <span class="keywordtype">id</span>);
<a name="l02225"></a>02225   len = <a class="code" href="target_8c.html#aac7df8f3a1d061c97c45219ed0cace6c">target_read</a> (&amp;<a class="code" href="target_8h.html#a2d8640b030266b58d3821eb5cfd112b9">current_target</a>, <a class="code" href="target_8h.html#aa5a3e4ceb377c9f5822cdc68c6f138e2a09790d59558546bb5ab8aa15ae6fbc74">TARGET_OBJECT_SPU</a>, annex,
<a name="l02226"></a>02226                      buf, 0, <span class="keyword">sizeof</span> buf);
<a name="l02227"></a>02227   <span class="keywordflow">if</span> (len &lt; 0)
<a name="l02228"></a>02228     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Could not read mbox_info.&quot;</span>));
<a name="l02229"></a>02229 
<a name="l02230"></a>02230   <a class="code" href="spu-tdep_8c.html#a4a80ea74b1f82942978a94f192183ff6">info_spu_mailbox_list</a> (buf, len / 4, byte_order,
<a name="l02231"></a>02231                          <span class="stringliteral">&quot;mbox&quot;</span>, <span class="stringliteral">&quot;SPU Outbound Mailbox&quot;</span>);
<a name="l02232"></a>02232 
<a name="l02233"></a>02233   <a class="code" href="common-utils_8c.html#ad9940337ec98983dae9951c947879fc8">xsnprintf</a> (annex, <span class="keyword">sizeof</span> annex, <span class="stringliteral">&quot;%d/ibox_info&quot;</span>, <span class="keywordtype">id</span>);
<a name="l02234"></a>02234   len = <a class="code" href="target_8c.html#aac7df8f3a1d061c97c45219ed0cace6c">target_read</a> (&amp;<a class="code" href="target_8h.html#a2d8640b030266b58d3821eb5cfd112b9">current_target</a>, <a class="code" href="target_8h.html#aa5a3e4ceb377c9f5822cdc68c6f138e2a09790d59558546bb5ab8aa15ae6fbc74">TARGET_OBJECT_SPU</a>, annex,
<a name="l02235"></a>02235                      buf, 0, <span class="keyword">sizeof</span> buf);
<a name="l02236"></a>02236   <span class="keywordflow">if</span> (len &lt; 0)
<a name="l02237"></a>02237     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Could not read ibox_info.&quot;</span>));
<a name="l02238"></a>02238 
<a name="l02239"></a>02239   <a class="code" href="spu-tdep_8c.html#a4a80ea74b1f82942978a94f192183ff6">info_spu_mailbox_list</a> (buf, len / 4, byte_order,
<a name="l02240"></a>02240                          <span class="stringliteral">&quot;ibox&quot;</span>, <span class="stringliteral">&quot;SPU Outbound Interrupt Mailbox&quot;</span>);
<a name="l02241"></a>02241 
<a name="l02242"></a>02242   <a class="code" href="common-utils_8c.html#ad9940337ec98983dae9951c947879fc8">xsnprintf</a> (annex, <span class="keyword">sizeof</span> annex, <span class="stringliteral">&quot;%d/wbox_info&quot;</span>, <span class="keywordtype">id</span>);
<a name="l02243"></a>02243   len = <a class="code" href="target_8c.html#aac7df8f3a1d061c97c45219ed0cace6c">target_read</a> (&amp;<a class="code" href="target_8h.html#a2d8640b030266b58d3821eb5cfd112b9">current_target</a>, <a class="code" href="target_8h.html#aa5a3e4ceb377c9f5822cdc68c6f138e2a09790d59558546bb5ab8aa15ae6fbc74">TARGET_OBJECT_SPU</a>, annex,
<a name="l02244"></a>02244                      buf, 0, <span class="keyword">sizeof</span> buf);
<a name="l02245"></a>02245   <span class="keywordflow">if</span> (len &lt; 0)
<a name="l02246"></a>02246     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Could not read wbox_info.&quot;</span>));
<a name="l02247"></a>02247 
<a name="l02248"></a>02248   <a class="code" href="spu-tdep_8c.html#a4a80ea74b1f82942978a94f192183ff6">info_spu_mailbox_list</a> (buf, len / 4, byte_order,
<a name="l02249"></a>02249                          <span class="stringliteral">&quot;wbox&quot;</span>, <span class="stringliteral">&quot;SPU Inbound Mailbox&quot;</span>);
<a name="l02250"></a>02250 
<a name="l02251"></a>02251   <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (chain);
<a name="l02252"></a>02252 }
<a name="l02253"></a>02253 
<a name="l02254"></a>02254 <span class="keyword">static</span> <a class="code" href="defs_8h.html#a4df4af8771b1016a24976757026f4984">ULONGEST</a>
<a name="l02255"></a><a class="code" href="spu-tdep_8c.html#ac3f896555be04b727f6bca768f363a61">02255</a> <a class="code" href="spu-tdep_8c.html#ac3f896555be04b727f6bca768f363a61">spu_mfc_get_bitfield</a> (<a class="code" href="defs_8h.html#a4df4af8771b1016a24976757026f4984">ULONGEST</a> <a class="code" href="symtab_8h.html#adc1f34651f7bbfa3ba5af27db5f53817">word</a>, <span class="keywordtype">int</span> first, <span class="keywordtype">int</span> last)
<a name="l02256"></a>02256 {
<a name="l02257"></a>02257   <a class="code" href="defs_8h.html#a4df4af8771b1016a24976757026f4984">ULONGEST</a> mask = ~(~(<a class="code" href="defs_8h.html#a4df4af8771b1016a24976757026f4984">ULONGEST</a>)0 &lt;&lt; (last - first + 1));
<a name="l02258"></a>02258   <span class="keywordflow">return</span> (word &gt;&gt; (63 - last)) &amp; mask;
<a name="l02259"></a>02259 }
<a name="l02260"></a>02260 
<a name="l02261"></a>02261 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l02262"></a><a class="code" href="spu-tdep_8c.html#a8c9994818046a2cc058b90377c1a634e">02262</a> <a class="code" href="spu-tdep_8c.html#a8c9994818046a2cc058b90377c1a634e">info_spu_dma_cmdlist</a> (<a class="code" href="defs_8h.html#a336b399b3b83dbcc61f176c33f26b607">gdb_byte</a> *buf, <span class="keywordtype">int</span> nr, <span class="keyword">enum</span> bfd_endian byte_order)
<a name="l02263"></a>02263 {
<a name="l02264"></a>02264   <span class="keyword">static</span> <span class="keywordtype">char</span> *spu_mfc_opcode[256] =
<a name="l02265"></a>02265     {
<a name="l02266"></a>02266     <span class="comment">/* 00 */</span> NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL,
<a name="l02267"></a>02267              NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL,
<a name="l02268"></a>02268     <span class="comment">/* 10 */</span> NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL,
<a name="l02269"></a>02269              NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL,
<a name="l02270"></a>02270     <span class="comment">/* 20 */</span> <span class="stringliteral">&quot;put&quot;</span>, <span class="stringliteral">&quot;putb&quot;</span>, <span class="stringliteral">&quot;putf&quot;</span>, NULL, <span class="stringliteral">&quot;putl&quot;</span>, <span class="stringliteral">&quot;putlb&quot;</span>, <span class="stringliteral">&quot;putlf&quot;</span>, NULL,
<a name="l02271"></a>02271              <span class="stringliteral">&quot;puts&quot;</span>, <span class="stringliteral">&quot;putbs&quot;</span>, <span class="stringliteral">&quot;putfs&quot;</span>, NULL, NULL, NULL, NULL, NULL,
<a name="l02272"></a>02272     <span class="comment">/* 30 */</span> <span class="stringliteral">&quot;putr&quot;</span>, <span class="stringliteral">&quot;putrb&quot;</span>, <span class="stringliteral">&quot;putrf&quot;</span>, NULL, <span class="stringliteral">&quot;putrl&quot;</span>, <span class="stringliteral">&quot;putrlb&quot;</span>, <span class="stringliteral">&quot;putrlf&quot;</span>, NULL,
<a name="l02273"></a>02273              NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL,
<a name="l02274"></a>02274     <span class="comment">/* 40 */</span> <span class="stringliteral">&quot;get&quot;</span>, <span class="stringliteral">&quot;getb&quot;</span>, <span class="stringliteral">&quot;getf&quot;</span>, NULL, <span class="stringliteral">&quot;getl&quot;</span>, <span class="stringliteral">&quot;getlb&quot;</span>, <span class="stringliteral">&quot;getlf&quot;</span>, NULL,
<a name="l02275"></a>02275              <span class="stringliteral">&quot;gets&quot;</span>, <span class="stringliteral">&quot;getbs&quot;</span>, <span class="stringliteral">&quot;getfs&quot;</span>, NULL, NULL, NULL, NULL, NULL,
<a name="l02276"></a>02276     <span class="comment">/* 50 */</span> NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL,
<a name="l02277"></a>02277              NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL,
<a name="l02278"></a>02278     <span class="comment">/* 60 */</span> NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL,
<a name="l02279"></a>02279              NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL,
<a name="l02280"></a>02280     <span class="comment">/* 70 */</span> NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL,
<a name="l02281"></a>02281              NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL,
<a name="l02282"></a>02282     <span class="comment">/* 80 */</span> <span class="stringliteral">&quot;sdcrt&quot;</span>, <span class="stringliteral">&quot;sdcrtst&quot;</span>, NULL, NULL, NULL, NULL, NULL, NULL,
<a name="l02283"></a>02283              NULL, <span class="stringliteral">&quot;sdcrz&quot;</span>, NULL, NULL, NULL, <span class="stringliteral">&quot;sdcrst&quot;</span>, NULL, <span class="stringliteral">&quot;sdcrf&quot;</span>,
<a name="l02284"></a>02284     <span class="comment">/* 90 */</span> NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL,
<a name="l02285"></a>02285              NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL,
<a name="l02286"></a>02286     <span class="comment">/* a0 */</span> <span class="stringliteral">&quot;sndsig&quot;</span>, <span class="stringliteral">&quot;sndsigb&quot;</span>, <span class="stringliteral">&quot;sndsigf&quot;</span>, NULL, NULL, NULL, NULL, NULL,
<a name="l02287"></a>02287              NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL,
<a name="l02288"></a>02288     <span class="comment">/* b0 */</span> <span class="stringliteral">&quot;putlluc&quot;</span>, NULL, NULL, NULL, <span class="stringliteral">&quot;putllc&quot;</span>, NULL, NULL, NULL,
<a name="l02289"></a>02289              <span class="stringliteral">&quot;putqlluc&quot;</span>, NULL, NULL, NULL, NULL, NULL, NULL, NULL,
<a name="l02290"></a>02290     <span class="comment">/* c0 */</span> <span class="stringliteral">&quot;barrier&quot;</span>, NULL, NULL, NULL, NULL, NULL, NULL, NULL,
<a name="l02291"></a>02291              <span class="stringliteral">&quot;mfceieio&quot;</span>, NULL, NULL, NULL, <span class="stringliteral">&quot;mfcsync&quot;</span>, NULL, NULL, NULL,
<a name="l02292"></a>02292     <span class="comment">/* d0 */</span> <span class="stringliteral">&quot;getllar&quot;</span>, NULL, NULL, NULL, NULL, NULL, NULL, NULL,
<a name="l02293"></a>02293              NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL,
<a name="l02294"></a>02294     <span class="comment">/* e0 */</span> NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL,
<a name="l02295"></a>02295              NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL,
<a name="l02296"></a>02296     <span class="comment">/* f0 */</span> NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL,
<a name="l02297"></a>02297              NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL,
<a name="l02298"></a>02298     };
<a name="l02299"></a>02299 
<a name="l02300"></a>02300   <span class="keywordtype">int</span> *seq = alloca (nr * <span class="keyword">sizeof</span> (<span class="keywordtype">int</span>));
<a name="l02301"></a>02301   <span class="keywordtype">int</span> done = 0;
<a name="l02302"></a>02302   <span class="keyword">struct </span><a class="code" href="structcleanup.html">cleanup</a> *chain;
<a name="l02303"></a>02303   <span class="keywordtype">int</span> i, j;
<a name="l02304"></a>02304 
<a name="l02305"></a>02305 
<a name="l02306"></a>02306   <span class="comment">/* Determine sequence in which to display (valid) entries.  */</span>
<a name="l02307"></a>02307   <span class="keywordflow">for</span> (i = 0; i &lt; nr; i++)
<a name="l02308"></a>02308     {
<a name="l02309"></a>02309       <span class="comment">/* Search for the first valid entry all of whose</span>
<a name="l02310"></a>02310 <span class="comment">         dependencies are met.  */</span>
<a name="l02311"></a>02311       <span class="keywordflow">for</span> (j = 0; j &lt; nr; j++)
<a name="l02312"></a>02312         {
<a name="l02313"></a>02313           <a class="code" href="defs_8h.html#a4df4af8771b1016a24976757026f4984">ULONGEST</a> mfc_cq_dw3;
<a name="l02314"></a>02314           <a class="code" href="defs_8h.html#a4df4af8771b1016a24976757026f4984">ULONGEST</a> dependencies;
<a name="l02315"></a>02315 
<a name="l02316"></a>02316           <span class="keywordflow">if</span> (done &amp; (1 &lt;&lt; (nr - 1 - j)))
<a name="l02317"></a>02317             <span class="keywordflow">continue</span>;
<a name="l02318"></a>02318 
<a name="l02319"></a>02319           mfc_cq_dw3
<a name="l02320"></a>02320             = <a class="code" href="defs_8h.html#a99aec65329508b4d449a4f881026f844">extract_unsigned_integer</a> (buf + 32*j + 24,8, byte_order);
<a name="l02321"></a>02321           <span class="keywordflow">if</span> (!<a class="code" href="spu-tdep_8c.html#ac3f896555be04b727f6bca768f363a61">spu_mfc_get_bitfield</a> (mfc_cq_dw3, 16, 16))
<a name="l02322"></a>02322             <span class="keywordflow">continue</span>;
<a name="l02323"></a>02323 
<a name="l02324"></a>02324           dependencies = <a class="code" href="spu-tdep_8c.html#ac3f896555be04b727f6bca768f363a61">spu_mfc_get_bitfield</a> (mfc_cq_dw3, 0, nr - 1);
<a name="l02325"></a>02325           <span class="keywordflow">if</span> ((dependencies &amp; done) != dependencies)
<a name="l02326"></a>02326             <span class="keywordflow">continue</span>;
<a name="l02327"></a>02327 
<a name="l02328"></a>02328           seq[i] = j;
<a name="l02329"></a>02329           done |= 1 &lt;&lt; (nr - 1 - j);
<a name="l02330"></a>02330           <span class="keywordflow">break</span>;
<a name="l02331"></a>02331         }
<a name="l02332"></a>02332 
<a name="l02333"></a>02333       <span class="keywordflow">if</span> (j == nr)
<a name="l02334"></a>02334         <span class="keywordflow">break</span>;
<a name="l02335"></a>02335     }
<a name="l02336"></a>02336 
<a name="l02337"></a>02337   nr = i;
<a name="l02338"></a>02338 
<a name="l02339"></a>02339 
<a name="l02340"></a>02340   chain = <a class="code" href="ui-out_8c.html#a9675e3968a06325a214ffe2fbb10bdc8">make_cleanup_ui_out_table_begin_end</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, 10, nr,
<a name="l02341"></a>02341                                                <span class="stringliteral">&quot;dma_cmd&quot;</span>);
<a name="l02342"></a>02342 
<a name="l02343"></a>02343   <a class="code" href="ui-out_8c.html#a6a85ff75fa4ac345725a2fd58498173f">ui_out_table_header</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, 7, <a class="code" href="ui-out_8h.html#ac5d0187f97768dc203458ddf644e0c7aac8a02f1b44706ba412f42aa3fc249695">ui_left</a>, <span class="stringliteral">&quot;opcode&quot;</span>, <span class="stringliteral">&quot;Opcode&quot;</span>);
<a name="l02344"></a>02344   <a class="code" href="ui-out_8c.html#a6a85ff75fa4ac345725a2fd58498173f">ui_out_table_header</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, 3, <a class="code" href="ui-out_8h.html#ac5d0187f97768dc203458ddf644e0c7aac8a02f1b44706ba412f42aa3fc249695">ui_left</a>, <span class="stringliteral">&quot;tag&quot;</span>, <span class="stringliteral">&quot;Tag&quot;</span>);
<a name="l02345"></a>02345   <a class="code" href="ui-out_8c.html#a6a85ff75fa4ac345725a2fd58498173f">ui_out_table_header</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, 3, <a class="code" href="ui-out_8h.html#ac5d0187f97768dc203458ddf644e0c7aac8a02f1b44706ba412f42aa3fc249695">ui_left</a>, <span class="stringliteral">&quot;tid&quot;</span>, <span class="stringliteral">&quot;TId&quot;</span>);
<a name="l02346"></a>02346   <a class="code" href="ui-out_8c.html#a6a85ff75fa4ac345725a2fd58498173f">ui_out_table_header</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, 3, <a class="code" href="ui-out_8h.html#ac5d0187f97768dc203458ddf644e0c7aac8a02f1b44706ba412f42aa3fc249695">ui_left</a>, <span class="stringliteral">&quot;rid&quot;</span>, <span class="stringliteral">&quot;RId&quot;</span>);
<a name="l02347"></a>02347   <a class="code" href="ui-out_8c.html#a6a85ff75fa4ac345725a2fd58498173f">ui_out_table_header</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, 18, <a class="code" href="ui-out_8h.html#ac5d0187f97768dc203458ddf644e0c7aac8a02f1b44706ba412f42aa3fc249695">ui_left</a>, <span class="stringliteral">&quot;ea&quot;</span>, <span class="stringliteral">&quot;EA&quot;</span>);
<a name="l02348"></a>02348   <a class="code" href="ui-out_8c.html#a6a85ff75fa4ac345725a2fd58498173f">ui_out_table_header</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, 7, <a class="code" href="ui-out_8h.html#ac5d0187f97768dc203458ddf644e0c7aac8a02f1b44706ba412f42aa3fc249695">ui_left</a>, <span class="stringliteral">&quot;lsa&quot;</span>, <span class="stringliteral">&quot;LSA&quot;</span>);
<a name="l02349"></a>02349   <a class="code" href="ui-out_8c.html#a6a85ff75fa4ac345725a2fd58498173f">ui_out_table_header</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, 7, <a class="code" href="ui-out_8h.html#ac5d0187f97768dc203458ddf644e0c7aac8a02f1b44706ba412f42aa3fc249695">ui_left</a>, <span class="stringliteral">&quot;size&quot;</span>, <span class="stringliteral">&quot;Size&quot;</span>);
<a name="l02350"></a>02350   <a class="code" href="ui-out_8c.html#a6a85ff75fa4ac345725a2fd58498173f">ui_out_table_header</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, 7, <a class="code" href="ui-out_8h.html#ac5d0187f97768dc203458ddf644e0c7aac8a02f1b44706ba412f42aa3fc249695">ui_left</a>, <span class="stringliteral">&quot;lstaddr&quot;</span>, <span class="stringliteral">&quot;LstAddr&quot;</span>);
<a name="l02351"></a>02351   <a class="code" href="ui-out_8c.html#a6a85ff75fa4ac345725a2fd58498173f">ui_out_table_header</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, 7, <a class="code" href="ui-out_8h.html#ac5d0187f97768dc203458ddf644e0c7aac8a02f1b44706ba412f42aa3fc249695">ui_left</a>, <span class="stringliteral">&quot;lstsize&quot;</span>, <span class="stringliteral">&quot;LstSize&quot;</span>);
<a name="l02352"></a>02352   <a class="code" href="ui-out_8c.html#a6a85ff75fa4ac345725a2fd58498173f">ui_out_table_header</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, 1, <a class="code" href="ui-out_8h.html#ac5d0187f97768dc203458ddf644e0c7aac8a02f1b44706ba412f42aa3fc249695">ui_left</a>, <span class="stringliteral">&quot;error_p&quot;</span>, <span class="stringliteral">&quot;E&quot;</span>);
<a name="l02353"></a>02353 
<a name="l02354"></a>02354   <a class="code" href="ui-out_8c.html#a07042144a117bc974f5c41761b68975e">ui_out_table_body</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>);
<a name="l02355"></a>02355 
<a name="l02356"></a>02356   <span class="keywordflow">for</span> (i = 0; i &lt; nr; i++)
<a name="l02357"></a>02357     {
<a name="l02358"></a>02358       <span class="keyword">struct </span><a class="code" href="structcleanup.html">cleanup</a> *cmd_chain;
<a name="l02359"></a>02359       <a class="code" href="defs_8h.html#a4df4af8771b1016a24976757026f4984">ULONGEST</a> mfc_cq_dw0;
<a name="l02360"></a>02360       <a class="code" href="defs_8h.html#a4df4af8771b1016a24976757026f4984">ULONGEST</a> mfc_cq_dw1;
<a name="l02361"></a>02361       <a class="code" href="defs_8h.html#a4df4af8771b1016a24976757026f4984">ULONGEST</a> mfc_cq_dw2;
<a name="l02362"></a>02362       <span class="keywordtype">int</span> mfc_cmd_opcode, mfc_cmd_tag, rclass_id, tclass_id;
<a name="l02363"></a>02363       <span class="keywordtype">int</span> list_lsa, list_size, mfc_lsa, mfc_size;
<a name="l02364"></a>02364       <a class="code" href="defs_8h.html#a4df4af8771b1016a24976757026f4984">ULONGEST</a> mfc_ea;
<a name="l02365"></a>02365       <span class="keywordtype">int</span> list_valid_p, noop_valid_p, qw_valid_p, ea_valid_p, cmd_error_p;
<a name="l02366"></a>02366 
<a name="l02367"></a>02367       <span class="comment">/* Decode contents of MFC Command Queue Context Save/Restore Registers.</span>
<a name="l02368"></a>02368 <span class="comment">         See &quot;Cell Broadband Engine Registers V1.3&quot;, section 3.3.2.1.  */</span>
<a name="l02369"></a>02369 
<a name="l02370"></a>02370       mfc_cq_dw0
<a name="l02371"></a>02371         = <a class="code" href="defs_8h.html#a99aec65329508b4d449a4f881026f844">extract_unsigned_integer</a> (buf + 32*seq[i], 8, byte_order);
<a name="l02372"></a>02372       mfc_cq_dw1
<a name="l02373"></a>02373         = <a class="code" href="defs_8h.html#a99aec65329508b4d449a4f881026f844">extract_unsigned_integer</a> (buf + 32*seq[i] + 8, 8, byte_order);
<a name="l02374"></a>02374       mfc_cq_dw2
<a name="l02375"></a>02375         = <a class="code" href="defs_8h.html#a99aec65329508b4d449a4f881026f844">extract_unsigned_integer</a> (buf + 32*seq[i] + 16, 8, byte_order);
<a name="l02376"></a>02376 
<a name="l02377"></a>02377       list_lsa = <a class="code" href="spu-tdep_8c.html#ac3f896555be04b727f6bca768f363a61">spu_mfc_get_bitfield</a> (mfc_cq_dw0, 0, 14);
<a name="l02378"></a>02378       list_size = <a class="code" href="spu-tdep_8c.html#ac3f896555be04b727f6bca768f363a61">spu_mfc_get_bitfield</a> (mfc_cq_dw0, 15, 26);
<a name="l02379"></a>02379       mfc_cmd_opcode = <a class="code" href="spu-tdep_8c.html#ac3f896555be04b727f6bca768f363a61">spu_mfc_get_bitfield</a> (mfc_cq_dw0, 27, 34);
<a name="l02380"></a>02380       mfc_cmd_tag = <a class="code" href="spu-tdep_8c.html#ac3f896555be04b727f6bca768f363a61">spu_mfc_get_bitfield</a> (mfc_cq_dw0, 35, 39);
<a name="l02381"></a>02381       list_valid_p = <a class="code" href="spu-tdep_8c.html#ac3f896555be04b727f6bca768f363a61">spu_mfc_get_bitfield</a> (mfc_cq_dw0, 40, 40);
<a name="l02382"></a>02382       rclass_id = <a class="code" href="spu-tdep_8c.html#ac3f896555be04b727f6bca768f363a61">spu_mfc_get_bitfield</a> (mfc_cq_dw0, 41, 43);
<a name="l02383"></a>02383       tclass_id = <a class="code" href="spu-tdep_8c.html#ac3f896555be04b727f6bca768f363a61">spu_mfc_get_bitfield</a> (mfc_cq_dw0, 44, 46);
<a name="l02384"></a>02384 
<a name="l02385"></a>02385       mfc_ea = <a class="code" href="spu-tdep_8c.html#ac3f896555be04b727f6bca768f363a61">spu_mfc_get_bitfield</a> (mfc_cq_dw1, 0, 51) &lt;&lt; 12
<a name="l02386"></a>02386                 | <a class="code" href="spu-tdep_8c.html#ac3f896555be04b727f6bca768f363a61">spu_mfc_get_bitfield</a> (mfc_cq_dw2, 25, 36);
<a name="l02387"></a>02387 
<a name="l02388"></a>02388       mfc_lsa = <a class="code" href="spu-tdep_8c.html#ac3f896555be04b727f6bca768f363a61">spu_mfc_get_bitfield</a> (mfc_cq_dw2, 0, 13);
<a name="l02389"></a>02389       mfc_size = <a class="code" href="spu-tdep_8c.html#ac3f896555be04b727f6bca768f363a61">spu_mfc_get_bitfield</a> (mfc_cq_dw2, 14, 24);
<a name="l02390"></a>02390       noop_valid_p = <a class="code" href="spu-tdep_8c.html#ac3f896555be04b727f6bca768f363a61">spu_mfc_get_bitfield</a> (mfc_cq_dw2, 37, 37);
<a name="l02391"></a>02391       qw_valid_p = <a class="code" href="spu-tdep_8c.html#ac3f896555be04b727f6bca768f363a61">spu_mfc_get_bitfield</a> (mfc_cq_dw2, 38, 38);
<a name="l02392"></a>02392       ea_valid_p = <a class="code" href="spu-tdep_8c.html#ac3f896555be04b727f6bca768f363a61">spu_mfc_get_bitfield</a> (mfc_cq_dw2, 39, 39);
<a name="l02393"></a>02393       cmd_error_p = <a class="code" href="spu-tdep_8c.html#ac3f896555be04b727f6bca768f363a61">spu_mfc_get_bitfield</a> (mfc_cq_dw2, 40, 40);
<a name="l02394"></a>02394 
<a name="l02395"></a>02395       cmd_chain = <a class="code" href="ui-out_8c.html#aaf5a0c991d74ad2e486f420d5c2ff058">make_cleanup_ui_out_tuple_begin_end</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, <span class="stringliteral">&quot;cmd&quot;</span>);
<a name="l02396"></a>02396 
<a name="l02397"></a>02397       <span class="keywordflow">if</span> (spu_mfc_opcode[mfc_cmd_opcode])
<a name="l02398"></a>02398         <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, <span class="stringliteral">&quot;opcode&quot;</span>, spu_mfc_opcode[mfc_cmd_opcode]);
<a name="l02399"></a>02399       <span class="keywordflow">else</span>
<a name="l02400"></a>02400         <a class="code" href="ui-out_8c.html#aa6f66551d03db456fb94ca1c9038f5a0">ui_out_field_int</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, <span class="stringliteral">&quot;opcode&quot;</span>, mfc_cmd_opcode);
<a name="l02401"></a>02401 
<a name="l02402"></a>02402       <a class="code" href="ui-out_8c.html#aa6f66551d03db456fb94ca1c9038f5a0">ui_out_field_int</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, <span class="stringliteral">&quot;tag&quot;</span>, mfc_cmd_tag);
<a name="l02403"></a>02403       <a class="code" href="ui-out_8c.html#aa6f66551d03db456fb94ca1c9038f5a0">ui_out_field_int</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, <span class="stringliteral">&quot;tid&quot;</span>, tclass_id);
<a name="l02404"></a>02404       <a class="code" href="ui-out_8c.html#aa6f66551d03db456fb94ca1c9038f5a0">ui_out_field_int</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, <span class="stringliteral">&quot;rid&quot;</span>, rclass_id);
<a name="l02405"></a>02405 
<a name="l02406"></a>02406       <span class="keywordflow">if</span> (ea_valid_p)
<a name="l02407"></a>02407         <a class="code" href="ui-out_8c.html#ac29596ba86f387928e0d3e6b7385f998">ui_out_field_fmt</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, <span class="stringliteral">&quot;ea&quot;</span>, <span class="stringliteral">&quot;0x%s&quot;</span>, <a class="code" href="utils_8c.html#a74449c9bb8c40997e79f44a3c2db935c">phex</a> (mfc_ea, 8));
<a name="l02408"></a>02408       <span class="keywordflow">else</span>
<a name="l02409"></a>02409         <a class="code" href="ui-out_8c.html#a5366a822858ecedafef54625bec57442">ui_out_field_skip</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, <span class="stringliteral">&quot;ea&quot;</span>);
<a name="l02410"></a>02410 
<a name="l02411"></a>02411       <a class="code" href="ui-out_8c.html#ac29596ba86f387928e0d3e6b7385f998">ui_out_field_fmt</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, <span class="stringliteral">&quot;lsa&quot;</span>, <span class="stringliteral">&quot;0x%05x&quot;</span>, mfc_lsa &lt;&lt; 4);
<a name="l02412"></a>02412       <span class="keywordflow">if</span> (qw_valid_p)
<a name="l02413"></a>02413         <a class="code" href="ui-out_8c.html#ac29596ba86f387928e0d3e6b7385f998">ui_out_field_fmt</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, <span class="stringliteral">&quot;size&quot;</span>, <span class="stringliteral">&quot;0x%05x&quot;</span>, mfc_size &lt;&lt; 4);
<a name="l02414"></a>02414       <span class="keywordflow">else</span>
<a name="l02415"></a>02415         <a class="code" href="ui-out_8c.html#ac29596ba86f387928e0d3e6b7385f998">ui_out_field_fmt</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, <span class="stringliteral">&quot;size&quot;</span>, <span class="stringliteral">&quot;0x%05x&quot;</span>, mfc_size);
<a name="l02416"></a>02416 
<a name="l02417"></a>02417       <span class="keywordflow">if</span> (list_valid_p)
<a name="l02418"></a>02418         {
<a name="l02419"></a>02419           <a class="code" href="ui-out_8c.html#ac29596ba86f387928e0d3e6b7385f998">ui_out_field_fmt</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, <span class="stringliteral">&quot;lstaddr&quot;</span>, <span class="stringliteral">&quot;0x%05x&quot;</span>, list_lsa &lt;&lt; 3);
<a name="l02420"></a>02420           <a class="code" href="ui-out_8c.html#ac29596ba86f387928e0d3e6b7385f998">ui_out_field_fmt</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, <span class="stringliteral">&quot;lstsize&quot;</span>, <span class="stringliteral">&quot;0x%05x&quot;</span>, list_size &lt;&lt; 3);
<a name="l02421"></a>02421         }
<a name="l02422"></a>02422       <span class="keywordflow">else</span>
<a name="l02423"></a>02423         {
<a name="l02424"></a>02424           <a class="code" href="ui-out_8c.html#a5366a822858ecedafef54625bec57442">ui_out_field_skip</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, <span class="stringliteral">&quot;lstaddr&quot;</span>);
<a name="l02425"></a>02425           <a class="code" href="ui-out_8c.html#a5366a822858ecedafef54625bec57442">ui_out_field_skip</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, <span class="stringliteral">&quot;lstsize&quot;</span>);
<a name="l02426"></a>02426         }
<a name="l02427"></a>02427 
<a name="l02428"></a>02428       <span class="keywordflow">if</span> (cmd_error_p)
<a name="l02429"></a>02429         <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, <span class="stringliteral">&quot;error_p&quot;</span>, <span class="stringliteral">&quot;*&quot;</span>);
<a name="l02430"></a>02430       <span class="keywordflow">else</span>
<a name="l02431"></a>02431         <a class="code" href="ui-out_8c.html#a5366a822858ecedafef54625bec57442">ui_out_field_skip</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, <span class="stringliteral">&quot;error_p&quot;</span>);
<a name="l02432"></a>02432 
<a name="l02433"></a>02433       <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (cmd_chain);
<a name="l02434"></a>02434 
<a name="l02435"></a>02435       <span class="keywordflow">if</span> (!<a class="code" href="ui-out_8c.html#a473db54efcfbc60feeb5a4f54f27af46">ui_out_is_mi_like_p</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>))
<a name="l02436"></a>02436         <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l02437"></a>02437     }
<a name="l02438"></a>02438 
<a name="l02439"></a>02439   <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (chain);
<a name="l02440"></a>02440 }
<a name="l02441"></a>02441 
<a name="l02442"></a>02442 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l02443"></a><a class="code" href="spu-tdep_8c.html#a4a6f08013b067a99a6fd7474c6f9c8b5">02443</a> <a class="code" href="spu-tdep_8c.html#a4a6f08013b067a99a6fd7474c6f9c8b5">info_spu_dma_command</a> (<span class="keywordtype">char</span> *args, <span class="keywordtype">int</span> from_tty)
<a name="l02444"></a>02444 {
<a name="l02445"></a>02445   <span class="keyword">struct </span><a class="code" href="structframe__info.html">frame_info</a> *frame = <a class="code" href="frame_8c.html#a8b714a78478670e14a297eba8d1a9915">get_selected_frame</a> (NULL);
<a name="l02446"></a>02446   <span class="keyword">struct </span>gdbarch *gdbarch = <a class="code" href="frame_8c.html#ab44507b5655da44e522ed5857835ede7">get_frame_arch</a> (frame);
<a name="l02447"></a>02447   <span class="keyword">enum</span> bfd_endian <a class="code" href="structgdbarch.html#a7a9dd6544406e9cbb574dae9d531346e">byte_order</a> = <a class="code" href="gdbarch_8c.html#abc300a3797421aa7342b288e1637483e">gdbarch_byte_order</a> (gdbarch);
<a name="l02448"></a>02448   <a class="code" href="defs_8h.html#a4df4af8771b1016a24976757026f4984">ULONGEST</a> dma_info_type;
<a name="l02449"></a>02449   <a class="code" href="defs_8h.html#a4df4af8771b1016a24976757026f4984">ULONGEST</a> dma_info_mask;
<a name="l02450"></a>02450   <a class="code" href="defs_8h.html#a4df4af8771b1016a24976757026f4984">ULONGEST</a> dma_info_status;
<a name="l02451"></a>02451   <a class="code" href="defs_8h.html#a4df4af8771b1016a24976757026f4984">ULONGEST</a> dma_info_stall_and_notify;
<a name="l02452"></a>02452   <a class="code" href="defs_8h.html#a4df4af8771b1016a24976757026f4984">ULONGEST</a> dma_info_atomic_command_status;
<a name="l02453"></a>02453   <span class="keyword">struct </span><a class="code" href="structcleanup.html">cleanup</a> *chain;
<a name="l02454"></a>02454   <span class="keywordtype">char</span> annex[32];
<a name="l02455"></a>02455   <a class="code" href="defs_8h.html#a336b399b3b83dbcc61f176c33f26b607">gdb_byte</a> buf[1024];
<a name="l02456"></a>02456   <a class="code" href="defs_8h.html#ac7647a3f71533007c9e128f3ddda1987">LONGEST</a> <a class="code" href="exec_8h.html#a00f945351279d3c8935f13d2b9f9b808">len</a>;
<a name="l02457"></a>02457   <span class="keywordtype">int</span> id;
<a name="l02458"></a>02458 
<a name="l02459"></a>02459   <span class="keywordflow">if</span> (<a class="code" href="gdbarch_8c.html#a305465885963fbf0fb5a7543594a7bff">gdbarch_bfd_arch_info</a> (<a class="code" href="frame_8c.html#ab44507b5655da44e522ed5857835ede7">get_frame_arch</a> (frame))-&gt;arch != bfd_arch_spu)
<a name="l02460"></a>02460     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\&quot;info spu\&quot; is only supported on the SPU architecture.&quot;</span>));
<a name="l02461"></a>02461 
<a name="l02462"></a>02462   <span class="keywordtype">id</span> = <a class="code" href="frame_8c.html#affa785e8937e96fd727e46a2cfec94c4">get_frame_register_unsigned</a> (frame, <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4ca2d3903584b23e19e9df838dc3939cf45">SPU_ID_REGNUM</a>);
<a name="l02463"></a>02463 
<a name="l02464"></a>02464   <a class="code" href="common-utils_8c.html#ad9940337ec98983dae9951c947879fc8">xsnprintf</a> (annex, <span class="keyword">sizeof</span> annex, <span class="stringliteral">&quot;%d/dma_info&quot;</span>, <span class="keywordtype">id</span>);
<a name="l02465"></a>02465   len = <a class="code" href="target_8c.html#aac7df8f3a1d061c97c45219ed0cace6c">target_read</a> (&amp;<a class="code" href="target_8h.html#a2d8640b030266b58d3821eb5cfd112b9">current_target</a>, <a class="code" href="target_8h.html#aa5a3e4ceb377c9f5822cdc68c6f138e2a09790d59558546bb5ab8aa15ae6fbc74">TARGET_OBJECT_SPU</a>, annex,
<a name="l02466"></a>02466                      buf, 0, 40 + 16 * 32);
<a name="l02467"></a>02467   <span class="keywordflow">if</span> (len &lt;= 0)
<a name="l02468"></a>02468     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Could not read dma_info.&quot;</span>));
<a name="l02469"></a>02469 
<a name="l02470"></a>02470   dma_info_type
<a name="l02471"></a>02471     = <a class="code" href="defs_8h.html#a99aec65329508b4d449a4f881026f844">extract_unsigned_integer</a> (buf, 8, byte_order);
<a name="l02472"></a>02472   dma_info_mask
<a name="l02473"></a>02473     = <a class="code" href="defs_8h.html#a99aec65329508b4d449a4f881026f844">extract_unsigned_integer</a> (buf + 8, 8, byte_order);
<a name="l02474"></a>02474   dma_info_status
<a name="l02475"></a>02475     = <a class="code" href="defs_8h.html#a99aec65329508b4d449a4f881026f844">extract_unsigned_integer</a> (buf + 16, 8, byte_order);
<a name="l02476"></a>02476   dma_info_stall_and_notify
<a name="l02477"></a>02477     = <a class="code" href="defs_8h.html#a99aec65329508b4d449a4f881026f844">extract_unsigned_integer</a> (buf + 24, 8, byte_order);
<a name="l02478"></a>02478   dma_info_atomic_command_status
<a name="l02479"></a>02479     = <a class="code" href="defs_8h.html#a99aec65329508b4d449a4f881026f844">extract_unsigned_integer</a> (buf + 32, 8, byte_order);
<a name="l02480"></a>02480   
<a name="l02481"></a>02481   chain = <a class="code" href="ui-out_8c.html#aaf5a0c991d74ad2e486f420d5c2ff058">make_cleanup_ui_out_tuple_begin_end</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, <span class="stringliteral">&quot;SPUInfoDMA&quot;</span>);
<a name="l02482"></a>02482 
<a name="l02483"></a>02483   <span class="keywordflow">if</span> (<a class="code" href="ui-out_8c.html#a473db54efcfbc60feeb5a4f54f27af46">ui_out_is_mi_like_p</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>))
<a name="l02484"></a>02484     {
<a name="l02485"></a>02485       <a class="code" href="ui-out_8c.html#ac29596ba86f387928e0d3e6b7385f998">ui_out_field_fmt</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, <span class="stringliteral">&quot;dma_info_type&quot;</span>, <span class="stringliteral">&quot;0x%s&quot;</span>,
<a name="l02486"></a>02486                         <a class="code" href="utils_8c.html#ac2742d41c48dc5ede26d22070fbc486a">phex_nz</a> (dma_info_type, 4));
<a name="l02487"></a>02487       <a class="code" href="ui-out_8c.html#ac29596ba86f387928e0d3e6b7385f998">ui_out_field_fmt</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, <span class="stringliteral">&quot;dma_info_mask&quot;</span>, <span class="stringliteral">&quot;0x%s&quot;</span>,
<a name="l02488"></a>02488                         <a class="code" href="utils_8c.html#ac2742d41c48dc5ede26d22070fbc486a">phex_nz</a> (dma_info_mask, 4));
<a name="l02489"></a>02489       <a class="code" href="ui-out_8c.html#ac29596ba86f387928e0d3e6b7385f998">ui_out_field_fmt</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, <span class="stringliteral">&quot;dma_info_status&quot;</span>, <span class="stringliteral">&quot;0x%s&quot;</span>,
<a name="l02490"></a>02490                         <a class="code" href="utils_8c.html#ac2742d41c48dc5ede26d22070fbc486a">phex_nz</a> (dma_info_status, 4));
<a name="l02491"></a>02491       <a class="code" href="ui-out_8c.html#ac29596ba86f387928e0d3e6b7385f998">ui_out_field_fmt</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, <span class="stringliteral">&quot;dma_info_stall_and_notify&quot;</span>, <span class="stringliteral">&quot;0x%s&quot;</span>,
<a name="l02492"></a>02492                         <a class="code" href="utils_8c.html#ac2742d41c48dc5ede26d22070fbc486a">phex_nz</a> (dma_info_stall_and_notify, 4));
<a name="l02493"></a>02493       <a class="code" href="ui-out_8c.html#ac29596ba86f387928e0d3e6b7385f998">ui_out_field_fmt</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, <span class="stringliteral">&quot;dma_info_atomic_command_status&quot;</span>, <span class="stringliteral">&quot;0x%s&quot;</span>,
<a name="l02494"></a>02494                         <a class="code" href="utils_8c.html#ac2742d41c48dc5ede26d22070fbc486a">phex_nz</a> (dma_info_atomic_command_status, 4));
<a name="l02495"></a>02495     }
<a name="l02496"></a>02496   <span class="keywordflow">else</span>
<a name="l02497"></a>02497     {
<a name="l02498"></a>02498       <span class="keyword">const</span> <span class="keywordtype">char</span> *query_msg = <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;no query pending&quot;</span>);
<a name="l02499"></a>02499 
<a name="l02500"></a>02500       <span class="keywordflow">if</span> (dma_info_type &amp; 4)
<a name="l02501"></a>02501         <span class="keywordflow">switch</span> (dma_info_type &amp; 3)
<a name="l02502"></a>02502           {
<a name="l02503"></a>02503             <span class="keywordflow">case</span> 1: query_msg = <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;&#39;any&#39; query pending&quot;</span>); <span class="keywordflow">break</span>;
<a name="l02504"></a>02504             <span class="keywordflow">case</span> 2: query_msg = <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;&#39;all&#39; query pending&quot;</span>); <span class="keywordflow">break</span>;
<a name="l02505"></a>02505             <span class="keywordflow">default</span>: query_msg = <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;undefined query type&quot;</span>); <span class="keywordflow">break</span>;
<a name="l02506"></a>02506           }
<a name="l02507"></a>02507 
<a name="l02508"></a>02508       <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Tag-Group Status  0x%s\n&quot;</span>),
<a name="l02509"></a>02509                        <a class="code" href="utils_8c.html#a74449c9bb8c40997e79f44a3c2db935c">phex</a> (dma_info_status, 4));
<a name="l02510"></a>02510       <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Tag-Group Mask    0x%s (%s)\n&quot;</span>),
<a name="l02511"></a>02511                        <a class="code" href="utils_8c.html#a74449c9bb8c40997e79f44a3c2db935c">phex</a> (dma_info_mask, 4), query_msg);
<a name="l02512"></a>02512       <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Stall-and-Notify  0x%s\n&quot;</span>),
<a name="l02513"></a>02513                        <a class="code" href="utils_8c.html#a74449c9bb8c40997e79f44a3c2db935c">phex</a> (dma_info_stall_and_notify, 4));
<a name="l02514"></a>02514       <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Atomic Cmd Status 0x%s\n&quot;</span>),
<a name="l02515"></a>02515                        <a class="code" href="utils_8c.html#a74449c9bb8c40997e79f44a3c2db935c">phex</a> (dma_info_atomic_command_status, 4));
<a name="l02516"></a>02516       <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l02517"></a>02517     }
<a name="l02518"></a>02518 
<a name="l02519"></a>02519   <a class="code" href="spu-tdep_8c.html#a8c9994818046a2cc058b90377c1a634e">info_spu_dma_cmdlist</a> (buf + 40, 16, byte_order);
<a name="l02520"></a>02520   <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (chain);
<a name="l02521"></a>02521 }
<a name="l02522"></a>02522 
<a name="l02523"></a>02523 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l02524"></a><a class="code" href="spu-tdep_8c.html#a34d841476aad999840bfa1f83fe3bb81">02524</a> <a class="code" href="spu-tdep_8c.html#a34d841476aad999840bfa1f83fe3bb81">info_spu_proxydma_command</a> (<span class="keywordtype">char</span> *args, <span class="keywordtype">int</span> from_tty)
<a name="l02525"></a>02525 {
<a name="l02526"></a>02526   <span class="keyword">struct </span><a class="code" href="structframe__info.html">frame_info</a> *frame = <a class="code" href="frame_8c.html#a8b714a78478670e14a297eba8d1a9915">get_selected_frame</a> (NULL);
<a name="l02527"></a>02527   <span class="keyword">struct </span>gdbarch *gdbarch = <a class="code" href="frame_8c.html#ab44507b5655da44e522ed5857835ede7">get_frame_arch</a> (frame);
<a name="l02528"></a>02528   <span class="keyword">enum</span> bfd_endian <a class="code" href="structgdbarch.html#a7a9dd6544406e9cbb574dae9d531346e">byte_order</a> = <a class="code" href="gdbarch_8c.html#abc300a3797421aa7342b288e1637483e">gdbarch_byte_order</a> (gdbarch);
<a name="l02529"></a>02529   <a class="code" href="defs_8h.html#a4df4af8771b1016a24976757026f4984">ULONGEST</a> dma_info_type;
<a name="l02530"></a>02530   <a class="code" href="defs_8h.html#a4df4af8771b1016a24976757026f4984">ULONGEST</a> dma_info_mask;
<a name="l02531"></a>02531   <a class="code" href="defs_8h.html#a4df4af8771b1016a24976757026f4984">ULONGEST</a> dma_info_status;
<a name="l02532"></a>02532   <span class="keyword">struct </span><a class="code" href="structcleanup.html">cleanup</a> *chain;
<a name="l02533"></a>02533   <span class="keywordtype">char</span> annex[32];
<a name="l02534"></a>02534   <a class="code" href="defs_8h.html#a336b399b3b83dbcc61f176c33f26b607">gdb_byte</a> buf[1024];
<a name="l02535"></a>02535   <a class="code" href="defs_8h.html#ac7647a3f71533007c9e128f3ddda1987">LONGEST</a> <a class="code" href="exec_8h.html#a00f945351279d3c8935f13d2b9f9b808">len</a>;
<a name="l02536"></a>02536   <span class="keywordtype">int</span> id;
<a name="l02537"></a>02537 
<a name="l02538"></a>02538   <span class="keywordflow">if</span> (<a class="code" href="gdbarch_8c.html#a305465885963fbf0fb5a7543594a7bff">gdbarch_bfd_arch_info</a> (gdbarch)-&gt;arch != bfd_arch_spu)
<a name="l02539"></a>02539     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\&quot;info spu\&quot; is only supported on the SPU architecture.&quot;</span>));
<a name="l02540"></a>02540 
<a name="l02541"></a>02541   <span class="keywordtype">id</span> = <a class="code" href="frame_8c.html#affa785e8937e96fd727e46a2cfec94c4">get_frame_register_unsigned</a> (frame, <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4ca2d3903584b23e19e9df838dc3939cf45">SPU_ID_REGNUM</a>);
<a name="l02542"></a>02542 
<a name="l02543"></a>02543   <a class="code" href="common-utils_8c.html#ad9940337ec98983dae9951c947879fc8">xsnprintf</a> (annex, <span class="keyword">sizeof</span> annex, <span class="stringliteral">&quot;%d/proxydma_info&quot;</span>, <span class="keywordtype">id</span>);
<a name="l02544"></a>02544   len = <a class="code" href="target_8c.html#aac7df8f3a1d061c97c45219ed0cace6c">target_read</a> (&amp;<a class="code" href="target_8h.html#a2d8640b030266b58d3821eb5cfd112b9">current_target</a>, <a class="code" href="target_8h.html#aa5a3e4ceb377c9f5822cdc68c6f138e2a09790d59558546bb5ab8aa15ae6fbc74">TARGET_OBJECT_SPU</a>, annex,
<a name="l02545"></a>02545                      buf, 0, 24 + 8 * 32);
<a name="l02546"></a>02546   <span class="keywordflow">if</span> (len &lt;= 0)
<a name="l02547"></a>02547     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Could not read proxydma_info.&quot;</span>));
<a name="l02548"></a>02548 
<a name="l02549"></a>02549   dma_info_type = <a class="code" href="defs_8h.html#a99aec65329508b4d449a4f881026f844">extract_unsigned_integer</a> (buf, 8, byte_order);
<a name="l02550"></a>02550   dma_info_mask = <a class="code" href="defs_8h.html#a99aec65329508b4d449a4f881026f844">extract_unsigned_integer</a> (buf + 8, 8, byte_order);
<a name="l02551"></a>02551   dma_info_status = <a class="code" href="defs_8h.html#a99aec65329508b4d449a4f881026f844">extract_unsigned_integer</a> (buf + 16, 8, byte_order);
<a name="l02552"></a>02552   
<a name="l02553"></a>02553   chain = <a class="code" href="ui-out_8c.html#aaf5a0c991d74ad2e486f420d5c2ff058">make_cleanup_ui_out_tuple_begin_end</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>,
<a name="l02554"></a>02554                                                <span class="stringliteral">&quot;SPUInfoProxyDMA&quot;</span>);
<a name="l02555"></a>02555 
<a name="l02556"></a>02556   <span class="keywordflow">if</span> (<a class="code" href="ui-out_8c.html#a473db54efcfbc60feeb5a4f54f27af46">ui_out_is_mi_like_p</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>))
<a name="l02557"></a>02557     {
<a name="l02558"></a>02558       <a class="code" href="ui-out_8c.html#ac29596ba86f387928e0d3e6b7385f998">ui_out_field_fmt</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, <span class="stringliteral">&quot;proxydma_info_type&quot;</span>, <span class="stringliteral">&quot;0x%s&quot;</span>,
<a name="l02559"></a>02559                         <a class="code" href="utils_8c.html#ac2742d41c48dc5ede26d22070fbc486a">phex_nz</a> (dma_info_type, 4));
<a name="l02560"></a>02560       <a class="code" href="ui-out_8c.html#ac29596ba86f387928e0d3e6b7385f998">ui_out_field_fmt</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, <span class="stringliteral">&quot;proxydma_info_mask&quot;</span>, <span class="stringliteral">&quot;0x%s&quot;</span>,
<a name="l02561"></a>02561                         <a class="code" href="utils_8c.html#ac2742d41c48dc5ede26d22070fbc486a">phex_nz</a> (dma_info_mask, 4));
<a name="l02562"></a>02562       <a class="code" href="ui-out_8c.html#ac29596ba86f387928e0d3e6b7385f998">ui_out_field_fmt</a> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>, <span class="stringliteral">&quot;proxydma_info_status&quot;</span>, <span class="stringliteral">&quot;0x%s&quot;</span>,
<a name="l02563"></a>02563                         <a class="code" href="utils_8c.html#ac2742d41c48dc5ede26d22070fbc486a">phex_nz</a> (dma_info_status, 4));
<a name="l02564"></a>02564     }
<a name="l02565"></a>02565   <span class="keywordflow">else</span>
<a name="l02566"></a>02566     {
<a name="l02567"></a>02567       <span class="keyword">const</span> <span class="keywordtype">char</span> *query_msg;
<a name="l02568"></a>02568 
<a name="l02569"></a>02569       <span class="keywordflow">switch</span> (dma_info_type &amp; 3)
<a name="l02570"></a>02570         {
<a name="l02571"></a>02571         <span class="keywordflow">case</span> 0: query_msg = <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;no query pending&quot;</span>); <span class="keywordflow">break</span>;
<a name="l02572"></a>02572         <span class="keywordflow">case</span> 1: query_msg = <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;&#39;any&#39; query pending&quot;</span>); <span class="keywordflow">break</span>;
<a name="l02573"></a>02573         <span class="keywordflow">case</span> 2: query_msg = <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;&#39;all&#39; query pending&quot;</span>); <span class="keywordflow">break</span>;
<a name="l02574"></a>02574         <span class="keywordflow">default</span>: query_msg = <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;undefined query type&quot;</span>); <span class="keywordflow">break</span>;
<a name="l02575"></a>02575         }
<a name="l02576"></a>02576 
<a name="l02577"></a>02577       <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Tag-Group Status  0x%s\n&quot;</span>),
<a name="l02578"></a>02578                        <a class="code" href="utils_8c.html#a74449c9bb8c40997e79f44a3c2db935c">phex</a> (dma_info_status, 4));
<a name="l02579"></a>02579       <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Tag-Group Mask    0x%s (%s)\n&quot;</span>),
<a name="l02580"></a>02580                        <a class="code" href="utils_8c.html#a74449c9bb8c40997e79f44a3c2db935c">phex</a> (dma_info_mask, 4), query_msg);
<a name="l02581"></a>02581       <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l02582"></a>02582     }
<a name="l02583"></a>02583 
<a name="l02584"></a>02584   <a class="code" href="spu-tdep_8c.html#a8c9994818046a2cc058b90377c1a634e">info_spu_dma_cmdlist</a> (buf + 24, 8, byte_order);
<a name="l02585"></a>02585   <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (chain);
<a name="l02586"></a>02586 }
<a name="l02587"></a>02587 
<a name="l02588"></a>02588 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l02589"></a><a class="code" href="spu-tdep_8c.html#a68b8fe98fd8f08f382945ad6a7df4e06">02589</a> <a class="code" href="spu-tdep_8c.html#a68b8fe98fd8f08f382945ad6a7df4e06">info_spu_command</a> (<span class="keywordtype">char</span> *args, <span class="keywordtype">int</span> from_tty)
<a name="l02590"></a>02590 {
<a name="l02591"></a>02591   <a class="code" href="utils_8c.html#ad57145632bbcb0361dc1dfa134b1efd0">printf_unfiltered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\&quot;info spu\&quot; must be followed by &quot;</span>
<a name="l02592"></a>02592                        <span class="stringliteral">&quot;the name of an SPU facility.\n&quot;</span>));
<a name="l02593"></a>02593   <a class="code" href="cli-decode_8c.html#a2ae762f5189f3597666852868defc038">help_list</a> (infospucmdlist, <span class="stringliteral">&quot;info spu &quot;</span>, -1, <a class="code" href="main_8c.html#a41a2b997ba5454df787d61f051dd918c">gdb_stdout</a>);
<a name="l02594"></a>02594 }
<a name="l02595"></a>02595 
<a name="l02596"></a>02596 
<a name="l02597"></a>02597 <span class="comment">/* Root of all &quot;set spu &quot;/&quot;show spu &quot; commands.  */</span>
<a name="l02598"></a>02598 
<a name="l02599"></a>02599 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l02600"></a><a class="code" href="spu-tdep_8c.html#a7d590d17cadbe4944c9563d2f4d3a533">02600</a> <a class="code" href="spu-tdep_8c.html#a7d590d17cadbe4944c9563d2f4d3a533">show_spu_command</a> (<span class="keywordtype">char</span> *args, <span class="keywordtype">int</span> from_tty)
<a name="l02601"></a>02601 {
<a name="l02602"></a>02602   <a class="code" href="cli-decode_8c.html#a2ae762f5189f3597666852868defc038">help_list</a> (showspucmdlist, <span class="stringliteral">&quot;show spu &quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a470d2795fd53d63204eb7343b0c8bb50">all_commands</a>, <a class="code" href="main_8c.html#a41a2b997ba5454df787d61f051dd918c">gdb_stdout</a>);
<a name="l02603"></a>02603 }
<a name="l02604"></a>02604 
<a name="l02605"></a>02605 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l02606"></a><a class="code" href="spu-tdep_8c.html#a08ffa98505d8283a448788093e2246eb">02606</a> <a class="code" href="spu-tdep_8c.html#a08ffa98505d8283a448788093e2246eb">set_spu_command</a> (<span class="keywordtype">char</span> *args, <span class="keywordtype">int</span> from_tty)
<a name="l02607"></a>02607 {
<a name="l02608"></a>02608   <a class="code" href="cli-decode_8c.html#a2ae762f5189f3597666852868defc038">help_list</a> (setspucmdlist, <span class="stringliteral">&quot;set spu &quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a470d2795fd53d63204eb7343b0c8bb50">all_commands</a>, <a class="code" href="main_8c.html#a41a2b997ba5454df787d61f051dd918c">gdb_stdout</a>);
<a name="l02609"></a>02609 }
<a name="l02610"></a>02610 
<a name="l02611"></a>02611 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l02612"></a><a class="code" href="spu-tdep_8c.html#ad2009098c3d846884f2167006043a092">02612</a> <a class="code" href="spu-tdep_8c.html#ad2009098c3d846884f2167006043a092">show_spu_stop_on_load</a> (<span class="keyword">struct</span> <a class="code" href="structui__file.html">ui_file</a> *file, <span class="keywordtype">int</span> from_tty,
<a name="l02613"></a>02613                        <span class="keyword">struct</span> <a class="code" href="structcmd__list__element.html">cmd_list_element</a> *c, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structvalue.html">value</a>)
<a name="l02614"></a>02614 {
<a name="l02615"></a>02615   <a class="code" href="utils_8c.html#aaa819b1a6c0b6c4090bdc0b027eaf64b">fprintf_filtered</a> (file, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Stopping for new SPE threads is %s.\n&quot;</span>),
<a name="l02616"></a>02616                     value);
<a name="l02617"></a>02617 }
<a name="l02618"></a>02618 
<a name="l02619"></a>02619 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l02620"></a><a class="code" href="spu-tdep_8c.html#a0ccf7d2319d75507574c920b8d280fac">02620</a> <a class="code" href="spu-tdep_8c.html#a0ccf7d2319d75507574c920b8d280fac">show_spu_auto_flush_cache</a> (<span class="keyword">struct</span> <a class="code" href="structui__file.html">ui_file</a> *file, <span class="keywordtype">int</span> from_tty,
<a name="l02621"></a>02621                            <span class="keyword">struct</span> <a class="code" href="structcmd__list__element.html">cmd_list_element</a> *c, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structvalue.html">value</a>)
<a name="l02622"></a>02622 {
<a name="l02623"></a>02623   <a class="code" href="utils_8c.html#aaa819b1a6c0b6c4090bdc0b027eaf64b">fprintf_filtered</a> (file, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Automatic software-cache flush is %s.\n&quot;</span>),
<a name="l02624"></a>02624                     value);
<a name="l02625"></a>02625 }
<a name="l02626"></a>02626 
<a name="l02627"></a>02627 
<a name="l02628"></a>02628 <span class="comment">/* Set up gdbarch struct.  */</span>
<a name="l02629"></a>02629 
<a name="l02630"></a>02630 <span class="keyword">static</span> <span class="keyword">struct </span>gdbarch *
<a name="l02631"></a><a class="code" href="spu-tdep_8c.html#ab71b2ab1e7df756e3087a23f2452f04b">02631</a> <a class="code" href="spu-tdep_8c.html#ab71b2ab1e7df756e3087a23f2452f04b">spu_gdbarch_init</a> (<span class="keyword">struct</span> <a class="code" href="structgdbarch__info.html">gdbarch_info</a> info, <span class="keyword">struct</span> <a class="code" href="structgdbarch__list.html">gdbarch_list</a> *arches)
<a name="l02632"></a>02632 {
<a name="l02633"></a>02633   <span class="keyword">struct </span>gdbarch *gdbarch;
<a name="l02634"></a>02634   <span class="keyword">struct </span><a class="code" href="structgdbarch__tdep.html">gdbarch_tdep</a> *tdep;
<a name="l02635"></a>02635   <span class="keywordtype">int</span> <span class="keywordtype">id</span> = -1;
<a name="l02636"></a>02636 
<a name="l02637"></a>02637   <span class="comment">/* Which spufs ID was requested as address space?  */</span>
<a name="l02638"></a>02638   <span class="keywordflow">if</span> (info.<a class="code" href="structgdbarch__info.html#a86760dc33f60db9d946b09271bf244a3">tdep_info</a>)
<a name="l02639"></a>02639     <span class="keywordtype">id</span> = *(<span class="keywordtype">int</span> *)info.<a class="code" href="structgdbarch__info.html#a86760dc33f60db9d946b09271bf244a3">tdep_info</a>;
<a name="l02640"></a>02640   <span class="comment">/* For objfile architectures of SPU solibs, decode the ID from the name.</span>
<a name="l02641"></a>02641 <span class="comment">     This assumes the filename convention employed by solib-spu.c.  */</span>
<a name="l02642"></a>02642   <span class="keywordflow">else</span> if (info.<a class="code" href="structgdbarch__info.html#a3c4162054156176568f3b6aab88c2d58">abfd</a>)
<a name="l02643"></a>02643     {
<a name="l02644"></a>02644       <span class="keywordtype">char</span> *<a class="code" href="aarch64-tdep_8c.html#acc128f98d9ceca227038c771308eff39">name</a> = <a class="code" href="gdb__string_8h.html#a5cbb8bbfc7174d9468b1853f1031efb3">strrchr</a> (info.<a class="code" href="structgdbarch__info.html#a3c4162054156176568f3b6aab88c2d58">abfd</a>-&gt;filename, <span class="charliteral">&#39;@&#39;</span>);
<a name="l02645"></a>02645       <span class="keywordflow">if</span> (name)
<a name="l02646"></a>02646         sscanf (name, <span class="stringliteral">&quot;@0x%*x &lt;%d&gt;&quot;</span>, &amp;<span class="keywordtype">id</span>);
<a name="l02647"></a>02647     }
<a name="l02648"></a>02648 
<a name="l02649"></a>02649   <span class="comment">/* Find a candidate among extant architectures.  */</span>
<a name="l02650"></a>02650   <span class="keywordflow">for</span> (arches = <a class="code" href="gdbarch_8c.html#aa3ea1c25a21a533dfd0d924a7d9778e4">gdbarch_list_lookup_by_info</a> (arches, &amp;info);
<a name="l02651"></a>02651        arches != NULL;
<a name="l02652"></a>02652        arches = <a class="code" href="gdbarch_8c.html#aa3ea1c25a21a533dfd0d924a7d9778e4">gdbarch_list_lookup_by_info</a> (arches-&gt;<a class="code" href="structgdbarch__list.html#a9da6f84112797b67d5d8e7b8d4e26b14">next</a>, &amp;info))
<a name="l02653"></a>02653     {
<a name="l02654"></a>02654       tdep = <a class="code" href="gdbarch_8c.html#acea996b7421706849bc20567695b5b31">gdbarch_tdep</a> (arches-&gt;<a class="code" href="structgdbarch__list.html#a6c51da8c4c95249704dfe18394fd08f9">gdbarch</a>);
<a name="l02655"></a>02655       <span class="keywordflow">if</span> (tdep &amp;&amp; tdep-&gt;<a class="code" href="structgdbarch__tdep.html#a6c04333e4962a9690dea1334a6201d30">id</a> == <span class="keywordtype">id</span>)
<a name="l02656"></a>02656         <span class="keywordflow">return</span> arches-&gt;<a class="code" href="structgdbarch__list.html#a6c51da8c4c95249704dfe18394fd08f9">gdbarch</a>;
<a name="l02657"></a>02657     }
<a name="l02658"></a>02658 
<a name="l02659"></a>02659   <span class="comment">/* None found, so create a new architecture.  */</span>
<a name="l02660"></a>02660   tdep = <a class="code" href="defs_8h.html#a4c67016fda510e35550be38ad53c44d1">XCALLOC</a> (1, <span class="keyword">struct</span> <a class="code" href="structgdbarch__tdep.html">gdbarch_tdep</a>);
<a name="l02661"></a>02661   tdep-&gt;<a class="code" href="structgdbarch__tdep.html#a6c04333e4962a9690dea1334a6201d30">id</a> = <a class="code" href="structgdbarch__tdep.html#a6c04333e4962a9690dea1334a6201d30">id</a>;
<a name="l02662"></a>02662   gdbarch = <a class="code" href="gdbarch_8c.html#a9e0b0979fa2cb7439f41f66deda8dec5">gdbarch_alloc</a> (&amp;info, tdep);
<a name="l02663"></a>02663 
<a name="l02664"></a>02664   <span class="comment">/* Disassembler.  */</span>
<a name="l02665"></a>02665   <a class="code" href="gdbarch_8c.html#a0c9e9e391e44d476b74debefc407e9bb">set_gdbarch_print_insn</a> (gdbarch, <a class="code" href="spu-tdep_8c.html#a7b7e70ab7b9e8842e75725c99189f8d1">gdb_print_insn_spu</a>);
<a name="l02666"></a>02666 
<a name="l02667"></a>02667   <span class="comment">/* Registers.  */</span>
<a name="l02668"></a>02668   <a class="code" href="gdbarch_8c.html#ad8417c5d66cf04d0587f58f82de94c48">set_gdbarch_num_regs</a> (gdbarch, <a class="code" href="spu-tdep_8h.html#a7063becc82879801018c49a4c52db7b6">SPU_NUM_REGS</a>);
<a name="l02669"></a>02669   <a class="code" href="gdbarch_8c.html#aaf72e08f972ba348d5d28f6b6b8db638">set_gdbarch_num_pseudo_regs</a> (gdbarch, <a class="code" href="spu-tdep_8h.html#a7efbbe085b0486e515ef39116fa09402">SPU_NUM_PSEUDO_REGS</a>);
<a name="l02670"></a>02670   <a class="code" href="gdbarch_8c.html#a81a92a88a67093d18e59fd5650fda352">set_gdbarch_sp_regnum</a> (gdbarch, <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4ca4d2edf1cf9cd8c1c52cde68536a2c45d">SPU_SP_REGNUM</a>);
<a name="l02671"></a>02671   <a class="code" href="gdbarch_8c.html#a8852f70e2afc74953a57521ed08a3381">set_gdbarch_pc_regnum</a> (gdbarch, <a class="code" href="spu-tdep_8h.html#ae0b8575583a8b8862d041b6478f20a4cac5c6ca5984213bd79f0060b49caef630">SPU_PC_REGNUM</a>);
<a name="l02672"></a>02672   <a class="code" href="gdbarch_8c.html#ab63f129c7af7d29dcea12aabd9048c1f">set_gdbarch_read_pc</a> (gdbarch, <a class="code" href="spu-tdep_8c.html#af43e5f10b9caf800fbfda85907dc7baa">spu_read_pc</a>);
<a name="l02673"></a>02673   <a class="code" href="gdbarch_8c.html#a3209bbcdaee096f4977ef11291f0be48">set_gdbarch_write_pc</a> (gdbarch, <a class="code" href="spu-tdep_8c.html#a2ec06b5638bb6b107050e0cd1ca75a1c">spu_write_pc</a>);
<a name="l02674"></a>02674   <a class="code" href="gdbarch_8c.html#a378ba40a6275393e204873c5bba602ad">set_gdbarch_register_name</a> (gdbarch, <a class="code" href="spu-tdep_8c.html#aedddb239dbf3ae30926c8b5522bcae7a">spu_register_name</a>);
<a name="l02675"></a>02675   <a class="code" href="gdbarch_8c.html#a21919f6adfae80ed36e69e89cdfea531">set_gdbarch_register_type</a> (gdbarch, <a class="code" href="spu-tdep_8c.html#a87a7ef44e19d693394ed6e1baa584172">spu_register_type</a>);
<a name="l02676"></a>02676   <a class="code" href="gdbarch_8c.html#a99fd57c1a882cf61c413e64028937a1b">set_gdbarch_pseudo_register_read</a> (gdbarch, <a class="code" href="spu-tdep_8c.html#a30664d6761ac66712b4edd96f95e2196">spu_pseudo_register_read</a>);
<a name="l02677"></a>02677   <a class="code" href="gdbarch_8c.html#ae463eca1992acf69ff1bc28ed8ca3aea">set_gdbarch_pseudo_register_write</a> (gdbarch, <a class="code" href="spu-tdep_8c.html#a3eab080857c685a19f04c45f6938c3e9">spu_pseudo_register_write</a>);
<a name="l02678"></a>02678   <a class="code" href="gdbarch_8c.html#a4ac341cc36d8a6d7600408cc4c1443ad">set_gdbarch_value_from_register</a> (gdbarch, <a class="code" href="spu-tdep_8c.html#a593c2ca1951c05283797db39013c8673">spu_value_from_register</a>);
<a name="l02679"></a>02679   <a class="code" href="gdbarch_8c.html#a17301533b8e9f7002350ed0a2f4b5558">set_gdbarch_register_reggroup_p</a> (gdbarch, <a class="code" href="spu-tdep_8c.html#af6cab198f4a1060c33d5c2e6d8e8b201">spu_register_reggroup_p</a>);
<a name="l02680"></a>02680 
<a name="l02681"></a>02681   <span class="comment">/* Data types.  */</span>
<a name="l02682"></a>02682   <a class="code" href="gdbarch_8c.html#a0863fa86a9cb752711cca456e3f829b7">set_gdbarch_char_signed</a> (gdbarch, 0);
<a name="l02683"></a>02683   <a class="code" href="gdbarch_8c.html#abaaa21a756f3f8a689513c6df8b47ced">set_gdbarch_ptr_bit</a> (gdbarch, 32);
<a name="l02684"></a>02684   <a class="code" href="gdbarch_8c.html#a028fd40e003f89fcf02d7c2f9335b6ad">set_gdbarch_addr_bit</a> (gdbarch, 32);
<a name="l02685"></a>02685   <a class="code" href="gdbarch_8c.html#aa8ab344aebdb71839678ff3d3e248f9b">set_gdbarch_short_bit</a> (gdbarch, 16);
<a name="l02686"></a>02686   <a class="code" href="gdbarch_8c.html#a4dbde89c15b9ee9f1808a4e01f2a758d">set_gdbarch_int_bit</a> (gdbarch, 32);
<a name="l02687"></a>02687   <a class="code" href="gdbarch_8c.html#ab661d4332c2357c6242d5f3f57f1bc44">set_gdbarch_long_bit</a> (gdbarch, 32);
<a name="l02688"></a>02688   <a class="code" href="gdbarch_8c.html#a00b33f93ffedea6960d0ed4a9d7e1fba">set_gdbarch_long_long_bit</a> (gdbarch, 64);
<a name="l02689"></a>02689   <a class="code" href="gdbarch_8c.html#aa04e7a5715ca0c94652f8d35f44411f7">set_gdbarch_float_bit</a> (gdbarch, 32);
<a name="l02690"></a>02690   <a class="code" href="gdbarch_8c.html#a6dde6fbd6439a96136e99bed4a7d98cd">set_gdbarch_double_bit</a> (gdbarch, 64);
<a name="l02691"></a>02691   <a class="code" href="gdbarch_8c.html#ada51ef491e1e7d747c9a974639adf84d">set_gdbarch_long_double_bit</a> (gdbarch, 64);
<a name="l02692"></a>02692   <a class="code" href="gdbarch_8c.html#af3d3823011ac395f80e7f616ba59d252">set_gdbarch_float_format</a> (gdbarch, <a class="code" href="gdbtypes_8c.html#a2fcc5f34f85af43cce0eb78225fd2a11">floatformats_ieee_single</a>);
<a name="l02693"></a>02693   <a class="code" href="gdbarch_8c.html#aeda072f3599a56ad1fdfe82f4c99f1f8">set_gdbarch_double_format</a> (gdbarch, <a class="code" href="gdbtypes_8c.html#ab5eaf32f7eeeb57f880c28ff0d7544ae">floatformats_ieee_double</a>);
<a name="l02694"></a>02694   <a class="code" href="gdbarch_8c.html#a882287a38d1557dce54fdb2172756b2f">set_gdbarch_long_double_format</a> (gdbarch, <a class="code" href="gdbtypes_8c.html#ab5eaf32f7eeeb57f880c28ff0d7544ae">floatformats_ieee_double</a>);
<a name="l02695"></a>02695 
<a name="l02696"></a>02696   <span class="comment">/* Address handling.  */</span>
<a name="l02697"></a>02697   <a class="code" href="gdbarch_8c.html#a6c82f1dbe30d9e90f292191a8990a083">set_gdbarch_address_to_pointer</a> (gdbarch, <a class="code" href="spu-tdep_8c.html#a4dbad6733cd47d047a27d2ca5f03449d">spu_address_to_pointer</a>);
<a name="l02698"></a>02698   <a class="code" href="gdbarch_8c.html#a32663d81b453b7b64760943b2e34900f">set_gdbarch_pointer_to_address</a> (gdbarch, <a class="code" href="spu-tdep_8c.html#a8f8b5b87f57db941738d914ebf000009">spu_pointer_to_address</a>);
<a name="l02699"></a>02699   <a class="code" href="gdbarch_8c.html#adf7a3ade5decd91ce5049182253c69d7">set_gdbarch_integer_to_address</a> (gdbarch, <a class="code" href="spu-tdep_8c.html#aa45cc57405b97309e1ef2d0061090fe1">spu_integer_to_address</a>);
<a name="l02700"></a>02700   <a class="code" href="gdbarch_8c.html#a898dbfb9db4c1761f5d079c2cfd37bec">set_gdbarch_address_class_type_flags</a> (gdbarch, <a class="code" href="spu-tdep_8c.html#af2ee8d21ae3390a25bf86ce304a27414">spu_address_class_type_flags</a>);
<a name="l02701"></a>02701   <a class="code" href="gdbarch_8c.html#a608c51ee7051b7cc9d9b48c1c279590d">set_gdbarch_address_class_type_flags_to_name</a>
<a name="l02702"></a>02702     (gdbarch, <a class="code" href="spu-tdep_8c.html#a2c775c9bbdc903d75ab54387c6ba2fd7">spu_address_class_type_flags_to_name</a>);
<a name="l02703"></a>02703   <a class="code" href="gdbarch_8c.html#a8bdb5c60355bafb9facebaec35809aff">set_gdbarch_address_class_name_to_type_flags</a>
<a name="l02704"></a>02704     (gdbarch, <a class="code" href="spu-tdep_8c.html#a06e98506018d058814e39ff9e232b741">spu_address_class_name_to_type_flags</a>);
<a name="l02705"></a>02705 
<a name="l02706"></a>02706 
<a name="l02707"></a>02707   <span class="comment">/* Inferior function calls.  */</span>
<a name="l02708"></a>02708   <a class="code" href="gdbarch_8c.html#a2bf76ca78a247a34ce6fae8b7440bfa8">set_gdbarch_call_dummy_location</a> (gdbarch, <a class="code" href="inferior_8h.html#a15d448cd96768b563862febf09863fe5">ON_STACK</a>);
<a name="l02709"></a>02709   <a class="code" href="gdbarch_8c.html#aff48f6a8b2982831522fc7b3af596654">set_gdbarch_frame_align</a> (gdbarch, <a class="code" href="spu-tdep_8c.html#a84db0a35173eb9e9cea85107677187a5">spu_frame_align</a>);
<a name="l02710"></a>02710   <a class="code" href="gdbarch_8c.html#a9d0c04c0e9493d309e98100935b6cda3">set_gdbarch_frame_red_zone_size</a> (gdbarch, 2000);
<a name="l02711"></a>02711   <a class="code" href="gdbarch_8c.html#a8b3dcaa6f8f1a2aec2cf84ece769d858">set_gdbarch_push_dummy_code</a> (gdbarch, <a class="code" href="spu-tdep_8c.html#a1632a5411024f28aee614f6d39ab9e13">spu_push_dummy_code</a>);
<a name="l02712"></a>02712   <a class="code" href="gdbarch_8c.html#a853528dceff46211c1bb8c57b77dca31">set_gdbarch_push_dummy_call</a> (gdbarch, <a class="code" href="spu-tdep_8c.html#a66feaa86c4753825f37064b384394300">spu_push_dummy_call</a>);
<a name="l02713"></a>02713   <a class="code" href="gdbarch_8c.html#a23da982924f904d22d0b58639a48bccf">set_gdbarch_dummy_id</a> (gdbarch, <a class="code" href="spu-tdep_8c.html#a66ed1a8781f95b51c78ade30c6985cfb">spu_dummy_id</a>);
<a name="l02714"></a>02714   <a class="code" href="gdbarch_8c.html#ad9b13a9323cac027c4b805953b4fff63">set_gdbarch_return_value</a> (gdbarch, <a class="code" href="spu-tdep_8c.html#ace219b3a4937b222c91e9b6137e464f3">spu_return_value</a>);
<a name="l02715"></a>02715 
<a name="l02716"></a>02716   <span class="comment">/* Frame handling.  */</span>
<a name="l02717"></a>02717   <a class="code" href="gdbarch_8c.html#ad66381ed135b13aa5635f0485211ca71">set_gdbarch_inner_than</a> (gdbarch, <a class="code" href="arch-utils_8c.html#aaceae1c07203f3091df647f813b9f20e">core_addr_lessthan</a>);
<a name="l02718"></a>02718   <a class="code" href="frame-unwind_8c.html#afa4de8a130514bfd524d46f32e35a534">frame_unwind_append_unwinder</a> (gdbarch, &amp;spu_frame_unwind);
<a name="l02719"></a>02719   <a class="code" href="frame-base_8c.html#afc9e209b41e14278fb1ab72c1d3c6e5d">frame_base_set_default</a> (gdbarch, &amp;spu_frame_base);
<a name="l02720"></a>02720   <a class="code" href="gdbarch_8c.html#a1974f5f26c09a4cd32165286c3769621">set_gdbarch_unwind_pc</a> (gdbarch, <a class="code" href="spu-tdep_8c.html#a9473c264146aab82adcbf41922b1c3d6">spu_unwind_pc</a>);
<a name="l02721"></a>02721   <a class="code" href="gdbarch_8c.html#ababd871cc4b5fac1831e52f7331d7572">set_gdbarch_unwind_sp</a> (gdbarch, <a class="code" href="spu-tdep_8c.html#ae3bf0f68054dfcb863609c9278145186">spu_unwind_sp</a>);
<a name="l02722"></a>02722   <a class="code" href="gdbarch_8c.html#ac20d66067cb5240cb6c1d8e48c0500e2">set_gdbarch_virtual_frame_pointer</a> (gdbarch, <a class="code" href="spu-tdep_8c.html#ada1c158ebf5147954ddf38c28d49d079">spu_virtual_frame_pointer</a>);
<a name="l02723"></a>02723   <a class="code" href="gdbarch_8c.html#affeacd014397bbaf442f32de0cb4b86c">set_gdbarch_frame_args_skip</a> (gdbarch, 0);
<a name="l02724"></a>02724   <a class="code" href="gdbarch_8c.html#a841509ae0070f2f12aa9b3b7fd52b92f">set_gdbarch_skip_prologue</a> (gdbarch, <a class="code" href="spu-tdep_8c.html#a898464df5dd4ab9698763a25395d4fd2">spu_skip_prologue</a>);
<a name="l02725"></a>02725   <a class="code" href="gdbarch_8c.html#ab1ffbc0d23252e88823c50139b8464fb">set_gdbarch_in_function_epilogue_p</a> (gdbarch, <a class="code" href="spu-tdep_8c.html#a2f027eeca7e79f8c6781d09650ded7b5">spu_in_function_epilogue_p</a>);
<a name="l02726"></a>02726 
<a name="l02727"></a>02727   <span class="comment">/* Cell/B.E. cross-architecture unwinder support.  */</span>
<a name="l02728"></a>02728   <a class="code" href="frame-unwind_8c.html#a731c456ce19a87c968bfa663c6245675">frame_unwind_prepend_unwinder</a> (gdbarch, &amp;spu2ppu_unwind);
<a name="l02729"></a>02729 
<a name="l02730"></a>02730   <span class="comment">/* Breakpoints.  */</span>
<a name="l02731"></a>02731   <a class="code" href="gdbarch_8c.html#a59e0f429a0c89806415bb5e1b7367bb8">set_gdbarch_decr_pc_after_break</a> (gdbarch, 4);
<a name="l02732"></a>02732   <a class="code" href="gdbarch_8c.html#ad738cdf37fa27f4cf3642107cadf61d3">set_gdbarch_breakpoint_from_pc</a> (gdbarch, <a class="code" href="spu-tdep_8c.html#af104778760276c04eba2bad4db341fdb">spu_breakpoint_from_pc</a>);
<a name="l02733"></a>02733   <a class="code" href="gdbarch_8c.html#aa3831ad36e1b618a311be7d5b0528353">set_gdbarch_memory_remove_breakpoint</a> (gdbarch, <a class="code" href="spu-tdep_8c.html#a8ba4f52f5196b027cd146ccdc78a6c98">spu_memory_remove_breakpoint</a>);
<a name="l02734"></a>02734   <a class="code" href="gdbarch_8c.html#a7e2d4ab11404574d0fe4bcda37a58cf2">set_gdbarch_cannot_step_breakpoint</a> (gdbarch, 1);
<a name="l02735"></a>02735   <a class="code" href="gdbarch_8c.html#a3ef5204e360b0a4ef1d162945911c403">set_gdbarch_software_single_step</a> (gdbarch, <a class="code" href="spu-tdep_8c.html#a19a63bc48633bb1f909f0f30dba516b6">spu_software_single_step</a>);
<a name="l02736"></a>02736   <a class="code" href="gdbarch_8c.html#ae8e313db3a0bf29bc29ab4173b6d4418">set_gdbarch_get_longjmp_target</a> (gdbarch, <a class="code" href="spu-tdep_8c.html#a1d65f2bff6878ccf0b53c99684a15309">spu_get_longjmp_target</a>);
<a name="l02737"></a>02737 
<a name="l02738"></a>02738   <span class="comment">/* Overlays.  */</span>
<a name="l02739"></a>02739   <a class="code" href="gdbarch_8c.html#a78e6c4dd0e6bbf28f36463cb9eb43df2">set_gdbarch_overlay_update</a> (gdbarch, <a class="code" href="spu-tdep_8c.html#a8213a386e270b40a537b451ecebac22a">spu_overlay_update</a>);
<a name="l02740"></a>02740 
<a name="l02741"></a>02741   <span class="keywordflow">return</span> gdbarch;
<a name="l02742"></a>02742 }
<a name="l02743"></a>02743 
<a name="l02744"></a>02744 <span class="comment">/* Provide a prototype to silence -Wmissing-prototypes.  */</span>
<a name="l02745"></a>02745 <span class="keyword">extern</span> <a class="code" href="defs_8h.html#a686ed07d4fdcdc366f2bc677216ca08d">initialize_file_ftype</a> <a class="code" href="spu-tdep_8c.html#add663b55d56f4299f638964add98f884">_initialize_spu_tdep</a>;
<a name="l02746"></a>02746 
<a name="l02747"></a>02747 <span class="keywordtype">void</span>
<a name="l02748"></a><a class="code" href="spu-tdep_8c.html#a66db49d051734561a2763e52399ce187">02748</a> <a class="code" href="spu-tdep_8c.html#add663b55d56f4299f638964add98f884">_initialize_spu_tdep</a> (<span class="keywordtype">void</span>)
<a name="l02749"></a>02749 {
<a name="l02750"></a>02750   <a class="code" href="gdbarch_8c.html#adb96505b62850783929ff38de0c39062">register_gdbarch_init</a> (bfd_arch_spu, <a class="code" href="spu-tdep_8c.html#ab71b2ab1e7df756e3087a23f2452f04b">spu_gdbarch_init</a>);
<a name="l02751"></a>02751 
<a name="l02752"></a>02752   <span class="comment">/* Add ourselves to objfile event chain.  */</span>
<a name="l02753"></a>02753   <a class="code" href="observer_8h.html#a688df6ed7b6f01418f3498e7c376e360">observer_attach_new_objfile</a> (<a class="code" href="spu-tdep_8c.html#a419e5a40fb8559d4b4ed9a1d17194975">spu_overlay_new_objfile</a>);
<a name="l02754"></a>02754   <a class="code" href="spu-tdep_8c.html#a81051b5d2c73ade3382357773946f648">spu_overlay_data</a> = register_objfile_data ();
<a name="l02755"></a>02755 
<a name="l02756"></a>02756   <span class="comment">/* Install spu stop-on-load handler.  */</span>
<a name="l02757"></a>02757   <a class="code" href="observer_8h.html#a688df6ed7b6f01418f3498e7c376e360">observer_attach_new_objfile</a> (<a class="code" href="spu-tdep_8c.html#a5e9f6785d6ad3dc5ac5681df0ec25448">spu_catch_start</a>);
<a name="l02758"></a>02758 
<a name="l02759"></a>02759   <span class="comment">/* Add ourselves to normal_stop event chain.  */</span>
<a name="l02760"></a>02760   <a class="code" href="observer_8h.html#abc87124a884f15ff21d7899e6eb690d0">observer_attach_normal_stop</a> (<a class="code" href="spu-tdep_8c.html#a8c5d1cf1825964d587766d8980534e71">spu_attach_normal_stop</a>);
<a name="l02761"></a>02761 
<a name="l02762"></a>02762   <span class="comment">/* Add root prefix command for all &quot;set spu&quot;/&quot;show spu&quot; commands.  */</span>
<a name="l02763"></a>02763   <a class="code" href="cli-decode_8c.html#a8abc1e9af59eb3cb12bb03977d5e8e5a">add_prefix_cmd</a> (<span class="stringliteral">&quot;spu&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49afbf489a4abce7e8770b178aa54f0908b">no_class</a>, <a class="code" href="spu-tdep_8c.html#a08ffa98505d8283a448788093e2246eb">set_spu_command</a>,
<a name="l02764"></a>02764                   <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Various SPU specific commands.&quot;</span>),
<a name="l02765"></a>02765                   &amp;setspucmdlist, <span class="stringliteral">&quot;set spu &quot;</span>, 0, &amp;<a class="code" href="cli-cmds_8c.html#a723e0174d833cba0aa82fb936a56c8fa">setlist</a>);
<a name="l02766"></a>02766   <a class="code" href="cli-decode_8c.html#a8abc1e9af59eb3cb12bb03977d5e8e5a">add_prefix_cmd</a> (<span class="stringliteral">&quot;spu&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49afbf489a4abce7e8770b178aa54f0908b">no_class</a>, <a class="code" href="spu-tdep_8c.html#a7d590d17cadbe4944c9563d2f4d3a533">show_spu_command</a>,
<a name="l02767"></a>02767                   <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Various SPU specific commands.&quot;</span>),
<a name="l02768"></a>02768                   &amp;showspucmdlist, <span class="stringliteral">&quot;show spu &quot;</span>, 0, &amp;<a class="code" href="cli-cmds_8c.html#a003932aa76fd3f41763ecc6bee5e2ca8">showlist</a>);
<a name="l02769"></a>02769 
<a name="l02770"></a>02770   <span class="comment">/* Toggle whether or not to add a temporary breakpoint at the &quot;main&quot;</span>
<a name="l02771"></a>02771 <span class="comment">     function of new SPE contexts.  */</span>
<a name="l02772"></a>02772   <a class="code" href="cli-decode_8c.html#ad86a0f135b6c546ae7ffbb41fd72e14f">add_setshow_boolean_cmd</a> (<span class="stringliteral">&quot;stop-on-load&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a92be6efbab6bd9647a6f7a2862712d9b">class_support</a>,
<a name="l02773"></a>02773                           &amp;<a class="code" href="spu-tdep_8c.html#a7727de4d3c84d3cea031dea8953b8ad6">spu_stop_on_load_p</a>, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l02774"></a>02774 <span class="stringliteral">Set whether to stop for new SPE threads.&quot;</span>),
<a name="l02775"></a>02775                            <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l02776"></a>02776 <span class="stringliteral">Show whether to stop for new SPE threads.&quot;</span>),
<a name="l02777"></a>02777                            <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l02778"></a>02778 <span class="stringliteral">Use \&quot;on\&quot; to give control to the user when a new SPE thread\n\</span>
<a name="l02779"></a>02779 <span class="stringliteral">enters its \&quot;main\&quot; function.\n\</span>
<a name="l02780"></a>02780 <span class="stringliteral">Use \&quot;off\&quot; to disable stopping for new SPE threads.&quot;</span>),
<a name="l02781"></a>02781                           NULL,
<a name="l02782"></a>02782                           <a class="code" href="spu-tdep_8c.html#ad2009098c3d846884f2167006043a092">show_spu_stop_on_load</a>,
<a name="l02783"></a>02783                           &amp;setspucmdlist, &amp;showspucmdlist);
<a name="l02784"></a>02784 
<a name="l02785"></a>02785   <span class="comment">/* Toggle whether or not to automatically flush the software-managed</span>
<a name="l02786"></a>02786 <span class="comment">     cache whenever SPE execution stops.  */</span>
<a name="l02787"></a>02787   <a class="code" href="cli-decode_8c.html#ad86a0f135b6c546ae7ffbb41fd72e14f">add_setshow_boolean_cmd</a> (<span class="stringliteral">&quot;auto-flush-cache&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a92be6efbab6bd9647a6f7a2862712d9b">class_support</a>,
<a name="l02788"></a>02788                           &amp;<a class="code" href="spu-tdep_8c.html#a7a6c9e0cdc6342602ad23650b8f55c45">spu_auto_flush_cache_p</a>, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l02789"></a>02789 <span class="stringliteral">Set whether to automatically flush the software-managed cache.&quot;</span>),
<a name="l02790"></a>02790                            <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l02791"></a>02791 <span class="stringliteral">Show whether to automatically flush the software-managed cache.&quot;</span>),
<a name="l02792"></a>02792                            <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l02793"></a>02793 <span class="stringliteral">Use \&quot;on\&quot; to automatically flush the software-managed cache\n\</span>
<a name="l02794"></a>02794 <span class="stringliteral">whenever SPE execution stops.\n\</span>
<a name="l02795"></a>02795 <span class="stringliteral">Use \&quot;off\&quot; to never automatically flush the software-managed cache.&quot;</span>),
<a name="l02796"></a>02796                           NULL,
<a name="l02797"></a>02797                           <a class="code" href="spu-tdep_8c.html#a0ccf7d2319d75507574c920b8d280fac">show_spu_auto_flush_cache</a>,
<a name="l02798"></a>02798                           &amp;setspucmdlist, &amp;showspucmdlist);
<a name="l02799"></a>02799 
<a name="l02800"></a>02800   <span class="comment">/* Add root prefix command for all &quot;info spu&quot; commands.  */</span>
<a name="l02801"></a>02801   <a class="code" href="cli-decode_8c.html#a8abc1e9af59eb3cb12bb03977d5e8e5a">add_prefix_cmd</a> (<span class="stringliteral">&quot;spu&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49afeb5c4e1710a4f7dfc804136248d274d">class_info</a>, <a class="code" href="spu-tdep_8c.html#a68b8fe98fd8f08f382945ad6a7df4e06">info_spu_command</a>,
<a name="l02802"></a>02802                   <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Various SPU specific commands.&quot;</span>),
<a name="l02803"></a>02803                   &amp;infospucmdlist, <span class="stringliteral">&quot;info spu &quot;</span>, 0, &amp;<a class="code" href="cli-cmds_8c.html#a2b65c04ff262047fd6fee65572dcfc43">infolist</a>);
<a name="l02804"></a>02804 
<a name="l02805"></a>02805   <span class="comment">/* Add various &quot;info spu&quot; commands.  */</span>
<a name="l02806"></a>02806   <a class="code" href="cli-decode_8c.html#ab87b0ba51ed9aa4c8aac0c96373537f8">add_cmd</a> (<span class="stringliteral">&quot;event&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49afeb5c4e1710a4f7dfc804136248d274d">class_info</a>, <a class="code" href="spu-tdep_8c.html#acb0050e806af1c59e4508d9e12061110">info_spu_event_command</a>,
<a name="l02807"></a>02807            <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Display SPU event facility status.\n&quot;</span>),
<a name="l02808"></a>02808            &amp;infospucmdlist);
<a name="l02809"></a>02809   <a class="code" href="cli-decode_8c.html#ab87b0ba51ed9aa4c8aac0c96373537f8">add_cmd</a> (<span class="stringliteral">&quot;signal&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49afeb5c4e1710a4f7dfc804136248d274d">class_info</a>, <a class="code" href="spu-tdep_8c.html#ae9ee817db6c353fd2d430c73978849b1">info_spu_signal_command</a>,
<a name="l02810"></a>02810            <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Display SPU signal notification facility status.\n&quot;</span>),
<a name="l02811"></a>02811            &amp;infospucmdlist);
<a name="l02812"></a>02812   <a class="code" href="cli-decode_8c.html#ab87b0ba51ed9aa4c8aac0c96373537f8">add_cmd</a> (<span class="stringliteral">&quot;mailbox&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49afeb5c4e1710a4f7dfc804136248d274d">class_info</a>, <a class="code" href="spu-tdep_8c.html#a0a2f850288930aaca4eeb3ad29e31fe6">info_spu_mailbox_command</a>,
<a name="l02813"></a>02813            <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Display SPU mailbox facility status.\n&quot;</span>),
<a name="l02814"></a>02814            &amp;infospucmdlist);
<a name="l02815"></a>02815   <a class="code" href="cli-decode_8c.html#ab87b0ba51ed9aa4c8aac0c96373537f8">add_cmd</a> (<span class="stringliteral">&quot;dma&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49afeb5c4e1710a4f7dfc804136248d274d">class_info</a>, <a class="code" href="spu-tdep_8c.html#a4a6f08013b067a99a6fd7474c6f9c8b5">info_spu_dma_command</a>,
<a name="l02816"></a>02816            <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Display MFC DMA status.\n&quot;</span>),
<a name="l02817"></a>02817            &amp;infospucmdlist);
<a name="l02818"></a>02818   <a class="code" href="cli-decode_8c.html#ab87b0ba51ed9aa4c8aac0c96373537f8">add_cmd</a> (<span class="stringliteral">&quot;proxydma&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49afeb5c4e1710a4f7dfc804136248d274d">class_info</a>, <a class="code" href="spu-tdep_8c.html#a34d841476aad999840bfa1f83fe3bb81">info_spu_proxydma_command</a>,
<a name="l02819"></a>02819            <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Display MFC Proxy-DMA status.\n&quot;</span>),
<a name="l02820"></a>02820            &amp;infospucmdlist);
<a name="l02821"></a>02821 }
</pre></div></div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated on Fri Oct 11 2013 14:13:34 for GDB (xrefs) by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
