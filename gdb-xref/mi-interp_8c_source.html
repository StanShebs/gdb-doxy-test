<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>GDB (xrefs): /home/stan/gdb/src/gdb/mi/mi-interp.c Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">GDB (xrefs)
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">/home/stan/gdb/src/gdb/mi/mi-interp.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="mi-interp_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/* MI Interpreter Definitions and Commands for GDB, the GNU debugger.</span>
<a name="l00002"></a>00002 <span class="comment"></span>
<a name="l00003"></a>00003 <span class="comment">   Copyright (C) 2002-2013 Free Software Foundation, Inc.</span>
<a name="l00004"></a>00004 <span class="comment"></span>
<a name="l00005"></a>00005 <span class="comment">   This file is part of GDB.</span>
<a name="l00006"></a>00006 <span class="comment"></span>
<a name="l00007"></a>00007 <span class="comment">   This program is free software; you can redistribute it and/or modify</span>
<a name="l00008"></a>00008 <span class="comment">   it under the terms of the GNU General Public License as published by</span>
<a name="l00009"></a>00009 <span class="comment">   the Free Software Foundation; either version 3 of the License, or</span>
<a name="l00010"></a>00010 <span class="comment">   (at your option) any later version.</span>
<a name="l00011"></a>00011 <span class="comment"></span>
<a name="l00012"></a>00012 <span class="comment">   This program is distributed in the hope that it will be useful,</span>
<a name="l00013"></a>00013 <span class="comment">   but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00014"></a>00014 <span class="comment">   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00015"></a>00015 <span class="comment">   GNU General Public License for more details.</span>
<a name="l00016"></a>00016 <span class="comment"></span>
<a name="l00017"></a>00017 <span class="comment">   You should have received a copy of the GNU General Public License</span>
<a name="l00018"></a>00018 <span class="comment">   along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.  */</span>
<a name="l00019"></a>00019 
<a name="l00020"></a>00020 <span class="preprocessor">#include &quot;<a class="code" href="defs_8h.html">defs.h</a>&quot;</span>
<a name="l00021"></a>00021 <span class="preprocessor">#include &quot;<a class="code" href="gdb__string_8h.html">gdb_string.h</a>&quot;</span>
<a name="l00022"></a>00022 <span class="preprocessor">#include &quot;<a class="code" href="interps_8h.html">interps.h</a>&quot;</span>
<a name="l00023"></a>00023 <span class="preprocessor">#include &quot;<a class="code" href="event-top_8h.html">event-top.h</a>&quot;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &quot;<a class="code" href="event-loop_8h.html">event-loop.h</a>&quot;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &quot;<a class="code" href="inferior_8h.html">inferior.h</a>&quot;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &quot;<a class="code" href="ui-out_8h.html">ui-out.h</a>&quot;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &quot;<a class="code" href="top_8h.html">top.h</a>&quot;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &quot;<a class="code" href="exceptions_8h.html">exceptions.h</a>&quot;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &quot;<a class="code" href="mi-main_8h.html">mi-main.h</a>&quot;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &quot;<a class="code" href="mi-cmds_8h.html">mi-cmds.h</a>&quot;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &quot;<a class="code" href="mi-out_8h.html">mi-out.h</a>&quot;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &quot;<a class="code" href="mi-console_8h.html">mi-console.h</a>&quot;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &quot;<a class="code" href="mi-common_8h.html">mi-common.h</a>&quot;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &quot;<a class="code" href="observer_8h.html">observer.h</a>&quot;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &quot;<a class="code" href="gdbthread_8h.html">gdbthread.h</a>&quot;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &quot;<a class="code" href="solist_8h.html">solist.h</a>&quot;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &quot;<a class="code" href="gdb_8h.html">gdb.h</a>&quot;</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include &quot;<a class="code" href="objfiles_8h.html">objfiles.h</a>&quot;</span>
<a name="l00039"></a>00039 <span class="preprocessor">#include &quot;<a class="code" href="tracepoint_8h.html">tracepoint.h</a>&quot;</span>
<a name="l00040"></a>00040 
<a name="l00041"></a>00041 <span class="comment">/* These are the interpreter setup, etc. functions for the MI</span>
<a name="l00042"></a>00042 <span class="comment">   interpreter.  */</span>
<a name="l00043"></a>00043 
<a name="l00044"></a>00044 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="mi-interp_8c.html#a89ccf50e27d46714caab459e92b82abd">mi_execute_command_wrapper</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> *cmd);
<a name="l00045"></a>00045 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="mi-interp_8c.html#a0de0229ecb8ecadb2cf4a651b0006537">mi_execute_command_input_handler</a> (<span class="keywordtype">char</span> *cmd);
<a name="l00046"></a>00046 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="mi-interp_8c.html#a94631d0d7bf085ae413460a2578a2480">mi_command_loop</a> (<span class="keywordtype">void</span> *data);
<a name="l00047"></a>00047 
<a name="l00048"></a>00048 <span class="comment">/* These are hooks that we put in place while doing interpreter_exec</span>
<a name="l00049"></a>00049 <span class="comment">   so we can report interesting things that happened &quot;behind the MI&#39;s</span>
<a name="l00050"></a>00050 <span class="comment">   back&quot; in this command.  */</span>
<a name="l00051"></a>00051 
<a name="l00052"></a>00052 <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="mi-interp_8c.html#a38b8e3be27b634dc648cce207d7608a9">mi_interp_query_hook</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> *ctlstr, va_list ap)
<a name="l00053"></a>00053   <a class="code" href="cli-out_8c.html#a1c68b904ac79d64e1debacd07269758b">ATTRIBUTE_PRINTF</a> (1, 0);
<a name="l00054"></a>00054 
<a name="l00055"></a>00055 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="mi-interp_8c.html#a7d32ab33812d72193d153de20d524831">mi_insert_notify_hooks</a> (<span class="keywordtype">void</span>);
<a name="l00056"></a>00056 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="mi-interp_8c.html#a738ebbadc40cd895cf993b0fb6632d69">mi_remove_notify_hooks</a> (<span class="keywordtype">void</span>);
<a name="l00057"></a>00057 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="mi-interp_8c.html#a5147838d964e57b31536766b072669aa">mi_on_normal_stop</a> (<span class="keyword">struct</span> <a class="code" href="structbpstats.html">bpstats</a> *bs, <span class="keywordtype">int</span> <a class="code" href="stack_8c.html#ab3f10aab610905e59c2a90953afd1d24">print_frame</a>);
<a name="l00058"></a>00058 
<a name="l00059"></a>00059 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="mi-interp_8c.html#a380aff65e183e2c3b14e2f637ed29cbb">mi_new_thread</a> (<span class="keyword">struct</span> <a class="code" href="structthread__info.html">thread_info</a> *t);
<a name="l00060"></a>00060 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="mi-interp_8c.html#a3e98ae6e302ef7e113d0dca829c2064c">mi_thread_exit</a> (<span class="keyword">struct</span> <a class="code" href="structthread__info.html">thread_info</a> *t, <span class="keywordtype">int</span> silent);
<a name="l00061"></a>00061 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="mi-interp_8c.html#afc79092844166efb123218ff19ccda1d">mi_record_changed</a> (<span class="keyword">struct</span> <a class="code" href="structinferior.html">inferior</a>*, <span class="keywordtype">int</span>);
<a name="l00062"></a>00062 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="mi-interp_8c.html#a27784bb809a0101834661f1921016586">mi_inferior_added</a> (<span class="keyword">struct</span> <a class="code" href="structinferior.html">inferior</a> *<a class="code" href="structinf.html">inf</a>);
<a name="l00063"></a>00063 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="mi-interp_8c.html#a78a16a1fafee2c935dbbe08a248ad31b">mi_inferior_appeared</a> (<span class="keyword">struct</span> <a class="code" href="structinferior.html">inferior</a> *<a class="code" href="structinf.html">inf</a>);
<a name="l00064"></a>00064 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="mi-interp_8c.html#ad06cb7b3eab3fbb0840022848cbe6916">mi_inferior_exit</a> (<span class="keyword">struct</span> <a class="code" href="structinferior.html">inferior</a> *<a class="code" href="structinf.html">inf</a>);
<a name="l00065"></a>00065 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="mi-interp_8c.html#a1c7465dd5656fc047efe22334971be49">mi_inferior_removed</a> (<span class="keyword">struct</span> <a class="code" href="structinferior.html">inferior</a> *<a class="code" href="structinf.html">inf</a>);
<a name="l00066"></a>00066 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="mi-interp_8c.html#a19d360e6f63bb8ea0c513ac95f9f0dd4">mi_on_resume</a> (<a class="code" href="structptid.html">ptid_t</a> <a class="code" href="structptid.html">ptid</a>);
<a name="l00067"></a>00067 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="mi-interp_8c.html#afd11eba703051775f32ef475a83e258d">mi_solib_loaded</a> (<span class="keyword">struct</span> <a class="code" href="structso__list.html">so_list</a> *solib);
<a name="l00068"></a>00068 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="mi-interp_8c.html#ac8699802c2dbab6b40d1d7d5fd1e3291">mi_solib_unloaded</a> (<span class="keyword">struct</span> <a class="code" href="structso__list.html">so_list</a> *solib);
<a name="l00069"></a>00069 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="mi-interp_8c.html#ae17ac38c1bfdf776be42d50f652d7a49">mi_about_to_proceed</a> (<span class="keywordtype">void</span>);
<a name="l00070"></a>00070 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="mi-interp_8c.html#a20ec2fe5cd63d94377c5bbd8feb2a52e">mi_traceframe_changed</a> (<span class="keywordtype">int</span> tfnum, <span class="keywordtype">int</span> tpnum);
<a name="l00071"></a>00071 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="mi-interp_8c.html#a5fb0ab4388e00737f83b1dc55c65d6c9">mi_tsv_created</a> (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structtrace__state__variable.html">trace_state_variable</a> *tsv);
<a name="l00072"></a>00072 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="mi-interp_8c.html#a1593794bc67f7d8a5f64602d0dae4bb8">mi_tsv_deleted</a> (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structtrace__state__variable.html">trace_state_variable</a> *tsv);
<a name="l00073"></a>00073 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="mi-interp_8c.html#a0cb3c1556b2017693f0388585e4aabed">mi_tsv_modified</a> (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structtrace__state__variable.html">trace_state_variable</a> *tsv);
<a name="l00074"></a>00074 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="mi-interp_8c.html#ac0eb3ee0ed40175e882630f671298dba">mi_breakpoint_created</a> (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b);
<a name="l00075"></a>00075 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="mi-interp_8c.html#a8f87e4d98246d822fcf8aabeec14e4be">mi_breakpoint_deleted</a> (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b);
<a name="l00076"></a>00076 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="mi-interp_8c.html#a1ff485ae1e437ac61ca08f90126be231">mi_breakpoint_modified</a> (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b);
<a name="l00077"></a>00077 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="mi-interp_8c.html#ab57d87356090364cadf16311bece2241">mi_command_param_changed</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> *param, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structvalue.html">value</a>);
<a name="l00078"></a>00078 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="mi-interp_8c.html#a40bf8f631e88916076f25725dec16cf8">mi_memory_changed</a> (<span class="keyword">struct</span> <a class="code" href="structinferior.html">inferior</a> *<a class="code" href="structinf.html">inf</a>, <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> <a class="code" href="exec_8h.html#ab268c3184bf49615e16de006a296a542">memaddr</a>,
<a name="l00079"></a>00079                                ssize_t <a class="code" href="exec_8h.html#a00f945351279d3c8935f13d2b9f9b808">len</a>, <span class="keyword">const</span> bfd_byte *myaddr);
<a name="l00080"></a>00080 
<a name="l00081"></a>00081 <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="mi-interp_8c.html#a3a17cac5b43a5afad6dff33ceb8b9e9f">report_initial_inferior</a> (<span class="keyword">struct</span> <a class="code" href="structinferior.html">inferior</a> *<a class="code" href="structinf.html">inf</a>, <span class="keywordtype">void</span> *closure);
<a name="l00082"></a>00082 
<a name="l00083"></a>00083 <span class="keyword">static</span> <span class="keywordtype">void</span> *
<a name="l00084"></a><a class="code" href="mi-interp_8c.html#a4585819f4c3b6d0bcb717e6a4b21b2ea">00084</a> <a class="code" href="mi-interp_8c.html#a4585819f4c3b6d0bcb717e6a4b21b2ea">mi_interpreter_init</a> (<span class="keyword">struct</span> <a class="code" href="structinterp.html">interp</a> *<a class="code" href="structinterp.html">interp</a>, <span class="keywordtype">int</span> top_level)
<a name="l00085"></a>00085 {
<a name="l00086"></a>00086   <span class="keyword">struct </span><a class="code" href="structmi__interp.html">mi_interp</a> *mi = <a class="code" href="defs_8h.html#ab6751cea794fc22fa3696fe15df3139b">XMALLOC</a> (<span class="keyword">struct</span> <a class="code" href="structmi__interp.html">mi_interp</a>);
<a name="l00087"></a>00087   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="aarch64-tdep_8c.html#acc128f98d9ceca227038c771308eff39">name</a>;
<a name="l00088"></a>00088   <span class="keywordtype">int</span> <a class="code" href="mi-out_8c.html#aea1048f857402687800f2f7c97919efe">mi_version</a>;
<a name="l00089"></a>00089 
<a name="l00090"></a>00090   <span class="comment">/* Assign the output channel created at startup to its own global,</span>
<a name="l00091"></a>00091 <span class="comment">     so that we can create a console channel that encapsulates and</span>
<a name="l00092"></a>00092 <span class="comment">     prefixes all gdb_output-type bits coming from the rest of the</span>
<a name="l00093"></a>00093 <span class="comment">     debugger.  */</span>
<a name="l00094"></a>00094 
<a name="l00095"></a>00095   <a class="code" href="mi-cmds_8h.html#a291315c01d39483f0026b8a849b70fba">raw_stdout</a> = <a class="code" href="main_8c.html#a41a2b997ba5454df787d61f051dd918c">gdb_stdout</a>;
<a name="l00096"></a>00096 
<a name="l00097"></a>00097   <span class="comment">/* Create MI console channels, each with a different prefix so they</span>
<a name="l00098"></a>00098 <span class="comment">     can be distinguished.  */</span>
<a name="l00099"></a>00099   mi-&gt;<a class="code" href="structmi__interp.html#ac8bb6a962e3cf201e8be215bbddae337">out</a> = <a class="code" href="mi-console_8c.html#a51eaec2d98d730144ad91a3e4d4b39f0">mi_console_file_new</a> (<a class="code" href="mi-cmds_8h.html#a291315c01d39483f0026b8a849b70fba">raw_stdout</a>, <span class="stringliteral">&quot;~&quot;</span>, <span class="charliteral">&#39;&quot;&#39;</span>);
<a name="l00100"></a>00100   mi-&gt;<a class="code" href="structmi__interp.html#a0ff34900d13331d8c52b61654ecf7eb2">err</a> = <a class="code" href="mi-console_8c.html#a51eaec2d98d730144ad91a3e4d4b39f0">mi_console_file_new</a> (<a class="code" href="mi-cmds_8h.html#a291315c01d39483f0026b8a849b70fba">raw_stdout</a>, <span class="stringliteral">&quot;&amp;&quot;</span>, <span class="charliteral">&#39;&quot;&#39;</span>);
<a name="l00101"></a>00101   mi-&gt;<a class="code" href="structmi__interp.html#aae20e5805757470b103b7b11830b2e66">log</a> = mi-&gt;<a class="code" href="structmi__interp.html#a0ff34900d13331d8c52b61654ecf7eb2">err</a>;
<a name="l00102"></a>00102   mi-&gt;<a class="code" href="structmi__interp.html#aabe1c0e5f999b3c6413959f52bc20260">targ</a> = <a class="code" href="mi-console_8c.html#a51eaec2d98d730144ad91a3e4d4b39f0">mi_console_file_new</a> (<a class="code" href="mi-cmds_8h.html#a291315c01d39483f0026b8a849b70fba">raw_stdout</a>, <span class="stringliteral">&quot;@&quot;</span>, <span class="charliteral">&#39;&quot;&#39;</span>);
<a name="l00103"></a>00103   mi-&gt;<a class="code" href="structmi__interp.html#a9789f994da11c82cd9217afb3355c28b">event_channel</a> = <a class="code" href="mi-console_8c.html#a51eaec2d98d730144ad91a3e4d4b39f0">mi_console_file_new</a> (<a class="code" href="mi-cmds_8h.html#a291315c01d39483f0026b8a849b70fba">raw_stdout</a>, <span class="stringliteral">&quot;=&quot;</span>, 0);
<a name="l00104"></a>00104 
<a name="l00105"></a>00105   name = <a class="code" href="interps_8c.html#a5ed77ff8ab6dd29fb45dbc7163b4610b">interp_name</a> (interp);
<a name="l00106"></a>00106   <span class="comment">/* INTERP_MI selects the most recent released version.  &quot;mi2&quot; was</span>
<a name="l00107"></a>00107 <span class="comment">     released as part of GDB 6.0.  */</span>
<a name="l00108"></a>00108   <span class="keywordflow">if</span> (strcmp (name, <a class="code" href="interps_8h.html#a8ef82a15f52b124715117c7dcfbfa829">INTERP_MI</a>) == 0)
<a name="l00109"></a>00109     mi_version = 2;
<a name="l00110"></a>00110   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp (name, <a class="code" href="interps_8h.html#aaa97c8c73c091bcc516f07ded3c74d34">INTERP_MI1</a>) == 0)
<a name="l00111"></a>00111     mi_version = 1;
<a name="l00112"></a>00112   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp (name, <a class="code" href="interps_8h.html#a0afb639c3352bbe39c403870a94b12c4">INTERP_MI2</a>) == 0)
<a name="l00113"></a>00113     mi_version = 2;
<a name="l00114"></a>00114   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp (name, <a class="code" href="interps_8h.html#aa4032fae75b2d0583f79c5c2221727bf">INTERP_MI3</a>) == 0)
<a name="l00115"></a>00115     mi_version = 3;
<a name="l00116"></a>00116   <span class="keywordflow">else</span>
<a name="l00117"></a>00117     <a class="code" href="gdb__assert_8h.html#aa0526ecd768317edecf0b46c981cbcc0">gdb_assert_not_reached</a> (<span class="stringliteral">&quot;unhandled MI version&quot;</span>);
<a name="l00118"></a>00118 
<a name="l00119"></a>00119   mi-&gt;<a class="code" href="structmi__interp.html#a9fe195f78eae236651136aa39441b33d">uiout</a> = <a class="code" href="mi-out_8c.html#a44a884acb396bcc6a3960b20504542fe">mi_out_new</a> (mi_version);
<a name="l00120"></a>00120 
<a name="l00121"></a>00121   <span class="keywordflow">if</span> (top_level)
<a name="l00122"></a>00122     {
<a name="l00123"></a>00123       <a class="code" href="observer_8h.html#a01cc986bb1d7b2d9b26306a1a7e905a7">observer_attach_new_thread</a> (<a class="code" href="mi-interp_8c.html#a380aff65e183e2c3b14e2f637ed29cbb">mi_new_thread</a>);
<a name="l00124"></a>00124       <a class="code" href="observer_8h.html#ab8ba29ba5f9bd5ae038ee11c550b062d">observer_attach_thread_exit</a> (<a class="code" href="mi-interp_8c.html#a3e98ae6e302ef7e113d0dca829c2064c">mi_thread_exit</a>);
<a name="l00125"></a>00125       <a class="code" href="observer_8h.html#a9fba88c9af3a24b802cbb4607ffd9df6">observer_attach_inferior_added</a> (<a class="code" href="mi-interp_8c.html#a27784bb809a0101834661f1921016586">mi_inferior_added</a>);
<a name="l00126"></a>00126       <a class="code" href="observer_8h.html#a6c01a1262f958fc1f5f7e4ee3211932e">observer_attach_inferior_appeared</a> (<a class="code" href="mi-interp_8c.html#a78a16a1fafee2c935dbbe08a248ad31b">mi_inferior_appeared</a>);
<a name="l00127"></a>00127       <a class="code" href="observer_8h.html#a9a54ebb2156e3189a09d3e7afcf1b067">observer_attach_inferior_exit</a> (<a class="code" href="mi-interp_8c.html#ad06cb7b3eab3fbb0840022848cbe6916">mi_inferior_exit</a>);
<a name="l00128"></a>00128       <a class="code" href="observer_8h.html#aeb5a57c850dba9dd79b8647ab3ece07c">observer_attach_inferior_removed</a> (<a class="code" href="mi-interp_8c.html#a1c7465dd5656fc047efe22334971be49">mi_inferior_removed</a>);
<a name="l00129"></a>00129       <a class="code" href="observer_8h.html#aed87b8ff493d9bf717c729b88e8d0b7b">observer_attach_record_changed</a> (<a class="code" href="mi-interp_8c.html#afc79092844166efb123218ff19ccda1d">mi_record_changed</a>);
<a name="l00130"></a>00130       <a class="code" href="observer_8h.html#abc87124a884f15ff21d7899e6eb690d0">observer_attach_normal_stop</a> (<a class="code" href="mi-interp_8c.html#a5147838d964e57b31536766b072669aa">mi_on_normal_stop</a>);
<a name="l00131"></a>00131       <a class="code" href="observer_8h.html#a688dd0fa197dcfef15344bb84639deb3">observer_attach_target_resumed</a> (<a class="code" href="mi-interp_8c.html#a19d360e6f63bb8ea0c513ac95f9f0dd4">mi_on_resume</a>);
<a name="l00132"></a>00132       <a class="code" href="observer_8h.html#a904016e858720098d746deea3aaada6f">observer_attach_solib_loaded</a> (<a class="code" href="mi-interp_8c.html#afd11eba703051775f32ef475a83e258d">mi_solib_loaded</a>);
<a name="l00133"></a>00133       <a class="code" href="observer_8h.html#adcc6152213c4fbd8094b5bd439c0747a">observer_attach_solib_unloaded</a> (<a class="code" href="mi-interp_8c.html#ac8699802c2dbab6b40d1d7d5fd1e3291">mi_solib_unloaded</a>);
<a name="l00134"></a>00134       <a class="code" href="observer_8h.html#a36029354af4d88ac9a531ccf89aede20">observer_attach_about_to_proceed</a> (<a class="code" href="mi-interp_8c.html#ae17ac38c1bfdf776be42d50f652d7a49">mi_about_to_proceed</a>);
<a name="l00135"></a>00135       <a class="code" href="observer_8h.html#a737136bd591ce31f625bf9ab926f87ec">observer_attach_traceframe_changed</a> (<a class="code" href="mi-interp_8c.html#a20ec2fe5cd63d94377c5bbd8feb2a52e">mi_traceframe_changed</a>);
<a name="l00136"></a>00136       <a class="code" href="observer_8h.html#a7c879422b2c864dbf37499823cc77091">observer_attach_tsv_created</a> (<a class="code" href="mi-interp_8c.html#a5fb0ab4388e00737f83b1dc55c65d6c9">mi_tsv_created</a>);
<a name="l00137"></a>00137       <a class="code" href="observer_8h.html#a167d5cf1969494ab778fc935df7379ba">observer_attach_tsv_deleted</a> (<a class="code" href="mi-interp_8c.html#a1593794bc67f7d8a5f64602d0dae4bb8">mi_tsv_deleted</a>);
<a name="l00138"></a>00138       <a class="code" href="observer_8h.html#a638fa54746ca43f1e1c4107952efee8d">observer_attach_tsv_modified</a> (<a class="code" href="mi-interp_8c.html#a0cb3c1556b2017693f0388585e4aabed">mi_tsv_modified</a>);
<a name="l00139"></a>00139       <a class="code" href="observer_8h.html#aba111ffdda5f1aa8170b3cd15a3a6c94">observer_attach_breakpoint_created</a> (<a class="code" href="mi-interp_8c.html#ac0eb3ee0ed40175e882630f671298dba">mi_breakpoint_created</a>);
<a name="l00140"></a>00140       <a class="code" href="observer_8h.html#acf9aa982569991bffd276b08c7514af8">observer_attach_breakpoint_deleted</a> (<a class="code" href="mi-interp_8c.html#a8f87e4d98246d822fcf8aabeec14e4be">mi_breakpoint_deleted</a>);
<a name="l00141"></a>00141       <a class="code" href="observer_8h.html#a4ec76d5e2cad23c7a9e9de7addc877ac">observer_attach_breakpoint_modified</a> (<a class="code" href="mi-interp_8c.html#a1ff485ae1e437ac61ca08f90126be231">mi_breakpoint_modified</a>);
<a name="l00142"></a>00142       <a class="code" href="observer_8h.html#ac39573ea170c69949776414b4ffc7f5b">observer_attach_command_param_changed</a> (<a class="code" href="mi-interp_8c.html#ab57d87356090364cadf16311bece2241">mi_command_param_changed</a>);
<a name="l00143"></a>00143       <a class="code" href="observer_8h.html#a930b5ab9555a6b6bca3337c14b89de2e">observer_attach_memory_changed</a> (<a class="code" href="mi-interp_8c.html#a40bf8f631e88916076f25725dec16cf8">mi_memory_changed</a>);
<a name="l00144"></a>00144 
<a name="l00145"></a>00145       <span class="comment">/* The initial inferior is created before this function is</span>
<a name="l00146"></a>00146 <span class="comment">         called, so we need to report it explicitly.  Use iteration in</span>
<a name="l00147"></a>00147 <span class="comment">         case future version of GDB creates more than one inferior</span>
<a name="l00148"></a>00148 <span class="comment">         up-front.  */</span>
<a name="l00149"></a>00149       <a class="code" href="inferior_8c.html#afcb3f43a2669a8ad733c575dc07d3a80">iterate_over_inferiors</a> (<a class="code" href="mi-interp_8c.html#a3a17cac5b43a5afad6dff33ceb8b9e9f">report_initial_inferior</a>, mi);
<a name="l00150"></a>00150     }
<a name="l00151"></a>00151 
<a name="l00152"></a>00152   <span class="keywordflow">return</span> mi;
<a name="l00153"></a>00153 }
<a name="l00154"></a>00154 
<a name="l00155"></a>00155 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l00156"></a><a class="code" href="mi-interp_8c.html#a87514fc113a9a42a18c0ef2b2abc98ee">00156</a> <a class="code" href="mi-interp_8c.html#a87514fc113a9a42a18c0ef2b2abc98ee">mi_interpreter_resume</a> (<span class="keywordtype">void</span> *data)
<a name="l00157"></a>00157 {
<a name="l00158"></a>00158   <span class="keyword">struct </span><a class="code" href="structmi__interp.html">mi_interp</a> *mi = data;
<a name="l00159"></a>00159 
<a name="l00160"></a>00160   <span class="comment">/* As per hack note in mi_interpreter_init, swap in the output</span>
<a name="l00161"></a>00161 <span class="comment">     channels... */</span>
<a name="l00162"></a>00162   <a class="code" href="event-top_8c.html#ada4cd4c3129cffb3498065839f0e7ed3">gdb_setup_readline</a> ();
<a name="l00163"></a>00163 
<a name="l00164"></a>00164   <span class="comment">/* These overwrite some of the initialization done in</span>
<a name="l00165"></a>00165 <span class="comment">     _intialize_event_loop.  */</span>
<a name="l00166"></a>00166   <a class="code" href="event-top_8c.html#a44117c9001e49bbdba1fcb09bbac14b1">call_readline</a> = <a class="code" href="event-top_8c.html#a3ba65abb4d07c97aa9d100d7ee3f59c4">gdb_readline2</a>;
<a name="l00167"></a>00167   <a class="code" href="event-top_8c.html#a8c55795caa665bb372a77f3f8ad79624">input_handler</a> = <a class="code" href="mi-interp_8c.html#a0de0229ecb8ecadb2cf4a651b0006537">mi_execute_command_input_handler</a>;
<a name="l00168"></a>00168   <a class="code" href="event-top_8c.html#a0c25d96db6170286380cc620a381403e">async_command_editing_p</a> = 0;
<a name="l00169"></a>00169   <span class="comment">/* FIXME: This is a total hack for now.  PB&#39;s use of the MI</span>
<a name="l00170"></a>00170 <span class="comment">     implicitly relies on a bug in the async support which allows</span>
<a name="l00171"></a>00171 <span class="comment">     asynchronous commands to leak through the commmand loop.  The bug</span>
<a name="l00172"></a>00172 <span class="comment">     involves (but is not limited to) the fact that sync_execution was</span>
<a name="l00173"></a>00173 <span class="comment">     erroneously initialized to 0.  Duplicate by initializing it thus</span>
<a name="l00174"></a>00174 <span class="comment">     here...  */</span>
<a name="l00175"></a>00175   <a class="code" href="inferior_8h.html#a808bc634b7f69798d2c0c818b57c58f9">sync_execution</a> = 0;
<a name="l00176"></a>00176 
<a name="l00177"></a>00177   <a class="code" href="main_8c.html#a41a2b997ba5454df787d61f051dd918c">gdb_stdout</a> = mi-&gt;<a class="code" href="structmi__interp.html#ac8bb6a962e3cf201e8be215bbddae337">out</a>;
<a name="l00178"></a>00178   <span class="comment">/* Route error and log output through the MI.  */</span>
<a name="l00179"></a>00179   <a class="code" href="main_8c.html#a2a1dea1e551cadb9541353a004193a47">gdb_stderr</a> = mi-&gt;<a class="code" href="structmi__interp.html#a0ff34900d13331d8c52b61654ecf7eb2">err</a>;
<a name="l00180"></a>00180   <a class="code" href="main_8c.html#a097b10b28c07237b554c73fbf42a8e9e">gdb_stdlog</a> = mi-&gt;<a class="code" href="structmi__interp.html#aae20e5805757470b103b7b11830b2e66">log</a>;
<a name="l00181"></a>00181   <span class="comment">/* Route target output through the MI.  */</span>
<a name="l00182"></a>00182   <a class="code" href="main_8c.html#a88e32e1eabdc385541d2039cd1c80847">gdb_stdtarg</a> = mi-&gt;<a class="code" href="structmi__interp.html#aabe1c0e5f999b3c6413959f52bc20260">targ</a>;
<a name="l00183"></a>00183   <span class="comment">/* Route target error through the MI as well.  */</span>
<a name="l00184"></a>00184   <a class="code" href="main_8c.html#a8ec7086f69c099528d82bd50a7329162">gdb_stdtargerr</a> = mi-&gt;<a class="code" href="structmi__interp.html#aabe1c0e5f999b3c6413959f52bc20260">targ</a>;
<a name="l00185"></a>00185 
<a name="l00186"></a>00186   <span class="comment">/* Replace all the hooks that we know about.  There really needs to</span>
<a name="l00187"></a>00187 <span class="comment">     be a better way of doing this... */</span>
<a name="l00188"></a>00188   <a class="code" href="interps_8c.html#a3c626f1b0ad50affdf380d6bd307a9fe">clear_interpreter_hooks</a> ();
<a name="l00189"></a>00189 
<a name="l00190"></a>00190   <a class="code" href="defs_8h.html#aa3e9328e9e086f3192861265a9f49896">deprecated_show_load_progress</a> = <a class="code" href="mi-main_8c.html#a0753a905a014fa59648704e1e6f9f51a">mi_load_progress</a>;
<a name="l00191"></a>00191 
<a name="l00192"></a>00192   <span class="keywordflow">return</span> 1;
<a name="l00193"></a>00193 }
<a name="l00194"></a>00194 
<a name="l00195"></a>00195 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l00196"></a><a class="code" href="mi-interp_8c.html#a8ffadfd157c1b5e2a85f3526f34fe622">00196</a> <a class="code" href="mi-interp_8c.html#a8ffadfd157c1b5e2a85f3526f34fe622">mi_interpreter_suspend</a> (<span class="keywordtype">void</span> *data)
<a name="l00197"></a>00197 {
<a name="l00198"></a>00198   <a class="code" href="event-top_8c.html#a7c11e07c01e6b03f4658d1be31b145ef">gdb_disable_readline</a> ();
<a name="l00199"></a>00199   <span class="keywordflow">return</span> 1;
<a name="l00200"></a>00200 }
<a name="l00201"></a>00201 
<a name="l00202"></a>00202 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structgdb__exception.html">gdb_exception</a>
<a name="l00203"></a><a class="code" href="mi-interp_8c.html#aa1677b11f9223ea965db3d82bafeca62">00203</a> <a class="code" href="mi-interp_8c.html#aa1677b11f9223ea965db3d82bafeca62">mi_interpreter_exec</a> (void *data, <span class="keyword">const</span> <span class="keywordtype">char</span> *command)
<a name="l00204"></a>00204 {
<a name="l00205"></a>00205   <a class="code" href="mi-interp_8c.html#a89ccf50e27d46714caab459e92b82abd">mi_execute_command_wrapper</a> (command);
<a name="l00206"></a>00206   <span class="keywordflow">return</span> <a class="code" href="exceptions_8c.html#a4b322fbbfac5414950392caee965e197">exception_none</a>;
<a name="l00207"></a>00207 }
<a name="l00208"></a>00208 
<a name="l00209"></a>00209 <span class="comment">/* Never display the default GDB prompt in MI case.  */</span>
<a name="l00210"></a>00210 
<a name="l00211"></a>00211 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l00212"></a><a class="code" href="mi-interp_8c.html#a296777036ac92e6755e670231e460bf0">00212</a> <a class="code" href="mi-interp_8c.html#a296777036ac92e6755e670231e460bf0">mi_interpreter_prompt_p</a> (<span class="keywordtype">void</span> *data)
<a name="l00213"></a>00213 {
<a name="l00214"></a>00214   <span class="keywordflow">return</span> 0;
<a name="l00215"></a>00215 }
<a name="l00216"></a>00216 
<a name="l00217"></a>00217 <span class="keywordtype">void</span>
<a name="l00218"></a><a class="code" href="mi-interp_8c.html#a42d53aabdc4eb8185dee39f086385355">00218</a> <a class="code" href="mi-cmds_8h.html#a9a4db220f38b23313b2dab7670778a7c">mi_cmd_interpreter_exec</a> (<span class="keywordtype">char</span> *command, <span class="keywordtype">char</span> **argv, <span class="keywordtype">int</span> argc)
<a name="l00219"></a>00219 {
<a name="l00220"></a>00220   <span class="keyword">struct </span><a class="code" href="structinterp.html">interp</a> *interp_to_use;
<a name="l00221"></a>00221   <span class="keywordtype">int</span> i;
<a name="l00222"></a>00222   <span class="keywordtype">char</span> *mi_error_message = NULL;
<a name="l00223"></a>00223   <span class="keyword">struct </span><a class="code" href="structcleanup.html">cleanup</a> *old_chain;
<a name="l00224"></a>00224 
<a name="l00225"></a>00225   <span class="keywordflow">if</span> (argc &lt; 2)
<a name="l00226"></a>00226     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;-interpreter-exec: &quot;</span>
<a name="l00227"></a>00227              <span class="stringliteral">&quot;Usage: -interpreter-exec interp command&quot;</span>));
<a name="l00228"></a>00228 
<a name="l00229"></a>00229   interp_to_use = <a class="code" href="interps_8c.html#a63b64a75299f9e2e2e01ef14f3f4eae6">interp_lookup</a> (argv[0]);
<a name="l00230"></a>00230   <span class="keywordflow">if</span> (interp_to_use == NULL)
<a name="l00231"></a>00231     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;-interpreter-exec: could not find interpreter \&quot;%s\&quot;&quot;</span>),
<a name="l00232"></a>00232            argv[0]);
<a name="l00233"></a>00233 
<a name="l00234"></a>00234   <span class="keywordflow">if</span> (!<a class="code" href="interps_8c.html#a206590653d371c6c92408118f0cb24d8">interp_exec_p</a> (interp_to_use))
<a name="l00235"></a>00235     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;-interpreter-exec: interpreter \&quot;%s\&quot; &quot;</span>
<a name="l00236"></a>00236              <span class="stringliteral">&quot;does not support command execution&quot;</span>),
<a name="l00237"></a>00237               argv[0]);
<a name="l00238"></a>00238 
<a name="l00239"></a>00239   <span class="comment">/* Insert the MI out hooks, making sure to also call the</span>
<a name="l00240"></a>00240 <span class="comment">     interpreter&#39;s hooks if it has any.  */</span>
<a name="l00241"></a>00241   <span class="comment">/* KRS: We shouldn&#39;t need this... Events should be installed and</span>
<a name="l00242"></a>00242 <span class="comment">     they should just ALWAYS fire something out down the MI</span>
<a name="l00243"></a>00243 <span class="comment">     channel.  */</span>
<a name="l00244"></a>00244   <a class="code" href="mi-interp_8c.html#a7d32ab33812d72193d153de20d524831">mi_insert_notify_hooks</a> ();
<a name="l00245"></a>00245 
<a name="l00246"></a>00246   <span class="comment">/* Now run the code.  */</span>
<a name="l00247"></a>00247 
<a name="l00248"></a>00248   old_chain = <a class="code" href="cleanups_8c.html#a3d418f8af424aec399898c2d48b26224">make_cleanup</a> (<a class="code" href="cleanups_8c.html#a1ec2a3980c2be1f31f2142103d1f7abf">null_cleanup</a>, 0);
<a name="l00249"></a>00249   <span class="keywordflow">for</span> (i = 1; i &lt; argc; i++)
<a name="l00250"></a>00250     {
<a name="l00251"></a>00251       <span class="keyword">struct </span><a class="code" href="structgdb__exception.html">gdb_exception</a> e = <a class="code" href="interps_8c.html#af863c73cfa6d92989d90d7c2ecd4b31b">interp_exec</a> (interp_to_use, argv[i]);
<a name="l00252"></a>00252 
<a name="l00253"></a>00253       <span class="keywordflow">if</span> (e.<a class="code" href="structgdb__exception.html#ae0e14189c63f830024865d557c1122cc">reason</a> &lt; 0)
<a name="l00254"></a>00254         {
<a name="l00255"></a>00255           mi_error_message = xstrdup (e.<a class="code" href="structgdb__exception.html#a7f57f80c4d36200d121cee8cce513e5f">message</a>);
<a name="l00256"></a>00256           <a class="code" href="cleanups_8c.html#a3d418f8af424aec399898c2d48b26224">make_cleanup</a> (<a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a>, mi_error_message);
<a name="l00257"></a>00257           <span class="keywordflow">break</span>;
<a name="l00258"></a>00258         }
<a name="l00259"></a>00259     }
<a name="l00260"></a>00260 
<a name="l00261"></a>00261   <a class="code" href="mi-interp_8c.html#a738ebbadc40cd895cf993b0fb6632d69">mi_remove_notify_hooks</a> ();
<a name="l00262"></a>00262 
<a name="l00263"></a>00263   <span class="keywordflow">if</span> (mi_error_message != NULL)
<a name="l00264"></a>00264     <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<span class="stringliteral">&quot;%s&quot;</span>, mi_error_message);
<a name="l00265"></a>00265   <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (old_chain);
<a name="l00266"></a>00266 }
<a name="l00267"></a>00267 
<a name="l00268"></a>00268 <span class="comment">/* This inserts a number of hooks that are meant to produce</span>
<a name="l00269"></a>00269 <span class="comment">   async-notify (&quot;=&quot;) MI messages while running commands in another</span>
<a name="l00270"></a>00270 <span class="comment">   interpreter using mi_interpreter_exec.  The canonical use for this</span>
<a name="l00271"></a>00271 <span class="comment">   is to allow access to the gdb CLI interpreter from within the MI,</span>
<a name="l00272"></a>00272 <span class="comment">   while still producing MI style output when actions in the CLI</span>
<a name="l00273"></a>00273 <span class="comment">   command change GDB&#39;s state.  */</span>
<a name="l00274"></a>00274 
<a name="l00275"></a>00275 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00276"></a><a class="code" href="mi-interp_8c.html#a7d32ab33812d72193d153de20d524831">00276</a> <a class="code" href="mi-interp_8c.html#a7d32ab33812d72193d153de20d524831">mi_insert_notify_hooks</a> (<span class="keywordtype">void</span>)
<a name="l00277"></a>00277 {
<a name="l00278"></a>00278   <a class="code" href="defs_8h.html#a73e08825d49cc8ffff1e0166d7dd9c4a">deprecated_query_hook</a> = <a class="code" href="mi-interp_8c.html#a38b8e3be27b634dc648cce207d7608a9">mi_interp_query_hook</a>;
<a name="l00279"></a>00279 }
<a name="l00280"></a>00280 
<a name="l00281"></a>00281 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00282"></a><a class="code" href="mi-interp_8c.html#a738ebbadc40cd895cf993b0fb6632d69">00282</a> <a class="code" href="mi-interp_8c.html#a738ebbadc40cd895cf993b0fb6632d69">mi_remove_notify_hooks</a> (<span class="keywordtype">void</span>)
<a name="l00283"></a>00283 {
<a name="l00284"></a>00284   <a class="code" href="defs_8h.html#a73e08825d49cc8ffff1e0166d7dd9c4a">deprecated_query_hook</a> = NULL;
<a name="l00285"></a>00285 }
<a name="l00286"></a>00286 
<a name="l00287"></a>00287 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l00288"></a><a class="code" href="mi-interp_8c.html#a38b8e3be27b634dc648cce207d7608a9">00288</a> <a class="code" href="mi-interp_8c.html#a38b8e3be27b634dc648cce207d7608a9">mi_interp_query_hook</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> *ctlstr, va_list ap)
<a name="l00289"></a>00289 {
<a name="l00290"></a>00290   <span class="keywordflow">return</span> 1;
<a name="l00291"></a>00291 }
<a name="l00292"></a>00292 
<a name="l00293"></a>00293 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00294"></a><a class="code" href="mi-interp_8c.html#a89ccf50e27d46714caab459e92b82abd">00294</a> <a class="code" href="mi-interp_8c.html#a89ccf50e27d46714caab459e92b82abd">mi_execute_command_wrapper</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> *cmd)
<a name="l00295"></a>00295 {
<a name="l00296"></a>00296   <a class="code" href="mi-cmds_8h.html#ac7b7e16aaef3a6955fdd2c8c6a022d15">mi_execute_command</a> (cmd, stdin == <a class="code" href="top_8c.html#a3291280191f8913361ed5602219b6022">instream</a>);
<a name="l00297"></a>00297 }
<a name="l00298"></a>00298 
<a name="l00299"></a>00299 <span class="comment">/* mi_execute_command_wrapper wrapper suitable for INPUT_HANDLER.  */</span>
<a name="l00300"></a>00300 
<a name="l00301"></a>00301 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00302"></a><a class="code" href="mi-interp_8c.html#a0de0229ecb8ecadb2cf4a651b0006537">00302</a> <a class="code" href="mi-interp_8c.html#a0de0229ecb8ecadb2cf4a651b0006537">mi_execute_command_input_handler</a> (<span class="keywordtype">char</span> *cmd)
<a name="l00303"></a>00303 {
<a name="l00304"></a>00304   <a class="code" href="mi-interp_8c.html#a89ccf50e27d46714caab459e92b82abd">mi_execute_command_wrapper</a> (cmd);
<a name="l00305"></a>00305 
<a name="l00306"></a>00306   <a class="code" href="ui-file_8c.html#aae3b905f888b1dcdce586f77b9554153">fputs_unfiltered</a> (<span class="stringliteral">&quot;(gdb) \n&quot;</span>, <a class="code" href="mi-cmds_8h.html#a291315c01d39483f0026b8a849b70fba">raw_stdout</a>);
<a name="l00307"></a>00307   <a class="code" href="ui-file_8c.html#a046f07b5ef1bcc35c28b4be983e39998">gdb_flush</a> (<a class="code" href="mi-cmds_8h.html#a291315c01d39483f0026b8a849b70fba">raw_stdout</a>);
<a name="l00308"></a>00308 }
<a name="l00309"></a>00309 
<a name="l00310"></a>00310 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00311"></a><a class="code" href="mi-interp_8c.html#a94631d0d7bf085ae413460a2578a2480">00311</a> <a class="code" href="mi-interp_8c.html#a94631d0d7bf085ae413460a2578a2480">mi_command_loop</a> (<span class="keywordtype">void</span> *data)
<a name="l00312"></a>00312 {
<a name="l00313"></a>00313   <span class="comment">/* Turn off 8 bit strings in quoted output.  Any character with the</span>
<a name="l00314"></a>00314 <span class="comment">     high bit set is printed using C&#39;s octal format.  */</span>
<a name="l00315"></a>00315   <a class="code" href="utils_8c.html#a3d85ae7b6a5716072d84b123a7cd877c">sevenbit_strings</a> = 1;
<a name="l00316"></a>00316 
<a name="l00317"></a>00317   <span class="comment">/* Tell the world that we&#39;re alive.  */</span>
<a name="l00318"></a>00318   <a class="code" href="ui-file_8c.html#aae3b905f888b1dcdce586f77b9554153">fputs_unfiltered</a> (<span class="stringliteral">&quot;(gdb) \n&quot;</span>, <a class="code" href="mi-cmds_8h.html#a291315c01d39483f0026b8a849b70fba">raw_stdout</a>);
<a name="l00319"></a>00319   <a class="code" href="ui-file_8c.html#a046f07b5ef1bcc35c28b4be983e39998">gdb_flush</a> (<a class="code" href="mi-cmds_8h.html#a291315c01d39483f0026b8a849b70fba">raw_stdout</a>);
<a name="l00320"></a>00320 
<a name="l00321"></a>00321   <a class="code" href="event-loop_8c.html#aa771684e91976dc40ce481207fbaf24a">start_event_loop</a> ();
<a name="l00322"></a>00322 }
<a name="l00323"></a>00323 
<a name="l00324"></a>00324 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00325"></a><a class="code" href="mi-interp_8c.html#a380aff65e183e2c3b14e2f637ed29cbb">00325</a> <a class="code" href="mi-interp_8c.html#a380aff65e183e2c3b14e2f637ed29cbb">mi_new_thread</a> (<span class="keyword">struct</span> <a class="code" href="structthread__info.html">thread_info</a> *t)
<a name="l00326"></a>00326 {
<a name="l00327"></a>00327   <span class="keyword">struct </span><a class="code" href="structmi__interp.html">mi_interp</a> *mi = <a class="code" href="interps_8c.html#a045aa3f9489496bd379f36c7ace015cf">top_level_interpreter_data</a> ();
<a name="l00328"></a>00328   <span class="keyword">struct </span><a class="code" href="structinferior.html">inferior</a> *<a class="code" href="structinf.html">inf</a> = <a class="code" href="inferior_8c.html#aa6cb4e509f05c4b88a55198f804dc2cc">find_inferior_pid</a> (<a class="code" href="ptid_8c.html#a264ba40fc2a0cf3d4fb24a55fe32aede">ptid_get_pid</a> (t-&gt;<a class="code" href="structthread__info.html#a533aa3979b60affd446e9fbff93fdd2c">ptid</a>));
<a name="l00329"></a>00329 
<a name="l00330"></a>00330   <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (inf);
<a name="l00331"></a>00331 
<a name="l00332"></a>00332   <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (mi-&gt;<a class="code" href="structmi__interp.html#a9789f994da11c82cd9217afb3355c28b">event_channel</a>, 
<a name="l00333"></a>00333                       <span class="stringliteral">&quot;thread-created,id=\&quot;%d\&quot;,group-id=\&quot;i%d\&quot;&quot;</span>,
<a name="l00334"></a>00334                       t-&gt;<a class="code" href="structthread__info.html#a64accc7e3d39da1d926c23877f9f9d0d">num</a>, inf-&gt;<a class="code" href="structinferior.html#af9e2350a56bd124ce14020ccc0c93f9e">num</a>);
<a name="l00335"></a>00335   <a class="code" href="ui-file_8c.html#a046f07b5ef1bcc35c28b4be983e39998">gdb_flush</a> (mi-&gt;<a class="code" href="structmi__interp.html#a9789f994da11c82cd9217afb3355c28b">event_channel</a>);
<a name="l00336"></a>00336 }
<a name="l00337"></a>00337 
<a name="l00338"></a>00338 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00339"></a><a class="code" href="mi-interp_8c.html#a3e98ae6e302ef7e113d0dca829c2064c">00339</a> <a class="code" href="mi-interp_8c.html#a3e98ae6e302ef7e113d0dca829c2064c">mi_thread_exit</a> (<span class="keyword">struct</span> <a class="code" href="structthread__info.html">thread_info</a> *t, <span class="keywordtype">int</span> silent)
<a name="l00340"></a>00340 {
<a name="l00341"></a>00341   <span class="keyword">struct </span><a class="code" href="structmi__interp.html">mi_interp</a> *mi;
<a name="l00342"></a>00342   <span class="keyword">struct </span><a class="code" href="structinferior.html">inferior</a> *<a class="code" href="namespacearm-linux.html#aaf6bae53545ee96f24d7ba560ed0a205">inf</a>;
<a name="l00343"></a>00343 
<a name="l00344"></a>00344   <span class="keywordflow">if</span> (silent)
<a name="l00345"></a>00345     <span class="keywordflow">return</span>;
<a name="l00346"></a>00346 
<a name="l00347"></a>00347   inf = <a class="code" href="inferior_8c.html#aa6cb4e509f05c4b88a55198f804dc2cc">find_inferior_pid</a> (<a class="code" href="ptid_8c.html#a264ba40fc2a0cf3d4fb24a55fe32aede">ptid_get_pid</a> (t-&gt;<a class="code" href="structthread__info.html#a533aa3979b60affd446e9fbff93fdd2c">ptid</a>));
<a name="l00348"></a>00348 
<a name="l00349"></a>00349   mi = <a class="code" href="interps_8c.html#a045aa3f9489496bd379f36c7ace015cf">top_level_interpreter_data</a> ();
<a name="l00350"></a>00350   <a class="code" href="target_8h.html#a7128a26aa3c50e663201b4a6633636fe">target_terminal_ours</a> ();
<a name="l00351"></a>00351   <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (mi-&gt;<a class="code" href="structmi__interp.html#a9789f994da11c82cd9217afb3355c28b">event_channel</a>, 
<a name="l00352"></a>00352                       <span class="stringliteral">&quot;thread-exited,id=\&quot;%d\&quot;,group-id=\&quot;i%d\&quot;&quot;</span>,
<a name="l00353"></a>00353                       t-&gt;<a class="code" href="structthread__info.html#a64accc7e3d39da1d926c23877f9f9d0d">num</a>, inf-&gt;<a class="code" href="structinferior.html#af9e2350a56bd124ce14020ccc0c93f9e">num</a>);
<a name="l00354"></a>00354   <a class="code" href="ui-file_8c.html#a046f07b5ef1bcc35c28b4be983e39998">gdb_flush</a> (mi-&gt;<a class="code" href="structmi__interp.html#a9789f994da11c82cd9217afb3355c28b">event_channel</a>);
<a name="l00355"></a>00355 }
<a name="l00356"></a>00356 
<a name="l00357"></a>00357 <span class="comment">/* Emit notification on changing the state of record.  */</span>
<a name="l00358"></a>00358 
<a name="l00359"></a>00359 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00360"></a><a class="code" href="mi-interp_8c.html#afc79092844166efb123218ff19ccda1d">00360</a> <a class="code" href="mi-interp_8c.html#afc79092844166efb123218ff19ccda1d">mi_record_changed</a> (<span class="keyword">struct</span> <a class="code" href="structinferior.html">inferior</a> *<a class="code" href="structinferior.html">inferior</a>, <span class="keywordtype">int</span> started)
<a name="l00361"></a>00361 {
<a name="l00362"></a>00362   <span class="keyword">struct </span><a class="code" href="structmi__interp.html">mi_interp</a> *mi = <a class="code" href="interps_8c.html#a045aa3f9489496bd379f36c7ace015cf">top_level_interpreter_data</a> ();
<a name="l00363"></a>00363 
<a name="l00364"></a>00364   <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (mi-&gt;<a class="code" href="structmi__interp.html#a9789f994da11c82cd9217afb3355c28b">event_channel</a>,  <span class="stringliteral">&quot;record-%s,thread-group=\&quot;i%d\&quot;&quot;</span>,
<a name="l00365"></a>00365                       started ? <span class="stringliteral">&quot;started&quot;</span> : <span class="stringliteral">&quot;stopped&quot;</span>, inferior-&gt;<a class="code" href="structinferior.html#af9e2350a56bd124ce14020ccc0c93f9e">num</a>);
<a name="l00366"></a>00366 
<a name="l00367"></a>00367   <a class="code" href="ui-file_8c.html#a046f07b5ef1bcc35c28b4be983e39998">gdb_flush</a> (mi-&gt;<a class="code" href="structmi__interp.html#a9789f994da11c82cd9217afb3355c28b">event_channel</a>);
<a name="l00368"></a>00368 }
<a name="l00369"></a>00369 
<a name="l00370"></a>00370 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00371"></a><a class="code" href="mi-interp_8c.html#a27784bb809a0101834661f1921016586">00371</a> <a class="code" href="mi-interp_8c.html#a27784bb809a0101834661f1921016586">mi_inferior_added</a> (<span class="keyword">struct</span> <a class="code" href="structinferior.html">inferior</a> *<a class="code" href="structinf.html">inf</a>)
<a name="l00372"></a>00372 {
<a name="l00373"></a>00373   <span class="keyword">struct </span><a class="code" href="structmi__interp.html">mi_interp</a> *mi = <a class="code" href="interps_8c.html#a045aa3f9489496bd379f36c7ace015cf">top_level_interpreter_data</a> ();
<a name="l00374"></a>00374 
<a name="l00375"></a>00375   <a class="code" href="target_8h.html#a7128a26aa3c50e663201b4a6633636fe">target_terminal_ours</a> ();
<a name="l00376"></a>00376   <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (mi-&gt;<a class="code" href="structmi__interp.html#a9789f994da11c82cd9217afb3355c28b">event_channel</a>,
<a name="l00377"></a>00377                       <span class="stringliteral">&quot;thread-group-added,id=\&quot;i%d\&quot;&quot;</span>,
<a name="l00378"></a>00378                       inf-&gt;<a class="code" href="structinferior.html#af9e2350a56bd124ce14020ccc0c93f9e">num</a>);
<a name="l00379"></a>00379   <a class="code" href="ui-file_8c.html#a046f07b5ef1bcc35c28b4be983e39998">gdb_flush</a> (mi-&gt;<a class="code" href="structmi__interp.html#a9789f994da11c82cd9217afb3355c28b">event_channel</a>);
<a name="l00380"></a>00380 }
<a name="l00381"></a>00381 
<a name="l00382"></a>00382 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00383"></a><a class="code" href="mi-interp_8c.html#a78a16a1fafee2c935dbbe08a248ad31b">00383</a> <a class="code" href="mi-interp_8c.html#a78a16a1fafee2c935dbbe08a248ad31b">mi_inferior_appeared</a> (<span class="keyword">struct</span> <a class="code" href="structinferior.html">inferior</a> *<a class="code" href="structinf.html">inf</a>)
<a name="l00384"></a>00384 {
<a name="l00385"></a>00385   <span class="keyword">struct </span><a class="code" href="structmi__interp.html">mi_interp</a> *mi = <a class="code" href="interps_8c.html#a045aa3f9489496bd379f36c7ace015cf">top_level_interpreter_data</a> ();
<a name="l00386"></a>00386 
<a name="l00387"></a>00387   <a class="code" href="target_8h.html#a7128a26aa3c50e663201b4a6633636fe">target_terminal_ours</a> ();
<a name="l00388"></a>00388   <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (mi-&gt;<a class="code" href="structmi__interp.html#a9789f994da11c82cd9217afb3355c28b">event_channel</a>,
<a name="l00389"></a>00389                       <span class="stringliteral">&quot;thread-group-started,id=\&quot;i%d\&quot;,pid=\&quot;%d\&quot;&quot;</span>,
<a name="l00390"></a>00390                       inf-&gt;<a class="code" href="structinferior.html#af9e2350a56bd124ce14020ccc0c93f9e">num</a>, inf-&gt;<a class="code" href="structinferior.html#a1be87f581dbb6c893dbe1f2ff701636a">pid</a>);
<a name="l00391"></a>00391   <a class="code" href="ui-file_8c.html#a046f07b5ef1bcc35c28b4be983e39998">gdb_flush</a> (mi-&gt;<a class="code" href="structmi__interp.html#a9789f994da11c82cd9217afb3355c28b">event_channel</a>);
<a name="l00392"></a>00392 }
<a name="l00393"></a>00393 
<a name="l00394"></a>00394 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00395"></a><a class="code" href="mi-interp_8c.html#ad06cb7b3eab3fbb0840022848cbe6916">00395</a> <a class="code" href="mi-interp_8c.html#ad06cb7b3eab3fbb0840022848cbe6916">mi_inferior_exit</a> (<span class="keyword">struct</span> <a class="code" href="structinferior.html">inferior</a> *<a class="code" href="structinf.html">inf</a>)
<a name="l00396"></a>00396 {
<a name="l00397"></a>00397   <span class="keyword">struct </span><a class="code" href="structmi__interp.html">mi_interp</a> *mi = <a class="code" href="interps_8c.html#a045aa3f9489496bd379f36c7ace015cf">top_level_interpreter_data</a> ();
<a name="l00398"></a>00398 
<a name="l00399"></a>00399   <a class="code" href="target_8h.html#a7128a26aa3c50e663201b4a6633636fe">target_terminal_ours</a> ();
<a name="l00400"></a>00400   <span class="keywordflow">if</span> (inf-&gt;<a class="code" href="structinferior.html#a38748b019158d27df939745e12d9084b">has_exit_code</a>)
<a name="l00401"></a>00401     <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (mi-&gt;<a class="code" href="structmi__interp.html#a9789f994da11c82cd9217afb3355c28b">event_channel</a>,
<a name="l00402"></a>00402                         <span class="stringliteral">&quot;thread-group-exited,id=\&quot;i%d\&quot;,exit-code=\&quot;%s\&quot;&quot;</span>,
<a name="l00403"></a>00403                         inf-&gt;<a class="code" href="structinferior.html#af9e2350a56bd124ce14020ccc0c93f9e">num</a>, <a class="code" href="utils_8c.html#a3ce8e8de91440036fe0ce3f1e00b5666">int_string</a> (inf-&gt;<a class="code" href="structinferior.html#ac513f42cdd45b9560d83f4bc2a1a8b64">exit_code</a>, 8, 0, 0, 1));
<a name="l00404"></a>00404   <span class="keywordflow">else</span>
<a name="l00405"></a>00405     <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (mi-&gt;<a class="code" href="structmi__interp.html#a9789f994da11c82cd9217afb3355c28b">event_channel</a>,
<a name="l00406"></a>00406                         <span class="stringliteral">&quot;thread-group-exited,id=\&quot;i%d\&quot;&quot;</span>, inf-&gt;<a class="code" href="structinferior.html#af9e2350a56bd124ce14020ccc0c93f9e">num</a>);
<a name="l00407"></a>00407 
<a name="l00408"></a>00408   <a class="code" href="ui-file_8c.html#a046f07b5ef1bcc35c28b4be983e39998">gdb_flush</a> (mi-&gt;<a class="code" href="structmi__interp.html#a9789f994da11c82cd9217afb3355c28b">event_channel</a>);  
<a name="l00409"></a>00409 }
<a name="l00410"></a>00410 
<a name="l00411"></a>00411 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00412"></a><a class="code" href="mi-interp_8c.html#a1c7465dd5656fc047efe22334971be49">00412</a> <a class="code" href="mi-interp_8c.html#a1c7465dd5656fc047efe22334971be49">mi_inferior_removed</a> (<span class="keyword">struct</span> <a class="code" href="structinferior.html">inferior</a> *<a class="code" href="structinf.html">inf</a>)
<a name="l00413"></a>00413 {
<a name="l00414"></a>00414   <span class="keyword">struct </span><a class="code" href="structmi__interp.html">mi_interp</a> *mi = <a class="code" href="interps_8c.html#a045aa3f9489496bd379f36c7ace015cf">top_level_interpreter_data</a> ();
<a name="l00415"></a>00415 
<a name="l00416"></a>00416   <a class="code" href="target_8h.html#a7128a26aa3c50e663201b4a6633636fe">target_terminal_ours</a> ();
<a name="l00417"></a>00417   <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (mi-&gt;<a class="code" href="structmi__interp.html#a9789f994da11c82cd9217afb3355c28b">event_channel</a>,
<a name="l00418"></a>00418                       <span class="stringliteral">&quot;thread-group-removed,id=\&quot;i%d\&quot;&quot;</span>,
<a name="l00419"></a>00419                       inf-&gt;<a class="code" href="structinferior.html#af9e2350a56bd124ce14020ccc0c93f9e">num</a>);
<a name="l00420"></a>00420   <a class="code" href="ui-file_8c.html#a046f07b5ef1bcc35c28b4be983e39998">gdb_flush</a> (mi-&gt;<a class="code" href="structmi__interp.html#a9789f994da11c82cd9217afb3355c28b">event_channel</a>);
<a name="l00421"></a>00421 }
<a name="l00422"></a>00422 
<a name="l00423"></a>00423 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00424"></a><a class="code" href="mi-interp_8c.html#a5147838d964e57b31536766b072669aa">00424</a> <a class="code" href="mi-interp_8c.html#a5147838d964e57b31536766b072669aa">mi_on_normal_stop</a> (<span class="keyword">struct</span> <a class="code" href="structbpstats.html">bpstats</a> *bs, <span class="keywordtype">int</span> <a class="code" href="stack_8c.html#ab3f10aab610905e59c2a90953afd1d24">print_frame</a>)
<a name="l00425"></a>00425 {
<a name="l00426"></a>00426   <span class="comment">/* Since this can be called when CLI command is executing,</span>
<a name="l00427"></a>00427 <span class="comment">     using cli interpreter, be sure to use MI uiout for output,</span>
<a name="l00428"></a>00428 <span class="comment">     not the current one.  */</span>
<a name="l00429"></a>00429   <span class="keyword">struct </span><a class="code" href="structui__out.html">ui_out</a> *mi_uiout = <a class="code" href="interps_8c.html#a8e9dd8dc026ec4b76ae0c0a27a97383d">interp_ui_out</a> (<a class="code" href="interps_8c.html#a55d2f9afbe93d6b241b23fdffb5f17a4">top_level_interpreter</a> ());
<a name="l00430"></a>00430 
<a name="l00431"></a>00431   <span class="keywordflow">if</span> (print_frame)
<a name="l00432"></a>00432     {
<a name="l00433"></a>00433       <span class="keywordtype">int</span> core;
<a name="l00434"></a>00434 
<a name="l00435"></a>00435       <span class="keywordflow">if</span> (<a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a> != mi_uiout)
<a name="l00436"></a>00436         {
<a name="l00437"></a>00437           <span class="comment">/* The normal_stop function has printed frame information</span>
<a name="l00438"></a>00438 <span class="comment">             into CLI uiout, or some other non-MI uiout.  There&#39;s no</span>
<a name="l00439"></a>00439 <span class="comment">             way we can extract proper fields from random uiout</span>
<a name="l00440"></a>00440 <span class="comment">             object, so we print the frame again.  In practice, this</span>
<a name="l00441"></a>00441 <span class="comment">             can only happen when running a CLI command in MI.  */</span>
<a name="l00442"></a>00442           <span class="keyword">struct </span><a class="code" href="structui__out.html">ui_out</a> *saved_uiout = <a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a>;
<a name="l00443"></a>00443           <span class="keyword">struct </span><a class="code" href="structtarget__waitstatus.html">target_waitstatus</a> last;
<a name="l00444"></a>00444           <a class="code" href="structptid.html">ptid_t</a> last_ptid;
<a name="l00445"></a>00445 
<a name="l00446"></a>00446           <a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a> = mi_uiout;
<a name="l00447"></a>00447 
<a name="l00448"></a>00448           <a class="code" href="inferior_8h.html#a4a47a81bc60d7b0fd147f0d4ce8de8bc">get_last_target_status</a> (&amp;last_ptid, &amp;last);
<a name="l00449"></a>00449           <a class="code" href="breakpoint_8c.html#a1e1d6bc375a82c26b53ee3614ff3f4bf">bpstat_print</a> (bs, last.<a class="code" href="structtarget__waitstatus.html#a17ed1783e9146f443fa51ace8da76198">kind</a>);
<a name="l00450"></a>00450 
<a name="l00451"></a>00451           <a class="code" href="frame_8h.html#a849748a17da39e76cc4648e83c64c344">print_stack_frame</a> (<a class="code" href="frame_8c.html#a8b714a78478670e14a297eba8d1a9915">get_selected_frame</a> (NULL), 0, <a class="code" href="frame_8h.html#a2431f51963af6773c12937f24f7525a4a706a5abb481e7684ba3944582daf6727">SRC_AND_LOC</a>, 1);
<a name="l00452"></a>00452           <a class="code" href="ui-out_8c.html#a3d9e2a5710f076cc035ef73920eb8c87">current_uiout</a> = saved_uiout;
<a name="l00453"></a>00453         }
<a name="l00454"></a>00454 
<a name="l00455"></a>00455       <a class="code" href="ui-out_8c.html#aa6f66551d03db456fb94ca1c9038f5a0">ui_out_field_int</a> (mi_uiout, <span class="stringliteral">&quot;thread-id&quot;</span>,
<a name="l00456"></a>00456                         <a class="code" href="gdbthread_8h.html#a3dbd3518561f91d8aa7621a65d39f305">pid_to_thread_id</a> (<a class="code" href="infcmd_8c.html#a428c5be9ce5e70bd03760e828e19c6b7">inferior_ptid</a>));
<a name="l00457"></a>00457       <span class="keywordflow">if</span> (<a class="code" href="inferior_8h.html#af01b8288bc30e83805793d6908408e81">non_stop</a>)
<a name="l00458"></a>00458         {
<a name="l00459"></a>00459           <span class="keyword">struct </span><a class="code" href="structcleanup.html">cleanup</a> *back_to = <a class="code" href="ui-out_8c.html#aa6e8e9b18ba11e13617a6c56cbfab08f">make_cleanup_ui_out_list_begin_end</a> 
<a name="l00460"></a>00460             (mi_uiout, <span class="stringliteral">&quot;stopped-threads&quot;</span>);
<a name="l00461"></a>00461 
<a name="l00462"></a>00462           <a class="code" href="ui-out_8c.html#aa6f66551d03db456fb94ca1c9038f5a0">ui_out_field_int</a> (mi_uiout, NULL,
<a name="l00463"></a>00463                             <a class="code" href="gdbthread_8h.html#a3dbd3518561f91d8aa7621a65d39f305">pid_to_thread_id</a> (<a class="code" href="infcmd_8c.html#a428c5be9ce5e70bd03760e828e19c6b7">inferior_ptid</a>));
<a name="l00464"></a>00464           <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (back_to);
<a name="l00465"></a>00465         }
<a name="l00466"></a>00466       <span class="keywordflow">else</span>
<a name="l00467"></a>00467         <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a> (mi_uiout, <span class="stringliteral">&quot;stopped-threads&quot;</span>, <span class="stringliteral">&quot;all&quot;</span>);
<a name="l00468"></a>00468 
<a name="l00469"></a>00469       core = <a class="code" href="target_8c.html#a71e29bd9cb12824ec46394190d8b08c7">target_core_of_thread</a> (<a class="code" href="infcmd_8c.html#a428c5be9ce5e70bd03760e828e19c6b7">inferior_ptid</a>);
<a name="l00470"></a>00470       <span class="keywordflow">if</span> (core != -1)
<a name="l00471"></a>00471         <a class="code" href="ui-out_8c.html#aa6f66551d03db456fb94ca1c9038f5a0">ui_out_field_int</a> (mi_uiout, <span class="stringliteral">&quot;core&quot;</span>, core);
<a name="l00472"></a>00472     }
<a name="l00473"></a>00473   
<a name="l00474"></a>00474   <a class="code" href="ui-file_8c.html#aae3b905f888b1dcdce586f77b9554153">fputs_unfiltered</a> (<span class="stringliteral">&quot;*stopped&quot;</span>, <a class="code" href="mi-cmds_8h.html#a291315c01d39483f0026b8a849b70fba">raw_stdout</a>);
<a name="l00475"></a>00475   <a class="code" href="mi-out_8c.html#a395eec86cb794425014fa789e78d18f9">mi_out_put</a> (mi_uiout, <a class="code" href="mi-cmds_8h.html#a291315c01d39483f0026b8a849b70fba">raw_stdout</a>);
<a name="l00476"></a>00476   <a class="code" href="mi-out_8c.html#a5586f83db70f70a26abc03703c9b177e">mi_out_rewind</a> (mi_uiout);
<a name="l00477"></a>00477   <a class="code" href="mi-main_8c.html#a000d4dec4db900d06f900cfde3eb1f93">mi_print_timing_maybe</a> ();
<a name="l00478"></a>00478   <a class="code" href="ui-file_8c.html#aae3b905f888b1dcdce586f77b9554153">fputs_unfiltered</a> (<span class="stringliteral">&quot;\n&quot;</span>, <a class="code" href="mi-cmds_8h.html#a291315c01d39483f0026b8a849b70fba">raw_stdout</a>);
<a name="l00479"></a>00479   <a class="code" href="ui-file_8c.html#a046f07b5ef1bcc35c28b4be983e39998">gdb_flush</a> (<a class="code" href="mi-cmds_8h.html#a291315c01d39483f0026b8a849b70fba">raw_stdout</a>);
<a name="l00480"></a>00480 }
<a name="l00481"></a>00481 
<a name="l00482"></a>00482 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00483"></a><a class="code" href="mi-interp_8c.html#ae17ac38c1bfdf776be42d50f652d7a49">00483</a> <a class="code" href="mi-interp_8c.html#ae17ac38c1bfdf776be42d50f652d7a49">mi_about_to_proceed</a> (<span class="keywordtype">void</span>)
<a name="l00484"></a>00484 {
<a name="l00485"></a>00485   <span class="comment">/* Suppress output while calling an inferior function.  */</span>
<a name="l00486"></a>00486 
<a name="l00487"></a>00487   <span class="keywordflow">if</span> (!<a class="code" href="ptid_8c.html#a0df58c8db2620a2cec647934b4f77266">ptid_equal</a> (<a class="code" href="infcmd_8c.html#a428c5be9ce5e70bd03760e828e19c6b7">inferior_ptid</a>, <a class="code" href="ptid_8c.html#acba69c857786546b204883bbcc90a64e">null_ptid</a>))
<a name="l00488"></a>00488     {
<a name="l00489"></a>00489       <span class="keyword">struct </span><a class="code" href="structthread__info.html">thread_info</a> *tp = <a class="code" href="gdbthread_8h.html#a668af1dd99cac24599dc0f3ef6458924">inferior_thread</a> ();
<a name="l00490"></a>00490 
<a name="l00491"></a>00491       <span class="keywordflow">if</span> (tp-&gt;<a class="code" href="structthread__info.html#a223c3ebf1726773195c6e75c247ddd3c">control</a>.<a class="code" href="structthread__control__state.html#a340358c8f365b4f792bbfc16059a4e0a">in_infcall</a>)
<a name="l00492"></a>00492         <span class="keywordflow">return</span>;
<a name="l00493"></a>00493     }
<a name="l00494"></a>00494 
<a name="l00495"></a>00495   <a class="code" href="mi-main_8c.html#a987c1fbb7cbe6c0bf8abd268085acb0a">mi_proceeded</a> = 1;
<a name="l00496"></a>00496 }
<a name="l00497"></a>00497 
<a name="l00498"></a>00498 <span class="comment">/* When the element is non-zero, no MI notifications will be emitted in</span>
<a name="l00499"></a>00499 <span class="comment">   response to the corresponding observers.  */</span>
<a name="l00500"></a>00500 
<a name="l00501"></a><a class="code" href="mi-main_8h.html#a6ab4725e8a2e83a2d953873696a91016">00501</a> <span class="keyword">struct </span><a class="code" href="structmi__suppress__notification.html">mi_suppress_notification</a> <a class="code" href="structmi__suppress__notification.html">mi_suppress_notification</a> =
<a name="l00502"></a>00502   {
<a name="l00503"></a>00503     0,
<a name="l00504"></a>00504     0,
<a name="l00505"></a>00505     0,
<a name="l00506"></a>00506   };
<a name="l00507"></a>00507 
<a name="l00508"></a>00508 <span class="comment">/* Emit notification on changing a traceframe.  */</span>
<a name="l00509"></a>00509 
<a name="l00510"></a>00510 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00511"></a><a class="code" href="mi-interp_8c.html#a20ec2fe5cd63d94377c5bbd8feb2a52e">00511</a> <a class="code" href="mi-interp_8c.html#a20ec2fe5cd63d94377c5bbd8feb2a52e">mi_traceframe_changed</a> (<span class="keywordtype">int</span> tfnum, <span class="keywordtype">int</span> tpnum)
<a name="l00512"></a>00512 {
<a name="l00513"></a>00513   <span class="keyword">struct </span><a class="code" href="structmi__interp.html">mi_interp</a> *mi = <a class="code" href="interps_8c.html#a045aa3f9489496bd379f36c7ace015cf">top_level_interpreter_data</a> ();
<a name="l00514"></a>00514 
<a name="l00515"></a>00515   <span class="keywordflow">if</span> (mi_suppress_notification.<a class="code" href="structmi__suppress__notification.html#aaa9ef30f0872bff08c6ab8a10017c07d">traceframe</a>)
<a name="l00516"></a>00516     <span class="keywordflow">return</span>;
<a name="l00517"></a>00517 
<a name="l00518"></a>00518   <a class="code" href="target_8h.html#a7128a26aa3c50e663201b4a6633636fe">target_terminal_ours</a> ();
<a name="l00519"></a>00519 
<a name="l00520"></a>00520   <span class="keywordflow">if</span> (tfnum &gt;= 0)
<a name="l00521"></a>00521     <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (mi-&gt;<a class="code" href="structmi__interp.html#a9789f994da11c82cd9217afb3355c28b">event_channel</a>, <span class="stringliteral">&quot;traceframe-changed,&quot;</span>
<a name="l00522"></a>00522                         <span class="stringliteral">&quot;num=\&quot;%d\&quot;,tracepoint=\&quot;%d\&quot;\n&quot;</span>,
<a name="l00523"></a>00523                         tfnum, tpnum);
<a name="l00524"></a>00524   <span class="keywordflow">else</span>
<a name="l00525"></a>00525     <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (mi-&gt;<a class="code" href="structmi__interp.html#a9789f994da11c82cd9217afb3355c28b">event_channel</a>, <span class="stringliteral">&quot;traceframe-changed,end&quot;</span>);
<a name="l00526"></a>00526 
<a name="l00527"></a>00527   <a class="code" href="ui-file_8c.html#a046f07b5ef1bcc35c28b4be983e39998">gdb_flush</a> (mi-&gt;<a class="code" href="structmi__interp.html#a9789f994da11c82cd9217afb3355c28b">event_channel</a>);
<a name="l00528"></a>00528 }
<a name="l00529"></a>00529 
<a name="l00530"></a>00530 <span class="comment">/* Emit notification on creating a trace state variable.  */</span>
<a name="l00531"></a>00531 
<a name="l00532"></a>00532 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00533"></a><a class="code" href="mi-interp_8c.html#a5fb0ab4388e00737f83b1dc55c65d6c9">00533</a> <a class="code" href="mi-interp_8c.html#a5fb0ab4388e00737f83b1dc55c65d6c9">mi_tsv_created</a> (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structtrace__state__variable.html">trace_state_variable</a> *tsv)
<a name="l00534"></a>00534 {
<a name="l00535"></a>00535   <span class="keyword">struct </span><a class="code" href="structmi__interp.html">mi_interp</a> *mi = <a class="code" href="interps_8c.html#a045aa3f9489496bd379f36c7ace015cf">top_level_interpreter_data</a> ();
<a name="l00536"></a>00536 
<a name="l00537"></a>00537   <a class="code" href="target_8h.html#a7128a26aa3c50e663201b4a6633636fe">target_terminal_ours</a> ();
<a name="l00538"></a>00538 
<a name="l00539"></a>00539   <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (mi-&gt;<a class="code" href="structmi__interp.html#a9789f994da11c82cd9217afb3355c28b">event_channel</a>, <span class="stringliteral">&quot;tsv-created,&quot;</span>
<a name="l00540"></a>00540                       <span class="stringliteral">&quot;name=\&quot;%s\&quot;,initial=\&quot;%s\&quot;\n&quot;</span>,
<a name="l00541"></a>00541                       tsv-&gt;<a class="code" href="structtrace__state__variable.html#ac86438487a7fe60738afe3ba2699b09f">name</a>, <a class="code" href="utils_8c.html#a707b1023c85049b17b9d1ca01c58768a">plongest</a> (tsv-&gt;<a class="code" href="structtrace__state__variable.html#aa0332c05c03fbfd925ec6b83c7ec21de">initial_value</a>));
<a name="l00542"></a>00542 
<a name="l00543"></a>00543   <a class="code" href="ui-file_8c.html#a046f07b5ef1bcc35c28b4be983e39998">gdb_flush</a> (mi-&gt;<a class="code" href="structmi__interp.html#a9789f994da11c82cd9217afb3355c28b">event_channel</a>);
<a name="l00544"></a>00544 }
<a name="l00545"></a>00545 
<a name="l00546"></a>00546 <span class="comment">/* Emit notification on deleting a trace state variable.  */</span>
<a name="l00547"></a>00547 
<a name="l00548"></a>00548 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00549"></a><a class="code" href="mi-interp_8c.html#a1593794bc67f7d8a5f64602d0dae4bb8">00549</a> <a class="code" href="mi-interp_8c.html#a1593794bc67f7d8a5f64602d0dae4bb8">mi_tsv_deleted</a> (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structtrace__state__variable.html">trace_state_variable</a> *tsv)
<a name="l00550"></a>00550 {
<a name="l00551"></a>00551   <span class="keyword">struct </span><a class="code" href="structmi__interp.html">mi_interp</a> *mi = <a class="code" href="interps_8c.html#a045aa3f9489496bd379f36c7ace015cf">top_level_interpreter_data</a> ();
<a name="l00552"></a>00552 
<a name="l00553"></a>00553   <a class="code" href="target_8h.html#a7128a26aa3c50e663201b4a6633636fe">target_terminal_ours</a> ();
<a name="l00554"></a>00554 
<a name="l00555"></a>00555   <span class="keywordflow">if</span> (tsv != NULL)
<a name="l00556"></a>00556     <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (mi-&gt;<a class="code" href="structmi__interp.html#a9789f994da11c82cd9217afb3355c28b">event_channel</a>, <span class="stringliteral">&quot;tsv-deleted,&quot;</span>
<a name="l00557"></a>00557                         <span class="stringliteral">&quot;name=\&quot;%s\&quot;\n&quot;</span>, tsv-&gt;<a class="code" href="structtrace__state__variable.html#ac86438487a7fe60738afe3ba2699b09f">name</a>);
<a name="l00558"></a>00558   <span class="keywordflow">else</span>
<a name="l00559"></a>00559     <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (mi-&gt;<a class="code" href="structmi__interp.html#a9789f994da11c82cd9217afb3355c28b">event_channel</a>, <span class="stringliteral">&quot;tsv-deleted\n&quot;</span>);
<a name="l00560"></a>00560 
<a name="l00561"></a>00561   <a class="code" href="ui-file_8c.html#a046f07b5ef1bcc35c28b4be983e39998">gdb_flush</a> (mi-&gt;<a class="code" href="structmi__interp.html#a9789f994da11c82cd9217afb3355c28b">event_channel</a>);
<a name="l00562"></a>00562 }
<a name="l00563"></a>00563 
<a name="l00564"></a>00564 <span class="comment">/* Emit notification on modifying a trace state variable.  */</span>
<a name="l00565"></a>00565 
<a name="l00566"></a>00566 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00567"></a><a class="code" href="mi-interp_8c.html#a0cb3c1556b2017693f0388585e4aabed">00567</a> <a class="code" href="mi-interp_8c.html#a0cb3c1556b2017693f0388585e4aabed">mi_tsv_modified</a> (<span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structtrace__state__variable.html">trace_state_variable</a> *tsv)
<a name="l00568"></a>00568 {
<a name="l00569"></a>00569   <span class="keyword">struct </span><a class="code" href="structmi__interp.html">mi_interp</a> *mi = <a class="code" href="interps_8c.html#a045aa3f9489496bd379f36c7ace015cf">top_level_interpreter_data</a> ();
<a name="l00570"></a>00570   <span class="keyword">struct </span><a class="code" href="structui__out.html">ui_out</a> *mi_uiout = <a class="code" href="interps_8c.html#a8e9dd8dc026ec4b76ae0c0a27a97383d">interp_ui_out</a> (<a class="code" href="interps_8c.html#a55d2f9afbe93d6b241b23fdffb5f17a4">top_level_interpreter</a> ());
<a name="l00571"></a>00571 
<a name="l00572"></a>00572   <a class="code" href="target_8h.html#a7128a26aa3c50e663201b4a6633636fe">target_terminal_ours</a> ();
<a name="l00573"></a>00573 
<a name="l00574"></a>00574   <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (mi-&gt;<a class="code" href="structmi__interp.html#a9789f994da11c82cd9217afb3355c28b">event_channel</a>,
<a name="l00575"></a>00575                       <span class="stringliteral">&quot;tsv-modified&quot;</span>);
<a name="l00576"></a>00576 
<a name="l00577"></a>00577   <a class="code" href="ui-out_8c.html#a6ed7ee65c5533a37f6af18d8a689cd38">ui_out_redirect</a> (mi_uiout, mi-&gt;<a class="code" href="structmi__interp.html#a9789f994da11c82cd9217afb3355c28b">event_channel</a>);
<a name="l00578"></a>00578 
<a name="l00579"></a>00579   <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a> (mi_uiout, <span class="stringliteral">&quot;name&quot;</span>, tsv-&gt;<a class="code" href="structtrace__state__variable.html#ac86438487a7fe60738afe3ba2699b09f">name</a>);
<a name="l00580"></a>00580   <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a> (mi_uiout, <span class="stringliteral">&quot;initial&quot;</span>,
<a name="l00581"></a>00581                        <a class="code" href="utils_8c.html#a707b1023c85049b17b9d1ca01c58768a">plongest</a> (tsv-&gt;<a class="code" href="structtrace__state__variable.html#aa0332c05c03fbfd925ec6b83c7ec21de">initial_value</a>));
<a name="l00582"></a>00582   <span class="keywordflow">if</span> (tsv-&gt;<a class="code" href="structtrace__state__variable.html#a477de2307634454e6eba5730e76f71ce">value_known</a>)
<a name="l00583"></a>00583     <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a> (mi_uiout, <span class="stringliteral">&quot;current&quot;</span>, <a class="code" href="utils_8c.html#a707b1023c85049b17b9d1ca01c58768a">plongest</a> (tsv-&gt;<a class="code" href="structtrace__state__variable.html#af724d35de7189b31747e0e39d51e3719">value</a>));
<a name="l00584"></a>00584 
<a name="l00585"></a>00585   <a class="code" href="ui-out_8c.html#a6ed7ee65c5533a37f6af18d8a689cd38">ui_out_redirect</a> (mi_uiout, NULL);
<a name="l00586"></a>00586 
<a name="l00587"></a>00587   <a class="code" href="ui-file_8c.html#a046f07b5ef1bcc35c28b4be983e39998">gdb_flush</a> (mi-&gt;<a class="code" href="structmi__interp.html#a9789f994da11c82cd9217afb3355c28b">event_channel</a>);
<a name="l00588"></a>00588 }
<a name="l00589"></a>00589 
<a name="l00590"></a>00590 <span class="comment">/* Emit notification about a created breakpoint.  */</span>
<a name="l00591"></a>00591 
<a name="l00592"></a>00592 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00593"></a><a class="code" href="mi-interp_8c.html#ac0eb3ee0ed40175e882630f671298dba">00593</a> <a class="code" href="mi-interp_8c.html#ac0eb3ee0ed40175e882630f671298dba">mi_breakpoint_created</a> (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b)
<a name="l00594"></a>00594 {
<a name="l00595"></a>00595   <span class="keyword">struct </span><a class="code" href="structmi__interp.html">mi_interp</a> *mi = <a class="code" href="interps_8c.html#a045aa3f9489496bd379f36c7ace015cf">top_level_interpreter_data</a> ();
<a name="l00596"></a>00596   <span class="keyword">struct </span><a class="code" href="structui__out.html">ui_out</a> *mi_uiout = <a class="code" href="interps_8c.html#a8e9dd8dc026ec4b76ae0c0a27a97383d">interp_ui_out</a> (<a class="code" href="interps_8c.html#a55d2f9afbe93d6b241b23fdffb5f17a4">top_level_interpreter</a> ());
<a name="l00597"></a>00597   <span class="keyword">volatile</span> <span class="keyword">struct </span><a class="code" href="structgdb__exception.html">gdb_exception</a> e;
<a name="l00598"></a>00598 
<a name="l00599"></a>00599   <span class="keywordflow">if</span> (mi_suppress_notification.<a class="code" href="structmi__suppress__notification.html#a18c1ea76cc13d815c8f58d660da640ea">breakpoint</a>)
<a name="l00600"></a>00600     <span class="keywordflow">return</span>;
<a name="l00601"></a>00601 
<a name="l00602"></a>00602   <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a> &lt;= 0)
<a name="l00603"></a>00603     <span class="keywordflow">return</span>;
<a name="l00604"></a>00604 
<a name="l00605"></a>00605   <a class="code" href="target_8h.html#a7128a26aa3c50e663201b4a6633636fe">target_terminal_ours</a> ();
<a name="l00606"></a>00606   <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (mi-&gt;<a class="code" href="structmi__interp.html#a9789f994da11c82cd9217afb3355c28b">event_channel</a>,
<a name="l00607"></a>00607                       <span class="stringliteral">&quot;breakpoint-created&quot;</span>);
<a name="l00608"></a>00608   <span class="comment">/* We want the output from gdb_breakpoint_query to go to</span>
<a name="l00609"></a>00609 <span class="comment">     mi-&gt;event_channel.  One approach would be to just call</span>
<a name="l00610"></a>00610 <span class="comment">     gdb_breakpoint_query, and then use mi_out_put to send the current</span>
<a name="l00611"></a>00611 <span class="comment">     content of mi_outout into mi-&gt;event_channel.  However, that will</span>
<a name="l00612"></a>00612 <span class="comment">     break if anything is output to mi_uiout prior to calling the</span>
<a name="l00613"></a>00613 <span class="comment">     breakpoint_created notifications.  So, we use</span>
<a name="l00614"></a>00614 <span class="comment">     ui_out_redirect.  */</span>
<a name="l00615"></a>00615   <a class="code" href="ui-out_8c.html#a6ed7ee65c5533a37f6af18d8a689cd38">ui_out_redirect</a> (mi_uiout, mi-&gt;<a class="code" href="structmi__interp.html#a9789f994da11c82cd9217afb3355c28b">event_channel</a>);
<a name="l00616"></a>00616   <a class="code" href="exceptions_8h.html#aef4514ee39b9305fddee27f49c7c34eb">TRY_CATCH</a> (e, <a class="code" href="exceptions_8h.html#abfa3a3b99557b11f5766baf69465fdf6a44de51845416ac49ab08438792b908f0">RETURN_MASK_ERROR</a>)
<a name="l00617"></a>00617     <a class="code" href="breakpoint_8c.html#a52477bff2f2ecd8774a3e1000ef4ac6b">gdb_breakpoint_query</a> (mi_uiout, b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>, NULL);
<a name="l00618"></a>00618   <a class="code" href="ui-out_8c.html#a6ed7ee65c5533a37f6af18d8a689cd38">ui_out_redirect</a> (mi_uiout, NULL);
<a name="l00619"></a>00619 
<a name="l00620"></a>00620   <a class="code" href="ui-file_8c.html#a046f07b5ef1bcc35c28b4be983e39998">gdb_flush</a> (mi-&gt;<a class="code" href="structmi__interp.html#a9789f994da11c82cd9217afb3355c28b">event_channel</a>);
<a name="l00621"></a>00621 }
<a name="l00622"></a>00622 
<a name="l00623"></a>00623 <span class="comment">/* Emit notification about deleted breakpoint.  */</span>
<a name="l00624"></a>00624 
<a name="l00625"></a>00625 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00626"></a><a class="code" href="mi-interp_8c.html#a8f87e4d98246d822fcf8aabeec14e4be">00626</a> <a class="code" href="mi-interp_8c.html#a8f87e4d98246d822fcf8aabeec14e4be">mi_breakpoint_deleted</a> (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b)
<a name="l00627"></a>00627 {
<a name="l00628"></a>00628   <span class="keyword">struct </span><a class="code" href="structmi__interp.html">mi_interp</a> *mi = <a class="code" href="interps_8c.html#a045aa3f9489496bd379f36c7ace015cf">top_level_interpreter_data</a> ();
<a name="l00629"></a>00629 
<a name="l00630"></a>00630   <span class="keywordflow">if</span> (mi_suppress_notification.<a class="code" href="structmi__suppress__notification.html#a18c1ea76cc13d815c8f58d660da640ea">breakpoint</a>)
<a name="l00631"></a>00631     <span class="keywordflow">return</span>;
<a name="l00632"></a>00632 
<a name="l00633"></a>00633   <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a> &lt;= 0)
<a name="l00634"></a>00634     <span class="keywordflow">return</span>;
<a name="l00635"></a>00635 
<a name="l00636"></a>00636   <a class="code" href="target_8h.html#a7128a26aa3c50e663201b4a6633636fe">target_terminal_ours</a> ();
<a name="l00637"></a>00637 
<a name="l00638"></a>00638   <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (mi-&gt;<a class="code" href="structmi__interp.html#a9789f994da11c82cd9217afb3355c28b">event_channel</a>, <span class="stringliteral">&quot;breakpoint-deleted,id=\&quot;%d\&quot;&quot;</span>,
<a name="l00639"></a>00639                       b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>);
<a name="l00640"></a>00640 
<a name="l00641"></a>00641   <a class="code" href="ui-file_8c.html#a046f07b5ef1bcc35c28b4be983e39998">gdb_flush</a> (mi-&gt;<a class="code" href="structmi__interp.html#a9789f994da11c82cd9217afb3355c28b">event_channel</a>);
<a name="l00642"></a>00642 }
<a name="l00643"></a>00643 
<a name="l00644"></a>00644 <span class="comment">/* Emit notification about modified breakpoint.  */</span>
<a name="l00645"></a>00645 
<a name="l00646"></a>00646 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00647"></a><a class="code" href="mi-interp_8c.html#a1ff485ae1e437ac61ca08f90126be231">00647</a> <a class="code" href="mi-interp_8c.html#a1ff485ae1e437ac61ca08f90126be231">mi_breakpoint_modified</a> (<span class="keyword">struct</span> <a class="code" href="structbreakpoint.html">breakpoint</a> *b)
<a name="l00648"></a>00648 {
<a name="l00649"></a>00649   <span class="keyword">struct </span><a class="code" href="structmi__interp.html">mi_interp</a> *mi = <a class="code" href="interps_8c.html#a045aa3f9489496bd379f36c7ace015cf">top_level_interpreter_data</a> ();
<a name="l00650"></a>00650   <span class="keyword">struct </span><a class="code" href="structui__out.html">ui_out</a> *mi_uiout = <a class="code" href="interps_8c.html#a8e9dd8dc026ec4b76ae0c0a27a97383d">interp_ui_out</a> (<a class="code" href="interps_8c.html#a55d2f9afbe93d6b241b23fdffb5f17a4">top_level_interpreter</a> ());
<a name="l00651"></a>00651   <span class="keyword">volatile</span> <span class="keyword">struct </span><a class="code" href="structgdb__exception.html">gdb_exception</a> e;
<a name="l00652"></a>00652 
<a name="l00653"></a>00653   <span class="keywordflow">if</span> (mi_suppress_notification.<a class="code" href="structmi__suppress__notification.html#a18c1ea76cc13d815c8f58d660da640ea">breakpoint</a>)
<a name="l00654"></a>00654     <span class="keywordflow">return</span>;
<a name="l00655"></a>00655 
<a name="l00656"></a>00656   <span class="keywordflow">if</span> (b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a> &lt;= 0)
<a name="l00657"></a>00657     <span class="keywordflow">return</span>;
<a name="l00658"></a>00658 
<a name="l00659"></a>00659   <a class="code" href="target_8h.html#a7128a26aa3c50e663201b4a6633636fe">target_terminal_ours</a> ();
<a name="l00660"></a>00660   <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (mi-&gt;<a class="code" href="structmi__interp.html#a9789f994da11c82cd9217afb3355c28b">event_channel</a>,
<a name="l00661"></a>00661                       <span class="stringliteral">&quot;breakpoint-modified&quot;</span>);
<a name="l00662"></a>00662   <span class="comment">/* We want the output from gdb_breakpoint_query to go to</span>
<a name="l00663"></a>00663 <span class="comment">     mi-&gt;event_channel.  One approach would be to just call</span>
<a name="l00664"></a>00664 <span class="comment">     gdb_breakpoint_query, and then use mi_out_put to send the current</span>
<a name="l00665"></a>00665 <span class="comment">     content of mi_outout into mi-&gt;event_channel.  However, that will</span>
<a name="l00666"></a>00666 <span class="comment">     break if anything is output to mi_uiout prior to calling the</span>
<a name="l00667"></a>00667 <span class="comment">     breakpoint_created notifications.  So, we use</span>
<a name="l00668"></a>00668 <span class="comment">     ui_out_redirect.  */</span>
<a name="l00669"></a>00669   <a class="code" href="ui-out_8c.html#a6ed7ee65c5533a37f6af18d8a689cd38">ui_out_redirect</a> (mi_uiout, mi-&gt;<a class="code" href="structmi__interp.html#a9789f994da11c82cd9217afb3355c28b">event_channel</a>);
<a name="l00670"></a>00670   <a class="code" href="exceptions_8h.html#aef4514ee39b9305fddee27f49c7c34eb">TRY_CATCH</a> (e, <a class="code" href="exceptions_8h.html#abfa3a3b99557b11f5766baf69465fdf6a44de51845416ac49ab08438792b908f0">RETURN_MASK_ERROR</a>)
<a name="l00671"></a>00671     <a class="code" href="breakpoint_8c.html#a52477bff2f2ecd8774a3e1000ef4ac6b">gdb_breakpoint_query</a> (mi_uiout, b-&gt;<a class="code" href="structbreakpoint.html#aa46a2ab4a5f2ae1e42412c412997871b">number</a>, NULL);
<a name="l00672"></a>00672   <a class="code" href="ui-out_8c.html#a6ed7ee65c5533a37f6af18d8a689cd38">ui_out_redirect</a> (mi_uiout, NULL);
<a name="l00673"></a>00673 
<a name="l00674"></a>00674   <a class="code" href="ui-file_8c.html#a046f07b5ef1bcc35c28b4be983e39998">gdb_flush</a> (mi-&gt;<a class="code" href="structmi__interp.html#a9789f994da11c82cd9217afb3355c28b">event_channel</a>);
<a name="l00675"></a>00675 }
<a name="l00676"></a>00676 
<a name="l00677"></a>00677 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l00678"></a><a class="code" href="mi-interp_8c.html#ab87c6d60c607d60f90fbc0331992dc8e">00678</a> <a class="code" href="mi-interp_8c.html#ab87c6d60c607d60f90fbc0331992dc8e">mi_output_running_pid</a> (<span class="keyword">struct</span> <a class="code" href="structthread__info.html">thread_info</a> *info, <span class="keywordtype">void</span> *arg)
<a name="l00679"></a>00679 {
<a name="l00680"></a>00680   <a class="code" href="structptid.html">ptid_t</a> *<a class="code" href="structptid.html">ptid</a> = arg;
<a name="l00681"></a>00681 
<a name="l00682"></a>00682   <span class="keywordflow">if</span> (<a class="code" href="ptid_8c.html#a264ba40fc2a0cf3d4fb24a55fe32aede">ptid_get_pid</a> (*ptid) == <a class="code" href="ptid_8c.html#a264ba40fc2a0cf3d4fb24a55fe32aede">ptid_get_pid</a> (info-&gt;<a class="code" href="structthread__info.html#a533aa3979b60affd446e9fbff93fdd2c">ptid</a>))
<a name="l00683"></a>00683     <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (<a class="code" href="mi-cmds_8h.html#a291315c01d39483f0026b8a849b70fba">raw_stdout</a>,
<a name="l00684"></a>00684                         <span class="stringliteral">&quot;*running,thread-id=\&quot;%d\&quot;\n&quot;</span>,
<a name="l00685"></a>00685                         info-&gt;<a class="code" href="structthread__info.html#a64accc7e3d39da1d926c23877f9f9d0d">num</a>);
<a name="l00686"></a>00686 
<a name="l00687"></a>00687   <span class="keywordflow">return</span> 0;
<a name="l00688"></a>00688 }
<a name="l00689"></a>00689 
<a name="l00690"></a>00690 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l00691"></a><a class="code" href="mi-interp_8c.html#a88575214f7db39db4e62f553b9b50ecf">00691</a> <a class="code" href="mi-interp_8c.html#a88575214f7db39db4e62f553b9b50ecf">mi_inferior_count</a> (<span class="keyword">struct</span> <a class="code" href="structinferior.html">inferior</a> *<a class="code" href="structinf.html">inf</a>, <span class="keywordtype">void</span> *arg)
<a name="l00692"></a>00692 {
<a name="l00693"></a>00693   <span class="keywordflow">if</span> (inf-&gt;<a class="code" href="structinferior.html#a1be87f581dbb6c893dbe1f2ff701636a">pid</a> != 0)
<a name="l00694"></a>00694     {
<a name="l00695"></a>00695       <span class="keywordtype">int</span> *count_p = arg;
<a name="l00696"></a>00696       (*count_p)++;
<a name="l00697"></a>00697     }
<a name="l00698"></a>00698 
<a name="l00699"></a>00699   <span class="keywordflow">return</span> 0;
<a name="l00700"></a>00700 }
<a name="l00701"></a>00701 
<a name="l00702"></a>00702 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00703"></a><a class="code" href="mi-interp_8c.html#a19d360e6f63bb8ea0c513ac95f9f0dd4">00703</a> <a class="code" href="mi-interp_8c.html#a19d360e6f63bb8ea0c513ac95f9f0dd4">mi_on_resume</a> (<a class="code" href="structptid.html">ptid_t</a> <a class="code" href="structptid.html">ptid</a>)
<a name="l00704"></a>00704 {
<a name="l00705"></a>00705   <span class="keyword">struct </span><a class="code" href="structthread__info.html">thread_info</a> *tp = NULL;
<a name="l00706"></a>00706 
<a name="l00707"></a>00707   <span class="keywordflow">if</span> (<a class="code" href="ptid_8c.html#a0df58c8db2620a2cec647934b4f77266">ptid_equal</a> (ptid, <a class="code" href="ptid_8c.html#ae865e32ccc6c9636dcec8ff779f99514">minus_one_ptid</a>) || <a class="code" href="ptid_8c.html#af8d85698e4f3f571b2a3909bac3df4fd">ptid_is_pid</a> (ptid))
<a name="l00708"></a>00708     tp = <a class="code" href="gdbthread_8h.html#a668af1dd99cac24599dc0f3ef6458924">inferior_thread</a> ();
<a name="l00709"></a>00709   <span class="keywordflow">else</span>
<a name="l00710"></a>00710     tp = <a class="code" href="gdbthread_8h.html#ac9a7f4c3c173f717f0da44f83745384c">find_thread_ptid</a> (ptid);
<a name="l00711"></a>00711 
<a name="l00712"></a>00712   <span class="comment">/* Suppress output while calling an inferior function.  */</span>
<a name="l00713"></a>00713   <span class="keywordflow">if</span> (tp-&gt;<a class="code" href="structthread__info.html#a223c3ebf1726773195c6e75c247ddd3c">control</a>.<a class="code" href="structthread__control__state.html#a340358c8f365b4f792bbfc16059a4e0a">in_infcall</a>)
<a name="l00714"></a>00714     <span class="keywordflow">return</span>;
<a name="l00715"></a>00715 
<a name="l00716"></a>00716   <span class="comment">/* To cater for older frontends, emit ^running, but do it only once</span>
<a name="l00717"></a>00717 <span class="comment">     per each command.  We do it here, since at this point we know</span>
<a name="l00718"></a>00718 <span class="comment">     that the target was successfully resumed, and in non-async mode,</span>
<a name="l00719"></a>00719 <span class="comment">     we won&#39;t return back to MI interpreter code until the target</span>
<a name="l00720"></a>00720 <span class="comment">     is done running, so delaying the output of &quot;^running&quot; until then</span>
<a name="l00721"></a>00721 <span class="comment">     will make it impossible for frontend to know what&#39;s going on.</span>
<a name="l00722"></a>00722 <span class="comment"></span>
<a name="l00723"></a>00723 <span class="comment">     In future (MI3), we&#39;ll be outputting &quot;^done&quot; here.  */</span>
<a name="l00724"></a>00724   <span class="keywordflow">if</span> (!<a class="code" href="mi-main_8c.html#a974a29ac0dd1dbabd96ff5f85e378419">running_result_record_printed</a> &amp;&amp; <a class="code" href="mi-main_8c.html#a987c1fbb7cbe6c0bf8abd268085acb0a">mi_proceeded</a>)
<a name="l00725"></a>00725     {
<a name="l00726"></a>00726       <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (<a class="code" href="mi-cmds_8h.html#a291315c01d39483f0026b8a849b70fba">raw_stdout</a>, <span class="stringliteral">&quot;%s^running\n&quot;</span>,
<a name="l00727"></a>00727                           <a class="code" href="mi-main_8c.html#a4f31fe20e2b760c8d54d42910947ef2d">current_token</a> ? <a class="code" href="mi-main_8c.html#a4f31fe20e2b760c8d54d42910947ef2d">current_token</a> : <span class="stringliteral">&quot;&quot;</span>);
<a name="l00728"></a>00728     }
<a name="l00729"></a>00729 
<a name="l00730"></a>00730   <span class="keywordflow">if</span> (<a class="code" href="ptid_8c.html#a264ba40fc2a0cf3d4fb24a55fe32aede">ptid_get_pid</a> (ptid) == -1)
<a name="l00731"></a>00731     <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (<a class="code" href="mi-cmds_8h.html#a291315c01d39483f0026b8a849b70fba">raw_stdout</a>, <span class="stringliteral">&quot;*running,thread-id=\&quot;all\&quot;\n&quot;</span>);
<a name="l00732"></a>00732   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="ptid_8c.html#af8d85698e4f3f571b2a3909bac3df4fd">ptid_is_pid</a> (ptid))
<a name="l00733"></a>00733     {
<a name="l00734"></a>00734       <span class="keywordtype">int</span> count = 0;
<a name="l00735"></a>00735 
<a name="l00736"></a>00736       <span class="comment">/* Backwards compatibility.  If there&#39;s only one inferior,</span>
<a name="l00737"></a>00737 <span class="comment">         output &quot;all&quot;, otherwise, output each resumed thread</span>
<a name="l00738"></a>00738 <span class="comment">         individually.  */</span>
<a name="l00739"></a>00739       <a class="code" href="inferior_8c.html#afcb3f43a2669a8ad733c575dc07d3a80">iterate_over_inferiors</a> (<a class="code" href="mi-interp_8c.html#a88575214f7db39db4e62f553b9b50ecf">mi_inferior_count</a>, &amp;count);
<a name="l00740"></a>00740 
<a name="l00741"></a>00741       <span class="keywordflow">if</span> (count == 1)
<a name="l00742"></a>00742         <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (<a class="code" href="mi-cmds_8h.html#a291315c01d39483f0026b8a849b70fba">raw_stdout</a>, <span class="stringliteral">&quot;*running,thread-id=\&quot;all\&quot;\n&quot;</span>);
<a name="l00743"></a>00743       <span class="keywordflow">else</span>
<a name="l00744"></a>00744         <a class="code" href="gdbthread_8h.html#a5dc20fee3cc8a79f615f2f5d695ae1bc">iterate_over_threads</a> (<a class="code" href="mi-interp_8c.html#ab87c6d60c607d60f90fbc0331992dc8e">mi_output_running_pid</a>, &amp;ptid);
<a name="l00745"></a>00745     }
<a name="l00746"></a>00746   <span class="keywordflow">else</span>
<a name="l00747"></a>00747     {
<a name="l00748"></a>00748       <span class="keyword">struct </span><a class="code" href="structthread__info.html">thread_info</a> *ti = <a class="code" href="gdbthread_8h.html#ac9a7f4c3c173f717f0da44f83745384c">find_thread_ptid</a> (ptid);
<a name="l00749"></a>00749 
<a name="l00750"></a>00750       <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (ti);
<a name="l00751"></a>00751       <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (<a class="code" href="mi-cmds_8h.html#a291315c01d39483f0026b8a849b70fba">raw_stdout</a>, <span class="stringliteral">&quot;*running,thread-id=\&quot;%d\&quot;\n&quot;</span>, ti-&gt;<a class="code" href="structthread__info.html#a64accc7e3d39da1d926c23877f9f9d0d">num</a>);
<a name="l00752"></a>00752     }
<a name="l00753"></a>00753 
<a name="l00754"></a>00754   <span class="keywordflow">if</span> (!<a class="code" href="mi-main_8c.html#a974a29ac0dd1dbabd96ff5f85e378419">running_result_record_printed</a> &amp;&amp; <a class="code" href="mi-main_8c.html#a987c1fbb7cbe6c0bf8abd268085acb0a">mi_proceeded</a>)
<a name="l00755"></a>00755     {
<a name="l00756"></a>00756       <a class="code" href="mi-main_8c.html#a974a29ac0dd1dbabd96ff5f85e378419">running_result_record_printed</a> = 1;
<a name="l00757"></a>00757       <span class="comment">/* This is what gdb used to do historically -- printing prompt even if</span>
<a name="l00758"></a>00758 <span class="comment">         it cannot actually accept any input.  This will be surely removed</span>
<a name="l00759"></a>00759 <span class="comment">         for MI3, and may be removed even earler.  */</span>
<a name="l00760"></a>00760       <span class="comment">/* FIXME: review the use of target_is_async_p here -- is that</span>
<a name="l00761"></a>00761 <span class="comment">         what we want? */</span>
<a name="l00762"></a>00762       <span class="keywordflow">if</span> (!<a class="code" href="target_8h.html#a9024f679a83bd653c5b0183e2d1177e9">target_is_async_p</a> ())
<a name="l00763"></a>00763         <a class="code" href="ui-file_8c.html#aae3b905f888b1dcdce586f77b9554153">fputs_unfiltered</a> (<span class="stringliteral">&quot;(gdb) \n&quot;</span>, <a class="code" href="mi-cmds_8h.html#a291315c01d39483f0026b8a849b70fba">raw_stdout</a>);
<a name="l00764"></a>00764     }
<a name="l00765"></a>00765   <a class="code" href="ui-file_8c.html#a046f07b5ef1bcc35c28b4be983e39998">gdb_flush</a> (<a class="code" href="mi-cmds_8h.html#a291315c01d39483f0026b8a849b70fba">raw_stdout</a>);
<a name="l00766"></a>00766 }
<a name="l00767"></a>00767 
<a name="l00768"></a>00768 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00769"></a><a class="code" href="mi-interp_8c.html#afd11eba703051775f32ef475a83e258d">00769</a> <a class="code" href="mi-interp_8c.html#afd11eba703051775f32ef475a83e258d">mi_solib_loaded</a> (<span class="keyword">struct</span> <a class="code" href="structso__list.html">so_list</a> *solib)
<a name="l00770"></a>00770 {
<a name="l00771"></a>00771   <span class="keyword">struct </span><a class="code" href="structmi__interp.html">mi_interp</a> *mi = <a class="code" href="interps_8c.html#a045aa3f9489496bd379f36c7ace015cf">top_level_interpreter_data</a> ();
<a name="l00772"></a>00772 
<a name="l00773"></a>00773   <a class="code" href="target_8h.html#a7128a26aa3c50e663201b4a6633636fe">target_terminal_ours</a> ();
<a name="l00774"></a>00774   <span class="keywordflow">if</span> (<a class="code" href="gdbarch_8c.html#aaff2dacd8f41f769c351f2f3ca0620ca">gdbarch_has_global_solist</a> (<a class="code" href="gdbarch_8c.html#ad648a33f69abe34e9679744a0c5a0580">target_gdbarch</a> ()))
<a name="l00775"></a>00775     <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (mi-&gt;<a class="code" href="structmi__interp.html#a9789f994da11c82cd9217afb3355c28b">event_channel</a>,
<a name="l00776"></a>00776                         <span class="stringliteral">&quot;library-loaded,id=\&quot;%s\&quot;,target-name=\&quot;%s\&quot;,&quot;</span>
<a name="l00777"></a>00777                         <span class="stringliteral">&quot;host-name=\&quot;%s\&quot;,symbols-loaded=\&quot;%d\&quot;&quot;</span>,
<a name="l00778"></a>00778                         solib-&gt;<a class="code" href="structso__list.html#acaf1629339fc6d9e734dcc6b9ce02bbf">so_original_name</a>, solib-&gt;<a class="code" href="structso__list.html#acaf1629339fc6d9e734dcc6b9ce02bbf">so_original_name</a>,
<a name="l00779"></a>00779                         solib-&gt;<a class="code" href="structso__list.html#a140beac8c60259f8debd88cd693b8fb4">so_name</a>, solib-&gt;<a class="code" href="structso__list.html#ae46552b89ed2c4c286e9e15717a93537">symbols_loaded</a>);
<a name="l00780"></a>00780   <span class="keywordflow">else</span>
<a name="l00781"></a>00781     <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (mi-&gt;<a class="code" href="structmi__interp.html#a9789f994da11c82cd9217afb3355c28b">event_channel</a>,
<a name="l00782"></a>00782                         <span class="stringliteral">&quot;library-loaded,id=\&quot;%s\&quot;,target-name=\&quot;%s\&quot;,&quot;</span>
<a name="l00783"></a>00783                         <span class="stringliteral">&quot;host-name=\&quot;%s\&quot;,symbols-loaded=\&quot;%d\&quot;,&quot;</span>
<a name="l00784"></a>00784                         <span class="stringliteral">&quot;thread-group=\&quot;i%d\&quot;&quot;</span>,
<a name="l00785"></a>00785                         solib-&gt;<a class="code" href="structso__list.html#acaf1629339fc6d9e734dcc6b9ce02bbf">so_original_name</a>, solib-&gt;<a class="code" href="structso__list.html#acaf1629339fc6d9e734dcc6b9ce02bbf">so_original_name</a>,
<a name="l00786"></a>00786                         solib-&gt;<a class="code" href="structso__list.html#a140beac8c60259f8debd88cd693b8fb4">so_name</a>, solib-&gt;<a class="code" href="structso__list.html#ae46552b89ed2c4c286e9e15717a93537">symbols_loaded</a>,
<a name="l00787"></a>00787                         <a class="code" href="inferior_8c.html#a9e592c83e7c0c1f89f1a4a392bd1a277">current_inferior</a> ()-&gt;num);
<a name="l00788"></a>00788 
<a name="l00789"></a>00789   <a class="code" href="ui-file_8c.html#a046f07b5ef1bcc35c28b4be983e39998">gdb_flush</a> (mi-&gt;<a class="code" href="structmi__interp.html#a9789f994da11c82cd9217afb3355c28b">event_channel</a>);
<a name="l00790"></a>00790 }
<a name="l00791"></a>00791 
<a name="l00792"></a>00792 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00793"></a><a class="code" href="mi-interp_8c.html#ac8699802c2dbab6b40d1d7d5fd1e3291">00793</a> <a class="code" href="mi-interp_8c.html#ac8699802c2dbab6b40d1d7d5fd1e3291">mi_solib_unloaded</a> (<span class="keyword">struct</span> <a class="code" href="structso__list.html">so_list</a> *solib)
<a name="l00794"></a>00794 {
<a name="l00795"></a>00795   <span class="keyword">struct </span><a class="code" href="structmi__interp.html">mi_interp</a> *mi = <a class="code" href="interps_8c.html#a045aa3f9489496bd379f36c7ace015cf">top_level_interpreter_data</a> ();
<a name="l00796"></a>00796 
<a name="l00797"></a>00797   <a class="code" href="target_8h.html#a7128a26aa3c50e663201b4a6633636fe">target_terminal_ours</a> ();
<a name="l00798"></a>00798   <span class="keywordflow">if</span> (<a class="code" href="gdbarch_8c.html#aaff2dacd8f41f769c351f2f3ca0620ca">gdbarch_has_global_solist</a> (<a class="code" href="gdbarch_8c.html#ad648a33f69abe34e9679744a0c5a0580">target_gdbarch</a> ()))
<a name="l00799"></a>00799     <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (mi-&gt;<a class="code" href="structmi__interp.html#a9789f994da11c82cd9217afb3355c28b">event_channel</a>,
<a name="l00800"></a>00800                         <span class="stringliteral">&quot;library-unloaded,id=\&quot;%s\&quot;,target-name=\&quot;%s\&quot;,&quot;</span>
<a name="l00801"></a>00801                         <span class="stringliteral">&quot;host-name=\&quot;%s\&quot;&quot;</span>,
<a name="l00802"></a>00802                         solib-&gt;<a class="code" href="structso__list.html#acaf1629339fc6d9e734dcc6b9ce02bbf">so_original_name</a>, solib-&gt;<a class="code" href="structso__list.html#acaf1629339fc6d9e734dcc6b9ce02bbf">so_original_name</a>,
<a name="l00803"></a>00803                         solib-&gt;<a class="code" href="structso__list.html#a140beac8c60259f8debd88cd693b8fb4">so_name</a>);
<a name="l00804"></a>00804   <span class="keywordflow">else</span>
<a name="l00805"></a>00805     <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (mi-&gt;<a class="code" href="structmi__interp.html#a9789f994da11c82cd9217afb3355c28b">event_channel</a>,
<a name="l00806"></a>00806                         <span class="stringliteral">&quot;library-unloaded,id=\&quot;%s\&quot;,target-name=\&quot;%s\&quot;,&quot;</span>
<a name="l00807"></a>00807                         <span class="stringliteral">&quot;host-name=\&quot;%s\&quot;,thread-group=\&quot;i%d\&quot;&quot;</span>,
<a name="l00808"></a>00808                         solib-&gt;<a class="code" href="structso__list.html#acaf1629339fc6d9e734dcc6b9ce02bbf">so_original_name</a>, solib-&gt;<a class="code" href="structso__list.html#acaf1629339fc6d9e734dcc6b9ce02bbf">so_original_name</a>,
<a name="l00809"></a>00809                         solib-&gt;<a class="code" href="structso__list.html#a140beac8c60259f8debd88cd693b8fb4">so_name</a>, <a class="code" href="inferior_8c.html#a9e592c83e7c0c1f89f1a4a392bd1a277">current_inferior</a> ()-&gt;num);
<a name="l00810"></a>00810 
<a name="l00811"></a>00811   <a class="code" href="ui-file_8c.html#a046f07b5ef1bcc35c28b4be983e39998">gdb_flush</a> (mi-&gt;<a class="code" href="structmi__interp.html#a9789f994da11c82cd9217afb3355c28b">event_channel</a>);
<a name="l00812"></a>00812 }
<a name="l00813"></a>00813 
<a name="l00814"></a>00814 <span class="comment">/* Emit notification about the command parameter change.  */</span>
<a name="l00815"></a>00815 
<a name="l00816"></a>00816 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00817"></a><a class="code" href="mi-interp_8c.html#ab57d87356090364cadf16311bece2241">00817</a> <a class="code" href="mi-interp_8c.html#ab57d87356090364cadf16311bece2241">mi_command_param_changed</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> *param, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structvalue.html">value</a>)
<a name="l00818"></a>00818 {
<a name="l00819"></a>00819   <span class="keyword">struct </span><a class="code" href="structmi__interp.html">mi_interp</a> *mi = <a class="code" href="interps_8c.html#a045aa3f9489496bd379f36c7ace015cf">top_level_interpreter_data</a> ();
<a name="l00820"></a>00820   <span class="keyword">struct </span><a class="code" href="structui__out.html">ui_out</a> *mi_uiout = <a class="code" href="interps_8c.html#a8e9dd8dc026ec4b76ae0c0a27a97383d">interp_ui_out</a> (<a class="code" href="interps_8c.html#a55d2f9afbe93d6b241b23fdffb5f17a4">top_level_interpreter</a> ());
<a name="l00821"></a>00821 
<a name="l00822"></a>00822   <span class="keywordflow">if</span> (mi_suppress_notification.<a class="code" href="structmi__suppress__notification.html#a90582182a820e5c8a2558db33d54982a">cmd_param_changed</a>)
<a name="l00823"></a>00823     <span class="keywordflow">return</span>;
<a name="l00824"></a>00824 
<a name="l00825"></a>00825   <a class="code" href="target_8h.html#a7128a26aa3c50e663201b4a6633636fe">target_terminal_ours</a> ();
<a name="l00826"></a>00826 
<a name="l00827"></a>00827   <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (mi-&gt;<a class="code" href="structmi__interp.html#a9789f994da11c82cd9217afb3355c28b">event_channel</a>,
<a name="l00828"></a>00828                       <span class="stringliteral">&quot;cmd-param-changed&quot;</span>);
<a name="l00829"></a>00829 
<a name="l00830"></a>00830   <a class="code" href="ui-out_8c.html#a6ed7ee65c5533a37f6af18d8a689cd38">ui_out_redirect</a> (mi_uiout, mi-&gt;<a class="code" href="structmi__interp.html#a9789f994da11c82cd9217afb3355c28b">event_channel</a>);
<a name="l00831"></a>00831 
<a name="l00832"></a>00832   <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a> (mi_uiout, <span class="stringliteral">&quot;param&quot;</span>, param);
<a name="l00833"></a>00833   <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a> (mi_uiout, <span class="stringliteral">&quot;value&quot;</span>, value);
<a name="l00834"></a>00834 
<a name="l00835"></a>00835   <a class="code" href="ui-out_8c.html#a6ed7ee65c5533a37f6af18d8a689cd38">ui_out_redirect</a> (mi_uiout, NULL);
<a name="l00836"></a>00836 
<a name="l00837"></a>00837   <a class="code" href="ui-file_8c.html#a046f07b5ef1bcc35c28b4be983e39998">gdb_flush</a> (mi-&gt;<a class="code" href="structmi__interp.html#a9789f994da11c82cd9217afb3355c28b">event_channel</a>);
<a name="l00838"></a>00838 }
<a name="l00839"></a>00839 
<a name="l00840"></a>00840 <span class="comment">/* Emit notification about the target memory change.  */</span>
<a name="l00841"></a>00841 
<a name="l00842"></a>00842 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00843"></a><a class="code" href="mi-interp_8c.html#a40bf8f631e88916076f25725dec16cf8">00843</a> <a class="code" href="mi-interp_8c.html#a40bf8f631e88916076f25725dec16cf8">mi_memory_changed</a> (<span class="keyword">struct</span> <a class="code" href="structinferior.html">inferior</a> *<a class="code" href="structinferior.html">inferior</a>, <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> <a class="code" href="exec_8h.html#ab268c3184bf49615e16de006a296a542">memaddr</a>,
<a name="l00844"></a>00844                    ssize_t <a class="code" href="exec_8h.html#a00f945351279d3c8935f13d2b9f9b808">len</a>, <span class="keyword">const</span> bfd_byte *myaddr)
<a name="l00845"></a>00845 {
<a name="l00846"></a>00846   <span class="keyword">struct </span><a class="code" href="structmi__interp.html">mi_interp</a> *mi = <a class="code" href="interps_8c.html#a045aa3f9489496bd379f36c7ace015cf">top_level_interpreter_data</a> ();
<a name="l00847"></a>00847   <span class="keyword">struct </span><a class="code" href="structui__out.html">ui_out</a> *mi_uiout = <a class="code" href="interps_8c.html#a8e9dd8dc026ec4b76ae0c0a27a97383d">interp_ui_out</a> (<a class="code" href="interps_8c.html#a55d2f9afbe93d6b241b23fdffb5f17a4">top_level_interpreter</a> ());
<a name="l00848"></a>00848   <span class="keyword">struct </span><a class="code" href="structobj__section.html">obj_section</a> *sec;
<a name="l00849"></a>00849 
<a name="l00850"></a>00850   <span class="keywordflow">if</span> (mi_suppress_notification.<a class="code" href="structmi__suppress__notification.html#af8aa08507ed382e10a182d07ce19b9d3">memory</a>)
<a name="l00851"></a>00851     <span class="keywordflow">return</span>;
<a name="l00852"></a>00852 
<a name="l00853"></a>00853   <a class="code" href="target_8h.html#a7128a26aa3c50e663201b4a6633636fe">target_terminal_ours</a> ();
<a name="l00854"></a>00854 
<a name="l00855"></a>00855   <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (mi-&gt;<a class="code" href="structmi__interp.html#a9789f994da11c82cd9217afb3355c28b">event_channel</a>,
<a name="l00856"></a>00856                       <span class="stringliteral">&quot;memory-changed&quot;</span>);
<a name="l00857"></a>00857 
<a name="l00858"></a>00858   <a class="code" href="ui-out_8c.html#a6ed7ee65c5533a37f6af18d8a689cd38">ui_out_redirect</a> (mi_uiout, mi-&gt;<a class="code" href="structmi__interp.html#a9789f994da11c82cd9217afb3355c28b">event_channel</a>);
<a name="l00859"></a>00859 
<a name="l00860"></a>00860   <a class="code" href="ui-out_8c.html#ac29596ba86f387928e0d3e6b7385f998">ui_out_field_fmt</a> (mi_uiout, <span class="stringliteral">&quot;thread-group&quot;</span>, <span class="stringliteral">&quot;i%d&quot;</span>, inferior-&gt;<a class="code" href="structinferior.html#af9e2350a56bd124ce14020ccc0c93f9e">num</a>);
<a name="l00861"></a>00861   <a class="code" href="ui-out_8c.html#ada85ed653fecf3c2a80027de6f71ef71">ui_out_field_core_addr</a> (mi_uiout, <span class="stringliteral">&quot;addr&quot;</span>, <a class="code" href="gdbarch_8c.html#ad648a33f69abe34e9679744a0c5a0580">target_gdbarch</a> (), memaddr);
<a name="l00862"></a>00862   <a class="code" href="ui-out_8c.html#ac29596ba86f387928e0d3e6b7385f998">ui_out_field_fmt</a> (mi_uiout, <span class="stringliteral">&quot;len&quot;</span>, <span class="stringliteral">&quot;0x%zx&quot;</span>, len);
<a name="l00863"></a>00863 
<a name="l00864"></a>00864   <span class="comment">/* Append &#39;type=code&#39; into notification if MEMADDR falls in the range of</span>
<a name="l00865"></a>00865 <span class="comment">     sections contain code.  */</span>
<a name="l00866"></a>00866   sec = <a class="code" href="objfiles_8c.html#a458f94deb438e6e7908997a9b496674d">find_pc_section</a> (memaddr);
<a name="l00867"></a>00867   <span class="keywordflow">if</span> (sec != NULL &amp;&amp; sec-&gt;<a class="code" href="structobj__section.html#a3dba4273f49b43a5e8c64bd29ac39ef1">objfile</a> != NULL)
<a name="l00868"></a>00868     {
<a name="l00869"></a>00869       flagword <a class="code" href="solib-som_8c.html#a555096840020c318e34b205419e98cca">flags</a> = bfd_get_section_flags (sec-&gt;<a class="code" href="structobj__section.html#a3dba4273f49b43a5e8c64bd29ac39ef1">objfile</a>-&gt;<a class="code" href="structobjfile.html#a0b967b64f365ef71d618700b7308dcde">obfd</a>,
<a name="l00870"></a>00870                                               sec-&gt;<a class="code" href="structobj__section.html#ad233927d4d1037bde66ab9628ae82345">the_bfd_section</a>);
<a name="l00871"></a>00871 
<a name="l00872"></a>00872       <span class="keywordflow">if</span> (flags &amp; SEC_CODE)
<a name="l00873"></a>00873         <a class="code" href="ui-out_8c.html#a58efe771979c53ca23a30573d06dc291">ui_out_field_string</a> (mi_uiout, <span class="stringliteral">&quot;type&quot;</span>, <span class="stringliteral">&quot;code&quot;</span>);
<a name="l00874"></a>00874     }
<a name="l00875"></a>00875 
<a name="l00876"></a>00876   <a class="code" href="ui-out_8c.html#a6ed7ee65c5533a37f6af18d8a689cd38">ui_out_redirect</a> (mi_uiout, NULL);
<a name="l00877"></a>00877 
<a name="l00878"></a>00878   <a class="code" href="ui-file_8c.html#a046f07b5ef1bcc35c28b4be983e39998">gdb_flush</a> (mi-&gt;<a class="code" href="structmi__interp.html#a9789f994da11c82cd9217afb3355c28b">event_channel</a>);
<a name="l00879"></a>00879 }
<a name="l00880"></a>00880 
<a name="l00881"></a>00881 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l00882"></a><a class="code" href="mi-interp_8c.html#a3a17cac5b43a5afad6dff33ceb8b9e9f">00882</a> <a class="code" href="mi-interp_8c.html#a3a17cac5b43a5afad6dff33ceb8b9e9f">report_initial_inferior</a> (<span class="keyword">struct</span> <a class="code" href="structinferior.html">inferior</a> *<a class="code" href="structinf.html">inf</a>, <span class="keywordtype">void</span> *closure)
<a name="l00883"></a>00883 {
<a name="l00884"></a>00884   <span class="comment">/* This function is called from mi_intepreter_init, and since</span>
<a name="l00885"></a>00885 <span class="comment">     mi_inferior_added assumes that inferior is fully initialized</span>
<a name="l00886"></a>00886 <span class="comment">     and top_level_interpreter_data is set, we cannot call</span>
<a name="l00887"></a>00887 <span class="comment">     it here.  */</span>
<a name="l00888"></a>00888   <span class="keyword">struct </span><a class="code" href="structmi__interp.html">mi_interp</a> *mi = closure;
<a name="l00889"></a>00889 
<a name="l00890"></a>00890   <a class="code" href="target_8h.html#a7128a26aa3c50e663201b4a6633636fe">target_terminal_ours</a> ();
<a name="l00891"></a>00891   <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (mi-&gt;<a class="code" href="structmi__interp.html#a9789f994da11c82cd9217afb3355c28b">event_channel</a>,
<a name="l00892"></a>00892                       <span class="stringliteral">&quot;thread-group-added,id=\&quot;i%d\&quot;&quot;</span>,
<a name="l00893"></a>00893                       inf-&gt;<a class="code" href="structinferior.html#af9e2350a56bd124ce14020ccc0c93f9e">num</a>);
<a name="l00894"></a>00894   <a class="code" href="ui-file_8c.html#a046f07b5ef1bcc35c28b4be983e39998">gdb_flush</a> (mi-&gt;<a class="code" href="structmi__interp.html#a9789f994da11c82cd9217afb3355c28b">event_channel</a>);
<a name="l00895"></a>00895   <span class="keywordflow">return</span> 0;
<a name="l00896"></a>00896 }
<a name="l00897"></a>00897 
<a name="l00898"></a>00898 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structui__out.html">ui_out</a> *
<a name="l00899"></a><a class="code" href="mi-interp_8c.html#aa422b691f6f24f08ed560d79e4bf9f3d">00899</a> <a class="code" href="mi-interp_8c.html#aa422b691f6f24f08ed560d79e4bf9f3d">mi_ui_out</a> (<span class="keyword">struct</span> <a class="code" href="structinterp.html">interp</a> *<a class="code" href="structinterp.html">interp</a>)
<a name="l00900"></a>00900 {
<a name="l00901"></a>00901   <span class="keyword">struct </span><a class="code" href="structmi__interp.html">mi_interp</a> *mi = <a class="code" href="interps_8c.html#ae399a584d76db5d5e5219a30740704d7">interp_data</a> (interp);
<a name="l00902"></a>00902 
<a name="l00903"></a>00903   <span class="keywordflow">return</span> mi-&gt;<a class="code" href="structmi__interp.html#a9fe195f78eae236651136aa39441b33d">uiout</a>;
<a name="l00904"></a>00904 }
<a name="l00905"></a>00905 
<a name="l00906"></a>00906 <span class="comment">/* Save the original value of raw_stdout here when logging, so we can</span>
<a name="l00907"></a>00907 <span class="comment">   restore correctly when done.  */</span>
<a name="l00908"></a>00908 
<a name="l00909"></a><a class="code" href="mi-interp_8c.html#ade2dc27238af530ba907c03a1bbc21f6">00909</a> <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structui__file.html">ui_file</a> *<a class="code" href="mi-interp_8c.html#ade2dc27238af530ba907c03a1bbc21f6">saved_raw_stdout</a>;
<a name="l00910"></a>00910 
<a name="l00911"></a>00911 <span class="comment">/* Do MI-specific logging actions; save raw_stdout, and change all</span>
<a name="l00912"></a>00912 <span class="comment">   the consoles to use the supplied ui-file(s).  */</span>
<a name="l00913"></a>00913 
<a name="l00914"></a>00914 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l00915"></a><a class="code" href="mi-interp_8c.html#ad98066e43f05da1ba11313f48e477453">00915</a> <a class="code" href="mi-interp_8c.html#ad98066e43f05da1ba11313f48e477453">mi_set_logging</a> (<span class="keyword">struct</span> <a class="code" href="structinterp.html">interp</a> *<a class="code" href="structinterp.html">interp</a>, <span class="keywordtype">int</span> start_log,
<a name="l00916"></a>00916                 <span class="keyword">struct</span> <a class="code" href="structui__file.html">ui_file</a> *out, <span class="keyword">struct</span> <a class="code" href="structui__file.html">ui_file</a> *logfile)
<a name="l00917"></a>00917 {
<a name="l00918"></a>00918   <span class="keyword">struct </span><a class="code" href="structmi__interp.html">mi_interp</a> *mi = <a class="code" href="interps_8c.html#ae399a584d76db5d5e5219a30740704d7">interp_data</a> (interp);
<a name="l00919"></a>00919 
<a name="l00920"></a>00920   <span class="keywordflow">if</span> (!mi)
<a name="l00921"></a>00921     <span class="keywordflow">return</span> 0;
<a name="l00922"></a>00922 
<a name="l00923"></a>00923   <span class="keywordflow">if</span> (start_log)
<a name="l00924"></a>00924     {
<a name="l00925"></a>00925       <span class="comment">/* The tee created already is based on gdb_stdout, which for MI</span>
<a name="l00926"></a>00926 <span class="comment">         is a console and so we end up in an infinite loop of console</span>
<a name="l00927"></a>00927 <span class="comment">         writing to ui_file writing to console etc.  So discard the</span>
<a name="l00928"></a>00928 <span class="comment">         existing tee (it hasn&#39;t been used yet, and MI won&#39;t ever use</span>
<a name="l00929"></a>00929 <span class="comment">         it), and create one based on raw_stdout instead.  */</span>
<a name="l00930"></a>00930       <span class="keywordflow">if</span> (logfile)
<a name="l00931"></a>00931         {
<a name="l00932"></a>00932           <a class="code" href="ui-file_8c.html#a17fda20af14c0187cbda770d4eb2777b">ui_file_delete</a> (out);
<a name="l00933"></a>00933           out = <a class="code" href="ui-file_8c.html#a0adfb4bb63269b08badf1bf843c0ac74">tee_file_new</a> (<a class="code" href="mi-cmds_8h.html#a291315c01d39483f0026b8a849b70fba">raw_stdout</a>, 0, logfile, 0);
<a name="l00934"></a>00934         }
<a name="l00935"></a>00935 
<a name="l00936"></a>00936       saved_raw_stdout = <a class="code" href="mi-cmds_8h.html#a291315c01d39483f0026b8a849b70fba">raw_stdout</a>;
<a name="l00937"></a>00937       <a class="code" href="mi-cmds_8h.html#a291315c01d39483f0026b8a849b70fba">raw_stdout</a> = <a class="code" href="structmi__interp.html#ac8bb6a962e3cf201e8be215bbddae337">out</a>;
<a name="l00938"></a>00938     }
<a name="l00939"></a>00939   <span class="keywordflow">else</span>
<a name="l00940"></a>00940     {
<a name="l00941"></a>00941       <a class="code" href="mi-cmds_8h.html#a291315c01d39483f0026b8a849b70fba">raw_stdout</a> = <a class="code" href="mi-interp_8c.html#ade2dc27238af530ba907c03a1bbc21f6">saved_raw_stdout</a>;
<a name="l00942"></a>00942       saved_raw_stdout = NULL;
<a name="l00943"></a>00943     }
<a name="l00944"></a>00944   
<a name="l00945"></a>00945   <a class="code" href="mi-console_8c.html#a191194ab9cffcff62dbcd44d28ed620b">mi_console_set_raw</a> (mi-&gt;<a class="code" href="structmi__interp.html#ac8bb6a962e3cf201e8be215bbddae337">out</a>, <a class="code" href="mi-cmds_8h.html#a291315c01d39483f0026b8a849b70fba">raw_stdout</a>);
<a name="l00946"></a>00946   <a class="code" href="mi-console_8c.html#a191194ab9cffcff62dbcd44d28ed620b">mi_console_set_raw</a> (mi-&gt;<a class="code" href="structmi__interp.html#a0ff34900d13331d8c52b61654ecf7eb2">err</a>, <a class="code" href="mi-cmds_8h.html#a291315c01d39483f0026b8a849b70fba">raw_stdout</a>);
<a name="l00947"></a>00947   <a class="code" href="mi-console_8c.html#a191194ab9cffcff62dbcd44d28ed620b">mi_console_set_raw</a> (mi-&gt;<a class="code" href="structmi__interp.html#aae20e5805757470b103b7b11830b2e66">log</a>, <a class="code" href="mi-cmds_8h.html#a291315c01d39483f0026b8a849b70fba">raw_stdout</a>);
<a name="l00948"></a>00948   <a class="code" href="mi-console_8c.html#a191194ab9cffcff62dbcd44d28ed620b">mi_console_set_raw</a> (mi-&gt;<a class="code" href="structmi__interp.html#aabe1c0e5f999b3c6413959f52bc20260">targ</a>, <a class="code" href="mi-cmds_8h.html#a291315c01d39483f0026b8a849b70fba">raw_stdout</a>);
<a name="l00949"></a>00949   <a class="code" href="mi-console_8c.html#a191194ab9cffcff62dbcd44d28ed620b">mi_console_set_raw</a> (mi-&gt;<a class="code" href="structmi__interp.html#a9789f994da11c82cd9217afb3355c28b">event_channel</a>, <a class="code" href="mi-cmds_8h.html#a291315c01d39483f0026b8a849b70fba">raw_stdout</a>);
<a name="l00950"></a>00950 
<a name="l00951"></a>00951   <span class="keywordflow">return</span> 1;
<a name="l00952"></a>00952 }
<a name="l00953"></a>00953 
<a name="l00954"></a>00954 <span class="keyword">extern</span> <a class="code" href="defs_8h.html#a686ed07d4fdcdc366f2bc677216ca08d">initialize_file_ftype</a> <a class="code" href="mi-interp_8c.html#a09c4501c08b00c3647dde693a7c61bf9">_initialize_mi_interp</a>; <span class="comment">/* -Wmissing-prototypes */</span>
<a name="l00955"></a>00955 
<a name="l00956"></a>00956 <span class="keywordtype">void</span>
<a name="l00957"></a><a class="code" href="mi-interp_8c.html#a508ea7eda63fef102ad8a92633c33bd3">00957</a> <a class="code" href="mi-interp_8c.html#a09c4501c08b00c3647dde693a7c61bf9">_initialize_mi_interp</a> (<span class="keywordtype">void</span>)
<a name="l00958"></a>00958 {
<a name="l00959"></a>00959   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structinterp__procs.html">interp_procs</a> procs =
<a name="l00960"></a>00960     {
<a name="l00961"></a>00961       <a class="code" href="mi-interp_8c.html#a4585819f4c3b6d0bcb717e6a4b21b2ea">mi_interpreter_init</a>,      <span class="comment">/* init_proc */</span>
<a name="l00962"></a>00962       <a class="code" href="mi-interp_8c.html#a87514fc113a9a42a18c0ef2b2abc98ee">mi_interpreter_resume</a>,    <span class="comment">/* resume_proc */</span>
<a name="l00963"></a>00963       <a class="code" href="mi-interp_8c.html#a8ffadfd157c1b5e2a85f3526f34fe622">mi_interpreter_suspend</a>,   <span class="comment">/* suspend_proc */</span>
<a name="l00964"></a>00964       <a class="code" href="mi-interp_8c.html#aa1677b11f9223ea965db3d82bafeca62">mi_interpreter_exec</a>,      <span class="comment">/* exec_proc */</span>
<a name="l00965"></a>00965       <a class="code" href="mi-interp_8c.html#a296777036ac92e6755e670231e460bf0">mi_interpreter_prompt_p</a>,  <span class="comment">/* prompt_proc_p */</span>
<a name="l00966"></a>00966       <a class="code" href="mi-interp_8c.html#aa422b691f6f24f08ed560d79e4bf9f3d">mi_ui_out</a>,                <span class="comment">/* ui_out_proc */</span>
<a name="l00967"></a>00967       <a class="code" href="mi-interp_8c.html#ad98066e43f05da1ba11313f48e477453">mi_set_logging</a>,           <span class="comment">/* set_logging_proc */</span>
<a name="l00968"></a>00968       <a class="code" href="mi-interp_8c.html#a94631d0d7bf085ae413460a2578a2480">mi_command_loop</a>           <span class="comment">/* command_loop_proc */</span>
<a name="l00969"></a>00969     };
<a name="l00970"></a>00970 
<a name="l00971"></a>00971   <span class="comment">/* The various interpreter levels.  */</span>
<a name="l00972"></a>00972   <a class="code" href="interps_8c.html#aca3cf2fd44fdf505859a2e997e97c4f8">interp_add</a> (<a class="code" href="interps_8c.html#a16b1f2e85509f0126c2b5f6fb24ac59c">interp_new</a> (<a class="code" href="interps_8h.html#aaa97c8c73c091bcc516f07ded3c74d34">INTERP_MI1</a>, &amp;procs));
<a name="l00973"></a>00973   <a class="code" href="interps_8c.html#aca3cf2fd44fdf505859a2e997e97c4f8">interp_add</a> (<a class="code" href="interps_8c.html#a16b1f2e85509f0126c2b5f6fb24ac59c">interp_new</a> (<a class="code" href="interps_8h.html#a0afb639c3352bbe39c403870a94b12c4">INTERP_MI2</a>, &amp;procs));
<a name="l00974"></a>00974   <a class="code" href="interps_8c.html#aca3cf2fd44fdf505859a2e997e97c4f8">interp_add</a> (<a class="code" href="interps_8c.html#a16b1f2e85509f0126c2b5f6fb24ac59c">interp_new</a> (<a class="code" href="interps_8h.html#aa4032fae75b2d0583f79c5c2221727bf">INTERP_MI3</a>, &amp;procs));
<a name="l00975"></a>00975   <a class="code" href="interps_8c.html#aca3cf2fd44fdf505859a2e997e97c4f8">interp_add</a> (<a class="code" href="interps_8c.html#a16b1f2e85509f0126c2b5f6fb24ac59c">interp_new</a> (<a class="code" href="interps_8h.html#a8ef82a15f52b124715117c7dcfbfa829">INTERP_MI</a>, &amp;procs));
<a name="l00976"></a>00976 }
</pre></div></div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated on Fri Oct 11 2013 14:13:30 for GDB (xrefs) by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
