<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>GDB (xrefs): /home/stan/gdb/src/gdb/psymtab.c Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">GDB (xrefs)
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">/home/stan/gdb/src/gdb/psymtab.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="psymtab_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/* Partial symbol tables.</span>
<a name="l00002"></a>00002 <span class="comment">   </span>
<a name="l00003"></a>00003 <span class="comment">   Copyright (C) 2009-2013 Free Software Foundation, Inc.</span>
<a name="l00004"></a>00004 <span class="comment"></span>
<a name="l00005"></a>00005 <span class="comment">   This file is part of GDB.</span>
<a name="l00006"></a>00006 <span class="comment"></span>
<a name="l00007"></a>00007 <span class="comment">   This program is free software; you can redistribute it and/or modify</span>
<a name="l00008"></a>00008 <span class="comment">   it under the terms of the GNU General Public License as published by</span>
<a name="l00009"></a>00009 <span class="comment">   the Free Software Foundation; either version 3 of the License, or</span>
<a name="l00010"></a>00010 <span class="comment">   (at your option) any later version.</span>
<a name="l00011"></a>00011 <span class="comment"></span>
<a name="l00012"></a>00012 <span class="comment">   This program is distributed in the hope that it will be useful,</span>
<a name="l00013"></a>00013 <span class="comment">   but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00014"></a>00014 <span class="comment">   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00015"></a>00015 <span class="comment">   GNU General Public License for more details.</span>
<a name="l00016"></a>00016 <span class="comment"></span>
<a name="l00017"></a>00017 <span class="comment">   You should have received a copy of the GNU General Public License</span>
<a name="l00018"></a>00018 <span class="comment">   along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.  */</span>
<a name="l00019"></a>00019 
<a name="l00020"></a>00020 <span class="preprocessor">#include &quot;<a class="code" href="defs_8h.html">defs.h</a>&quot;</span>
<a name="l00021"></a>00021 <span class="preprocessor">#include &quot;<a class="code" href="symtab_8h.html">symtab.h</a>&quot;</span>
<a name="l00022"></a>00022 <span class="preprocessor">#include &quot;<a class="code" href="psympriv_8h.html">psympriv.h</a>&quot;</span>
<a name="l00023"></a>00023 <span class="preprocessor">#include &quot;<a class="code" href="objfiles_8h.html">objfiles.h</a>&quot;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &quot;<a class="code" href="gdb__assert_8h.html">gdb_assert.h</a>&quot;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &quot;<a class="code" href="block_8h.html">block.h</a>&quot;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &quot;filenames.h&quot;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &quot;<a class="code" href="source_8h.html">source.h</a>&quot;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &quot;<a class="code" href="addrmap_8h.html">addrmap.h</a>&quot;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &quot;<a class="code" href="gdbtypes_8h.html">gdbtypes.h</a>&quot;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &quot;<a class="code" href="bcache_8h.html">bcache.h</a>&quot;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &quot;<a class="code" href="ui-out_8h.html">ui-out.h</a>&quot;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &quot;<a class="code" href="command_8h.html">command.h</a>&quot;</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &quot;readline/readline.h&quot;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &quot;<a class="code" href="gdb__regex_8h.html">gdb_regex.h</a>&quot;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &quot;<a class="code" href="dictionary_8h.html">dictionary.h</a>&quot;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &quot;<a class="code" href="language_8h.html">language.h</a>&quot;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &quot;<a class="code" href="cp-support_8h.html">cp-support.h</a>&quot;</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include &quot;<a class="code" href="gdbcmd_8h.html">gdbcmd.h</a>&quot;</span>
<a name="l00039"></a>00039 
<a name="l00040"></a>00040 <span class="preprocessor">#ifndef DEV_TTY</span>
<a name="l00041"></a><a class="code" href="psymtab_8c.html#a76aaa26b53defe4e315b752bf3b6e2a3">00041</a> <span class="preprocessor"></span><span class="preprocessor">#define DEV_TTY &quot;/dev/tty&quot;</span>
<a name="l00042"></a>00042 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00043"></a>00043 <span class="preprocessor"></span>
<a name="l00044"></a><a class="code" href="structpsymbol__bcache.html">00044</a> <span class="keyword">struct </span><a class="code" href="structpsymbol__bcache.html">psymbol_bcache</a>
<a name="l00045"></a>00045 {
<a name="l00046"></a><a class="code" href="structpsymbol__bcache.html#aabaebf31fe72a442e512063481704905">00046</a>   <span class="keyword">struct </span><a class="code" href="structbcache.html">bcache</a> *<a class="code" href="structpsymbol__bcache.html#aabaebf31fe72a442e512063481704905">bcache</a>;
<a name="l00047"></a>00047 };
<a name="l00048"></a>00048 
<a name="l00049"></a>00049 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structpartial__symbol.html">partial_symbol</a> *<a class="code" href="psymtab_8c.html#a858899bc2b0798c6f9d38754434435a7">match_partial_symbol</a> (<span class="keyword">struct</span> <a class="code" href="structobjfile.html">objfile</a> *,
<a name="l00050"></a>00050                                                     <span class="keyword">struct</span> <a class="code" href="structpartial__symtab.html">partial_symtab</a> *,
<a name="l00051"></a>00051                                                     <span class="keywordtype">int</span>,
<a name="l00052"></a>00052                                                     <span class="keyword">const</span> <span class="keywordtype">char</span> *, <a class="code" href="symtab_8h.html#abbcd14557de81830c9e96ea4bdfc14aa">domain_enum</a>,
<a name="l00053"></a>00053                                                     <a class="code" href="symfile_8h.html#a2b98a5062928ff31e334877e5cf444bd">symbol_compare_ftype</a> *,
<a name="l00054"></a>00054                                                     <a class="code" href="symfile_8h.html#a2b98a5062928ff31e334877e5cf444bd">symbol_compare_ftype</a> *);
<a name="l00055"></a>00055 
<a name="l00056"></a>00056 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structpartial__symbol.html">partial_symbol</a> *<a class="code" href="psymtab_8c.html#af55d03c98bc38e536b34403f0ff4429b">lookup_partial_symbol</a> (<span class="keyword">struct</span> <a class="code" href="structobjfile.html">objfile</a> *,
<a name="l00057"></a>00057                                                      <span class="keyword">struct</span> <a class="code" href="structpartial__symtab.html">partial_symtab</a> *,
<a name="l00058"></a>00058                                                      <span class="keyword">const</span> <span class="keywordtype">char</span> *, <span class="keywordtype">int</span>,
<a name="l00059"></a>00059                                                      <a class="code" href="symtab_8h.html#abbcd14557de81830c9e96ea4bdfc14aa">domain_enum</a>);
<a name="l00060"></a>00060 
<a name="l00061"></a>00061 <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="psymtab_8c.html#af53cd102034592d4246538edbadc98fe">psymtab_to_fullname</a> (<span class="keyword">struct</span> <a class="code" href="structpartial__symtab.html">partial_symtab</a> *<a class="code" href="namespacecleanup__check.html#a2f9ce522b7667bef19a5777d12fa44d8">ps</a>);
<a name="l00062"></a>00062 
<a name="l00063"></a>00063 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structpartial__symbol.html">partial_symbol</a> *<a class="code" href="psymtab_8c.html#a71291ddf853861e78a63f1324e44aea6">find_pc_sect_psymbol</a> (<span class="keyword">struct</span> <a class="code" href="structobjfile.html">objfile</a> *,
<a name="l00064"></a>00064                                                     <span class="keyword">struct</span> <a class="code" href="structpartial__symtab.html">partial_symtab</a> *,
<a name="l00065"></a>00065                                                     <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a>,
<a name="l00066"></a>00066                                                     <span class="keyword">struct</span> <a class="code" href="structobj__section.html">obj_section</a> *);
<a name="l00067"></a>00067 
<a name="l00068"></a>00068 <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="psymtab_8c.html#ab6769b1757f156547dec8cdf53b45ad9">fixup_psymbol_section</a> (<span class="keyword">struct</span> <a class="code" href="structpartial__symbol.html">partial_symbol</a> *psym,
<a name="l00069"></a>00069                                    <span class="keyword">struct</span> <a class="code" href="structobjfile.html">objfile</a> *<a class="code" href="structobjfile.html">objfile</a>);
<a name="l00070"></a>00070 
<a name="l00071"></a>00071 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structsymtab.html">symtab</a> *<a class="code" href="psymtab_8c.html#a9afb9c706b9a9f25e4395b9a95ce4c8a">psymtab_to_symtab</a> (<span class="keyword">struct</span> <a class="code" href="structobjfile.html">objfile</a> *<a class="code" href="structobjfile.html">objfile</a>,
<a name="l00072"></a>00072                                          <span class="keyword">struct</span> <a class="code" href="structpartial__symtab.html">partial_symtab</a> *pst);
<a name="l00073"></a>00073 
<a name="l00074"></a>00074 <span class="comment">/* Ensure that the partial symbols for OBJFILE have been loaded.  This</span>
<a name="l00075"></a>00075 <span class="comment">   function always returns its argument, as a convenience.  */</span>
<a name="l00076"></a>00076 
<a name="l00077"></a>00077 <span class="keyword">struct </span><a class="code" href="structobjfile.html">objfile</a> *
<a name="l00078"></a><a class="code" href="psymtab_8h.html#ad46668e72558b7dfaae6836853cf1a03">00078</a> <a class="code" href="psymtab_8c.html#ad46668e72558b7dfaae6836853cf1a03">require_partial_symbols</a> (<span class="keyword">struct</span> <a class="code" href="structobjfile.html">objfile</a> *<a class="code" href="structobjfile.html">objfile</a>, <span class="keywordtype">int</span> verbose)
<a name="l00079"></a>00079 {
<a name="l00080"></a>00080   <span class="keywordflow">if</span> ((objfile-&gt;<a class="code" href="structobjfile.html#a07578e542db3b2a277e146b24adf007e">flags</a> &amp; <a class="code" href="objfiles_8h.html#a13235f574bd2cf0e2254a9693c1a597a">OBJF_PSYMTABS_READ</a>) == 0)
<a name="l00081"></a>00081     {
<a name="l00082"></a>00082       objfile-&gt;<a class="code" href="structobjfile.html#a07578e542db3b2a277e146b24adf007e">flags</a> |= <a class="code" href="objfiles_8h.html#a13235f574bd2cf0e2254a9693c1a597a">OBJF_PSYMTABS_READ</a>;
<a name="l00083"></a>00083 
<a name="l00084"></a>00084       <span class="keywordflow">if</span> (objfile-&gt;<a class="code" href="structobjfile.html#af6814df9c2fd1f669fd79d0b0c94262c">sf</a>-&gt;<a class="code" href="structsym__fns.html#a4170e31bf1aee5650fd20bd66c0f614a">sym_read_psymbols</a>)
<a name="l00085"></a>00085         {
<a name="l00086"></a>00086           <span class="keywordflow">if</span> (verbose)
<a name="l00087"></a>00087             {
<a name="l00088"></a>00088               <a class="code" href="utils_8c.html#ad57145632bbcb0361dc1dfa134b1efd0">printf_unfiltered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;Reading symbols from %s...&quot;</span>),
<a name="l00089"></a>00089                                  <a class="code" href="objfiles_8c.html#a33e548a19b86b293435d3c2d6daaaec6">objfile_name</a> (objfile));
<a name="l00090"></a>00090               <a class="code" href="ui-file_8c.html#a046f07b5ef1bcc35c28b4be983e39998">gdb_flush</a> (<a class="code" href="main_8c.html#a41a2b997ba5454df787d61f051dd918c">gdb_stdout</a>);
<a name="l00091"></a>00091             }
<a name="l00092"></a>00092           (*objfile-&gt;<a class="code" href="structobjfile.html#af6814df9c2fd1f669fd79d0b0c94262c">sf</a>-&gt;<a class="code" href="structsym__fns.html#a4170e31bf1aee5650fd20bd66c0f614a">sym_read_psymbols</a>) (objfile);
<a name="l00093"></a>00093           <span class="keywordflow">if</span> (verbose)
<a name="l00094"></a>00094             {
<a name="l00095"></a>00095               <span class="keywordflow">if</span> (!<a class="code" href="objfiles_8c.html#a4ce59bee0b77fe55f4e326c7ecad3f6a">objfile_has_symbols</a> (objfile))
<a name="l00096"></a>00096                 {
<a name="l00097"></a>00097                   <a class="code" href="utils_8c.html#a857540a17ef1cd62fef4a33cc3b6a894">wrap_here</a> (<span class="stringliteral">&quot;&quot;</span>);
<a name="l00098"></a>00098                   <a class="code" href="utils_8c.html#ad57145632bbcb0361dc1dfa134b1efd0">printf_unfiltered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;(no debugging symbols found)...&quot;</span>));
<a name="l00099"></a>00099                   <a class="code" href="utils_8c.html#a857540a17ef1cd62fef4a33cc3b6a894">wrap_here</a> (<span class="stringliteral">&quot;&quot;</span>);
<a name="l00100"></a>00100                 }
<a name="l00101"></a>00101 
<a name="l00102"></a>00102               <a class="code" href="utils_8c.html#ad57145632bbcb0361dc1dfa134b1efd0">printf_unfiltered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;done.\n&quot;</span>));
<a name="l00103"></a>00103             }
<a name="l00104"></a>00104         }
<a name="l00105"></a>00105     }
<a name="l00106"></a>00106 
<a name="l00107"></a>00107   <span class="keywordflow">return</span> objfile;
<a name="l00108"></a>00108 }
<a name="l00109"></a>00109 
<a name="l00110"></a>00110 <span class="comment">/* Traverse all psymtabs in one objfile, requiring that the psymtabs</span>
<a name="l00111"></a>00111 <span class="comment">   be read in.  */</span>
<a name="l00112"></a>00112 
<a name="l00113"></a><a class="code" href="psymtab_8c.html#a3fbd70c118d9b449af634c15717d508e">00113</a> <span class="preprocessor">#define ALL_OBJFILE_PSYMTABS_REQUIRED(objfile, p)               \</span>
<a name="l00114"></a>00114 <span class="preprocessor">    for ((p) = require_partial_symbols (objfile, 1)-&gt;psymtabs;  \</span>
<a name="l00115"></a>00115 <span class="preprocessor">         (p) != NULL;                                           \</span>
<a name="l00116"></a>00116 <span class="preprocessor">         (p) = (p)-&gt;next)</span>
<a name="l00117"></a>00117 <span class="preprocessor"></span>
<a name="l00118"></a>00118 <span class="comment">/* We want to make sure this file always requires psymtabs.  */</span>
<a name="l00119"></a>00119 
<a name="l00120"></a>00120 <span class="preprocessor">#undef ALL_OBJFILE_PSYMTABS</span>
<a name="l00121"></a>00121 <span class="preprocessor"></span>
<a name="l00122"></a>00122 <span class="comment">/* Traverse all psymtabs in all objfiles.  */</span>
<a name="l00123"></a>00123 
<a name="l00124"></a><a class="code" href="psymtab_8c.html#a3a00a6d0d1f26826e6270ee7e2bb4f6d">00124</a> <span class="preprocessor">#define ALL_PSYMTABS(objfile, p) \</span>
<a name="l00125"></a>00125 <span class="preprocessor">  ALL_OBJFILES (objfile)         \</span>
<a name="l00126"></a>00126 <span class="preprocessor">    ALL_OBJFILE_PSYMTABS_REQUIRED (objfile, p)</span>
<a name="l00127"></a>00127 <span class="preprocessor"></span>
<a name="l00128"></a>00128 <span class="comment">/* Helper function for partial_map_symtabs_matching_filename that</span>
<a name="l00129"></a>00129 <span class="comment">   expands the symtabs and calls the iterator.  */</span>
<a name="l00130"></a>00130 
<a name="l00131"></a>00131 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l00132"></a><a class="code" href="psymtab_8c.html#a5c60b0476238ffbc171610896db86b3a">00132</a> <a class="code" href="psymtab_8c.html#a5c60b0476238ffbc171610896db86b3a">partial_map_expand_apply</a> (<span class="keyword">struct</span> <a class="code" href="structobjfile.html">objfile</a> *<a class="code" href="structobjfile.html">objfile</a>,
<a name="l00133"></a>00133                           <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="aarch64-tdep_8c.html#acc128f98d9ceca227038c771308eff39">name</a>,
<a name="l00134"></a>00134                           <span class="keyword">const</span> <span class="keywordtype">char</span> *real_path,
<a name="l00135"></a>00135                           <span class="keyword">struct</span> <a class="code" href="structpartial__symtab.html">partial_symtab</a> *pst,
<a name="l00136"></a>00136                           <span class="keywordtype">int</span> (*callback) (<span class="keyword">struct</span> <a class="code" href="structsymtab.html">symtab</a> *, <span class="keywordtype">void</span> *),
<a name="l00137"></a>00137                           <span class="keywordtype">void</span> *data)
<a name="l00138"></a>00138 {
<a name="l00139"></a>00139   <span class="keyword">struct </span><a class="code" href="structsymtab.html">symtab</a> *last_made = objfile-&gt;<a class="code" href="structobjfile.html#a7de941af61199f5f18580235feec7e8c">symtabs</a>;
<a name="l00140"></a>00140 
<a name="l00141"></a>00141   <span class="comment">/* Shared psymtabs should never be seen here.  Instead they should</span>
<a name="l00142"></a>00142 <span class="comment">     be handled properly by the caller.  */</span>
<a name="l00143"></a>00143   <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (pst-&gt;<a class="code" href="structpartial__symtab.html#a0609b1a2e29b3419dc25520e7d7293f0">user</a> == NULL);
<a name="l00144"></a>00144 
<a name="l00145"></a>00145   <span class="comment">/* Don&#39;t visit already-expanded psymtabs.  */</span>
<a name="l00146"></a>00146   <span class="keywordflow">if</span> (pst-&gt;<a class="code" href="structpartial__symtab.html#a11d8e59b962db1317c8c23f917dbed42">readin</a>)
<a name="l00147"></a>00147     <span class="keywordflow">return</span> 0;
<a name="l00148"></a>00148 
<a name="l00149"></a>00149   <span class="comment">/* This may expand more than one symtab, and we want to iterate over</span>
<a name="l00150"></a>00150 <span class="comment">     all of them.  */</span>
<a name="l00151"></a>00151   <a class="code" href="psymtab_8c.html#a9afb9c706b9a9f25e4395b9a95ce4c8a">psymtab_to_symtab</a> (objfile, pst);
<a name="l00152"></a>00152 
<a name="l00153"></a>00153   <span class="keywordflow">return</span> <a class="code" href="symtab_8c.html#a6aef2b41973621c0425ce4f6a39e5a99">iterate_over_some_symtabs</a> (name, real_path, callback, data,
<a name="l00154"></a>00154                                     objfile-&gt;<a class="code" href="structobjfile.html#a7de941af61199f5f18580235feec7e8c">symtabs</a>, last_made);
<a name="l00155"></a>00155 }
<a name="l00156"></a>00156 
<a name="l00157"></a>00157 <span class="comment">/* Implementation of the map_symtabs_matching_filename method.  */</span>
<a name="l00158"></a>00158 
<a name="l00159"></a>00159 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l00160"></a><a class="code" href="psymtab_8c.html#a832ded68ab5e9e7810eaf81bf8b04598">00160</a> <a class="code" href="psymtab_8c.html#a832ded68ab5e9e7810eaf81bf8b04598">partial_map_symtabs_matching_filename</a> (<span class="keyword">struct</span> objfile *objfile,
<a name="l00161"></a>00161                                        <span class="keyword">const</span> <span class="keywordtype">char</span> *name,
<a name="l00162"></a>00162                                        <span class="keyword">const</span> <span class="keywordtype">char</span> *real_path,
<a name="l00163"></a>00163                                        <span class="keywordtype">int</span> (*callback) (<span class="keyword">struct</span> <a class="code" href="structsymtab.html">symtab</a> *,
<a name="l00164"></a>00164                                                         <span class="keywordtype">void</span> *),
<a name="l00165"></a>00165                                        <span class="keywordtype">void</span> *data)
<a name="l00166"></a>00166 {
<a name="l00167"></a>00167   <span class="keyword">struct </span><a class="code" href="structpartial__symtab.html">partial_symtab</a> *pst;
<a name="l00168"></a>00168   <span class="keyword">const</span> <span class="keywordtype">char</span> *name_basename = lbasename (name);
<a name="l00169"></a>00169 
<a name="l00170"></a>00170   <a class="code" href="psymtab_8c.html#a3fbd70c118d9b449af634c15717d508e">ALL_OBJFILE_PSYMTABS_REQUIRED</a> (objfile, pst)
<a name="l00171"></a>00171   {
<a name="l00172"></a>00172     <span class="comment">/* We can skip shared psymtabs here, because any file name will be</span>
<a name="l00173"></a>00173 <span class="comment">       attached to the unshared psymtab.  */</span>
<a name="l00174"></a>00174     <span class="keywordflow">if</span> (pst-&gt;<a class="code" href="structpartial__symtab.html#a0609b1a2e29b3419dc25520e7d7293f0">user</a> != NULL)
<a name="l00175"></a>00175       <span class="keywordflow">continue</span>;
<a name="l00176"></a>00176 
<a name="l00177"></a>00177     <span class="comment">/* Anonymous psymtabs don&#39;t have a file name.  */</span>
<a name="l00178"></a>00178     <span class="keywordflow">if</span> (pst-&gt;<a class="code" href="structpartial__symtab.html#a72ab74ae49f0048cc7151d786e724235">anonymous</a>)
<a name="l00179"></a>00179       <span class="keywordflow">continue</span>;
<a name="l00180"></a>00180 
<a name="l00181"></a>00181     <span class="keywordflow">if</span> (<a class="code" href="symtab_8c.html#a1316e7f1ae237bfce71774ffee89fa1f">compare_filenames_for_search</a> (pst-&gt;<a class="code" href="structpartial__symtab.html#a6ea70ac87d6dbd541967bdd6dacd7321">filename</a>, name))
<a name="l00182"></a>00182       {
<a name="l00183"></a>00183         <span class="keywordflow">if</span> (<a class="code" href="psymtab_8c.html#a5c60b0476238ffbc171610896db86b3a">partial_map_expand_apply</a> (objfile, name, real_path,
<a name="l00184"></a>00184                                       pst, callback, data))
<a name="l00185"></a>00185           <span class="keywordflow">return</span> 1;
<a name="l00186"></a>00186         <span class="keywordflow">continue</span>;
<a name="l00187"></a>00187       }
<a name="l00188"></a>00188 
<a name="l00189"></a>00189     <span class="comment">/* Before we invoke realpath, which can get expensive when many</span>
<a name="l00190"></a>00190 <span class="comment">       files are involved, do a quick comparison of the basenames.  */</span>
<a name="l00191"></a>00191     <span class="keywordflow">if</span> (! <a class="code" href="symtab_8c.html#af9a62a674b6767f0981034f1ceb7756a">basenames_may_differ</a>
<a name="l00192"></a>00192         &amp;&amp; FILENAME_CMP (name_basename, lbasename (pst-&gt;<a class="code" href="structpartial__symtab.html#a6ea70ac87d6dbd541967bdd6dacd7321">filename</a>)) != 0)
<a name="l00193"></a>00193       <span class="keywordflow">continue</span>;
<a name="l00194"></a>00194 
<a name="l00195"></a>00195     <span class="keywordflow">if</span> (<a class="code" href="symtab_8c.html#a1316e7f1ae237bfce71774ffee89fa1f">compare_filenames_for_search</a> (<a class="code" href="psymtab_8c.html#af53cd102034592d4246538edbadc98fe">psymtab_to_fullname</a> (pst), name))
<a name="l00196"></a>00196       {
<a name="l00197"></a>00197         <span class="keywordflow">if</span> (<a class="code" href="psymtab_8c.html#a5c60b0476238ffbc171610896db86b3a">partial_map_expand_apply</a> (objfile, name, real_path,
<a name="l00198"></a>00198                                       pst, callback, data))
<a name="l00199"></a>00199           <span class="keywordflow">return</span> 1;
<a name="l00200"></a>00200         <span class="keywordflow">continue</span>;
<a name="l00201"></a>00201       }
<a name="l00202"></a>00202 
<a name="l00203"></a>00203     <span class="comment">/* If the user gave us an absolute path, try to find the file in</span>
<a name="l00204"></a>00204 <span class="comment">       this symtab and use its absolute path.  */</span>
<a name="l00205"></a>00205     <span class="keywordflow">if</span> (real_path != NULL)
<a name="l00206"></a>00206       {
<a name="l00207"></a>00207         <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (IS_ABSOLUTE_PATH (real_path));
<a name="l00208"></a>00208         <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (IS_ABSOLUTE_PATH (name));
<a name="l00209"></a>00209         <span class="keywordflow">if</span> (filename_cmp (<a class="code" href="psymtab_8c.html#af53cd102034592d4246538edbadc98fe">psymtab_to_fullname</a> (pst), real_path) == 0)
<a name="l00210"></a>00210           {
<a name="l00211"></a>00211             <span class="keywordflow">if</span> (<a class="code" href="psymtab_8c.html#a5c60b0476238ffbc171610896db86b3a">partial_map_expand_apply</a> (objfile, name, real_path,
<a name="l00212"></a>00212                                           pst, callback, data))
<a name="l00213"></a>00213               <span class="keywordflow">return</span> 1;
<a name="l00214"></a>00214             <span class="keywordflow">continue</span>;
<a name="l00215"></a>00215           }
<a name="l00216"></a>00216       }
<a name="l00217"></a>00217   }
<a name="l00218"></a>00218 
<a name="l00219"></a>00219   <span class="keywordflow">return</span> 0;
<a name="l00220"></a>00220 }
<a name="l00221"></a>00221 
<a name="l00222"></a>00222 <span class="comment">/* Find which partial symtab contains PC and SECTION starting at psymtab PST.</span>
<a name="l00223"></a>00223 <span class="comment">   We may find a different psymtab than PST.  See FIND_PC_SECT_PSYMTAB.  */</span>
<a name="l00224"></a>00224 
<a name="l00225"></a>00225 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structpartial__symtab.html">partial_symtab</a> *
<a name="l00226"></a><a class="code" href="psymtab_8c.html#a65231dddd11f69a0f516a99f88cc07f4">00226</a> <a class="code" href="psymtab_8c.html#a65231dddd11f69a0f516a99f88cc07f4">find_pc_sect_psymtab_closer</a> (<span class="keyword">struct</span> objfile *objfile,
<a name="l00227"></a>00227                              <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> pc, <span class="keyword">struct</span> <a class="code" href="structobj__section.html">obj_section</a> *section,
<a name="l00228"></a>00228                              <span class="keyword">struct</span> <a class="code" href="structpartial__symtab.html">partial_symtab</a> *pst,
<a name="l00229"></a>00229                              <span class="keyword">struct</span> <a class="code" href="structminimal__symbol.html">minimal_symbol</a> *msymbol)
<a name="l00230"></a>00230 {
<a name="l00231"></a>00231   <span class="keyword">struct </span><a class="code" href="structpartial__symtab.html">partial_symtab</a> *tpst;
<a name="l00232"></a>00232   <span class="keyword">struct </span><a class="code" href="structpartial__symtab.html">partial_symtab</a> *best_pst = pst;
<a name="l00233"></a>00233   <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> best_addr = pst-&gt;<a class="code" href="structpartial__symtab.html#a194e7d3c21d81ce56b81d1fe02e1dbc3">textlow</a>;
<a name="l00234"></a>00234 
<a name="l00235"></a>00235   <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (!pst-&gt;<a class="code" href="structpartial__symtab.html#aa4a6c5beadf5f2d9b39a06c04c728fa2">psymtabs_addrmap_supported</a>);
<a name="l00236"></a>00236 
<a name="l00237"></a>00237   <span class="comment">/* An objfile that has its functions reordered might have</span>
<a name="l00238"></a>00238 <span class="comment">     many partial symbol tables containing the PC, but</span>
<a name="l00239"></a>00239 <span class="comment">     we want the partial symbol table that contains the</span>
<a name="l00240"></a>00240 <span class="comment">     function containing the PC.  */</span>
<a name="l00241"></a>00241   <span class="keywordflow">if</span> (!(objfile-&gt;<a class="code" href="structobjfile.html#a07578e542db3b2a277e146b24adf007e">flags</a> &amp; <a class="code" href="objfiles_8h.html#aebdb0f14c149fa8267a184b55130c4c6">OBJF_REORDERED</a>) &amp;&amp;
<a name="l00242"></a>00242       section == 0)     <span class="comment">/* Can&#39;t validate section this way.  */</span>
<a name="l00243"></a>00243     <span class="keywordflow">return</span> pst;
<a name="l00244"></a>00244 
<a name="l00245"></a>00245   <span class="keywordflow">if</span> (msymbol == NULL)
<a name="l00246"></a>00246     <span class="keywordflow">return</span> (pst);
<a name="l00247"></a>00247 
<a name="l00248"></a>00248   <span class="comment">/* The code range of partial symtabs sometimes overlap, so, in</span>
<a name="l00249"></a>00249 <span class="comment">     the loop below, we need to check all partial symtabs and</span>
<a name="l00250"></a>00250 <span class="comment">     find the one that fits better for the given PC address.  We</span>
<a name="l00251"></a>00251 <span class="comment">     select the partial symtab that contains a symbol whose</span>
<a name="l00252"></a>00252 <span class="comment">     address is closest to the PC address.  By closest we mean</span>
<a name="l00253"></a>00253 <span class="comment">     that find_pc_sect_symbol returns the symbol with address</span>
<a name="l00254"></a>00254 <span class="comment">     that is closest and still less than the given PC.  */</span>
<a name="l00255"></a>00255   <span class="keywordflow">for</span> (tpst = pst; tpst != NULL; tpst = tpst-&gt;<a class="code" href="structpartial__symtab.html#aa58c92073996df85892297ab82788785">next</a>)
<a name="l00256"></a>00256     {
<a name="l00257"></a>00257       <span class="keywordflow">if</span> (pc &gt;= tpst-&gt;<a class="code" href="structpartial__symtab.html#a194e7d3c21d81ce56b81d1fe02e1dbc3">textlow</a> &amp;&amp; pc &lt; tpst-&gt;<a class="code" href="structpartial__symtab.html#aa582095c68fb326f3042ad672527a438">texthigh</a>)
<a name="l00258"></a>00258         {
<a name="l00259"></a>00259           <span class="keyword">struct </span><a class="code" href="structpartial__symbol.html">partial_symbol</a> *<a class="code" href="windows-nat_8c.html#ade66e4ccafbc33b117610bbc0d85feb0">p</a>;
<a name="l00260"></a>00260           <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> this_addr;
<a name="l00261"></a>00261 
<a name="l00262"></a>00262           <span class="comment">/* NOTE: This assumes that every psymbol has a</span>
<a name="l00263"></a>00263 <span class="comment">             corresponding msymbol, which is not necessarily</span>
<a name="l00264"></a>00264 <span class="comment">             true; the debug info might be much richer than the</span>
<a name="l00265"></a>00265 <span class="comment">             object&#39;s symbol table.  */</span>
<a name="l00266"></a>00266           p = <a class="code" href="psymtab_8c.html#a71291ddf853861e78a63f1324e44aea6">find_pc_sect_psymbol</a> (objfile, tpst, pc, section);
<a name="l00267"></a>00267           <span class="keywordflow">if</span> (p != NULL
<a name="l00268"></a>00268               &amp;&amp; <a class="code" href="symtab_8h.html#abee697b9e3bb4f4d164ad920a87ab854">SYMBOL_VALUE_ADDRESS</a> (p)
<a name="l00269"></a>00269               == <a class="code" href="symtab_8h.html#abee697b9e3bb4f4d164ad920a87ab854">SYMBOL_VALUE_ADDRESS</a> (msymbol))
<a name="l00270"></a>00270             <span class="keywordflow">return</span> tpst;
<a name="l00271"></a>00271 
<a name="l00272"></a>00272           <span class="comment">/* Also accept the textlow value of a psymtab as a</span>
<a name="l00273"></a>00273 <span class="comment">             &quot;symbol&quot;, to provide some support for partial</span>
<a name="l00274"></a>00274 <span class="comment">             symbol tables with line information but no debug</span>
<a name="l00275"></a>00275 <span class="comment">             symbols (e.g. those produced by an assembler).  */</span>
<a name="l00276"></a>00276           <span class="keywordflow">if</span> (p != NULL)
<a name="l00277"></a>00277             this_addr = <a class="code" href="symtab_8h.html#abee697b9e3bb4f4d164ad920a87ab854">SYMBOL_VALUE_ADDRESS</a> (p);
<a name="l00278"></a>00278           <span class="keywordflow">else</span>
<a name="l00279"></a>00279             this_addr = tpst-&gt;<a class="code" href="structpartial__symtab.html#a194e7d3c21d81ce56b81d1fe02e1dbc3">textlow</a>;
<a name="l00280"></a>00280 
<a name="l00281"></a>00281           <span class="comment">/* Check whether it is closer than our current</span>
<a name="l00282"></a>00282 <span class="comment">             BEST_ADDR.  Since this symbol address is</span>
<a name="l00283"></a>00283 <span class="comment">             necessarily lower or equal to PC, the symbol closer</span>
<a name="l00284"></a>00284 <span class="comment">             to PC is the symbol which address is the highest.</span>
<a name="l00285"></a>00285 <span class="comment">             This way we return the psymtab which contains such</span>
<a name="l00286"></a>00286 <span class="comment">             best match symbol.  This can help in cases where the</span>
<a name="l00287"></a>00287 <span class="comment">             symbol information/debuginfo is not complete, like</span>
<a name="l00288"></a>00288 <span class="comment">             for instance on IRIX6 with gcc, where no debug info</span>
<a name="l00289"></a>00289 <span class="comment">             is emitted for statics.  (See also the nodebug.exp</span>
<a name="l00290"></a>00290 <span class="comment">             testcase.)  */</span>
<a name="l00291"></a>00291           <span class="keywordflow">if</span> (this_addr &gt; best_addr)
<a name="l00292"></a>00292             {
<a name="l00293"></a>00293               best_addr = this_addr;
<a name="l00294"></a>00294               best_pst = tpst;
<a name="l00295"></a>00295             }
<a name="l00296"></a>00296         }
<a name="l00297"></a>00297     }
<a name="l00298"></a>00298   <span class="keywordflow">return</span> best_pst;
<a name="l00299"></a>00299 }
<a name="l00300"></a>00300 
<a name="l00301"></a>00301 <span class="comment">/* Find which partial symtab contains PC and SECTION.  Return 0 if</span>
<a name="l00302"></a>00302 <span class="comment">   none.  We return the psymtab that contains a symbol whose address</span>
<a name="l00303"></a>00303 <span class="comment">   exactly matches PC, or, if we cannot find an exact match, the</span>
<a name="l00304"></a>00304 <span class="comment">   psymtab that contains a symbol whose address is closest to PC.  */</span>
<a name="l00305"></a>00305 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structpartial__symtab.html">partial_symtab</a> *
<a name="l00306"></a><a class="code" href="psymtab_8c.html#ab2b27021abdd583e28f866f03bb4628a">00306</a> <a class="code" href="psymtab_8c.html#ab2b27021abdd583e28f866f03bb4628a">find_pc_sect_psymtab</a> (<span class="keyword">struct</span> objfile *objfile, <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> pc,
<a name="l00307"></a>00307                       <span class="keyword">struct</span> <a class="code" href="structobj__section.html">obj_section</a> *section,
<a name="l00308"></a>00308                       <span class="keyword">struct</span> <a class="code" href="structminimal__symbol.html">minimal_symbol</a> *msymbol)
<a name="l00309"></a>00309 {
<a name="l00310"></a>00310   <span class="keyword">struct </span><a class="code" href="structpartial__symtab.html">partial_symtab</a> *pst;
<a name="l00311"></a>00311 
<a name="l00312"></a>00312   <span class="comment">/* Try just the PSYMTABS_ADDRMAP mapping first as it has better granularity</span>
<a name="l00313"></a>00313 <span class="comment">     than the later used TEXTLOW/TEXTHIGH one.  */</span>
<a name="l00314"></a>00314 
<a name="l00315"></a>00315   <span class="keywordflow">if</span> (objfile-&gt;<a class="code" href="structobjfile.html#ae7c792f2cd4efcff86d84d7bd3e15b26">psymtabs_addrmap</a> != NULL)
<a name="l00316"></a>00316     {
<a name="l00317"></a>00317       pst = <a class="code" href="addrmap_8c.html#a74b7d52b6910844e259bd1a9861a614c">addrmap_find</a> (objfile-&gt;<a class="code" href="structobjfile.html#ae7c792f2cd4efcff86d84d7bd3e15b26">psymtabs_addrmap</a>, pc);
<a name="l00318"></a>00318       <span class="keywordflow">if</span> (pst != NULL)
<a name="l00319"></a>00319         {
<a name="l00320"></a>00320           <span class="comment">/* FIXME: addrmaps currently do not handle overlayed sections,</span>
<a name="l00321"></a>00321 <span class="comment">             so fall back to the non-addrmap case if we&#39;re debugging</span>
<a name="l00322"></a>00322 <span class="comment">             overlays and the addrmap returned the wrong section.  */</span>
<a name="l00323"></a>00323           <span class="keywordflow">if</span> (<a class="code" href="symfile_8c.html#ad96d01ef61ee2925825b3992d37408f5">overlay_debugging</a> &amp;&amp; msymbol &amp;&amp; section)
<a name="l00324"></a>00324             {
<a name="l00325"></a>00325               <span class="keyword">struct </span><a class="code" href="structpartial__symbol.html">partial_symbol</a> *<a class="code" href="windows-nat_8c.html#ade66e4ccafbc33b117610bbc0d85feb0">p</a>;
<a name="l00326"></a>00326 
<a name="l00327"></a>00327               <span class="comment">/* NOTE: This assumes that every psymbol has a</span>
<a name="l00328"></a>00328 <span class="comment">                 corresponding msymbol, which is not necessarily</span>
<a name="l00329"></a>00329 <span class="comment">                 true; the debug info might be much richer than the</span>
<a name="l00330"></a>00330 <span class="comment">                 object&#39;s symbol table.  */</span>
<a name="l00331"></a>00331               p = <a class="code" href="psymtab_8c.html#a71291ddf853861e78a63f1324e44aea6">find_pc_sect_psymbol</a> (objfile, pst, pc, section);
<a name="l00332"></a>00332               <span class="keywordflow">if</span> (!p
<a name="l00333"></a>00333                   || <a class="code" href="symtab_8h.html#abee697b9e3bb4f4d164ad920a87ab854">SYMBOL_VALUE_ADDRESS</a> (p)
<a name="l00334"></a>00334                   != <a class="code" href="symtab_8h.html#abee697b9e3bb4f4d164ad920a87ab854">SYMBOL_VALUE_ADDRESS</a> (msymbol))
<a name="l00335"></a>00335                 <span class="keywordflow">goto</span> next;
<a name="l00336"></a>00336             }
<a name="l00337"></a>00337 
<a name="l00338"></a>00338           <span class="comment">/* We do not try to call FIND_PC_SECT_PSYMTAB_CLOSER as</span>
<a name="l00339"></a>00339 <span class="comment">             PSYMTABS_ADDRMAP we used has already the best 1-byte</span>
<a name="l00340"></a>00340 <span class="comment">             granularity and FIND_PC_SECT_PSYMTAB_CLOSER may mislead us into</span>
<a name="l00341"></a>00341 <span class="comment">             a worse chosen section due to the TEXTLOW/TEXTHIGH ranges</span>
<a name="l00342"></a>00342 <span class="comment">             overlap.  */</span>
<a name="l00343"></a>00343 
<a name="l00344"></a>00344           <span class="keywordflow">return</span> pst;
<a name="l00345"></a>00345         }
<a name="l00346"></a>00346     }
<a name="l00347"></a>00347 
<a name="l00348"></a>00348  next:
<a name="l00349"></a>00349 
<a name="l00350"></a>00350   <span class="comment">/* Existing PSYMTABS_ADDRMAP mapping is present even for PARTIAL_SYMTABs</span>
<a name="l00351"></a>00351 <span class="comment">     which still have no corresponding full SYMTABs read.  But it is not</span>
<a name="l00352"></a>00352 <span class="comment">     present for non-DWARF2 debug infos not supporting PSYMTABS_ADDRMAP in GDB</span>
<a name="l00353"></a>00353 <span class="comment">     so far.  */</span>
<a name="l00354"></a>00354 
<a name="l00355"></a>00355   <span class="comment">/* Check even OBJFILE with non-zero PSYMTABS_ADDRMAP as only several of</span>
<a name="l00356"></a>00356 <span class="comment">     its CUs may be missing in PSYMTABS_ADDRMAP as they may be varying</span>
<a name="l00357"></a>00357 <span class="comment">     debug info type in single OBJFILE.  */</span>
<a name="l00358"></a>00358 
<a name="l00359"></a>00359   <a class="code" href="psymtab_8c.html#a3fbd70c118d9b449af634c15717d508e">ALL_OBJFILE_PSYMTABS_REQUIRED</a> (objfile, pst)
<a name="l00360"></a>00360     <span class="keywordflow">if</span> (!pst-&gt;<a class="code" href="structpartial__symtab.html#aa4a6c5beadf5f2d9b39a06c04c728fa2">psymtabs_addrmap_supported</a>
<a name="l00361"></a>00361         &amp;&amp; pc &gt;= pst-&gt;<a class="code" href="structpartial__symtab.html#a194e7d3c21d81ce56b81d1fe02e1dbc3">textlow</a> &amp;&amp; pc &lt; pst-&gt;texthigh)
<a name="l00362"></a>00362       {
<a name="l00363"></a>00363         <span class="keyword">struct </span><a class="code" href="structpartial__symtab.html">partial_symtab</a> *best_pst;
<a name="l00364"></a>00364 
<a name="l00365"></a>00365         best_pst = <a class="code" href="psymtab_8c.html#a65231dddd11f69a0f516a99f88cc07f4">find_pc_sect_psymtab_closer</a> (objfile, pc, section, pst,
<a name="l00366"></a>00366                                                 msymbol);
<a name="l00367"></a>00367         <span class="keywordflow">if</span> (best_pst != NULL)
<a name="l00368"></a>00368           <span class="keywordflow">return</span> best_pst;
<a name="l00369"></a>00369       }
<a name="l00370"></a>00370 
<a name="l00371"></a>00371   <span class="keywordflow">return</span> NULL;
<a name="l00372"></a>00372 }
<a name="l00373"></a>00373 
<a name="l00374"></a>00374 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structsymtab.html">symtab</a> *
<a name="l00375"></a><a class="code" href="psymtab_8c.html#a4bc5ff8b9e909f45bb1fbd3daa21038b">00375</a> <a class="code" href="psymtab_8c.html#a4bc5ff8b9e909f45bb1fbd3daa21038b">find_pc_sect_symtab_from_partial</a> (<span class="keyword">struct</span> objfile *objfile,
<a name="l00376"></a>00376                                   <span class="keyword">struct</span> <a class="code" href="structminimal__symbol.html">minimal_symbol</a> *msymbol,
<a name="l00377"></a>00377                                   <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> pc, <span class="keyword">struct</span> <a class="code" href="structobj__section.html">obj_section</a> *section,
<a name="l00378"></a>00378                                   <span class="keywordtype">int</span> warn_if_readin)
<a name="l00379"></a>00379 {
<a name="l00380"></a>00380   <span class="keyword">struct </span><a class="code" href="structpartial__symtab.html">partial_symtab</a> *<a class="code" href="namespacecleanup__check.html#a2f9ce522b7667bef19a5777d12fa44d8">ps</a> = <a class="code" href="psymtab_8c.html#ab2b27021abdd583e28f866f03bb4628a">find_pc_sect_psymtab</a> (objfile, pc, section,
<a name="l00381"></a>00381                                                     msymbol);
<a name="l00382"></a>00382   <span class="keywordflow">if</span> (ps)
<a name="l00383"></a>00383     {
<a name="l00384"></a>00384       <span class="keywordflow">if</span> (warn_if_readin &amp;&amp; ps-&gt;<a class="code" href="structpartial__symtab.html#a11d8e59b962db1317c8c23f917dbed42">readin</a>)
<a name="l00385"></a>00385         <span class="comment">/* Might want to error() here (in case symtab is corrupt and</span>
<a name="l00386"></a>00386 <span class="comment">           will cause a core dump), but maybe we can successfully</span>
<a name="l00387"></a>00387 <span class="comment">           continue, so let&#39;s not.  */</span>
<a name="l00388"></a>00388         <a class="code" href="utils_8c.html#a5fc201a4181499a6b4057a6caa15b5e2">warning</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l00389"></a>00389 <span class="stringliteral">(Internal error: pc %s in read in psymtab, but not in symtab.)\n&quot;</span>),
<a name="l00390"></a>00390                  <a class="code" href="utils_8c.html#ab5c76d72090f01d3848b63dda4e37d1c">paddress</a> (<a class="code" href="objfiles_8c.html#a1c7101234ac2edc601fa465e48bc3463">get_objfile_arch</a> (objfile), pc));
<a name="l00391"></a>00391       <a class="code" href="psymtab_8c.html#a9afb9c706b9a9f25e4395b9a95ce4c8a">psymtab_to_symtab</a> (objfile, ps);
<a name="l00392"></a>00392       <span class="keywordflow">return</span> ps-&gt;<a class="code" href="structpartial__symtab.html#a1bbcf18c88d09005b43f960b6f3575f8">symtab</a>;
<a name="l00393"></a>00393     }
<a name="l00394"></a>00394   <span class="keywordflow">return</span> NULL;
<a name="l00395"></a>00395 }
<a name="l00396"></a>00396 
<a name="l00397"></a>00397 <span class="comment">/* Find which partial symbol within a psymtab matches PC and SECTION.</span>
<a name="l00398"></a>00398 <span class="comment">   Return 0 if none.  */</span>
<a name="l00399"></a>00399 
<a name="l00400"></a>00400 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structpartial__symbol.html">partial_symbol</a> *
<a name="l00401"></a><a class="code" href="psymtab_8c.html#a71291ddf853861e78a63f1324e44aea6">00401</a> <a class="code" href="psymtab_8c.html#a71291ddf853861e78a63f1324e44aea6">find_pc_sect_psymbol</a> (<span class="keyword">struct</span> objfile *objfile,
<a name="l00402"></a>00402                       <span class="keyword">struct</span> <a class="code" href="structpartial__symtab.html">partial_symtab</a> *psymtab, <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> pc,
<a name="l00403"></a>00403                       <span class="keyword">struct</span> <a class="code" href="structobj__section.html">obj_section</a> *section)
<a name="l00404"></a>00404 {
<a name="l00405"></a>00405   <span class="keyword">struct </span><a class="code" href="structpartial__symbol.html">partial_symbol</a> *best = NULL, *<a class="code" href="windows-nat_8c.html#ade66e4ccafbc33b117610bbc0d85feb0">p</a>, **pp;
<a name="l00406"></a>00406   <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> best_pc;
<a name="l00407"></a>00407 
<a name="l00408"></a>00408   <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (psymtab != NULL);
<a name="l00409"></a>00409 
<a name="l00410"></a>00410   <span class="comment">/* Cope with programs that start at address 0.  */</span>
<a name="l00411"></a>00411   best_pc = (psymtab-&gt;<a class="code" href="structpartial__symtab.html#a194e7d3c21d81ce56b81d1fe02e1dbc3">textlow</a> != 0) ? psymtab-&gt;<a class="code" href="structpartial__symtab.html#a194e7d3c21d81ce56b81d1fe02e1dbc3">textlow</a> - 1 : 0;
<a name="l00412"></a>00412 
<a name="l00413"></a>00413   <span class="comment">/* Search the global symbols as well as the static symbols, so that</span>
<a name="l00414"></a>00414 <span class="comment">     find_pc_partial_function doesn&#39;t use a minimal symbol and thus</span>
<a name="l00415"></a>00415 <span class="comment">     cache a bad endaddr.  */</span>
<a name="l00416"></a>00416   for (pp = objfile-&gt;<a class="code" href="structobjfile.html#a5665fb90f8a5d1481cc59ed5cf6a86fa">global_psymbols</a>.<a class="code" href="structpsymbol__allocation__list.html#ac618c483c3ff07162cdfe508abd6034d">list</a> + psymtab-&gt;<a class="code" href="structpartial__symtab.html#ae11f1094416fd506398f4a58fe4fa405">globals_offset</a>;
<a name="l00417"></a>00417     (pp - (objfile-&gt;<a class="code" href="structobjfile.html#a5665fb90f8a5d1481cc59ed5cf6a86fa">global_psymbols</a>.<a class="code" href="structpsymbol__allocation__list.html#ac618c483c3ff07162cdfe508abd6034d">list</a> + psymtab-&gt;<a class="code" href="structpartial__symtab.html#ae11f1094416fd506398f4a58fe4fa405">globals_offset</a>)
<a name="l00418"></a>00418      &lt; psymtab-&gt;<a class="code" href="structpartial__symtab.html#ab26039959ff434afcf130049cfa8d27d">n_global_syms</a>);
<a name="l00419"></a>00419        pp++)
<a name="l00420"></a>00420     {
<a name="l00421"></a>00421       p = *pp;
<a name="l00422"></a>00422       <span class="keywordflow">if</span> (<a class="code" href="symtab_8h.html#a362f2f64212c0c45fb770a3f21ef5ab0">SYMBOL_DOMAIN</a> (p) == <a class="code" href="symtab_8h.html#a5c384cef81c5f50f32caadbfd6974a1aa15693f9d844450eb4bfd4b37114f4aed">VAR_DOMAIN</a>
<a name="l00423"></a>00423           &amp;&amp; <a class="code" href="psympriv_8h.html#acb5399267e28b8e4b2d8294ae490e700">PSYMBOL_CLASS</a> (p) == <a class="code" href="symtab_8h.html#a40bca6cf3ed5cfa15b1275e6750cdda3a1f1e8d54397f35889104cd7766fcec2b">LOC_BLOCK</a>
<a name="l00424"></a>00424           &amp;&amp; pc &gt;= <a class="code" href="symtab_8h.html#abee697b9e3bb4f4d164ad920a87ab854">SYMBOL_VALUE_ADDRESS</a> (p)
<a name="l00425"></a>00425           &amp;&amp; (<a class="code" href="symtab_8h.html#abee697b9e3bb4f4d164ad920a87ab854">SYMBOL_VALUE_ADDRESS</a> (p) &gt; best_pc
<a name="l00426"></a>00426               || (psymtab-&gt;<a class="code" href="structpartial__symtab.html#a194e7d3c21d81ce56b81d1fe02e1dbc3">textlow</a> == 0
<a name="l00427"></a>00427                   &amp;&amp; best_pc == 0 &amp;&amp; <a class="code" href="symtab_8h.html#abee697b9e3bb4f4d164ad920a87ab854">SYMBOL_VALUE_ADDRESS</a> (p) == 0)))
<a name="l00428"></a>00428         {
<a name="l00429"></a>00429           <span class="keywordflow">if</span> (section)          <span class="comment">/* Match on a specific section.  */</span>
<a name="l00430"></a>00430             {
<a name="l00431"></a>00431               <a class="code" href="psymtab_8c.html#ab6769b1757f156547dec8cdf53b45ad9">fixup_psymbol_section</a> (p, objfile);
<a name="l00432"></a>00432               <span class="keywordflow">if</span> (!<a class="code" href="symtab_8c.html#aca12cb59ef55dcae719eba8f64ffaef7">matching_obj_sections</a> (<a class="code" href="symtab_8h.html#a68f0685d666b6934c762f89d9b996c63">SYMBOL_OBJ_SECTION</a> (objfile, p),
<a name="l00433"></a>00433                                           section))
<a name="l00434"></a>00434                 <span class="keywordflow">continue</span>;
<a name="l00435"></a>00435             }
<a name="l00436"></a>00436           best_pc = <a class="code" href="symtab_8h.html#abee697b9e3bb4f4d164ad920a87ab854">SYMBOL_VALUE_ADDRESS</a> (p);
<a name="l00437"></a>00437           best = p;
<a name="l00438"></a>00438         }
<a name="l00439"></a>00439     }
<a name="l00440"></a>00440 
<a name="l00441"></a>00441   <span class="keywordflow">for</span> (pp = objfile-&gt;<a class="code" href="structobjfile.html#a365549b70c39eb429e3103991da9b3e6">static_psymbols</a>.<a class="code" href="structpsymbol__allocation__list.html#ac618c483c3ff07162cdfe508abd6034d">list</a> + psymtab-&gt;<a class="code" href="structpartial__symtab.html#a36b8c771ea2906e413b8f1fffe1f4d10">statics_offset</a>;
<a name="l00442"></a>00442     (pp - (objfile-&gt;<a class="code" href="structobjfile.html#a365549b70c39eb429e3103991da9b3e6">static_psymbols</a>.<a class="code" href="structpsymbol__allocation__list.html#ac618c483c3ff07162cdfe508abd6034d">list</a> + psymtab-&gt;<a class="code" href="structpartial__symtab.html#a36b8c771ea2906e413b8f1fffe1f4d10">statics_offset</a>)
<a name="l00443"></a>00443      &lt; psymtab-&gt;<a class="code" href="structpartial__symtab.html#a0fd67e243d440beaf6cc4757a97ff9b0">n_static_syms</a>);
<a name="l00444"></a>00444        pp++)
<a name="l00445"></a>00445     {
<a name="l00446"></a>00446       p = *pp;
<a name="l00447"></a>00447       <span class="keywordflow">if</span> (<a class="code" href="symtab_8h.html#a362f2f64212c0c45fb770a3f21ef5ab0">SYMBOL_DOMAIN</a> (p) == <a class="code" href="symtab_8h.html#a5c384cef81c5f50f32caadbfd6974a1aa15693f9d844450eb4bfd4b37114f4aed">VAR_DOMAIN</a>
<a name="l00448"></a>00448           &amp;&amp; <a class="code" href="psympriv_8h.html#acb5399267e28b8e4b2d8294ae490e700">PSYMBOL_CLASS</a> (p) == <a class="code" href="symtab_8h.html#a40bca6cf3ed5cfa15b1275e6750cdda3a1f1e8d54397f35889104cd7766fcec2b">LOC_BLOCK</a>
<a name="l00449"></a>00449           &amp;&amp; pc &gt;= <a class="code" href="symtab_8h.html#abee697b9e3bb4f4d164ad920a87ab854">SYMBOL_VALUE_ADDRESS</a> (p)
<a name="l00450"></a>00450           &amp;&amp; (<a class="code" href="symtab_8h.html#abee697b9e3bb4f4d164ad920a87ab854">SYMBOL_VALUE_ADDRESS</a> (p) &gt; best_pc
<a name="l00451"></a>00451               || (psymtab-&gt;<a class="code" href="structpartial__symtab.html#a194e7d3c21d81ce56b81d1fe02e1dbc3">textlow</a> == 0
<a name="l00452"></a>00452                   &amp;&amp; best_pc == 0 &amp;&amp; <a class="code" href="symtab_8h.html#abee697b9e3bb4f4d164ad920a87ab854">SYMBOL_VALUE_ADDRESS</a> (p) == 0)))
<a name="l00453"></a>00453         {
<a name="l00454"></a>00454           <span class="keywordflow">if</span> (section)          <span class="comment">/* Match on a specific section.  */</span>
<a name="l00455"></a>00455             {
<a name="l00456"></a>00456               <a class="code" href="psymtab_8c.html#ab6769b1757f156547dec8cdf53b45ad9">fixup_psymbol_section</a> (p, objfile);
<a name="l00457"></a>00457               <span class="keywordflow">if</span> (!<a class="code" href="symtab_8c.html#aca12cb59ef55dcae719eba8f64ffaef7">matching_obj_sections</a> (<a class="code" href="symtab_8h.html#a68f0685d666b6934c762f89d9b996c63">SYMBOL_OBJ_SECTION</a> (objfile, p),
<a name="l00458"></a>00458                                           section))
<a name="l00459"></a>00459                 <span class="keywordflow">continue</span>;
<a name="l00460"></a>00460             }
<a name="l00461"></a>00461           best_pc = <a class="code" href="symtab_8h.html#abee697b9e3bb4f4d164ad920a87ab854">SYMBOL_VALUE_ADDRESS</a> (p);
<a name="l00462"></a>00462           best = p;
<a name="l00463"></a>00463         }
<a name="l00464"></a>00464     }
<a name="l00465"></a>00465 
<a name="l00466"></a>00466   <span class="keywordflow">return</span> best;
<a name="l00467"></a>00467 }
<a name="l00468"></a>00468 
<a name="l00469"></a>00469 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00470"></a><a class="code" href="psymtab_8c.html#ab6769b1757f156547dec8cdf53b45ad9">00470</a> <a class="code" href="psymtab_8c.html#ab6769b1757f156547dec8cdf53b45ad9">fixup_psymbol_section</a> (<span class="keyword">struct</span> <a class="code" href="structpartial__symbol.html">partial_symbol</a> *psym, <span class="keyword">struct</span> objfile *objfile)
<a name="l00471"></a>00471 {
<a name="l00472"></a>00472   <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> addr;
<a name="l00473"></a>00473 
<a name="l00474"></a>00474   <span class="keywordflow">if</span> (!psym)
<a name="l00475"></a>00475     <span class="keywordflow">return</span>;
<a name="l00476"></a>00476 
<a name="l00477"></a>00477   <span class="keywordflow">if</span> (<a class="code" href="symtab_8h.html#a9e82ed3317c58c4b85104d87e738fada">SYMBOL_SECTION</a> (psym) &gt;= 0)
<a name="l00478"></a>00478     <span class="keywordflow">return</span>;
<a name="l00479"></a>00479 
<a name="l00480"></a>00480   <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (objfile);
<a name="l00481"></a>00481 
<a name="l00482"></a>00482   <span class="keywordflow">switch</span> (<a class="code" href="psympriv_8h.html#acb5399267e28b8e4b2d8294ae490e700">PSYMBOL_CLASS</a> (psym))
<a name="l00483"></a>00483     {
<a name="l00484"></a>00484     <span class="keywordflow">case</span> <a class="code" href="symtab_8h.html#a40bca6cf3ed5cfa15b1275e6750cdda3a154b256439f7acd7ec7f6257d5881a0f">LOC_STATIC</a>:
<a name="l00485"></a>00485     <span class="keywordflow">case</span> <a class="code" href="symtab_8h.html#a40bca6cf3ed5cfa15b1275e6750cdda3a246b44ddd9acee8dac2a7d9d2c5d7c6e">LOC_LABEL</a>:
<a name="l00486"></a>00486     <span class="keywordflow">case</span> <a class="code" href="symtab_8h.html#a40bca6cf3ed5cfa15b1275e6750cdda3a1f1e8d54397f35889104cd7766fcec2b">LOC_BLOCK</a>:
<a name="l00487"></a>00487       addr = <a class="code" href="symtab_8h.html#abee697b9e3bb4f4d164ad920a87ab854">SYMBOL_VALUE_ADDRESS</a> (psym);
<a name="l00488"></a>00488       <span class="keywordflow">break</span>;
<a name="l00489"></a>00489     <span class="keywordflow">default</span>:
<a name="l00490"></a>00490       <span class="comment">/* Nothing else will be listed in the minsyms -- no use looking</span>
<a name="l00491"></a>00491 <span class="comment">         it up.  */</span>
<a name="l00492"></a>00492       <span class="keywordflow">return</span>;
<a name="l00493"></a>00493     }
<a name="l00494"></a>00494 
<a name="l00495"></a>00495   <a class="code" href="symtab_8c.html#a30eade6748d986d8b97b8eea6b00fc17">fixup_section</a> (&amp;psym-&gt;<a class="code" href="structpartial__symbol.html#a572d3210ebeea0d15085bd9ed6e153d6">ginfo</a>, addr, objfile);
<a name="l00496"></a>00496 }
<a name="l00497"></a>00497 
<a name="l00498"></a>00498 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structsymtab.html">symtab</a> *
<a name="l00499"></a><a class="code" href="psymtab_8c.html#a3f37b27a6ba097cead8506ccdded18fe">00499</a> <a class="code" href="psymtab_8c.html#a3f37b27a6ba097cead8506ccdded18fe">lookup_symbol_aux_psymtabs</a> (<span class="keyword">struct</span> objfile *objfile,
<a name="l00500"></a>00500                             <span class="keywordtype">int</span> block_index, <span class="keyword">const</span> <span class="keywordtype">char</span> *name,
<a name="l00501"></a>00501                             <span class="keyword">const</span> <a class="code" href="symtab_8h.html#abbcd14557de81830c9e96ea4bdfc14aa">domain_enum</a> domain)
<a name="l00502"></a>00502 {
<a name="l00503"></a>00503   <span class="keyword">struct </span><a class="code" href="structpartial__symtab.html">partial_symtab</a> *<a class="code" href="namespacecleanup__check.html#a2f9ce522b7667bef19a5777d12fa44d8">ps</a>;
<a name="l00504"></a>00504   <span class="keyword">const</span> <span class="keywordtype">int</span> psymtab_index = (block_index == <a class="code" href="defs_8h.html#a8ec407cb404e1ae8ce984f792e83f124a973ee91cbe4b0cee4eb7603252a29bec">GLOBAL_BLOCK</a> ? 1 : 0);
<a name="l00505"></a>00505   <span class="keyword">struct </span><a class="code" href="structsymtab.html">symtab</a> *stab_best = NULL;
<a name="l00506"></a>00506 
<a name="l00507"></a>00507   <a class="code" href="psymtab_8c.html#a3fbd70c118d9b449af634c15717d508e">ALL_OBJFILE_PSYMTABS_REQUIRED</a> (objfile, ps)
<a name="l00508"></a>00508   {
<a name="l00509"></a>00509     <span class="keywordflow">if</span> (!ps-&gt;<a class="code" href="structpartial__symtab.html#a11d8e59b962db1317c8c23f917dbed42">readin</a> &amp;&amp; <a class="code" href="psymtab_8c.html#af55d03c98bc38e536b34403f0ff4429b">lookup_partial_symbol</a> (objfile, ps, name,
<a name="l00510"></a>00510                                               psymtab_index, domain))
<a name="l00511"></a>00511       {
<a name="l00512"></a>00512         <span class="keyword">struct </span><a class="code" href="structsymbol.html">symbol</a> *sym = NULL;
<a name="l00513"></a>00513         <span class="keyword">struct </span><a class="code" href="structsymtab.html">symtab</a> *stab = <a class="code" href="psymtab_8c.html#a9afb9c706b9a9f25e4395b9a95ce4c8a">psymtab_to_symtab</a> (objfile, ps);
<a name="l00514"></a>00514 
<a name="l00515"></a>00515         <span class="comment">/* Some caution must be observed with overloaded functions</span>
<a name="l00516"></a>00516 <span class="comment">           and methods, since the psymtab will not contain any overload</span>
<a name="l00517"></a>00517 <span class="comment">           information (but NAME might contain it).  */</span>
<a name="l00518"></a>00518         <span class="keywordflow">if</span> (stab-&gt;<a class="code" href="structsymtab.html#ac7b1b53ffb88e931203f53942070bc7f">primary</a>)
<a name="l00519"></a>00519           {
<a name="l00520"></a>00520             <span class="keyword">struct </span><a class="code" href="structblockvector.html">blockvector</a> *bv = <a class="code" href="symtab_8h.html#a6cd84410d73680ff8006ac44b1b98a9c">BLOCKVECTOR</a> (stab);
<a name="l00521"></a>00521             <span class="keyword">struct </span><a class="code" href="structblock.html">block</a> *<a class="code" href="structblock.html">block</a> = <a class="code" href="block_8h.html#a84c4a3aa7b6b4d9a127a1c018dd6a776">BLOCKVECTOR_BLOCK</a> (bv, block_index);
<a name="l00522"></a>00522 
<a name="l00523"></a>00523             sym = <a class="code" href="symtab_8c.html#a25f45a38ca9085f0fad46c8cd1394fda">lookup_block_symbol</a> (block, name, domain);
<a name="l00524"></a>00524           }
<a name="l00525"></a>00525 
<a name="l00526"></a>00526         <span class="keywordflow">if</span> (sym &amp;&amp; <a class="code" href="utils_8c.html#afe92387dbf8135978e7845a7dcf18003">strcmp_iw</a> (<a class="code" href="symtab_8h.html#a16e484ff2bd09d4f0400caf5e3f8c3eb">SYMBOL_SEARCH_NAME</a> (sym), name) == 0)
<a name="l00527"></a>00527           {
<a name="l00528"></a>00528             <span class="keywordflow">if</span> (!<a class="code" href="gdbtypes_8h.html#a69344b27f7781ba403f1843600ed386e">TYPE_IS_OPAQUE</a> (<a class="code" href="symtab_8h.html#aadfeb02c4b5fc2b6764ad32eaccf0e58">SYMBOL_TYPE</a> (sym)))
<a name="l00529"></a>00529               <span class="keywordflow">return</span> stab;
<a name="l00530"></a>00530 
<a name="l00531"></a>00531             stab_best = stab;
<a name="l00532"></a>00532           }
<a name="l00533"></a>00533 
<a name="l00534"></a>00534         <span class="comment">/* Keep looking through other psymtabs.  */</span>
<a name="l00535"></a>00535       }
<a name="l00536"></a>00536   }
<a name="l00537"></a>00537 
<a name="l00538"></a>00538   <span class="keywordflow">return</span> stab_best;
<a name="l00539"></a>00539 }
<a name="l00540"></a>00540 
<a name="l00541"></a>00541 <span class="comment">/* Look in PST for a symbol in DOMAIN whose name matches NAME.  Search</span>
<a name="l00542"></a>00542 <span class="comment">   the global block of PST if GLOBAL, and otherwise the static block.</span>
<a name="l00543"></a>00543 <span class="comment">   MATCH is the comparison operation that returns true iff MATCH (s,</span>
<a name="l00544"></a>00544 <span class="comment">   NAME), where s is a SYMBOL_SEARCH_NAME.  If ORDERED_COMPARE is</span>
<a name="l00545"></a>00545 <span class="comment">   non-null, the symbols in the block are assumed to be ordered</span>
<a name="l00546"></a>00546 <span class="comment">   according to it (allowing binary search).  It must be compatible</span>
<a name="l00547"></a>00547 <span class="comment">   with MATCH.  Returns the symbol, if found, and otherwise NULL.  */</span>
<a name="l00548"></a>00548 
<a name="l00549"></a>00549 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structpartial__symbol.html">partial_symbol</a> *
<a name="l00550"></a><a class="code" href="psymtab_8c.html#a858899bc2b0798c6f9d38754434435a7">00550</a> <a class="code" href="psymtab_8c.html#a858899bc2b0798c6f9d38754434435a7">match_partial_symbol</a> (<span class="keyword">struct</span> objfile *objfile,
<a name="l00551"></a>00551                       <span class="keyword">struct</span> <a class="code" href="structpartial__symtab.html">partial_symtab</a> *pst, <span class="keywordtype">int</span> global,
<a name="l00552"></a>00552                       <span class="keyword">const</span> <span class="keywordtype">char</span> *name, <a class="code" href="symtab_8h.html#abbcd14557de81830c9e96ea4bdfc14aa">domain_enum</a> domain,
<a name="l00553"></a>00553                       <a class="code" href="symfile_8h.html#a2b98a5062928ff31e334877e5cf444bd">symbol_compare_ftype</a> *match,
<a name="l00554"></a>00554                       <a class="code" href="symfile_8h.html#a2b98a5062928ff31e334877e5cf444bd">symbol_compare_ftype</a> *ordered_compare)
<a name="l00555"></a>00555 {
<a name="l00556"></a>00556   <span class="keyword">struct </span><a class="code" href="structpartial__symbol.html">partial_symbol</a> **start, **psym;
<a name="l00557"></a>00557   <span class="keyword">struct </span><a class="code" href="structpartial__symbol.html">partial_symbol</a> **top, **real_top, **bottom, **center;
<a name="l00558"></a>00558   <span class="keywordtype">int</span> length = (global ? pst-&gt;<a class="code" href="structpartial__symtab.html#ab26039959ff434afcf130049cfa8d27d">n_global_syms</a> : pst-&gt;<a class="code" href="structpartial__symtab.html#a0fd67e243d440beaf6cc4757a97ff9b0">n_static_syms</a>);
<a name="l00559"></a>00559   <span class="keywordtype">int</span> do_linear_search = 1;
<a name="l00560"></a>00560 
<a name="l00561"></a>00561   <span class="keywordflow">if</span> (length == 0)
<a name="l00562"></a>00562       <span class="keywordflow">return</span> NULL;
<a name="l00563"></a>00563   start = (global ?
<a name="l00564"></a>00564            objfile-&gt;<a class="code" href="structobjfile.html#a5665fb90f8a5d1481cc59ed5cf6a86fa">global_psymbols</a>.<a class="code" href="structpsymbol__allocation__list.html#ac618c483c3ff07162cdfe508abd6034d">list</a> + pst-&gt;<a class="code" href="structpartial__symtab.html#ae11f1094416fd506398f4a58fe4fa405">globals_offset</a> :
<a name="l00565"></a>00565            objfile-&gt;<a class="code" href="structobjfile.html#a365549b70c39eb429e3103991da9b3e6">static_psymbols</a>.<a class="code" href="structpsymbol__allocation__list.html#ac618c483c3ff07162cdfe508abd6034d">list</a> + pst-&gt;<a class="code" href="structpartial__symtab.html#a36b8c771ea2906e413b8f1fffe1f4d10">statics_offset</a>);
<a name="l00566"></a>00566 
<a name="l00567"></a>00567   <span class="keywordflow">if</span> (global &amp;&amp; ordered_compare)  <span class="comment">/* Can use a binary search.  */</span>
<a name="l00568"></a>00568     {
<a name="l00569"></a>00569       do_linear_search = 0;
<a name="l00570"></a>00570 
<a name="l00571"></a>00571       <span class="comment">/* Binary search.  This search is guaranteed to end with center</span>
<a name="l00572"></a>00572 <span class="comment">         pointing at the earliest partial symbol whose name might be</span>
<a name="l00573"></a>00573 <span class="comment">         correct.  At that point *all* partial symbols with an</span>
<a name="l00574"></a>00574 <span class="comment">         appropriate name will be checked against the correct</span>
<a name="l00575"></a>00575 <span class="comment">         domain.  */</span>
<a name="l00576"></a>00576 
<a name="l00577"></a>00577       bottom = start;
<a name="l00578"></a>00578       top = start + length - 1;
<a name="l00579"></a>00579       real_top = top;
<a name="l00580"></a>00580       <span class="keywordflow">while</span> (top &gt; bottom)
<a name="l00581"></a>00581         {
<a name="l00582"></a>00582           center = bottom + (top - bottom) / 2;
<a name="l00583"></a>00583           <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (center &lt; top);
<a name="l00584"></a>00584           <span class="keywordflow">if</span> (!do_linear_search
<a name="l00585"></a>00585               &amp;&amp; (<a class="code" href="symtab_8h.html#a82fc22e60b1007c826a5ebf7d6593e78">SYMBOL_LANGUAGE</a> (*center) == <a class="code" href="defs_8h.html#aa37aa8979934d47ac32fd96ecff32202a12d69481f6d247081bff8287275979ae">language_java</a>))
<a name="l00586"></a>00586             do_linear_search = 1;
<a name="l00587"></a>00587           <span class="keywordflow">if</span> (ordered_compare (<a class="code" href="symtab_8h.html#a16e484ff2bd09d4f0400caf5e3f8c3eb">SYMBOL_SEARCH_NAME</a> (*center), name) &gt;= 0)
<a name="l00588"></a>00588             top = center;
<a name="l00589"></a>00589           <span class="keywordflow">else</span>
<a name="l00590"></a>00590             bottom = center + 1;
<a name="l00591"></a>00591         }
<a name="l00592"></a>00592       <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (top == bottom);
<a name="l00593"></a>00593 
<a name="l00594"></a>00594       <span class="keywordflow">while</span> (top &lt;= real_top
<a name="l00595"></a>00595              &amp;&amp; match (<a class="code" href="symtab_8h.html#a16e484ff2bd09d4f0400caf5e3f8c3eb">SYMBOL_SEARCH_NAME</a> (*top), name) == 0)
<a name="l00596"></a>00596         {
<a name="l00597"></a>00597           <span class="keywordflow">if</span> (<a class="code" href="symtab_8c.html#a0e427a626fe6f76b83881c89fe5e8155">symbol_matches_domain</a> (<a class="code" href="symtab_8h.html#a82fc22e60b1007c826a5ebf7d6593e78">SYMBOL_LANGUAGE</a> (*top),
<a name="l00598"></a>00598                                      <a class="code" href="symtab_8h.html#a362f2f64212c0c45fb770a3f21ef5ab0">SYMBOL_DOMAIN</a> (*top), domain))
<a name="l00599"></a>00599             <span class="keywordflow">return</span> *top;
<a name="l00600"></a>00600           top++;
<a name="l00601"></a>00601         }
<a name="l00602"></a>00602     }
<a name="l00603"></a>00603 
<a name="l00604"></a>00604   <span class="comment">/* Can&#39;t use a binary search or else we found during the binary search that</span>
<a name="l00605"></a>00605 <span class="comment">     we should also do a linear search.  */</span>
<a name="l00606"></a>00606 
<a name="l00607"></a>00607   <span class="keywordflow">if</span> (do_linear_search)
<a name="l00608"></a>00608     {
<a name="l00609"></a>00609       <span class="keywordflow">for</span> (psym = start; psym &lt; start + length; psym++)
<a name="l00610"></a>00610         {
<a name="l00611"></a>00611           <span class="keywordflow">if</span> (<a class="code" href="symtab_8c.html#a0e427a626fe6f76b83881c89fe5e8155">symbol_matches_domain</a> (<a class="code" href="symtab_8h.html#a82fc22e60b1007c826a5ebf7d6593e78">SYMBOL_LANGUAGE</a> (*psym),
<a name="l00612"></a>00612                                      <a class="code" href="symtab_8h.html#a362f2f64212c0c45fb770a3f21ef5ab0">SYMBOL_DOMAIN</a> (*psym), domain)
<a name="l00613"></a>00613               &amp;&amp; match (<a class="code" href="symtab_8h.html#a16e484ff2bd09d4f0400caf5e3f8c3eb">SYMBOL_SEARCH_NAME</a> (*psym), name) == 0)
<a name="l00614"></a>00614             <span class="keywordflow">return</span> *psym;
<a name="l00615"></a>00615         }
<a name="l00616"></a>00616     }
<a name="l00617"></a>00617 
<a name="l00618"></a>00618   <span class="keywordflow">return</span> NULL;
<a name="l00619"></a>00619 }
<a name="l00620"></a>00620 
<a name="l00621"></a>00621 <span class="comment">/* Returns the name used to search psymtabs.  Unlike symtabs, psymtabs do</span>
<a name="l00622"></a>00622 <span class="comment">   not contain any method/function instance information (since this would</span>
<a name="l00623"></a>00623 <span class="comment">   force reading type information while reading psymtabs).  Therefore,</span>
<a name="l00624"></a>00624 <span class="comment">   if NAME contains overload information, it must be stripped before searching</span>
<a name="l00625"></a>00625 <span class="comment">   psymtabs.</span>
<a name="l00626"></a>00626 <span class="comment"></span>
<a name="l00627"></a>00627 <span class="comment">   The caller is responsible for freeing the return result.  */</span>
<a name="l00628"></a>00628 
<a name="l00629"></a>00629 <span class="keyword">static</span> <span class="keywordtype">char</span> *
<a name="l00630"></a><a class="code" href="psymtab_8c.html#aaed0e42acfcf1f78e80d6ce1e52c6aba">00630</a> <a class="code" href="psymtab_8c.html#aaed0e42acfcf1f78e80d6ce1e52c6aba">psymtab_search_name</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> *name)
<a name="l00631"></a>00631 {
<a name="l00632"></a>00632   <span class="keywordflow">switch</span> (<a class="code" href="language_8c.html#acd2505a014a95629da9c836f8914fc79">current_language</a>-&gt;<a class="code" href="structlanguage__defn.html#a1395b7eb05a09e5798dc29257f30810a">la_language</a>)
<a name="l00633"></a>00633     {
<a name="l00634"></a>00634     <span class="keywordflow">case</span> <a class="code" href="defs_8h.html#aa37aa8979934d47ac32fd96ecff32202a44cdc45a15de5e8e690da9ebf1b91132">language_cplus</a>:
<a name="l00635"></a>00635     <span class="keywordflow">case</span> <a class="code" href="defs_8h.html#aa37aa8979934d47ac32fd96ecff32202a12d69481f6d247081bff8287275979ae">language_java</a>:
<a name="l00636"></a>00636       {
<a name="l00637"></a>00637        <span class="keywordflow">if</span> (<a class="code" href="gdb__string_8h.html#adf46aa8f2e08cfb505868bbfc88b5fd4">strchr</a> (name, <span class="charliteral">&#39;(&#39;</span>))
<a name="l00638"></a>00638          {
<a name="l00639"></a>00639            <span class="keywordtype">char</span> *ret = <a class="code" href="cp-support_8c.html#a6a38238179eb06d9c4927adf4385b2e7">cp_remove_params</a> (name);
<a name="l00640"></a>00640 
<a name="l00641"></a>00641            <span class="keywordflow">if</span> (ret)
<a name="l00642"></a>00642              <span class="keywordflow">return</span> ret;
<a name="l00643"></a>00643          }
<a name="l00644"></a>00644       }
<a name="l00645"></a>00645       <span class="keywordflow">break</span>;
<a name="l00646"></a>00646 
<a name="l00647"></a>00647     <span class="keywordflow">default</span>:
<a name="l00648"></a>00648       <span class="keywordflow">break</span>;
<a name="l00649"></a>00649     }
<a name="l00650"></a>00650 
<a name="l00651"></a>00651   <span class="keywordflow">return</span> xstrdup (name);
<a name="l00652"></a>00652 }
<a name="l00653"></a>00653 
<a name="l00654"></a>00654 <span class="comment">/* Look, in partial_symtab PST, for symbol whose natural name is NAME.</span>
<a name="l00655"></a>00655 <span class="comment">   Check the global symbols if GLOBAL, the static symbols if not.  */</span>
<a name="l00656"></a>00656 
<a name="l00657"></a>00657 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structpartial__symbol.html">partial_symbol</a> *
<a name="l00658"></a><a class="code" href="psymtab_8c.html#af55d03c98bc38e536b34403f0ff4429b">00658</a> <a class="code" href="psymtab_8c.html#af55d03c98bc38e536b34403f0ff4429b">lookup_partial_symbol</a> (<span class="keyword">struct</span> objfile *objfile,
<a name="l00659"></a>00659                        <span class="keyword">struct</span> <a class="code" href="structpartial__symtab.html">partial_symtab</a> *pst, <span class="keyword">const</span> <span class="keywordtype">char</span> *name,
<a name="l00660"></a>00660                        <span class="keywordtype">int</span> global, <a class="code" href="symtab_8h.html#abbcd14557de81830c9e96ea4bdfc14aa">domain_enum</a> domain)
<a name="l00661"></a>00661 {
<a name="l00662"></a>00662   <span class="keyword">struct </span><a class="code" href="structpartial__symbol.html">partial_symbol</a> **start, **psym;
<a name="l00663"></a>00663   <span class="keyword">struct </span><a class="code" href="structpartial__symbol.html">partial_symbol</a> **top, **real_top, **bottom, **center;
<a name="l00664"></a>00664   <span class="keywordtype">int</span> length = (global ? pst-&gt;<a class="code" href="structpartial__symtab.html#ab26039959ff434afcf130049cfa8d27d">n_global_syms</a> : pst-&gt;<a class="code" href="structpartial__symtab.html#a0fd67e243d440beaf6cc4757a97ff9b0">n_static_syms</a>);
<a name="l00665"></a>00665   <span class="keywordtype">int</span> do_linear_search = 1;
<a name="l00666"></a>00666   <span class="keywordtype">char</span> *search_name;
<a name="l00667"></a>00667   <span class="keyword">struct </span><a class="code" href="structcleanup.html">cleanup</a> *<a class="code" href="structcleanup.html">cleanup</a>;
<a name="l00668"></a>00668 
<a name="l00669"></a>00669   <span class="keywordflow">if</span> (length == 0)
<a name="l00670"></a>00670     {
<a name="l00671"></a>00671       <span class="keywordflow">return</span> (NULL);
<a name="l00672"></a>00672     }
<a name="l00673"></a>00673 
<a name="l00674"></a>00674   search_name = <a class="code" href="psymtab_8c.html#aaed0e42acfcf1f78e80d6ce1e52c6aba">psymtab_search_name</a> (name);
<a name="l00675"></a>00675   cleanup = <a class="code" href="cleanups_8c.html#a3d418f8af424aec399898c2d48b26224">make_cleanup</a> (<a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a>, search_name);
<a name="l00676"></a>00676   start = (global ?
<a name="l00677"></a>00677            objfile-&gt;<a class="code" href="structobjfile.html#a5665fb90f8a5d1481cc59ed5cf6a86fa">global_psymbols</a>.<a class="code" href="structpsymbol__allocation__list.html#ac618c483c3ff07162cdfe508abd6034d">list</a> + pst-&gt;<a class="code" href="structpartial__symtab.html#ae11f1094416fd506398f4a58fe4fa405">globals_offset</a> :
<a name="l00678"></a>00678            objfile-&gt;<a class="code" href="structobjfile.html#a365549b70c39eb429e3103991da9b3e6">static_psymbols</a>.<a class="code" href="structpsymbol__allocation__list.html#ac618c483c3ff07162cdfe508abd6034d">list</a> + pst-&gt;<a class="code" href="structpartial__symtab.html#a36b8c771ea2906e413b8f1fffe1f4d10">statics_offset</a>);
<a name="l00679"></a>00679 
<a name="l00680"></a>00680   <span class="keywordflow">if</span> (global)                   <span class="comment">/* This means we can use a binary search.  */</span>
<a name="l00681"></a>00681     {
<a name="l00682"></a>00682       do_linear_search = 0;
<a name="l00683"></a>00683 
<a name="l00684"></a>00684       <span class="comment">/* Binary search.  This search is guaranteed to end with center</span>
<a name="l00685"></a>00685 <span class="comment">         pointing at the earliest partial symbol whose name might be</span>
<a name="l00686"></a>00686 <span class="comment">         correct.  At that point *all* partial symbols with an</span>
<a name="l00687"></a>00687 <span class="comment">         appropriate name will be checked against the correct</span>
<a name="l00688"></a>00688 <span class="comment">         domain.  */</span>
<a name="l00689"></a>00689 
<a name="l00690"></a>00690       bottom = start;
<a name="l00691"></a>00691       top = start + length - 1;
<a name="l00692"></a>00692       real_top = top;
<a name="l00693"></a>00693       <span class="keywordflow">while</span> (top &gt; bottom)
<a name="l00694"></a>00694         {
<a name="l00695"></a>00695           center = bottom + (top - bottom) / 2;
<a name="l00696"></a>00696           <span class="keywordflow">if</span> (!(center &lt; top))
<a name="l00697"></a>00697             <a class="code" href="common-utils_8h.html#aa14285d9d3d4171016ef9cf09447e8bb">internal_error</a> (__FILE__, __LINE__,
<a name="l00698"></a>00698                             <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;failed internal consistency check&quot;</span>));
<a name="l00699"></a>00699           <span class="keywordflow">if</span> (!do_linear_search
<a name="l00700"></a>00700               &amp;&amp; <a class="code" href="symtab_8h.html#a82fc22e60b1007c826a5ebf7d6593e78">SYMBOL_LANGUAGE</a> (*center) == <a class="code" href="defs_8h.html#aa37aa8979934d47ac32fd96ecff32202a12d69481f6d247081bff8287275979ae">language_java</a>)
<a name="l00701"></a>00701             {
<a name="l00702"></a>00702               do_linear_search = 1;
<a name="l00703"></a>00703             }
<a name="l00704"></a>00704           <span class="keywordflow">if</span> (<a class="code" href="utils_8c.html#a75e0024041a6c68cde74b1ee53a5e55e">strcmp_iw_ordered</a> (<a class="code" href="symtab_8h.html#a16e484ff2bd09d4f0400caf5e3f8c3eb">SYMBOL_SEARCH_NAME</a> (*center),
<a name="l00705"></a>00705                                  search_name) &gt;= 0)
<a name="l00706"></a>00706             {
<a name="l00707"></a>00707               top = center;
<a name="l00708"></a>00708             }
<a name="l00709"></a>00709           <span class="keywordflow">else</span>
<a name="l00710"></a>00710             {
<a name="l00711"></a>00711               bottom = center + 1;
<a name="l00712"></a>00712             }
<a name="l00713"></a>00713         }
<a name="l00714"></a>00714       <span class="keywordflow">if</span> (!(top == bottom))
<a name="l00715"></a>00715         <a class="code" href="common-utils_8h.html#aa14285d9d3d4171016ef9cf09447e8bb">internal_error</a> (__FILE__, __LINE__,
<a name="l00716"></a>00716                         <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;failed internal consistency check&quot;</span>));
<a name="l00717"></a>00717 
<a name="l00718"></a>00718       <span class="comment">/* For `case_sensitivity == case_sensitive_off&#39; strcmp_iw_ordered will</span>
<a name="l00719"></a>00719 <span class="comment">         search more exactly than what matches SYMBOL_MATCHES_SEARCH_NAME.  */</span>
<a name="l00720"></a>00720       <span class="keywordflow">while</span> (top &gt;= start &amp;&amp; <a class="code" href="symtab_8h.html#af85f137c3945370e82ec73705f272556">SYMBOL_MATCHES_SEARCH_NAME</a> (*top, search_name))
<a name="l00721"></a>00721         top--;
<a name="l00722"></a>00722 
<a name="l00723"></a>00723       <span class="comment">/* Fixup to have a symbol which matches SYMBOL_MATCHES_SEARCH_NAME.  */</span>
<a name="l00724"></a>00724       top++;
<a name="l00725"></a>00725 
<a name="l00726"></a>00726       <span class="keywordflow">while</span> (top &lt;= real_top &amp;&amp; <a class="code" href="symtab_8h.html#af85f137c3945370e82ec73705f272556">SYMBOL_MATCHES_SEARCH_NAME</a> (*top, search_name))
<a name="l00727"></a>00727         {
<a name="l00728"></a>00728           <span class="keywordflow">if</span> (<a class="code" href="symtab_8c.html#a0e427a626fe6f76b83881c89fe5e8155">symbol_matches_domain</a> (<a class="code" href="symtab_8h.html#a82fc22e60b1007c826a5ebf7d6593e78">SYMBOL_LANGUAGE</a> (*top),
<a name="l00729"></a>00729                                      <a class="code" href="symtab_8h.html#a362f2f64212c0c45fb770a3f21ef5ab0">SYMBOL_DOMAIN</a> (*top), domain))
<a name="l00730"></a>00730             {
<a name="l00731"></a>00731               <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (cleanup);
<a name="l00732"></a>00732               <span class="keywordflow">return</span> (*top);
<a name="l00733"></a>00733             }
<a name="l00734"></a>00734           top++;
<a name="l00735"></a>00735         }
<a name="l00736"></a>00736     }
<a name="l00737"></a>00737 
<a name="l00738"></a>00738   <span class="comment">/* Can&#39;t use a binary search or else we found during the binary search that</span>
<a name="l00739"></a>00739 <span class="comment">     we should also do a linear search.  */</span>
<a name="l00740"></a>00740 
<a name="l00741"></a>00741   <span class="keywordflow">if</span> (do_linear_search)
<a name="l00742"></a>00742     {
<a name="l00743"></a>00743       <span class="keywordflow">for</span> (psym = start; psym &lt; start + length; psym++)
<a name="l00744"></a>00744         {
<a name="l00745"></a>00745           <span class="keywordflow">if</span> (<a class="code" href="symtab_8c.html#a0e427a626fe6f76b83881c89fe5e8155">symbol_matches_domain</a> (<a class="code" href="symtab_8h.html#a82fc22e60b1007c826a5ebf7d6593e78">SYMBOL_LANGUAGE</a> (*psym),
<a name="l00746"></a>00746                                      <a class="code" href="symtab_8h.html#a362f2f64212c0c45fb770a3f21ef5ab0">SYMBOL_DOMAIN</a> (*psym), domain)
<a name="l00747"></a>00747               &amp;&amp; <a class="code" href="symtab_8h.html#af85f137c3945370e82ec73705f272556">SYMBOL_MATCHES_SEARCH_NAME</a> (*psym, search_name))
<a name="l00748"></a>00748             {
<a name="l00749"></a>00749               <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (cleanup);
<a name="l00750"></a>00750               <span class="keywordflow">return</span> (*psym);
<a name="l00751"></a>00751             }
<a name="l00752"></a>00752         }
<a name="l00753"></a>00753     }
<a name="l00754"></a>00754 
<a name="l00755"></a>00755   <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (cleanup);
<a name="l00756"></a>00756   <span class="keywordflow">return</span> (NULL);
<a name="l00757"></a>00757 }
<a name="l00758"></a>00758 
<a name="l00759"></a>00759 <span class="comment">/* Get the symbol table that corresponds to a partial_symtab.</span>
<a name="l00760"></a>00760 <span class="comment">   This is fast after the first time you do it.  */</span>
<a name="l00761"></a>00761 
<a name="l00762"></a>00762 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structsymtab.html">symtab</a> *
<a name="l00763"></a><a class="code" href="psymtab_8c.html#a9afb9c706b9a9f25e4395b9a95ce4c8a">00763</a> <a class="code" href="psymtab_8c.html#a9afb9c706b9a9f25e4395b9a95ce4c8a">psymtab_to_symtab</a> (<span class="keyword">struct</span> objfile *objfile, <span class="keyword">struct</span> <a class="code" href="structpartial__symtab.html">partial_symtab</a> *pst)
<a name="l00764"></a>00764 {
<a name="l00765"></a>00765   <span class="comment">/* If it is a shared psymtab, find an unshared psymtab that includes</span>
<a name="l00766"></a>00766 <span class="comment">     it.  Any such psymtab will do.  */</span>
<a name="l00767"></a>00767   <span class="keywordflow">while</span> (pst-&gt;<a class="code" href="structpartial__symtab.html#a0609b1a2e29b3419dc25520e7d7293f0">user</a> != NULL)
<a name="l00768"></a>00768     pst = pst-&gt;<a class="code" href="structpartial__symtab.html#a0609b1a2e29b3419dc25520e7d7293f0">user</a>;
<a name="l00769"></a>00769 
<a name="l00770"></a>00770   <span class="comment">/* If it&#39;s been looked up before, return it.  */</span>
<a name="l00771"></a>00771   <span class="keywordflow">if</span> (pst-&gt;<a class="code" href="structpartial__symtab.html#a1bbcf18c88d09005b43f960b6f3575f8">symtab</a>)
<a name="l00772"></a>00772     <span class="keywordflow">return</span> pst-&gt;<a class="code" href="structpartial__symtab.html#a1bbcf18c88d09005b43f960b6f3575f8">symtab</a>;
<a name="l00773"></a>00773 
<a name="l00774"></a>00774   <span class="comment">/* If it has not yet been read in, read it.  */</span>
<a name="l00775"></a>00775   <span class="keywordflow">if</span> (!pst-&gt;<a class="code" href="structpartial__symtab.html#a11d8e59b962db1317c8c23f917dbed42">readin</a>)
<a name="l00776"></a>00776     {
<a name="l00777"></a>00777       <span class="keyword">struct </span><a class="code" href="structcleanup.html">cleanup</a> *back_to = <a class="code" href="symfile_8c.html#abdb94eda660bee43eb668a16fef021af">increment_reading_symtab</a> ();
<a name="l00778"></a>00778 
<a name="l00779"></a>00779       (*pst-&gt;<a class="code" href="structpartial__symtab.html#a51a53dce450ff3473f03a903aa06b263">read_symtab</a>) (pst, objfile);
<a name="l00780"></a>00780       <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (back_to);
<a name="l00781"></a>00781     }
<a name="l00782"></a>00782 
<a name="l00783"></a>00783   <span class="keywordflow">return</span> pst-&gt;<a class="code" href="structpartial__symtab.html#a1bbcf18c88d09005b43f960b6f3575f8">symtab</a>;
<a name="l00784"></a>00784 }
<a name="l00785"></a>00785 
<a name="l00786"></a>00786 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00787"></a><a class="code" href="psymtab_8c.html#a1a7f71f4c1748ebc9a0cadc768f0ba8e">00787</a> <a class="code" href="psymtab_8c.html#a1a7f71f4c1748ebc9a0cadc768f0ba8e">relocate_psymtabs</a> (<span class="keyword">struct</span> objfile *objfile,
<a name="l00788"></a>00788                    <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structsection__offsets.html">section_offsets</a> *new_offsets,
<a name="l00789"></a>00789                    <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structsection__offsets.html">section_offsets</a> *delta)
<a name="l00790"></a>00790 {
<a name="l00791"></a>00791   <span class="keyword">struct </span><a class="code" href="structpartial__symbol.html">partial_symbol</a> **psym;
<a name="l00792"></a>00792   <span class="keyword">struct </span><a class="code" href="structpartial__symtab.html">partial_symtab</a> *<a class="code" href="windows-nat_8c.html#ade66e4ccafbc33b117610bbc0d85feb0">p</a>;
<a name="l00793"></a>00793 
<a name="l00794"></a>00794   <a class="code" href="psymtab_8c.html#a3fbd70c118d9b449af634c15717d508e">ALL_OBJFILE_PSYMTABS_REQUIRED</a> (objfile, p)
<a name="l00795"></a>00795     {
<a name="l00796"></a>00796       p-&gt;<a class="code" href="structpartial__symtab.html#a194e7d3c21d81ce56b81d1fe02e1dbc3">textlow</a> += <a class="code" href="symtab_8h.html#ab72b539d710f3a5a3857df5d387c4af3">ANOFFSET</a> (delta, <a class="code" href="objfiles_8h.html#a83de51cc69bcdda3864a605b939a518e">SECT_OFF_TEXT</a> (objfile));
<a name="l00797"></a>00797       p-&gt;<a class="code" href="structpartial__symtab.html#aa582095c68fb326f3042ad672527a438">texthigh</a> += <a class="code" href="symtab_8h.html#ab72b539d710f3a5a3857df5d387c4af3">ANOFFSET</a> (delta, <a class="code" href="objfiles_8h.html#a83de51cc69bcdda3864a605b939a518e">SECT_OFF_TEXT</a> (objfile));
<a name="l00798"></a>00798     }
<a name="l00799"></a>00799 
<a name="l00800"></a>00800   <span class="keywordflow">for</span> (psym = objfile-&gt;<a class="code" href="structobjfile.html#a5665fb90f8a5d1481cc59ed5cf6a86fa">global_psymbols</a>.<a class="code" href="structpsymbol__allocation__list.html#ac618c483c3ff07162cdfe508abd6034d">list</a>;
<a name="l00801"></a>00801        psym &lt; objfile-&gt;global_psymbols.next;
<a name="l00802"></a>00802        psym++)
<a name="l00803"></a>00803     {
<a name="l00804"></a>00804       <a class="code" href="psymtab_8c.html#ab6769b1757f156547dec8cdf53b45ad9">fixup_psymbol_section</a> (*psym, objfile);
<a name="l00805"></a>00805       <span class="keywordflow">if</span> (<a class="code" href="symtab_8h.html#a9e82ed3317c58c4b85104d87e738fada">SYMBOL_SECTION</a> (*psym) &gt;= 0)
<a name="l00806"></a>00806         <a class="code" href="symtab_8h.html#abee697b9e3bb4f4d164ad920a87ab854">SYMBOL_VALUE_ADDRESS</a> (*psym) += <a class="code" href="symtab_8h.html#ab72b539d710f3a5a3857df5d387c4af3">ANOFFSET</a> (delta,
<a name="l00807"></a>00807                                                   <a class="code" href="symtab_8h.html#a9e82ed3317c58c4b85104d87e738fada">SYMBOL_SECTION</a> (*psym));
<a name="l00808"></a>00808     }
<a name="l00809"></a>00809   <span class="keywordflow">for</span> (psym = objfile-&gt;<a class="code" href="structobjfile.html#a365549b70c39eb429e3103991da9b3e6">static_psymbols</a>.<a class="code" href="structpsymbol__allocation__list.html#ac618c483c3ff07162cdfe508abd6034d">list</a>;
<a name="l00810"></a>00810        psym &lt; objfile-&gt;static_psymbols.next;
<a name="l00811"></a>00811        psym++)
<a name="l00812"></a>00812     {
<a name="l00813"></a>00813       <a class="code" href="psymtab_8c.html#ab6769b1757f156547dec8cdf53b45ad9">fixup_psymbol_section</a> (*psym, objfile);
<a name="l00814"></a>00814       <span class="keywordflow">if</span> (<a class="code" href="symtab_8h.html#a9e82ed3317c58c4b85104d87e738fada">SYMBOL_SECTION</a> (*psym) &gt;= 0)
<a name="l00815"></a>00815         <a class="code" href="symtab_8h.html#abee697b9e3bb4f4d164ad920a87ab854">SYMBOL_VALUE_ADDRESS</a> (*psym) += <a class="code" href="symtab_8h.html#ab72b539d710f3a5a3857df5d387c4af3">ANOFFSET</a> (delta,
<a name="l00816"></a>00816                                                   <a class="code" href="symtab_8h.html#a9e82ed3317c58c4b85104d87e738fada">SYMBOL_SECTION</a> (*psym));
<a name="l00817"></a>00817     }
<a name="l00818"></a>00818 }
<a name="l00819"></a>00819 
<a name="l00820"></a>00820 <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structsymtab.html">symtab</a> *
<a name="l00821"></a><a class="code" href="psymtab_8c.html#ab6fe688d3a6286282558045e8eca3016">00821</a> <a class="code" href="psymtab_8c.html#ab6fe688d3a6286282558045e8eca3016">find_last_source_symtab_from_partial</a> (<span class="keyword">struct</span> objfile *ofp)
<a name="l00822"></a>00822 {
<a name="l00823"></a>00823   <span class="keyword">struct </span><a class="code" href="structpartial__symtab.html">partial_symtab</a> *<a class="code" href="namespacecleanup__check.html#a2f9ce522b7667bef19a5777d12fa44d8">ps</a>;
<a name="l00824"></a>00824   <span class="keyword">struct </span><a class="code" href="structpartial__symtab.html">partial_symtab</a> *cs_pst = 0;
<a name="l00825"></a>00825 
<a name="l00826"></a>00826   <a class="code" href="psymtab_8c.html#a3fbd70c118d9b449af634c15717d508e">ALL_OBJFILE_PSYMTABS_REQUIRED</a> (ofp, ps)
<a name="l00827"></a>00827     {
<a name="l00828"></a>00828       <span class="keyword">const</span> <span class="keywordtype">char</span> *name = ps-&gt;<a class="code" href="structpartial__symtab.html#a6ea70ac87d6dbd541967bdd6dacd7321">filename</a>;
<a name="l00829"></a>00829       <span class="keywordtype">int</span> <a class="code" href="exec_8h.html#a00f945351279d3c8935f13d2b9f9b808">len</a> = strlen (name);
<a name="l00830"></a>00830 
<a name="l00831"></a>00831       <span class="keywordflow">if</span> (!(len &gt; 2 &amp;&amp; (strcmp (&amp;name[len - 2], <span class="stringliteral">&quot;.h&quot;</span>) == 0
<a name="l00832"></a>00832                         || strcmp (name, <span class="stringliteral">&quot;&lt;&lt;C++-namespaces&gt;&gt;&quot;</span>) == 0)))
<a name="l00833"></a>00833         cs_pst = <a class="code" href="namespacecleanup__check.html#a2f9ce522b7667bef19a5777d12fa44d8">ps</a>;
<a name="l00834"></a>00834     }
<a name="l00835"></a>00835 
<a name="l00836"></a>00836   <span class="keywordflow">if</span> (cs_pst)
<a name="l00837"></a>00837     {
<a name="l00838"></a>00838       <span class="keywordflow">if</span> (cs_pst-&gt;<a class="code" href="structpartial__symtab.html#a11d8e59b962db1317c8c23f917dbed42">readin</a>)
<a name="l00839"></a>00839         {
<a name="l00840"></a>00840           <a class="code" href="common-utils_8h.html#aa14285d9d3d4171016ef9cf09447e8bb">internal_error</a> (__FILE__, __LINE__,
<a name="l00841"></a>00841                           <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;select_source_symtab: &quot;</span>
<a name="l00842"></a>00842                           <span class="stringliteral">&quot;readin pst found and no symtabs.&quot;</span>));
<a name="l00843"></a>00843         }
<a name="l00844"></a>00844       <span class="keywordflow">else</span>
<a name="l00845"></a>00845         <span class="keywordflow">return</span> <a class="code" href="psymtab_8c.html#a9afb9c706b9a9f25e4395b9a95ce4c8a">psymtab_to_symtab</a> (ofp, cs_pst);
<a name="l00846"></a>00846     }
<a name="l00847"></a>00847   <span class="keywordflow">return</span> NULL;
<a name="l00848"></a>00848 }
<a name="l00849"></a>00849 
<a name="l00850"></a>00850 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00851"></a><a class="code" href="psymtab_8c.html#a898bad350618f20404dc2f93a87b1220">00851</a> <a class="code" href="psymtab_8c.html#a898bad350618f20404dc2f93a87b1220">forget_cached_source_info_partial</a> (<span class="keyword">struct</span> objfile *objfile)
<a name="l00852"></a>00852 {
<a name="l00853"></a>00853   <span class="keyword">struct </span><a class="code" href="structpartial__symtab.html">partial_symtab</a> *pst;
<a name="l00854"></a>00854 
<a name="l00855"></a>00855   <a class="code" href="psymtab_8c.html#a3fbd70c118d9b449af634c15717d508e">ALL_OBJFILE_PSYMTABS_REQUIRED</a> (objfile, pst)
<a name="l00856"></a>00856     {
<a name="l00857"></a>00857       <span class="keywordflow">if</span> (pst-&gt;<a class="code" href="structpartial__symtab.html#aeaaef4856b449061d28624055c9c70d6">fullname</a> != NULL)
<a name="l00858"></a>00858         {
<a name="l00859"></a>00859           <a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a> (pst-&gt;<a class="code" href="structpartial__symtab.html#aeaaef4856b449061d28624055c9c70d6">fullname</a>);
<a name="l00860"></a>00860           pst-&gt;<a class="code" href="structpartial__symtab.html#aeaaef4856b449061d28624055c9c70d6">fullname</a> = NULL;
<a name="l00861"></a>00861         }
<a name="l00862"></a>00862     }
<a name="l00863"></a>00863 }
<a name="l00864"></a>00864 
<a name="l00865"></a>00865 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00866"></a><a class="code" href="psymtab_8c.html#a228d1d480894193c8f04d1d55f99cab9">00866</a> <a class="code" href="psymtab_8c.html#a228d1d480894193c8f04d1d55f99cab9">print_partial_symbols</a> (<span class="keyword">struct</span> <a class="code" href="structgdbarch.html">gdbarch</a> *<a class="code" href="structgdbarch.html">gdbarch</a>,
<a name="l00867"></a>00867                        <span class="keyword">struct</span> <a class="code" href="structpartial__symbol.html">partial_symbol</a> **p, <span class="keywordtype">int</span> count, <span class="keywordtype">char</span> *what,
<a name="l00868"></a>00868                        <span class="keyword">struct</span> <a class="code" href="structui__file.html">ui_file</a> *outfile)
<a name="l00869"></a>00869 {
<a name="l00870"></a>00870   <a class="code" href="utils_8c.html#aaa819b1a6c0b6c4090bdc0b027eaf64b">fprintf_filtered</a> (outfile, <span class="stringliteral">&quot;  %s partial symbols:\n&quot;</span>, what);
<a name="l00871"></a>00871   <span class="keywordflow">while</span> (count-- &gt; 0)
<a name="l00872"></a>00872     {
<a name="l00873"></a>00873       <a class="code" href="defs_8h.html#ad24e2b54375e12474e65ebf7175988fb">QUIT</a>;
<a name="l00874"></a>00874       <a class="code" href="utils_8c.html#aaa819b1a6c0b6c4090bdc0b027eaf64b">fprintf_filtered</a> (outfile, <span class="stringliteral">&quot;    `%s&#39;&quot;</span>, <a class="code" href="symtab_8h.html#a956b56288511a18b855d8a263d60e87f">SYMBOL_LINKAGE_NAME</a> (*p));
<a name="l00875"></a>00875       <span class="keywordflow">if</span> (<a class="code" href="symtab_8h.html#a9be4a0902a8e084998541d5968d36a8c">SYMBOL_DEMANGLED_NAME</a> (*p) != NULL)
<a name="l00876"></a>00876         {
<a name="l00877"></a>00877           <a class="code" href="utils_8c.html#aaa819b1a6c0b6c4090bdc0b027eaf64b">fprintf_filtered</a> (outfile, <span class="stringliteral">&quot;  `%s&#39;&quot;</span>, <a class="code" href="symtab_8h.html#a9be4a0902a8e084998541d5968d36a8c">SYMBOL_DEMANGLED_NAME</a> (*p));
<a name="l00878"></a>00878         }
<a name="l00879"></a>00879       <a class="code" href="utils_8c.html#a4b28488051faf9ab4a2f07633225835f">fputs_filtered</a> (<span class="stringliteral">&quot;, &quot;</span>, outfile);
<a name="l00880"></a>00880       <span class="keywordflow">switch</span> (<a class="code" href="symtab_8h.html#a362f2f64212c0c45fb770a3f21ef5ab0">SYMBOL_DOMAIN</a> (*p))
<a name="l00881"></a>00881         {
<a name="l00882"></a>00882         <span class="keywordflow">case</span> <a class="code" href="symtab_8h.html#a5c384cef81c5f50f32caadbfd6974a1aa6b943c7bcdab5c62ae6a0cbe8929f91f">UNDEF_DOMAIN</a>:
<a name="l00883"></a>00883           <a class="code" href="utils_8c.html#a4b28488051faf9ab4a2f07633225835f">fputs_filtered</a> (<span class="stringliteral">&quot;undefined domain, &quot;</span>, outfile);
<a name="l00884"></a>00884           <span class="keywordflow">break</span>;
<a name="l00885"></a>00885         <span class="keywordflow">case</span> <a class="code" href="symtab_8h.html#a5c384cef81c5f50f32caadbfd6974a1aa15693f9d844450eb4bfd4b37114f4aed">VAR_DOMAIN</a>:
<a name="l00886"></a>00886           <span class="comment">/* This is the usual thing -- don&#39;t print it.  */</span>
<a name="l00887"></a>00887           <span class="keywordflow">break</span>;
<a name="l00888"></a>00888         <span class="keywordflow">case</span> <a class="code" href="symtab_8h.html#a5c384cef81c5f50f32caadbfd6974a1aa1f05a16e681efd2e892974878c353f11">STRUCT_DOMAIN</a>:
<a name="l00889"></a>00889           <a class="code" href="utils_8c.html#a4b28488051faf9ab4a2f07633225835f">fputs_filtered</a> (<span class="stringliteral">&quot;struct domain, &quot;</span>, outfile);
<a name="l00890"></a>00890           <span class="keywordflow">break</span>;
<a name="l00891"></a>00891         <span class="keywordflow">case</span> <a class="code" href="symtab_8h.html#a5c384cef81c5f50f32caadbfd6974a1aa56127af42926055244b2318cbdbc8413">LABEL_DOMAIN</a>:
<a name="l00892"></a>00892           <a class="code" href="utils_8c.html#a4b28488051faf9ab4a2f07633225835f">fputs_filtered</a> (<span class="stringliteral">&quot;label domain, &quot;</span>, outfile);
<a name="l00893"></a>00893           <span class="keywordflow">break</span>;
<a name="l00894"></a>00894         <span class="keywordflow">default</span>:
<a name="l00895"></a>00895           <a class="code" href="utils_8c.html#a4b28488051faf9ab4a2f07633225835f">fputs_filtered</a> (<span class="stringliteral">&quot;&lt;invalid domain&gt;, &quot;</span>, outfile);
<a name="l00896"></a>00896           <span class="keywordflow">break</span>;
<a name="l00897"></a>00897         }
<a name="l00898"></a>00898       <span class="keywordflow">switch</span> (<a class="code" href="psympriv_8h.html#acb5399267e28b8e4b2d8294ae490e700">PSYMBOL_CLASS</a> (*p))
<a name="l00899"></a>00899         {
<a name="l00900"></a>00900         <span class="keywordflow">case</span> <a class="code" href="symtab_8h.html#a40bca6cf3ed5cfa15b1275e6750cdda3a8f175362d642a65c7ee6e944ffd59a3d">LOC_UNDEF</a>:
<a name="l00901"></a>00901           <a class="code" href="utils_8c.html#a4b28488051faf9ab4a2f07633225835f">fputs_filtered</a> (<span class="stringliteral">&quot;undefined&quot;</span>, outfile);
<a name="l00902"></a>00902           <span class="keywordflow">break</span>;
<a name="l00903"></a>00903         <span class="keywordflow">case</span> <a class="code" href="symtab_8h.html#a40bca6cf3ed5cfa15b1275e6750cdda3a5268309778a6727d08106ff9f2966e54">LOC_CONST</a>:
<a name="l00904"></a>00904           <a class="code" href="utils_8c.html#a4b28488051faf9ab4a2f07633225835f">fputs_filtered</a> (<span class="stringliteral">&quot;constant int&quot;</span>, outfile);
<a name="l00905"></a>00905           <span class="keywordflow">break</span>;
<a name="l00906"></a>00906         <span class="keywordflow">case</span> <a class="code" href="symtab_8h.html#a40bca6cf3ed5cfa15b1275e6750cdda3a154b256439f7acd7ec7f6257d5881a0f">LOC_STATIC</a>:
<a name="l00907"></a>00907           <a class="code" href="utils_8c.html#a4b28488051faf9ab4a2f07633225835f">fputs_filtered</a> (<span class="stringliteral">&quot;static&quot;</span>, outfile);
<a name="l00908"></a>00908           <span class="keywordflow">break</span>;
<a name="l00909"></a>00909         <span class="keywordflow">case</span> <a class="code" href="symtab_8h.html#a40bca6cf3ed5cfa15b1275e6750cdda3a2a9bcb7d8487d7ccb3858184340712e7">LOC_REGISTER</a>:
<a name="l00910"></a>00910           <a class="code" href="utils_8c.html#a4b28488051faf9ab4a2f07633225835f">fputs_filtered</a> (<span class="stringliteral">&quot;register&quot;</span>, outfile);
<a name="l00911"></a>00911           <span class="keywordflow">break</span>;
<a name="l00912"></a>00912         <span class="keywordflow">case</span> <a class="code" href="symtab_8h.html#a40bca6cf3ed5cfa15b1275e6750cdda3affc89e823125f8ae758aee5fb913b308">LOC_ARG</a>:
<a name="l00913"></a>00913           <a class="code" href="utils_8c.html#a4b28488051faf9ab4a2f07633225835f">fputs_filtered</a> (<span class="stringliteral">&quot;pass by value&quot;</span>, outfile);
<a name="l00914"></a>00914           <span class="keywordflow">break</span>;
<a name="l00915"></a>00915         <span class="keywordflow">case</span> <a class="code" href="symtab_8h.html#a40bca6cf3ed5cfa15b1275e6750cdda3a3c444a41d837bee346e19072ca35f8d3">LOC_REF_ARG</a>:
<a name="l00916"></a>00916           <a class="code" href="utils_8c.html#a4b28488051faf9ab4a2f07633225835f">fputs_filtered</a> (<span class="stringliteral">&quot;pass by reference&quot;</span>, outfile);
<a name="l00917"></a>00917           <span class="keywordflow">break</span>;
<a name="l00918"></a>00918         <span class="keywordflow">case</span> <a class="code" href="symtab_8h.html#a40bca6cf3ed5cfa15b1275e6750cdda3ad9b13677899a4fbbd0f44f39726416e7">LOC_REGPARM_ADDR</a>:
<a name="l00919"></a>00919           <a class="code" href="utils_8c.html#a4b28488051faf9ab4a2f07633225835f">fputs_filtered</a> (<span class="stringliteral">&quot;register address parameter&quot;</span>, outfile);
<a name="l00920"></a>00920           <span class="keywordflow">break</span>;
<a name="l00921"></a>00921         <span class="keywordflow">case</span> <a class="code" href="symtab_8h.html#a40bca6cf3ed5cfa15b1275e6750cdda3a495b83fa459ac0722b15a3e94afadbce">LOC_LOCAL</a>:
<a name="l00922"></a>00922           <a class="code" href="utils_8c.html#a4b28488051faf9ab4a2f07633225835f">fputs_filtered</a> (<span class="stringliteral">&quot;stack parameter&quot;</span>, outfile);
<a name="l00923"></a>00923           <span class="keywordflow">break</span>;
<a name="l00924"></a>00924         <span class="keywordflow">case</span> <a class="code" href="symtab_8h.html#a40bca6cf3ed5cfa15b1275e6750cdda3ac0b2498d37ddd0f48d23739bba4abca4">LOC_TYPEDEF</a>:
<a name="l00925"></a>00925           <a class="code" href="utils_8c.html#a4b28488051faf9ab4a2f07633225835f">fputs_filtered</a> (<span class="stringliteral">&quot;type&quot;</span>, outfile);
<a name="l00926"></a>00926           <span class="keywordflow">break</span>;
<a name="l00927"></a>00927         <span class="keywordflow">case</span> <a class="code" href="symtab_8h.html#a40bca6cf3ed5cfa15b1275e6750cdda3a246b44ddd9acee8dac2a7d9d2c5d7c6e">LOC_LABEL</a>:
<a name="l00928"></a>00928           <a class="code" href="utils_8c.html#a4b28488051faf9ab4a2f07633225835f">fputs_filtered</a> (<span class="stringliteral">&quot;label&quot;</span>, outfile);
<a name="l00929"></a>00929           <span class="keywordflow">break</span>;
<a name="l00930"></a>00930         <span class="keywordflow">case</span> <a class="code" href="symtab_8h.html#a40bca6cf3ed5cfa15b1275e6750cdda3a1f1e8d54397f35889104cd7766fcec2b">LOC_BLOCK</a>:
<a name="l00931"></a>00931           <a class="code" href="utils_8c.html#a4b28488051faf9ab4a2f07633225835f">fputs_filtered</a> (<span class="stringliteral">&quot;function&quot;</span>, outfile);
<a name="l00932"></a>00932           <span class="keywordflow">break</span>;
<a name="l00933"></a>00933         <span class="keywordflow">case</span> <a class="code" href="symtab_8h.html#a40bca6cf3ed5cfa15b1275e6750cdda3a74c269ff88b13d3497422a9ebfd98b2d">LOC_CONST_BYTES</a>:
<a name="l00934"></a>00934           <a class="code" href="utils_8c.html#a4b28488051faf9ab4a2f07633225835f">fputs_filtered</a> (<span class="stringliteral">&quot;constant bytes&quot;</span>, outfile);
<a name="l00935"></a>00935           <span class="keywordflow">break</span>;
<a name="l00936"></a>00936         <span class="keywordflow">case</span> <a class="code" href="symtab_8h.html#a40bca6cf3ed5cfa15b1275e6750cdda3a3d61e7ad56c95328fba05416abc73f7a">LOC_UNRESOLVED</a>:
<a name="l00937"></a>00937           <a class="code" href="utils_8c.html#a4b28488051faf9ab4a2f07633225835f">fputs_filtered</a> (<span class="stringliteral">&quot;unresolved&quot;</span>, outfile);
<a name="l00938"></a>00938           <span class="keywordflow">break</span>;
<a name="l00939"></a>00939         <span class="keywordflow">case</span> <a class="code" href="symtab_8h.html#a40bca6cf3ed5cfa15b1275e6750cdda3aa4f37f80c900ee253911325c30b8a60f">LOC_OPTIMIZED_OUT</a>:
<a name="l00940"></a>00940           <a class="code" href="utils_8c.html#a4b28488051faf9ab4a2f07633225835f">fputs_filtered</a> (<span class="stringliteral">&quot;optimized out&quot;</span>, outfile);
<a name="l00941"></a>00941           <span class="keywordflow">break</span>;
<a name="l00942"></a>00942         <span class="keywordflow">case</span> <a class="code" href="symtab_8h.html#a40bca6cf3ed5cfa15b1275e6750cdda3afd4303a25cda7805900ce8212c67ed45">LOC_COMPUTED</a>:
<a name="l00943"></a>00943           <a class="code" href="utils_8c.html#a4b28488051faf9ab4a2f07633225835f">fputs_filtered</a> (<span class="stringliteral">&quot;computed at runtime&quot;</span>, outfile);
<a name="l00944"></a>00944           <span class="keywordflow">break</span>;
<a name="l00945"></a>00945         <span class="keywordflow">default</span>:
<a name="l00946"></a>00946           <a class="code" href="utils_8c.html#a4b28488051faf9ab4a2f07633225835f">fputs_filtered</a> (<span class="stringliteral">&quot;&lt;invalid location&gt;&quot;</span>, outfile);
<a name="l00947"></a>00947           <span class="keywordflow">break</span>;
<a name="l00948"></a>00948         }
<a name="l00949"></a>00949       <a class="code" href="utils_8c.html#a4b28488051faf9ab4a2f07633225835f">fputs_filtered</a> (<span class="stringliteral">&quot;, &quot;</span>, outfile);
<a name="l00950"></a>00950       <a class="code" href="utils_8c.html#a4b28488051faf9ab4a2f07633225835f">fputs_filtered</a> (<a class="code" href="utils_8c.html#ab5c76d72090f01d3848b63dda4e37d1c">paddress</a> (gdbarch, <a class="code" href="symtab_8h.html#abee697b9e3bb4f4d164ad920a87ab854">SYMBOL_VALUE_ADDRESS</a> (*p)), outfile);
<a name="l00951"></a>00951       <a class="code" href="utils_8c.html#aaa819b1a6c0b6c4090bdc0b027eaf64b">fprintf_filtered</a> (outfile, <span class="stringliteral">&quot;\n&quot;</span>);
<a name="l00952"></a>00952       p++;
<a name="l00953"></a>00953     }
<a name="l00954"></a>00954 }
<a name="l00955"></a>00955 
<a name="l00956"></a>00956 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l00957"></a><a class="code" href="psymtab_8c.html#a51d965a77421fd3d82b44101beaf69b1">00957</a> <a class="code" href="psymtab_8c.html#a51d965a77421fd3d82b44101beaf69b1">dump_psymtab</a> (<span class="keyword">struct</span> objfile *objfile, <span class="keyword">struct</span> <a class="code" href="structpartial__symtab.html">partial_symtab</a> *psymtab,
<a name="l00958"></a>00958               <span class="keyword">struct</span> <a class="code" href="structui__file.html">ui_file</a> *outfile)
<a name="l00959"></a>00959 {
<a name="l00960"></a>00960   <span class="keyword">struct </span><a class="code" href="structgdbarch.html">gdbarch</a> *<a class="code" href="structgdbarch.html">gdbarch</a> = <a class="code" href="objfiles_8c.html#a1c7101234ac2edc601fa465e48bc3463">get_objfile_arch</a> (objfile);
<a name="l00961"></a>00961   <span class="keywordtype">int</span> i;
<a name="l00962"></a>00962 
<a name="l00963"></a>00963   <span class="keywordflow">if</span> (psymtab-&gt;<a class="code" href="structpartial__symtab.html#a72ab74ae49f0048cc7151d786e724235">anonymous</a>)
<a name="l00964"></a>00964     {
<a name="l00965"></a>00965       <a class="code" href="utils_8c.html#aaa819b1a6c0b6c4090bdc0b027eaf64b">fprintf_filtered</a> (outfile, <span class="stringliteral">&quot;\nAnonymous partial symtab (%s) &quot;</span>,
<a name="l00966"></a>00966                         psymtab-&gt;<a class="code" href="structpartial__symtab.html#a6ea70ac87d6dbd541967bdd6dacd7321">filename</a>);
<a name="l00967"></a>00967     }
<a name="l00968"></a>00968   <span class="keywordflow">else</span>
<a name="l00969"></a>00969     {
<a name="l00970"></a>00970       <a class="code" href="utils_8c.html#aaa819b1a6c0b6c4090bdc0b027eaf64b">fprintf_filtered</a> (outfile, <span class="stringliteral">&quot;\nPartial symtab for source file %s &quot;</span>,
<a name="l00971"></a>00971                         psymtab-&gt;<a class="code" href="structpartial__symtab.html#a6ea70ac87d6dbd541967bdd6dacd7321">filename</a>);
<a name="l00972"></a>00972     }
<a name="l00973"></a>00973   <a class="code" href="utils_8c.html#aaa819b1a6c0b6c4090bdc0b027eaf64b">fprintf_filtered</a> (outfile, <span class="stringliteral">&quot;(object &quot;</span>);
<a name="l00974"></a>00974   <a class="code" href="utils_8c.html#a44c27389317dc7223638a3ee31bcd22b">gdb_print_host_address</a> (psymtab, outfile);
<a name="l00975"></a>00975   <a class="code" href="utils_8c.html#aaa819b1a6c0b6c4090bdc0b027eaf64b">fprintf_filtered</a> (outfile, <span class="stringliteral">&quot;)\n\n&quot;</span>);
<a name="l00976"></a>00976   <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (outfile, <span class="stringliteral">&quot;  Read from object file %s (&quot;</span>,
<a name="l00977"></a>00977                       <a class="code" href="objfiles_8c.html#a33e548a19b86b293435d3c2d6daaaec6">objfile_name</a> (objfile));
<a name="l00978"></a>00978   <a class="code" href="utils_8c.html#a44c27389317dc7223638a3ee31bcd22b">gdb_print_host_address</a> (objfile, outfile);
<a name="l00979"></a>00979   <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (outfile, <span class="stringliteral">&quot;)\n&quot;</span>);
<a name="l00980"></a>00980 
<a name="l00981"></a>00981   <span class="keywordflow">if</span> (psymtab-&gt;<a class="code" href="structpartial__symtab.html#a11d8e59b962db1317c8c23f917dbed42">readin</a>)
<a name="l00982"></a>00982     {
<a name="l00983"></a>00983       <a class="code" href="utils_8c.html#aaa819b1a6c0b6c4090bdc0b027eaf64b">fprintf_filtered</a> (outfile,
<a name="l00984"></a>00984                         <span class="stringliteral">&quot;  Full symtab was read (at &quot;</span>);
<a name="l00985"></a>00985       <a class="code" href="utils_8c.html#a44c27389317dc7223638a3ee31bcd22b">gdb_print_host_address</a> (psymtab-&gt;<a class="code" href="structpartial__symtab.html#a1bbcf18c88d09005b43f960b6f3575f8">symtab</a>, outfile);
<a name="l00986"></a>00986       <a class="code" href="utils_8c.html#aaa819b1a6c0b6c4090bdc0b027eaf64b">fprintf_filtered</a> (outfile, <span class="stringliteral">&quot; by function at &quot;</span>);
<a name="l00987"></a>00987       <a class="code" href="utils_8c.html#a44c27389317dc7223638a3ee31bcd22b">gdb_print_host_address</a> (psymtab-&gt;<a class="code" href="structpartial__symtab.html#a51a53dce450ff3473f03a903aa06b263">read_symtab</a>, outfile);
<a name="l00988"></a>00988       <a class="code" href="utils_8c.html#aaa819b1a6c0b6c4090bdc0b027eaf64b">fprintf_filtered</a> (outfile, <span class="stringliteral">&quot;)\n&quot;</span>);
<a name="l00989"></a>00989     }
<a name="l00990"></a>00990 
<a name="l00991"></a>00991   <a class="code" href="utils_8c.html#aaa819b1a6c0b6c4090bdc0b027eaf64b">fprintf_filtered</a> (outfile, <span class="stringliteral">&quot;  Relocate symbols by &quot;</span>);
<a name="l00992"></a>00992   <span class="keywordflow">for</span> (i = 0; i &lt; objfile-&gt;<a class="code" href="structobjfile.html#a34232a1b946c53c44c4a41409033d533">num_sections</a>; ++i)
<a name="l00993"></a>00993     {
<a name="l00994"></a>00994       <span class="keywordflow">if</span> (i != 0)
<a name="l00995"></a>00995         <a class="code" href="utils_8c.html#aaa819b1a6c0b6c4090bdc0b027eaf64b">fprintf_filtered</a> (outfile, <span class="stringliteral">&quot;, &quot;</span>);
<a name="l00996"></a>00996       <a class="code" href="utils_8c.html#a857540a17ef1cd62fef4a33cc3b6a894">wrap_here</a> (<span class="stringliteral">&quot;    &quot;</span>);
<a name="l00997"></a>00997       <a class="code" href="utils_8c.html#a4b28488051faf9ab4a2f07633225835f">fputs_filtered</a> (<a class="code" href="utils_8c.html#ab5c76d72090f01d3848b63dda4e37d1c">paddress</a> (gdbarch,
<a name="l00998"></a>00998                                 <a class="code" href="symtab_8h.html#ab72b539d710f3a5a3857df5d387c4af3">ANOFFSET</a> (psymtab-&gt;<a class="code" href="structpartial__symtab.html#abdbad327cdb56a7663e18f1f14e18730">section_offsets</a>, i)),
<a name="l00999"></a>00999                       outfile);
<a name="l01000"></a>01000     }
<a name="l01001"></a>01001   <a class="code" href="utils_8c.html#aaa819b1a6c0b6c4090bdc0b027eaf64b">fprintf_filtered</a> (outfile, <span class="stringliteral">&quot;\n&quot;</span>);
<a name="l01002"></a>01002 
<a name="l01003"></a>01003   <a class="code" href="utils_8c.html#aaa819b1a6c0b6c4090bdc0b027eaf64b">fprintf_filtered</a> (outfile, <span class="stringliteral">&quot;  Symbols cover text addresses &quot;</span>);
<a name="l01004"></a>01004   <a class="code" href="utils_8c.html#a4b28488051faf9ab4a2f07633225835f">fputs_filtered</a> (<a class="code" href="utils_8c.html#ab5c76d72090f01d3848b63dda4e37d1c">paddress</a> (gdbarch, psymtab-&gt;<a class="code" href="structpartial__symtab.html#a194e7d3c21d81ce56b81d1fe02e1dbc3">textlow</a>), outfile);
<a name="l01005"></a>01005   <a class="code" href="utils_8c.html#aaa819b1a6c0b6c4090bdc0b027eaf64b">fprintf_filtered</a> (outfile, <span class="stringliteral">&quot;-&quot;</span>);
<a name="l01006"></a>01006   <a class="code" href="utils_8c.html#a4b28488051faf9ab4a2f07633225835f">fputs_filtered</a> (<a class="code" href="utils_8c.html#ab5c76d72090f01d3848b63dda4e37d1c">paddress</a> (gdbarch, psymtab-&gt;<a class="code" href="structpartial__symtab.html#aa582095c68fb326f3042ad672527a438">texthigh</a>), outfile);
<a name="l01007"></a>01007   <a class="code" href="utils_8c.html#aaa819b1a6c0b6c4090bdc0b027eaf64b">fprintf_filtered</a> (outfile, <span class="stringliteral">&quot;\n&quot;</span>);
<a name="l01008"></a>01008   <a class="code" href="utils_8c.html#aaa819b1a6c0b6c4090bdc0b027eaf64b">fprintf_filtered</a> (outfile, <span class="stringliteral">&quot;  Address map supported - %s.\n&quot;</span>,
<a name="l01009"></a>01009                     psymtab-&gt;<a class="code" href="structpartial__symtab.html#aa4a6c5beadf5f2d9b39a06c04c728fa2">psymtabs_addrmap_supported</a> ? <span class="stringliteral">&quot;yes&quot;</span> : <span class="stringliteral">&quot;no&quot;</span>);
<a name="l01010"></a>01010   <a class="code" href="utils_8c.html#aaa819b1a6c0b6c4090bdc0b027eaf64b">fprintf_filtered</a> (outfile, <span class="stringliteral">&quot;  Depends on %d other partial symtabs.\n&quot;</span>,
<a name="l01011"></a>01011                     psymtab-&gt;<a class="code" href="structpartial__symtab.html#a917b503a5e1f7c2bb60feb6ff1e3b197">number_of_dependencies</a>);
<a name="l01012"></a>01012   <span class="keywordflow">for</span> (i = 0; i &lt; psymtab-&gt;<a class="code" href="structpartial__symtab.html#a917b503a5e1f7c2bb60feb6ff1e3b197">number_of_dependencies</a>; i++)
<a name="l01013"></a>01013     {
<a name="l01014"></a>01014       <a class="code" href="utils_8c.html#aaa819b1a6c0b6c4090bdc0b027eaf64b">fprintf_filtered</a> (outfile, <span class="stringliteral">&quot;    %d &quot;</span>, i);
<a name="l01015"></a>01015       <a class="code" href="utils_8c.html#a44c27389317dc7223638a3ee31bcd22b">gdb_print_host_address</a> (psymtab-&gt;<a class="code" href="structpartial__symtab.html#a0b7bd5bada02a362357552790b111c23">dependencies</a>[i], outfile);
<a name="l01016"></a>01016       <a class="code" href="utils_8c.html#aaa819b1a6c0b6c4090bdc0b027eaf64b">fprintf_filtered</a> (outfile, <span class="stringliteral">&quot; %s\n&quot;</span>,
<a name="l01017"></a>01017                         psymtab-&gt;<a class="code" href="structpartial__symtab.html#a0b7bd5bada02a362357552790b111c23">dependencies</a>[i]-&gt;<a class="code" href="structpartial__symtab.html#a6ea70ac87d6dbd541967bdd6dacd7321">filename</a>);
<a name="l01018"></a>01018     }
<a name="l01019"></a>01019   <span class="keywordflow">if</span> (psymtab-&gt;<a class="code" href="structpartial__symtab.html#a0609b1a2e29b3419dc25520e7d7293f0">user</a> != NULL)
<a name="l01020"></a>01020     {
<a name="l01021"></a>01021       <a class="code" href="utils_8c.html#aaa819b1a6c0b6c4090bdc0b027eaf64b">fprintf_filtered</a> (outfile, <span class="stringliteral">&quot;  Shared partial symtab with user &quot;</span>);
<a name="l01022"></a>01022       <a class="code" href="utils_8c.html#a44c27389317dc7223638a3ee31bcd22b">gdb_print_host_address</a> (psymtab-&gt;<a class="code" href="structpartial__symtab.html#a0609b1a2e29b3419dc25520e7d7293f0">user</a>, outfile);
<a name="l01023"></a>01023       <a class="code" href="utils_8c.html#aaa819b1a6c0b6c4090bdc0b027eaf64b">fprintf_filtered</a> (outfile, <span class="stringliteral">&quot;\n&quot;</span>);
<a name="l01024"></a>01024     }
<a name="l01025"></a>01025   <span class="keywordflow">if</span> (psymtab-&gt;<a class="code" href="structpartial__symtab.html#ab26039959ff434afcf130049cfa8d27d">n_global_syms</a> &gt; 0)
<a name="l01026"></a>01026     {
<a name="l01027"></a>01027       <a class="code" href="psymtab_8c.html#a228d1d480894193c8f04d1d55f99cab9">print_partial_symbols</a> (gdbarch,
<a name="l01028"></a>01028                              objfile-&gt;<a class="code" href="structobjfile.html#a5665fb90f8a5d1481cc59ed5cf6a86fa">global_psymbols</a>.<a class="code" href="structpsymbol__allocation__list.html#ac618c483c3ff07162cdfe508abd6034d">list</a>
<a name="l01029"></a>01029                              + psymtab-&gt;<a class="code" href="structpartial__symtab.html#ae11f1094416fd506398f4a58fe4fa405">globals_offset</a>,
<a name="l01030"></a>01030                              psymtab-&gt;<a class="code" href="structpartial__symtab.html#ab26039959ff434afcf130049cfa8d27d">n_global_syms</a>, <span class="stringliteral">&quot;Global&quot;</span>, outfile);
<a name="l01031"></a>01031     }
<a name="l01032"></a>01032   <span class="keywordflow">if</span> (psymtab-&gt;<a class="code" href="structpartial__symtab.html#a0fd67e243d440beaf6cc4757a97ff9b0">n_static_syms</a> &gt; 0)
<a name="l01033"></a>01033     {
<a name="l01034"></a>01034       <a class="code" href="psymtab_8c.html#a228d1d480894193c8f04d1d55f99cab9">print_partial_symbols</a> (gdbarch,
<a name="l01035"></a>01035                              objfile-&gt;<a class="code" href="structobjfile.html#a365549b70c39eb429e3103991da9b3e6">static_psymbols</a>.<a class="code" href="structpsymbol__allocation__list.html#ac618c483c3ff07162cdfe508abd6034d">list</a>
<a name="l01036"></a>01036                              + psymtab-&gt;<a class="code" href="structpartial__symtab.html#a36b8c771ea2906e413b8f1fffe1f4d10">statics_offset</a>,
<a name="l01037"></a>01037                              psymtab-&gt;<a class="code" href="structpartial__symtab.html#a0fd67e243d440beaf6cc4757a97ff9b0">n_static_syms</a>, <span class="stringliteral">&quot;Static&quot;</span>, outfile);
<a name="l01038"></a>01038     }
<a name="l01039"></a>01039   <a class="code" href="utils_8c.html#aaa819b1a6c0b6c4090bdc0b027eaf64b">fprintf_filtered</a> (outfile, <span class="stringliteral">&quot;\n&quot;</span>);
<a name="l01040"></a>01040 }
<a name="l01041"></a>01041 
<a name="l01042"></a>01042 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01043"></a><a class="code" href="psymtab_8c.html#acf2ef4edb85e0cb4d75a65c66597aa8b">01043</a> <a class="code" href="psymtab_8c.html#acf2ef4edb85e0cb4d75a65c66597aa8b">print_psymtab_stats_for_objfile</a> (<span class="keyword">struct</span> objfile *objfile)
<a name="l01044"></a>01044 {
<a name="l01045"></a>01045   <span class="keywordtype">int</span> i;
<a name="l01046"></a>01046   <span class="keyword">struct </span><a class="code" href="structpartial__symtab.html">partial_symtab</a> *<a class="code" href="namespacecleanup__check.html#a2f9ce522b7667bef19a5777d12fa44d8">ps</a>;
<a name="l01047"></a>01047 
<a name="l01048"></a>01048   i = 0;
<a name="l01049"></a>01049   <a class="code" href="psymtab_8c.html#a3fbd70c118d9b449af634c15717d508e">ALL_OBJFILE_PSYMTABS_REQUIRED</a> (objfile, ps)
<a name="l01050"></a>01050     {
<a name="l01051"></a>01051       <span class="keywordflow">if</span> (ps-&gt;<a class="code" href="structpartial__symtab.html#a11d8e59b962db1317c8c23f917dbed42">readin</a> == 0)
<a name="l01052"></a>01052         i++;
<a name="l01053"></a>01053     }
<a name="l01054"></a>01054   <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;  Number of psym tables (not yet expanded): %d\n&quot;</span>), i);
<a name="l01055"></a>01055 }
<a name="l01056"></a>01056 
<a name="l01057"></a>01057 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01058"></a><a class="code" href="psymtab_8c.html#ab98f306fac9b0ed1df47b94ab6bc2eb8">01058</a> <a class="code" href="psymtab_8c.html#ab98f306fac9b0ed1df47b94ab6bc2eb8">dump_psymtabs_for_objfile</a> (<span class="keyword">struct</span> objfile *objfile)
<a name="l01059"></a>01059 {
<a name="l01060"></a>01060   <span class="keyword">struct </span><a class="code" href="structpartial__symtab.html">partial_symtab</a> *psymtab;
<a name="l01061"></a>01061 
<a name="l01062"></a>01062   <span class="keywordflow">if</span> (objfile-&gt;<a class="code" href="structobjfile.html#a4dcbf92348a83fa9d6d5d2d08cb59eb5">psymtabs</a>)
<a name="l01063"></a>01063     {
<a name="l01064"></a>01064       <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;Psymtabs:\n&quot;</span>);
<a name="l01065"></a>01065       <span class="keywordflow">for</span> (psymtab = objfile-&gt;<a class="code" href="structobjfile.html#a4dcbf92348a83fa9d6d5d2d08cb59eb5">psymtabs</a>;
<a name="l01066"></a>01066            psymtab != NULL;
<a name="l01067"></a>01067            psymtab = psymtab-&gt;<a class="code" href="structpartial__symtab.html#aa58c92073996df85892297ab82788785">next</a>)
<a name="l01068"></a>01068         {
<a name="l01069"></a>01069           <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;%s at &quot;</span>,
<a name="l01070"></a>01070                            psymtab-&gt;<a class="code" href="structpartial__symtab.html#a6ea70ac87d6dbd541967bdd6dacd7321">filename</a>);
<a name="l01071"></a>01071           <a class="code" href="utils_8c.html#a44c27389317dc7223638a3ee31bcd22b">gdb_print_host_address</a> (psymtab, <a class="code" href="main_8c.html#a41a2b997ba5454df787d61f051dd918c">gdb_stdout</a>);
<a name="l01072"></a>01072           <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;, &quot;</span>);
<a name="l01073"></a>01073           <a class="code" href="utils_8c.html#a857540a17ef1cd62fef4a33cc3b6a894">wrap_here</a> (<span class="stringliteral">&quot;  &quot;</span>);
<a name="l01074"></a>01074         }
<a name="l01075"></a>01075       <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;\n\n&quot;</span>);
<a name="l01076"></a>01076     }
<a name="l01077"></a>01077 }
<a name="l01078"></a>01078 
<a name="l01079"></a>01079 <span class="comment">/* Look through the partial symtabs for all symbols which begin</span>
<a name="l01080"></a>01080 <span class="comment">   by matching FUNC_NAME.  Make sure we read that symbol table in.  */</span>
<a name="l01081"></a>01081 
<a name="l01082"></a>01082 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01083"></a><a class="code" href="psymtab_8c.html#a3fbbaceb2887d3e45fafcf7f94ef99ff">01083</a> <a class="code" href="psymtab_8c.html#a3fbbaceb2887d3e45fafcf7f94ef99ff">read_symtabs_for_function</a> (<span class="keyword">struct</span> objfile *objfile, <span class="keyword">const</span> <span class="keywordtype">char</span> *func_name)
<a name="l01084"></a>01084 {
<a name="l01085"></a>01085   <span class="keyword">struct </span><a class="code" href="structpartial__symtab.html">partial_symtab</a> *<a class="code" href="namespacecleanup__check.html#a2f9ce522b7667bef19a5777d12fa44d8">ps</a>;
<a name="l01086"></a>01086 
<a name="l01087"></a>01087   <a class="code" href="psymtab_8c.html#a3fbd70c118d9b449af634c15717d508e">ALL_OBJFILE_PSYMTABS_REQUIRED</a> (objfile, ps)
<a name="l01088"></a>01088   {
<a name="l01089"></a>01089     <span class="keywordflow">if</span> (ps-&gt;<a class="code" href="structpartial__symtab.html#a11d8e59b962db1317c8c23f917dbed42">readin</a>)
<a name="l01090"></a>01090       <span class="keywordflow">continue</span>;
<a name="l01091"></a>01091 
<a name="l01092"></a>01092     <span class="keywordflow">if</span> ((<a class="code" href="psymtab_8c.html#af55d03c98bc38e536b34403f0ff4429b">lookup_partial_symbol</a> (objfile, ps, func_name, 1, <a class="code" href="symtab_8h.html#a5c384cef81c5f50f32caadbfd6974a1aa15693f9d844450eb4bfd4b37114f4aed">VAR_DOMAIN</a>)
<a name="l01093"></a>01093          != NULL)
<a name="l01094"></a>01094         || (<a class="code" href="psymtab_8c.html#af55d03c98bc38e536b34403f0ff4429b">lookup_partial_symbol</a> (objfile, ps, func_name, 0, <a class="code" href="symtab_8h.html#a5c384cef81c5f50f32caadbfd6974a1aa15693f9d844450eb4bfd4b37114f4aed">VAR_DOMAIN</a>)
<a name="l01095"></a>01095             != NULL))
<a name="l01096"></a>01096       <a class="code" href="psymtab_8c.html#a9afb9c706b9a9f25e4395b9a95ce4c8a">psymtab_to_symtab</a> (objfile, ps);
<a name="l01097"></a>01097   }
<a name="l01098"></a>01098 }
<a name="l01099"></a>01099 
<a name="l01100"></a>01100 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01101"></a><a class="code" href="psymtab_8c.html#a987f53ffd20fc1cad58009e7701f7460">01101</a> <a class="code" href="psymtab_8c.html#a987f53ffd20fc1cad58009e7701f7460">expand_partial_symbol_tables</a> (<span class="keyword">struct</span> objfile *objfile)
<a name="l01102"></a>01102 {
<a name="l01103"></a>01103   <span class="keyword">struct </span><a class="code" href="structpartial__symtab.html">partial_symtab</a> *psymtab;
<a name="l01104"></a>01104 
<a name="l01105"></a>01105   <a class="code" href="psymtab_8c.html#a3fbd70c118d9b449af634c15717d508e">ALL_OBJFILE_PSYMTABS_REQUIRED</a> (objfile, psymtab)
<a name="l01106"></a>01106     {
<a name="l01107"></a>01107       <a class="code" href="psymtab_8c.html#a9afb9c706b9a9f25e4395b9a95ce4c8a">psymtab_to_symtab</a> (objfile, psymtab);
<a name="l01108"></a>01108     }
<a name="l01109"></a>01109 }
<a name="l01110"></a>01110 
<a name="l01111"></a>01111 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01112"></a><a class="code" href="psymtab_8c.html#a0a4d5906ce91ec7bd30054e9f0476d7c">01112</a> <a class="code" href="psymtab_8c.html#a0a4d5906ce91ec7bd30054e9f0476d7c">read_psymtabs_with_fullname</a> (<span class="keyword">struct</span> objfile *objfile, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structpartial__symtab.html#aeaaef4856b449061d28624055c9c70d6">fullname</a>)
<a name="l01113"></a>01113 {
<a name="l01114"></a>01114   <span class="keyword">struct </span><a class="code" href="structpartial__symtab.html">partial_symtab</a> *<a class="code" href="windows-nat_8c.html#ade66e4ccafbc33b117610bbc0d85feb0">p</a>;
<a name="l01115"></a>01115 
<a name="l01116"></a>01116   <a class="code" href="psymtab_8c.html#a3fbd70c118d9b449af634c15717d508e">ALL_OBJFILE_PSYMTABS_REQUIRED</a> (objfile, p)
<a name="l01117"></a>01117     {
<a name="l01118"></a>01118       <span class="comment">/* Anonymous psymtabs don&#39;t have a name of a source file.  */</span>
<a name="l01119"></a>01119       <span class="keywordflow">if</span> (p-&gt;<a class="code" href="structpartial__symtab.html#a72ab74ae49f0048cc7151d786e724235">anonymous</a>)
<a name="l01120"></a>01120         <span class="keywordflow">continue</span>;
<a name="l01121"></a>01121 
<a name="l01122"></a>01122       <span class="comment">/* psymtab_to_fullname tries to open the file which is slow.</span>
<a name="l01123"></a>01123 <span class="comment">         Don&#39;t call it if we know the basenames don&#39;t match.  */</span>
<a name="l01124"></a>01124       <span class="keywordflow">if</span> ((<a class="code" href="symtab_8c.html#af9a62a674b6767f0981034f1ceb7756a">basenames_may_differ</a>
<a name="l01125"></a>01125            || filename_cmp (lbasename (fullname), lbasename (p-&gt;<a class="code" href="structpartial__symtab.html#a6ea70ac87d6dbd541967bdd6dacd7321">filename</a>)) == 0)
<a name="l01126"></a>01126           &amp;&amp; filename_cmp (fullname, <a class="code" href="psymtab_8c.html#af53cd102034592d4246538edbadc98fe">psymtab_to_fullname</a> (p)) == 0)
<a name="l01127"></a>01127         <a class="code" href="psymtab_8c.html#a9afb9c706b9a9f25e4395b9a95ce4c8a">psymtab_to_symtab</a> (objfile, p);
<a name="l01128"></a>01128     }
<a name="l01129"></a>01129 }
<a name="l01130"></a>01130 
<a name="l01131"></a>01131 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01132"></a><a class="code" href="psymtab_8c.html#abdea7e9ab52b049507df90715fab7fb8">01132</a> <a class="code" href="psymtab_8c.html#abdea7e9ab52b049507df90715fab7fb8">map_symbol_filenames_psymtab</a> (<span class="keyword">struct</span> objfile *objfile,
<a name="l01133"></a>01133                               <a class="code" href="symfile_8h.html#aa6c3550ce55c965193c4397a8583a3b8">symbol_filename_ftype</a> *fun, <span class="keywordtype">void</span> *data,
<a name="l01134"></a>01134                               <span class="keywordtype">int</span> need_fullname)
<a name="l01135"></a>01135 {
<a name="l01136"></a>01136   <span class="keyword">struct </span><a class="code" href="structpartial__symtab.html">partial_symtab</a> *<a class="code" href="namespacecleanup__check.html#a2f9ce522b7667bef19a5777d12fa44d8">ps</a>;
<a name="l01137"></a>01137 
<a name="l01138"></a>01138   <a class="code" href="psymtab_8c.html#a3fbd70c118d9b449af634c15717d508e">ALL_OBJFILE_PSYMTABS_REQUIRED</a> (objfile, ps)
<a name="l01139"></a>01139     {
<a name="l01140"></a>01140       <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structpartial__symtab.html#aeaaef4856b449061d28624055c9c70d6">fullname</a>;
<a name="l01141"></a>01141 
<a name="l01142"></a>01142       <span class="keywordflow">if</span> (ps-&gt;<a class="code" href="structpartial__symtab.html#a11d8e59b962db1317c8c23f917dbed42">readin</a>)
<a name="l01143"></a>01143         <span class="keywordflow">continue</span>;
<a name="l01144"></a>01144 
<a name="l01145"></a>01145       <span class="comment">/* We can skip shared psymtabs here, because any file name will be</span>
<a name="l01146"></a>01146 <span class="comment">         attached to the unshared psymtab.  */</span>
<a name="l01147"></a>01147       <span class="keywordflow">if</span> (ps-&gt;<a class="code" href="structpartial__symtab.html#a0609b1a2e29b3419dc25520e7d7293f0">user</a> != NULL)
<a name="l01148"></a>01148         <span class="keywordflow">continue</span>;
<a name="l01149"></a>01149 
<a name="l01150"></a>01150       <span class="comment">/* Anonymous psymtabs don&#39;t have a file name.  */</span>
<a name="l01151"></a>01151       <span class="keywordflow">if</span> (ps-&gt;<a class="code" href="structpartial__symtab.html#a72ab74ae49f0048cc7151d786e724235">anonymous</a>)
<a name="l01152"></a>01152         <span class="keywordflow">continue</span>;
<a name="l01153"></a>01153 
<a name="l01154"></a>01154       <a class="code" href="defs_8h.html#ad24e2b54375e12474e65ebf7175988fb">QUIT</a>;
<a name="l01155"></a>01155       <span class="keywordflow">if</span> (need_fullname)
<a name="l01156"></a>01156         fullname = <a class="code" href="psymtab_8c.html#af53cd102034592d4246538edbadc98fe">psymtab_to_fullname</a> (ps);
<a name="l01157"></a>01157       <span class="keywordflow">else</span>
<a name="l01158"></a>01158         fullname = NULL;
<a name="l01159"></a>01159       (*fun) (ps-&gt;<a class="code" href="structpartial__symtab.html#a6ea70ac87d6dbd541967bdd6dacd7321">filename</a>, <a class="code" href="structpartial__symtab.html#aeaaef4856b449061d28624055c9c70d6">fullname</a>, data);
<a name="l01160"></a>01160     }
<a name="l01161"></a>01161 }
<a name="l01162"></a>01162 
<a name="l01163"></a>01163 <span class="comment">/* Finds the fullname that a partial_symtab represents.</span>
<a name="l01164"></a>01164 <span class="comment"></span>
<a name="l01165"></a>01165 <span class="comment">   If this functions finds the fullname, it will save it in ps-&gt;fullname</span>
<a name="l01166"></a>01166 <span class="comment">   and it will also return the value.</span>
<a name="l01167"></a>01167 <span class="comment"></span>
<a name="l01168"></a>01168 <span class="comment">   If this function fails to find the file that this partial_symtab represents,</span>
<a name="l01169"></a>01169 <span class="comment">   NULL will be returned and ps-&gt;fullname will be set to NULL.  */</span>
<a name="l01170"></a>01170 
<a name="l01171"></a>01171 <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *
<a name="l01172"></a><a class="code" href="psymtab_8c.html#af53cd102034592d4246538edbadc98fe">01172</a> <a class="code" href="psymtab_8c.html#af53cd102034592d4246538edbadc98fe">psymtab_to_fullname</a> (<span class="keyword">struct</span> <a class="code" href="structpartial__symtab.html">partial_symtab</a> *<a class="code" href="namespacecleanup__check.html#a2f9ce522b7667bef19a5777d12fa44d8">ps</a>)
<a name="l01173"></a>01173 {
<a name="l01174"></a>01174   <a class="code" href="gdb__assert_8h.html#aeb007d3e990858c7ef8e40a7e512c1ff">gdb_assert</a> (!ps-&gt;<a class="code" href="structpartial__symtab.html#a72ab74ae49f0048cc7151d786e724235">anonymous</a>);
<a name="l01175"></a>01175 
<a name="l01176"></a>01176   <span class="comment">/* Use cached copy if we have it.</span>
<a name="l01177"></a>01177 <span class="comment">     We rely on forget_cached_source_info being called appropriately</span>
<a name="l01178"></a>01178 <span class="comment">     to handle cases like the file being moved.  */</span>
<a name="l01179"></a>01179   <span class="keywordflow">if</span> (ps-&gt;<a class="code" href="structpartial__symtab.html#aeaaef4856b449061d28624055c9c70d6">fullname</a> == NULL)
<a name="l01180"></a>01180     {
<a name="l01181"></a>01181       <span class="keywordtype">int</span> fd = <a class="code" href="source_8c.html#ae5539bbba8d780cb825400372c1dd5ea">find_and_open_source</a> (ps-&gt;<a class="code" href="structpartial__symtab.html#a6ea70ac87d6dbd541967bdd6dacd7321">filename</a>, ps-&gt;<a class="code" href="structpartial__symtab.html#a4861f775b1cc7a848abdf336238dbb37">dirname</a>, &amp;ps-&gt;<a class="code" href="structpartial__symtab.html#aeaaef4856b449061d28624055c9c70d6">fullname</a>);
<a name="l01182"></a>01182 
<a name="l01183"></a>01183       <span class="keywordflow">if</span> (fd &gt;= 0)
<a name="l01184"></a>01184         close (fd);
<a name="l01185"></a>01185       <span class="keywordflow">else</span>
<a name="l01186"></a>01186         {
<a name="l01187"></a>01187           <span class="keywordtype">char</span> *<a class="code" href="structpartial__symtab.html#aeaaef4856b449061d28624055c9c70d6">fullname</a>;
<a name="l01188"></a>01188           <span class="keyword">struct </span><a class="code" href="structcleanup.html">cleanup</a> *back_to;
<a name="l01189"></a>01189 
<a name="l01190"></a>01190           <span class="comment">/* rewrite_source_path would be applied by find_and_open_source, we</span>
<a name="l01191"></a>01191 <span class="comment">             should report the pathname where GDB tried to find the file.  */</span>
<a name="l01192"></a>01192 
<a name="l01193"></a>01193           <span class="keywordflow">if</span> (ps-&gt;<a class="code" href="structpartial__symtab.html#a4861f775b1cc7a848abdf336238dbb37">dirname</a> == NULL || IS_ABSOLUTE_PATH (ps-&gt;<a class="code" href="structpartial__symtab.html#a6ea70ac87d6dbd541967bdd6dacd7321">filename</a>))
<a name="l01194"></a>01194             fullname = xstrdup (ps-&gt;<a class="code" href="structpartial__symtab.html#a6ea70ac87d6dbd541967bdd6dacd7321">filename</a>);
<a name="l01195"></a>01195           <span class="keywordflow">else</span>
<a name="l01196"></a>01196             fullname = concat (ps-&gt;<a class="code" href="structpartial__symtab.html#a4861f775b1cc7a848abdf336238dbb37">dirname</a>, SLASH_STRING, ps-&gt;<a class="code" href="structpartial__symtab.html#a6ea70ac87d6dbd541967bdd6dacd7321">filename</a>, NULL);
<a name="l01197"></a>01197 
<a name="l01198"></a>01198           back_to = <a class="code" href="cleanups_8c.html#a3d418f8af424aec399898c2d48b26224">make_cleanup</a> (<a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a>, fullname);
<a name="l01199"></a>01199           ps-&gt;<a class="code" href="structpartial__symtab.html#aeaaef4856b449061d28624055c9c70d6">fullname</a> = <a class="code" href="source_8c.html#aec288411481bbf19a38b56b2a35eeb47">rewrite_source_path</a> (fullname);
<a name="l01200"></a>01200           <span class="keywordflow">if</span> (ps-&gt;<a class="code" href="structpartial__symtab.html#aeaaef4856b449061d28624055c9c70d6">fullname</a> == NULL)
<a name="l01201"></a>01201             ps-&gt;<a class="code" href="structpartial__symtab.html#aeaaef4856b449061d28624055c9c70d6">fullname</a> = xstrdup (fullname);
<a name="l01202"></a>01202           <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (back_to);
<a name="l01203"></a>01203         }
<a name="l01204"></a>01204     } 
<a name="l01205"></a>01205 
<a name="l01206"></a>01206   <span class="keywordflow">return</span> ps-&gt;<a class="code" href="structpartial__symtab.html#aeaaef4856b449061d28624055c9c70d6">fullname</a>;
<a name="l01207"></a>01207 }
<a name="l01208"></a>01208 
<a name="l01209"></a>01209 <span class="comment">/*  For all symbols, s, in BLOCK that are in NAMESPACE and match NAME</span>
<a name="l01210"></a>01210 <span class="comment">    according to the function MATCH, call CALLBACK(BLOCK, s, DATA).</span>
<a name="l01211"></a>01211 <span class="comment">    BLOCK is assumed to come from OBJFILE.  Returns 1 iff CALLBACK</span>
<a name="l01212"></a>01212 <span class="comment">    ever returns non-zero, and otherwise returns 0.  */</span>
<a name="l01213"></a>01213 
<a name="l01214"></a>01214 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l01215"></a><a class="code" href="psymtab_8c.html#a41373f241f669df040fd012da75d19d4">01215</a> <a class="code" href="psymtab_8c.html#a41373f241f669df040fd012da75d19d4">map_block</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> *name, <a class="code" href="symtab_8h.html#abbcd14557de81830c9e96ea4bdfc14aa">domain_enum</a> <span class="keyword">namespace</span>, <span class="keyword">struct</span> objfile *objfile,
<a name="l01216"></a>01216            <span class="keyword">struct</span> <a class="code" href="structblock.html">block</a> *<a class="code" href="structblock.html">block</a>,
<a name="l01217"></a>01217            <span class="keywordtype">int</span> (*callback) (<span class="keyword">struct</span> block *, <span class="keyword">struct</span> <a class="code" href="structsymbol.html">symbol</a> *, <span class="keywordtype">void</span> *),
<a name="l01218"></a>01218            <span class="keywordtype">void</span> *data, <a class="code" href="symfile_8h.html#a2b98a5062928ff31e334877e5cf444bd">symbol_compare_ftype</a> *match)
<a name="l01219"></a>01219 {
<a name="l01220"></a>01220   <span class="keyword">struct </span><a class="code" href="structblock__iterator.html">block_iterator</a> iter;
<a name="l01221"></a>01221   <span class="keyword">struct </span><a class="code" href="structsymbol.html">symbol</a> *sym;
<a name="l01222"></a>01222 
<a name="l01223"></a>01223   <span class="keywordflow">for</span> (sym = <a class="code" href="block_8c.html#a0938a1eb8284a627679b4f9c7017b641">block_iter_match_first</a> (block, name, match, &amp;iter);
<a name="l01224"></a>01224        sym != NULL; sym = <a class="code" href="block_8c.html#a2778671a23255479265eb187754ba06a">block_iter_match_next</a> (name, match, &amp;iter))
<a name="l01225"></a>01225     {
<a name="l01226"></a>01226       <span class="keywordflow">if</span> (<a class="code" href="symtab_8c.html#a0e427a626fe6f76b83881c89fe5e8155">symbol_matches_domain</a> (<a class="code" href="symtab_8h.html#a82fc22e60b1007c826a5ebf7d6593e78">SYMBOL_LANGUAGE</a> (sym), 
<a name="l01227"></a>01227                                  <a class="code" href="symtab_8h.html#a362f2f64212c0c45fb770a3f21ef5ab0">SYMBOL_DOMAIN</a> (sym), <span class="keyword">namespace</span>))
<a name="l01228"></a>01228         {
<a name="l01229"></a>01229           <span class="keywordflow">if</span> (callback (block, sym, data))
<a name="l01230"></a>01230             <span class="keywordflow">return</span> 1;
<a name="l01231"></a>01231         }
<a name="l01232"></a>01232     }
<a name="l01233"></a>01233 
<a name="l01234"></a>01234   <span class="keywordflow">return</span> 0;
<a name="l01235"></a>01235 }
<a name="l01236"></a>01236 
<a name="l01237"></a>01237 <span class="comment">/*  Psymtab version of map_matching_symbols.  See its definition in</span>
<a name="l01238"></a>01238 <span class="comment">    the definition of quick_symbol_functions in symfile.h.  */</span>
<a name="l01239"></a>01239 
<a name="l01240"></a>01240 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01241"></a><a class="code" href="psymtab_8c.html#a44408668ccab0e225f2157683c01ed64">01241</a> <a class="code" href="psymtab_8c.html#a44408668ccab0e225f2157683c01ed64">map_matching_symbols_psymtab</a> (<span class="keyword">struct</span> objfile *objfile,
<a name="l01242"></a>01242                               <span class="keyword">const</span> <span class="keywordtype">char</span> *name, <a class="code" href="symtab_8h.html#abbcd14557de81830c9e96ea4bdfc14aa">domain_enum</a> <span class="keyword">namespace</span>,
<a name="l01243"></a>01243                               <span class="keywordtype">int</span> global,
<a name="l01244"></a>01244                               <span class="keywordtype">int</span> (*callback) (<span class="keyword">struct</span> block *,
<a name="l01245"></a>01245                                                <span class="keyword">struct</span> <a class="code" href="structsymbol.html">symbol</a> *, <span class="keywordtype">void</span> *),
<a name="l01246"></a>01246                               <span class="keywordtype">void</span> *data,
<a name="l01247"></a>01247                               <a class="code" href="symfile_8h.html#a2b98a5062928ff31e334877e5cf444bd">symbol_compare_ftype</a> *match,
<a name="l01248"></a>01248                               <a class="code" href="symfile_8h.html#a2b98a5062928ff31e334877e5cf444bd">symbol_compare_ftype</a> *ordered_compare)
<a name="l01249"></a>01249 {
<a name="l01250"></a>01250   <span class="keyword">const</span> <span class="keywordtype">int</span> block_kind = global ? <a class="code" href="defs_8h.html#a8ec407cb404e1ae8ce984f792e83f124a973ee91cbe4b0cee4eb7603252a29bec">GLOBAL_BLOCK</a> : <a class="code" href="defs_8h.html#a8ec407cb404e1ae8ce984f792e83f124a4842990ca5391ee943c2069b28443a99">STATIC_BLOCK</a>;
<a name="l01251"></a>01251   <span class="keyword">struct </span><a class="code" href="structpartial__symtab.html">partial_symtab</a> *<a class="code" href="namespacecleanup__check.html#a2f9ce522b7667bef19a5777d12fa44d8">ps</a>;
<a name="l01252"></a>01252 
<a name="l01253"></a>01253   <a class="code" href="psymtab_8c.html#a3fbd70c118d9b449af634c15717d508e">ALL_OBJFILE_PSYMTABS_REQUIRED</a> (objfile, ps)
<a name="l01254"></a>01254     {
<a name="l01255"></a>01255       <a class="code" href="defs_8h.html#ad24e2b54375e12474e65ebf7175988fb">QUIT</a>;
<a name="l01256"></a>01256       <span class="keywordflow">if</span> (ps-&gt;<a class="code" href="structpartial__symtab.html#a11d8e59b962db1317c8c23f917dbed42">readin</a>
<a name="l01257"></a>01257           || <a class="code" href="psymtab_8c.html#a858899bc2b0798c6f9d38754434435a7">match_partial_symbol</a> (objfile, ps, global, name, <span class="keyword">namespace</span>, match,
<a name="l01258"></a>01258                                    ordered_compare))
<a name="l01259"></a>01259         {
<a name="l01260"></a>01260           <span class="keyword">struct </span><a class="code" href="structsymtab.html">symtab</a> *s = <a class="code" href="psymtab_8c.html#a9afb9c706b9a9f25e4395b9a95ce4c8a">psymtab_to_symtab</a> (objfile, ps);
<a name="l01261"></a>01261           <span class="keyword">struct </span>block *block;
<a name="l01262"></a>01262 
<a name="l01263"></a>01263           <span class="keywordflow">if</span> (s == NULL || !s-&gt;<a class="code" href="structsymtab.html#ac7b1b53ffb88e931203f53942070bc7f">primary</a>)
<a name="l01264"></a>01264             <span class="keywordflow">continue</span>;
<a name="l01265"></a>01265           block = <a class="code" href="block_8h.html#a84c4a3aa7b6b4d9a127a1c018dd6a776">BLOCKVECTOR_BLOCK</a> (<a class="code" href="symtab_8h.html#a6cd84410d73680ff8006ac44b1b98a9c">BLOCKVECTOR</a> (s), block_kind);
<a name="l01266"></a>01266           <span class="keywordflow">if</span> (<a class="code" href="psymtab_8c.html#a41373f241f669df040fd012da75d19d4">map_block</a> (name, <span class="keyword">namespace</span>, objfile, block,
<a name="l01267"></a>01267                          callback, data, match))
<a name="l01268"></a>01268             <span class="keywordflow">return</span>;
<a name="l01269"></a>01269           <span class="keywordflow">if</span> (callback (block, NULL, data))
<a name="l01270"></a>01270             <span class="keywordflow">return</span>;
<a name="l01271"></a>01271         }
<a name="l01272"></a>01272     }
<a name="l01273"></a>01273 }           
<a name="l01274"></a>01274 
<a name="l01275"></a>01275 <span class="comment">/* A helper for expand_symtabs_matching_via_partial that handles</span>
<a name="l01276"></a>01276 <span class="comment">   searching included psymtabs.  This returns 1 if a symbol is found,</span>
<a name="l01277"></a>01277 <span class="comment">   and zero otherwise.  It also updates the &#39;searched_flag&#39; on the</span>
<a name="l01278"></a>01278 <span class="comment">   various psymtabs that it searches.  */</span>
<a name="l01279"></a>01279 
<a name="l01280"></a>01280 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l01281"></a><a class="code" href="psymtab_8c.html#a79b1dabd8be0b2535a1aa6d48ff26370">01281</a> <a class="code" href="psymtab_8c.html#a79b1dabd8be0b2535a1aa6d48ff26370">recursively_search_psymtabs</a> (<span class="keyword">struct</span> <a class="code" href="structpartial__symtab.html">partial_symtab</a> *<a class="code" href="namespacecleanup__check.html#a2f9ce522b7667bef19a5777d12fa44d8">ps</a>,
<a name="l01282"></a>01282                              <span class="keyword">struct</span> objfile *objfile,
<a name="l01283"></a>01283                              <span class="keyword">enum</span> <a class="code" href="symtab_8h.html#a37678171929b3b399903eec8be25dcd5">search_domain</a> kind,
<a name="l01284"></a>01284                              <span class="keywordtype">int</span> (*name_matcher) (<span class="keyword">const</span> <span class="keywordtype">char</span> *, <span class="keywordtype">void</span> *),
<a name="l01285"></a>01285                              <span class="keywordtype">void</span> *data)
<a name="l01286"></a>01286 {
<a name="l01287"></a>01287   <span class="keyword">struct </span><a class="code" href="structpartial__symbol.html">partial_symbol</a> **psym;
<a name="l01288"></a>01288   <span class="keyword">struct </span><a class="code" href="structpartial__symbol.html">partial_symbol</a> **bound, **gbound, **sbound;
<a name="l01289"></a>01289   <span class="keywordtype">int</span> <a class="code" href="infrun_8c.html#a8851508f61d760f67cc2f9a5090f26c3">keep_going</a> = 1;
<a name="l01290"></a>01290   <span class="keywordtype">int</span> result = <a class="code" href="psympriv_8h.html#a05e490eb2fb92d92a6a94889e1542f6aadd099b835ae15327300cdab9c7e8bdd3">PST_SEARCHED_AND_NOT_FOUND</a>;
<a name="l01291"></a>01291   <span class="keywordtype">int</span> i;
<a name="l01292"></a>01292 
<a name="l01293"></a>01293   <span class="keywordflow">if</span> (ps-&gt;searched_flag != <a class="code" href="psympriv_8h.html#a05e490eb2fb92d92a6a94889e1542f6aabdf0e50d686428b37ad77805de2ade65">PST_NOT_SEARCHED</a>)
<a name="l01294"></a>01294     <span class="keywordflow">return</span> ps-&gt;searched_flag == <a class="code" href="psympriv_8h.html#a05e490eb2fb92d92a6a94889e1542f6aaf0334c35ccacb6d312fdf1eb732a08a7">PST_SEARCHED_AND_FOUND</a>;
<a name="l01295"></a>01295 
<a name="l01296"></a>01296   <span class="comment">/* Recurse into shared psymtabs first, because they may have already</span>
<a name="l01297"></a>01297 <span class="comment">     been searched, and this could save some time.  */</span>
<a name="l01298"></a>01298   <span class="keywordflow">for</span> (i = 0; i &lt; ps-&gt;<a class="code" href="structpartial__symtab.html#a917b503a5e1f7c2bb60feb6ff1e3b197">number_of_dependencies</a>; ++i)
<a name="l01299"></a>01299     {
<a name="l01300"></a>01300       <span class="keywordtype">int</span> r;
<a name="l01301"></a>01301 
<a name="l01302"></a>01302       <span class="comment">/* Skip non-shared dependencies, these are handled elsewhere.  */</span>
<a name="l01303"></a>01303       <span class="keywordflow">if</span> (ps-&gt;<a class="code" href="structpartial__symtab.html#a0b7bd5bada02a362357552790b111c23">dependencies</a>[i]-&gt;<a class="code" href="structpartial__symtab.html#a0609b1a2e29b3419dc25520e7d7293f0">user</a> == NULL)
<a name="l01304"></a>01304         <span class="keywordflow">continue</span>;
<a name="l01305"></a>01305 
<a name="l01306"></a>01306       r = <a class="code" href="psymtab_8c.html#a79b1dabd8be0b2535a1aa6d48ff26370">recursively_search_psymtabs</a> (ps-&gt;<a class="code" href="structpartial__symtab.html#a0b7bd5bada02a362357552790b111c23">dependencies</a>[i],
<a name="l01307"></a>01307                                        objfile, kind, name_matcher, data);
<a name="l01308"></a>01308       <span class="keywordflow">if</span> (r != 0)
<a name="l01309"></a>01309         {
<a name="l01310"></a>01310           ps-&gt;searched_flag = <a class="code" href="psympriv_8h.html#a05e490eb2fb92d92a6a94889e1542f6aaf0334c35ccacb6d312fdf1eb732a08a7">PST_SEARCHED_AND_FOUND</a>;
<a name="l01311"></a>01311           <span class="keywordflow">return</span> 1;
<a name="l01312"></a>01312         }
<a name="l01313"></a>01313     }
<a name="l01314"></a>01314 
<a name="l01315"></a>01315   gbound = (objfile-&gt;<a class="code" href="structobjfile.html#a5665fb90f8a5d1481cc59ed5cf6a86fa">global_psymbols</a>.<a class="code" href="structpsymbol__allocation__list.html#ac618c483c3ff07162cdfe508abd6034d">list</a>
<a name="l01316"></a>01316             + ps-&gt;<a class="code" href="structpartial__symtab.html#ae11f1094416fd506398f4a58fe4fa405">globals_offset</a> + ps-&gt;<a class="code" href="structpartial__symtab.html#ab26039959ff434afcf130049cfa8d27d">n_global_syms</a>);
<a name="l01317"></a>01317   sbound = (objfile-&gt;<a class="code" href="structobjfile.html#a365549b70c39eb429e3103991da9b3e6">static_psymbols</a>.<a class="code" href="structpsymbol__allocation__list.html#ac618c483c3ff07162cdfe508abd6034d">list</a>
<a name="l01318"></a>01318             + ps-&gt;<a class="code" href="structpartial__symtab.html#a36b8c771ea2906e413b8f1fffe1f4d10">statics_offset</a> + ps-&gt;<a class="code" href="structpartial__symtab.html#a0fd67e243d440beaf6cc4757a97ff9b0">n_static_syms</a>);
<a name="l01319"></a>01319   bound = gbound;
<a name="l01320"></a>01320 
<a name="l01321"></a>01321   <span class="comment">/* Go through all of the symbols stored in a partial</span>
<a name="l01322"></a>01322 <span class="comment">     symtab in one loop.  */</span>
<a name="l01323"></a>01323   psym = objfile-&gt;<a class="code" href="structobjfile.html#a5665fb90f8a5d1481cc59ed5cf6a86fa">global_psymbols</a>.<a class="code" href="structpsymbol__allocation__list.html#ac618c483c3ff07162cdfe508abd6034d">list</a> + ps-&gt;<a class="code" href="structpartial__symtab.html#ae11f1094416fd506398f4a58fe4fa405">globals_offset</a>;
<a name="l01324"></a>01324   <span class="keywordflow">while</span> (keep_going)
<a name="l01325"></a>01325     {
<a name="l01326"></a>01326       <span class="keywordflow">if</span> (psym &gt;= bound)
<a name="l01327"></a>01327         {
<a name="l01328"></a>01328           <span class="keywordflow">if</span> (bound == gbound &amp;&amp; ps-&gt;<a class="code" href="structpartial__symtab.html#a0fd67e243d440beaf6cc4757a97ff9b0">n_static_syms</a> != 0)
<a name="l01329"></a>01329             {
<a name="l01330"></a>01330               psym = objfile-&gt;<a class="code" href="structobjfile.html#a365549b70c39eb429e3103991da9b3e6">static_psymbols</a>.<a class="code" href="structpsymbol__allocation__list.html#ac618c483c3ff07162cdfe508abd6034d">list</a> + ps-&gt;<a class="code" href="structpartial__symtab.html#a36b8c771ea2906e413b8f1fffe1f4d10">statics_offset</a>;
<a name="l01331"></a>01331               bound = sbound;
<a name="l01332"></a>01332             }
<a name="l01333"></a>01333           <span class="keywordflow">else</span>
<a name="l01334"></a>01334             keep_going = 0;
<a name="l01335"></a>01335           <span class="keywordflow">continue</span>;
<a name="l01336"></a>01336         }
<a name="l01337"></a>01337       <span class="keywordflow">else</span>
<a name="l01338"></a>01338         {
<a name="l01339"></a>01339           <a class="code" href="defs_8h.html#ad24e2b54375e12474e65ebf7175988fb">QUIT</a>;
<a name="l01340"></a>01340 
<a name="l01341"></a>01341           <span class="keywordflow">if</span> ((kind == <a class="code" href="symtab_8h.html#a37678171929b3b399903eec8be25dcd5ac9f9f7eff869eba6d6d85c4046c31f6f">ALL_DOMAIN</a>
<a name="l01342"></a>01342                || (kind == <a class="code" href="symtab_8h.html#a37678171929b3b399903eec8be25dcd5a12470f2cb7373a9a19bd82b04cf1fe5e">VARIABLES_DOMAIN</a>
<a name="l01343"></a>01343                    &amp;&amp; <a class="code" href="psympriv_8h.html#acb5399267e28b8e4b2d8294ae490e700">PSYMBOL_CLASS</a> (*psym) != <a class="code" href="symtab_8h.html#a40bca6cf3ed5cfa15b1275e6750cdda3ac0b2498d37ddd0f48d23739bba4abca4">LOC_TYPEDEF</a>
<a name="l01344"></a>01344                    &amp;&amp; <a class="code" href="psympriv_8h.html#acb5399267e28b8e4b2d8294ae490e700">PSYMBOL_CLASS</a> (*psym) != <a class="code" href="symtab_8h.html#a40bca6cf3ed5cfa15b1275e6750cdda3a1f1e8d54397f35889104cd7766fcec2b">LOC_BLOCK</a>)
<a name="l01345"></a>01345                || (kind == <a class="code" href="symtab_8h.html#a37678171929b3b399903eec8be25dcd5a1f61ae1bab4f2263bf193b1260269e67">FUNCTIONS_DOMAIN</a>
<a name="l01346"></a>01346                    &amp;&amp; <a class="code" href="psympriv_8h.html#acb5399267e28b8e4b2d8294ae490e700">PSYMBOL_CLASS</a> (*psym) == <a class="code" href="symtab_8h.html#a40bca6cf3ed5cfa15b1275e6750cdda3a1f1e8d54397f35889104cd7766fcec2b">LOC_BLOCK</a>)
<a name="l01347"></a>01347                || (kind == <a class="code" href="symtab_8h.html#a37678171929b3b399903eec8be25dcd5a26fe3ebdde492058eb9dc6a0116288ef">TYPES_DOMAIN</a>
<a name="l01348"></a>01348                    &amp;&amp; <a class="code" href="psympriv_8h.html#acb5399267e28b8e4b2d8294ae490e700">PSYMBOL_CLASS</a> (*psym) == <a class="code" href="symtab_8h.html#a40bca6cf3ed5cfa15b1275e6750cdda3ac0b2498d37ddd0f48d23739bba4abca4">LOC_TYPEDEF</a>))
<a name="l01349"></a>01349               &amp;&amp; (*name_matcher) (<a class="code" href="symtab_8h.html#a16e484ff2bd09d4f0400caf5e3f8c3eb">SYMBOL_SEARCH_NAME</a> (*psym), data))
<a name="l01350"></a>01350             {
<a name="l01351"></a>01351               <span class="comment">/* Found a match, so notify our caller.  */</span>
<a name="l01352"></a>01352               result = <a class="code" href="psympriv_8h.html#a05e490eb2fb92d92a6a94889e1542f6aaf0334c35ccacb6d312fdf1eb732a08a7">PST_SEARCHED_AND_FOUND</a>;
<a name="l01353"></a>01353               keep_going = 0;
<a name="l01354"></a>01354             }
<a name="l01355"></a>01355         }
<a name="l01356"></a>01356       psym++;
<a name="l01357"></a>01357     }
<a name="l01358"></a>01358 
<a name="l01359"></a>01359   ps-&gt;searched_flag = result;
<a name="l01360"></a>01360   <span class="keywordflow">return</span> result == <a class="code" href="psympriv_8h.html#a05e490eb2fb92d92a6a94889e1542f6aaf0334c35ccacb6d312fdf1eb732a08a7">PST_SEARCHED_AND_FOUND</a>;
<a name="l01361"></a>01361 }
<a name="l01362"></a>01362 
<a name="l01363"></a>01363 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01364"></a>01364 <a class="code" href="psymtab_8c.html#abcfe25575ec07714014a17e1b240b47e">expand_symtabs_matching_via_partial</a>
<a name="l01365"></a><a class="code" href="psymtab_8c.html#abcfe25575ec07714014a17e1b240b47e">01365</a>   (<span class="keyword">struct</span> objfile *objfile,
<a name="l01366"></a>01366    <span class="keywordtype">int</span> (*file_matcher) (<span class="keyword">const</span> <span class="keywordtype">char</span> *, <span class="keywordtype">void</span> *, <span class="keywordtype">int</span> basenames),
<a name="l01367"></a>01367    <span class="keywordtype">int</span> (*name_matcher) (<span class="keyword">const</span> <span class="keywordtype">char</span> *, <span class="keywordtype">void</span> *),
<a name="l01368"></a>01368    <span class="keyword">enum</span> <a class="code" href="symtab_8h.html#a37678171929b3b399903eec8be25dcd5">search_domain</a> kind,
<a name="l01369"></a>01369    <span class="keywordtype">void</span> *data)
<a name="l01370"></a>01370 {
<a name="l01371"></a>01371   <span class="keyword">struct </span><a class="code" href="structpartial__symtab.html">partial_symtab</a> *<a class="code" href="namespacecleanup__check.html#a2f9ce522b7667bef19a5777d12fa44d8">ps</a>;
<a name="l01372"></a>01372 
<a name="l01373"></a>01373   <span class="comment">/* Clear the search flags.  */</span>
<a name="l01374"></a>01374   <a class="code" href="psymtab_8c.html#a3fbd70c118d9b449af634c15717d508e">ALL_OBJFILE_PSYMTABS_REQUIRED</a> (objfile, ps)
<a name="l01375"></a>01375     {
<a name="l01376"></a>01376       ps-&gt;searched_flag = <a class="code" href="psympriv_8h.html#a05e490eb2fb92d92a6a94889e1542f6aabdf0e50d686428b37ad77805de2ade65">PST_NOT_SEARCHED</a>;
<a name="l01377"></a>01377     }
<a name="l01378"></a>01378 
<a name="l01379"></a>01379   <a class="code" href="psymtab_8c.html#a3fbd70c118d9b449af634c15717d508e">ALL_OBJFILE_PSYMTABS_REQUIRED</a> (objfile, ps)
<a name="l01380"></a>01380     {
<a name="l01381"></a>01381       <span class="keywordflow">if</span> (ps-&gt;<a class="code" href="structpartial__symtab.html#a11d8e59b962db1317c8c23f917dbed42">readin</a>)
<a name="l01382"></a>01382         <span class="keywordflow">continue</span>;
<a name="l01383"></a>01383 
<a name="l01384"></a>01384       <span class="comment">/* We skip shared psymtabs because file-matching doesn&#39;t apply</span>
<a name="l01385"></a>01385 <span class="comment">         to them; but we search them later in the loop.  */</span>
<a name="l01386"></a>01386       <span class="keywordflow">if</span> (ps-&gt;<a class="code" href="structpartial__symtab.html#a0609b1a2e29b3419dc25520e7d7293f0">user</a> != NULL)
<a name="l01387"></a>01387         <span class="keywordflow">continue</span>;
<a name="l01388"></a>01388 
<a name="l01389"></a>01389       <span class="keywordflow">if</span> (file_matcher)
<a name="l01390"></a>01390         {
<a name="l01391"></a>01391           <span class="keywordtype">int</span> match;
<a name="l01392"></a>01392 
<a name="l01393"></a>01393           <span class="keywordflow">if</span> (ps-&gt;<a class="code" href="structpartial__symtab.html#a72ab74ae49f0048cc7151d786e724235">anonymous</a>)
<a name="l01394"></a>01394             <span class="keywordflow">continue</span>;
<a name="l01395"></a>01395 
<a name="l01396"></a>01396           match = (*file_matcher) (ps-&gt;<a class="code" href="structpartial__symtab.html#a6ea70ac87d6dbd541967bdd6dacd7321">filename</a>, data, 0);
<a name="l01397"></a>01397           <span class="keywordflow">if</span> (!match)
<a name="l01398"></a>01398             {
<a name="l01399"></a>01399               <span class="comment">/* Before we invoke realpath, which can get expensive when many</span>
<a name="l01400"></a>01400 <span class="comment">                 files are involved, do a quick comparison of the basenames.  */</span>
<a name="l01401"></a>01401               <span class="keywordflow">if</span> (<a class="code" href="symtab_8c.html#af9a62a674b6767f0981034f1ceb7756a">basenames_may_differ</a>
<a name="l01402"></a>01402                   || (*file_matcher) (lbasename (ps-&gt;<a class="code" href="structpartial__symtab.html#a6ea70ac87d6dbd541967bdd6dacd7321">filename</a>), data, 1))
<a name="l01403"></a>01403                 match = (*file_matcher) (<a class="code" href="psymtab_8c.html#af53cd102034592d4246538edbadc98fe">psymtab_to_fullname</a> (ps), data, 0);
<a name="l01404"></a>01404             }
<a name="l01405"></a>01405           <span class="keywordflow">if</span> (!match)
<a name="l01406"></a>01406             <span class="keywordflow">continue</span>;
<a name="l01407"></a>01407         }
<a name="l01408"></a>01408 
<a name="l01409"></a>01409       <span class="keywordflow">if</span> (<a class="code" href="psymtab_8c.html#a79b1dabd8be0b2535a1aa6d48ff26370">recursively_search_psymtabs</a> (ps, objfile, kind, name_matcher, data))
<a name="l01410"></a>01410         <a class="code" href="psymtab_8c.html#a9afb9c706b9a9f25e4395b9a95ce4c8a">psymtab_to_symtab</a> (objfile, ps);
<a name="l01411"></a>01411     }
<a name="l01412"></a>01412 }
<a name="l01413"></a>01413 
<a name="l01414"></a>01414 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l01415"></a><a class="code" href="psymtab_8c.html#a768a98e1c1a45d5c394de9a9b1929207">01415</a> <a class="code" href="psymtab_8c.html#a768a98e1c1a45d5c394de9a9b1929207">objfile_has_psyms</a> (<span class="keyword">struct</span> objfile *objfile)
<a name="l01416"></a>01416 {
<a name="l01417"></a>01417   <span class="keywordflow">return</span> objfile-&gt;<a class="code" href="structobjfile.html#a4dcbf92348a83fa9d6d5d2d08cb59eb5">psymtabs</a> != NULL;
<a name="l01418"></a>01418 }
<a name="l01419"></a>01419 
<a name="l01420"></a><a class="code" href="psymtab_8h.html#ac4f5f8556b4077b1396b89446cf220eb">01420</a> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structquick__symbol__functions.html">quick_symbol_functions</a> <a class="code" href="psymtab_8c.html#ac4f5f8556b4077b1396b89446cf220eb">psym_functions</a> =
<a name="l01421"></a>01421 {
<a name="l01422"></a>01422   <a class="code" href="psymtab_8c.html#a768a98e1c1a45d5c394de9a9b1929207">objfile_has_psyms</a>,
<a name="l01423"></a>01423   <a class="code" href="psymtab_8c.html#ab6fe688d3a6286282558045e8eca3016">find_last_source_symtab_from_partial</a>,
<a name="l01424"></a>01424   <a class="code" href="psymtab_8c.html#a898bad350618f20404dc2f93a87b1220">forget_cached_source_info_partial</a>,
<a name="l01425"></a>01425   <a class="code" href="psymtab_8c.html#a832ded68ab5e9e7810eaf81bf8b04598">partial_map_symtabs_matching_filename</a>,
<a name="l01426"></a>01426   <a class="code" href="psymtab_8c.html#a3f37b27a6ba097cead8506ccdded18fe">lookup_symbol_aux_psymtabs</a>,
<a name="l01427"></a>01427   <a class="code" href="psymtab_8c.html#acf2ef4edb85e0cb4d75a65c66597aa8b">print_psymtab_stats_for_objfile</a>,
<a name="l01428"></a>01428   <a class="code" href="psymtab_8c.html#ab98f306fac9b0ed1df47b94ab6bc2eb8">dump_psymtabs_for_objfile</a>,
<a name="l01429"></a>01429   <a class="code" href="psymtab_8c.html#a1a7f71f4c1748ebc9a0cadc768f0ba8e">relocate_psymtabs</a>,
<a name="l01430"></a>01430   <a class="code" href="psymtab_8c.html#a3fbbaceb2887d3e45fafcf7f94ef99ff">read_symtabs_for_function</a>,
<a name="l01431"></a>01431   <a class="code" href="psymtab_8c.html#a987f53ffd20fc1cad58009e7701f7460">expand_partial_symbol_tables</a>,
<a name="l01432"></a>01432   <a class="code" href="psymtab_8c.html#a0a4d5906ce91ec7bd30054e9f0476d7c">read_psymtabs_with_fullname</a>,
<a name="l01433"></a>01433   <a class="code" href="psymtab_8c.html#a44408668ccab0e225f2157683c01ed64">map_matching_symbols_psymtab</a>,
<a name="l01434"></a>01434   <a class="code" href="psymtab_8c.html#abcfe25575ec07714014a17e1b240b47e">expand_symtabs_matching_via_partial</a>,
<a name="l01435"></a>01435   <a class="code" href="psymtab_8c.html#a4bc5ff8b9e909f45bb1fbd3daa21038b">find_pc_sect_symtab_from_partial</a>,
<a name="l01436"></a>01436   <a class="code" href="psymtab_8c.html#abdea7e9ab52b049507df90715fab7fb8">map_symbol_filenames_psymtab</a>
<a name="l01437"></a>01437 };
<a name="l01438"></a>01438 
<a name="l01439"></a>01439 
<a name="l01440"></a>01440 
<a name="l01441"></a>01441 <span class="comment">/* This compares two partial symbols by names, using strcmp_iw_ordered</span>
<a name="l01442"></a>01442 <span class="comment">   for the comparison.  */</span>
<a name="l01443"></a>01443 
<a name="l01444"></a>01444 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l01445"></a><a class="code" href="psymtab_8c.html#a6ab3c1a601114f77d59fdb3a7840e5a4">01445</a> <a class="code" href="psymtab_8c.html#a6ab3c1a601114f77d59fdb3a7840e5a4">compare_psymbols</a> (<span class="keyword">const</span> <span class="keywordtype">void</span> *s1p, <span class="keyword">const</span> <span class="keywordtype">void</span> *s2p)
<a name="l01446"></a>01446 {
<a name="l01447"></a>01447   <span class="keyword">struct </span><a class="code" href="structpartial__symbol.html">partial_symbol</a> *<span class="keyword">const</span> *s1 = s1p;
<a name="l01448"></a>01448   <span class="keyword">struct </span><a class="code" href="structpartial__symbol.html">partial_symbol</a> *<span class="keyword">const</span> *s2 = s2p;
<a name="l01449"></a>01449 
<a name="l01450"></a>01450   <span class="keywordflow">return</span> <a class="code" href="utils_8c.html#a75e0024041a6c68cde74b1ee53a5e55e">strcmp_iw_ordered</a> (<a class="code" href="symtab_8h.html#a16e484ff2bd09d4f0400caf5e3f8c3eb">SYMBOL_SEARCH_NAME</a> (*s1),
<a name="l01451"></a>01451                             <a class="code" href="symtab_8h.html#a16e484ff2bd09d4f0400caf5e3f8c3eb">SYMBOL_SEARCH_NAME</a> (*s2));
<a name="l01452"></a>01452 }
<a name="l01453"></a>01453 
<a name="l01454"></a>01454 <span class="keywordtype">void</span>
<a name="l01455"></a><a class="code" href="psymtab_8c.html#a620a1710d75b7c077882cb2881cdb539">01455</a> <a class="code" href="psympriv_8h.html#a6cea36b8ce21ebe0c95e2cab2a0fc4eb">sort_pst_symbols</a> (<span class="keyword">struct</span> objfile *objfile, <span class="keyword">struct</span> <a class="code" href="structpartial__symtab.html">partial_symtab</a> *pst)
<a name="l01456"></a>01456 {
<a name="l01457"></a>01457   <span class="comment">/* Sort the global list; don&#39;t sort the static list.  */</span>
<a name="l01458"></a>01458 
<a name="l01459"></a>01459   <a class="code" href="ada-exp_8c.html#a849e2297facde4d3c80dc4f45f8abbdb">qsort</a> (objfile-&gt;<a class="code" href="structobjfile.html#a5665fb90f8a5d1481cc59ed5cf6a86fa">global_psymbols</a>.<a class="code" href="structpsymbol__allocation__list.html#ac618c483c3ff07162cdfe508abd6034d">list</a> + pst-&gt;<a class="code" href="structpartial__symtab.html#ae11f1094416fd506398f4a58fe4fa405">globals_offset</a>,
<a name="l01460"></a>01460          pst-&gt;<a class="code" href="structpartial__symtab.html#ab26039959ff434afcf130049cfa8d27d">n_global_syms</a>, sizeof (<span class="keyword">struct</span> <a class="code" href="structpartial__symbol.html">partial_symbol</a> *),
<a name="l01461"></a>01461          <a class="code" href="psymtab_8c.html#a6ab3c1a601114f77d59fdb3a7840e5a4">compare_psymbols</a>);
<a name="l01462"></a>01462 }
<a name="l01463"></a>01463 
<a name="l01464"></a>01464 <span class="comment">/* Allocate and partially fill a partial symtab.  It will be</span>
<a name="l01465"></a>01465 <span class="comment">   completely filled at the end of the symbol list.</span>
<a name="l01466"></a>01466 <span class="comment"></span>
<a name="l01467"></a>01467 <span class="comment">   FILENAME is the name of the symbol-file we are reading from.  */</span>
<a name="l01468"></a>01468 
<a name="l01469"></a>01469 <span class="keyword">struct </span><a class="code" href="structpartial__symtab.html">partial_symtab</a> *
<a name="l01470"></a><a class="code" href="psymtab_8c.html#a940c55eab1275841e27016ad69fdb9bb">01470</a> <a class="code" href="psympriv_8h.html#ae1da6f85572732c205a3d0e7bfaa4898">start_psymtab_common</a> (<span class="keyword">struct</span> objfile *objfile,
<a name="l01471"></a>01471                       <span class="keyword">struct</span> <a class="code" href="structsection__offsets.html">section_offsets</a> *<a class="code" href="structsection__offsets.html">section_offsets</a>,
<a name="l01472"></a>01472                       <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structpartial__symtab.html#a6ea70ac87d6dbd541967bdd6dacd7321">filename</a>,
<a name="l01473"></a>01473                       <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> <a class="code" href="structpartial__symtab.html#a194e7d3c21d81ce56b81d1fe02e1dbc3">textlow</a>, <span class="keyword">struct</span> <a class="code" href="structpartial__symbol.html">partial_symbol</a> **global_syms,
<a name="l01474"></a>01474                       <span class="keyword">struct</span> <a class="code" href="structpartial__symbol.html">partial_symbol</a> **static_syms)
<a name="l01475"></a>01475 {
<a name="l01476"></a>01476   <span class="keyword">struct </span><a class="code" href="structpartial__symtab.html">partial_symtab</a> *psymtab;
<a name="l01477"></a>01477 
<a name="l01478"></a>01478   psymtab = <a class="code" href="psympriv_8h.html#aaab6295ffb54728aaa0817aa18c4c61c">allocate_psymtab</a> (filename, objfile);
<a name="l01479"></a>01479   psymtab-&gt;<a class="code" href="structpartial__symtab.html#abdbad327cdb56a7663e18f1f14e18730">section_offsets</a> = <a class="code" href="structpartial__symtab.html#abdbad327cdb56a7663e18f1f14e18730">section_offsets</a>;
<a name="l01480"></a>01480   psymtab-&gt;<a class="code" href="structpartial__symtab.html#a194e7d3c21d81ce56b81d1fe02e1dbc3">textlow</a> = <a class="code" href="structpartial__symtab.html#a194e7d3c21d81ce56b81d1fe02e1dbc3">textlow</a>;
<a name="l01481"></a>01481   psymtab-&gt;<a class="code" href="structpartial__symtab.html#aa582095c68fb326f3042ad672527a438">texthigh</a> = psymtab-&gt;<a class="code" href="structpartial__symtab.html#a194e7d3c21d81ce56b81d1fe02e1dbc3">textlow</a>;         <span class="comment">/* default */</span>
<a name="l01482"></a>01482   psymtab-&gt;<a class="code" href="structpartial__symtab.html#ae11f1094416fd506398f4a58fe4fa405">globals_offset</a> = global_syms - objfile-&gt;<a class="code" href="structobjfile.html#a5665fb90f8a5d1481cc59ed5cf6a86fa">global_psymbols</a>.<a class="code" href="structpsymbol__allocation__list.html#ac618c483c3ff07162cdfe508abd6034d">list</a>;
<a name="l01483"></a>01483   psymtab-&gt;<a class="code" href="structpartial__symtab.html#a36b8c771ea2906e413b8f1fffe1f4d10">statics_offset</a> = static_syms - objfile-&gt;<a class="code" href="structobjfile.html#a365549b70c39eb429e3103991da9b3e6">static_psymbols</a>.<a class="code" href="structpsymbol__allocation__list.html#ac618c483c3ff07162cdfe508abd6034d">list</a>;
<a name="l01484"></a>01484   <span class="keywordflow">return</span> (psymtab);
<a name="l01485"></a>01485 }
<a name="l01486"></a>01486 
<a name="l01487"></a>01487 <span class="comment">/* Calculate a hash code for the given partial symbol.  The hash is</span>
<a name="l01488"></a>01488 <span class="comment">   calculated using the symbol&#39;s value, language, domain, class</span>
<a name="l01489"></a>01489 <span class="comment">   and name.  These are the values which are set by</span>
<a name="l01490"></a>01490 <span class="comment">   add_psymbol_to_bcache.  */</span>
<a name="l01491"></a>01491 
<a name="l01492"></a>01492 <span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>
<a name="l01493"></a><a class="code" href="psymtab_8c.html#ac286a1ff174fc5190083f001d7236f78">01493</a> <a class="code" href="psymtab_8c.html#ac286a1ff174fc5190083f001d7236f78">psymbol_hash</a> (<span class="keyword">const</span> <span class="keywordtype">void</span> *addr, <span class="keywordtype">int</span> length)
<a name="l01494"></a>01494 {
<a name="l01495"></a>01495   <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> h = 0;
<a name="l01496"></a>01496   <span class="keyword">struct </span><a class="code" href="structpartial__symbol.html">partial_symbol</a> *psymbol = (<span class="keyword">struct </span><a class="code" href="structpartial__symbol.html">partial_symbol</a> *) addr;
<a name="l01497"></a>01497   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> lang = psymbol-&gt;<a class="code" href="structpartial__symbol.html#a572d3210ebeea0d15085bd9ed6e153d6">ginfo</a>.language;
<a name="l01498"></a>01498   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> domain = <a class="code" href="psympriv_8h.html#a86c7a1603b0e6af0457e79b5d9af71e6">PSYMBOL_DOMAIN</a> (psymbol);
<a name="l01499"></a>01499   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <span class="keyword">class </span>= <a class="code" href="psympriv_8h.html#acb5399267e28b8e4b2d8294ae490e700">PSYMBOL_CLASS</a> (psymbol);
<a name="l01500"></a>01500 
<a name="l01501"></a>01501   h = <a class="code" href="bcache_8c.html#a9b49b664b0a54f9a234d99c9413f9551">hash_continue</a> (&amp;psymbol-&gt;ginfo.value, sizeof (psymbol-&gt;ginfo.value), h);
<a name="l01502"></a>01502   h = <a class="code" href="bcache_8c.html#a9b49b664b0a54f9a234d99c9413f9551">hash_continue</a> (&amp;lang, <span class="keyword">sizeof</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>), h);
<a name="l01503"></a>01503   h = <a class="code" href="bcache_8c.html#a9b49b664b0a54f9a234d99c9413f9551">hash_continue</a> (&amp;domain, <span class="keyword">sizeof</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>), h);
<a name="l01504"></a>01504   h = <a class="code" href="bcache_8c.html#a9b49b664b0a54f9a234d99c9413f9551">hash_continue</a> (&amp;<span class="keyword">class</span>, <span class="keyword">sizeof</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>), h);
<a name="l01505"></a>01505   h = <a class="code" href="bcache_8c.html#a9b49b664b0a54f9a234d99c9413f9551">hash_continue</a> (psymbol-&gt;ginfo.name, strlen (psymbol-&gt;ginfo.name), h);
<a name="l01506"></a>01506 
<a name="l01507"></a>01507   <span class="keywordflow">return</span> h;
<a name="l01508"></a>01508 }
<a name="l01509"></a>01509 
<a name="l01510"></a>01510 <span class="comment">/* Returns true if the symbol at addr1 equals the symbol at addr2.</span>
<a name="l01511"></a>01511 <span class="comment">   For the comparison this function uses a symbols value,</span>
<a name="l01512"></a>01512 <span class="comment">   language, domain, class and name.  */</span>
<a name="l01513"></a>01513 
<a name="l01514"></a>01514 <span class="keyword">static</span> <span class="keywordtype">int</span>
<a name="l01515"></a><a class="code" href="psymtab_8c.html#a5fff3492b17e4b5c068439c2709246fd">01515</a> <a class="code" href="psymtab_8c.html#a5fff3492b17e4b5c068439c2709246fd">psymbol_compare</a> (<span class="keyword">const</span> <span class="keywordtype">void</span> *addr1, <span class="keyword">const</span> <span class="keywordtype">void</span> *addr2, <span class="keywordtype">int</span> length)
<a name="l01516"></a>01516 {
<a name="l01517"></a>01517   <span class="keyword">struct </span><a class="code" href="structpartial__symbol.html">partial_symbol</a> *sym1 = (<span class="keyword">struct </span><a class="code" href="structpartial__symbol.html">partial_symbol</a> *) addr1;
<a name="l01518"></a>01518   <span class="keyword">struct </span><a class="code" href="structpartial__symbol.html">partial_symbol</a> *sym2 = (<span class="keyword">struct </span><a class="code" href="structpartial__symbol.html">partial_symbol</a> *) addr2;
<a name="l01519"></a>01519 
<a name="l01520"></a>01520   <span class="keywordflow">return</span> (<a class="code" href="gdb__string_8h.html#a65c3e6b23d6855c86acaf147853c82cc">memcmp</a> (&amp;sym1-&gt;<a class="code" href="structpartial__symbol.html#a572d3210ebeea0d15085bd9ed6e153d6">ginfo</a>.<a class="code" href="structgeneral__symbol__info.html#a208143347b14b4febd5aa8bcfdf17e28">value</a>, &amp;sym1-&gt;<a class="code" href="structpartial__symbol.html#a572d3210ebeea0d15085bd9ed6e153d6">ginfo</a>.<a class="code" href="structgeneral__symbol__info.html#a208143347b14b4febd5aa8bcfdf17e28">value</a>,
<a name="l01521"></a>01521                   sizeof (sym1-&gt;<a class="code" href="structpartial__symbol.html#a572d3210ebeea0d15085bd9ed6e153d6">ginfo</a>.<a class="code" href="structgeneral__symbol__info.html#a208143347b14b4febd5aa8bcfdf17e28">value</a>)) == 0
<a name="l01522"></a>01522           &amp;&amp; sym1-&gt;<a class="code" href="structpartial__symbol.html#a572d3210ebeea0d15085bd9ed6e153d6">ginfo</a>.language == sym2-&gt;<a class="code" href="structpartial__symbol.html#a572d3210ebeea0d15085bd9ed6e153d6">ginfo</a>.language
<a name="l01523"></a>01523           &amp;&amp; <a class="code" href="psympriv_8h.html#a86c7a1603b0e6af0457e79b5d9af71e6">PSYMBOL_DOMAIN</a> (sym1) == <a class="code" href="psympriv_8h.html#a86c7a1603b0e6af0457e79b5d9af71e6">PSYMBOL_DOMAIN</a> (sym2)
<a name="l01524"></a>01524           &amp;&amp; <a class="code" href="psympriv_8h.html#acb5399267e28b8e4b2d8294ae490e700">PSYMBOL_CLASS</a> (sym1) == <a class="code" href="psympriv_8h.html#acb5399267e28b8e4b2d8294ae490e700">PSYMBOL_CLASS</a> (sym2)
<a name="l01525"></a>01525           &amp;&amp; sym1-&gt;<a class="code" href="structpartial__symbol.html#a572d3210ebeea0d15085bd9ed6e153d6">ginfo</a>.<a class="code" href="structgeneral__symbol__info.html#a4347da5f5930f7be0ae6d9e400304884">name</a> == sym2-&gt;<a class="code" href="structpartial__symbol.html#a572d3210ebeea0d15085bd9ed6e153d6">ginfo</a>.<a class="code" href="structgeneral__symbol__info.html#a4347da5f5930f7be0ae6d9e400304884">name</a>);
<a name="l01526"></a>01526 }
<a name="l01527"></a>01527 
<a name="l01528"></a>01528 <span class="comment">/* Initialize a partial symbol bcache.  */</span>
<a name="l01529"></a>01529 
<a name="l01530"></a>01530 <span class="keyword">struct </span><a class="code" href="structpsymbol__bcache.html">psymbol_bcache</a> *
<a name="l01531"></a><a class="code" href="psymtab_8h.html#ae0710dfcb0b2be4aae8ae595004ee27f">01531</a> <a class="code" href="psymtab_8c.html#ae0710dfcb0b2be4aae8ae595004ee27f">psymbol_bcache_init</a> (<span class="keywordtype">void</span>)
<a name="l01532"></a>01532 {
<a name="l01533"></a>01533   <span class="keyword">struct </span><a class="code" href="structpsymbol__bcache.html">psymbol_bcache</a> *<a class="code" href="structbcache.html">bcache</a> = <a class="code" href="defs_8h.html#a4c67016fda510e35550be38ad53c44d1">XCALLOC</a> (1, <span class="keyword">struct</span> <a class="code" href="structpsymbol__bcache.html">psymbol_bcache</a>);
<a name="l01534"></a>01534   bcache-&gt;<a class="code" href="structpsymbol__bcache.html#aabaebf31fe72a442e512063481704905">bcache</a> = <a class="code" href="bcache_8c.html#a37a65394e02f4fee32368807f268da8a">bcache_xmalloc</a> (<a class="code" href="psymtab_8c.html#ac286a1ff174fc5190083f001d7236f78">psymbol_hash</a>, <a class="code" href="psymtab_8c.html#a5fff3492b17e4b5c068439c2709246fd">psymbol_compare</a>);
<a name="l01535"></a>01535   <span class="keywordflow">return</span> <a class="code" href="bcache_8c.html#afa8fdf176cc100675ae2e506b24b9ee9">bcache</a>;
<a name="l01536"></a>01536 }
<a name="l01537"></a>01537 
<a name="l01538"></a>01538 <span class="comment">/* Free a partial symbol bcache.  */</span>
<a name="l01539"></a>01539 <span class="keywordtype">void</span>
<a name="l01540"></a><a class="code" href="psymtab_8h.html#a5257a966650ed0bb585a16bf71c46d6a">01540</a> <a class="code" href="psymtab_8c.html#ad8dd0fdd246e93a932ef858576f8ebc0">psymbol_bcache_free</a> (<span class="keyword">struct</span> <a class="code" href="structpsymbol__bcache.html">psymbol_bcache</a> *<a class="code" href="structbcache.html">bcache</a>)
<a name="l01541"></a>01541 {
<a name="l01542"></a>01542   <span class="keywordflow">if</span> (bcache == NULL)
<a name="l01543"></a>01543     <span class="keywordflow">return</span>;
<a name="l01544"></a>01544 
<a name="l01545"></a>01545   <a class="code" href="bcache_8c.html#af8aceee05a2e20e2dd76c3c512d0e2db">bcache_xfree</a> (bcache-&gt;<a class="code" href="structpsymbol__bcache.html#aabaebf31fe72a442e512063481704905">bcache</a>);
<a name="l01546"></a>01546   <a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a> (bcache);
<a name="l01547"></a>01547 }
<a name="l01548"></a>01548 
<a name="l01549"></a>01549 <span class="comment">/* Return the internal bcache of the psymbol_bcache BCACHE.  */</span>
<a name="l01550"></a>01550 
<a name="l01551"></a>01551 <span class="keyword">struct </span><a class="code" href="structbcache.html">bcache</a> *
<a name="l01552"></a><a class="code" href="psymtab_8h.html#ae64fc80919b12a0e91304d8caf3abd89">01552</a> <a class="code" href="psymtab_8c.html#a9460c303abe27e2f4d3e25d2b99e4811">psymbol_bcache_get_bcache</a> (<span class="keyword">struct</span> <a class="code" href="structpsymbol__bcache.html">psymbol_bcache</a> *<a class="code" href="structbcache.html">bcache</a>)
<a name="l01553"></a>01553 {
<a name="l01554"></a>01554   <span class="keywordflow">return</span> bcache-&gt;<a class="code" href="structpsymbol__bcache.html#aabaebf31fe72a442e512063481704905">bcache</a>;
<a name="l01555"></a>01555 }
<a name="l01556"></a>01556 
<a name="l01557"></a>01557 <span class="comment">/* Find a copy of the SYM in BCACHE.  If BCACHE has never seen this</span>
<a name="l01558"></a>01558 <span class="comment">   symbol before, add a copy to BCACHE.  In either case, return a pointer</span>
<a name="l01559"></a>01559 <span class="comment">   to BCACHE&#39;s copy of the symbol.  If optional ADDED is not NULL, return</span>
<a name="l01560"></a>01560 <span class="comment">   1 in case of new entry or 0 if returning an old entry.  */</span>
<a name="l01561"></a>01561 
<a name="l01562"></a>01562 <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structpartial__symbol.html">partial_symbol</a> *
<a name="l01563"></a><a class="code" href="psymtab_8c.html#ab371c887d8720bd84e7dfe5fda37f116">01563</a> <a class="code" href="psymtab_8c.html#ab371c887d8720bd84e7dfe5fda37f116">psymbol_bcache_full</a> (<span class="keyword">struct</span> <a class="code" href="structpartial__symbol.html">partial_symbol</a> *sym,
<a name="l01564"></a>01564                      <span class="keyword">struct</span> <a class="code" href="structpsymbol__bcache.html">psymbol_bcache</a> *<a class="code" href="structbcache.html">bcache</a>,
<a name="l01565"></a>01565                      <span class="keywordtype">int</span> *added)
<a name="l01566"></a>01566 {
<a name="l01567"></a>01567   <span class="keywordflow">return</span> <a class="code" href="bcache_8c.html#a47abebcb4beade5fead027c476961d73">bcache_full</a> (sym,
<a name="l01568"></a>01568                       <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structpartial__symbol.html">partial_symbol</a>),
<a name="l01569"></a>01569                       bcache-&gt;<a class="code" href="structpsymbol__bcache.html#aabaebf31fe72a442e512063481704905">bcache</a>,
<a name="l01570"></a>01570                       added);
<a name="l01571"></a>01571 }
<a name="l01572"></a>01572 
<a name="l01573"></a>01573 <span class="comment">/* Helper function, initialises partial symbol structure and stashes </span>
<a name="l01574"></a>01574 <span class="comment">   it into objfile&#39;s bcache.  Note that our caching mechanism will</span>
<a name="l01575"></a>01575 <span class="comment">   use all fields of struct partial_symbol to determine hash value of the</span>
<a name="l01576"></a>01576 <span class="comment">   structure.  In other words, having two symbols with the same name but</span>
<a name="l01577"></a>01577 <span class="comment">   different domain (or address) is possible and correct.  */</span>
<a name="l01578"></a>01578 
<a name="l01579"></a>01579 <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structpartial__symbol.html">partial_symbol</a> *
<a name="l01580"></a><a class="code" href="psymtab_8c.html#af862db56fc1c66a8f923e956fb025def">01580</a> <a class="code" href="psymtab_8c.html#af862db56fc1c66a8f923e956fb025def">add_psymbol_to_bcache</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keywordtype">int</span> namelength, <span class="keywordtype">int</span> <a class="code" href="parse_8c.html#ae2c3f5e61c639d2b9821cbb548bbe10c">copy_name</a>,
<a name="l01581"></a>01581                        <a class="code" href="symtab_8h.html#abbcd14557de81830c9e96ea4bdfc14aa">domain_enum</a> domain,
<a name="l01582"></a>01582                        <span class="keyword">enum</span> <a class="code" href="symtab_8h.html#a40bca6cf3ed5cfa15b1275e6750cdda3">address_class</a> <span class="keyword">class</span>,
<a name="l01583"></a>01583                        <span class="keywordtype">long</span> val,        <span class="comment">/* Value as a long */</span>
<a name="l01584"></a>01584                        <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> coreaddr,      <span class="comment">/* Value as a CORE_ADDR */</span>
<a name="l01585"></a>01585                        <span class="keyword">enum</span> <a class="code" href="defs_8h.html#aa37aa8979934d47ac32fd96ecff32202">language</a> <a class="code" href="defs_8h.html#aa37aa8979934d47ac32fd96ecff32202">language</a>, <span class="keyword">struct</span> objfile *objfile,
<a name="l01586"></a>01586                        <span class="keywordtype">int</span> *added)
<a name="l01587"></a>01587 {
<a name="l01588"></a>01588   <span class="keyword">struct </span><a class="code" href="structpartial__symbol.html">partial_symbol</a> psymbol;
<a name="l01589"></a>01589 
<a name="l01590"></a>01590   <span class="comment">/* We must ensure that the entire struct has been zeroed before</span>
<a name="l01591"></a>01591 <span class="comment">     assigning to it, because an assignment may not touch some of the</span>
<a name="l01592"></a>01592 <span class="comment">     holes.  */</span>
<a name="l01593"></a>01593   <a class="code" href="gdb__string_8h.html#adb03df3679ce1445e801310614624ccb">memset</a> (&amp;psymbol, 0, <span class="keyword">sizeof</span> (psymbol));
<a name="l01594"></a>01594 
<a name="l01595"></a>01595   <span class="comment">/* val and coreaddr are mutually exclusive, one of them *will* be zero.  */</span>
<a name="l01596"></a>01596   <span class="keywordflow">if</span> (val != 0)
<a name="l01597"></a>01597     {
<a name="l01598"></a>01598       <a class="code" href="symtab_8h.html#a31840856d8e3eed18cbe9ca90cd2bf39">SYMBOL_VALUE</a> (&amp;psymbol) = val;
<a name="l01599"></a>01599     }
<a name="l01600"></a>01600   <span class="keywordflow">else</span>
<a name="l01601"></a>01601     {
<a name="l01602"></a>01602       <a class="code" href="symtab_8h.html#abee697b9e3bb4f4d164ad920a87ab854">SYMBOL_VALUE_ADDRESS</a> (&amp;psymbol) = coreaddr;
<a name="l01603"></a>01603     }
<a name="l01604"></a>01604   <a class="code" href="symtab_8h.html#a9e82ed3317c58c4b85104d87e738fada">SYMBOL_SECTION</a> (&amp;psymbol) = -1;
<a name="l01605"></a>01605   <a class="code" href="symtab_8h.html#add78e67f78de1edd9f8aa220f11bfd89">SYMBOL_SET_LANGUAGE</a> (&amp;psymbol, language, &amp;objfile-&gt;<a class="code" href="structobjfile.html#aab9cedc53383f1b540f0b725edd2d9be">objfile_obstack</a>);
<a name="l01606"></a>01606   <a class="code" href="psympriv_8h.html#a86c7a1603b0e6af0457e79b5d9af71e6">PSYMBOL_DOMAIN</a> (&amp;psymbol) = domain;
<a name="l01607"></a>01607   <a class="code" href="psympriv_8h.html#acb5399267e28b8e4b2d8294ae490e700">PSYMBOL_CLASS</a> (&amp;psymbol) = <span class="keyword">class</span>;
<a name="l01608"></a>01608 
<a name="l01609"></a>01609   <a class="code" href="symtab_8h.html#a1f31078ca0e1d9517eb48e71fe7d53f9">SYMBOL_SET_NAMES</a> (&amp;psymbol, name, namelength, copy_name, objfile);
<a name="l01610"></a>01610 
<a name="l01611"></a>01611   <span class="comment">/* Stash the partial symbol away in the cache.  */</span>
<a name="l01612"></a>01612   <span class="keywordflow">return</span> <a class="code" href="psymtab_8c.html#ab371c887d8720bd84e7dfe5fda37f116">psymbol_bcache_full</a> (&amp;psymbol,
<a name="l01613"></a>01613                               objfile-&gt;<a class="code" href="structobjfile.html#a48c765fff8299f429430792b1864ce38">psymbol_cache</a>,
<a name="l01614"></a>01614                               added);
<a name="l01615"></a>01615 }
<a name="l01616"></a>01616 
<a name="l01617"></a>01617 <span class="comment">/* Increase the space allocated for LISTP, which is probably</span>
<a name="l01618"></a>01618 <span class="comment">   global_psymbols or static_psymbols.  This space will eventually</span>
<a name="l01619"></a>01619 <span class="comment">   be freed in free_objfile().  */</span>
<a name="l01620"></a>01620 
<a name="l01621"></a>01621 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01622"></a><a class="code" href="psymtab_8c.html#a16e9cb9f6fe30eff1bb6556c144bec2c">01622</a> <a class="code" href="psymtab_8c.html#a16e9cb9f6fe30eff1bb6556c144bec2c">extend_psymbol_list</a> (<span class="keyword">struct</span> <a class="code" href="structpsymbol__allocation__list.html">psymbol_allocation_list</a> *listp,
<a name="l01623"></a>01623                      <span class="keyword">struct</span> objfile *objfile)
<a name="l01624"></a>01624 {
<a name="l01625"></a>01625   <span class="keywordtype">int</span> new_size;
<a name="l01626"></a>01626 
<a name="l01627"></a>01627   <span class="keywordflow">if</span> (listp-&gt;<a class="code" href="structpsymbol__allocation__list.html#ad9937316024e2a8589a4e04d080e74eb">size</a> == 0)
<a name="l01628"></a>01628     {
<a name="l01629"></a>01629       new_size = 255;
<a name="l01630"></a>01630       listp-&gt;<a class="code" href="structpsymbol__allocation__list.html#ac618c483c3ff07162cdfe508abd6034d">list</a> = (<span class="keyword">struct </span><a class="code" href="structpartial__symbol.html">partial_symbol</a> **)
<a name="l01631"></a>01631         <a class="code" href="common-utils_8c.html#a634d6cd850bb831afebc499579303b3b">xmalloc</a> (new_size * <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structpartial__symbol.html">partial_symbol</a> *));
<a name="l01632"></a>01632     }
<a name="l01633"></a>01633   <span class="keywordflow">else</span>
<a name="l01634"></a>01634     {
<a name="l01635"></a>01635       new_size = listp-&gt;<a class="code" href="structpsymbol__allocation__list.html#ad9937316024e2a8589a4e04d080e74eb">size</a> * 2;
<a name="l01636"></a>01636       listp-&gt;<a class="code" href="structpsymbol__allocation__list.html#ac618c483c3ff07162cdfe508abd6034d">list</a> = (<span class="keyword">struct </span><a class="code" href="structpartial__symbol.html">partial_symbol</a> **)
<a name="l01637"></a>01637         <a class="code" href="common-utils_8c.html#af404b7244f442ce8c3069f31af566eae">xrealloc</a> ((<span class="keywordtype">char</span> *) listp-&gt;<a class="code" href="structpsymbol__allocation__list.html#ac618c483c3ff07162cdfe508abd6034d">list</a>,
<a name="l01638"></a>01638                   new_size * <span class="keyword">sizeof</span> (<span class="keyword">struct </span><a class="code" href="structpartial__symbol.html">partial_symbol</a> *));
<a name="l01639"></a>01639     }
<a name="l01640"></a>01640   <span class="comment">/* Next assumes we only went one over.  Should be good if</span>
<a name="l01641"></a>01641 <span class="comment">     program works correctly.  */</span>
<a name="l01642"></a>01642   listp-&gt;<a class="code" href="structpsymbol__allocation__list.html#a47883420b19f6e99ee9989eb600ce6e5">next</a> = listp-&gt;<a class="code" href="structpsymbol__allocation__list.html#ac618c483c3ff07162cdfe508abd6034d">list</a> + listp-&gt;<a class="code" href="structpsymbol__allocation__list.html#ad9937316024e2a8589a4e04d080e74eb">size</a>;
<a name="l01643"></a>01643   listp-&gt;<a class="code" href="structpsymbol__allocation__list.html#ad9937316024e2a8589a4e04d080e74eb">size</a> = new_size;
<a name="l01644"></a>01644 }
<a name="l01645"></a>01645 
<a name="l01646"></a>01646 <span class="comment">/* Helper function, adds partial symbol to the given partial symbol</span>
<a name="l01647"></a>01647 <span class="comment">   list.  */</span>
<a name="l01648"></a>01648 
<a name="l01649"></a>01649 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01650"></a><a class="code" href="psymtab_8c.html#acc1aca262b5d116b093d69edd931aa10">01650</a> <a class="code" href="psymtab_8c.html#acc1aca262b5d116b093d69edd931aa10">append_psymbol_to_list</a> (<span class="keyword">struct</span> <a class="code" href="structpsymbol__allocation__list.html">psymbol_allocation_list</a> *list,
<a name="l01651"></a>01651                         <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structpartial__symbol.html">partial_symbol</a> *psym,
<a name="l01652"></a>01652                         <span class="keyword">struct</span> objfile *objfile)
<a name="l01653"></a>01653 {
<a name="l01654"></a>01654   <span class="keywordflow">if</span> (list-&gt;<a class="code" href="structpsymbol__allocation__list.html#a47883420b19f6e99ee9989eb600ce6e5">next</a> &gt;= list-&gt;<a class="code" href="structpsymbol__allocation__list.html#ac618c483c3ff07162cdfe508abd6034d">list</a> + list-&gt;<a class="code" href="structpsymbol__allocation__list.html#ad9937316024e2a8589a4e04d080e74eb">size</a>)
<a name="l01655"></a>01655     <a class="code" href="psymtab_8c.html#a16e9cb9f6fe30eff1bb6556c144bec2c">extend_psymbol_list</a> (list, objfile);
<a name="l01656"></a>01656   *list-&gt;<a class="code" href="structpsymbol__allocation__list.html#a47883420b19f6e99ee9989eb600ce6e5">next</a>++ = (<span class="keyword">struct </span><a class="code" href="structpartial__symbol.html">partial_symbol</a> *) psym;
<a name="l01657"></a>01657   <a class="code" href="objfiles_8h.html#abdcf99cd4c458e281e591cbce3fa627c">OBJSTAT</a> (objfile, n_psyms++);
<a name="l01658"></a>01658 }
<a name="l01659"></a>01659 
<a name="l01660"></a>01660 <span class="comment">/* Add a symbol with a long value to a psymtab.</span>
<a name="l01661"></a>01661 <span class="comment">   Since one arg is a struct, we pass in a ptr and deref it (sigh).</span>
<a name="l01662"></a>01662 <span class="comment">   Return the partial symbol that has been added.  */</span>
<a name="l01663"></a>01663 
<a name="l01664"></a>01664 <span class="keywordtype">void</span>
<a name="l01665"></a><a class="code" href="psymtab_8c.html#af5271af9a3b4711c19151269964cb889">01665</a> <a class="code" href="psympriv_8h.html#a62f8da83aee3f33ec2da32c0e583260a">add_psymbol_to_list</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keywordtype">int</span> namelength, <span class="keywordtype">int</span> <a class="code" href="parse_8c.html#ae2c3f5e61c639d2b9821cbb548bbe10c">copy_name</a>,
<a name="l01666"></a>01666                      <a class="code" href="symtab_8h.html#abbcd14557de81830c9e96ea4bdfc14aa">domain_enum</a> domain,
<a name="l01667"></a>01667                      <span class="keyword">enum</span> <a class="code" href="symtab_8h.html#a40bca6cf3ed5cfa15b1275e6750cdda3">address_class</a> <span class="keyword">class</span>,
<a name="l01668"></a>01668                      <span class="keyword">struct</span> <a class="code" href="structpsymbol__allocation__list.html">psymbol_allocation_list</a> *list, 
<a name="l01669"></a>01669                      <span class="keywordtype">long</span> val,  <span class="comment">/* Value as a long */</span>
<a name="l01670"></a>01670                      <a class="code" href="defs_8h.html#aba5d0eb4e938c80ae1112a4439aaf71a">CORE_ADDR</a> coreaddr,        <span class="comment">/* Value as a CORE_ADDR */</span>
<a name="l01671"></a>01671                      <span class="keyword">enum</span> <a class="code" href="defs_8h.html#aa37aa8979934d47ac32fd96ecff32202">language</a> <a class="code" href="defs_8h.html#aa37aa8979934d47ac32fd96ecff32202">language</a>, <span class="keyword">struct</span> objfile *objfile)
<a name="l01672"></a>01672 {
<a name="l01673"></a>01673   <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structpartial__symbol.html">partial_symbol</a> *psym;
<a name="l01674"></a>01674 
<a name="l01675"></a>01675   <span class="keywordtype">int</span> added;
<a name="l01676"></a>01676 
<a name="l01677"></a>01677   <span class="comment">/* Stash the partial symbol away in the cache.  */</span>
<a name="l01678"></a>01678   psym = <a class="code" href="psymtab_8c.html#af862db56fc1c66a8f923e956fb025def">add_psymbol_to_bcache</a> (name, namelength, copy_name, domain, <span class="keyword">class</span>,
<a name="l01679"></a>01679                                 val, coreaddr, language, objfile, &amp;added);
<a name="l01680"></a>01680 
<a name="l01681"></a>01681   <span class="comment">/* Do not duplicate global partial symbols.  */</span>
<a name="l01682"></a>01682   <span class="keywordflow">if</span> (list == &amp;objfile-&gt;<a class="code" href="structobjfile.html#a5665fb90f8a5d1481cc59ed5cf6a86fa">global_psymbols</a>
<a name="l01683"></a>01683       &amp;&amp; !added)
<a name="l01684"></a>01684     <span class="keywordflow">return</span>;
<a name="l01685"></a>01685 
<a name="l01686"></a>01686   <span class="comment">/* Save pointer to partial symbol in psymtab, growing symtab if needed.  */</span>
<a name="l01687"></a>01687   <a class="code" href="psymtab_8c.html#acc1aca262b5d116b093d69edd931aa10">append_psymbol_to_list</a> (list, psym, objfile);
<a name="l01688"></a>01688 }
<a name="l01689"></a>01689 
<a name="l01690"></a>01690 <span class="comment">/* Initialize storage for partial symbols.  */</span>
<a name="l01691"></a>01691 
<a name="l01692"></a>01692 <span class="keywordtype">void</span>
<a name="l01693"></a><a class="code" href="psymtab_8c.html#a155dbac8e947d91c1d0ce937ac738a9d">01693</a> <a class="code" href="psympriv_8h.html#ae1974889fb462795c0c148c5c8bee750">init_psymbol_list</a> (<span class="keyword">struct</span> objfile *objfile, <span class="keywordtype">int</span> total_symbols)
<a name="l01694"></a>01694 {
<a name="l01695"></a>01695   <span class="comment">/* Free any previously allocated psymbol lists.  */</span>
<a name="l01696"></a>01696 
<a name="l01697"></a>01697   <span class="keywordflow">if</span> (objfile-&gt;<a class="code" href="structobjfile.html#a5665fb90f8a5d1481cc59ed5cf6a86fa">global_psymbols</a>.<a class="code" href="structpsymbol__allocation__list.html#ac618c483c3ff07162cdfe508abd6034d">list</a>)
<a name="l01698"></a>01698     {
<a name="l01699"></a>01699       <a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a> (objfile-&gt;<a class="code" href="structobjfile.html#a5665fb90f8a5d1481cc59ed5cf6a86fa">global_psymbols</a>.<a class="code" href="structpsymbol__allocation__list.html#ac618c483c3ff07162cdfe508abd6034d">list</a>);
<a name="l01700"></a>01700     }
<a name="l01701"></a>01701   <span class="keywordflow">if</span> (objfile-&gt;<a class="code" href="structobjfile.html#a365549b70c39eb429e3103991da9b3e6">static_psymbols</a>.<a class="code" href="structpsymbol__allocation__list.html#ac618c483c3ff07162cdfe508abd6034d">list</a>)
<a name="l01702"></a>01702     {
<a name="l01703"></a>01703       <a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a> (objfile-&gt;<a class="code" href="structobjfile.html#a365549b70c39eb429e3103991da9b3e6">static_psymbols</a>.<a class="code" href="structpsymbol__allocation__list.html#ac618c483c3ff07162cdfe508abd6034d">list</a>);
<a name="l01704"></a>01704     }
<a name="l01705"></a>01705 
<a name="l01706"></a>01706   <span class="comment">/* Current best guess is that approximately a twentieth</span>
<a name="l01707"></a>01707 <span class="comment">     of the total symbols (in a debugging file) are global or static</span>
<a name="l01708"></a>01708 <span class="comment">     oriented symbols, then multiply that by slop factor of two.  */</span>
<a name="l01709"></a>01709 
<a name="l01710"></a>01710   objfile-&gt;<a class="code" href="structobjfile.html#a5665fb90f8a5d1481cc59ed5cf6a86fa">global_psymbols</a>.<a class="code" href="structpsymbol__allocation__list.html#ad9937316024e2a8589a4e04d080e74eb">size</a> = total_symbols / 10;
<a name="l01711"></a>01711   objfile-&gt;<a class="code" href="structobjfile.html#a365549b70c39eb429e3103991da9b3e6">static_psymbols</a>.<a class="code" href="structpsymbol__allocation__list.html#ad9937316024e2a8589a4e04d080e74eb">size</a> = total_symbols / 10;
<a name="l01712"></a>01712 
<a name="l01713"></a>01713   <span class="keywordflow">if</span> (objfile-&gt;<a class="code" href="structobjfile.html#a5665fb90f8a5d1481cc59ed5cf6a86fa">global_psymbols</a>.<a class="code" href="structpsymbol__allocation__list.html#ad9937316024e2a8589a4e04d080e74eb">size</a> &gt; 0)
<a name="l01714"></a>01714     {
<a name="l01715"></a>01715       objfile-&gt;<a class="code" href="structobjfile.html#a5665fb90f8a5d1481cc59ed5cf6a86fa">global_psymbols</a>.<a class="code" href="structpsymbol__allocation__list.html#a47883420b19f6e99ee9989eb600ce6e5">next</a> =
<a name="l01716"></a>01716         objfile-&gt;<a class="code" href="structobjfile.html#a5665fb90f8a5d1481cc59ed5cf6a86fa">global_psymbols</a>.<a class="code" href="structpsymbol__allocation__list.html#ac618c483c3ff07162cdfe508abd6034d">list</a> = (<span class="keyword">struct </span><a class="code" href="structpartial__symbol.html">partial_symbol</a> **)
<a name="l01717"></a>01717         <a class="code" href="common-utils_8c.html#a634d6cd850bb831afebc499579303b3b">xmalloc</a> ((objfile-&gt;<a class="code" href="structobjfile.html#a5665fb90f8a5d1481cc59ed5cf6a86fa">global_psymbols</a>.<a class="code" href="structpsymbol__allocation__list.html#ad9937316024e2a8589a4e04d080e74eb">size</a>
<a name="l01718"></a>01718                   * sizeof (<span class="keyword">struct</span> <a class="code" href="structpartial__symbol.html">partial_symbol</a> *)));
<a name="l01719"></a>01719     }
<a name="l01720"></a>01720   <span class="keywordflow">if</span> (objfile-&gt;<a class="code" href="structobjfile.html#a365549b70c39eb429e3103991da9b3e6">static_psymbols</a>.<a class="code" href="structpsymbol__allocation__list.html#ad9937316024e2a8589a4e04d080e74eb">size</a> &gt; 0)
<a name="l01721"></a>01721     {
<a name="l01722"></a>01722       objfile-&gt;<a class="code" href="structobjfile.html#a365549b70c39eb429e3103991da9b3e6">static_psymbols</a>.<a class="code" href="structpsymbol__allocation__list.html#a47883420b19f6e99ee9989eb600ce6e5">next</a> =
<a name="l01723"></a>01723         objfile-&gt;<a class="code" href="structobjfile.html#a365549b70c39eb429e3103991da9b3e6">static_psymbols</a>.<a class="code" href="structpsymbol__allocation__list.html#ac618c483c3ff07162cdfe508abd6034d">list</a> = (<span class="keyword">struct </span><a class="code" href="structpartial__symbol.html">partial_symbol</a> **)
<a name="l01724"></a>01724         <a class="code" href="common-utils_8c.html#a634d6cd850bb831afebc499579303b3b">xmalloc</a> ((objfile-&gt;<a class="code" href="structobjfile.html#a365549b70c39eb429e3103991da9b3e6">static_psymbols</a>.<a class="code" href="structpsymbol__allocation__list.html#ad9937316024e2a8589a4e04d080e74eb">size</a>
<a name="l01725"></a>01725                   * sizeof (<span class="keyword">struct</span> <a class="code" href="structpartial__symbol.html">partial_symbol</a> *)));
<a name="l01726"></a>01726     }
<a name="l01727"></a>01727 }
<a name="l01728"></a>01728 
<a name="l01729"></a>01729 <span class="keyword">struct </span><a class="code" href="structpartial__symtab.html">partial_symtab</a> *
<a name="l01730"></a><a class="code" href="psymtab_8c.html#ab31181e981039eadd988ccf95263a6c7">01730</a> <a class="code" href="psympriv_8h.html#aaab6295ffb54728aaa0817aa18c4c61c">allocate_psymtab</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structpartial__symtab.html#a6ea70ac87d6dbd541967bdd6dacd7321">filename</a>, <span class="keyword">struct</span> objfile *objfile)
<a name="l01731"></a>01731 {
<a name="l01732"></a>01732   <span class="keyword">struct </span><a class="code" href="structpartial__symtab.html">partial_symtab</a> *psymtab;
<a name="l01733"></a>01733 
<a name="l01734"></a>01734   <span class="keywordflow">if</span> (objfile-&gt;<a class="code" href="structobjfile.html#a280f61a600a303c151625e90f3762383">free_psymtabs</a>)
<a name="l01735"></a>01735     {
<a name="l01736"></a>01736       psymtab = objfile-&gt;<a class="code" href="structobjfile.html#a280f61a600a303c151625e90f3762383">free_psymtabs</a>;
<a name="l01737"></a>01737       objfile-&gt;<a class="code" href="structobjfile.html#a280f61a600a303c151625e90f3762383">free_psymtabs</a> = psymtab-&gt;<a class="code" href="structpartial__symtab.html#aa58c92073996df85892297ab82788785">next</a>;
<a name="l01738"></a>01738     }
<a name="l01739"></a>01739   <span class="keywordflow">else</span>
<a name="l01740"></a>01740     psymtab = (<span class="keyword">struct </span><a class="code" href="structpartial__symtab.html">partial_symtab</a> *)
<a name="l01741"></a>01741       obstack_alloc (&amp;objfile-&gt;<a class="code" href="structobjfile.html#aab9cedc53383f1b540f0b725edd2d9be">objfile_obstack</a>,
<a name="l01742"></a>01742                      sizeof (<span class="keyword">struct</span> <a class="code" href="structpartial__symtab.html">partial_symtab</a>));
<a name="l01743"></a>01743 
<a name="l01744"></a>01744   <a class="code" href="gdb__string_8h.html#adb03df3679ce1445e801310614624ccb">memset</a> (psymtab, 0, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structpartial__symtab.html">partial_symtab</a>));
<a name="l01745"></a>01745   psymtab-&gt;<a class="code" href="structpartial__symtab.html#a6ea70ac87d6dbd541967bdd6dacd7321">filename</a> = obstack_copy0 (&amp;objfile-&gt;<a class="code" href="structobjfile.html#aab9cedc53383f1b540f0b725edd2d9be">objfile_obstack</a>,
<a name="l01746"></a>01746                                      filename, strlen (filename));
<a name="l01747"></a>01747   psymtab-&gt;<a class="code" href="structpartial__symtab.html#a1bbcf18c88d09005b43f960b6f3575f8">symtab</a> = NULL;
<a name="l01748"></a>01748 
<a name="l01749"></a>01749   <span class="comment">/* Prepend it to the psymtab list for the objfile it belongs to.</span>
<a name="l01750"></a>01750 <span class="comment">     Psymtabs are searched in most recent inserted -&gt; least recent</span>
<a name="l01751"></a>01751 <span class="comment">     inserted order.  */</span>
<a name="l01752"></a>01752 
<a name="l01753"></a>01753   psymtab-&gt;<a class="code" href="structpartial__symtab.html#aa58c92073996df85892297ab82788785">next</a> = objfile-&gt;<a class="code" href="structobjfile.html#a4dcbf92348a83fa9d6d5d2d08cb59eb5">psymtabs</a>;
<a name="l01754"></a>01754   objfile-&gt;<a class="code" href="structobjfile.html#a4dcbf92348a83fa9d6d5d2d08cb59eb5">psymtabs</a> = psymtab;
<a name="l01755"></a>01755 
<a name="l01756"></a>01756   <span class="keywordflow">if</span> (<a class="code" href="symtab_8c.html#a79f9baa7ed4892b24e17edf25c934ec6">symtab_create_debug</a>)
<a name="l01757"></a>01757     {
<a name="l01758"></a>01758       <span class="comment">/* Be a bit clever with debugging messages, and don&#39;t print objfile</span>
<a name="l01759"></a>01759 <span class="comment">         every time, only when it changes.  */</span>
<a name="l01760"></a>01760       <span class="keyword">static</span> <span class="keywordtype">char</span> *last_objfile_name = NULL;
<a name="l01761"></a>01761 
<a name="l01762"></a>01762       <span class="keywordflow">if</span> (last_objfile_name == NULL
<a name="l01763"></a>01763           || strcmp (last_objfile_name, <a class="code" href="objfiles_8c.html#a33e548a19b86b293435d3c2d6daaaec6">objfile_name</a> (objfile)) != 0)
<a name="l01764"></a>01764         {
<a name="l01765"></a>01765           <a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a> (last_objfile_name);
<a name="l01766"></a>01766           last_objfile_name = xstrdup (<a class="code" href="objfiles_8c.html#a33e548a19b86b293435d3c2d6daaaec6">objfile_name</a> (objfile));
<a name="l01767"></a>01767           <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (<a class="code" href="main_8c.html#a097b10b28c07237b554c73fbf42a8e9e">gdb_stdlog</a>,
<a name="l01768"></a>01768                               <span class="stringliteral">&quot;Creating one or more psymtabs for objfile %s ...\n&quot;</span>,
<a name="l01769"></a>01769                               last_objfile_name);
<a name="l01770"></a>01770         }
<a name="l01771"></a>01771       <a class="code" href="utils_8c.html#aa624d49eae7e3e3ee9124fde6c631392">fprintf_unfiltered</a> (<a class="code" href="main_8c.html#a097b10b28c07237b554c73fbf42a8e9e">gdb_stdlog</a>,
<a name="l01772"></a>01772                           <span class="stringliteral">&quot;Created psymtab %s for module %s.\n&quot;</span>,
<a name="l01773"></a>01773                           <a class="code" href="utils_8c.html#ac166db325056a01e8babd984f8ba2b98">host_address_to_string</a> (psymtab), filename);
<a name="l01774"></a>01774     }
<a name="l01775"></a>01775 
<a name="l01776"></a>01776   <span class="keywordflow">return</span> (psymtab);
<a name="l01777"></a>01777 }
<a name="l01778"></a>01778 
<a name="l01779"></a>01779 <span class="keywordtype">void</span>
<a name="l01780"></a><a class="code" href="psymtab_8c.html#a3bc9d70aab1278a447d259e75ca6fdf9">01780</a> <a class="code" href="psympriv_8h.html#a94e15af92a54fef2dd0a688ec8479c79">discard_psymtab</a> (<span class="keyword">struct</span> objfile *objfile, <span class="keyword">struct</span> <a class="code" href="structpartial__symtab.html">partial_symtab</a> *pst)
<a name="l01781"></a>01781 {
<a name="l01782"></a>01782   <span class="keyword">struct </span><a class="code" href="structpartial__symtab.html">partial_symtab</a> **prev_pst;
<a name="l01783"></a>01783 
<a name="l01784"></a>01784   <span class="comment">/* From dbxread.c:</span>
<a name="l01785"></a>01785 <span class="comment">     Empty psymtabs happen as a result of header files which don&#39;t</span>
<a name="l01786"></a>01786 <span class="comment">     have any symbols in them.  There can be a lot of them.  But this</span>
<a name="l01787"></a>01787 <span class="comment">     check is wrong, in that a psymtab with N_SLINE entries but</span>
<a name="l01788"></a>01788 <span class="comment">     nothing else is not empty, but we don&#39;t realize that.  Fixing</span>
<a name="l01789"></a>01789 <span class="comment">     that without slowing things down might be tricky.  */</span>
<a name="l01790"></a>01790 
<a name="l01791"></a>01791   <span class="comment">/* First, snip it out of the psymtab chain.  */</span>
<a name="l01792"></a>01792 
<a name="l01793"></a>01793   prev_pst = &amp;(objfile-&gt;<a class="code" href="structobjfile.html#a4dcbf92348a83fa9d6d5d2d08cb59eb5">psymtabs</a>);
<a name="l01794"></a>01794   <span class="keywordflow">while</span> ((*prev_pst) != pst)
<a name="l01795"></a>01795     prev_pst = &amp;((*prev_pst)-&gt;next);
<a name="l01796"></a>01796   (*prev_pst) = pst-&gt;<a class="code" href="structpartial__symtab.html#aa58c92073996df85892297ab82788785">next</a>;
<a name="l01797"></a>01797 
<a name="l01798"></a>01798   <span class="comment">/* Next, put it on a free list for recycling.  */</span>
<a name="l01799"></a>01799 
<a name="l01800"></a>01800   pst-&gt;<a class="code" href="structpartial__symtab.html#aa58c92073996df85892297ab82788785">next</a> = objfile-&gt;<a class="code" href="structobjfile.html#a280f61a600a303c151625e90f3762383">free_psymtabs</a>;
<a name="l01801"></a>01801   objfile-&gt;<a class="code" href="structobjfile.html#a280f61a600a303c151625e90f3762383">free_psymtabs</a> = pst;
<a name="l01802"></a>01802 }
<a name="l01803"></a>01803 
<a name="l01804"></a>01804 <span class="comment">/* An object of this type is passed to discard_psymtabs_upto.  */</span>
<a name="l01805"></a>01805 
<a name="l01806"></a><a class="code" href="structpsymtab__state.html">01806</a> <span class="keyword">struct </span><a class="code" href="structpsymtab__state.html">psymtab_state</a>
<a name="l01807"></a>01807 {
<a name="l01808"></a>01808   <span class="comment">/* The objfile where psymtabs are discarded.  */</span>
<a name="l01809"></a>01809 
<a name="l01810"></a><a class="code" href="structpsymtab__state.html#a105806da66f5c5b76ec498d9b40a4316">01810</a>   <span class="keyword">struct </span>objfile *<a class="code" href="structpsymtab__state.html#a105806da66f5c5b76ec498d9b40a4316">objfile</a>;
<a name="l01811"></a>01811 
<a name="l01812"></a>01812   <span class="comment">/* The first psymtab to save.  */</span>
<a name="l01813"></a>01813 
<a name="l01814"></a><a class="code" href="structpsymtab__state.html#a2570bef635ba38f87064a7c18988fdac">01814</a>   <span class="keyword">struct </span><a class="code" href="structpartial__symtab.html">partial_symtab</a> *<a class="code" href="structpsymtab__state.html#a2570bef635ba38f87064a7c18988fdac">save</a>;
<a name="l01815"></a>01815 };
<a name="l01816"></a>01816 
<a name="l01817"></a>01817 <span class="comment">/* A cleanup function used by make_cleanup_discard_psymtabs.  */</span>
<a name="l01818"></a>01818 
<a name="l01819"></a>01819 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01820"></a><a class="code" href="psymtab_8c.html#a72d5ae6e8c1eaa9d9bf699b36f86f383">01820</a> <a class="code" href="psymtab_8c.html#a72d5ae6e8c1eaa9d9bf699b36f86f383">discard_psymtabs_upto</a> (<span class="keywordtype">void</span> *arg)
<a name="l01821"></a>01821 {
<a name="l01822"></a>01822   <span class="keyword">struct </span><a class="code" href="structpsymtab__state.html">psymtab_state</a> *state = arg;
<a name="l01823"></a>01823 
<a name="l01824"></a>01824   <span class="keywordflow">while</span> (state-&gt;<a class="code" href="structpsymtab__state.html#a105806da66f5c5b76ec498d9b40a4316">objfile</a>-&gt;<a class="code" href="structobjfile.html#a4dcbf92348a83fa9d6d5d2d08cb59eb5">psymtabs</a> != state-&gt;<a class="code" href="structpsymtab__state.html#a2570bef635ba38f87064a7c18988fdac">save</a>)
<a name="l01825"></a>01825     <a class="code" href="psympriv_8h.html#a94e15af92a54fef2dd0a688ec8479c79">discard_psymtab</a> (state-&gt;<a class="code" href="structpsymtab__state.html#a105806da66f5c5b76ec498d9b40a4316">objfile</a>, state-&gt;<a class="code" href="structpsymtab__state.html#a105806da66f5c5b76ec498d9b40a4316">objfile</a>-&gt;<a class="code" href="structobjfile.html#a4dcbf92348a83fa9d6d5d2d08cb59eb5">psymtabs</a>);
<a name="l01826"></a>01826 }
<a name="l01827"></a>01827 
<a name="l01828"></a>01828 <span class="comment">/* Return a new cleanup that discards all psymtabs created in OBJFILE</span>
<a name="l01829"></a>01829 <span class="comment">   after this function is called.  */</span>
<a name="l01830"></a>01830 
<a name="l01831"></a>01831 <span class="keyword">struct </span><a class="code" href="structcleanup.html">cleanup</a> *
<a name="l01832"></a><a class="code" href="psymtab_8c.html#a99df1e048d8dcc21092601923fb10bfc">01832</a> <a class="code" href="psympriv_8h.html#ad507fe2563db86bee80cdb1a837268a2">make_cleanup_discard_psymtabs</a> (<span class="keyword">struct</span> objfile *objfile)
<a name="l01833"></a>01833 {
<a name="l01834"></a>01834   <span class="keyword">struct </span><a class="code" href="structpsymtab__state.html">psymtab_state</a> *state = XNEW (<span class="keyword">struct</span> <a class="code" href="structpsymtab__state.html">psymtab_state</a>);
<a name="l01835"></a>01835 
<a name="l01836"></a>01836   state-&gt;<a class="code" href="structpsymtab__state.html#a105806da66f5c5b76ec498d9b40a4316">objfile</a> = <a class="code" href="structpsymtab__state.html#a105806da66f5c5b76ec498d9b40a4316">objfile</a>;
<a name="l01837"></a>01837   state-&gt;<a class="code" href="structpsymtab__state.html#a2570bef635ba38f87064a7c18988fdac">save</a> = objfile-&gt;<a class="code" href="structobjfile.html#a4dcbf92348a83fa9d6d5d2d08cb59eb5">psymtabs</a>;
<a name="l01838"></a>01838 
<a name="l01839"></a>01839   <span class="keywordflow">return</span> <a class="code" href="cleanups_8c.html#ae88f17d488a67d25182d5ae4ad9550cf">make_cleanup_dtor</a> (<a class="code" href="psymtab_8c.html#a72d5ae6e8c1eaa9d9bf699b36f86f383">discard_psymtabs_upto</a>, state, <a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a>);
<a name="l01840"></a>01840 }
<a name="l01841"></a>01841 
<a name="l01842"></a>01842 
<a name="l01843"></a>01843 
<a name="l01844"></a>01844 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01845"></a><a class="code" href="psymtab_8c.html#a2cd6b3d0b6c923db487f730df9dbb83c">01845</a> <a class="code" href="psymtab_8c.html#a2cd6b3d0b6c923db487f730df9dbb83c">maintenance_print_psymbols</a> (<span class="keywordtype">char</span> *args, <span class="keywordtype">int</span> from_tty)
<a name="l01846"></a>01846 {
<a name="l01847"></a>01847   <span class="keywordtype">char</span> **argv;
<a name="l01848"></a>01848   <span class="keyword">struct </span><a class="code" href="structui__file.html">ui_file</a> *outfile;
<a name="l01849"></a>01849   <span class="keyword">struct </span><a class="code" href="structcleanup.html">cleanup</a> *cleanups;
<a name="l01850"></a>01850   <span class="keywordtype">char</span> *symname = NULL;
<a name="l01851"></a>01851   <span class="keywordtype">char</span> *filename = <a class="code" href="psymtab_8c.html#a76aaa26b53defe4e315b752bf3b6e2a3">DEV_TTY</a>;
<a name="l01852"></a>01852   <span class="keyword">struct </span>objfile *objfile;
<a name="l01853"></a>01853   <span class="keyword">struct </span><a class="code" href="structpartial__symtab.html">partial_symtab</a> *<a class="code" href="namespacecleanup__check.html#a2f9ce522b7667bef19a5777d12fa44d8">ps</a>;
<a name="l01854"></a>01854 
<a name="l01855"></a>01855   <a class="code" href="command_8h.html#ac7af34b03605d65b114a173d49532050">dont_repeat</a> ();
<a name="l01856"></a>01856 
<a name="l01857"></a>01857   <span class="keywordflow">if</span> (args == NULL)
<a name="l01858"></a>01858     {
<a name="l01859"></a>01859       <a class="code" href="utils_8c.html#a279e952362d12544d9bebc26660fec4b">error</a> (<a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l01860"></a>01860 <span class="stringliteral">print-psymbols takes an output file name and optional symbol file name&quot;</span>));
<a name="l01861"></a>01861     }
<a name="l01862"></a>01862   argv = <a class="code" href="utils_8c.html#a146bf06d6062174a10a36700c40fdae4">gdb_buildargv</a> (args);
<a name="l01863"></a>01863   cleanups = <a class="code" href="utils_8c.html#aad1e14fe73668592441775f7346f558e">make_cleanup_freeargv</a> (argv);
<a name="l01864"></a>01864 
<a name="l01865"></a>01865   <span class="keywordflow">if</span> (argv[0] != NULL)
<a name="l01866"></a>01866     {
<a name="l01867"></a>01867       filename = argv[0];
<a name="l01868"></a>01868       <span class="comment">/* If a second arg is supplied, it is a source file name to match on.  */</span>
<a name="l01869"></a>01869       <span class="keywordflow">if</span> (argv[1] != NULL)
<a name="l01870"></a>01870         {
<a name="l01871"></a>01871           symname = argv[1];
<a name="l01872"></a>01872         }
<a name="l01873"></a>01873     }
<a name="l01874"></a>01874 
<a name="l01875"></a>01875   filename = tilde_expand (filename);
<a name="l01876"></a>01876   <a class="code" href="cleanups_8c.html#a3d418f8af424aec399898c2d48b26224">make_cleanup</a> (<a class="code" href="common-utils_8c.html#a976e14808b9247ec952c262553f09f8f">xfree</a>, filename);
<a name="l01877"></a>01877 
<a name="l01878"></a>01878   outfile = <a class="code" href="ui-file_8c.html#a3ab113067050b62e6a56f08fe86e72c5">gdb_fopen</a> (filename, FOPEN_WT);
<a name="l01879"></a>01879   <span class="keywordflow">if</span> (outfile == 0)
<a name="l01880"></a>01880     <a class="code" href="utils_8c.html#a14801ceb45147833b8ce111c89ea0d5f">perror_with_name</a> (filename);
<a name="l01881"></a>01881   <a class="code" href="utils_8c.html#a94dc56baeb57791e114136764f7763aa">make_cleanup_ui_file_delete</a> (outfile);
<a name="l01882"></a>01882 
<a name="l01883"></a>01883   <a class="code" href="psymtab_8c.html#a3a00a6d0d1f26826e6270ee7e2bb4f6d">ALL_PSYMTABS</a> (objfile, ps)
<a name="l01884"></a>01884     {
<a name="l01885"></a>01885       <a class="code" href="defs_8h.html#ad24e2b54375e12474e65ebf7175988fb">QUIT</a>;
<a name="l01886"></a>01886       <span class="keywordflow">if</span> (symname == NULL || filename_cmp (symname, ps-&gt;<a class="code" href="structpartial__symtab.html#a6ea70ac87d6dbd541967bdd6dacd7321">filename</a>) == 0)
<a name="l01887"></a>01887         <a class="code" href="psymtab_8c.html#a51d965a77421fd3d82b44101beaf69b1">dump_psymtab</a> (objfile, ps, outfile);
<a name="l01888"></a>01888     }
<a name="l01889"></a>01889   <a class="code" href="cleanups_8c.html#a8b313a4f1c613973ea444e5fa54976f8">do_cleanups</a> (cleanups);
<a name="l01890"></a>01890 }
<a name="l01891"></a>01891 
<a name="l01892"></a>01892 <span class="comment">/* List all the partial symbol tables whose names match REGEXP (optional).  */</span>
<a name="l01893"></a>01893 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l01894"></a><a class="code" href="psymtab_8c.html#a97903a765274eadf721bedbb12c7ed25">01894</a> <a class="code" href="psymtab_8c.html#a97903a765274eadf721bedbb12c7ed25">maintenance_info_psymtabs</a> (<span class="keywordtype">char</span> *regexp, <span class="keywordtype">int</span> from_tty)
<a name="l01895"></a>01895 {
<a name="l01896"></a>01896   <span class="keyword">struct </span><a class="code" href="structprogram__space.html">program_space</a> *pspace;
<a name="l01897"></a>01897   <span class="keyword">struct </span>objfile *objfile;
<a name="l01898"></a>01898 
<a name="l01899"></a>01899   <span class="keywordflow">if</span> (regexp)
<a name="l01900"></a>01900     <a class="code" href="defs_8h.html#ad321e1eefeb38442e0c40b1279f41ca0">re_comp</a> (regexp);
<a name="l01901"></a>01901 
<a name="l01902"></a>01902   <a class="code" href="progspace_8h.html#a9e4091a3fcf8c96cb18cf2042cbe21f6">ALL_PSPACES</a> (pspace)
<a name="l01903"></a>01903     <a class="code" href="objfiles_8h.html#a9c2f75ae5c5a8cb4da219f7cb063e262">ALL_PSPACE_OBJFILES</a> (pspace, objfile)
<a name="l01904"></a>01904     {
<a name="l01905"></a>01905       <span class="keyword">struct </span><a class="code" href="structgdbarch.html">gdbarch</a> *<a class="code" href="structgdbarch.html">gdbarch</a> = <a class="code" href="objfiles_8c.html#a1c7101234ac2edc601fa465e48bc3463">get_objfile_arch</a> (objfile);
<a name="l01906"></a>01906       <span class="keyword">struct </span><a class="code" href="structpartial__symtab.html">partial_symtab</a> *psymtab;
<a name="l01907"></a>01907 
<a name="l01908"></a>01908       <span class="comment">/* We don&#39;t want to print anything for this objfile until we</span>
<a name="l01909"></a>01909 <span class="comment">         actually find a symtab whose name matches.  */</span>
<a name="l01910"></a>01910       <span class="keywordtype">int</span> printed_objfile_start = 0;
<a name="l01911"></a>01911 
<a name="l01912"></a>01912       <a class="code" href="psymtab_8c.html#a3fbd70c118d9b449af634c15717d508e">ALL_OBJFILE_PSYMTABS_REQUIRED</a> (objfile, psymtab)
<a name="l01913"></a>01913         {
<a name="l01914"></a>01914           <a class="code" href="defs_8h.html#ad24e2b54375e12474e65ebf7175988fb">QUIT</a>;
<a name="l01915"></a>01915 
<a name="l01916"></a>01916           <span class="keywordflow">if</span> (! regexp
<a name="l01917"></a>01917               || re_exec (psymtab-&gt;<a class="code" href="structpartial__symtab.html#a6ea70ac87d6dbd541967bdd6dacd7321">filename</a>))
<a name="l01918"></a>01918             {
<a name="l01919"></a>01919               <span class="keywordflow">if</span> (! printed_objfile_start)
<a name="l01920"></a>01920                 {
<a name="l01921"></a>01921                   <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;{ objfile %s &quot;</span>, <a class="code" href="objfiles_8c.html#a33e548a19b86b293435d3c2d6daaaec6">objfile_name</a> (objfile));
<a name="l01922"></a>01922                   <a class="code" href="utils_8c.html#a857540a17ef1cd62fef4a33cc3b6a894">wrap_here</a> (<span class="stringliteral">&quot;  &quot;</span>);
<a name="l01923"></a>01923                   <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;((struct objfile *) %s)\n&quot;</span>, 
<a name="l01924"></a>01924                                    <a class="code" href="utils_8c.html#ac166db325056a01e8babd984f8ba2b98">host_address_to_string</a> (objfile));
<a name="l01925"></a>01925                   printed_objfile_start = 1;
<a name="l01926"></a>01926                 }
<a name="l01927"></a>01927 
<a name="l01928"></a>01928               <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;  { psymtab %s &quot;</span>, psymtab-&gt;<a class="code" href="structpartial__symtab.html#a6ea70ac87d6dbd541967bdd6dacd7321">filename</a>);
<a name="l01929"></a>01929               <a class="code" href="utils_8c.html#a857540a17ef1cd62fef4a33cc3b6a894">wrap_here</a> (<span class="stringliteral">&quot;    &quot;</span>);
<a name="l01930"></a>01930               <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;((struct partial_symtab *) %s)\n&quot;</span>, 
<a name="l01931"></a>01931                                <a class="code" href="utils_8c.html#ac166db325056a01e8babd984f8ba2b98">host_address_to_string</a> (psymtab));
<a name="l01932"></a>01932 
<a name="l01933"></a>01933               <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;    readin %s\n&quot;</span>,
<a name="l01934"></a>01934                                psymtab-&gt;<a class="code" href="structpartial__symtab.html#a11d8e59b962db1317c8c23f917dbed42">readin</a> ? <span class="stringliteral">&quot;yes&quot;</span> : <span class="stringliteral">&quot;no&quot;</span>);
<a name="l01935"></a>01935               <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;    fullname %s\n&quot;</span>,
<a name="l01936"></a>01936                                psymtab-&gt;<a class="code" href="structpartial__symtab.html#aeaaef4856b449061d28624055c9c70d6">fullname</a>
<a name="l01937"></a>01937                                ? psymtab-&gt;<a class="code" href="structpartial__symtab.html#aeaaef4856b449061d28624055c9c70d6">fullname</a> : <span class="stringliteral">&quot;(null)&quot;</span>);
<a name="l01938"></a>01938               <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;    text addresses &quot;</span>);
<a name="l01939"></a>01939               <a class="code" href="utils_8c.html#a4b28488051faf9ab4a2f07633225835f">fputs_filtered</a> (<a class="code" href="utils_8c.html#ab5c76d72090f01d3848b63dda4e37d1c">paddress</a> (gdbarch, psymtab-&gt;<a class="code" href="structpartial__symtab.html#a194e7d3c21d81ce56b81d1fe02e1dbc3">textlow</a>),
<a name="l01940"></a>01940                               <a class="code" href="main_8c.html#a41a2b997ba5454df787d61f051dd918c">gdb_stdout</a>);
<a name="l01941"></a>01941               <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot; -- &quot;</span>);
<a name="l01942"></a>01942               <a class="code" href="utils_8c.html#a4b28488051faf9ab4a2f07633225835f">fputs_filtered</a> (<a class="code" href="utils_8c.html#ab5c76d72090f01d3848b63dda4e37d1c">paddress</a> (gdbarch, psymtab-&gt;<a class="code" href="structpartial__symtab.html#aa582095c68fb326f3042ad672527a438">texthigh</a>),
<a name="l01943"></a>01943                               <a class="code" href="main_8c.html#a41a2b997ba5454df787d61f051dd918c">gdb_stdout</a>);
<a name="l01944"></a>01944               <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l01945"></a>01945               <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;    psymtabs_addrmap_supported %s\n&quot;</span>,
<a name="l01946"></a>01946                                (psymtab-&gt;<a class="code" href="structpartial__symtab.html#aa4a6c5beadf5f2d9b39a06c04c728fa2">psymtabs_addrmap_supported</a>
<a name="l01947"></a>01947                                 ? <span class="stringliteral">&quot;yes&quot;</span> : <span class="stringliteral">&quot;no&quot;</span>));
<a name="l01948"></a>01948               <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;    globals &quot;</span>);
<a name="l01949"></a>01949               <span class="keywordflow">if</span> (psymtab-&gt;<a class="code" href="structpartial__symtab.html#ab26039959ff434afcf130049cfa8d27d">n_global_syms</a>)
<a name="l01950"></a>01950                 {
<a name="l01951"></a>01951                   <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;(* (struct partial_symbol **) %s @ %d)\n&quot;</span>,
<a name="l01952"></a>01952                                    <a class="code" href="utils_8c.html#ac166db325056a01e8babd984f8ba2b98">host_address_to_string</a> (objfile-&gt;<a class="code" href="structobjfile.html#a5665fb90f8a5d1481cc59ed5cf6a86fa">global_psymbols</a>.<a class="code" href="structpsymbol__allocation__list.html#ac618c483c3ff07162cdfe508abd6034d">list</a>
<a name="l01953"></a>01953                                     + psymtab-&gt;<a class="code" href="structpartial__symtab.html#ae11f1094416fd506398f4a58fe4fa405">globals_offset</a>),
<a name="l01954"></a>01954                                    psymtab-&gt;<a class="code" href="structpartial__symtab.html#ab26039959ff434afcf130049cfa8d27d">n_global_syms</a>);
<a name="l01955"></a>01955                 }
<a name="l01956"></a>01956               <span class="keywordflow">else</span>
<a name="l01957"></a>01957                 <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;(none)\n&quot;</span>);
<a name="l01958"></a>01958               <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;    statics &quot;</span>);
<a name="l01959"></a>01959               <span class="keywordflow">if</span> (psymtab-&gt;<a class="code" href="structpartial__symtab.html#a0fd67e243d440beaf6cc4757a97ff9b0">n_static_syms</a>)
<a name="l01960"></a>01960                 {
<a name="l01961"></a>01961                   <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;(* (struct partial_symbol **) %s @ %d)\n&quot;</span>,
<a name="l01962"></a>01962                                    <a class="code" href="utils_8c.html#ac166db325056a01e8babd984f8ba2b98">host_address_to_string</a> (objfile-&gt;<a class="code" href="structobjfile.html#a365549b70c39eb429e3103991da9b3e6">static_psymbols</a>.<a class="code" href="structpsymbol__allocation__list.html#ac618c483c3ff07162cdfe508abd6034d">list</a>
<a name="l01963"></a>01963                                     + psymtab-&gt;<a class="code" href="structpartial__symtab.html#a36b8c771ea2906e413b8f1fffe1f4d10">statics_offset</a>),
<a name="l01964"></a>01964                                    psymtab-&gt;<a class="code" href="structpartial__symtab.html#a0fd67e243d440beaf6cc4757a97ff9b0">n_static_syms</a>);
<a name="l01965"></a>01965                 }
<a name="l01966"></a>01966               <span class="keywordflow">else</span>
<a name="l01967"></a>01967                 <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;(none)\n&quot;</span>);
<a name="l01968"></a>01968               <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;    dependencies &quot;</span>);
<a name="l01969"></a>01969               <span class="keywordflow">if</span> (psymtab-&gt;<a class="code" href="structpartial__symtab.html#a917b503a5e1f7c2bb60feb6ff1e3b197">number_of_dependencies</a>)
<a name="l01970"></a>01970                 {
<a name="l01971"></a>01971                   <span class="keywordtype">int</span> i;
<a name="l01972"></a>01972 
<a name="l01973"></a>01973                   <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;{\n&quot;</span>);
<a name="l01974"></a>01974                   <span class="keywordflow">for</span> (i = 0; i &lt; psymtab-&gt;<a class="code" href="structpartial__symtab.html#a917b503a5e1f7c2bb60feb6ff1e3b197">number_of_dependencies</a>; i++)
<a name="l01975"></a>01975                     {
<a name="l01976"></a>01976                       <span class="keyword">struct </span><a class="code" href="structpartial__symtab.html">partial_symtab</a> *dep = psymtab-&gt;<a class="code" href="structpartial__symtab.html#a0b7bd5bada02a362357552790b111c23">dependencies</a>[i];
<a name="l01977"></a>01977 
<a name="l01978"></a>01978                       <span class="comment">/* Note the string concatenation there --- no comma.  */</span>
<a name="l01979"></a>01979                       <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;      psymtab %s &quot;</span>
<a name="l01980"></a>01980                                        <span class="stringliteral">&quot;((struct partial_symtab *) %s)\n&quot;</span>,
<a name="l01981"></a>01981                                        dep-&gt;<a class="code" href="structpartial__symtab.html#a6ea70ac87d6dbd541967bdd6dacd7321">filename</a>, 
<a name="l01982"></a>01982                                        <a class="code" href="utils_8c.html#ac166db325056a01e8babd984f8ba2b98">host_address_to_string</a> (dep));
<a name="l01983"></a>01983                     }
<a name="l01984"></a>01984                   <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;    }\n&quot;</span>);
<a name="l01985"></a>01985                 }
<a name="l01986"></a>01986               <span class="keywordflow">else</span>
<a name="l01987"></a>01987                 <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;(none)\n&quot;</span>);
<a name="l01988"></a>01988               <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;  }\n&quot;</span>);
<a name="l01989"></a>01989             }
<a name="l01990"></a>01990         }
<a name="l01991"></a>01991 
<a name="l01992"></a>01992       <span class="keywordflow">if</span> (printed_objfile_start)
<a name="l01993"></a>01993         <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;}\n&quot;</span>);
<a name="l01994"></a>01994     }
<a name="l01995"></a>01995 }
<a name="l01996"></a>01996 
<a name="l01997"></a>01997 <span class="comment">/* Check consistency of currently expanded psymtabs vs symtabs.  */</span>
<a name="l01998"></a>01998 
<a name="l01999"></a>01999 <span class="keyword">static</span> <span class="keywordtype">void</span>
<a name="l02000"></a><a class="code" href="psymtab_8c.html#a292fa5f37edcf3b8ef6dadec00598d6e">02000</a> <a class="code" href="psymtab_8c.html#a292fa5f37edcf3b8ef6dadec00598d6e">maintenance_check_psymtabs</a> (<span class="keywordtype">char</span> *<a class="code" href="corelow_8c.html#ac54c1aef0966c38fc155dec95a38db50">ignore</a>, <span class="keywordtype">int</span> from_tty)
<a name="l02001"></a>02001 {
<a name="l02002"></a>02002   <span class="keyword">struct </span><a class="code" href="structsymbol.html">symbol</a> *sym;
<a name="l02003"></a>02003   <span class="keyword">struct </span><a class="code" href="structpartial__symbol.html">partial_symbol</a> **psym;
<a name="l02004"></a>02004   <span class="keyword">struct </span><a class="code" href="structsymtab.html">symtab</a> *s = NULL;
<a name="l02005"></a>02005   <span class="keyword">struct </span><a class="code" href="structpartial__symtab.html">partial_symtab</a> *<a class="code" href="namespacecleanup__check.html#a2f9ce522b7667bef19a5777d12fa44d8">ps</a>;
<a name="l02006"></a>02006   <span class="keyword">struct </span><a class="code" href="structblockvector.html">blockvector</a> *bv;
<a name="l02007"></a>02007   <span class="keyword">struct </span>objfile *objfile;
<a name="l02008"></a>02008   <span class="keyword">struct </span>block *b;
<a name="l02009"></a>02009   <span class="keywordtype">int</span> length;
<a name="l02010"></a>02010 
<a name="l02011"></a>02011   <a class="code" href="psymtab_8c.html#a3a00a6d0d1f26826e6270ee7e2bb4f6d">ALL_PSYMTABS</a> (objfile, ps)
<a name="l02012"></a>02012   {
<a name="l02013"></a>02013     <span class="keyword">struct </span><a class="code" href="structgdbarch.html">gdbarch</a> *<a class="code" href="structgdbarch.html">gdbarch</a> = <a class="code" href="objfiles_8c.html#a1c7101234ac2edc601fa465e48bc3463">get_objfile_arch</a> (objfile);
<a name="l02014"></a>02014 
<a name="l02015"></a>02015     <span class="comment">/* We don&#39;t call psymtab_to_symtab here because that may cause symtab</span>
<a name="l02016"></a>02016 <span class="comment">       expansion.  When debugging a problem it helps if checkers leave</span>
<a name="l02017"></a>02017 <span class="comment">       things unchanged.  */</span>
<a name="l02018"></a>02018     s = ps-&gt;<a class="code" href="structpartial__symtab.html#a1bbcf18c88d09005b43f960b6f3575f8">symtab</a>;
<a name="l02019"></a>02019 
<a name="l02020"></a>02020     <span class="comment">/* First do some checks that don&#39;t require the associated symtab.  */</span>
<a name="l02021"></a>02021     <span class="keywordflow">if</span> (ps-&gt;<a class="code" href="structpartial__symtab.html#aa582095c68fb326f3042ad672527a438">texthigh</a> &lt; ps-&gt;<a class="code" href="structpartial__symtab.html#a194e7d3c21d81ce56b81d1fe02e1dbc3">textlow</a>)
<a name="l02022"></a>02022       {
<a name="l02023"></a>02023         <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;Psymtab &quot;</span>);
<a name="l02024"></a>02024         <a class="code" href="utils_8c.html#ab4c30e1b3fe2dfa6e73f320a6758ad5f">puts_filtered</a> (ps-&gt;<a class="code" href="structpartial__symtab.html#a6ea70ac87d6dbd541967bdd6dacd7321">filename</a>);
<a name="l02025"></a>02025         <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot; covers bad range &quot;</span>);
<a name="l02026"></a>02026         <a class="code" href="utils_8c.html#a4b28488051faf9ab4a2f07633225835f">fputs_filtered</a> (<a class="code" href="utils_8c.html#ab5c76d72090f01d3848b63dda4e37d1c">paddress</a> (gdbarch, ps-&gt;<a class="code" href="structpartial__symtab.html#a194e7d3c21d81ce56b81d1fe02e1dbc3">textlow</a>), <a class="code" href="main_8c.html#a41a2b997ba5454df787d61f051dd918c">gdb_stdout</a>);
<a name="l02027"></a>02027         <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot; - &quot;</span>);
<a name="l02028"></a>02028         <a class="code" href="utils_8c.html#a4b28488051faf9ab4a2f07633225835f">fputs_filtered</a> (<a class="code" href="utils_8c.html#ab5c76d72090f01d3848b63dda4e37d1c">paddress</a> (gdbarch, ps-&gt;<a class="code" href="structpartial__symtab.html#aa582095c68fb326f3042ad672527a438">texthigh</a>), <a class="code" href="main_8c.html#a41a2b997ba5454df787d61f051dd918c">gdb_stdout</a>);
<a name="l02029"></a>02029         <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l02030"></a>02030         <span class="keywordflow">continue</span>;
<a name="l02031"></a>02031       }
<a name="l02032"></a>02032 
<a name="l02033"></a>02033     <span class="comment">/* Now do checks requiring the associated symtab.  */</span>
<a name="l02034"></a>02034     <span class="keywordflow">if</span> (s == NULL)
<a name="l02035"></a>02035       <span class="keywordflow">continue</span>;
<a name="l02036"></a>02036     bv = <a class="code" href="symtab_8h.html#a6cd84410d73680ff8006ac44b1b98a9c">BLOCKVECTOR</a> (s);
<a name="l02037"></a>02037     b = <a class="code" href="block_8h.html#a84c4a3aa7b6b4d9a127a1c018dd6a776">BLOCKVECTOR_BLOCK</a> (bv, <a class="code" href="defs_8h.html#a8ec407cb404e1ae8ce984f792e83f124a4842990ca5391ee943c2069b28443a99">STATIC_BLOCK</a>);
<a name="l02038"></a>02038     psym = objfile-&gt;<a class="code" href="structobjfile.html#a365549b70c39eb429e3103991da9b3e6">static_psymbols</a>.<a class="code" href="structpsymbol__allocation__list.html#ac618c483c3ff07162cdfe508abd6034d">list</a> + ps-&gt;<a class="code" href="structpartial__symtab.html#a36b8c771ea2906e413b8f1fffe1f4d10">statics_offset</a>;
<a name="l02039"></a>02039     length = ps-&gt;<a class="code" href="structpartial__symtab.html#a0fd67e243d440beaf6cc4757a97ff9b0">n_static_syms</a>;
<a name="l02040"></a>02040     <span class="keywordflow">while</span> (length--)
<a name="l02041"></a>02041       {
<a name="l02042"></a>02042         sym = <a class="code" href="symtab_8c.html#a25f45a38ca9085f0fad46c8cd1394fda">lookup_block_symbol</a> (b, <a class="code" href="symtab_8h.html#a956b56288511a18b855d8a263d60e87f">SYMBOL_LINKAGE_NAME</a> (*psym),
<a name="l02043"></a>02043                                    <a class="code" href="symtab_8h.html#a362f2f64212c0c45fb770a3f21ef5ab0">SYMBOL_DOMAIN</a> (*psym));
<a name="l02044"></a>02044         <span class="keywordflow">if</span> (!sym)
<a name="l02045"></a>02045           {
<a name="l02046"></a>02046             <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;Static symbol `&quot;</span>);
<a name="l02047"></a>02047             <a class="code" href="utils_8c.html#ab4c30e1b3fe2dfa6e73f320a6758ad5f">puts_filtered</a> (<a class="code" href="symtab_8h.html#a956b56288511a18b855d8a263d60e87f">SYMBOL_LINKAGE_NAME</a> (*psym));
<a name="l02048"></a>02048             <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;&#39; only found in &quot;</span>);
<a name="l02049"></a>02049             <a class="code" href="utils_8c.html#ab4c30e1b3fe2dfa6e73f320a6758ad5f">puts_filtered</a> (ps-&gt;<a class="code" href="structpartial__symtab.html#a6ea70ac87d6dbd541967bdd6dacd7321">filename</a>);
<a name="l02050"></a>02050             <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot; psymtab\n&quot;</span>);
<a name="l02051"></a>02051           }
<a name="l02052"></a>02052         psym++;
<a name="l02053"></a>02053       }
<a name="l02054"></a>02054     b = <a class="code" href="block_8h.html#a84c4a3aa7b6b4d9a127a1c018dd6a776">BLOCKVECTOR_BLOCK</a> (bv, <a class="code" href="defs_8h.html#a8ec407cb404e1ae8ce984f792e83f124a973ee91cbe4b0cee4eb7603252a29bec">GLOBAL_BLOCK</a>);
<a name="l02055"></a>02055     psym = objfile-&gt;<a class="code" href="structobjfile.html#a5665fb90f8a5d1481cc59ed5cf6a86fa">global_psymbols</a>.<a class="code" href="structpsymbol__allocation__list.html#ac618c483c3ff07162cdfe508abd6034d">list</a> + ps-&gt;<a class="code" href="structpartial__symtab.html#ae11f1094416fd506398f4a58fe4fa405">globals_offset</a>;
<a name="l02056"></a>02056     length = ps-&gt;<a class="code" href="structpartial__symtab.html#ab26039959ff434afcf130049cfa8d27d">n_global_syms</a>;
<a name="l02057"></a>02057     <span class="keywordflow">while</span> (length--)
<a name="l02058"></a>02058       {
<a name="l02059"></a>02059         sym = <a class="code" href="symtab_8c.html#a25f45a38ca9085f0fad46c8cd1394fda">lookup_block_symbol</a> (b, <a class="code" href="symtab_8h.html#a956b56288511a18b855d8a263d60e87f">SYMBOL_LINKAGE_NAME</a> (*psym),
<a name="l02060"></a>02060                                    <a class="code" href="symtab_8h.html#a362f2f64212c0c45fb770a3f21ef5ab0">SYMBOL_DOMAIN</a> (*psym));
<a name="l02061"></a>02061         <span class="keywordflow">if</span> (!sym)
<a name="l02062"></a>02062           {
<a name="l02063"></a>02063             <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;Global symbol `&quot;</span>);
<a name="l02064"></a>02064             <a class="code" href="utils_8c.html#ab4c30e1b3fe2dfa6e73f320a6758ad5f">puts_filtered</a> (<a class="code" href="symtab_8h.html#a956b56288511a18b855d8a263d60e87f">SYMBOL_LINKAGE_NAME</a> (*psym));
<a name="l02065"></a>02065             <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;&#39; only found in &quot;</span>);
<a name="l02066"></a>02066             <a class="code" href="utils_8c.html#ab4c30e1b3fe2dfa6e73f320a6758ad5f">puts_filtered</a> (ps-&gt;<a class="code" href="structpartial__symtab.html#a6ea70ac87d6dbd541967bdd6dacd7321">filename</a>);
<a name="l02067"></a>02067             <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot; psymtab\n&quot;</span>);
<a name="l02068"></a>02068           }
<a name="l02069"></a>02069         psym++;
<a name="l02070"></a>02070       }
<a name="l02071"></a>02071     <span class="keywordflow">if</span> (ps-&gt;<a class="code" href="structpartial__symtab.html#aa582095c68fb326f3042ad672527a438">texthigh</a> != 0
<a name="l02072"></a>02072         &amp;&amp; (ps-&gt;<a class="code" href="structpartial__symtab.html#a194e7d3c21d81ce56b81d1fe02e1dbc3">textlow</a> &lt; <a class="code" href="block_8h.html#a08fdff319bcd75e92b61c79139592af6">BLOCK_START</a> (b) || ps-&gt;<a class="code" href="structpartial__symtab.html#aa582095c68fb326f3042ad672527a438">texthigh</a> &gt; <a class="code" href="block_8h.html#a61fcc8934fd274ea984eab2e0f787b6d">BLOCK_END</a> (b)))
<a name="l02073"></a>02073       {
<a name="l02074"></a>02074         <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;Psymtab &quot;</span>);
<a name="l02075"></a>02075         <a class="code" href="utils_8c.html#ab4c30e1b3fe2dfa6e73f320a6758ad5f">puts_filtered</a> (ps-&gt;<a class="code" href="structpartial__symtab.html#a6ea70ac87d6dbd541967bdd6dacd7321">filename</a>);
<a name="l02076"></a>02076         <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot; covers &quot;</span>);
<a name="l02077"></a>02077         <a class="code" href="utils_8c.html#a4b28488051faf9ab4a2f07633225835f">fputs_filtered</a> (<a class="code" href="utils_8c.html#ab5c76d72090f01d3848b63dda4e37d1c">paddress</a> (gdbarch, ps-&gt;<a class="code" href="structpartial__symtab.html#a194e7d3c21d81ce56b81d1fe02e1dbc3">textlow</a>), <a class="code" href="main_8c.html#a41a2b997ba5454df787d61f051dd918c">gdb_stdout</a>);
<a name="l02078"></a>02078         <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot; - &quot;</span>);
<a name="l02079"></a>02079         <a class="code" href="utils_8c.html#a4b28488051faf9ab4a2f07633225835f">fputs_filtered</a> (<a class="code" href="utils_8c.html#ab5c76d72090f01d3848b63dda4e37d1c">paddress</a> (gdbarch, ps-&gt;<a class="code" href="structpartial__symtab.html#aa582095c68fb326f3042ad672527a438">texthigh</a>), <a class="code" href="main_8c.html#a41a2b997ba5454df787d61f051dd918c">gdb_stdout</a>);
<a name="l02080"></a>02080         <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot; but symtab covers only &quot;</span>);
<a name="l02081"></a>02081         <a class="code" href="utils_8c.html#a4b28488051faf9ab4a2f07633225835f">fputs_filtered</a> (<a class="code" href="utils_8c.html#ab5c76d72090f01d3848b63dda4e37d1c">paddress</a> (gdbarch, <a class="code" href="block_8h.html#a08fdff319bcd75e92b61c79139592af6">BLOCK_START</a> (b)), <a class="code" href="main_8c.html#a41a2b997ba5454df787d61f051dd918c">gdb_stdout</a>);
<a name="l02082"></a>02082         <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot; - &quot;</span>);
<a name="l02083"></a>02083         <a class="code" href="utils_8c.html#a4b28488051faf9ab4a2f07633225835f">fputs_filtered</a> (<a class="code" href="utils_8c.html#ab5c76d72090f01d3848b63dda4e37d1c">paddress</a> (gdbarch, <a class="code" href="block_8h.html#a61fcc8934fd274ea984eab2e0f787b6d">BLOCK_END</a> (b)), <a class="code" href="main_8c.html#a41a2b997ba5454df787d61f051dd918c">gdb_stdout</a>);
<a name="l02084"></a>02084         <a class="code" href="utils_8c.html#a8a83ee04701e157bf53e23d8682874e8">printf_filtered</a> (<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l02085"></a>02085       }
<a name="l02086"></a>02086   }
<a name="l02087"></a>02087 }
<a name="l02088"></a>02088 
<a name="l02089"></a>02089 
<a name="l02090"></a>02090 
<a name="l02091"></a>02091 <span class="keywordtype">void</span>
<a name="l02092"></a><a class="code" href="psymtab_8h.html#a9c4eed855ee2892c78e1dc3a5ea9a5d5">02092</a> <a class="code" href="psymtab_8c.html#a9c4eed855ee2892c78e1dc3a5ea9a5d5">expand_partial_symbol_names</a> (<span class="keywordtype">int</span> (*fun) (<span class="keyword">const</span> <span class="keywordtype">char</span> *, <span class="keywordtype">void</span> *),
<a name="l02093"></a>02093                              <span class="keywordtype">void</span> *data)
<a name="l02094"></a>02094 {
<a name="l02095"></a>02095   <span class="keyword">struct </span>objfile *objfile;
<a name="l02096"></a>02096 
<a name="l02097"></a>02097   <a class="code" href="objfiles_8h.html#a8efee3b85a322006131a6056d45058b3">ALL_OBJFILES</a> (objfile)
<a name="l02098"></a>02098   {
<a name="l02099"></a>02099     <span class="keywordflow">if</span> (objfile-&gt;<a class="code" href="structobjfile.html#af6814df9c2fd1f669fd79d0b0c94262c">sf</a>)
<a name="l02100"></a>02100       objfile-&gt;<a class="code" href="structobjfile.html#af6814df9c2fd1f669fd79d0b0c94262c">sf</a>-&gt;<a class="code" href="structsym__fns.html#ae4cb3e689cab6e5ecf8e2fb8770b55b0">qf</a>-&gt;<a class="code" href="structquick__symbol__functions.html#a591769641f8235f275019b6288690a47">expand_symtabs_matching</a> (objfile, NULL, fun,
<a name="l02101"></a>02101                                                 <a class="code" href="symtab_8h.html#a37678171929b3b399903eec8be25dcd5ac9f9f7eff869eba6d6d85c4046c31f6f">ALL_DOMAIN</a>, data);
<a name="l02102"></a>02102   }
<a name="l02103"></a>02103 }
<a name="l02104"></a>02104 
<a name="l02105"></a>02105 <span class="keywordtype">void</span>
<a name="l02106"></a><a class="code" href="psymtab_8h.html#a07fc8cc2e97a8692e427226781f6f87e">02106</a> <a class="code" href="psymtab_8c.html#a07fc8cc2e97a8692e427226781f6f87e">map_partial_symbol_filenames</a> (<a class="code" href="symfile_8h.html#aa6c3550ce55c965193c4397a8583a3b8">symbol_filename_ftype</a> *fun, <span class="keywordtype">void</span> *data,
<a name="l02107"></a>02107                               <span class="keywordtype">int</span> need_fullname)
<a name="l02108"></a>02108 {
<a name="l02109"></a>02109   <span class="keyword">struct </span>objfile *objfile;
<a name="l02110"></a>02110 
<a name="l02111"></a>02111   <a class="code" href="objfiles_8h.html#a8efee3b85a322006131a6056d45058b3">ALL_OBJFILES</a> (objfile)
<a name="l02112"></a>02112   {
<a name="l02113"></a>02113     <span class="keywordflow">if</span> (objfile-&gt;<a class="code" href="structobjfile.html#af6814df9c2fd1f669fd79d0b0c94262c">sf</a>)
<a name="l02114"></a>02114       objfile-&gt;<a class="code" href="structobjfile.html#af6814df9c2fd1f669fd79d0b0c94262c">sf</a>-&gt;<a class="code" href="structsym__fns.html#ae4cb3e689cab6e5ecf8e2fb8770b55b0">qf</a>-&gt;<a class="code" href="structquick__symbol__functions.html#a0ac309ebbf8f64f8fe2f6270b56b06e1">map_symbol_filenames</a> (objfile, fun, data,
<a name="l02115"></a>02115                                              need_fullname);
<a name="l02116"></a>02116   }
<a name="l02117"></a>02117 }
<a name="l02118"></a>02118 
<a name="l02119"></a>02119 <span class="keyword">extern</span> <a class="code" href="defs_8h.html#a686ed07d4fdcdc366f2bc677216ca08d">initialize_file_ftype</a> <a class="code" href="psymtab_8c.html#a88408d4e3f974188034d34563eca769f">_initialize_psymtab</a>;
<a name="l02120"></a>02120 
<a name="l02121"></a>02121 <span class="keywordtype">void</span>
<a name="l02122"></a><a class="code" href="psymtab_8c.html#a4a6bff9ef3338db2ce2f68d707c8c349">02122</a> _initialize_psymtab (<span class="keywordtype">void</span>)
<a name="l02123"></a>02123 {
<a name="l02124"></a>02124   <a class="code" href="cli-decode_8c.html#ab87b0ba51ed9aa4c8aac0c96373537f8">add_cmd</a> (<span class="stringliteral">&quot;psymbols&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a502c7b57c7172ac88ef735f68070bb59">class_maintenance</a>, <a class="code" href="psymtab_8c.html#a2cd6b3d0b6c923db487f730df9dbb83c">maintenance_print_psymbols</a>, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l02125"></a>02125 <span class="stringliteral">Print dump of current partial symbol definitions.\n\</span>
<a name="l02126"></a>02126 <span class="stringliteral">Entries in the partial symbol table are dumped to file OUTFILE.\n\</span>
<a name="l02127"></a>02127 <span class="stringliteral">If a SOURCE file is specified, dump only that file&#39;s partial symbols.&quot;</span>),
<a name="l02128"></a>02128            &amp;<a class="code" href="cli-cmds_8c.html#a3f79698e1da932120faaa70c587711b7">maintenanceprintlist</a>);
<a name="l02129"></a>02129 
<a name="l02130"></a>02130   <a class="code" href="cli-decode_8c.html#ab87b0ba51ed9aa4c8aac0c96373537f8">add_cmd</a> (<span class="stringliteral">&quot;psymtabs&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a502c7b57c7172ac88ef735f68070bb59">class_maintenance</a>, <a class="code" href="psymtab_8c.html#a97903a765274eadf721bedbb12c7ed25">maintenance_info_psymtabs</a>, <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l02131"></a>02131 <span class="stringliteral">List the partial symbol tables for all object files.\n\</span>
<a name="l02132"></a>02132 <span class="stringliteral">This does not include information about individual partial symbols,\n\</span>
<a name="l02133"></a>02133 <span class="stringliteral">just the symbol table structures themselves.&quot;</span>),
<a name="l02134"></a>02134            &amp;<a class="code" href="cli-cmds_8c.html#adea9c2a6ad27de2f64d04262ff61d43f">maintenanceinfolist</a>);
<a name="l02135"></a>02135 
<a name="l02136"></a>02136   <a class="code" href="cli-decode_8c.html#ab87b0ba51ed9aa4c8aac0c96373537f8">add_cmd</a> (<span class="stringliteral">&quot;check-psymtabs&quot;</span>, <a class="code" href="command_8h.html#ad71b5a938f3966cf81293bca79acef49a502c7b57c7172ac88ef735f68070bb59">class_maintenance</a>, <a class="code" href="psymtab_8c.html#a292fa5f37edcf3b8ef6dadec00598d6e">maintenance_check_psymtabs</a>,
<a name="l02137"></a>02137            <a class="code" href="gdb__locale_8h.html#a32a3cf3d9dd914f5aeeca5423c157934">_</a>(<span class="stringliteral">&quot;\</span>
<a name="l02138"></a>02138 <span class="stringliteral">Check consistency of currently expanded psymtabs versus symtabs.&quot;</span>),
<a name="l02139"></a>02139            &amp;<a class="code" href="cli-cmds_8c.html#ab063b8cc1899a71b24df72922339d766">maintenancelist</a>);
<a name="l02140"></a>02140 }
</pre></div></div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated on Fri Oct 11 2013 14:13:31 for GDB (xrefs) by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
